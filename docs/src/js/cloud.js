var a0_0x3f2dbc=a0_0x250e;(function(_0x472413,_0x4908d2){var _0x23ec85=a0_0x250e,_0x50dc2b=_0x472413();while(!![]){try{var _0x497a59=-parseInt(_0x23ec85(0x1b5))/0x1+parseInt(_0x23ec85(0x1ab))/0x2*(parseInt(_0x23ec85(0x199))/0x3)+-parseInt(_0x23ec85(0x1bb))/0x4*(-parseInt(_0x23ec85(0x1a9))/0x5)+-parseInt(_0x23ec85(0x1c6))/0x6+parseInt(_0x23ec85(0x1a8))/0x7*(parseInt(_0x23ec85(0x1b4))/0x8)+parseInt(_0x23ec85(0x1cd))/0x9*(parseInt(_0x23ec85(0x1d2))/0xa)+-parseInt(_0x23ec85(0x1bf))/0xb;if(_0x497a59===_0x4908d2)break;else _0x50dc2b['push'](_0x50dc2b['shift']());}catch(_0x26ffa8){_0x50dc2b['push'](_0x50dc2b['shift']());}}}(a0_0x1886,0x7b0ce));import*as a0_0x12bddd from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x3f2dbc(0x1ca),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x204af6=a0_0x3f2dbc,_0x3988aa=window[_0x204af6(0x191)][_0x204af6(0x1d7)]['split']('?')[0x0],_0x3c4e7a=_0x204af6(0x198),_0xeabb03=_0x204af6(0x1cc),_0x513e27=_0x204af6(0x18f)+clientId+_0x204af6(0x1a0)+_0x3c4e7a+_0x204af6(0x1ce)+_0xeabb03+_0x204af6(0x1a1)+encodeURIComponent(_0x3988aa);window[_0x204af6(0x191)]['href']=_0x513e27;}function a0_0x1886(){var _0x29f0d6=['[\x5c?&#]','Restore\x20canceled\x20by\x20user.','screenshot','14164370vxqpyr','name','refreshToken','Download\x20failed\x20for\x20','Do\x20you\x20want\x20to\x20logout?','Bearer\x20','Backing\x20up...','2386266JkYZbH','json','access_token','click','knh3uz2mx2hp2eu','Cloud\x20login\x20required!','offline','90eKyVEe','&token_access_type=','POST','folder','Folder\x20already\x20exists','415920ZlfPtE','log','Upload\x20failed,\x20unknown\x20http\x20status:\x20','No\x20refresh\x20token','Refreshing\x20token...','href','confirm','getItem','replace','parse','state','authorization_code','Folder\x20created','stringify','blob','open','https://api.dropboxapi.com/2/files/create_folder_v2','Do\x20not\x20receive\x20authorization','active','application/json','accessToken','addEventListener','search','entries','push','Error\x20creating\x20folder\x20','application/x-www-form-urlencoded','send','Do\x20you\x20want\x20to\x20backup\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','save','Cloud\x20↦\x20Kabu\x20storage\x20◆','classList','Kabu\x20storage\x20↦\x20Cloud\x20◆','Content-Type','https://www.dropbox.com/oauth2/authorize?client_id=','Download\x20failed,\x20unknown\x20http\x20status:','location','split','error','map','\x20files\x20in\x20Kabu?','refresh_token','onload','code','4239mJLJEa','https://api.dropboxapi.com/2/files/list_folder','=([^&#]*)','length','responseText','https://content.dropboxapi.com/2/files/download','alert','&response_type=','&redirect_uri=','status','Unable\x20to\x20refresh\x20token','No\x20files\x20found\x20to\x20restore.','Restoring...','remove','uId','1883lBYXZU','140KdIVCi','Failed\x20to\x20upload\x20file\x20','662hZKwoH','uid','Error\x20while\x20refreshing\x20token:','DOMContentLoaded',',\x20status:\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','.tag','filter','&client_secret=','26776idXlRH','372383mXYwFo','setItem','error_description','Wait\x20a\x20little\x20bit...','application/octet-stream','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','111116XneUUi'];a0_0x1886=function(){return _0x29f0d6;};return a0_0x1886();}function handleDropboxCallback(){var _0x190f2e=a0_0x3f2dbc,_0x57e8c1=getUrlParameter('code');_0x57e8c1?(getAccessToken(_0x57e8c1),console[_0x190f2e(0x1d3)]('Authorization\x20Code:',_0x57e8c1)):console[_0x190f2e(0x1d3)](_0x190f2e(0x17d));}function getUrlParameter(_0x2475f6){var _0x1c4811=a0_0x3f2dbc;_0x2475f6=_0x2475f6['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x15baaa=new RegExp(_0x1c4811(0x1bc)+_0x2475f6+_0x1c4811(0x19b)),_0x19f58f=_0x15baaa['exec'](location[_0x1c4811(0x182)]);return _0x19f58f===null?'':decodeURIComponent(_0x19f58f[0x1][_0x1c4811(0x1da)](/\+/g,'\x20'));}function a0_0x250e(_0xda8e94,_0x1f5df7){var _0x188633=a0_0x1886();return a0_0x250e=function(_0x250ee8,_0x3876b7){_0x250ee8=_0x250ee8-0x175;var _0x3a5a8=_0x188633[_0x250ee8];return _0x3a5a8;},a0_0x250e(_0xda8e94,_0x1f5df7);}function getAccessToken(_0x44a01b){var _0x2e91f3=a0_0x3f2dbc,_0x2a85aa=_0x2e91f3(0x177),_0x5960f7=window[_0x2e91f3(0x191)]['href'][_0x2e91f3(0x192)]('?')[0x0],_0x3a924f=new XMLHttpRequest();_0x3a924f[_0x2e91f3(0x17b)](_0x2e91f3(0x1cf),'https://api.dropbox.com/oauth2/token'),_0x3a924f['setRequestHeader'](_0x2e91f3(0x18e),_0x2e91f3(0x186)),_0x3a924f[_0x2e91f3(0x197)]=function(){var _0x5dc11f=_0x2e91f3;if(_0x3a924f[_0x5dc11f(0x1a2)]===0xc8){var _0x3666dd=JSON[_0x5dc11f(0x175)](_0x3a924f[_0x5dc11f(0x19d)]),_0x32f00e=_0x3666dd[_0x5dc11f(0x1c8)],_0x3fa9ec=_0x3666dd[_0x5dc11f(0x196)],_0x4ea790=_0x3666dd[_0x5dc11f(0x1ac)];localStorage[_0x5dc11f(0x1b6)](_0x5dc11f(0x180),_0x32f00e),localStorage[_0x5dc11f(0x1b6)]('refreshToken',_0x3fa9ec),localStorage['setItem'](_0x5dc11f(0x1a7),_0x4ea790);}else console[_0x5dc11f(0x1d3)](_0x5dc11f(0x1ba));},_0x3a924f[_0x2e91f3(0x187)]('code='+_0x44a01b+'&grant_type='+_0x2a85aa+'&client_id='+clientId+_0x2e91f3(0x1b3)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5960f7));}export async function dpCreateFolder(_0x1e0b9c){var _0x1062c4=a0_0x3f2dbc;const _0x2404cc=localStorage[_0x1062c4(0x1d9)](_0x1062c4(0x1a7));let _0x19c673=localStorage[_0x1062c4(0x1d9)](_0x1062c4(0x180));const _0x2879cd='/'+_0x2404cc+'/'+_0x1e0b9c,_0x28ca81=JSON['stringify']({'path':_0x2879cd,'autorename':![]});for(let _0x1c4687=0x0;_0x1c4687<0x2;_0x1c4687++){try{const _0x50ee53=await fetch(_0x1062c4(0x17c),{'method':_0x1062c4(0x1cf),'headers':{'Authorization':_0x1062c4(0x1c4)+_0x19c673,'Content-Type':_0x1062c4(0x17f)},'body':_0x28ca81});if(_0x50ee53['status']===0x191){const _0x483ea6=await dpRefreshToken();if(!_0x483ea6)throw new Error('Unable\x20to\x20refresh\x20token');_0x19c673=localStorage[_0x1062c4(0x1d9)](_0x1062c4(0x180));continue;}if(_0x50ee53[_0x1062c4(0x1a2)]===0x199)return{'message':_0x1062c4(0x1d1),'path':_0x1e0b9c};if(!_0x50ee53['ok'])throw new Error(_0x1062c4(0x185)+_0x1e0b9c);const _0x164007=await _0x50ee53[_0x1062c4(0x1c7)]();return await lockNoti(_0x1062c4(0x178),'',0xbb8),_0x164007;}catch(_0x31d320){if(_0x1c4687===0x1)throw _0x31d320;}}return![];}export async function dpRefreshToken(){var _0x5ae7d5=a0_0x3f2dbc;if(!localStorage[_0x5ae7d5(0x1d9)]('refreshToken'))throw _0x5ae7d5(0x1d5);try{const _0x5997d4=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0x5ae7d5(0x1d9)](_0x5ae7d5(0x1c1))+_0x5ae7d5(0x1b0)}),_0x84c208=await _0x5997d4['json']();if(!_0x84c208[_0x5ae7d5(0x193)])return localStorage[_0x5ae7d5(0x1b6)]('accessToken',_0x84c208[_0x5ae7d5(0x1c8)]),await lockNoti(_0x5ae7d5(0x1d6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x84c208[_0x5ae7d5(0x1b7)]||_0x5ae7d5(0x189));}catch(_0x106b93){console[_0x5ae7d5(0x193)](_0x5ae7d5(0x1ad),_0x106b93);}return![];}export async function dpUploadFile(_0x2cc03c,_0x58e314,_0x461046){var _0x1bd862=a0_0x3f2dbc;const _0x8efd6d=localStorage[_0x1bd862(0x1d9)](_0x1bd862(0x1a7));var _0x1797a1=JSON[_0x1bd862(0x179)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x8efd6d+'/'+_0x461046+'/'+_0x2cc03c}),_0x428671=new Blob([_0x58e314],{'type':_0x1bd862(0x1b9)});for(var _0x498512=0x0;_0x498512<0x2;_0x498512++){var _0x2d24bc=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x1bd862(0x1cf),'headers':{'Authorization':_0x1bd862(0x1c4)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x1797a1,'Content-Type':_0x1bd862(0x1b9)},'body':_0x428671});if(_0x2d24bc[_0x1bd862(0x1a2)]!=0xc8){if(_0x2d24bc[_0x1bd862(0x1a2)]==0x191){var _0x9f99e7=await dpRefreshToken();if(!_0x9f99e7)throw _0x1bd862(0x1a3);continue;}else throw _0x1bd862(0x1d4)+_0x2d24bc['status'];}else{var _0x34942d=await _0x2d24bc[_0x1bd862(0x1c7)]();return console[_0x1bd862(0x1d3)](_0x1bd862(0x18d),_0x2cc03c),_0x34942d;}}return![];}export async function dpDownloadFile(_0x437b70,_0x6fc084){var _0x216cdb=a0_0x3f2dbc;const _0x596464=localStorage['getItem']('uId');var _0x2401f=JSON[_0x216cdb(0x179)]({'path':'/'+_0x596464+'/'+_0x6fc084+'/'+_0x437b70});for(var _0x1b6f39=0x0;_0x1b6f39<0x2;_0x1b6f39++){var _0x149e36=await fetch(_0x216cdb(0x19e),{'method':_0x216cdb(0x1cf),'headers':{'Authorization':_0x216cdb(0x1c4)+localStorage[_0x216cdb(0x1d9)](_0x216cdb(0x180)),'Dropbox-API-Arg':_0x2401f}});if(_0x149e36[_0x216cdb(0x1a2)]!=0xc8){if(_0x149e36[_0x216cdb(0x1a2)]==0x191){var _0x588380=await dpRefreshToken();if(!_0x588380)throw _0x216cdb(0x1a3);continue;}else throw _0x216cdb(0x190)+_0x149e36[_0x216cdb(0x1a2)];}const _0x30119f=new File([await _0x149e36[_0x216cdb(0x17a)]()],_0x437b70);return console[_0x216cdb(0x1d3)](_0x216cdb(0x18b),_0x30119f[_0x216cdb(0x1c0)]),a0_0x12bddd['uploadFileInCloud'](_0x30119f,()=>{}),_0x30119f;}return![];}document[a0_0x3f2dbc(0x181)](a0_0x3f2dbc(0x1ae),function(){var _0x1ad1df=a0_0x3f2dbc;dropboxRestore['addEventListener'](_0x1ad1df(0x1c9),async function(){var _0x4f375c=_0x1ad1df;await lockNoti(_0x4f375c(0x1b8),'',0x1388);const _0x3d27a7=localStorage[_0x4f375c(0x1d9)](_0x4f375c(0x1a7)),_0x32cbeb=[_0x4f375c(0x176),_0x4f375c(0x18a),_0x4f375c(0x1be)];if(!_0x3d27a7){window[_0x4f375c(0x19f)](_0x4f375c(0x1cb));return;}let _0x9eee10=[];for(const _0x172fb2 of _0x32cbeb){let _0x305644={'path':'/'+_0x3d27a7+'/'+_0x172fb2};for(let _0x1d4859=0x0;_0x1d4859<0x2;_0x1d4859++){let _0x36fe58=await fetch(_0x4f375c(0x19a),{'method':_0x4f375c(0x1cf),'headers':{'Authorization':_0x4f375c(0x1c4)+localStorage[_0x4f375c(0x1d9)](_0x4f375c(0x180)),'Content-Type':_0x4f375c(0x17f)},'body':JSON['stringify'](_0x305644)});if(_0x36fe58[_0x4f375c(0x1a2)]===0xc8){let _0x37e90f=await _0x36fe58[_0x4f375c(0x1c7)](),_0x1817ec=_0x37e90f[_0x4f375c(0x183)][_0x4f375c(0x1b2)](_0x1787a7=>_0x1787a7[_0x4f375c(0x1b1)]==='file');_0x1817ec[_0x4f375c(0x19c)]>0x0&&_0x9eee10[_0x4f375c(0x184)](..._0x1817ec[_0x4f375c(0x194)](_0x24c578=>({'name':_0x24c578[_0x4f375c(0x1c0)],'folder':_0x172fb2})));break;}else{if(_0x36fe58[_0x4f375c(0x1a2)]===0x191){let _0xa17a59=await dpRefreshToken();if(!_0xa17a59)throw _0x4f375c(0x1a3);}else{console[_0x4f375c(0x193)](_0x4f375c(0x1c2)+_0x172fb2+_0x4f375c(0x1af)+_0x36fe58[_0x4f375c(0x1a2)]);break;}}}}if(_0x9eee10['length']>0x0){const _0x1cc0f0='Do\x20you\x20want\x20to\x20restore\x20'+_0x9eee10[_0x4f375c(0x19c)]+'\x20files\x20from\x20Cloud?';if(window[_0x4f375c(0x1d8)](_0x1cc0f0))for(const _0x1bc7d1 of _0x9eee10){await lockNoti(_0x4f375c(0x1a5),_0x1bc7d1[_0x4f375c(0x1c0)],0xbb8),await dpDownloadFile(_0x1bc7d1[_0x4f375c(0x1c0)],_0x1bc7d1[_0x4f375c(0x1d0)]);}else console[_0x4f375c(0x1d3)](_0x4f375c(0x1bd));}else console[_0x4f375c(0x1d3)](_0x4f375c(0x1a4));}),dropboxBackup[_0x1ad1df(0x181)](_0x1ad1df(0x1c9),async function(){var _0x17c423=_0x1ad1df;await lockNoti(_0x17c423(0x1b8),'',0x1388);const _0x398763=localStorage[_0x17c423(0x1d9)](_0x17c423(0x1a7));if(_0x398763===null||_0x398763==='')window[_0x17c423(0x19f)]('Cloud\x20login\x20required!');else{const _0xd7d68=[_0x17c423(0x176),_0x17c423(0x18a),_0x17c423(0x1be)];for(const _0x547d39 of _0xd7d68){await dpCreateFolder(_0x547d39);}let _0x4a8890=0x0;for(const _0x382a11 of _0xd7d68){const _0x189fe2=a0_0x12bddd['listFiles'](_0x382a11+'s');_0x4a8890+=_0x189fe2[_0x17c423(0x19c)];}if(window[_0x17c423(0x1d8)](_0x17c423(0x188)+_0x4a8890+_0x17c423(0x195)))for(const _0x31e6b4 of _0xd7d68){const _0x4664d8=a0_0x12bddd['listFiles'](_0x31e6b4+'s');for(const _0x219e01 of _0x4664d8){const _0x1ec68d=await a0_0x12bddd['downloadFileInCloud']('/data/'+_0x31e6b4+'s/'+_0x219e01);try{await lockNoti(_0x17c423(0x1c5),_0x219e01,0xbb8),await dpUploadFile(_0x219e01,_0x1ec68d,_0x31e6b4);}catch(_0x311f14){console[_0x17c423(0x193)](_0x17c423(0x1aa)+_0x219e01+':',_0x311f14);}}}else console[_0x17c423(0x1d3)](_0x17c423(0x1bd));}}),dropboxCloud[_0x1ad1df(0x181)](_0x1ad1df(0x1c9),function(){var _0x575054=_0x1ad1df;const _0x108b16=localStorage[_0x575054(0x1d9)](_0x575054(0x1a7));_0x108b16===null||_0x108b16===''?authorizeWithDropbox():window[_0x575054(0x1d8)](_0x575054(0x1c3))&&(localStorage[_0x575054(0x1b6)](_0x575054(0x1a7),''),dropboxRestore['classList'][_0x575054(0x1a6)](_0x575054(0x17e)),dropboxBackup['classList'][_0x575054(0x1a6)]('active'),dropboxCloud[_0x575054(0x18c)][_0x575054(0x1a6)](_0x575054(0x17e)));}),handleDropboxCallback();});