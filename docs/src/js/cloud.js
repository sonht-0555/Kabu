var a0_0x57892b=a0_0x265e;(function(_0x31e8ca,_0x306efd){var _0x24ef25=a0_0x265e,_0x3ee145=_0x31e8ca();while(!![]){try{var _0x526644=parseInt(_0x24ef25(0x22a))/0x1*(-parseInt(_0x24ef25(0x1f4))/0x2)+-parseInt(_0x24ef25(0x1fe))/0x3*(-parseInt(_0x24ef25(0x1fd))/0x4)+parseInt(_0x24ef25(0x20c))/0x5+parseInt(_0x24ef25(0x1ec))/0x6+-parseInt(_0x24ef25(0x20d))/0x7*(parseInt(_0x24ef25(0x1d4))/0x8)+-parseInt(_0x24ef25(0x228))/0x9+parseInt(_0x24ef25(0x1e0))/0xa;if(_0x526644===_0x306efd)break;else _0x3ee145['push'](_0x3ee145['shift']());}catch(_0x235de3){_0x3ee145['push'](_0x3ee145['shift']());}}}(a0_0x2e2b,0xbefc1));import*as a0_0x268b06 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x57892b(0x227),clientSecret='nwb3dnfh09rhs31';function a0_0x265e(_0x59b2a1,_0x3445ec){var _0x2e2b34=a0_0x2e2b();return a0_0x265e=function(_0x265e19,_0x35e403){_0x265e19=_0x265e19-0x1d0;var _0x2e82e7=_0x2e2b34[_0x265e19];return _0x2e82e7;},a0_0x265e(_0x59b2a1,_0x3445ec);}function authorizeWithDropbox(){var _0x3f7240=a0_0x57892b,_0x57d20e=window[_0x3f7240(0x1f3)][_0x3f7240(0x219)][_0x3f7240(0x20e)]('?')[0x0],_0x1d39ab=_0x3f7240(0x204),_0x108e8e=_0x3f7240(0x1f0),_0x4cb7ca=_0x3f7240(0x1dc)+clientId+'&response_type='+_0x1d39ab+'&token_access_type='+_0x108e8e+_0x3f7240(0x1d9)+encodeURIComponent(_0x57d20e);window[_0x3f7240(0x1f3)][_0x3f7240(0x219)]=_0x4cb7ca;}function a0_0x2e2b(){var _0x52bf31=['Kabu\x20storage\x20↦\x20Cloud\x20◆','Wait\x20a\x20little\x20bit...','classList','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','status','DOMContentLoaded','knh3uz2mx2hp2eu','9597861eWOwcd','push','33164tgpOaK','remove','Do\x20you\x20want\x20to\x20backup\x20','uploadFileInCloud','refresh_token=','&client_secret=','application/json',',\x20status:\x20','overwrite','stringify','Failed\x20to\x20refresh\x20Dropbox\x20token.','access_token','addEventListener','Content-Type','\x20files\x20in\x20Kabu?','25776fjBVqY','code=','Failed\x20to\x20upload\x20file\x20','onload','list','&redirect_uri=','blob','[\x5c?&#]','https://www.dropbox.com/oauth2/authorize?client_id=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','folder','application/x-www-form-urlencoded','23305020jvQZZL','state','Error\x20creating\x20folder\x20','Download\x20failed,\x20unknown\x20http\x20status:','json','exec','name','toUpperCase','No\x20refresh\x20token','application/octet-stream','setItem','search','4203138ekgXSV','responseText','refresh_token','Bearer\x20','offline','confirm','Cloud\x20login\x20required!','location','82ZniCPz','alert','log','No\x20files\x20found\x20to\x20restore.','open','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','downloadFileInCloud','click','424OxFOvi','26859ZJBKaV','replace','POST','file','error','https://api.dropboxapi.com/2/files/list_folder','code','charAt','slice','accessToken','length','Restore\x20canceled\x20by\x20user.','map','=([^&#]*)','56645wmctHa','1701ObOVrP','split','Do\x20you\x20want\x20to\x20restore\x20','authorization_code','setRequestHeader','uId','send','save','Do\x20you\x20want\x20to\x20logout?','https://api.dropbox.com/oauth2/token','active','Error\x20while\x20refreshing\x20token:','href','Authorization\x20Code:','Unable\x20to\x20refresh\x20token','getItem','FSSync','Folder\x20already\x20exists','screenshot','refreshToken'];a0_0x2e2b=function(){return _0x52bf31;};return a0_0x2e2b();}function handleDropboxCallback(){var _0x8c4870=a0_0x57892b,_0x1e8358=getUrlParameter('code');_0x1e8358?(getAccessToken(_0x1e8358),console['log'](_0x8c4870(0x21a),_0x1e8358)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x2a7459){var _0x5a6108=a0_0x57892b;_0x2a7459=_0x2a7459[_0x5a6108(0x1ff)](/[\[]/,'\x5c[')[_0x5a6108(0x1ff)](/[\]]/,'\x5c]');var _0x4a3645=new RegExp(_0x5a6108(0x1db)+_0x2a7459+_0x5a6108(0x20b)),_0x245be7=_0x4a3645[_0x5a6108(0x1e5)](location[_0x5a6108(0x1eb)]);return _0x245be7===null?'':decodeURIComponent(_0x245be7[0x1][_0x5a6108(0x1ff)](/\+/g,'\x20'));}function getAccessToken(_0xa4803){var _0x26a955=a0_0x57892b,_0x40cc50=_0x26a955(0x210),_0x46fb7a=window[_0x26a955(0x1f3)][_0x26a955(0x219)][_0x26a955(0x20e)]('?')[0x0],_0x2e523f=new XMLHttpRequest();_0x2e523f[_0x26a955(0x1f8)](_0x26a955(0x200),_0x26a955(0x216)),_0x2e523f[_0x26a955(0x211)](_0x26a955(0x1d2),'application/x-www-form-urlencoded'),_0x2e523f[_0x26a955(0x1d7)]=function(){var _0x3b4ec8=_0x26a955;if(_0x2e523f[_0x3b4ec8(0x225)]===0xc8){var _0x14446e=JSON['parse'](_0x2e523f[_0x3b4ec8(0x1ed)]),_0x40fbdc=_0x14446e[_0x3b4ec8(0x1d0)],_0x1a6c71=_0x14446e[_0x3b4ec8(0x1ee)],_0x80d830=_0x14446e['uid'];localStorage['setItem'](_0x3b4ec8(0x207),_0x40fbdc),localStorage['setItem'](_0x3b4ec8(0x220),_0x1a6c71),localStorage[_0x3b4ec8(0x1ea)](_0x3b4ec8(0x212),_0x80d830);}else console[_0x3b4ec8(0x1f6)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x2e523f[_0x26a955(0x213)](_0x26a955(0x1d5)+_0xa4803+'&grant_type='+_0x40cc50+'&client_id='+clientId+_0x26a955(0x22f)+clientSecret+_0x26a955(0x1d9)+encodeURIComponent(_0x46fb7a));}export async function dpCreateFolder(_0x1c41d0){var _0x4d54d2=a0_0x57892b;const _0x43da5d=localStorage[_0x4d54d2(0x21c)]('uId');let _0x5b0f2c=localStorage[_0x4d54d2(0x21c)](_0x4d54d2(0x207));const _0x45e1e3='/'+_0x43da5d+'/'+_0x1c41d0,_0x29b3ed=JSON['stringify']({'path':_0x45e1e3,'autorename':![]});for(let _0x34213f=0x0;_0x34213f<0x2;_0x34213f++){try{const _0xf666a0=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x5b0f2c,'Content-Type':_0x4d54d2(0x230)},'body':_0x29b3ed});if(_0xf666a0[_0x4d54d2(0x225)]===0x191){const _0x598fba=await dpRefreshToken();if(!_0x598fba)throw new Error(_0x4d54d2(0x21b));_0x5b0f2c=localStorage[_0x4d54d2(0x21c)](_0x4d54d2(0x207));continue;}if(_0xf666a0['status']===0x199)return{'message':_0x4d54d2(0x21e),'path':_0x1c41d0};if(!_0xf666a0['ok'])throw new Error(_0x4d54d2(0x1e2)+_0x1c41d0);const _0x5378b8=await _0xf666a0[_0x4d54d2(0x1e4)]();return await lockNoti('Folder\x20created','',0xbb8),_0x5378b8;}catch(_0x11c49f){if(_0x34213f===0x1)throw _0x11c49f;}}return![];}export async function dpRefreshToken(){var _0x29a7e7=a0_0x57892b;if(!localStorage[_0x29a7e7(0x21c)](_0x29a7e7(0x220)))throw _0x29a7e7(0x1e8);try{const _0x1e9094=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x29a7e7(0x200),'headers':{'Content-Type':_0x29a7e7(0x1df)},'body':_0x29a7e7(0x22e)+localStorage[_0x29a7e7(0x21c)](_0x29a7e7(0x220))+_0x29a7e7(0x224)}),_0x4ca762=await _0x1e9094[_0x29a7e7(0x1e4)]();if(!_0x4ca762[_0x29a7e7(0x202)])return localStorage[_0x29a7e7(0x1ea)](_0x29a7e7(0x207),_0x4ca762[_0x29a7e7(0x1d0)]),await lockNoti(_0x29a7e7(0x1f9),'',0xbb8),await delay(0x3e8),!![];else alert(_0x4ca762['error_description']||_0x29a7e7(0x234));}catch(_0x5bd764){console[_0x29a7e7(0x202)](_0x29a7e7(0x218),_0x5bd764);}return![];}export async function dpUploadFile(_0x19cadb,_0x59f3fa,_0xc98c16){var _0x5bef6b=a0_0x57892b;const _0x246a47=localStorage[_0x5bef6b(0x21c)](_0x5bef6b(0x212));var _0x383524=JSON[_0x5bef6b(0x233)]({'autorename':!![],'mode':_0x5bef6b(0x232),'mute':!![],'strict_conflict':![],'path':'/'+_0x246a47+'/'+_0xc98c16+'/'+_0x19cadb}),_0x1b4a73=new Blob([_0x59f3fa],{'type':_0x5bef6b(0x1e9)});for(var _0x99d9a6=0x0;_0x99d9a6<0x2;_0x99d9a6++){var _0x3e84fa=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x383524,'Content-Type':_0x5bef6b(0x1e9)},'body':_0x1b4a73});if(_0x3e84fa[_0x5bef6b(0x225)]!=0xc8){if(_0x3e84fa[_0x5bef6b(0x225)]==0x191){var _0x4d9600=await dpRefreshToken();if(!_0x4d9600)throw _0x5bef6b(0x21b);continue;}else throw _0x5bef6b(0x1dd)+_0x3e84fa['status'];}else{var _0x5bf1db=await _0x3e84fa[_0x5bef6b(0x1e4)]();return console[_0x5bef6b(0x1f6)](_0x5bef6b(0x221),_0x19cadb),_0x5bf1db;}}return![];}export async function dpDownloadFile(_0x24dd83,_0x3ccb44){var _0x5e0388=a0_0x57892b;const _0x85dee=localStorage[_0x5e0388(0x21c)]('uId');var _0x5ce7e4=JSON['stringify']({'path':'/'+_0x85dee+'/'+_0x3ccb44+'/'+_0x24dd83});for(var _0x585bd3=0x0;_0x585bd3<0x2;_0x585bd3++){var _0x4e2481=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x5e0388(0x200),'headers':{'Authorization':_0x5e0388(0x1ef)+localStorage[_0x5e0388(0x21c)](_0x5e0388(0x207)),'Dropbox-API-Arg':_0x5ce7e4}});if(_0x4e2481[_0x5e0388(0x225)]!=0xc8){if(_0x4e2481['status']==0x191){var _0x3da706=await dpRefreshToken();if(!_0x3da706)throw _0x5e0388(0x21b);continue;}else throw _0x5e0388(0x1e3)+_0x4e2481['status'];}const _0x3d8e5b=new File([await _0x4e2481[_0x5e0388(0x1da)]()],_0x24dd83);return console['log'](_0x5e0388(0x1fa),_0x3d8e5b[_0x5e0388(0x1e6)]),a0_0x268b06[_0x5e0388(0x22d)](_0x3d8e5b,()=>{var _0x5c32ee=_0x5e0388;localStorageFile(),Module[_0x5c32ee(0x21d)]();}),_0x3d8e5b;}return![];}document['addEventListener'](a0_0x57892b(0x226),function(){var _0x1235f8=a0_0x57892b;dropboxRestore['addEventListener'](_0x1235f8(0x1fc),async function(){var _0xa1387a=_0x1235f8;await lockNoti(_0xa1387a(0x222),'',0x1388);const _0x27d524=localStorage[_0xa1387a(0x21c)](_0xa1387a(0x212)),_0x6203b0=[_0xa1387a(0x1e1),_0xa1387a(0x214),_0xa1387a(0x21f)];if(!_0x27d524){window[_0xa1387a(0x1f5)](_0xa1387a(0x1f2));return;}let _0x115130=[];for(const _0x7bd8df of _0x6203b0){let _0x2877c0={'path':'/'+_0x27d524+'/'+_0x7bd8df};for(let _0x35b0f2=0x0;_0x35b0f2<0x2;_0x35b0f2++){let _0x32073e=await fetch(_0xa1387a(0x203),{'method':_0xa1387a(0x200),'headers':{'Authorization':_0xa1387a(0x1ef)+localStorage[_0xa1387a(0x21c)](_0xa1387a(0x207)),'Content-Type':_0xa1387a(0x230)},'body':JSON['stringify'](_0x2877c0)});if(_0x32073e[_0xa1387a(0x225)]===0xc8){let _0x32365c=await _0x32073e[_0xa1387a(0x1e4)](),_0x4f9964=_0x32365c['entries']['filter'](_0x49a806=>_0x49a806['.tag']===_0xa1387a(0x201));_0x4f9964['length']>0x0&&_0x115130[_0xa1387a(0x229)](..._0x4f9964[_0xa1387a(0x20a)](_0xcd9dee=>({'name':_0xcd9dee[_0xa1387a(0x1e6)],'folder':_0x7bd8df})));break;}else{if(_0x32073e[_0xa1387a(0x225)]===0x191){let _0x504d3e=await dpRefreshToken();if(!_0x504d3e)throw _0xa1387a(0x21b);}else{console['error']('Download\x20failed\x20for\x20'+_0x7bd8df+_0xa1387a(0x231)+_0x32073e['status']);break;}}}}if(_0x115130['length']>0x0){const _0x1f0750=_0xa1387a(0x20f)+_0x115130[_0xa1387a(0x208)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x1f0750))for(const _0x112b76 of _0x115130){await lockNoti('Restoring...',_0x112b76[_0xa1387a(0x1e6)],0xbb8),await dpDownloadFile(_0x112b76['name'],_0x112b76[_0xa1387a(0x1de)]);}else console[_0xa1387a(0x1f6)]('Restore\x20canceled\x20by\x20user.');}else console[_0xa1387a(0x1f6)](_0xa1387a(0x1f7));}),dropboxBackup[_0x1235f8(0x1d1)](_0x1235f8(0x1fc),async function(){var _0x1c7bbe=_0x1235f8;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4943b6=localStorage['getItem'](_0x1c7bbe(0x212));if(_0x4943b6===null||_0x4943b6==='')window['alert'](_0x1c7bbe(0x1f2));else{const _0x5cf504=[_0x1c7bbe(0x1e1),_0x1c7bbe(0x214),_0x1c7bbe(0x21f)];for(const _0xa85095 of _0x5cf504){await dpCreateFolder(_0xa85095);}let _0xb310e9=0x0;for(const _0x2ae7a1 of _0x5cf504){const _0x40f565=a0_0x268b06['list'+(_0x2ae7a1[_0x1c7bbe(0x205)](0x0)[_0x1c7bbe(0x1e7)]()+_0x2ae7a1[_0x1c7bbe(0x206)](0x1))]();_0xb310e9+=_0x40f565[_0x1c7bbe(0x208)];}if(window[_0x1c7bbe(0x1f1)](_0x1c7bbe(0x22c)+_0xb310e9+_0x1c7bbe(0x1d3)))for(const _0x3daf58 of _0x5cf504){const _0x3d37aa=a0_0x268b06[_0x1c7bbe(0x1d8)+(_0x3daf58['charAt'](0x0)['toUpperCase']()+_0x3daf58['slice'](0x1))]();for(const _0x46bb3a of _0x3d37aa){const _0x392dca=await a0_0x268b06[_0x1c7bbe(0x1fb)]('/data/'+_0x3daf58+'s/'+_0x46bb3a);try{await lockNoti('Backing\x20up...',_0x46bb3a,0xbb8),await dpUploadFile(_0x46bb3a,_0x392dca,_0x3daf58);}catch(_0x4cf93f){console[_0x1c7bbe(0x202)](_0x1c7bbe(0x1d6)+_0x46bb3a+':',_0x4cf93f);}}}else console[_0x1c7bbe(0x1f6)](_0x1c7bbe(0x209));}}),dropboxCloud['addEventListener']('click',function(){var _0x59841e=_0x1235f8;const _0x6ab974=localStorage[_0x59841e(0x21c)](_0x59841e(0x212));_0x6ab974===null||_0x6ab974===''?authorizeWithDropbox():window[_0x59841e(0x1f1)](_0x59841e(0x215))&&(localStorage[_0x59841e(0x1ea)](_0x59841e(0x212),''),dropboxRestore[_0x59841e(0x223)]['remove'](_0x59841e(0x217)),dropboxBackup[_0x59841e(0x223)][_0x59841e(0x22b)](_0x59841e(0x217)),dropboxCloud[_0x59841e(0x223)]['remove'](_0x59841e(0x217)));}),handleDropboxCallback();});