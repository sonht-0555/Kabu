function a0_0x8822(){var _0x5afbf2=['Unable\x20to\x20refresh\x20token','Failed\x20to\x20refresh\x20Dropbox\x20token.','entries','38163QaPnTX','&token_access_type=','&redirect_uri=','active','636924rLJXqE','alert','state','&grant_type=','Content-Type','refreshToken','click','Failed\x20to\x20upload\x20file\x20','application/json','Bearer\x20','=([^&#]*)','[\x5c?&#]','Restoring...','https://api.dropboxapi.com/2/files/list_folder','.tag','Kabu\x20storage\x20↦\x20Cloud\x20◆','knh3uz2mx2hp2eu','Error\x20creating\x20folder\x20','Wait\x20a\x20little\x20bit...','&response_type=','open','stringify','setRequestHeader','confirm','723830iHOmGv','code=','Do\x20you\x20want\x20to\x20logout?','send','uId','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','code','Cloud\x20login\x20required!','parse','error','8pwfURB','DOMContentLoaded','access_token','6dRHebZ','href','3657951XAIQXZ','authorization_code','11KDsrnj','listFiles','replace','status','Backing\x20up...','Refreshing\x20token...','split','&client_id=','Do\x20you\x20want\x20to\x20backup\x20','downloadFileInCloud','POST','uploadFileInCloud','Error\x20while\x20refreshing\x20token:','Restore\x20canceled\x20by\x20user.','location','classList','folder','\x20files\x20in\x20Kabu?','push','screenshot','https://content.dropboxapi.com/2/files/upload','getItem','offline','overwrite','application/octet-stream','No\x20refresh\x20token','onload','uid','length','addEventListener','781945RslShx','setItem','https://www.dropbox.com/oauth2/authorize?client_id=','search','&client_secret=','responseText','Do\x20you\x20want\x20to\x20restore\x20','2718JkzkmF','\x20files\x20from\x20Cloud?','Cloud\x20↦\x20Kabu\x20storage\x20◆','accessToken','name','https://api.dropboxapi.com/oauth2/token','Do\x20not\x20receive\x20authorization','blob','json','save','1213416buZLgb','8505hGGfBb','log','remove','299SEdxjc','nwb3dnfh09rhs31','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','4MUKzqo'];a0_0x8822=function(){return _0x5afbf2;};return a0_0x8822();}var a0_0x381b78=a0_0x3ac9;(function(_0x416059,_0x1aab07){var _0x465a2d=a0_0x3ac9,_0xbd0f11=_0x416059();while(!![]){try{var _0x37e547=-parseInt(_0x465a2d(0x1d3))/0x1*(-parseInt(_0x465a2d(0x1fc))/0x2)+parseInt(_0x465a2d(0x1c8))/0x3+parseInt(_0x465a2d(0x1cf))/0x4*(parseInt(_0x465a2d(0x21e))/0x5)+parseInt(_0x465a2d(0x1be))/0x6*(parseInt(_0x465a2d(0x1c9))/0x7)+-parseInt(_0x465a2d(0x1f9))/0x8*(-parseInt(_0x465a2d(0x1fe))/0x9)+parseInt(_0x465a2d(0x1ef))/0xa*(-parseInt(_0x465a2d(0x200))/0xb)+parseInt(_0x465a2d(0x1d7))/0xc*(-parseInt(_0x465a2d(0x1cc))/0xd);if(_0x37e547===_0x1aab07)break;else _0xbd0f11['push'](_0xbd0f11['shift']());}catch(_0x46a762){_0xbd0f11['push'](_0xbd0f11['shift']());}}}(a0_0x8822,0x52c56));import*as a0_0x284f93 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x381b78(0x1e7),clientSecret=a0_0x381b78(0x1cd);function a0_0x3ac9(_0x222182,_0x44b287){var _0x882230=a0_0x8822();return a0_0x3ac9=function(_0x3ac996,_0x578f40){_0x3ac996=_0x3ac996-0x1ba;var _0x2bf2f7=_0x882230[_0x3ac996];return _0x2bf2f7;},a0_0x3ac9(_0x222182,_0x44b287);}function authorizeWithDropbox(){var _0x4754ef=a0_0x381b78,_0x3edd99=window[_0x4754ef(0x20e)][_0x4754ef(0x1fd)][_0x4754ef(0x206)]('?')[0x0],_0x3f59ca=_0x4754ef(0x1f5),_0x3086e7=_0x4754ef(0x216),_0x528443=_0x4754ef(0x220)+clientId+_0x4754ef(0x1ea)+_0x3f59ca+_0x4754ef(0x1d4)+_0x3086e7+_0x4754ef(0x1d5)+encodeURIComponent(_0x3edd99);window['location']['href']=_0x528443;}function handleDropboxCallback(){var _0x526c25=a0_0x381b78,_0x26a2a1=getUrlParameter(_0x526c25(0x1f5));_0x26a2a1?(getAccessToken(_0x26a2a1),console['log']('Authorization\x20Code:',_0x26a2a1)):console['log'](_0x526c25(0x1c4));}function getUrlParameter(_0x4c6b9c){var _0x3245b8=a0_0x381b78;_0x4c6b9c=_0x4c6b9c[_0x3245b8(0x202)](/[\[]/,'\x5c[')[_0x3245b8(0x202)](/[\]]/,'\x5c]');var _0x375d50=new RegExp(_0x3245b8(0x1e2)+_0x4c6b9c+_0x3245b8(0x1e1)),_0x5dba1a=_0x375d50['exec'](location[_0x3245b8(0x1ba)]);return _0x5dba1a===null?'':decodeURIComponent(_0x5dba1a[0x1][_0x3245b8(0x202)](/\+/g,'\x20'));}function getAccessToken(_0x1770be){var _0x3a1ec8=a0_0x381b78,_0x5b9033=_0x3a1ec8(0x1ff),_0x215168=window[_0x3a1ec8(0x20e)][_0x3a1ec8(0x1fd)][_0x3a1ec8(0x206)]('?')[0x0],_0x2403bc=new XMLHttpRequest();_0x2403bc[_0x3a1ec8(0x1eb)](_0x3a1ec8(0x20a),'https://api.dropbox.com/oauth2/token'),_0x2403bc[_0x3a1ec8(0x1ed)](_0x3a1ec8(0x1db),'application/x-www-form-urlencoded'),_0x2403bc[_0x3a1ec8(0x21a)]=function(){var _0x57c784=_0x3a1ec8;if(_0x2403bc[_0x57c784(0x203)]===0xc8){var _0x2e234d=JSON[_0x57c784(0x1f7)](_0x2403bc[_0x57c784(0x1bc)]),_0x3bef39=_0x2e234d[_0x57c784(0x1fb)],_0x1ce8f3=_0x2e234d['refresh_token'],_0x5baead=_0x2e234d[_0x57c784(0x21b)];localStorage[_0x57c784(0x21f)](_0x57c784(0x1c1),_0x3bef39),localStorage['setItem'](_0x57c784(0x1dc),_0x1ce8f3),localStorage[_0x57c784(0x21f)](_0x57c784(0x1f3),_0x5baead);}else console['log'](_0x57c784(0x1f4));},_0x2403bc[_0x3a1ec8(0x1f2)](_0x3a1ec8(0x1f0)+_0x1770be+_0x3a1ec8(0x1da)+_0x5b9033+_0x3a1ec8(0x207)+clientId+_0x3a1ec8(0x1bb)+clientSecret+_0x3a1ec8(0x1d5)+encodeURIComponent(_0x215168));}export async function dpCreateFolder(_0x489b24){var _0x218b24=a0_0x381b78;const _0x24bdd1=localStorage['getItem']('uId');let _0x566a8c=localStorage[_0x218b24(0x215)]('accessToken');const _0x48551d='/'+_0x24bdd1+'/'+_0x489b24,_0x1f7399=JSON[_0x218b24(0x1ec)]({'path':_0x48551d,'autorename':![]});for(let _0x3f9d2a=0x0;_0x3f9d2a<0x2;_0x3f9d2a++){try{const _0x4155eb=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x218b24(0x20a),'headers':{'Authorization':_0x218b24(0x1e0)+_0x566a8c,'Content-Type':_0x218b24(0x1df)},'body':_0x1f7399});if(_0x4155eb[_0x218b24(0x203)]===0x191){const _0x20660e=await dpRefreshToken();if(!_0x20660e)throw new Error(_0x218b24(0x1d0));_0x566a8c=localStorage[_0x218b24(0x215)](_0x218b24(0x1c1));continue;}if(_0x4155eb[_0x218b24(0x203)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x489b24};if(!_0x4155eb['ok'])throw new Error(_0x218b24(0x1e8)+_0x489b24);const _0x3dd57d=await _0x4155eb[_0x218b24(0x1c6)]();return await lockNoti('Folder\x20created','',0xbb8),_0x3dd57d;}catch(_0x53eb6e){if(_0x3f9d2a===0x1)throw _0x53eb6e;}}return![];}export async function dpRefreshToken(){var _0x4878d5=a0_0x381b78;if(!localStorage[_0x4878d5(0x215)](_0x4878d5(0x1dc)))throw _0x4878d5(0x219);try{const _0x234d91=await fetch(_0x4878d5(0x1c3),{'method':_0x4878d5(0x20a),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0x4878d5(0x215)]('refreshToken')+_0x4878d5(0x1ce)}),_0x469d7e=await _0x234d91[_0x4878d5(0x1c6)]();if(!_0x469d7e[_0x4878d5(0x1f8)])return localStorage['setItem'](_0x4878d5(0x1c1),_0x469d7e[_0x4878d5(0x1fb)]),await lockNoti(_0x4878d5(0x205),'',0xbb8),await delay(0x3e8),!![];else alert(_0x469d7e['error_description']||_0x4878d5(0x1d1));}catch(_0x57087b){console[_0x4878d5(0x1f8)](_0x4878d5(0x20c),_0x57087b);}return![];}export async function dpUploadFile(_0x10aeda,_0xf8b229,_0x4fb600){var _0x515c4e=a0_0x381b78;const _0x585ecf=localStorage[_0x515c4e(0x215)](_0x515c4e(0x1f3));var _0x4f6989=JSON['stringify']({'autorename':!![],'mode':_0x515c4e(0x217),'mute':!![],'strict_conflict':![],'path':'/'+_0x585ecf+'/'+_0x4fb600+'/'+_0x10aeda}),_0x34bbbd=new Blob([_0xf8b229],{'type':_0x515c4e(0x218)});for(var _0x2e9241=0x0;_0x2e9241<0x2;_0x2e9241++){var _0x3d972e=await fetch(_0x515c4e(0x214),{'method':_0x515c4e(0x20a),'headers':{'Authorization':_0x515c4e(0x1e0)+localStorage[_0x515c4e(0x215)]('accessToken'),'Dropbox-API-Arg':_0x4f6989,'Content-Type':_0x515c4e(0x218)},'body':_0x34bbbd});if(_0x3d972e[_0x515c4e(0x203)]!=0xc8){if(_0x3d972e[_0x515c4e(0x203)]==0x191){var _0x473b60=await dpRefreshToken();if(!_0x473b60)throw _0x515c4e(0x1d0);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3d972e[_0x515c4e(0x203)];}else{var _0xf0e4ed=await _0x3d972e[_0x515c4e(0x1c6)]();return console['log'](_0x515c4e(0x1e6),_0x10aeda),_0xf0e4ed;}}return![];}export async function dpDownloadFile(_0xce7ca7,_0x38af29){var _0x136b15=a0_0x381b78;const _0x16b222=localStorage[_0x136b15(0x215)](_0x136b15(0x1f3));var _0x13cad3=JSON[_0x136b15(0x1ec)]({'path':'/'+_0x16b222+'/'+_0x38af29+'/'+_0xce7ca7});for(var _0x3ef370=0x0;_0x3ef370<0x2;_0x3ef370++){var _0x1cf547=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x136b15(0x20a),'headers':{'Authorization':_0x136b15(0x1e0)+localStorage[_0x136b15(0x215)]('accessToken'),'Dropbox-API-Arg':_0x13cad3}});if(_0x1cf547[_0x136b15(0x203)]!=0xc8){if(_0x1cf547[_0x136b15(0x203)]==0x191){var _0x575da6=await dpRefreshToken();if(!_0x575da6)throw _0x136b15(0x1d0);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x1cf547[_0x136b15(0x203)];}const _0x11241a=new File([await _0x1cf547[_0x136b15(0x1c5)]()],_0xce7ca7);return console['log'](_0x136b15(0x1c0),_0x11241a[_0x136b15(0x1c2)]),a0_0x284f93[_0x136b15(0x20b)](_0x11241a,()=>{}),_0x11241a;}return![];}document[a0_0x381b78(0x21d)](a0_0x381b78(0x1fa),function(){var _0x3c86c9=a0_0x381b78;dropboxRestore[_0x3c86c9(0x21d)](_0x3c86c9(0x1dd),async function(){var _0x9f8109=_0x3c86c9;await lockNoti(_0x9f8109(0x1e9),'',0x1388);const _0x510dc9=localStorage['getItem'](_0x9f8109(0x1f3)),_0x1fa209=[_0x9f8109(0x1d9),'save','screenshot'];if(!_0x510dc9){window[_0x9f8109(0x1d8)](_0x9f8109(0x1f6));return;}let _0x5387b5=[];for(const _0x4d6f5a of _0x1fa209){let _0x1b35c9={'path':'/'+_0x510dc9+'/'+_0x4d6f5a};for(let _0x1bd1b0=0x0;_0x1bd1b0<0x2;_0x1bd1b0++){let _0x2c51e9=await fetch(_0x9f8109(0x1e4),{'method':'POST','headers':{'Authorization':_0x9f8109(0x1e0)+localStorage[_0x9f8109(0x215)](_0x9f8109(0x1c1)),'Content-Type':_0x9f8109(0x1df)},'body':JSON['stringify'](_0x1b35c9)});if(_0x2c51e9[_0x9f8109(0x203)]===0xc8){let _0x4f358f=await _0x2c51e9[_0x9f8109(0x1c6)](),_0x190c7a=_0x4f358f[_0x9f8109(0x1d2)]['filter'](_0x28002a=>_0x28002a[_0x9f8109(0x1e5)]==='file');_0x190c7a[_0x9f8109(0x21c)]>0x0&&_0x5387b5[_0x9f8109(0x212)](..._0x190c7a['map'](_0x466d48=>({'name':_0x466d48[_0x9f8109(0x1c2)],'folder':_0x4d6f5a})));break;}else{if(_0x2c51e9[_0x9f8109(0x203)]===0x191){let _0x5d75fe=await dpRefreshToken();if(!_0x5d75fe)throw _0x9f8109(0x1d0);}else{console[_0x9f8109(0x1f8)]('Download\x20failed\x20for\x20'+_0x4d6f5a+',\x20status:\x20'+_0x2c51e9[_0x9f8109(0x203)]);break;}}}}if(_0x5387b5[_0x9f8109(0x21c)]>0x0){const _0x40bee2=_0x9f8109(0x1bd)+_0x5387b5[_0x9f8109(0x21c)]+_0x9f8109(0x1bf);if(window[_0x9f8109(0x1ee)](_0x40bee2))for(const _0x205f25 of _0x5387b5){await lockNoti(_0x9f8109(0x1e3),_0x205f25[_0x9f8109(0x1c2)],0xbb8),await dpDownloadFile(_0x205f25['name'],_0x205f25[_0x9f8109(0x210)]);}else console[_0x9f8109(0x1ca)](_0x9f8109(0x20d));}else console[_0x9f8109(0x1ca)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x3c86c9(0x21d)]('click',async function(){var _0xe7da20=_0x3c86c9;await lockNoti(_0xe7da20(0x1e9),'',0x1388);const _0x201f98=localStorage[_0xe7da20(0x215)]('uId');if(_0x201f98===null||_0x201f98==='')window['alert'](_0xe7da20(0x1f6));else{const _0x2b293b=[_0xe7da20(0x1d9),_0xe7da20(0x1c7),_0xe7da20(0x213)];for(const _0x80fde1 of _0x2b293b){await dpCreateFolder(_0x80fde1);}let _0x71ca19=0x0;for(const _0x3c8245 of _0x2b293b){const _0x1c0624=a0_0x284f93[_0xe7da20(0x201)](_0x3c8245+'s');_0x71ca19+=_0x1c0624[_0xe7da20(0x21c)];}if(window[_0xe7da20(0x1ee)](_0xe7da20(0x208)+_0x71ca19+_0xe7da20(0x211)))for(const _0x452adc of _0x2b293b){const _0x3060d6=a0_0x284f93[_0xe7da20(0x201)](_0x452adc+'s');for(const _0x415992 of _0x3060d6){const _0x1f04fd=await a0_0x284f93[_0xe7da20(0x209)]('/data/'+_0x452adc+'s/'+_0x415992);try{await lockNoti(_0xe7da20(0x204),_0x415992,0xbb8),await dpUploadFile(_0x415992,_0x1f04fd,_0x452adc);}catch(_0x2293bd){console[_0xe7da20(0x1f8)](_0xe7da20(0x1de)+_0x415992+':',_0x2293bd);}}}else console[_0xe7da20(0x1ca)](_0xe7da20(0x20d));}}),dropboxCloud['addEventListener'](_0x3c86c9(0x1dd),function(){var _0x953cba=_0x3c86c9;const _0x16e89b=localStorage[_0x953cba(0x215)](_0x953cba(0x1f3));_0x16e89b===null||_0x16e89b===''?authorizeWithDropbox():window[_0x953cba(0x1ee)](_0x953cba(0x1f1))&&(localStorage[_0x953cba(0x21f)](_0x953cba(0x1f3),''),dropboxRestore[_0x953cba(0x20f)][_0x953cba(0x1cb)](_0x953cba(0x1d6)),dropboxBackup[_0x953cba(0x20f)][_0x953cba(0x1cb)]('active'),dropboxCloud[_0x953cba(0x20f)][_0x953cba(0x1cb)]('active'));}),handleDropboxCallback();});