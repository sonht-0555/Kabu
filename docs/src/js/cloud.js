var a0_0x711155=a0_0xc135;function a0_0xc135(_0x9bf248,_0x42d505){var _0x82d6bc=a0_0x82d6();return a0_0xc135=function(_0xc135fd,_0x521ba3){_0xc135fd=_0xc135fd-0x1ec;var _0xe99705=_0x82d6bc[_0xc135fd];return _0xe99705;},a0_0xc135(_0x9bf248,_0x42d505);}(function(_0x2dafb8,_0x4e1f8a){var _0x207113=a0_0xc135,_0x2f030d=_0x2dafb8();while(!![]){try{var _0x3457ec=parseInt(_0x207113(0x22a))/0x1+-parseInt(_0x207113(0x1ef))/0x2+-parseInt(_0x207113(0x209))/0x3+-parseInt(_0x207113(0x231))/0x4*(-parseInt(_0x207113(0x21d))/0x5)+-parseInt(_0x207113(0x205))/0x6+-parseInt(_0x207113(0x238))/0x7+parseInt(_0x207113(0x249))/0x8*(parseInt(_0x207113(0x22f))/0x9);if(_0x3457ec===_0x4e1f8a)break;else _0x2f030d['push'](_0x2f030d['shift']());}catch(_0x48f086){_0x2f030d['push'](_0x2f030d['shift']());}}}(a0_0x82d6,0xb1635));function a0_0x82d6(){var _0x247a6f=['application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20logout?','&client_secret=','/data/','Cloud\x20↦\x20Kabu\x20storage\x20◆','Upload\x20failed,\x20unknown\x20http\x20status:\x20','href','remove','https://api.dropboxapi.com/2/files/create_folder_v2','onload','220128RfyHbM','send','Restore\x20canceled\x20by\x20user.','=([^&#]*)','Bearer\x20','listFiles','addEventListener','length','exec','error','1800822nXKnxZ','[\x5c?&#]','getItem','stringify','Kabu\x20storage\x20↦\x20Cloud\x20◆','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Folder\x20already\x20exists','&redirect_uri=','code=','overwrite','replace','Error\x20while\x20refreshing\x20token:','split','No\x20refresh\x20token','error_description','refresh_token','nwb3dnfh09rhs31','POST','state','name','push','alert','8604264LxshcY','confirm','&token_access_type=','log','3763239WHPAmI','setItem','classList','Download\x20failed,\x20unknown\x20http\x20status:','Do\x20not\x20receive\x20authorization','screenshot','click','offline','Failed\x20to\x20refresh\x20Dropbox\x20token.','.tag','code','downloadFileInCloud','Backing\x20up...','blob','Authorization\x20Code:','uId','status','\x20files\x20from\x20Cloud?','&client_id=','Failed\x20to\x20upload\x20file\x20','45KeIPWx','setRequestHeader','Cloud\x20login\x20required!','filter','application/octet-stream','search','https://api.dropboxapi.com/oauth2/token','Restoring...','https://www.dropbox.com/oauth2/authorize?client_id=','DOMContentLoaded','json','https://content.dropboxapi.com/2/files/download','https://api.dropbox.com/oauth2/token','1110282NmGnlG',',\x20status:\x20','https://api.dropboxapi.com/2/files/list_folder','Content-Type','authorization_code','954VcnrZN','folder','521104juQEnC','Unable\x20to\x20refresh\x20token','active','https://content.dropboxapi.com/2/files/upload','location','access_token','knh3uz2mx2hp2eu','6188091sWOsMY','uploadFileInCloud','refreshToken','parse','entries','save','accessToken'];a0_0x82d6=function(){return _0x247a6f;};return a0_0x82d6();}import*as a0_0x430025 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x711155(0x237),clientSecret=a0_0x711155(0x1ff);function authorizeWithDropbox(){var _0x46920a=a0_0x711155,_0x35a6de=window[_0x46920a(0x235)][_0x46920a(0x245)]['split']('?')[0x0],_0x2a4049=_0x46920a(0x213),_0x179f9d=_0x46920a(0x210),_0x369f65=_0x46920a(0x225)+clientId+'&response_type='+_0x2a4049+_0x46920a(0x207)+_0x179f9d+_0x46920a(0x1f6)+encodeURIComponent(_0x35a6de);window['location'][_0x46920a(0x245)]=_0x369f65;}function handleDropboxCallback(){var _0x2db8a3=a0_0x711155,_0x3988b2=getUrlParameter('code');_0x3988b2?(getAccessToken(_0x3988b2),console['log'](_0x2db8a3(0x217),_0x3988b2)):console[_0x2db8a3(0x208)](_0x2db8a3(0x20d));}function getUrlParameter(_0x24bdd5){var _0x3be8f7=a0_0x711155;_0x24bdd5=_0x24bdd5[_0x3be8f7(0x1f9)](/[\[]/,'\x5c[')[_0x3be8f7(0x1f9)](/[\]]/,'\x5c]');var _0x328ecd=new RegExp(_0x3be8f7(0x1f0)+_0x24bdd5+_0x3be8f7(0x24c)),_0x407686=_0x328ecd[_0x3be8f7(0x1ed)](location[_0x3be8f7(0x222)]);return _0x407686===null?'':decodeURIComponent(_0x407686[0x1][_0x3be8f7(0x1f9)](/\+/g,'\x20'));}function getAccessToken(_0x5be77d){var _0x286a47=a0_0x711155,_0x1dd3d2=_0x286a47(0x22e),_0x40ec2e=window[_0x286a47(0x235)][_0x286a47(0x245)][_0x286a47(0x1fb)]('?')[0x0],_0xbff400=new XMLHttpRequest();_0xbff400['open']('POST',_0x286a47(0x229)),_0xbff400[_0x286a47(0x21e)](_0x286a47(0x22d),_0x286a47(0x23f)),_0xbff400[_0x286a47(0x248)]=function(){var _0x5046bb=_0x286a47;if(_0xbff400[_0x5046bb(0x219)]===0xc8){var _0x49259f=JSON[_0x5046bb(0x23b)](_0xbff400['responseText']),_0x352708=_0x49259f[_0x5046bb(0x236)],_0x447ed8=_0x49259f[_0x5046bb(0x1fe)],_0x5256ef=_0x49259f['uid'];localStorage['setItem']('accessToken',_0x352708),localStorage[_0x5046bb(0x20a)](_0x5046bb(0x23a),_0x447ed8),localStorage['setItem'](_0x5046bb(0x218),_0x5256ef);}else console[_0x5046bb(0x208)](_0x5046bb(0x1f4));},_0xbff400[_0x286a47(0x24a)](_0x286a47(0x1f7)+_0x5be77d+'&grant_type='+_0x1dd3d2+_0x286a47(0x21b)+clientId+_0x286a47(0x241)+clientSecret+_0x286a47(0x1f6)+encodeURIComponent(_0x40ec2e));}export async function dpCreateFolder(_0x58eb75){var _0xe64178=a0_0x711155;const _0x2966d8=localStorage[_0xe64178(0x1f1)](_0xe64178(0x218));let _0x1d6b76=localStorage[_0xe64178(0x1f1)](_0xe64178(0x23e));const _0x5bf60a='/'+_0x2966d8+'/'+_0x58eb75,_0x598c32=JSON['stringify']({'path':_0x5bf60a,'autorename':![]});for(let _0x6fcc8e=0x0;_0x6fcc8e<0x2;_0x6fcc8e++){try{const _0x132482=await fetch(_0xe64178(0x247),{'method':_0xe64178(0x200),'headers':{'Authorization':_0xe64178(0x24d)+_0x1d6b76,'Content-Type':'application/json'},'body':_0x598c32});if(_0x132482[_0xe64178(0x219)]===0x191){const _0x582a32=await dpRefreshToken();if(!_0x582a32)throw new Error(_0xe64178(0x232));_0x1d6b76=localStorage['getItem'](_0xe64178(0x23e));continue;}if(_0x132482[_0xe64178(0x219)]===0x199)return{'message':_0xe64178(0x1f5),'path':_0x58eb75};if(!_0x132482['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x58eb75);const _0x1677b0=await _0x132482['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x1677b0;}catch(_0x1fe2b1){if(_0x6fcc8e===0x1)throw _0x1fe2b1;}}return![];}export async function dpRefreshToken(){var _0x34bf67=a0_0x711155;if(!localStorage['getItem'](_0x34bf67(0x23a)))throw _0x34bf67(0x1fc);try{const _0xf686f9=await fetch(_0x34bf67(0x223),{'method':_0x34bf67(0x200),'headers':{'Content-Type':_0x34bf67(0x23f)},'body':'refresh_token='+localStorage[_0x34bf67(0x1f1)](_0x34bf67(0x23a))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x15c34e=await _0xf686f9['json']();if(!_0x15c34e[_0x34bf67(0x1ee)])return localStorage[_0x34bf67(0x20a)](_0x34bf67(0x23e),_0x15c34e[_0x34bf67(0x236)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x15c34e[_0x34bf67(0x1fd)]||_0x34bf67(0x211));}catch(_0x1f0eb7){console['error'](_0x34bf67(0x1fa),_0x1f0eb7);}return![];}export async function dpUploadFile(_0x17dc98,_0x5cb9e2,_0x31c379){var _0x4216ea=a0_0x711155;const _0x4a750d=localStorage[_0x4216ea(0x1f1)](_0x4216ea(0x218));var _0x1b2299=JSON[_0x4216ea(0x1f2)]({'autorename':!![],'mode':_0x4216ea(0x1f8),'mute':!![],'strict_conflict':![],'path':'/'+_0x4a750d+'/'+_0x31c379+'/'+_0x17dc98}),_0x1624f7=new Blob([_0x5cb9e2],{'type':'application/octet-stream'});for(var _0x1db82e=0x0;_0x1db82e<0x2;_0x1db82e++){var _0xc667a1=await fetch(_0x4216ea(0x234),{'method':_0x4216ea(0x200),'headers':{'Authorization':_0x4216ea(0x24d)+localStorage[_0x4216ea(0x1f1)](_0x4216ea(0x23e)),'Dropbox-API-Arg':_0x1b2299,'Content-Type':_0x4216ea(0x221)},'body':_0x1624f7});if(_0xc667a1['status']!=0xc8){if(_0xc667a1[_0x4216ea(0x219)]==0x191){var _0x28be66=await dpRefreshToken();if(!_0x28be66)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4216ea(0x244)+_0xc667a1[_0x4216ea(0x219)];}else{var _0x268df3=await _0xc667a1[_0x4216ea(0x227)]();return console[_0x4216ea(0x208)](_0x4216ea(0x1f3),_0x17dc98),_0x268df3;}}return![];}export async function dpDownloadFile(_0x3e5a48,_0x49491f){var _0x5d76f8=a0_0x711155;const _0x59f4a8=localStorage[_0x5d76f8(0x1f1)]('uId');var _0x2372bc=JSON[_0x5d76f8(0x1f2)]({'path':'/'+_0x59f4a8+'/'+_0x49491f+'/'+_0x3e5a48});for(var _0x50d77b=0x0;_0x50d77b<0x2;_0x50d77b++){var _0x5381e0=await fetch(_0x5d76f8(0x228),{'method':_0x5d76f8(0x200),'headers':{'Authorization':_0x5d76f8(0x24d)+localStorage[_0x5d76f8(0x1f1)](_0x5d76f8(0x23e)),'Dropbox-API-Arg':_0x2372bc}});if(_0x5381e0[_0x5d76f8(0x219)]!=0xc8){if(_0x5381e0[_0x5d76f8(0x219)]==0x191){var _0x258919=await dpRefreshToken();if(!_0x258919)throw _0x5d76f8(0x232);continue;}else throw _0x5d76f8(0x20c)+_0x5381e0[_0x5d76f8(0x219)];}const _0x4e0513=new File([await _0x5381e0[_0x5d76f8(0x216)]()],_0x3e5a48);return console[_0x5d76f8(0x208)](_0x5d76f8(0x243),_0x4e0513[_0x5d76f8(0x202)]),a0_0x430025[_0x5d76f8(0x239)](_0x4e0513,()=>{}),_0x4e0513;}return![];}document['addEventListener'](a0_0x711155(0x226),function(){var _0x270b32=a0_0x711155;dropboxRestore[_0x270b32(0x24f)](_0x270b32(0x20f),async function(){var _0x2c5a39=_0x270b32;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1d7f2b=localStorage[_0x2c5a39(0x1f1)](_0x2c5a39(0x218)),_0x2ec69e=['state',_0x2c5a39(0x23d),_0x2c5a39(0x20e)];if(!_0x1d7f2b){window[_0x2c5a39(0x204)](_0x2c5a39(0x21f));return;}let _0x2e09d9=[];for(const _0x20c4f0 of _0x2ec69e){let _0x593fde={'path':'/'+_0x1d7f2b+'/'+_0x20c4f0};for(let _0x32694e=0x0;_0x32694e<0x2;_0x32694e++){let _0x573caf=await fetch(_0x2c5a39(0x22c),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Content-Type':'application/json'},'body':JSON['stringify'](_0x593fde)});if(_0x573caf['status']===0xc8){let _0x202e41=await _0x573caf[_0x2c5a39(0x227)](),_0x28904f=_0x202e41[_0x2c5a39(0x23c)][_0x2c5a39(0x220)](_0xd2c309=>_0xd2c309[_0x2c5a39(0x212)]==='file');_0x28904f['length']>0x0&&_0x2e09d9[_0x2c5a39(0x203)](..._0x28904f['map'](_0x57a628=>({'name':_0x57a628[_0x2c5a39(0x202)],'folder':_0x20c4f0})));break;}else{if(_0x573caf[_0x2c5a39(0x219)]===0x191){let _0x4a2009=await dpRefreshToken();if(!_0x4a2009)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x2c5a39(0x1ee)]('Download\x20failed\x20for\x20'+_0x20c4f0+_0x2c5a39(0x22b)+_0x573caf[_0x2c5a39(0x219)]);break;}}}}if(_0x2e09d9[_0x2c5a39(0x1ec)]>0x0){const _0x192d65='Do\x20you\x20want\x20to\x20restore\x20'+_0x2e09d9[_0x2c5a39(0x1ec)]+_0x2c5a39(0x21a);if(window[_0x2c5a39(0x206)](_0x192d65))for(const _0x5dc5c0 of _0x2e09d9){await lockNoti(_0x2c5a39(0x224),_0x5dc5c0[_0x2c5a39(0x202)],0xbb8),await dpDownloadFile(_0x5dc5c0[_0x2c5a39(0x202)],_0x5dc5c0[_0x2c5a39(0x230)]);}else console['log'](_0x2c5a39(0x24b));}else console[_0x2c5a39(0x208)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x270b32(0x24f)](_0x270b32(0x20f),async function(){var _0x199eb2=_0x270b32;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x896b6d=localStorage[_0x199eb2(0x1f1)]('uId');if(_0x896b6d===null||_0x896b6d==='')window[_0x199eb2(0x204)](_0x199eb2(0x21f));else{const _0x1b2ab7=[_0x199eb2(0x201),_0x199eb2(0x23d),_0x199eb2(0x20e)];for(const _0x35eb0e of _0x1b2ab7){await dpCreateFolder(_0x35eb0e);}let _0x4bab23=0x0;for(const _0x50b69b of _0x1b2ab7){const _0x398346=a0_0x430025[_0x199eb2(0x24e)](_0x50b69b+'s');_0x4bab23+=_0x398346[_0x199eb2(0x1ec)];}if(window[_0x199eb2(0x206)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4bab23+'\x20files\x20in\x20Kabu?'))for(const _0x3a6423 of _0x1b2ab7){const _0x4558d4=a0_0x430025[_0x199eb2(0x24e)](_0x3a6423+'s');for(const _0x95c732 of _0x4558d4){const _0x3ec228=await a0_0x430025[_0x199eb2(0x214)](_0x199eb2(0x242)+_0x3a6423+'s/'+_0x95c732);try{await lockNoti(_0x199eb2(0x215),_0x95c732,0xbb8),await dpUploadFile(_0x95c732,_0x3ec228,_0x3a6423);}catch(_0x49e6a2){console['error'](_0x199eb2(0x21c)+_0x95c732+':',_0x49e6a2);}}}else console[_0x199eb2(0x208)](_0x199eb2(0x24b));}}),dropboxCloud[_0x270b32(0x24f)](_0x270b32(0x20f),function(){var _0x5e0764=_0x270b32;const _0x23ef5f=localStorage[_0x5e0764(0x1f1)]('uId');_0x23ef5f===null||_0x23ef5f===''?authorizeWithDropbox():window[_0x5e0764(0x206)](_0x5e0764(0x240))&&(localStorage[_0x5e0764(0x20a)](_0x5e0764(0x218),''),dropboxRestore[_0x5e0764(0x20b)]['remove'](_0x5e0764(0x233)),dropboxBackup['classList'][_0x5e0764(0x246)](_0x5e0764(0x233)),dropboxCloud['classList'][_0x5e0764(0x246)](_0x5e0764(0x233)));}),handleDropboxCallback();});