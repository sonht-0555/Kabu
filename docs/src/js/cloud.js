var a0_0x580992=a0_0x155b;(function(_0x10774a,_0x24db79){var _0x42992c=a0_0x155b,_0x646ff7=_0x10774a();while(!![]){try{var _0xf0c6f=parseInt(_0x42992c(0xab))/0x1*(-parseInt(_0x42992c(0x102))/0x2)+-parseInt(_0x42992c(0xb1))/0x3*(-parseInt(_0x42992c(0xd2))/0x4)+-parseInt(_0x42992c(0xcd))/0x5+-parseInt(_0x42992c(0xb7))/0x6*(-parseInt(_0x42992c(0xc1))/0x7)+-parseInt(_0x42992c(0xe8))/0x8+parseInt(_0x42992c(0xc3))/0x9*(-parseInt(_0x42992c(0xd1))/0xa)+parseInt(_0x42992c(0xbb))/0xb*(parseInt(_0x42992c(0xba))/0xc);if(_0xf0c6f===_0x24db79)break;else _0x646ff7['push'](_0x646ff7['shift']());}catch(_0x5b31d0){_0x646ff7['push'](_0x646ff7['shift']());}}}(a0_0x2d10,0x6d80b));import*as a0_0x3b82f2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x580992(0xaf),clientSecret=a0_0x580992(0xea);function a0_0x2d10(){var _0x74a4c6=['Cloud\x20login\x20required!','status','code=','name','state','Cloud\x20↦\x20Kabu\x20storage\x20◆','application/json','code','refreshToken','Upload\x20failed,\x20unknown\x20http\x20status:\x20','addEventListener','parse','[\x5c?&#]','1fgupyr','Download\x20failed\x20for\x20','uId','Restore\x20canceled\x20by\x20user.','knh3uz2mx2hp2eu','json','15MakFrd','Authorization\x20Code:','Error\x20while\x20refreshing\x20token:','&response_type=','stringify','access_token','1285458sFeYzZ','overwrite','search','12IJDrAq','7764713oazqFN','https://content.dropboxapi.com/2/files/upload','application/octet-stream','classList','replace','Do\x20not\x20receive\x20authorization','21oLamyx','Refreshing\x20token...','9gzDwiu','Error\x20creating\x20folder\x20','offline','Restoring...','POST','\x20files\x20in\x20Kabu?','Backing\x20up...','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','error','log','3178820BSBtQx','alert','Failed\x20to\x20upload\x20file\x20','&token_access_type=','608880MtmzJp','281128hSYOry','=([^&#]*)','remove','Do\x20you\x20want\x20to\x20backup\x20','refresh_token=',',\x20status:\x20','blob','No\x20refresh\x20token','application/x-www-form-urlencoded','folder','push','click','https://content.dropboxapi.com/2/files/download','confirm','map','Kabu\x20storage\x20↦\x20Cloud\x20◆','downloadFileInCloud','split','Bearer\x20','&grant_type=','Wait\x20a\x20little\x20bit...','Content-Type','802720bQaVfy','length','nwb3dnfh09rhs31','setRequestHeader','https://api.dropboxapi.com/2/files/create_folder_v2','active','send','https://api.dropbox.com/oauth2/token','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/oauth2/token','Unable\x20to\x20refresh\x20token','screenshot','save','authorization_code','Failed\x20to\x20refresh\x20Dropbox\x20token.','getItem','setItem','Do\x20you\x20want\x20to\x20logout?','&client_id=','location','filter','error_description','listFiles','href','uploadFileInCloud','accessToken','909014wsXCnZ','https://www.dropbox.com/oauth2/authorize?client_id=','exec','&redirect_uri=','responseText'];a0_0x2d10=function(){return _0x74a4c6;};return a0_0x2d10();}function authorizeWithDropbox(){var _0xbe5b93=a0_0x580992,_0x33ad32=window[_0xbe5b93(0xfb)][_0xbe5b93(0xff)][_0xbe5b93(0xe3)]('?')[0x0],_0x7bb066=_0xbe5b93(0xa5),_0x1167c5=_0xbe5b93(0xc5),_0x645897=_0xbe5b93(0x103)+clientId+_0xbe5b93(0xb4)+_0x7bb066+_0xbe5b93(0xd0)+_0x1167c5+'&redirect_uri='+encodeURIComponent(_0x33ad32);window[_0xbe5b93(0xfb)][_0xbe5b93(0xff)]=_0x645897;}function handleDropboxCallback(){var _0x32e72c=a0_0x580992,_0x30328a=getUrlParameter(_0x32e72c(0xa5));_0x30328a?(getAccessToken(_0x30328a),console[_0x32e72c(0xcc)](_0x32e72c(0xb2),_0x30328a)):console['log'](_0x32e72c(0xc0));}function getUrlParameter(_0x351dfa){var _0x45dd31=a0_0x580992;_0x351dfa=_0x351dfa[_0x45dd31(0xbf)](/[\[]/,'\x5c[')[_0x45dd31(0xbf)](/[\]]/,'\x5c]');var _0x7e4d8a=new RegExp(_0x45dd31(0xaa)+_0x351dfa+_0x45dd31(0xd3)),_0x46e81d=_0x7e4d8a[_0x45dd31(0x9b)](location[_0x45dd31(0xb9)]);return _0x46e81d===null?'':decodeURIComponent(_0x46e81d[0x1][_0x45dd31(0xbf)](/\+/g,'\x20'));}function getAccessToken(_0x1f4ad5){var _0xd53c96=a0_0x580992,_0x4e73f9=_0xd53c96(0xf5),_0x1004ba=window[_0xd53c96(0xfb)][_0xd53c96(0xff)][_0xd53c96(0xe3)]('?')[0x0],_0xe14af=new XMLHttpRequest();_0xe14af['open']('POST',_0xd53c96(0xef)),_0xe14af[_0xd53c96(0xeb)](_0xd53c96(0xe7),'application/x-www-form-urlencoded'),_0xe14af['onload']=function(){var _0x2e3ddc=_0xd53c96;if(_0xe14af[_0x2e3ddc(0x9f)]===0xc8){var _0x12b4e0=JSON[_0x2e3ddc(0xa9)](_0xe14af[_0x2e3ddc(0x9d)]),_0x4cc7dd=_0x12b4e0[_0x2e3ddc(0xb6)],_0x2ce0e9=_0x12b4e0['refresh_token'],_0x4547db=_0x12b4e0['uid'];localStorage[_0x2e3ddc(0xf8)](_0x2e3ddc(0x101),_0x4cc7dd),localStorage[_0x2e3ddc(0xf8)]('refreshToken',_0x2ce0e9),localStorage['setItem'](_0x2e3ddc(0xad),_0x4547db);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0xe14af[_0xd53c96(0xee)](_0xd53c96(0xa0)+_0x1f4ad5+_0xd53c96(0xe5)+_0x4e73f9+_0xd53c96(0xfa)+clientId+'&client_secret='+clientSecret+_0xd53c96(0x9c)+encodeURIComponent(_0x1004ba));}export async function dpCreateFolder(_0x34c3ee){var _0x515d94=a0_0x580992;const _0x5aa81f=localStorage[_0x515d94(0xf7)](_0x515d94(0xad));let _0x3a6ab4=localStorage[_0x515d94(0xf7)](_0x515d94(0x101));const _0x374278='/'+_0x5aa81f+'/'+_0x34c3ee,_0x5037ef=JSON[_0x515d94(0xb5)]({'path':_0x374278,'autorename':![]});for(let _0x59cef0=0x0;_0x59cef0<0x2;_0x59cef0++){try{const _0x4440ea=await fetch(_0x515d94(0xec),{'method':_0x515d94(0xc7),'headers':{'Authorization':'Bearer\x20'+_0x3a6ab4,'Content-Type':_0x515d94(0xa4)},'body':_0x5037ef});if(_0x4440ea[_0x515d94(0x9f)]===0x191){const _0x3e6f48=await dpRefreshToken();if(!_0x3e6f48)throw new Error(_0x515d94(0xf2));_0x3a6ab4=localStorage[_0x515d94(0xf7)](_0x515d94(0x101));continue;}if(_0x4440ea['status']===0x199)return{'message':'Folder\x20already\x20exists','path':_0x34c3ee};if(!_0x4440ea['ok'])throw new Error(_0x515d94(0xc4)+_0x34c3ee);const _0x30b387=await _0x4440ea[_0x515d94(0xb0)]();return await lockNoti('Folder\x20created','',0xbb8),_0x30b387;}catch(_0x48c98b){if(_0x59cef0===0x1)throw _0x48c98b;}}return![];}export async function dpRefreshToken(){var _0x4bb1c5=a0_0x580992;if(!localStorage['getItem'](_0x4bb1c5(0xa6)))throw _0x4bb1c5(0xd9);try{const _0xf8e285=await fetch(_0x4bb1c5(0xf1),{'method':_0x4bb1c5(0xc7),'headers':{'Content-Type':_0x4bb1c5(0xda)},'body':_0x4bb1c5(0xd6)+localStorage[_0x4bb1c5(0xf7)](_0x4bb1c5(0xa6))+_0x4bb1c5(0xca)}),_0x79ff93=await _0xf8e285[_0x4bb1c5(0xb0)]();if(!_0x79ff93[_0x4bb1c5(0xcb)])return localStorage[_0x4bb1c5(0xf8)](_0x4bb1c5(0x101),_0x79ff93[_0x4bb1c5(0xb6)]),await lockNoti(_0x4bb1c5(0xc2),'',0xbb8),await delay(0x3e8),!![];else alert(_0x79ff93[_0x4bb1c5(0xfd)]||_0x4bb1c5(0xf6));}catch(_0x37d64d){console[_0x4bb1c5(0xcb)](_0x4bb1c5(0xb3),_0x37d64d);}return![];}export async function dpUploadFile(_0x5f020f,_0x121eaa,_0x33882d){var _0x15e042=a0_0x580992;const _0x119eff=localStorage[_0x15e042(0xf7)](_0x15e042(0xad));var _0x13e7b9=JSON[_0x15e042(0xb5)]({'autorename':!![],'mode':_0x15e042(0xb8),'mute':!![],'strict_conflict':![],'path':'/'+_0x119eff+'/'+_0x33882d+'/'+_0x5f020f}),_0x29901d=new Blob([_0x121eaa],{'type':_0x15e042(0xbd)});for(var _0x192fdb=0x0;_0x192fdb<0x2;_0x192fdb++){var _0x51158a=await fetch(_0x15e042(0xbc),{'method':_0x15e042(0xc7),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x15e042(0xf7)](_0x15e042(0x101)),'Dropbox-API-Arg':_0x13e7b9,'Content-Type':_0x15e042(0xbd)},'body':_0x29901d});if(_0x51158a[_0x15e042(0x9f)]!=0xc8){if(_0x51158a['status']==0x191){var _0x55c01a=await dpRefreshToken();if(!_0x55c01a)throw _0x15e042(0xf2);continue;}else throw _0x15e042(0xa7)+_0x51158a[_0x15e042(0x9f)];}else{var _0x12d07b=await _0x51158a[_0x15e042(0xb0)]();return console[_0x15e042(0xcc)](_0x15e042(0xe1),_0x5f020f),_0x12d07b;}}return![];}function a0_0x155b(_0x490355,_0x476f67){var _0x2d10b9=a0_0x2d10();return a0_0x155b=function(_0x155b63,_0x2c8d7c){_0x155b63=_0x155b63-0x9b;var _0x41cc74=_0x2d10b9[_0x155b63];return _0x41cc74;},a0_0x155b(_0x490355,_0x476f67);}export async function dpDownloadFile(_0x412f7b,_0x2ca3f4){var _0xef51f=a0_0x580992;const _0x52806f=localStorage[_0xef51f(0xf7)](_0xef51f(0xad));var _0x3ea067=JSON['stringify']({'path':'/'+_0x52806f+'/'+_0x2ca3f4+'/'+_0x412f7b});for(var _0x3d434a=0x0;_0x3d434a<0x2;_0x3d434a++){var _0x6ad6ca=await fetch(_0xef51f(0xde),{'method':_0xef51f(0xc7),'headers':{'Authorization':_0xef51f(0xe4)+localStorage[_0xef51f(0xf7)](_0xef51f(0x101)),'Dropbox-API-Arg':_0x3ea067}});if(_0x6ad6ca['status']!=0xc8){if(_0x6ad6ca[_0xef51f(0x9f)]==0x191){var _0x2319ff=await dpRefreshToken();if(!_0x2319ff)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x6ad6ca['status'];}const _0x48a7c7=new File([await _0x6ad6ca[_0xef51f(0xd8)]()],_0x412f7b);return console[_0xef51f(0xcc)](_0xef51f(0xa3),_0x48a7c7['name']),a0_0x3b82f2[_0xef51f(0x100)](_0x48a7c7,()=>{}),_0x48a7c7;}return![];}document[a0_0x580992(0xa8)]('DOMContentLoaded',function(){var _0x42eca1=a0_0x580992;dropboxRestore[_0x42eca1(0xa8)](_0x42eca1(0xdd),async function(){var _0x5f5ba5=_0x42eca1;await lockNoti(_0x5f5ba5(0xe6),'',0x1388);const _0x212b1b=localStorage[_0x5f5ba5(0xf7)](_0x5f5ba5(0xad)),_0x35f64=['state',_0x5f5ba5(0xf4),_0x5f5ba5(0xf3)];if(!_0x212b1b){window[_0x5f5ba5(0xce)](_0x5f5ba5(0x9e));return;}let _0x470e0c=[];for(const _0x14749e of _0x35f64){let _0x2f0c70={'path':'/'+_0x212b1b+'/'+_0x14749e};for(let _0x235f21=0x0;_0x235f21<0x2;_0x235f21++){let _0x1efddb=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x5f5ba5(0xc7),'headers':{'Authorization':_0x5f5ba5(0xe4)+localStorage[_0x5f5ba5(0xf7)](_0x5f5ba5(0x101)),'Content-Type':_0x5f5ba5(0xa4)},'body':JSON[_0x5f5ba5(0xb5)](_0x2f0c70)});if(_0x1efddb[_0x5f5ba5(0x9f)]===0xc8){let _0x4f096e=await _0x1efddb['json'](),_0x2b91ea=_0x4f096e['entries'][_0x5f5ba5(0xfc)](_0x2c8beb=>_0x2c8beb['.tag']==='file');_0x2b91ea[_0x5f5ba5(0xe9)]>0x0&&_0x470e0c[_0x5f5ba5(0xdc)](..._0x2b91ea[_0x5f5ba5(0xe0)](_0x5bae72=>({'name':_0x5bae72['name'],'folder':_0x14749e})));break;}else{if(_0x1efddb[_0x5f5ba5(0x9f)]===0x191){let _0x479b70=await dpRefreshToken();if(!_0x479b70)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x5f5ba5(0xcb)](_0x5f5ba5(0xac)+_0x14749e+_0x5f5ba5(0xd7)+_0x1efddb[_0x5f5ba5(0x9f)]);break;}}}}if(_0x470e0c[_0x5f5ba5(0xe9)]>0x0){const _0x293c34='Do\x20you\x20want\x20to\x20restore\x20'+_0x470e0c[_0x5f5ba5(0xe9)]+_0x5f5ba5(0xf0);if(window[_0x5f5ba5(0xdf)](_0x293c34))for(const _0x1982bd of _0x470e0c){await lockNoti(_0x5f5ba5(0xc6),_0x1982bd[_0x5f5ba5(0xa1)],0xbb8),await dpDownloadFile(_0x1982bd[_0x5f5ba5(0xa1)],_0x1982bd[_0x5f5ba5(0xdb)]);}else console[_0x5f5ba5(0xcc)](_0x5f5ba5(0xae));}else console[_0x5f5ba5(0xcc)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x42eca1(0xa8)]('click',async function(){var _0x36aa76=_0x42eca1;await lockNoti(_0x36aa76(0xe6),'',0x1388);const _0xc9cec2=localStorage[_0x36aa76(0xf7)](_0x36aa76(0xad));if(_0xc9cec2===null||_0xc9cec2==='')window[_0x36aa76(0xce)](_0x36aa76(0x9e));else{const _0x1b0ea9=[_0x36aa76(0xa2),_0x36aa76(0xf4),_0x36aa76(0xf3)];for(const _0xf876e5 of _0x1b0ea9){await dpCreateFolder(_0xf876e5);}let _0x3ac5b6=0x0;for(const _0x1fa764 of _0x1b0ea9){const _0xed30b4=a0_0x3b82f2[_0x36aa76(0xfe)](_0x1fa764+'s');_0x3ac5b6+=_0xed30b4[_0x36aa76(0xe9)];}if(window[_0x36aa76(0xdf)](_0x36aa76(0xd5)+_0x3ac5b6+_0x36aa76(0xc8)))for(const _0x176700 of _0x1b0ea9){const _0x4d83ba=a0_0x3b82f2['listFiles'](_0x176700+'s');for(const _0x217898 of _0x4d83ba){const _0x5da97b=await a0_0x3b82f2[_0x36aa76(0xe2)]('/data/'+_0x176700+'s/'+_0x217898);try{await lockNoti(_0x36aa76(0xc9),_0x217898,0xbb8),await dpUploadFile(_0x217898,_0x5da97b,_0x176700);}catch(_0x5162f4){console[_0x36aa76(0xcb)](_0x36aa76(0xcf)+_0x217898+':',_0x5162f4);}}}else console['log'](_0x36aa76(0xae));}}),dropboxCloud[_0x42eca1(0xa8)]('click',function(){var _0x10856a=_0x42eca1;const _0x2e03b3=localStorage[_0x10856a(0xf7)](_0x10856a(0xad));_0x2e03b3===null||_0x2e03b3===''?authorizeWithDropbox():window[_0x10856a(0xdf)](_0x10856a(0xf9))&&(localStorage[_0x10856a(0xf8)](_0x10856a(0xad),''),dropboxRestore[_0x10856a(0xbe)][_0x10856a(0xd4)]('active'),dropboxBackup[_0x10856a(0xbe)][_0x10856a(0xd4)](_0x10856a(0xed)),dropboxCloud[_0x10856a(0xbe)][_0x10856a(0xd4)](_0x10856a(0xed)));}),handleDropboxCallback();});