var a0_0x25602d=a0_0x179f;(function(_0x5c649f,_0xb955a1){var _0x3e2b9f=a0_0x179f,_0x2ff9fb=_0x5c649f();while(!![]){try{var _0xe48ff7=-parseInt(_0x3e2b9f(0x177))/0x1*(parseInt(_0x3e2b9f(0x11f))/0x2)+parseInt(_0x3e2b9f(0x12b))/0x3*(parseInt(_0x3e2b9f(0x16a))/0x4)+parseInt(_0x3e2b9f(0x16e))/0x5+parseInt(_0x3e2b9f(0x154))/0x6*(-parseInt(_0x3e2b9f(0x18a))/0x7)+parseInt(_0x3e2b9f(0x17f))/0x8*(-parseInt(_0x3e2b9f(0x147))/0x9)+-parseInt(_0x3e2b9f(0x167))/0xa+-parseInt(_0x3e2b9f(0x134))/0xb*(-parseInt(_0x3e2b9f(0x16c))/0xc);if(_0xe48ff7===_0xb955a1)break;else _0x2ff9fb['push'](_0x2ff9fb['shift']());}catch(_0x4b2a18){_0x2ff9fb['push'](_0x2ff9fb['shift']());}}}(a0_0x315e,0x5463c));import*as a0_0x1d3dce from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x25602d(0x139),clientSecret=a0_0x25602d(0x13f);function a0_0x179f(_0x18eaf5,_0x3353d7){var _0x315edb=a0_0x315e();return a0_0x179f=function(_0x179fdf,_0x5976ae){_0x179fdf=_0x179fdf-0x11f;var _0x1be6d3=_0x315edb[_0x179fdf];return _0x1be6d3;},a0_0x179f(_0x18eaf5,_0x3353d7);}function authorizeWithDropbox(){var _0x48aae4=a0_0x25602d,_0x15571c=window[_0x48aae4(0x145)]['href'][_0x48aae4(0x164)]('?')[0x0],_0x3f40c0=_0x48aae4(0x13b),_0x4faf29=_0x48aae4(0x17b),_0x3bc13e=_0x48aae4(0x126)+clientId+'&response_type='+_0x3f40c0+_0x48aae4(0x15c)+_0x4faf29+_0x48aae4(0x18e)+encodeURIComponent(_0x15571c);window[_0x48aae4(0x145)][_0x48aae4(0x136)]=_0x3bc13e;}function handleDropboxCallback(){var _0x1b31e9=a0_0x25602d,_0x25c419=getUrlParameter(_0x1b31e9(0x13b));_0x25c419?(getAccessToken(_0x25c419),console[_0x1b31e9(0x178)](_0x1b31e9(0x163),_0x25c419)):console[_0x1b31e9(0x178)](_0x1b31e9(0x12e));}function getUrlParameter(_0xf04832){var _0x16b0fd=a0_0x25602d;_0xf04832=_0xf04832['replace'](/[\[]/,'\x5c[')[_0x16b0fd(0x15d)](/[\]]/,'\x5c]');var _0x508519=new RegExp(_0x16b0fd(0x14c)+_0xf04832+_0x16b0fd(0x12a)),_0x4aabe2=_0x508519[_0x16b0fd(0x186)](location[_0x16b0fd(0x140)]);return _0x4aabe2===null?'':decodeURIComponent(_0x4aabe2[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x541b11){var _0xf3ebb7=a0_0x25602d,_0x23905b=_0xf3ebb7(0x15f),_0x639679=window[_0xf3ebb7(0x145)]['href'][_0xf3ebb7(0x164)]('?')[0x0],_0x11c1f3=new XMLHttpRequest();_0x11c1f3['open'](_0xf3ebb7(0x125),_0xf3ebb7(0x15a)),_0x11c1f3[_0xf3ebb7(0x153)]('Content-Type',_0xf3ebb7(0x162)),_0x11c1f3['onload']=function(){var _0x40b305=_0xf3ebb7;if(_0x11c1f3[_0x40b305(0x157)]===0xc8){var _0x43fb7e=JSON['parse'](_0x11c1f3[_0x40b305(0x120)]),_0x33a15c=_0x43fb7e[_0x40b305(0x18c)],_0x1790ce=_0x43fb7e[_0x40b305(0x13e)],_0x3464d1=_0x43fb7e[_0x40b305(0x17c)];localStorage['setItem']('accessToken',_0x33a15c),localStorage[_0x40b305(0x129)](_0x40b305(0x18b),_0x1790ce),localStorage[_0x40b305(0x129)](_0x40b305(0x173),_0x3464d1);}else console[_0x40b305(0x178)](_0x40b305(0x168));},_0x11c1f3[_0xf3ebb7(0x12f)](_0xf3ebb7(0x170)+_0x541b11+_0xf3ebb7(0x146)+_0x23905b+'&client_id='+clientId+_0xf3ebb7(0x182)+clientSecret+_0xf3ebb7(0x18e)+encodeURIComponent(_0x639679));}export async function dpRefreshToken(){var _0x3043d3=a0_0x25602d;if(!localStorage[_0x3043d3(0x191)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x399bea=await fetch(_0x3043d3(0x142),{'method':'POST','headers':{'Content-Type':_0x3043d3(0x162)},'body':'refresh_token='+localStorage['getItem'](_0x3043d3(0x18b))+_0x3043d3(0x171)}),_0x1ffa53=await _0x399bea[_0x3043d3(0x14e)]();if(!_0x1ffa53[_0x3043d3(0x141)])return localStorage[_0x3043d3(0x129)](_0x3043d3(0x14d),_0x1ffa53[_0x3043d3(0x18c)]),await lockNoti('',_0x3043d3(0x17a),0xbb8),await delay(0x3e8),!![];else alert(_0x1ffa53['error_description']||_0x3043d3(0x13d));}catch(_0x56e198){console[_0x3043d3(0x141)](_0x3043d3(0x174),_0x56e198);}return![];}export async function dpUploadFile(_0x36bb5a,_0x1ea3ee){var _0xf9b992=a0_0x25602d;const _0x2b77cd=localStorage[_0xf9b992(0x191)](_0xf9b992(0x173));var _0x2d4420=JSON[_0xf9b992(0x127)]({'autorename':!![],'mode':_0xf9b992(0x155),'mute':!![],'strict_conflict':![],'path':'/'+_0x2b77cd+'/'+_0x36bb5a}),_0x4fdee1=new Blob([_0x1ea3ee],{'type':'application/octet-stream'});for(var _0x3cf37a=0x0;_0x3cf37a<0x2;_0x3cf37a++){var _0x4f9325=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0xf9b992(0x125),'headers':{'Authorization':_0xf9b992(0x152)+localStorage[_0xf9b992(0x191)]('accessToken'),'Dropbox-API-Arg':_0x2d4420,'Content-Type':_0xf9b992(0x137)},'body':_0x4fdee1});if(_0x4f9325['status']!=0xc8){if(_0x4f9325[_0xf9b992(0x157)]==0x191){var _0x56574c=await dpRefreshToken();if(!_0x56574c)throw _0xf9b992(0x132);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x4f9325[_0xf9b992(0x157)];}else{var _0x5c140e=await _0x4f9325[_0xf9b992(0x14e)]();return console[_0xf9b992(0x178)](_0xf9b992(0x16f),_0x36bb5a),_0x5c140e;}}return![];}async function dpDownloadFile(_0x1a669a){var _0x444ebf=a0_0x25602d;const _0x140ed9=localStorage['getItem'](_0x444ebf(0x173));var _0x5979e8=JSON[_0x444ebf(0x127)]({'path':'/'+_0x140ed9+'/'+_0x1a669a});for(var _0x549da8=0x0;_0x549da8<0x2;_0x549da8++){var _0x104f41=await fetch(_0x444ebf(0x179),{'method':_0x444ebf(0x125),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x444ebf(0x191)](_0x444ebf(0x14d)),'Dropbox-API-Arg':_0x5979e8}});if(_0x104f41[_0x444ebf(0x157)]!=0xc8){if(_0x104f41[_0x444ebf(0x157)]==0x191){var _0xf12671=await dpRefreshToken();if(!_0xf12671)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x444ebf(0x183)+_0x104f41[_0x444ebf(0x157)];}const _0x18f3ba=new File([await _0x104f41[_0x444ebf(0x133)]()],_0x1a669a);console[_0x444ebf(0x178)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x18f3ba[_0x444ebf(0x185)]);if(_0x1a669a[_0x444ebf(0x130)](_0x444ebf(0x184))){const _0x48595f=await _0x18f3ba[_0x444ebf(0x135)](),[_0x81275b,_0x3a38e7]=_0x48595f[_0x444ebf(0x164)]('\x0a\x0a'),_0x53e1ea=_0x1a669a['substring'](0x0,_0x1a669a[_0x444ebf(0x169)](_0x444ebf(0x151))+0x3),_0x43792f=_0x1a669a['charAt'](_0x1a669a[_0x444ebf(0x187)]-0x5);localStorage[_0x444ebf(0x129)](_0x53e1ea+_0x444ebf(0x188)+_0x43792f,_0x3a38e7),localStorage[_0x444ebf(0x129)](_0x53e1ea+_0x444ebf(0x16b)+_0x43792f,_0x81275b);}else a0_0x1d3dce[_0x444ebf(0x16d)](_0x18f3ba,()=>{var _0x3e493d=_0x444ebf;localStorageFile(),Module[_0x3e493d(0x15e)]();});return _0x18f3ba;}return![];}function a0_0x315e(){var _0x582732=['uId','Error\x20while\x20refreshing\x20token:','substring','file','49QHWOIr','log','https://content.dropboxapi.com/2/files/download','Refreshing\x20token...','offline','uid','.ss4','.tag','16WMcnbe','entries','.ss3','&client_secret=','Download\x20failed,\x20unknown\x20http\x20status:','.txt','name','exec','length','_dateState','downloadFileInCloud','44681hgdPhO','refreshToken','access_token','classList','&redirect_uri=','click','Do\x20you\x20want\x20to\x20logout?','getItem','addEventListener','22604lwnoli','responseText','Do\x20you\x20want\x20to\x20backup\x20','application/json','text/plain','.ss2','POST','https://www.dropbox.com/oauth2/authorize?client_id=','stringify','https://api.dropboxapi.com/2/files/list_folder','setItem','=([^&#]*)','3LWPLJX','Do\x20you\x20want\x20to\x20restore\x20','.ss6','Do\x20not\x20receive\x20authorization','send','endsWith','list','Unable\x20to\x20refresh\x20token','blob','11cNkzHj','text','href','application/octet-stream','.gba_slot','knh3uz2mx2hp2eu','DOMContentLoaded','code','Failed\x20to\x20upload\x20file\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','refresh_token','nwb3dnfh09rhs31','search','error','https://api.dropboxapi.com/oauth2/token','Restore\x20canceled\x20by\x20user.','/data/','location','&grant_type=','2103075viRXHf','slice','\x20files\x20in\x20Kabu?','.ss1','confirm','[\x5c?&#]','accessToken','json','active','alert','gba','Bearer\x20','setRequestHeader','612HHQrJt','overwrite','remove','status','Backing\x20up...','state','https://api.dropbox.com/oauth2/token','charAt','&token_access_type=','replace','FSSync','authorization_code','.ss5','status:\x20','application/x-www-form-urlencoded','Authorization\x20Code:','split','.gba_imageState','save','4572820XpbFjp','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','lastIndexOf','2699404IkwgII','_imageState','16718292ucvwye','uploadSaveOrSaveState','2035570RqRlvk','Kabu\x20storage\x20↦\x20Cloud\x20◆','code=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','filter'];a0_0x315e=function(){return _0x582732;};return a0_0x315e();}document[a0_0x25602d(0x192)](a0_0x25602d(0x13a),function(){var _0x55faa2=a0_0x25602d;dropboxRestore[_0x55faa2(0x192)](_0x55faa2(0x18f),async function(){var _0x43ff97=_0x55faa2;const _0xc728a6=localStorage[_0x43ff97(0x191)]('uId');if(_0xc728a6===null||_0xc728a6==='')window[_0x43ff97(0x150)]('Cloud\x20login\x20required!');else{var _0x2280cd={'path':'/'+_0xc728a6};for(var _0x3a1372=0x0;_0x3a1372<0x2;_0x3a1372++){var _0x1328bb=await fetch(_0x43ff97(0x128),{'method':_0x43ff97(0x125),'headers':{'Authorization':_0x43ff97(0x152)+localStorage['getItem'](_0x43ff97(0x14d)),'Content-Type':_0x43ff97(0x122)},'body':JSON[_0x43ff97(0x127)](_0x2280cd)});console['log'](_0x43ff97(0x161),_0x1328bb[_0x43ff97(0x157)]);if(_0x1328bb[_0x43ff97(0x157)]!=0xc8){if(_0x1328bb[_0x43ff97(0x157)]==0x191){var _0x1ffefc=await dpRefreshToken();if(!_0x1ffefc)throw _0x43ff97(0x132);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1328bb[_0x43ff97(0x157)];}else{const _0x49d8e1=await _0x1328bb[_0x43ff97(0x14e)](),_0x5b3bf4=_0x49d8e1[_0x43ff97(0x180)][_0x43ff97(0x172)](_0x569aaa=>_0x569aaa[_0x43ff97(0x17e)]===_0x43ff97(0x176))[_0x43ff97(0x187)],_0x192cad=_0x43ff97(0x12c)+_0x5b3bf4+'\x20files\x20in\x20Cloud?';if(window[_0x43ff97(0x14b)](_0x192cad))for(const _0x597b88 of _0x49d8e1[_0x43ff97(0x180)]){_0x597b88['.tag']===_0x43ff97(0x176)&&(await lockNoti('Restoring...',_0x597b88[_0x43ff97(0x185)],0xbb8),await dpDownloadFile(_0x597b88[_0x43ff97(0x185)]));}else console[_0x43ff97(0x178)](_0x43ff97(0x143));return!![];}}return![];}}),dropboxBackup[_0x55faa2(0x192)]('click',async function(){var _0x1287d4=_0x55faa2;const _0x40ecf0=localStorage[_0x1287d4(0x191)]('uId');if(_0x40ecf0===null||_0x40ecf0==='')window[_0x1287d4(0x150)]('Cloud\x20login\x20required!');else{const _0x4a2ddf=[_0x1287d4(0x159),_0x1287d4(0x166)];let _0x1d5355=0x0;for(const _0x453a88 of _0x4a2ddf){const _0x3db630=a0_0x1d3dce[_0x1287d4(0x131)+(_0x453a88[_0x1287d4(0x15b)](0x0)['toUpperCase']()+_0x453a88[_0x1287d4(0x148)](0x1))]();_0x1d5355+=_0x3db630[_0x1287d4(0x187)];}if(window[_0x1287d4(0x14b)](_0x1287d4(0x121)+_0x1d5355+_0x1287d4(0x149)))for(const _0x4a8c1c of _0x4a2ddf){const _0x409a9f=a0_0x1d3dce[_0x1287d4(0x131)+(_0x4a8c1c[_0x1287d4(0x15b)](0x0)['toUpperCase']()+_0x4a8c1c[_0x1287d4(0x148)](0x1))]();for(const _0x197f3b of _0x409a9f){const _0x9b6441=await a0_0x1d3dce[_0x1287d4(0x189)](_0x1287d4(0x144)+_0x4a8c1c+'s/'+_0x197f3b);try{await lockNoti('Backing\x20up...',_0x197f3b,0xbb8),await dpUploadFile(_0x197f3b,_0x9b6441);if(_0x197f3b[_0x1287d4(0x130)]('.ss0')||_0x197f3b['endsWith'](_0x1287d4(0x14a))||_0x197f3b['endsWith'](_0x1287d4(0x124))||_0x197f3b['endsWith'](_0x1287d4(0x181))||_0x197f3b[_0x1287d4(0x130)](_0x1287d4(0x17d))||_0x197f3b['endsWith'](_0x1287d4(0x160))||_0x197f3b['endsWith'](_0x1287d4(0x12d))||_0x197f3b[_0x1287d4(0x130)]('.ss7')){const _0xae08b4=_0x197f3b[_0x1287d4(0x175)](0x0,_0x197f3b['lastIndexOf']('.')),_0x45dc2a=_0x197f3b[_0x1287d4(0x15b)](_0x197f3b[_0x1287d4(0x187)]-0x1),_0x1036bb=localStorage[_0x1287d4(0x191)](_0xae08b4+_0x1287d4(0x165)+_0x45dc2a),_0x463704=localStorage[_0x1287d4(0x191)](_0xae08b4+'.gba_dateState'+_0x45dc2a);if(_0x1036bb!==null){const _0x40bade=_0x1036bb+'\x0a\x0a'+_0x463704,_0x383803=new Blob([_0x40bade],{'type':_0x1287d4(0x123)});await lockNoti(_0x1287d4(0x158),_0xae08b4+'.gba_slot'+_0x45dc2a+_0x1287d4(0x184),0xbb8),await dpUploadFile(_0xae08b4+_0x1287d4(0x138)+_0x45dc2a+_0x1287d4(0x184),_0x383803);}}}catch(_0x3b50ef){console[_0x1287d4(0x141)](_0x1287d4(0x13c)+_0x197f3b+':',_0x3b50ef);}}}else console[_0x1287d4(0x178)](_0x1287d4(0x143));}}),dropboxCloud[_0x55faa2(0x192)](_0x55faa2(0x18f),function(){var _0x525144=_0x55faa2;const _0x3e8957=localStorage[_0x525144(0x191)](_0x525144(0x173));_0x3e8957===null||_0x3e8957===''?authorizeWithDropbox():window[_0x525144(0x14b)](_0x525144(0x190))&&(localStorage['setItem'](_0x525144(0x173),''),dropboxRestore[_0x525144(0x18d)]['remove']('active'),dropboxBackup['classList'][_0x525144(0x156)](_0x525144(0x14f)),dropboxCloud[_0x525144(0x18d)][_0x525144(0x156)](_0x525144(0x14f)));}),handleDropboxCallback();});