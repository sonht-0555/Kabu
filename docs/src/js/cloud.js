var a0_0x783353=a0_0x2b15;(function(_0x3d25fa,_0x4e8319){var _0x36e3fa=a0_0x2b15,_0x58990d=_0x3d25fa();while(!![]){try{var _0x535113=-parseInt(_0x36e3fa(0x108))/0x1*(-parseInt(_0x36e3fa(0xf1))/0x2)+parseInt(_0x36e3fa(0x107))/0x3*(parseInt(_0x36e3fa(0xef))/0x4)+-parseInt(_0x36e3fa(0x10b))/0x5+-parseInt(_0x36e3fa(0x116))/0x6+parseInt(_0x36e3fa(0x12f))/0x7*(parseInt(_0x36e3fa(0xf7))/0x8)+-parseInt(_0x36e3fa(0xeb))/0x9*(-parseInt(_0x36e3fa(0x11e))/0xa)+-parseInt(_0x36e3fa(0x115))/0xb;if(_0x535113===_0x4e8319)break;else _0x58990d['push'](_0x58990d['shift']());}catch(_0x15300c){_0x58990d['push'](_0x58990d['shift']());}}}(a0_0x50d9,0x99573));import*as a0_0x3564a2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x783353(0x104),clientSecret=a0_0x783353(0xf4);function authorizeWithDropbox(){var _0x426414=a0_0x783353,_0x64cd40=window[_0x426414(0x120)][_0x426414(0xfd)][_0x426414(0x11a)]('?')[0x0],_0x1bf03b='code',_0x395742=_0x426414(0xee),_0x233d08=_0x426414(0xf5)+clientId+_0x426414(0x126)+_0x1bf03b+_0x426414(0x10e)+_0x395742+'&redirect_uri='+encodeURIComponent(_0x64cd40);window[_0x426414(0x120)][_0x426414(0xfd)]=_0x233d08;}function handleDropboxCallback(){var _0x787ce0=a0_0x783353,_0x5896b2=getUrlParameter(_0x787ce0(0xd0));_0x5896b2?(getAccessToken(_0x5896b2),console[_0x787ce0(0x11f)](_0x787ce0(0xce),_0x5896b2)):console[_0x787ce0(0x11f)](_0x787ce0(0x11b));}function getUrlParameter(_0x303ff9){var _0x21bbb8=a0_0x783353;_0x303ff9=_0x303ff9[_0x21bbb8(0x10d)](/[\[]/,'\x5c[')[_0x21bbb8(0x10d)](/[\]]/,'\x5c]');var _0x2120f6=new RegExp(_0x21bbb8(0xd9)+_0x303ff9+_0x21bbb8(0xc9)),_0xc0b9b5=_0x2120f6['exec'](location[_0x21bbb8(0xd1)]);return _0xc0b9b5===null?'':decodeURIComponent(_0xc0b9b5[0x1][_0x21bbb8(0x10d)](/\+/g,'\x20'));}function getAccessToken(_0x55438a){var _0x4a684b=a0_0x783353,_0x4c84e6=_0x4a684b(0xe2),_0x3052c0=window[_0x4a684b(0x120)][_0x4a684b(0xfd)][_0x4a684b(0x11a)]('?')[0x0],_0x18ad29=new XMLHttpRequest();_0x18ad29[_0x4a684b(0xdf)](_0x4a684b(0x112),'https://api.dropbox.com/oauth2/token'),_0x18ad29[_0x4a684b(0xe9)]('Content-Type',_0x4a684b(0xf3)),_0x18ad29[_0x4a684b(0x100)]=function(){var _0x32db17=_0x4a684b;if(_0x18ad29['status']===0xc8){var _0x35e025=JSON[_0x32db17(0xde)](_0x18ad29['responseText']),_0x2e4cca=_0x35e025['access_token'],_0x7eac8d=_0x35e025[_0x32db17(0x123)],_0xa855ac=_0x35e025[_0x32db17(0xe5)];localStorage['setItem']('accessToken',_0x2e4cca),localStorage['setItem'](_0x32db17(0xcf),_0x7eac8d),localStorage['setItem'](_0x32db17(0x119),_0xa855ac);}else console[_0x32db17(0x11f)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x18ad29['send'](_0x4a684b(0x114)+_0x55438a+_0x4a684b(0xed)+_0x4c84e6+'&client_id='+clientId+_0x4a684b(0xcd)+clientSecret+_0x4a684b(0x109)+encodeURIComponent(_0x3052c0));}export async function dpCreateFolder(_0x27abba){var _0x2ccd11=a0_0x783353;const _0x1cf9d6=localStorage[_0x2ccd11(0xdb)](_0x2ccd11(0x119));let _0x193495=localStorage['getItem'](_0x2ccd11(0xfb));const _0x5ee707='/'+_0x1cf9d6+'/'+_0x27abba,_0x5482d5=JSON['stringify']({'path':_0x5ee707,'autorename':![]});for(let _0x21824b=0x0;_0x21824b<0x2;_0x21824b++){try{const _0x56d26e=await fetch(_0x2ccd11(0xfe),{'method':_0x2ccd11(0x112),'headers':{'Authorization':_0x2ccd11(0x101)+_0x193495,'Content-Type':'application/json'},'body':_0x5482d5});if(_0x56d26e[_0x2ccd11(0xda)]===0x191){const _0x26516f=await dpRefreshToken();if(!_0x26516f)throw new Error(_0x2ccd11(0x12a));_0x193495=localStorage[_0x2ccd11(0xdb)]('accessToken');continue;}if(_0x56d26e[_0x2ccd11(0xda)]===0x199)return{'message':_0x2ccd11(0x111),'path':_0x27abba};if(!_0x56d26e['ok'])throw new Error(_0x2ccd11(0xe4)+_0x27abba);const _0x4c9c3b=await _0x56d26e[_0x2ccd11(0xf8)]();return await lockNoti('Folder\x20created','',0xbb8),_0x4c9c3b;}catch(_0x223fc7){if(_0x21824b===0x1)throw _0x223fc7;}}return![];}export async function dpRefreshToken(){var _0x5ec208=a0_0x783353;if(!localStorage[_0x5ec208(0xdb)]('refreshToken'))throw _0x5ec208(0xcb);try{const _0x90fd72=await fetch(_0x5ec208(0xfc),{'method':_0x5ec208(0x112),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x5ec208(0x113)+localStorage[_0x5ec208(0xdb)]('refreshToken')+_0x5ec208(0x12b)}),_0x4bdfdd=await _0x90fd72[_0x5ec208(0xf8)]();if(!_0x4bdfdd['error'])return localStorage[_0x5ec208(0x12c)]('accessToken',_0x4bdfdd[_0x5ec208(0xdd)]),await lockNoti(_0x5ec208(0x131),'',0xbb8),await delay(0x3e8),!![];else alert(_0x4bdfdd[_0x5ec208(0x12d)]||_0x5ec208(0x130));}catch(_0x5c7c7d){console[_0x5ec208(0x11d)](_0x5ec208(0xd5),_0x5c7c7d);}return![];}export async function dpUploadFile(_0x2aab68,_0x598b38,_0x5a4964){var _0x5e751a=a0_0x783353;const _0x53d34e=localStorage[_0x5e751a(0xdb)]('uId');var _0x28c82a=JSON[_0x5e751a(0xe6)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x53d34e+'/'+_0x5a4964+'/'+_0x2aab68}),_0x138365=new Blob([_0x598b38],{'type':_0x5e751a(0xe8)});for(var _0x2c1626=0x0;_0x2c1626<0x2;_0x2c1626++){var _0x415209=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x5e751a(0x112),'headers':{'Authorization':_0x5e751a(0x101)+localStorage[_0x5e751a(0xdb)]('accessToken'),'Dropbox-API-Arg':_0x28c82a,'Content-Type':'application/octet-stream'},'body':_0x138365});if(_0x415209[_0x5e751a(0xda)]!=0xc8){if(_0x415209['status']==0x191){var _0x22e995=await dpRefreshToken();if(!_0x22e995)throw _0x5e751a(0x12a);continue;}else throw _0x5e751a(0x121)+_0x415209[_0x5e751a(0xda)];}else{var _0x4f10c8=await _0x415209[_0x5e751a(0xf8)]();return console[_0x5e751a(0x11f)](_0x5e751a(0x128),_0x2aab68),_0x4f10c8;}}return![];}export async function dpDownloadFile(_0x443d0e,_0x2b9e1c){var _0x34428d=a0_0x783353;const _0x104241=localStorage['getItem']('uId');var _0x25c851=JSON[_0x34428d(0xe6)]({'path':'/'+_0x104241+'/'+_0x2b9e1c+'/'+_0x443d0e});for(var _0x118cb3=0x0;_0x118cb3<0x2;_0x118cb3++){var _0x15937a=await fetch(_0x34428d(0x117),{'method':_0x34428d(0x112),'headers':{'Authorization':_0x34428d(0x101)+localStorage['getItem'](_0x34428d(0xfb)),'Dropbox-API-Arg':_0x25c851}});if(_0x15937a[_0x34428d(0xda)]!=0xc8){if(_0x15937a[_0x34428d(0xda)]==0x191){var _0x476975=await dpRefreshToken();if(!_0x476975)throw _0x34428d(0x12a);continue;}else throw _0x34428d(0xe7)+_0x15937a[_0x34428d(0xda)];}const _0x3c17a8=new File([await _0x15937a[_0x34428d(0xc8)]()],_0x443d0e);return console[_0x34428d(0x11f)](_0x34428d(0xd6),_0x3c17a8['name']),a0_0x3564a2[_0x34428d(0xf2)](_0x3c17a8,()=>{}),_0x3c17a8;}return![];}function a0_0x2b15(_0x3a4793,_0x3318fb){var _0x50d903=a0_0x50d9();return a0_0x2b15=function(_0x2b15c1,_0x132395){_0x2b15c1=_0x2b15c1-0xc8;var _0x2b14c1=_0x50d903[_0x2b15c1];return _0x2b14c1;},a0_0x2b15(_0x3a4793,_0x3318fb);}document['addEventListener'](a0_0x783353(0x127),function(){var _0x21fd49=a0_0x783353;dropboxRestore['addEventListener'](_0x21fd49(0xff),async function(){var _0x152e7a=_0x21fd49;await lockNoti(_0x152e7a(0x118),'',0x1388);const _0x46528c=localStorage['getItem']('uId'),_0x16d695=[_0x152e7a(0x10c),'save',_0x152e7a(0x129)];if(!_0x46528c){window['alert'](_0x152e7a(0x103));return;}let _0x1db273=[];for(const _0x5b385a of _0x16d695){let _0x4dc897={'path':'/'+_0x46528c+'/'+_0x5b385a};for(let _0x4ee3be=0x0;_0x4ee3be<0x2;_0x4ee3be++){let _0x29d0ff=await fetch(_0x152e7a(0x102),{'method':'POST','headers':{'Authorization':_0x152e7a(0x101)+localStorage['getItem']('accessToken'),'Content-Type':_0x152e7a(0x106)},'body':JSON['stringify'](_0x4dc897)});if(_0x29d0ff['status']===0xc8){let _0x5c9ca8=await _0x29d0ff['json'](),_0x5b4252=_0x5c9ca8['entries']['filter'](_0x3d5e97=>_0x3d5e97[_0x152e7a(0xe3)]===_0x152e7a(0xe0));_0x5b4252[_0x152e7a(0xd2)]>0x0&&_0x1db273[_0x152e7a(0xd3)](..._0x5b4252[_0x152e7a(0x124)](_0x2e2817=>({'name':_0x2e2817[_0x152e7a(0xf6)],'folder':_0x5b385a})));break;}else{if(_0x29d0ff[_0x152e7a(0xda)]===0x191){let _0x14e6bf=await dpRefreshToken();if(!_0x14e6bf)throw _0x152e7a(0x12a);}else{console[_0x152e7a(0x11d)](_0x152e7a(0x125)+_0x5b385a+_0x152e7a(0x12e)+_0x29d0ff[_0x152e7a(0xda)]);break;}}}}if(_0x1db273[_0x152e7a(0xd2)]>0x0){const _0x589fe4=_0x152e7a(0xd8)+_0x1db273[_0x152e7a(0xd2)]+'\x20files\x20from\x20Cloud?';if(window[_0x152e7a(0x110)](_0x589fe4))for(const _0x4e6140 of _0x1db273){await lockNoti(_0x152e7a(0xd4),_0x4e6140[_0x152e7a(0xf6)],0xbb8),await dpDownloadFile(_0x4e6140[_0x152e7a(0xf6)],_0x4e6140[_0x152e7a(0xdc)]);}else console[_0x152e7a(0x11f)](_0x152e7a(0xd7));}else console['log'](_0x152e7a(0x10f));}),dropboxBackup['addEventListener'](_0x21fd49(0xff),async function(){var _0x55321e=_0x21fd49;await lockNoti(_0x55321e(0x118),'',0x1388);const _0x5943b5=localStorage['getItem'](_0x55321e(0x119));if(_0x5943b5===null||_0x5943b5==='')window[_0x55321e(0xf9)]('Cloud\x20login\x20required!');else{const _0x3fe773=['state',_0x55321e(0xea),'screenshot'];for(const _0x15f467 of _0x3fe773){await dpCreateFolder(_0x15f467);}let _0x2f6b15=0x0;for(const _0x2ffb16 of _0x3fe773){const _0x3927d4=a0_0x3564a2[_0x55321e(0xfa)](_0x2ffb16+'s');_0x2f6b15+=_0x3927d4[_0x55321e(0xd2)];}if(window[_0x55321e(0x110)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x2f6b15+_0x55321e(0x122)))for(const _0x4e8490 of _0x3fe773){const _0x59af98=a0_0x3564a2[_0x55321e(0xfa)](_0x4e8490+'s');for(const _0x223521 of _0x59af98){const _0x13b4d7=await a0_0x3564a2[_0x55321e(0xca)](_0x55321e(0x132)+_0x4e8490+'s/'+_0x223521);try{await lockNoti(_0x55321e(0x105),_0x223521,0xbb8),await dpUploadFile(_0x223521,_0x13b4d7,_0x4e8490);}catch(_0x152161){console[_0x55321e(0x11d)](_0x55321e(0x10a)+_0x223521+':',_0x152161);}}}else console[_0x55321e(0x11f)](_0x55321e(0xd7));}}),dropboxCloud[_0x21fd49(0xf0)](_0x21fd49(0xff),function(){var _0x44380b=_0x21fd49;const _0x395965=localStorage[_0x44380b(0xdb)](_0x44380b(0x119));_0x395965===null||_0x395965===''?authorizeWithDropbox():window[_0x44380b(0x110)](_0x44380b(0x11c))&&(localStorage[_0x44380b(0x12c)](_0x44380b(0x119),''),dropboxRestore[_0x44380b(0xec)][_0x44380b(0xcc)](_0x44380b(0xe1)),dropboxBackup[_0x44380b(0xec)][_0x44380b(0xcc)]('active'),dropboxCloud['classList'][_0x44380b(0xcc)](_0x44380b(0xe1)));}),handleDropboxCallback();});function a0_0x50d9(){var _0x5dc759=['.tag','Error\x20creating\x20folder\x20','uid','stringify','Download\x20failed,\x20unknown\x20http\x20status:','application/octet-stream','setRequestHeader','save','932265HCXTzt','classList','&grant_type=','offline','164636XCVRoX','addEventListener','20barQPk','uploadFileInCloud','application/x-www-form-urlencoded','nwb3dnfh09rhs31','https://www.dropbox.com/oauth2/authorize?client_id=','name','8YnHkZr','json','alert','listFiles','accessToken','https://api.dropboxapi.com/oauth2/token','href','https://api.dropboxapi.com/2/files/create_folder_v2','click','onload','Bearer\x20','https://api.dropboxapi.com/2/files/list_folder','Cloud\x20login\x20required!','knh3uz2mx2hp2eu','Backing\x20up...','application/json','45aQeTKL','106649HWffVu','&redirect_uri=','Failed\x20to\x20upload\x20file\x20','772015wnVuWa','state','replace','&token_access_type=','No\x20files\x20found\x20to\x20restore.','confirm','Folder\x20already\x20exists','POST','refresh_token=','code=','18492122euQFVQ','3347184hHTgti','https://content.dropboxapi.com/2/files/download','Wait\x20a\x20little\x20bit...','uId','split','Do\x20not\x20receive\x20authorization','Do\x20you\x20want\x20to\x20logout?','error','20hWaQPY','log','location','Upload\x20failed,\x20unknown\x20http\x20status:\x20','\x20files\x20in\x20Kabu?','refresh_token','map','Download\x20failed\x20for\x20','&response_type=','DOMContentLoaded','Kabu\x20storage\x20↦\x20Cloud\x20◆','screenshot','Unable\x20to\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','setItem','error_description',',\x20status:\x20','7912849aSeaum','Failed\x20to\x20refresh\x20Dropbox\x20token.','Refreshing\x20token...','/data/','blob','=([^&#]*)','downloadFileInCloud','No\x20refresh\x20token','remove','&client_secret=','Authorization\x20Code:','refreshToken','code','search','length','push','Restoring...','Error\x20while\x20refreshing\x20token:','Cloud\x20↦\x20Kabu\x20storage\x20◆','Restore\x20canceled\x20by\x20user.','Do\x20you\x20want\x20to\x20restore\x20','[\x5c?&#]','status','getItem','folder','access_token','parse','open','file','active','authorization_code'];a0_0x50d9=function(){return _0x5dc759;};return a0_0x50d9();}