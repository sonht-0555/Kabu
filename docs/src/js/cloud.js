var a0_0x1f4b2c=a0_0x1aaf;(function(_0x2952d1,_0x58bb0b){var _0x2c8bb0=a0_0x1aaf,_0x57f774=_0x2952d1();while(!![]){try{var _0x355d59=-parseInt(_0x2c8bb0(0xd3))/0x1*(parseInt(_0x2c8bb0(0xbd))/0x2)+-parseInt(_0x2c8bb0(0xe9))/0x3+parseInt(_0x2c8bb0(0xb9))/0x4+-parseInt(_0x2c8bb0(0xb8))/0x5*(parseInt(_0x2c8bb0(0xc4))/0x6)+-parseInt(_0x2c8bb0(0xe4))/0x7+-parseInt(_0x2c8bb0(0xdc))/0x8*(parseInt(_0x2c8bb0(0x10b))/0x9)+-parseInt(_0x2c8bb0(0x109))/0xa*(-parseInt(_0x2c8bb0(0xd0))/0xb);if(_0x355d59===_0x58bb0b)break;else _0x57f774['push'](_0x57f774['shift']());}catch(_0x45ecb3){_0x57f774['push'](_0x57f774['shift']());}}}(a0_0x4d34,0xac084));import*as a0_0x109af6 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x1f4b2c(0xc8);function a0_0x1aaf(_0x4e2038,_0x453061){var _0x4d341a=a0_0x4d34();return a0_0x1aaf=function(_0x1aafdb,_0x98da01){_0x1aafdb=_0x1aafdb-0xb6;var _0x57acd4=_0x4d341a[_0x1aafdb];return _0x57acd4;},a0_0x1aaf(_0x4e2038,_0x453061);}function authorizeWithDropbox(){var _0x36851b=a0_0x1f4b2c,_0x576751=window['location'][_0x36851b(0xc0)][_0x36851b(0xe2)]('?')[0x0],_0x5d93c2=_0x36851b(0x10e),_0x1bf131=_0x36851b(0xda),_0x3cc6ed=_0x36851b(0xba)+clientId+_0x36851b(0x108)+_0x5d93c2+_0x36851b(0xdf)+_0x1bf131+_0x36851b(0xc3)+encodeURIComponent(_0x576751);window['location']['href']=_0x3cc6ed;}function handleDropboxCallback(){var _0x8169a=a0_0x1f4b2c,_0x609a33=getUrlParameter('code');_0x609a33?(getAccessToken(_0x609a33),console['log'](_0x8169a(0xf8),_0x609a33)):console[_0x8169a(0xbc)](_0x8169a(0xfb));}function getUrlParameter(_0x36f3ff){var _0x3a8c1e=a0_0x1f4b2c;_0x36f3ff=_0x36f3ff[_0x3a8c1e(0xed)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x353401=new RegExp(_0x3a8c1e(0xee)+_0x36f3ff+'=([^&#]*)'),_0x3c2c88=_0x353401[_0x3a8c1e(0xe8)](location[_0x3a8c1e(0xff)]);return _0x3c2c88===null?'':decodeURIComponent(_0x3c2c88[0x1][_0x3a8c1e(0xed)](/\+/g,'\x20'));}function getAccessToken(_0x32ca87){var _0x203c78=a0_0x1f4b2c,_0x274780='authorization_code',_0x4ac1d5=window[_0x203c78(0xe7)][_0x203c78(0xc0)]['split']('?')[0x0],_0x1a3751=new XMLHttpRequest();_0x1a3751[_0x203c78(0xeb)](_0x203c78(0xb7),'https://api.dropbox.com/oauth2/token'),_0x1a3751[_0x203c78(0xf2)](_0x203c78(0x102),'application/x-www-form-urlencoded'),_0x1a3751['onload']=function(){var _0x3b7e90=_0x203c78;if(_0x1a3751[_0x3b7e90(0xd1)]===0xc8){var _0x56685d=JSON['parse'](_0x1a3751[_0x3b7e90(0xf7)]),_0x3aa57b=_0x56685d['access_token'],_0x3f295e=_0x56685d[_0x3b7e90(0xde)],_0x5995f9=_0x56685d[_0x3b7e90(0xe5)];localStorage['setItem']('accessToken',_0x3aa57b),localStorage[_0x3b7e90(0xb6)](_0x3b7e90(0xe1),_0x3f295e),localStorage['setItem'](_0x3b7e90(0xca),_0x5995f9);}else console[_0x3b7e90(0xbc)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x1a3751['send'](_0x203c78(0x10c)+_0x32ca87+_0x203c78(0xf3)+_0x274780+_0x203c78(0xe0)+clientId+_0x203c78(0x10d)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4ac1d5));}export async function dpCreateFolder(_0x4fbda0){var _0xa8ae2b=a0_0x1f4b2c;const _0x4eb265=localStorage['getItem'](_0xa8ae2b(0xca));let _0x32e65d=localStorage[_0xa8ae2b(0xdb)](_0xa8ae2b(0xc9));const _0x198d90='/'+_0x4eb265+'/'+_0x4fbda0,_0x6536d2=JSON['stringify']({'path':_0x198d90,'autorename':![]});for(let _0x1afc52=0x0;_0x1afc52<0x2;_0x1afc52++){try{const _0x15db52=await fetch(_0xa8ae2b(0x111),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x32e65d,'Content-Type':_0xa8ae2b(0x10a)},'body':_0x6536d2});if(_0x15db52[_0xa8ae2b(0xd1)]===0x191){const _0x6d3571=await dpRefreshToken();if(!_0x6d3571)throw new Error(_0xa8ae2b(0xf0));_0x32e65d=localStorage['getItem'](_0xa8ae2b(0xc9));continue;}if(_0x15db52[_0xa8ae2b(0xd1)]===0x199)return{'message':_0xa8ae2b(0xfe),'path':_0x4fbda0};if(!_0x15db52['ok'])throw new Error(_0xa8ae2b(0x114)+_0x4fbda0);const _0x24657e=await _0x15db52['json']();return await lockNoti(_0xa8ae2b(0xf9),'',0xbb8),_0x24657e;}catch(_0xbe2d10){if(_0x1afc52===0x1)throw _0xbe2d10;}}return![];}export async function dpRefreshToken(){var _0x25b592=a0_0x1f4b2c;if(!localStorage[_0x25b592(0xdb)](_0x25b592(0xe1)))throw _0x25b592(0xfa);try{const _0x41403f=await fetch(_0x25b592(0x100),{'method':_0x25b592(0xb7),'headers':{'Content-Type':_0x25b592(0x113)},'body':'refresh_token='+localStorage[_0x25b592(0xdb)](_0x25b592(0xe1))+_0x25b592(0xbf)}),_0x4b7eba=await _0x41403f[_0x25b592(0xce)]();if(!_0x4b7eba[_0x25b592(0x107)])return localStorage['setItem']('accessToken',_0x4b7eba['access_token']),await lockNoti(_0x25b592(0x101),'',0xbb8),await delay(0x3e8),!![];else alert(_0x4b7eba[_0x25b592(0x105)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x243080){console[_0x25b592(0x107)]('Error\x20while\x20refreshing\x20token:',_0x243080);}return![];}export async function dpUploadFile(_0x19679b,_0x58dfb6,_0x5c197b){var _0x54b59c=a0_0x1f4b2c;const _0x39a831=localStorage[_0x54b59c(0xdb)](_0x54b59c(0xca));var _0x2e140a=JSON['stringify']({'autorename':!![],'mode':_0x54b59c(0x103),'mute':!![],'strict_conflict':![],'path':'/'+_0x39a831+'/'+_0x5c197b+'/'+_0x19679b}),_0x349d76=new Blob([_0x58dfb6],{'type':'application/octet-stream'});for(var _0x339e7a=0x0;_0x339e7a<0x2;_0x339e7a++){var _0x48bb88=await fetch(_0x54b59c(0x116),{'method':_0x54b59c(0xb7),'headers':{'Authorization':_0x54b59c(0xe3)+localStorage[_0x54b59c(0xdb)]('accessToken'),'Dropbox-API-Arg':_0x2e140a,'Content-Type':_0x54b59c(0x112)},'body':_0x349d76});if(_0x48bb88[_0x54b59c(0xd1)]!=0xc8){if(_0x48bb88[_0x54b59c(0xd1)]==0x191){var _0x137b18=await dpRefreshToken();if(!_0x137b18)throw _0x54b59c(0xf0);continue;}else throw _0x54b59c(0xf1)+_0x48bb88[_0x54b59c(0xd1)];}else{var _0x5d7b0d=await _0x48bb88[_0x54b59c(0xce)]();return console[_0x54b59c(0xbc)](_0x54b59c(0x110),_0x19679b),_0x5d7b0d;}}return![];}export async function dpDownloadFile(_0x5731ec,_0x4ded67){var _0x50ef7a=a0_0x1f4b2c;const _0x3bbd08=localStorage[_0x50ef7a(0xdb)](_0x50ef7a(0xca));var _0x5d55f6=JSON[_0x50ef7a(0xcf)]({'path':'/'+_0x3bbd08+'/'+_0x4ded67+'/'+_0x5731ec});for(var _0x369edf=0x0;_0x369edf<0x2;_0x369edf++){var _0x3315e3=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x50ef7a(0xb7),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x50ef7a(0xdb)]('accessToken'),'Dropbox-API-Arg':_0x5d55f6}});if(_0x3315e3[_0x50ef7a(0xd1)]!=0xc8){if(_0x3315e3['status']==0x191){var _0x50df77=await dpRefreshToken();if(!_0x50df77)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3315e3[_0x50ef7a(0xd1)];}const _0x45730d=new File([await _0x3315e3['blob']()],_0x5731ec);return console['log'](_0x50ef7a(0xc2),_0x45730d[_0x50ef7a(0xc1)]),a0_0x109af6[_0x50ef7a(0xbb)](_0x45730d,()=>{}),_0x45730d;}return![];}document['addEventListener'](a0_0x1f4b2c(0x10f),function(){var _0x51521d=a0_0x1f4b2c;dropboxRestore[_0x51521d(0xfc)](_0x51521d(0x115),async function(){var _0x37f769=_0x51521d;await lockNoti(_0x37f769(0xd6),'',0x1388);const _0x5bb444=localStorage[_0x37f769(0xdb)](_0x37f769(0xca)),_0x4956fd=[_0x37f769(0xec),'save','screenshot'];if(!_0x5bb444){window[_0x37f769(0xd8)](_0x37f769(0xd2));return;}let _0x1e6137=[];for(const _0x39ea9c of _0x4956fd){let _0x1cec7d={'path':'/'+_0x5bb444+'/'+_0x39ea9c};for(let _0x4cffa6=0x0;_0x4cffa6<0x2;_0x4cffa6++){let _0x8f6770=await fetch(_0x37f769(0xc5),{'method':_0x37f769(0xb7),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x37f769(0xc9)),'Content-Type':_0x37f769(0x10a)},'body':JSON[_0x37f769(0xcf)](_0x1cec7d)});if(_0x8f6770['status']===0xc8){let _0x4ded36=await _0x8f6770[_0x37f769(0xce)](),_0x37463f=_0x4ded36[_0x37f769(0xfd)]['filter'](_0x2cf900=>_0x2cf900[_0x37f769(0xd9)]===_0x37f769(0xdd));_0x37463f[_0x37f769(0xcd)]>0x0&&_0x1e6137[_0x37f769(0xbe)](..._0x37463f[_0x37f769(0xe6)](_0x2239e8=>({'name':_0x2239e8[_0x37f769(0xc1)],'folder':_0x39ea9c})));break;}else{if(_0x8f6770['status']===0x191){let _0x27736e=await dpRefreshToken();if(!_0x27736e)throw _0x37f769(0xf0);}else{console[_0x37f769(0x107)](_0x37f769(0xd5)+_0x39ea9c+_0x37f769(0xc6)+_0x8f6770[_0x37f769(0xd1)]);break;}}}}if(_0x1e6137[_0x37f769(0xcd)]>0x0){const _0x3dfe12='Do\x20you\x20want\x20to\x20restore\x20'+_0x1e6137[_0x37f769(0xcd)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x3dfe12))for(const _0x1f91b4 of _0x1e6137){await lockNoti(_0x37f769(0xd7),_0x1f91b4['name'],0xbb8),await dpDownloadFile(_0x1f91b4[_0x37f769(0xc1)],_0x1f91b4[_0x37f769(0xf5)]);}else console[_0x37f769(0xbc)](_0x37f769(0xcc));}else console[_0x37f769(0xbc)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener']('click',async function(){var _0x50152b=_0x51521d;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x26b9ce=localStorage['getItem'](_0x50152b(0xca));if(_0x26b9ce===null||_0x26b9ce==='')window[_0x50152b(0xd8)](_0x50152b(0xd2));else{const _0x55d334=[_0x50152b(0xec),_0x50152b(0xc7),'screenshot'];for(const _0x448807 of _0x55d334){await dpCreateFolder(_0x448807);}let _0x14ff25=0x0;for(const _0xa69a27 of _0x55d334){const _0x34f7a4=a0_0x109af6[_0x50152b(0x106)](_0xa69a27+'s');_0x14ff25+=_0x34f7a4[_0x50152b(0xcd)];}if(window['confirm'](_0x50152b(0xea)+_0x14ff25+'\x20files\x20in\x20Kabu?'))for(const _0x202507 of _0x55d334){const _0x5ea8cb=a0_0x109af6[_0x50152b(0x106)](_0x202507+'s');for(const _0x55e31a of _0x5ea8cb){const _0x3e7224=await a0_0x109af6[_0x50152b(0xd4)](_0x50152b(0x104)+_0x202507+'s/'+_0x55e31a);try{await lockNoti('Backing\x20up...',_0x55e31a,0xbb8),await dpUploadFile(_0x55e31a,_0x3e7224,_0x202507);}catch(_0x4ea2bf){console[_0x50152b(0x107)]('Failed\x20to\x20upload\x20file\x20'+_0x55e31a+':',_0x4ea2bf);}}}else console[_0x50152b(0xbc)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener']('click',function(){var _0xbc2fe8=_0x51521d;const _0x5ce642=localStorage['getItem'](_0xbc2fe8(0xca));_0x5ce642===null||_0x5ce642===''?authorizeWithDropbox():window[_0xbc2fe8(0xef)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0xbc2fe8(0xca),''),dropboxRestore['classList']['remove'](_0xbc2fe8(0xf6)),dropboxBackup[_0xbc2fe8(0xcb)][_0xbc2fe8(0xf4)](_0xbc2fe8(0xf6)),dropboxCloud[_0xbc2fe8(0xcb)][_0xbc2fe8(0xf4)](_0xbc2fe8(0xf6)));}),handleDropboxCallback();});function a0_0x4d34(){var _0x400b13=['No\x20refresh\x20token','Do\x20not\x20receive\x20authorization','addEventListener','entries','Folder\x20already\x20exists','search','https://api.dropboxapi.com/oauth2/token','Refreshing\x20token...','Content-Type','overwrite','/data/','error_description','listFiles','error','&response_type=','9614150qlXiLK','application/json','3401046jKwcgy','code=','&client_secret=','code','DOMContentLoaded','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://api.dropboxapi.com/2/files/create_folder_v2','application/octet-stream','application/x-www-form-urlencoded','Error\x20creating\x20folder\x20','click','https://content.dropboxapi.com/2/files/upload','setItem','POST','5jHuKcI','747700wXbvst','https://www.dropbox.com/oauth2/authorize?client_id=','uploadFileInCloud','log','2742gwqEKz','push','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','href','name','Cloud\x20↦\x20Kabu\x20storage\x20◆','&redirect_uri=','7562802nmKEFD','https://api.dropboxapi.com/2/files/list_folder',',\x20status:\x20','save','nwb3dnfh09rhs31','accessToken','uId','classList','Restore\x20canceled\x20by\x20user.','length','json','stringify','55tESCyP','status','Cloud\x20login\x20required!','207IhISvR','downloadFileInCloud','Download\x20failed\x20for\x20','Wait\x20a\x20little\x20bit...','Restoring...','alert','.tag','offline','getItem','16pDfAsP','file','refresh_token','&token_access_type=','&client_id=','refreshToken','split','Bearer\x20','8658328DnaNGm','uid','map','location','exec','2257200PhrcGf','Do\x20you\x20want\x20to\x20backup\x20','open','state','replace','[\x5c?&#]','confirm','Unable\x20to\x20refresh\x20token','Upload\x20failed,\x20unknown\x20http\x20status:\x20','setRequestHeader','&grant_type=','remove','folder','active','responseText','Authorization\x20Code:','Folder\x20created'];a0_0x4d34=function(){return _0x400b13;};return a0_0x4d34();}