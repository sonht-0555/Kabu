var a0_0x3b5df9=a0_0x1e50;(function(_0x219ecc,_0x77a77){var _0x1699c6=a0_0x1e50,_0x695436=_0x219ecc();while(!![]){try{var _0x31ae19=parseInt(_0x1699c6(0x71))/0x1*(-parseInt(_0x1699c6(0x7b))/0x2)+-parseInt(_0x1699c6(0xce))/0x3*(parseInt(_0x1699c6(0xcd))/0x4)+-parseInt(_0x1699c6(0xab))/0x5*(parseInt(_0x1699c6(0x81))/0x6)+-parseInt(_0x1699c6(0xb7))/0x7*(parseInt(_0x1699c6(0x98))/0x8)+parseInt(_0x1699c6(0x86))/0x9+parseInt(_0x1699c6(0x84))/0xa+parseInt(_0x1699c6(0x89))/0xb*(parseInt(_0x1699c6(0x7a))/0xc);if(_0x31ae19===_0x77a77)break;else _0x695436['push'](_0x695436['shift']());}catch(_0x314a4a){_0x695436['push'](_0x695436['shift']());}}}(a0_0x4d3d,0x58d1e));import*as a0_0xaeb739 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x4d3d(){var _0x4db64a=['parse','screenshot','11ynGOss','split','exec','\x20files\x20in\x20Kabu?','Upload\x20failed,\x20unknown\x20http\x20status:\x20','https://api.dropboxapi.com/2/files/list_folder','click','application/json','location','length','uId','POST','error','https://api.dropboxapi.com/oauth2/token','setRequestHeader','117544ZNtnKM','knh3uz2mx2hp2eu','https://content.dropboxapi.com/2/files/download','responseText','href','Cloud\x20↦\x20Kabu\x20storage\x20◆','&token_access_type=','access_token','Error\x20while\x20refreshing\x20token:','authorization_code','Error\x20creating\x20folder\x20','remove','stringify','Kabu\x20storage\x20↦\x20Cloud\x20◆','map','/data/','json','Content-Type','[\x5c?&#]','21940resaNS','application/octet-stream','search','state','filter','Download\x20failed,\x20unknown\x20http\x20status:','code','uploadFileInCloud','\x20files\x20from\x20Cloud?','&client_id=','classList','addEventListener','280UmIHsz','Restore\x20canceled\x20by\x20user.','Folder\x20already\x20exists','entries','Folder\x20created','&grant_type=','blob','save','application/x-www-form-urlencoded','Authorization\x20Code:','onload','name','accessToken','Backing\x20up...','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','log','error_description','listFiles','nwb3dnfh09rhs31','overwrite','alert','Bearer\x20','4NnmKxR','14247dfdeks','confirm','getItem','refresh_token','code=','=([^&#]*)','setItem','38vhkuke','Cloud\x20login\x20required!','&client_secret=','&response_type=','&redirect_uri=','replace','DOMContentLoaded','status','Do\x20you\x20want\x20to\x20restore\x20','4753836RERgaw','9986rOAqbG','Failed\x20to\x20upload\x20file\x20','push','Unable\x20to\x20refresh\x20token','file','Wait\x20a\x20little\x20bit...','324tbrCUH','No\x20files\x20found\x20to\x20restore.','refreshToken','6937570wxexvy','Do\x20you\x20want\x20to\x20logout?','2637459MytTND'];a0_0x4d3d=function(){return _0x4db64a;};return a0_0x4d3d();}var clientId=a0_0x3b5df9(0x99),clientSecret=a0_0x3b5df9(0xc9);function authorizeWithDropbox(){var _0x5e919e=a0_0x3b5df9,_0x6b5e29=window[_0x5e919e(0x91)][_0x5e919e(0x9c)][_0x5e919e(0x8a)]('?')[0x0],_0x3e236d=_0x5e919e(0xb1),_0x4ca967='offline',_0x497ac6='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x5e919e(0x74)+_0x3e236d+_0x5e919e(0x9e)+_0x4ca967+'&redirect_uri='+encodeURIComponent(_0x6b5e29);window[_0x5e919e(0x91)][_0x5e919e(0x9c)]=_0x497ac6;}function handleDropboxCallback(){var _0x235d77=a0_0x3b5df9,_0x29390e=getUrlParameter(_0x235d77(0xb1));_0x29390e?(getAccessToken(_0x29390e),console['log'](_0x235d77(0xc0),_0x29390e)):console[_0x235d77(0xc6)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x495345){var _0x557505=a0_0x3b5df9;_0x495345=_0x495345[_0x557505(0x76)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x4a3e20=new RegExp(_0x557505(0xaa)+_0x495345+_0x557505(0xd3)),_0x451e5f=_0x4a3e20[_0x557505(0x8b)](location[_0x557505(0xad)]);return _0x451e5f===null?'':decodeURIComponent(_0x451e5f[0x1][_0x557505(0x76)](/\+/g,'\x20'));}function a0_0x1e50(_0x2003a8,_0x100ed4){var _0x4d3dce=a0_0x4d3d();return a0_0x1e50=function(_0x1e50bc,_0x40db5d){_0x1e50bc=_0x1e50bc-0x70;var _0x151898=_0x4d3dce[_0x1e50bc];return _0x151898;},a0_0x1e50(_0x2003a8,_0x100ed4);}function getAccessToken(_0x3b21d3){var _0x563006=a0_0x3b5df9,_0x17c957=_0x563006(0xa1),_0x42d4ce=window[_0x563006(0x91)][_0x563006(0x9c)][_0x563006(0x8a)]('?')[0x0],_0x30c94d=new XMLHttpRequest();_0x30c94d['open'](_0x563006(0x94),'https://api.dropbox.com/oauth2/token'),_0x30c94d[_0x563006(0x97)](_0x563006(0xa9),_0x563006(0xbf)),_0x30c94d[_0x563006(0xc1)]=function(){var _0x281223=_0x563006;if(_0x30c94d[_0x281223(0x78)]===0xc8){var _0x33447f=JSON[_0x281223(0x87)](_0x30c94d[_0x281223(0x9b)]),_0x4c4e8a=_0x33447f[_0x281223(0x9f)],_0x167166=_0x33447f[_0x281223(0xd1)],_0x2110db=_0x33447f['uid'];localStorage['setItem']('accessToken',_0x4c4e8a),localStorage[_0x281223(0x70)](_0x281223(0x83),_0x167166),localStorage[_0x281223(0x70)]('uId',_0x2110db);}else console[_0x281223(0xc6)](_0x281223(0xc5));},_0x30c94d['send'](_0x563006(0xd2)+_0x3b21d3+_0x563006(0xbc)+_0x17c957+_0x563006(0xb4)+clientId+_0x563006(0x73)+clientSecret+_0x563006(0x75)+encodeURIComponent(_0x42d4ce));}export async function dpCreateFolder(_0x50a664){var _0x2ed790=a0_0x3b5df9;const _0x1539f6=localStorage[_0x2ed790(0xd0)](_0x2ed790(0x93));let _0x2d0ef8=localStorage[_0x2ed790(0xd0)](_0x2ed790(0xc3));const _0x4868d1='/'+_0x1539f6+'/'+_0x50a664,_0x50fcc4=JSON[_0x2ed790(0xa4)]({'path':_0x4868d1,'autorename':![]});for(let _0x9f9792=0x0;_0x9f9792<0x2;_0x9f9792++){try{const _0x122292=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x2ed790(0x94),'headers':{'Authorization':_0x2ed790(0xcc)+_0x2d0ef8,'Content-Type':'application/json'},'body':_0x50fcc4});if(_0x122292[_0x2ed790(0x78)]===0x191){const _0x4e758e=await dpRefreshToken();if(!_0x4e758e)throw new Error(_0x2ed790(0x7e));_0x2d0ef8=localStorage[_0x2ed790(0xd0)](_0x2ed790(0xc3));continue;}if(_0x122292[_0x2ed790(0x78)]===0x199)return{'message':_0x2ed790(0xb9),'path':_0x50a664};if(!_0x122292['ok'])throw new Error(_0x2ed790(0xa2)+_0x50a664);const _0x3c625d=await _0x122292[_0x2ed790(0xa8)]();return await lockNoti(_0x2ed790(0xbb),'',0xbb8),_0x3c625d;}catch(_0x12ff5f){if(_0x9f9792===0x1)throw _0x12ff5f;}}return![];}export async function dpRefreshToken(){var _0x148175=a0_0x3b5df9;if(!localStorage['getItem'](_0x148175(0x83)))throw'No\x20refresh\x20token';try{const _0x437ffc=await fetch(_0x148175(0x96),{'method':_0x148175(0x94),'headers':{'Content-Type':_0x148175(0xbf)},'body':'refresh_token='+localStorage[_0x148175(0xd0)](_0x148175(0x83))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2ad75b=await _0x437ffc[_0x148175(0xa8)]();if(!_0x2ad75b[_0x148175(0x95)])return localStorage[_0x148175(0x70)](_0x148175(0xc3),_0x2ad75b[_0x148175(0x9f)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x2ad75b[_0x148175(0xc7)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x28e24f){console['error'](_0x148175(0xa0),_0x28e24f);}return![];}export async function dpUploadFile(_0x480682,_0x3bc535,_0x2f292d){var _0x1d600f=a0_0x3b5df9;const _0x2a4331=localStorage[_0x1d600f(0xd0)](_0x1d600f(0x93));var _0x3cb337=JSON['stringify']({'autorename':!![],'mode':_0x1d600f(0xca),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a4331+'/'+_0x2f292d+'/'+_0x480682}),_0x3d417e=new Blob([_0x3bc535],{'type':_0x1d600f(0xac)});for(var _0x9315a6=0x0;_0x9315a6<0x2;_0x9315a6++){var _0x439a69=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x1d600f(0x94),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x1d600f(0xc3)),'Dropbox-API-Arg':_0x3cb337,'Content-Type':'application/octet-stream'},'body':_0x3d417e});if(_0x439a69[_0x1d600f(0x78)]!=0xc8){if(_0x439a69[_0x1d600f(0x78)]==0x191){var _0x56f96a=await dpRefreshToken();if(!_0x56f96a)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x1d600f(0x8d)+_0x439a69[_0x1d600f(0x78)];}else{var _0x3884cb=await _0x439a69[_0x1d600f(0xa8)]();return console['log'](_0x1d600f(0xa5),_0x480682),_0x3884cb;}}return![];}export async function dpDownloadFile(_0x37657d,_0x3d9c95){var _0x63ba7b=a0_0x3b5df9;const _0x12d5b5=localStorage[_0x63ba7b(0xd0)](_0x63ba7b(0x93));var _0x4d6b3c=JSON[_0x63ba7b(0xa4)]({'path':'/'+_0x12d5b5+'/'+_0x3d9c95+'/'+_0x37657d});for(var _0x47be02=0x0;_0x47be02<0x2;_0x47be02++){var _0x54eadb=await fetch(_0x63ba7b(0x9a),{'method':_0x63ba7b(0x94),'headers':{'Authorization':_0x63ba7b(0xcc)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x4d6b3c}});if(_0x54eadb['status']!=0xc8){if(_0x54eadb[_0x63ba7b(0x78)]==0x191){var _0x51639b=await dpRefreshToken();if(!_0x51639b)throw _0x63ba7b(0x7e);continue;}else throw _0x63ba7b(0xb0)+_0x54eadb[_0x63ba7b(0x78)];}const _0x5c0cc5=new File([await _0x54eadb[_0x63ba7b(0xbd)]()],_0x37657d);return console[_0x63ba7b(0xc6)](_0x63ba7b(0x9d),_0x5c0cc5['name']),a0_0xaeb739[_0x63ba7b(0xb2)](_0x5c0cc5,()=>{}),_0x5c0cc5;}return![];}document[a0_0x3b5df9(0xb6)](a0_0x3b5df9(0x77),function(){var _0x241ea4=a0_0x3b5df9;dropboxRestore[_0x241ea4(0xb6)](_0x241ea4(0x8f),async function(){var _0x43a81e=_0x241ea4;await lockNoti(_0x43a81e(0x80),'',0x1388);const _0x3d1746=localStorage[_0x43a81e(0xd0)](_0x43a81e(0x93)),_0xd8ba94=[_0x43a81e(0xae),'save',_0x43a81e(0x88)];if(!_0x3d1746){window['alert']('Cloud\x20login\x20required!');return;}let _0x1a2d74=[];for(const _0xece8b1 of _0xd8ba94){let _0x206012={'path':'/'+_0x3d1746+'/'+_0xece8b1};for(let _0x599fe9=0x0;_0x599fe9<0x2;_0x599fe9++){let _0x133a1b=await fetch(_0x43a81e(0x8e),{'method':_0x43a81e(0x94),'headers':{'Authorization':_0x43a81e(0xcc)+localStorage['getItem'](_0x43a81e(0xc3)),'Content-Type':_0x43a81e(0x90)},'body':JSON[_0x43a81e(0xa4)](_0x206012)});if(_0x133a1b[_0x43a81e(0x78)]===0xc8){let _0x34996f=await _0x133a1b['json'](),_0x45cd96=_0x34996f[_0x43a81e(0xba)][_0x43a81e(0xaf)](_0x990cf2=>_0x990cf2['.tag']===_0x43a81e(0x7f));_0x45cd96['length']>0x0&&_0x1a2d74[_0x43a81e(0x7d)](..._0x45cd96[_0x43a81e(0xa6)](_0xa109df=>({'name':_0xa109df[_0x43a81e(0xc2)],'folder':_0xece8b1})));break;}else{if(_0x133a1b['status']===0x191){let _0x567865=await dpRefreshToken();if(!_0x567865)throw _0x43a81e(0x7e);}else{console[_0x43a81e(0x95)]('Download\x20failed\x20for\x20'+_0xece8b1+',\x20status:\x20'+_0x133a1b[_0x43a81e(0x78)]);break;}}}}if(_0x1a2d74[_0x43a81e(0x92)]>0x0){const _0x5af3d0=_0x43a81e(0x79)+_0x1a2d74[_0x43a81e(0x92)]+_0x43a81e(0xb3);if(window[_0x43a81e(0xcf)](_0x5af3d0))for(const _0x17f562 of _0x1a2d74){await lockNoti('Restoring...',_0x17f562[_0x43a81e(0xc2)],0xbb8),await dpDownloadFile(_0x17f562[_0x43a81e(0xc2)],_0x17f562['folder']);}else console[_0x43a81e(0xc6)]('Restore\x20canceled\x20by\x20user.');}else console[_0x43a81e(0xc6)](_0x43a81e(0x82));}),dropboxBackup[_0x241ea4(0xb6)](_0x241ea4(0x8f),async function(){var _0x5f5426=_0x241ea4;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x2fea94=localStorage['getItem'](_0x5f5426(0x93));if(_0x2fea94===null||_0x2fea94==='')window[_0x5f5426(0xcb)](_0x5f5426(0x72));else{const _0x4cd25d=['state',_0x5f5426(0xbe),_0x5f5426(0x88)];for(const _0x287263 of _0x4cd25d){await dpCreateFolder(_0x287263);}let _0x5d69d6=0x0;for(const _0x5008e9 of _0x4cd25d){const _0x38ee52=a0_0xaeb739[_0x5f5426(0xc8)](_0x5008e9+'s');_0x5d69d6+=_0x38ee52[_0x5f5426(0x92)];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x5d69d6+_0x5f5426(0x8c)))for(const _0x1f0b34 of _0x4cd25d){const _0x2ec835=a0_0xaeb739[_0x5f5426(0xc8)](_0x1f0b34+'s');for(const _0x72cbbb of _0x2ec835){const _0x1b4c7b=await a0_0xaeb739['downloadFileInCloud'](_0x5f5426(0xa7)+_0x1f0b34+'s/'+_0x72cbbb);try{await lockNoti(_0x5f5426(0xc4),_0x72cbbb,0xbb8),await dpUploadFile(_0x72cbbb,_0x1b4c7b,_0x1f0b34);}catch(_0x377113){console['error'](_0x5f5426(0x7c)+_0x72cbbb+':',_0x377113);}}}else console['log'](_0x5f5426(0xb8));}}),dropboxCloud[_0x241ea4(0xb6)]('click',function(){var _0x554093=_0x241ea4;const _0x332f91=localStorage[_0x554093(0xd0)](_0x554093(0x93));_0x332f91===null||_0x332f91===''?authorizeWithDropbox():window[_0x554093(0xcf)](_0x554093(0x85))&&(localStorage[_0x554093(0x70)]('uId',''),dropboxRestore['classList'][_0x554093(0xa3)]('active'),dropboxBackup[_0x554093(0xb5)][_0x554093(0xa3)]('active'),dropboxCloud[_0x554093(0xb5)][_0x554093(0xa3)]('active'));}),handleDropboxCallback();});