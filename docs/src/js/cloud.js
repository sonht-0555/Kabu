var a0_0x1493ce=a0_0xd6a9;(function(_0x3789f1,_0x2d46d5){var _0x4b9a4d=a0_0xd6a9,_0x673f23=_0x3789f1();while(!![]){try{var _0x46643b=parseInt(_0x4b9a4d(0x1fc))/0x1+-parseInt(_0x4b9a4d(0x1e6))/0x2+-parseInt(_0x4b9a4d(0x1ab))/0x3+-parseInt(_0x4b9a4d(0x1c0))/0x4+parseInt(_0x4b9a4d(0x1dd))/0x5*(-parseInt(_0x4b9a4d(0x1ff))/0x6)+parseInt(_0x4b9a4d(0x1e0))/0x7+parseInt(_0x4b9a4d(0x1f5))/0x8;if(_0x46643b===_0x2d46d5)break;else _0x673f23['push'](_0x673f23['shift']());}catch(_0x1db448){_0x673f23['push'](_0x673f23['shift']());}}}(a0_0x2c96,0xdc5cf));function a0_0x2c96(){var _0x3523f9=['refresh_token','&response_type=','Cloud\x20login\x20required!','1983186QMeSHB','&client_id=','&client_secret=','Do\x20not\x20receive\x20authorization','listFiles','length','classList','https://api.dropboxapi.com/2/files/create_folder_v2','https://content.dropboxapi.com/2/files/upload','authorization_code','remove','Refreshing\x20token...','Do\x20you\x20want\x20to\x20backup\x20','blob','save','Restore\x20canceled\x20by\x20user.','Kabu\x20storage\x20↦\x20Cloud\x20◆','map','send','offline','exec','6810148mfFVnH','DOMContentLoaded','Unable\x20to\x20refresh\x20token','entries','replace','overwrite','json','Wait\x20a\x20little\x20bit...','setItem','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','responseText','addEventListener','active','No\x20refresh\x20token','.tag','state','search','Failed\x20to\x20refresh\x20Dropbox\x20token.','Do\x20you\x20want\x20to\x20logout?','code','Authorization\x20Code:','Folder\x20already\x20exists','push','error_description','uploadFileInCloud','downloadFileInCloud','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','application/octet-stream','accessToken','193055BkUTnt','refreshToken','status','6875911GUOEBa','\x20files\x20in\x20Kabu?','https://www.dropbox.com/oauth2/authorize?client_id=','=([^&#]*)','screenshot','https://content.dropboxapi.com/2/files/download','464430mWcxRs','log','Restoring...','Bearer\x20','&grant_type=','access_token','getItem','file','Cloud\x20↦\x20Kabu\x20storage\x20◆','POST','href',',\x20status:\x20','Backing\x20up...','error','uid','27772056QQxTsu','application/x-www-form-urlencoded','https://api.dropboxapi.com/oauth2/token','name','No\x20files\x20found\x20to\x20restore.','uId','location','704914oCindW','application/json','code=','258aaPcaL','click','Folder\x20created','alert','refresh_token=','Error\x20while\x20refreshing\x20token:','https://api.dropbox.com/oauth2/token','Download\x20failed\x20for\x20','&token_access_type=','\x20files\x20from\x20Cloud?','&redirect_uri=','Do\x20you\x20want\x20to\x20restore\x20','confirm','parse','stringify'];a0_0x2c96=function(){return _0x3523f9;};return a0_0x2c96();}import*as a0_0x1288c4 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x2fa6d2=a0_0xd6a9,_0x4fd3eb=window['location'][_0x2fa6d2(0x1f0)]['split']('?')[0x0],_0x487cb9=_0x2fa6d2(0x1d3),_0x257a48=_0x2fa6d2(0x1be),_0x30838f=_0x2fa6d2(0x1e2)+clientId+_0x2fa6d2(0x1a9)+_0x487cb9+_0x2fa6d2(0x207)+_0x257a48+_0x2fa6d2(0x209)+encodeURIComponent(_0x4fd3eb);window[_0x2fa6d2(0x1fb)][_0x2fa6d2(0x1f0)]=_0x30838f;}function handleDropboxCallback(){var _0x4ea46c=a0_0xd6a9,_0x18ec17=getUrlParameter('code');_0x18ec17?(getAccessToken(_0x18ec17),console[_0x4ea46c(0x1e7)](_0x4ea46c(0x1d4),_0x18ec17)):console[_0x4ea46c(0x1e7)](_0x4ea46c(0x1ae));}function getUrlParameter(_0x1a853c){var _0x292c1d=a0_0xd6a9;_0x1a853c=_0x1a853c['replace'](/[\[]/,'\x5c[')[_0x292c1d(0x1c4)](/[\]]/,'\x5c]');var _0x5b88b7=new RegExp('[\x5c?&#]'+_0x1a853c+_0x292c1d(0x1e3)),_0x4ebf4c=_0x5b88b7[_0x292c1d(0x1bf)](location[_0x292c1d(0x1d0)]);return _0x4ebf4c===null?'':decodeURIComponent(_0x4ebf4c[0x1][_0x292c1d(0x1c4)](/\+/g,'\x20'));}function getAccessToken(_0x3f1e5e){var _0x12037f=a0_0xd6a9,_0x5256ec=_0x12037f(0x1b4),_0x72d88a=window['location'][_0x12037f(0x1f0)]['split']('?')[0x0],_0x5f5216=new XMLHttpRequest();_0x5f5216['open'](_0x12037f(0x1ef),_0x12037f(0x205)),_0x5f5216['setRequestHeader']('Content-Type',_0x12037f(0x1f6)),_0x5f5216['onload']=function(){var _0x43c652=_0x12037f;if(_0x5f5216[_0x43c652(0x1df)]===0xc8){var _0x384594=JSON[_0x43c652(0x1a6)](_0x5f5216[_0x43c652(0x1ca)]),_0x375fae=_0x384594[_0x43c652(0x1eb)],_0x38f70f=_0x384594[_0x43c652(0x1a8)],_0x137a6d=_0x384594[_0x43c652(0x1f4)];localStorage[_0x43c652(0x1c8)]('accessToken',_0x375fae),localStorage['setItem'](_0x43c652(0x1de),_0x38f70f),localStorage[_0x43c652(0x1c8)](_0x43c652(0x1fa),_0x137a6d);}else console[_0x43c652(0x1e7)](_0x43c652(0x1da));},_0x5f5216[_0x12037f(0x1bd)](_0x12037f(0x1fe)+_0x3f1e5e+_0x12037f(0x1ea)+_0x5256ec+_0x12037f(0x1ac)+clientId+_0x12037f(0x1ad)+clientSecret+_0x12037f(0x209)+encodeURIComponent(_0x72d88a));}export async function dpCreateFolder(_0x1d3ec7){var _0x27533e=a0_0xd6a9;const _0x184e25=localStorage[_0x27533e(0x1ec)](_0x27533e(0x1fa));let _0x5a346d=localStorage['getItem'](_0x27533e(0x1dc));const _0x20f7fe='/'+_0x184e25+'/'+_0x1d3ec7,_0x3baa48=JSON[_0x27533e(0x1a7)]({'path':_0x20f7fe,'autorename':![]});for(let _0x225d39=0x0;_0x225d39<0x2;_0x225d39++){try{const _0x449e14=await fetch(_0x27533e(0x1b2),{'method':'POST','headers':{'Authorization':_0x27533e(0x1e9)+_0x5a346d,'Content-Type':_0x27533e(0x1fd)},'body':_0x3baa48});if(_0x449e14[_0x27533e(0x1df)]===0x191){const _0x1e52a4=await dpRefreshToken();if(!_0x1e52a4)throw new Error(_0x27533e(0x1c2));_0x5a346d=localStorage[_0x27533e(0x1ec)](_0x27533e(0x1dc));continue;}if(_0x449e14[_0x27533e(0x1df)]===0x199)return{'message':_0x27533e(0x1d5),'path':_0x1d3ec7};if(!_0x449e14['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x1d3ec7);const _0x4bbd53=await _0x449e14['json']();return await lockNoti(_0x27533e(0x201),'',0xbb8),_0x4bbd53;}catch(_0x302e0d){if(_0x225d39===0x1)throw _0x302e0d;}}return![];}export async function dpRefreshToken(){var _0xa799af=a0_0xd6a9;if(!localStorage['getItem'](_0xa799af(0x1de)))throw _0xa799af(0x1cd);try{const _0x24befc=await fetch(_0xa799af(0x1f7),{'method':_0xa799af(0x1ef),'headers':{'Content-Type':_0xa799af(0x1f6)},'body':_0xa799af(0x203)+localStorage[_0xa799af(0x1ec)](_0xa799af(0x1de))+_0xa799af(0x1c9)}),_0x2f016f=await _0x24befc[_0xa799af(0x1c6)]();if(!_0x2f016f['error'])return localStorage['setItem']('accessToken',_0x2f016f[_0xa799af(0x1eb)]),await lockNoti(_0xa799af(0x1b6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2f016f[_0xa799af(0x1d7)]||_0xa799af(0x1d1));}catch(_0x1640b2){console[_0xa799af(0x1f3)](_0xa799af(0x204),_0x1640b2);}return![];}export async function dpUploadFile(_0x10865c,_0x1a66fb,_0x1b34be){var _0x229de7=a0_0xd6a9;const _0x9a7666=localStorage['getItem'](_0x229de7(0x1fa));var _0xed6e74=JSON[_0x229de7(0x1a7)]({'autorename':!![],'mode':_0x229de7(0x1c5),'mute':!![],'strict_conflict':![],'path':'/'+_0x9a7666+'/'+_0x1b34be+'/'+_0x10865c}),_0x50b523=new Blob([_0x1a66fb],{'type':'application/octet-stream'});for(var _0x1613f3=0x0;_0x1613f3<0x2;_0x1613f3++){var _0x40c193=await fetch(_0x229de7(0x1b3),{'method':_0x229de7(0x1ef),'headers':{'Authorization':_0x229de7(0x1e9)+localStorage['getItem'](_0x229de7(0x1dc)),'Dropbox-API-Arg':_0xed6e74,'Content-Type':_0x229de7(0x1db)},'body':_0x50b523});if(_0x40c193['status']!=0xc8){if(_0x40c193['status']==0x191){var _0x2e6b33=await dpRefreshToken();if(!_0x2e6b33)throw _0x229de7(0x1c2);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x40c193[_0x229de7(0x1df)];}else{var _0x470d9b=await _0x40c193[_0x229de7(0x1c6)]();return console[_0x229de7(0x1e7)](_0x229de7(0x1bb),_0x10865c),_0x470d9b;}}return![];}export async function dpDownloadFile(_0x79e9cd,_0x407b79){var _0x17a8dc=a0_0xd6a9;const _0x1af8ef=localStorage[_0x17a8dc(0x1ec)](_0x17a8dc(0x1fa));var _0x371b03=JSON[_0x17a8dc(0x1a7)]({'path':'/'+_0x1af8ef+'/'+_0x407b79+'/'+_0x79e9cd});for(var _0x1325f9=0x0;_0x1325f9<0x2;_0x1325f9++){var _0x43dad8=await fetch(_0x17a8dc(0x1e5),{'method':_0x17a8dc(0x1ef),'headers':{'Authorization':_0x17a8dc(0x1e9)+localStorage['getItem'](_0x17a8dc(0x1dc)),'Dropbox-API-Arg':_0x371b03}});if(_0x43dad8[_0x17a8dc(0x1df)]!=0xc8){if(_0x43dad8[_0x17a8dc(0x1df)]==0x191){var _0xfc5b82=await dpRefreshToken();if(!_0xfc5b82)throw _0x17a8dc(0x1c2);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x43dad8[_0x17a8dc(0x1df)];}const _0x2a0524=new File([await _0x43dad8[_0x17a8dc(0x1b8)]()],_0x79e9cd);return console[_0x17a8dc(0x1e7)](_0x17a8dc(0x1ee),_0x2a0524['name']),a0_0x1288c4[_0x17a8dc(0x1d8)](_0x2a0524,()=>{}),_0x2a0524;}return![];}function a0_0xd6a9(_0x43b54d,_0x240e28){var _0x2c9691=a0_0x2c96();return a0_0xd6a9=function(_0xd6a99e,_0x1db4cf){_0xd6a99e=_0xd6a99e-0x1a5;var _0xcbc171=_0x2c9691[_0xd6a99e];return _0xcbc171;},a0_0xd6a9(_0x43b54d,_0x240e28);}document['addEventListener'](a0_0x1493ce(0x1c1),function(){var _0x55b861=a0_0x1493ce;dropboxRestore[_0x55b861(0x1cb)]('click',async function(){var _0xdacbe6=_0x55b861;await lockNoti(_0xdacbe6(0x1c7),'',0x1388);const _0x1b4927=localStorage[_0xdacbe6(0x1ec)](_0xdacbe6(0x1fa)),_0x4fcb72=['state',_0xdacbe6(0x1b9),_0xdacbe6(0x1e4)];if(!_0x1b4927){window[_0xdacbe6(0x202)](_0xdacbe6(0x1aa));return;}let _0x40e4cb=[];for(const _0x54aa14 of _0x4fcb72){let _0x312f2d={'path':'/'+_0x1b4927+'/'+_0x54aa14};for(let _0x5ef92a=0x0;_0x5ef92a<0x2;_0x5ef92a++){let _0x3993ad=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0xdacbe6(0x1dc)),'Content-Type':_0xdacbe6(0x1fd)},'body':JSON['stringify'](_0x312f2d)});if(_0x3993ad[_0xdacbe6(0x1df)]===0xc8){let _0x1265be=await _0x3993ad['json'](),_0x342a92=_0x1265be[_0xdacbe6(0x1c3)]['filter'](_0x35efb5=>_0x35efb5[_0xdacbe6(0x1ce)]===_0xdacbe6(0x1ed));_0x342a92['length']>0x0&&_0x40e4cb[_0xdacbe6(0x1d6)](..._0x342a92[_0xdacbe6(0x1bc)](_0x173aee=>({'name':_0x173aee[_0xdacbe6(0x1f8)],'folder':_0x54aa14})));break;}else{if(_0x3993ad[_0xdacbe6(0x1df)]===0x191){let _0x3ff315=await dpRefreshToken();if(!_0x3ff315)throw _0xdacbe6(0x1c2);}else{console[_0xdacbe6(0x1f3)](_0xdacbe6(0x206)+_0x54aa14+_0xdacbe6(0x1f1)+_0x3993ad[_0xdacbe6(0x1df)]);break;}}}}if(_0x40e4cb[_0xdacbe6(0x1b0)]>0x0){const _0x4da3a7=_0xdacbe6(0x20a)+_0x40e4cb[_0xdacbe6(0x1b0)]+_0xdacbe6(0x208);if(window[_0xdacbe6(0x1a5)](_0x4da3a7))for(const _0x3d4d00 of _0x40e4cb){await lockNoti(_0xdacbe6(0x1e8),_0x3d4d00[_0xdacbe6(0x1f8)],0xbb8),await dpDownloadFile(_0x3d4d00['name'],_0x3d4d00['folder']);}else console[_0xdacbe6(0x1e7)](_0xdacbe6(0x1ba));}else console[_0xdacbe6(0x1e7)](_0xdacbe6(0x1f9));}),dropboxBackup[_0x55b861(0x1cb)](_0x55b861(0x200),async function(){var _0x57ff5c=_0x55b861;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x2a11a8=localStorage[_0x57ff5c(0x1ec)]('uId');if(_0x2a11a8===null||_0x2a11a8==='')window[_0x57ff5c(0x202)](_0x57ff5c(0x1aa));else{const _0x46499b=[_0x57ff5c(0x1cf),_0x57ff5c(0x1b9),_0x57ff5c(0x1e4)];for(const _0x28d488 of _0x46499b){await dpCreateFolder(_0x28d488);}let _0x18ff00=0x0;for(const _0x154358 of _0x46499b){const _0xd596a1=a0_0x1288c4[_0x57ff5c(0x1af)](_0x154358+'s');_0x18ff00+=_0xd596a1[_0x57ff5c(0x1b0)];}if(window[_0x57ff5c(0x1a5)](_0x57ff5c(0x1b7)+_0x18ff00+_0x57ff5c(0x1e1)))for(const _0x425bd8 of _0x46499b){const _0x2a3be3=a0_0x1288c4[_0x57ff5c(0x1af)](_0x425bd8+'s');for(const _0x56ac7d of _0x2a3be3){const _0x990eba=await a0_0x1288c4[_0x57ff5c(0x1d9)]('/data/'+_0x425bd8+'s/'+_0x56ac7d);try{await lockNoti(_0x57ff5c(0x1f2),_0x56ac7d,0xbb8),await dpUploadFile(_0x56ac7d,_0x990eba,_0x425bd8);}catch(_0x2d8c5a){console[_0x57ff5c(0x1f3)]('Failed\x20to\x20upload\x20file\x20'+_0x56ac7d+':',_0x2d8c5a);}}}else console[_0x57ff5c(0x1e7)](_0x57ff5c(0x1ba));}}),dropboxCloud[_0x55b861(0x1cb)](_0x55b861(0x200),function(){var _0x526023=_0x55b861;const _0x5166fc=localStorage['getItem'](_0x526023(0x1fa));_0x5166fc===null||_0x5166fc===''?authorizeWithDropbox():window[_0x526023(0x1a5)](_0x526023(0x1d2))&&(localStorage[_0x526023(0x1c8)](_0x526023(0x1fa),''),dropboxRestore[_0x526023(0x1b1)]['remove']('active'),dropboxBackup[_0x526023(0x1b1)][_0x526023(0x1b5)](_0x526023(0x1cc)),dropboxCloud[_0x526023(0x1b1)][_0x526023(0x1b5)](_0x526023(0x1cc)));}),handleDropboxCallback();});