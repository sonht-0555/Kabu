var a0_0x2bfdb1=a0_0x2f89;(function(_0x1a5ff7,_0x4cd16e){var _0x1919aa=a0_0x2f89,_0x16abd1=_0x1a5ff7();while(!![]){try{var _0x16d12d=parseInt(_0x1919aa(0x1fd))/0x1*(-parseInt(_0x1919aa(0x1ad))/0x2)+-parseInt(_0x1919aa(0x1c4))/0x3+parseInt(_0x1919aa(0x1df))/0x4+-parseInt(_0x1919aa(0x1ed))/0x5*(parseInt(_0x1919aa(0x1c3))/0x6)+parseInt(_0x1919aa(0x1ac))/0x7*(parseInt(_0x1919aa(0x1f5))/0x8)+-parseInt(_0x1919aa(0x1d2))/0x9*(parseInt(_0x1919aa(0x1c0))/0xa)+parseInt(_0x1919aa(0x1b1))/0xb;if(_0x16d12d===_0x4cd16e)break;else _0x16abd1['push'](_0x16abd1['shift']());}catch(_0x1113de){_0x16abd1['push'](_0x16abd1['shift']());}}}(a0_0x3b5d,0x2410e));import*as a0_0x27a71f from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x3b5d(){var _0x497c99=['screenshot','active','name','refresh_token=','accessToken','Download\x20failed\x20for\x20','error_description','Failed\x20to\x20upload\x20file\x20','204617ajukbS','307114tttPRh','https://api.dropboxapi.com/2/files/create_folder_v2','Authorization\x20Code:','https://www.dropbox.com/oauth2/authorize?client_id=','3640626gkBnWS','remove','POST','file','folder','filter','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','[\x5c?&#]','Cloud\x20↦\x20Kabu\x20storage\x20◆','Content-Type','Unable\x20to\x20refresh\x20token','https://content.dropboxapi.com/2/files/upload','&grant_type=','exec','json','10FlEegR','https://content.dropboxapi.com/2/files/download','nwb3dnfh09rhs31','1262166SZCVXL','139008Qinsdn','setRequestHeader','length','code','href','split','Do\x20you\x20want\x20to\x20logout?','onload','addEventListener','refresh_token','downloadFileInCloud','status','&client_secret=','Error\x20while\x20refreshing\x20token:','1483578imsHVU','Download\x20failed,\x20unknown\x20http\x20status:','&response_type=','No\x20refresh\x20token','Cloud\x20login\x20required!','https://api.dropbox.com/oauth2/token','Kabu\x20storage\x20↦\x20Cloud\x20◆','Error\x20creating\x20folder\x20','&client_id=','refreshToken','uid','click','application/octet-stream','982804OioZQC','knh3uz2mx2hp2eu','Failed\x20to\x20refresh\x20Dropbox\x20token.','&redirect_uri=','.tag','Folder\x20created','state','authorization_code','setItem','https://api.dropboxapi.com/oauth2/token','No\x20files\x20found\x20to\x20restore.','uploadFileInCloud','send','Do\x20not\x20receive\x20authorization','5IxicCU','save','entries','\x20files\x20from\x20Cloud?','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','error','open','stringify','40brtZDZ','uId','log','responseText','blob','classList','DOMContentLoaded','getItem','1oXVKPC','listFiles','application/x-www-form-urlencoded','Restore\x20canceled\x20by\x20user.','code=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','confirm','application/json','location','Bearer\x20','https://api.dropboxapi.com/2/files/list_folder'];a0_0x3b5d=function(){return _0x497c99;};return a0_0x3b5d();}var clientId=a0_0x2bfdb1(0x1e0),clientSecret=a0_0x2bfdb1(0x1c2);function authorizeWithDropbox(){var _0x536870=a0_0x2bfdb1,_0x3c5a67=window[_0x536870(0x1a1)][_0x536870(0x1c8)][_0x536870(0x1c9)]('?')[0x0],_0x1256ee='code',_0x306187='offline',_0x47e217=_0x536870(0x1b0)+clientId+_0x536870(0x1d4)+_0x1256ee+'&token_access_type='+_0x306187+'&redirect_uri='+encodeURIComponent(_0x3c5a67);window['location']['href']=_0x47e217;}function a0_0x2f89(_0x1d5ff0,_0x545cda){var _0x3b5dec=a0_0x3b5d();return a0_0x2f89=function(_0x2f8909,_0x302a93){_0x2f8909=_0x2f8909-0x19e;var _0x15c6e2=_0x3b5dec[_0x2f8909];return _0x15c6e2;},a0_0x2f89(_0x1d5ff0,_0x545cda);}function handleDropboxCallback(){var _0x15202a=a0_0x2bfdb1,_0x27f2a7=getUrlParameter(_0x15202a(0x1c7));_0x27f2a7?(getAccessToken(_0x27f2a7),console[_0x15202a(0x1f7)](_0x15202a(0x1af),_0x27f2a7)):console[_0x15202a(0x1f7)](_0x15202a(0x1ec));}function getUrlParameter(_0x33314f){var _0x2ad591=a0_0x2bfdb1;_0x33314f=_0x33314f['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2fe8f9=new RegExp(_0x2ad591(0x1b8)+_0x33314f+'=([^&#]*)'),_0x2d5c20=_0x2fe8f9[_0x2ad591(0x1be)](location['search']);return _0x2d5c20===null?'':decodeURIComponent(_0x2d5c20[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x465a85){var _0x57e417=a0_0x2bfdb1,_0x5bdb4b=_0x57e417(0x1e6),_0x48bc61=window[_0x57e417(0x1a1)]['href'][_0x57e417(0x1c9)]('?')[0x0],_0x285e22=new XMLHttpRequest();_0x285e22[_0x57e417(0x1f3)](_0x57e417(0x1b3),_0x57e417(0x1d7)),_0x285e22[_0x57e417(0x1c5)](_0x57e417(0x1ba),_0x57e417(0x1ff)),_0x285e22[_0x57e417(0x1cb)]=function(){var _0x58f1b6=_0x57e417;if(_0x285e22[_0x58f1b6(0x1cf)]===0xc8){var _0x2666a5=JSON['parse'](_0x285e22[_0x58f1b6(0x1f8)]),_0x17732d=_0x2666a5['access_token'],_0x105911=_0x2666a5[_0x58f1b6(0x1cd)],_0x27c7d5=_0x2666a5[_0x58f1b6(0x1dc)];localStorage[_0x58f1b6(0x1e7)](_0x58f1b6(0x1a8),_0x17732d),localStorage[_0x58f1b6(0x1e7)](_0x58f1b6(0x1db),_0x105911),localStorage['setItem'](_0x58f1b6(0x1f6),_0x27c7d5);}else console['log'](_0x58f1b6(0x1b7));},_0x285e22[_0x57e417(0x1eb)](_0x57e417(0x201)+_0x465a85+_0x57e417(0x1bd)+_0x5bdb4b+_0x57e417(0x1da)+clientId+_0x57e417(0x1d0)+clientSecret+_0x57e417(0x1e2)+encodeURIComponent(_0x48bc61));}export async function dpCreateFolder(_0x21459e){var _0x3d648a=a0_0x2bfdb1;const _0x16dfe8=localStorage[_0x3d648a(0x1fc)](_0x3d648a(0x1f6));let _0x43e93b=localStorage['getItem']('accessToken');const _0x2b658d='/'+_0x16dfe8+'/'+_0x21459e,_0x4a9acb=JSON[_0x3d648a(0x1f4)]({'path':_0x2b658d,'autorename':![]});for(let _0x14d653=0x0;_0x14d653<0x2;_0x14d653++){try{const _0x5c15f2=await fetch(_0x3d648a(0x1ae),{'method':_0x3d648a(0x1b3),'headers':{'Authorization':'Bearer\x20'+_0x43e93b,'Content-Type':_0x3d648a(0x1a0)},'body':_0x4a9acb});if(_0x5c15f2[_0x3d648a(0x1cf)]===0x191){const _0x35b8f9=await dpRefreshToken();if(!_0x35b8f9)throw new Error(_0x3d648a(0x1bb));_0x43e93b=localStorage[_0x3d648a(0x1fc)]('accessToken');continue;}if(_0x5c15f2[_0x3d648a(0x1cf)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x21459e};if(!_0x5c15f2['ok'])throw new Error(_0x3d648a(0x1d9)+_0x21459e);const _0x4a9058=await _0x5c15f2[_0x3d648a(0x1bf)]();return await lockNoti(_0x3d648a(0x1e4),'',0xbb8),_0x4a9058;}catch(_0x38bfce){if(_0x14d653===0x1)throw _0x38bfce;}}return![];}export async function dpRefreshToken(){var _0x566c3a=a0_0x2bfdb1;if(!localStorage[_0x566c3a(0x1fc)](_0x566c3a(0x1db)))throw _0x566c3a(0x1d5);try{const _0x484c84=await fetch(_0x566c3a(0x1e8),{'method':_0x566c3a(0x1b3),'headers':{'Content-Type':_0x566c3a(0x1ff)},'body':_0x566c3a(0x1a7)+localStorage[_0x566c3a(0x1fc)](_0x566c3a(0x1db))+_0x566c3a(0x1f1)}),_0x1f93b2=await _0x484c84[_0x566c3a(0x1bf)]();if(!_0x1f93b2[_0x566c3a(0x1f2)])return localStorage[_0x566c3a(0x1e7)](_0x566c3a(0x1a8),_0x1f93b2['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x1f93b2[_0x566c3a(0x1aa)]||_0x566c3a(0x1e1));}catch(_0x2f6f9b){console[_0x566c3a(0x1f2)](_0x566c3a(0x1d1),_0x2f6f9b);}return![];}export async function dpUploadFile(_0x247b9e,_0x3be186,_0x33d835){var _0x37d0de=a0_0x2bfdb1;const _0x4ccb85=localStorage[_0x37d0de(0x1fc)](_0x37d0de(0x1f6));var _0x100677=JSON[_0x37d0de(0x1f4)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x4ccb85+'/'+_0x33d835+'/'+_0x247b9e}),_0x241a4b=new Blob([_0x3be186],{'type':_0x37d0de(0x1de)});for(var _0x3cdc24=0x0;_0x3cdc24<0x2;_0x3cdc24++){var _0x14c694=await fetch(_0x37d0de(0x1bc),{'method':'POST','headers':{'Authorization':_0x37d0de(0x1a2)+localStorage[_0x37d0de(0x1fc)](_0x37d0de(0x1a8)),'Dropbox-API-Arg':_0x100677,'Content-Type':'application/octet-stream'},'body':_0x241a4b});if(_0x14c694[_0x37d0de(0x1cf)]!=0xc8){if(_0x14c694[_0x37d0de(0x1cf)]==0x191){var _0x2159b2=await dpRefreshToken();if(!_0x2159b2)throw _0x37d0de(0x1bb);continue;}else throw _0x37d0de(0x19e)+_0x14c694['status'];}else{var _0xf0e0c3=await _0x14c694['json']();return console['log'](_0x37d0de(0x1d8),_0x247b9e),_0xf0e0c3;}}return![];}export async function dpDownloadFile(_0x287363,_0xfcf32b){var _0x47a759=a0_0x2bfdb1;const _0x1e2854=localStorage[_0x47a759(0x1fc)](_0x47a759(0x1f6));var _0x46e0be=JSON[_0x47a759(0x1f4)]({'path':'/'+_0x1e2854+'/'+_0xfcf32b+'/'+_0x287363});for(var _0x4147b8=0x0;_0x4147b8<0x2;_0x4147b8++){var _0x1d642d=await fetch(_0x47a759(0x1c1),{'method':'POST','headers':{'Authorization':_0x47a759(0x1a2)+localStorage[_0x47a759(0x1fc)](_0x47a759(0x1a8)),'Dropbox-API-Arg':_0x46e0be}});if(_0x1d642d[_0x47a759(0x1cf)]!=0xc8){if(_0x1d642d[_0x47a759(0x1cf)]==0x191){var _0x179351=await dpRefreshToken();if(!_0x179351)throw _0x47a759(0x1bb);continue;}else throw _0x47a759(0x1d3)+_0x1d642d[_0x47a759(0x1cf)];}const _0x4ea49d=new File([await _0x1d642d[_0x47a759(0x1f9)]()],_0x287363);return console[_0x47a759(0x1f7)](_0x47a759(0x1b9),_0x4ea49d[_0x47a759(0x1a6)]),a0_0x27a71f[_0x47a759(0x1ea)](_0x4ea49d,()=>{}),_0x4ea49d;}return![];}document[a0_0x2bfdb1(0x1cc)](a0_0x2bfdb1(0x1fb),function(){var _0x266561=a0_0x2bfdb1;dropboxRestore[_0x266561(0x1cc)](_0x266561(0x1dd),async function(){var _0x1318bc=_0x266561;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x52a826=localStorage['getItem'](_0x1318bc(0x1f6)),_0x25699b=['state','save',_0x1318bc(0x1a4)];if(!_0x52a826){window['alert'](_0x1318bc(0x1d6));return;}let _0x2566f4=[];for(const _0x1ebef0 of _0x25699b){let _0x536ec8={'path':'/'+_0x52a826+'/'+_0x1ebef0};for(let _0x63cdd0=0x0;_0x63cdd0<0x2;_0x63cdd0++){let _0x34f9f1=await fetch(_0x1318bc(0x1a3),{'method':_0x1318bc(0x1b3),'headers':{'Authorization':_0x1318bc(0x1a2)+localStorage[_0x1318bc(0x1fc)](_0x1318bc(0x1a8)),'Content-Type':_0x1318bc(0x1a0)},'body':JSON['stringify'](_0x536ec8)});if(_0x34f9f1[_0x1318bc(0x1cf)]===0xc8){let _0x1abc21=await _0x34f9f1[_0x1318bc(0x1bf)](),_0x52ded7=_0x1abc21[_0x1318bc(0x1ef)][_0x1318bc(0x1b6)](_0x45b6a3=>_0x45b6a3[_0x1318bc(0x1e3)]===_0x1318bc(0x1b4));_0x52ded7[_0x1318bc(0x1c6)]>0x0&&_0x2566f4['push'](..._0x52ded7['map'](_0x295e55=>({'name':_0x295e55[_0x1318bc(0x1a6)],'folder':_0x1ebef0})));break;}else{if(_0x34f9f1[_0x1318bc(0x1cf)]===0x191){let _0x1433b4=await dpRefreshToken();if(!_0x1433b4)throw _0x1318bc(0x1bb);}else{console['error'](_0x1318bc(0x1a9)+_0x1ebef0+',\x20status:\x20'+_0x34f9f1[_0x1318bc(0x1cf)]);break;}}}}if(_0x2566f4[_0x1318bc(0x1c6)]>0x0){const _0x9060c3='Do\x20you\x20want\x20to\x20restore\x20'+_0x2566f4[_0x1318bc(0x1c6)]+_0x1318bc(0x1f0);if(window[_0x1318bc(0x19f)](_0x9060c3))for(const _0x3cb2bc of _0x2566f4){await lockNoti('Restoring...',_0x3cb2bc[_0x1318bc(0x1a6)],0xbb8),await dpDownloadFile(_0x3cb2bc[_0x1318bc(0x1a6)],_0x3cb2bc[_0x1318bc(0x1b5)]);}else console[_0x1318bc(0x1f7)](_0x1318bc(0x200));}else console[_0x1318bc(0x1f7)](_0x1318bc(0x1e9));}),dropboxBackup['addEventListener'](_0x266561(0x1dd),async function(){var _0xe66e5c=_0x266561;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x3b8c61=localStorage[_0xe66e5c(0x1fc)]('uId');if(_0x3b8c61===null||_0x3b8c61==='')window['alert'](_0xe66e5c(0x1d6));else{const _0x5286a5=[_0xe66e5c(0x1e5),_0xe66e5c(0x1ee),_0xe66e5c(0x1a4)];for(const _0x389edf of _0x5286a5){await dpCreateFolder(_0x389edf);}let _0x3884a2=0x0;for(const _0x3cd79a of _0x5286a5){const _0x30c9cd=a0_0x27a71f[_0xe66e5c(0x1fe)](_0x3cd79a+'s');_0x3884a2+=_0x30c9cd[_0xe66e5c(0x1c6)];}if(window[_0xe66e5c(0x19f)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x3884a2+'\x20files\x20in\x20Kabu?'))for(const _0x4eca31 of _0x5286a5){const _0x58caae=a0_0x27a71f[_0xe66e5c(0x1fe)](_0x4eca31+'s');for(const _0x5bd9de of _0x58caae){const _0x456ff7=await a0_0x27a71f[_0xe66e5c(0x1ce)]('/data/'+_0x4eca31+'s/'+_0x5bd9de);try{await lockNoti('Backing\x20up...',_0x5bd9de,0xbb8),await dpUploadFile(_0x5bd9de,_0x456ff7,_0x4eca31);}catch(_0x580d8a){console[_0xe66e5c(0x1f2)](_0xe66e5c(0x1ab)+_0x5bd9de+':',_0x580d8a);}}}else console[_0xe66e5c(0x1f7)](_0xe66e5c(0x200));}}),dropboxCloud['addEventListener'](_0x266561(0x1dd),function(){var _0x55ddc4=_0x266561;const _0x1fee0a=localStorage[_0x55ddc4(0x1fc)](_0x55ddc4(0x1f6));_0x1fee0a===null||_0x1fee0a===''?authorizeWithDropbox():window[_0x55ddc4(0x19f)](_0x55ddc4(0x1ca))&&(localStorage[_0x55ddc4(0x1e7)](_0x55ddc4(0x1f6),''),dropboxRestore[_0x55ddc4(0x1fa)][_0x55ddc4(0x1b2)](_0x55ddc4(0x1a5)),dropboxBackup['classList'][_0x55ddc4(0x1b2)](_0x55ddc4(0x1a5)),dropboxCloud[_0x55ddc4(0x1fa)][_0x55ddc4(0x1b2)](_0x55ddc4(0x1a5)));}),handleDropboxCallback();});