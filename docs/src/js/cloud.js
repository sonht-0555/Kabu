var a0_0x2507ba=a0_0x4ed9;(function(_0x1fb67a,_0x4f77ca){var _0x2c8891=a0_0x4ed9,_0x5ad2c3=_0x1fb67a();while(!![]){try{var _0x57cfbf=parseInt(_0x2c8891(0xaa))/0x1+-parseInt(_0x2c8891(0x8c))/0x2+parseInt(_0x2c8891(0x9a))/0x3*(parseInt(_0x2c8891(0x77))/0x4)+parseInt(_0x2c8891(0x7e))/0x5+parseInt(_0x2c8891(0xa6))/0x6*(parseInt(_0x2c8891(0xd3))/0x7)+-parseInt(_0x2c8891(0xc6))/0x8+-parseInt(_0x2c8891(0xab))/0x9*(-parseInt(_0x2c8891(0xb0))/0xa);if(_0x57cfbf===_0x4f77ca)break;else _0x5ad2c3['push'](_0x5ad2c3['shift']());}catch(_0x2925a3){_0x5ad2c3['push'](_0x5ad2c3['shift']());}}}(a0_0x1299,0x73676));import*as a0_0x1f20a2 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x4ed9(_0x25a718,_0x3561fc){var _0x1299a5=a0_0x1299();return a0_0x4ed9=function(_0x4ed9ff,_0x4c200b){_0x4ed9ff=_0x4ed9ff-0x6e;var _0x28a42e=_0x1299a5[_0x4ed9ff];return _0x28a42e;},a0_0x4ed9(_0x25a718,_0x3561fc);}var clientId=a0_0x2507ba(0x86),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x486ea4=a0_0x2507ba,_0x166543=window[_0x486ea4(0x75)]['href'][_0x486ea4(0xa0)]('?')[0x0],_0x540000=_0x486ea4(0x91),_0x5d5ea9=_0x486ea4(0x90),_0x3a2173='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x540000+'&token_access_type='+_0x5d5ea9+_0x486ea4(0xcd)+encodeURIComponent(_0x166543);window[_0x486ea4(0x75)][_0x486ea4(0x87)]=_0x3a2173;}function handleDropboxCallback(){var _0x35e3c6=a0_0x2507ba,_0x15d493=getUrlParameter(_0x35e3c6(0x91));_0x15d493?(getAccessToken(_0x15d493),console[_0x35e3c6(0xb2)](_0x35e3c6(0xa7),_0x15d493)):console[_0x35e3c6(0xb2)](_0x35e3c6(0x99));}function getUrlParameter(_0x276b81){var _0x37540c=a0_0x2507ba;_0x276b81=_0x276b81[_0x37540c(0x9c)](/[\[]/,'\x5c[')[_0x37540c(0x9c)](/[\]]/,'\x5c]');var _0x1d3333=new RegExp(_0x37540c(0x9e)+_0x276b81+_0x37540c(0xd6)),_0x3b81fd=_0x1d3333['exec'](location[_0x37540c(0xd4)]);return _0x3b81fd===null?'':decodeURIComponent(_0x3b81fd[0x1][_0x37540c(0x9c)](/\+/g,'\x20'));}function getAccessToken(_0x4cc4d3){var _0x5164bc=a0_0x2507ba,_0x2f4772=_0x5164bc(0x85),_0x3f2d9d=window[_0x5164bc(0x75)][_0x5164bc(0x87)][_0x5164bc(0xa0)]('?')[0x0],_0x524101=new XMLHttpRequest();_0x524101[_0x5164bc(0xcc)]('POST',_0x5164bc(0xc0)),_0x524101[_0x5164bc(0xbd)]('Content-Type',_0x5164bc(0x80)),_0x524101[_0x5164bc(0xb7)]=function(){var _0x38eebd=_0x5164bc;if(_0x524101['status']===0xc8){var _0x37c71c=JSON['parse'](_0x524101[_0x38eebd(0x9d)]),_0xb7171b=_0x37c71c['access_token'],_0x537e51=_0x37c71c[_0x38eebd(0xb1)],_0x44c93b=_0x37c71c[_0x38eebd(0xd2)];localStorage[_0x38eebd(0xa3)]('accessToken',_0xb7171b),localStorage['setItem'](_0x38eebd(0x70),_0x537e51),localStorage[_0x38eebd(0xa3)](_0x38eebd(0x72),_0x44c93b);}else console[_0x38eebd(0xb2)](_0x38eebd(0xb8));},_0x524101['send'](_0x5164bc(0x8e)+_0x4cc4d3+_0x5164bc(0x71)+_0x2f4772+_0x5164bc(0xce)+clientId+_0x5164bc(0x95)+clientSecret+_0x5164bc(0xcd)+encodeURIComponent(_0x3f2d9d));}export async function dpCreateFolder(_0xc6f01b){var _0x2419fe=a0_0x2507ba;const _0xb17196=localStorage[_0x2419fe(0x8d)](_0x2419fe(0x72));let _0x45ed72=localStorage[_0x2419fe(0x8d)](_0x2419fe(0x7c));const _0x20ec32='/'+_0xb17196+'/'+_0xc6f01b,_0x5d7ed9=JSON[_0x2419fe(0xb9)]({'path':_0x20ec32,'autorename':![]});for(let _0x461523=0x0;_0x461523<0x2;_0x461523++){try{const _0x1562f4=await fetch(_0x2419fe(0xcb),{'method':_0x2419fe(0x74),'headers':{'Authorization':'Bearer\x20'+_0x45ed72,'Content-Type':'application/json'},'body':_0x5d7ed9});if(_0x1562f4[_0x2419fe(0xbb)]===0x191){const _0x26f9bc=await dpRefreshToken();if(!_0x26f9bc)throw new Error('Unable\x20to\x20refresh\x20token');_0x45ed72=localStorage[_0x2419fe(0x8d)](_0x2419fe(0x7c));continue;}if(_0x1562f4[_0x2419fe(0xbb)]===0x199)return{'message':_0x2419fe(0xcf),'path':_0xc6f01b};if(!_0x1562f4['ok'])throw new Error(_0x2419fe(0x7b)+_0xc6f01b);const _0x148440=await _0x1562f4[_0x2419fe(0x84)]();return await lockNoti(_0x2419fe(0x89),'',0xbb8),_0x148440;}catch(_0x4988ee){if(_0x461523===0x1)throw _0x4988ee;}}return![];}export async function dpRefreshToken(){var _0x1a74b9=a0_0x2507ba;if(!localStorage['getItem'](_0x1a74b9(0x70)))throw _0x1a74b9(0xbf);try{const _0x3baf40=await fetch(_0x1a74b9(0xb3),{'method':_0x1a74b9(0x74),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage['getItem'](_0x1a74b9(0x70))+_0x1a74b9(0x8b)}),_0x586b71=await _0x3baf40[_0x1a74b9(0x84)]();if(!_0x586b71[_0x1a74b9(0x78)])return localStorage['setItem'](_0x1a74b9(0x7c),_0x586b71[_0x1a74b9(0xaf)]),await lockNoti(_0x1a74b9(0xa8),'',0xbb8),await delay(0x3e8),!![];else alert(_0x586b71[_0x1a74b9(0xa5)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0xf07d4b){console[_0x1a74b9(0x78)](_0x1a74b9(0xc8),_0xf07d4b);}return![];}export async function dpUploadFile(_0x1f7ae7,_0xfb65d0,_0x52584d){var _0x5ee9b9=a0_0x2507ba;const _0x425a5f=localStorage['getItem'](_0x5ee9b9(0x72));var _0x6ec7fc=JSON[_0x5ee9b9(0xb9)]({'autorename':!![],'mode':_0x5ee9b9(0xc1),'mute':!![],'strict_conflict':![],'path':'/'+_0x425a5f+'/'+_0x52584d+'/'+_0x1f7ae7}),_0x58d69d=new Blob([_0xfb65d0],{'type':_0x5ee9b9(0x8a)});for(var _0xde7f6b=0x0;_0xde7f6b<0x2;_0xde7f6b++){var _0x3411aa=await fetch(_0x5ee9b9(0xc4),{'method':_0x5ee9b9(0x74),'headers':{'Authorization':_0x5ee9b9(0xb5)+localStorage[_0x5ee9b9(0x8d)](_0x5ee9b9(0x7c)),'Dropbox-API-Arg':_0x6ec7fc,'Content-Type':_0x5ee9b9(0x8a)},'body':_0x58d69d});if(_0x3411aa[_0x5ee9b9(0xbb)]!=0xc8){if(_0x3411aa['status']==0x191){var _0x21db0e=await dpRefreshToken();if(!_0x21db0e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5ee9b9(0x79)+_0x3411aa['status'];}else{var _0x49e523=await _0x3411aa[_0x5ee9b9(0x84)]();return console[_0x5ee9b9(0xb2)](_0x5ee9b9(0x94),_0x1f7ae7),_0x49e523;}}return![];}function a0_0x1299(){var _0x566ac9=['responseText','[\x5c?&#]','name','split','alert','FSSync','setItem','https://content.dropboxapi.com/2/files/download','error_description','1303782QBOaIe','Authorization\x20Code:','Refreshing\x20token...','Restoring...','811284PYHAKw','1494tPhoMI','\x20files\x20in\x20Kabu?','active','Download\x20failed\x20for\x20','access_token','4020Duevlj','refresh_token','log','https://api.dropboxapi.com/oauth2/token','Do\x20you\x20want\x20to\x20backup\x20','Bearer\x20','Wait\x20a\x20little\x20bit...','onload','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','stringify','toUpperCase','status','state','setRequestHeader','length','No\x20refresh\x20token','https://api.dropbox.com/oauth2/token','overwrite','downloadFileInCloud','entries','https://content.dropboxapi.com/2/files/upload','Backing\x20up...','7127240zaVHkO','map','Error\x20while\x20refreshing\x20token:','Unable\x20to\x20refresh\x20token','save','https://api.dropboxapi.com/2/files/create_folder_v2','open','&redirect_uri=','&client_id=','Folder\x20already\x20exists','charAt','.tag','uid','21kLIbYJ','search','Download\x20failed,\x20unknown\x20http\x20status:','=([^&#]*)','list','uploadFileInCloud','refreshToken','&grant_type=','uId','application/json','POST','location','filter','544708ItwnRX','error','Upload\x20failed,\x20unknown\x20http\x20status:\x20','https://api.dropboxapi.com/2/files/list_folder','Error\x20creating\x20folder\x20','accessToken','Do\x20you\x20want\x20to\x20restore\x20','69165vOZtri','slice','application/x-www-form-urlencoded','push',',\x20status:\x20','folder','json','authorization_code','knh3uz2mx2hp2eu','href','classList','Folder\x20created','application/octet-stream','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','1722052DkkiEB','getItem','code=','addEventListener','offline','code','blob','remove','Kabu\x20storage\x20↦\x20Cloud\x20◆','&client_secret=','Restore\x20canceled\x20by\x20user.','confirm','Cloud\x20login\x20required!','Do\x20not\x20receive\x20authorization','15zrcitP','DOMContentLoaded','replace'];a0_0x1299=function(){return _0x566ac9;};return a0_0x1299();}export async function dpDownloadFile(_0x51dc61,_0x38690f){var _0x4ba654=a0_0x2507ba;const _0x2a2b9a=localStorage['getItem'](_0x4ba654(0x72));var _0x38895e=JSON[_0x4ba654(0xb9)]({'path':'/'+_0x2a2b9a+'/'+_0x38690f+'/'+_0x51dc61});for(var _0x282f72=0x0;_0x282f72<0x2;_0x282f72++){var _0x7c088d=await fetch(_0x4ba654(0xa4),{'method':_0x4ba654(0x74),'headers':{'Authorization':_0x4ba654(0xb5)+localStorage[_0x4ba654(0x8d)](_0x4ba654(0x7c)),'Dropbox-API-Arg':_0x38895e}});if(_0x7c088d[_0x4ba654(0xbb)]!=0xc8){if(_0x7c088d[_0x4ba654(0xbb)]==0x191){var _0x2a771=await dpRefreshToken();if(!_0x2a771)throw _0x4ba654(0xc9);continue;}else throw _0x4ba654(0xd5)+_0x7c088d[_0x4ba654(0xbb)];}const _0x42dba2=new File([await _0x7c088d[_0x4ba654(0x92)]()],_0x51dc61);return console[_0x4ba654(0xb2)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x42dba2['name']),a0_0x1f20a2[_0x4ba654(0x6f)](_0x42dba2,()=>{var _0x2225b2=_0x4ba654;localStorageFile(),Module[_0x2225b2(0xa2)]();}),_0x42dba2;}return![];}document['addEventListener'](a0_0x2507ba(0x9b),function(){var _0x1d45c5=a0_0x2507ba;dropboxRestore[_0x1d45c5(0x8f)]('click',async function(){var _0x4f3bf7=_0x1d45c5;await lockNoti(_0x4f3bf7(0xb6),'',0x1388);const _0x4b6418=localStorage['getItem'](_0x4f3bf7(0x72)),_0xf305f4=[_0x4f3bf7(0xbc),_0x4f3bf7(0xca),'screenshot'];if(!_0x4b6418){window['alert'](_0x4f3bf7(0x98));return;}let _0x42a023=[];for(const _0x5ee8e3 of _0xf305f4){let _0xff42d3={'path':'/'+_0x4b6418+'/'+_0x5ee8e3};for(let _0x196099=0x0;_0x196099<0x2;_0x196099++){let _0x425ee4=await fetch(_0x4f3bf7(0x7a),{'method':'POST','headers':{'Authorization':_0x4f3bf7(0xb5)+localStorage[_0x4f3bf7(0x8d)](_0x4f3bf7(0x7c)),'Content-Type':_0x4f3bf7(0x73)},'body':JSON['stringify'](_0xff42d3)});if(_0x425ee4[_0x4f3bf7(0xbb)]===0xc8){let _0x4237b4=await _0x425ee4[_0x4f3bf7(0x84)](),_0x36e2b5=_0x4237b4[_0x4f3bf7(0xc3)][_0x4f3bf7(0x76)](_0x309b4b=>_0x309b4b[_0x4f3bf7(0xd1)]==='file');_0x36e2b5[_0x4f3bf7(0xbe)]>0x0&&_0x42a023[_0x4f3bf7(0x81)](..._0x36e2b5[_0x4f3bf7(0xc7)](_0x1d1697=>({'name':_0x1d1697['name'],'folder':_0x5ee8e3})));break;}else{if(_0x425ee4['status']===0x191){let _0x33556a=await dpRefreshToken();if(!_0x33556a)throw _0x4f3bf7(0xc9);}else{console[_0x4f3bf7(0x78)](_0x4f3bf7(0xae)+_0x5ee8e3+_0x4f3bf7(0x82)+_0x425ee4['status']);break;}}}}if(_0x42a023['length']>0x0){const _0x565dab=_0x4f3bf7(0x7d)+_0x42a023['length']+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x565dab))for(const _0x2693fc of _0x42a023){await lockNoti(_0x4f3bf7(0xa9),_0x2693fc[_0x4f3bf7(0x9f)],0xbb8),await dpDownloadFile(_0x2693fc[_0x4f3bf7(0x9f)],_0x2693fc[_0x4f3bf7(0x83)]);}else console[_0x4f3bf7(0xb2)](_0x4f3bf7(0x96));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x1d45c5(0x8f)]('click',async function(){var _0x22e14b=_0x1d45c5;await lockNoti(_0x22e14b(0xb6),'',0x1388);const _0x49f539=localStorage[_0x22e14b(0x8d)](_0x22e14b(0x72));if(_0x49f539===null||_0x49f539==='')window[_0x22e14b(0xa1)](_0x22e14b(0x98));else{const _0x5259a6=[_0x22e14b(0xbc),_0x22e14b(0xca),'screenshot'];for(const _0x85d4f8 of _0x5259a6){await dpCreateFolder(_0x85d4f8);}let _0x3506b3=0x0;for(const _0xb94951 of _0x5259a6){const _0x5db1b5=a0_0x1f20a2['list'+(_0xb94951[_0x22e14b(0xd0)](0x0)[_0x22e14b(0xba)]()+_0xb94951[_0x22e14b(0x7f)](0x1))]();_0x3506b3+=_0x5db1b5['length'];}if(window[_0x22e14b(0x97)](_0x22e14b(0xb4)+_0x3506b3+_0x22e14b(0xac)))for(const _0x40e854 of _0x5259a6){const _0x3805a4=a0_0x1f20a2[_0x22e14b(0x6e)+(_0x40e854[_0x22e14b(0xd0)](0x0)['toUpperCase']()+_0x40e854[_0x22e14b(0x7f)](0x1))]();for(const _0x5bc8d6 of _0x3805a4){const _0x128dd5=await a0_0x1f20a2[_0x22e14b(0xc2)]('/data/'+_0x40e854+'s/'+_0x5bc8d6);try{await lockNoti(_0x22e14b(0xc5),_0x5bc8d6,0xbb8),await dpUploadFile(_0x5bc8d6,_0x128dd5,_0x40e854);}catch(_0x45ee45){console[_0x22e14b(0x78)]('Failed\x20to\x20upload\x20file\x20'+_0x5bc8d6+':',_0x45ee45);}}}else console[_0x22e14b(0xb2)](_0x22e14b(0x96));}}),dropboxCloud['addEventListener']('click',function(){var _0x304098=_0x1d45c5;const _0x20503a=localStorage[_0x304098(0x8d)](_0x304098(0x72));_0x20503a===null||_0x20503a===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x304098(0xa3)](_0x304098(0x72),''),dropboxRestore[_0x304098(0x88)][_0x304098(0x93)](_0x304098(0xad)),dropboxBackup[_0x304098(0x88)]['remove'](_0x304098(0xad)),dropboxCloud[_0x304098(0x88)][_0x304098(0x93)](_0x304098(0xad)));}),handleDropboxCallback();});