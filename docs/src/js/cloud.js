function a0_0x117f(){var _0x564eaa=['Kabu\x20storage\x20↦\x20Cloud\x20◆','12eoTuvG','code','href','application/x-www-form-urlencoded','Upload\x20failed,\x20unknown\x20http\x20status:\x20','responseText','Authorization\x20Code:','https://api.dropboxapi.com/2/files/list_folder','split','\x20files\x20in\x20Kabu?','error','application/json','Folder\x20already\x20exists','active','application/octet-stream','Error\x20while\x20refreshing\x20token:','Cloud\x20login\x20required!','setRequestHeader','https://api.dropboxapi.com/2/files/create_folder_v2','Folder\x20created','Do\x20you\x20want\x20to\x20logout?','map','/data/','Failed\x20to\x20refresh\x20Dropbox\x20token.','state','Download\x20failed\x20for\x20','blob','parse','https://content.dropboxapi.com/2/files/download','stringify','save','344410XgAgaN','nwb3dnfh09rhs31','accessToken','Refreshing\x20token...','refresh_token=','access_token','POST','name','offline','Content-Type','location','\x20files\x20from\x20Cloud?','status','downloadFileInCloud','7534251JtUGhl','refreshToken','replace','onload','49heZqvu','code=','.tag','file','uId','https://content.dropboxapi.com/2/files/upload','authorization_code','Error\x20creating\x20folder\x20','No\x20refresh\x20token','error_description','classList','exec','remove','screenshot','alert','Do\x20you\x20want\x20to\x20backup\x20','Do\x20you\x20want\x20to\x20restore\x20','&client_secret=','click','entries','setItem','13170010UjIKTU','listFiles','[\x5c?&#]','uploadFileInCloud','log','Bearer\x20','addEventListener','send','=([^&#]*)','getItem','2456080KuZTHF','Do\x20not\x20receive\x20authorization','confirm','Backing\x20up...','Wait\x20a\x20little\x20bit...','Cloud\x20↦\x20Kabu\x20storage\x20◆','Restoring...','6FjOaWP','Restore\x20canceled\x20by\x20user.','1034200OxRtvg','&response_type=','filter','length','refresh_token','&client_id=','uid','Failed\x20to\x20upload\x20file\x20','json','Unable\x20to\x20refresh\x20token','608382TBGkGS','https://api.dropboxapi.com/oauth2/token','209760VNKdra','folder','&token_access_type=',',\x20status:\x20','search'];a0_0x117f=function(){return _0x564eaa;};return a0_0x117f();}var a0_0x20e3a9=a0_0x2527;(function(_0x18dd0c,_0x32d7f2){var _0xaf93e2=a0_0x2527,_0x5953ac=_0x18dd0c();while(!![]){try{var _0x956d70=-parseInt(_0xaf93e2(0xb1))/0x1+-parseInt(_0xaf93e2(0xa5))/0x2*(-parseInt(_0xaf93e2(0xb3))/0x3)+-parseInt(_0xaf93e2(0x9e))/0x4+parseInt(_0xaf93e2(0xd8))/0x5*(parseInt(_0xaf93e2(0xb9))/0x6)+-parseInt(_0xaf93e2(0x7f))/0x7*(-parseInt(_0xaf93e2(0xa7))/0x8)+-parseInt(_0xaf93e2(0x7b))/0x9+parseInt(_0xaf93e2(0x94))/0xa;if(_0x956d70===_0x32d7f2)break;else _0x5953ac['push'](_0x5953ac['shift']());}catch(_0x2c8942){_0x5953ac['push'](_0x5953ac['shift']());}}}(a0_0x117f,0x7c7d5));import*as a0_0x27aef6 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x20e3a9(0xd9);function authorizeWithDropbox(){var _0x5697ec=a0_0x20e3a9,_0x5e33ac=window[_0x5697ec(0x77)]['href'][_0x5697ec(0xc1)]('?')[0x0],_0x3b284a=_0x5697ec(0xba),_0x1b4a7b=_0x5697ec(0x75),_0xa661f8='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x5697ec(0xa8)+_0x3b284a+_0x5697ec(0xb5)+_0x1b4a7b+'&redirect_uri='+encodeURIComponent(_0x5e33ac);window[_0x5697ec(0x77)][_0x5697ec(0xbb)]=_0xa661f8;}function handleDropboxCallback(){var _0x473836=a0_0x20e3a9,_0x23f760=getUrlParameter(_0x473836(0xba));_0x23f760?(getAccessToken(_0x23f760),console[_0x473836(0x98)](_0x473836(0xbf),_0x23f760)):console[_0x473836(0x98)](_0x473836(0x9f));}function getUrlParameter(_0x3d7323){var _0x158aee=a0_0x20e3a9;_0x3d7323=_0x3d7323['replace'](/[\[]/,'\x5c[')[_0x158aee(0x7d)](/[\]]/,'\x5c]');var _0x14ee81=new RegExp(_0x158aee(0x96)+_0x3d7323+_0x158aee(0x9c)),_0x1ba93f=_0x14ee81[_0x158aee(0x8a)](location[_0x158aee(0xb7)]);return _0x1ba93f===null?'':decodeURIComponent(_0x1ba93f[0x1][_0x158aee(0x7d)](/\+/g,'\x20'));}function getAccessToken(_0x1f4c98){var _0x1cc32a=a0_0x20e3a9,_0x3c7489=_0x1cc32a(0x85),_0x5617f0=window[_0x1cc32a(0x77)][_0x1cc32a(0xbb)][_0x1cc32a(0xc1)]('?')[0x0],_0x5675cb=new XMLHttpRequest();_0x5675cb['open'](_0x1cc32a(0x73),'https://api.dropbox.com/oauth2/token'),_0x5675cb[_0x1cc32a(0xca)](_0x1cc32a(0x76),_0x1cc32a(0xbc)),_0x5675cb[_0x1cc32a(0x7e)]=function(){var _0x11c176=_0x1cc32a;if(_0x5675cb[_0x11c176(0x79)]===0xc8){var _0x51a515=JSON[_0x11c176(0xd4)](_0x5675cb[_0x11c176(0xbe)]),_0x2fbc7d=_0x51a515['access_token'],_0x44646d=_0x51a515[_0x11c176(0xab)],_0x4e5f58=_0x51a515[_0x11c176(0xad)];localStorage[_0x11c176(0x93)](_0x11c176(0x6f),_0x2fbc7d),localStorage[_0x11c176(0x93)](_0x11c176(0x7c),_0x44646d),localStorage['setItem']('uId',_0x4e5f58);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x5675cb[_0x1cc32a(0x9b)](_0x1cc32a(0x80)+_0x1f4c98+'&grant_type='+_0x3c7489+_0x1cc32a(0xac)+clientId+_0x1cc32a(0x90)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5617f0));}export async function dpCreateFolder(_0x3647e4){var _0x48f757=a0_0x20e3a9;const _0x54c86e=localStorage[_0x48f757(0x9d)]('uId');let _0x46820b=localStorage[_0x48f757(0x9d)](_0x48f757(0x6f));const _0x5739fb='/'+_0x54c86e+'/'+_0x3647e4,_0x5ca19b=JSON[_0x48f757(0xd6)]({'path':_0x5739fb,'autorename':![]});for(let _0x1c345c=0x0;_0x1c345c<0x2;_0x1c345c++){try{const _0x1ecc2a=await fetch(_0x48f757(0xcb),{'method':_0x48f757(0x73),'headers':{'Authorization':_0x48f757(0x99)+_0x46820b,'Content-Type':_0x48f757(0xc4)},'body':_0x5ca19b});if(_0x1ecc2a[_0x48f757(0x79)]===0x191){const _0x3c7269=await dpRefreshToken();if(!_0x3c7269)throw new Error(_0x48f757(0xb0));_0x46820b=localStorage[_0x48f757(0x9d)](_0x48f757(0x6f));continue;}if(_0x1ecc2a['status']===0x199)return{'message':_0x48f757(0xc5),'path':_0x3647e4};if(!_0x1ecc2a['ok'])throw new Error(_0x48f757(0x86)+_0x3647e4);const _0xc22550=await _0x1ecc2a['json']();return await lockNoti(_0x48f757(0xcc),'',0xbb8),_0xc22550;}catch(_0x4c7c1d){if(_0x1c345c===0x1)throw _0x4c7c1d;}}return![];}export async function dpRefreshToken(){var _0x55118e=a0_0x20e3a9;if(!localStorage[_0x55118e(0x9d)](_0x55118e(0x7c)))throw _0x55118e(0x87);try{const _0x4f167a=await fetch(_0x55118e(0xb2),{'method':_0x55118e(0x73),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x55118e(0x71)+localStorage[_0x55118e(0x9d)]('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x1e8a55=await _0x4f167a[_0x55118e(0xaf)]();if(!_0x1e8a55[_0x55118e(0xc3)])return localStorage[_0x55118e(0x93)](_0x55118e(0x6f),_0x1e8a55[_0x55118e(0x72)]),await lockNoti(_0x55118e(0x70),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1e8a55[_0x55118e(0x88)]||_0x55118e(0xd0));}catch(_0x1e279a){console[_0x55118e(0xc3)](_0x55118e(0xc8),_0x1e279a);}return![];}export async function dpUploadFile(_0x7e90b9,_0x262938,_0x75e089){var _0x1d1610=a0_0x20e3a9;const _0x295b8b=localStorage['getItem'](_0x1d1610(0x83));var _0x1787c9=JSON[_0x1d1610(0xd6)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x295b8b+'/'+_0x75e089+'/'+_0x7e90b9}),_0x337acc=new Blob([_0x262938],{'type':_0x1d1610(0xc7)});for(var _0x23a5d7=0x0;_0x23a5d7<0x2;_0x23a5d7++){var _0x3524b6=await fetch(_0x1d1610(0x84),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x1d1610(0x9d)](_0x1d1610(0x6f)),'Dropbox-API-Arg':_0x1787c9,'Content-Type':_0x1d1610(0xc7)},'body':_0x337acc});if(_0x3524b6[_0x1d1610(0x79)]!=0xc8){if(_0x3524b6['status']==0x191){var _0x114ea3=await dpRefreshToken();if(!_0x114ea3)throw _0x1d1610(0xb0);continue;}else throw _0x1d1610(0xbd)+_0x3524b6[_0x1d1610(0x79)];}else{var _0x98b740=await _0x3524b6[_0x1d1610(0xaf)]();return console[_0x1d1610(0x98)](_0x1d1610(0xb8),_0x7e90b9),_0x98b740;}}return![];}function a0_0x2527(_0x66e0e8,_0x357f2f){var _0x117f77=a0_0x117f();return a0_0x2527=function(_0x252721,_0x3974eb){_0x252721=_0x252721-0x6f;var _0x1f215e=_0x117f77[_0x252721];return _0x1f215e;},a0_0x2527(_0x66e0e8,_0x357f2f);}export async function dpDownloadFile(_0x80f005,_0x13fc8b){var _0xed80a6=a0_0x20e3a9;const _0x201d63=localStorage[_0xed80a6(0x9d)]('uId');var _0x14a3ce=JSON[_0xed80a6(0xd6)]({'path':'/'+_0x201d63+'/'+_0x13fc8b+'/'+_0x80f005});for(var _0x372260=0x0;_0x372260<0x2;_0x372260++){var _0x55f836=await fetch(_0xed80a6(0xd5),{'method':_0xed80a6(0x73),'headers':{'Authorization':_0xed80a6(0x99)+localStorage[_0xed80a6(0x9d)]('accessToken'),'Dropbox-API-Arg':_0x14a3ce}});if(_0x55f836[_0xed80a6(0x79)]!=0xc8){if(_0x55f836[_0xed80a6(0x79)]==0x191){var _0x40a4fd=await dpRefreshToken();if(!_0x40a4fd)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x55f836[_0xed80a6(0x79)];}const _0x188170=new File([await _0x55f836[_0xed80a6(0xd3)]()],_0x80f005);return console[_0xed80a6(0x98)](_0xed80a6(0xa3),_0x188170[_0xed80a6(0x74)]),a0_0x27aef6[_0xed80a6(0x97)](_0x188170,()=>{}),_0x188170;}return![];}document[a0_0x20e3a9(0x9a)]('DOMContentLoaded',function(){var _0x2bcf9e=a0_0x20e3a9;dropboxRestore[_0x2bcf9e(0x9a)](_0x2bcf9e(0x91),async function(){var _0x5a18ec=_0x2bcf9e;await lockNoti(_0x5a18ec(0xa2),'',0x1388);const _0x229e82=localStorage[_0x5a18ec(0x9d)](_0x5a18ec(0x83)),_0x4d8caa=[_0x5a18ec(0xd1),'save',_0x5a18ec(0x8c)];if(!_0x229e82){window['alert'](_0x5a18ec(0xc9));return;}let _0x41c302=[];for(const _0x13d26c of _0x4d8caa){let _0x206005={'path':'/'+_0x229e82+'/'+_0x13d26c};for(let _0x53ce08=0x0;_0x53ce08<0x2;_0x53ce08++){let _0x540ec3=await fetch(_0x5a18ec(0xc0),{'method':_0x5a18ec(0x73),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x5a18ec(0x6f)),'Content-Type':_0x5a18ec(0xc4)},'body':JSON['stringify'](_0x206005)});if(_0x540ec3[_0x5a18ec(0x79)]===0xc8){let _0x18c3c2=await _0x540ec3[_0x5a18ec(0xaf)](),_0x36b553=_0x18c3c2[_0x5a18ec(0x92)][_0x5a18ec(0xa9)](_0x55e4fd=>_0x55e4fd[_0x5a18ec(0x81)]===_0x5a18ec(0x82));_0x36b553[_0x5a18ec(0xaa)]>0x0&&_0x41c302['push'](..._0x36b553[_0x5a18ec(0xce)](_0xf5e8e7=>({'name':_0xf5e8e7[_0x5a18ec(0x74)],'folder':_0x13d26c})));break;}else{if(_0x540ec3[_0x5a18ec(0x79)]===0x191){let _0x1b497e=await dpRefreshToken();if(!_0x1b497e)throw _0x5a18ec(0xb0);}else{console[_0x5a18ec(0xc3)](_0x5a18ec(0xd2)+_0x13d26c+_0x5a18ec(0xb6)+_0x540ec3[_0x5a18ec(0x79)]);break;}}}}if(_0x41c302[_0x5a18ec(0xaa)]>0x0){const _0x45badb=_0x5a18ec(0x8f)+_0x41c302[_0x5a18ec(0xaa)]+_0x5a18ec(0x78);if(window[_0x5a18ec(0xa0)](_0x45badb))for(const _0x3e1575 of _0x41c302){await lockNoti(_0x5a18ec(0xa4),_0x3e1575[_0x5a18ec(0x74)],0xbb8),await dpDownloadFile(_0x3e1575[_0x5a18ec(0x74)],_0x3e1575[_0x5a18ec(0xb4)]);}else console[_0x5a18ec(0x98)](_0x5a18ec(0xa6));}else console[_0x5a18ec(0x98)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x2bcf9e(0x9a)](_0x2bcf9e(0x91),async function(){var _0x11fdcc=_0x2bcf9e;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x57c1d5=localStorage[_0x11fdcc(0x9d)](_0x11fdcc(0x83));if(_0x57c1d5===null||_0x57c1d5==='')window[_0x11fdcc(0x8d)](_0x11fdcc(0xc9));else{const _0x47da2e=[_0x11fdcc(0xd1),_0x11fdcc(0xd7),_0x11fdcc(0x8c)];for(const _0x101595 of _0x47da2e){await dpCreateFolder(_0x101595);}let _0x4161ef=0x0;for(const _0x311af3 of _0x47da2e){const _0x5cf8d0=a0_0x27aef6[_0x11fdcc(0x95)](_0x311af3+'s');_0x4161ef+=_0x5cf8d0['length'];}if(window['confirm'](_0x11fdcc(0x8e)+_0x4161ef+_0x11fdcc(0xc2)))for(const _0x607023 of _0x47da2e){const _0x1a6101=a0_0x27aef6[_0x11fdcc(0x95)](_0x607023+'s');for(const _0x12a6ec of _0x1a6101){const _0x26d8b3=await a0_0x27aef6[_0x11fdcc(0x7a)](_0x11fdcc(0xcf)+_0x607023+'s/'+_0x12a6ec);try{await lockNoti(_0x11fdcc(0xa1),_0x12a6ec,0xbb8),await dpUploadFile(_0x12a6ec,_0x26d8b3,_0x607023);}catch(_0x5d5b52){console[_0x11fdcc(0xc3)](_0x11fdcc(0xae)+_0x12a6ec+':',_0x5d5b52);}}}else console[_0x11fdcc(0x98)](_0x11fdcc(0xa6));}}),dropboxCloud[_0x2bcf9e(0x9a)](_0x2bcf9e(0x91),function(){var _0x3cd41f=_0x2bcf9e;const _0x48330b=localStorage[_0x3cd41f(0x9d)]('uId');_0x48330b===null||_0x48330b===''?authorizeWithDropbox():window['confirm'](_0x3cd41f(0xcd))&&(localStorage[_0x3cd41f(0x93)]('uId',''),dropboxRestore[_0x3cd41f(0x89)]['remove'](_0x3cd41f(0xc6)),dropboxBackup[_0x3cd41f(0x89)]['remove'](_0x3cd41f(0xc6)),dropboxCloud['classList'][_0x3cd41f(0x8b)](_0x3cd41f(0xc6)));}),handleDropboxCallback();});