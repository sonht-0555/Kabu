var a0_0x2b3eb3=a0_0x5dcc;(function(_0x12efe6,_0x837086){var _0xbfdea7=a0_0x5dcc,_0x217b3f=_0x12efe6();while(!![]){try{var _0x1465bf=-parseInt(_0xbfdea7(0x14a))/0x1+-parseInt(_0xbfdea7(0x142))/0x2+parseInt(_0xbfdea7(0x156))/0x3*(parseInt(_0xbfdea7(0x12a))/0x4)+-parseInt(_0xbfdea7(0x166))/0x5*(parseInt(_0xbfdea7(0x168))/0x6)+parseInt(_0xbfdea7(0x130))/0x7+-parseInt(_0xbfdea7(0x187))/0x8+parseInt(_0xbfdea7(0x144))/0x9;if(_0x1465bf===_0x837086)break;else _0x217b3f['push'](_0x217b3f['shift']());}catch(_0x5d0996){_0x217b3f['push'](_0x217b3f['shift']());}}}(a0_0x33a4,0x22deb));import*as a0_0x4cc24e from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2b3eb3(0x12c),clientSecret=a0_0x2b3eb3(0x16c);function authorizeWithDropbox(){var _0x53a8be=a0_0x2b3eb3,_0x22bd3f=window['location'][_0x53a8be(0x14b)][_0x53a8be(0x162)]('?')[0x0],_0x75e5b9=_0x53a8be(0x14c),_0x1e5eab=_0x53a8be(0x15b),_0x392377='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x75e5b9+_0x53a8be(0x157)+_0x1e5eab+'&redirect_uri='+encodeURIComponent(_0x22bd3f);window[_0x53a8be(0x150)][_0x53a8be(0x14b)]=_0x392377;}function handleDropboxCallback(){var _0x541770=a0_0x2b3eb3,_0x5af405=getUrlParameter(_0x541770(0x14c));_0x5af405?(getAccessToken(_0x5af405),console['log'](_0x541770(0x13f),_0x5af405)):console[_0x541770(0x185)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x48168a){var _0x463e5c=a0_0x2b3eb3;_0x48168a=_0x48168a[_0x463e5c(0x147)](/[\[]/,'\x5c[')[_0x463e5c(0x147)](/[\]]/,'\x5c]');var _0x475e34=new RegExp('[\x5c?&#]'+_0x48168a+_0x463e5c(0x133)),_0x446032=_0x475e34[_0x463e5c(0x165)](location[_0x463e5c(0x145)]);return _0x446032===null?'':decodeURIComponent(_0x446032[0x1][_0x463e5c(0x147)](/\+/g,'\x20'));}function getAccessToken(_0x5efd77){var _0x42149e=a0_0x2b3eb3,_0x2de390='authorization_code',_0x1dfa4a=window[_0x42149e(0x150)][_0x42149e(0x14b)][_0x42149e(0x162)]('?')[0x0],_0x24bad3=new XMLHttpRequest();_0x24bad3[_0x42149e(0x12d)](_0x42149e(0x125),_0x42149e(0x13c)),_0x24bad3[_0x42149e(0x129)]('Content-Type','application/x-www-form-urlencoded'),_0x24bad3[_0x42149e(0x154)]=function(){var _0x14ec14=_0x42149e;if(_0x24bad3[_0x14ec14(0x17c)]===0xc8){var _0x1347aa=JSON[_0x14ec14(0x160)](_0x24bad3[_0x14ec14(0x175)]),_0x3bcf90=_0x1347aa[_0x14ec14(0x155)],_0xb32537=_0x1347aa[_0x14ec14(0x183)],_0x52f3b8=_0x1347aa['uid'];localStorage['setItem'](_0x14ec14(0x188),_0x3bcf90),localStorage[_0x14ec14(0x174)]('refreshToken',_0xb32537),localStorage[_0x14ec14(0x174)](_0x14ec14(0x15f),_0x52f3b8);}else console[_0x14ec14(0x185)](_0x14ec14(0x179));},_0x24bad3[_0x42149e(0x163)]('code='+_0x5efd77+'&grant_type='+_0x2de390+'&client_id='+clientId+_0x42149e(0x15a)+clientSecret+_0x42149e(0x143)+encodeURIComponent(_0x1dfa4a));}function a0_0x5dcc(_0x2456f8,_0x5247db){var _0x33a4a7=a0_0x33a4();return a0_0x5dcc=function(_0x5dcc6e,_0x409af1){_0x5dcc6e=_0x5dcc6e-0x120;var _0x3eb340=_0x33a4a7[_0x5dcc6e];return _0x3eb340;},a0_0x5dcc(_0x2456f8,_0x5247db);}export async function dpCreateFolder(_0x3fe466){var _0x19479e=a0_0x2b3eb3;const _0x46b066=localStorage['getItem'](_0x19479e(0x15f));let _0x8921a3=localStorage[_0x19479e(0x161)](_0x19479e(0x188));const _0x406a3c='/'+_0x46b066+'/'+_0x3fe466,_0x3f1af1=JSON[_0x19479e(0x135)]({'path':_0x406a3c,'autorename':![]});for(let _0x3d87ce=0x0;_0x3d87ce<0x2;_0x3d87ce++){try{const _0x47bc84=await fetch(_0x19479e(0x14f),{'method':_0x19479e(0x125),'headers':{'Authorization':'Bearer\x20'+_0x8921a3,'Content-Type':'application/json'},'body':_0x3f1af1});if(_0x47bc84[_0x19479e(0x17c)]===0x191){const _0x534f6c=await dpRefreshToken();if(!_0x534f6c)throw new Error('Unable\x20to\x20refresh\x20token');_0x8921a3=localStorage[_0x19479e(0x161)]('accessToken');continue;}if(_0x47bc84[_0x19479e(0x17c)]===0x199)return{'message':_0x19479e(0x132),'path':_0x3fe466};if(!_0x47bc84['ok'])throw new Error(_0x19479e(0x140)+_0x3fe466);const _0x2b8e06=await _0x47bc84['json']();return await lockNoti(_0x19479e(0x141),'',0xbb8),_0x2b8e06;}catch(_0x5aaa0d){if(_0x3d87ce===0x1)throw _0x5aaa0d;}}return![];}export async function dpRefreshToken(){var _0x385f6d=a0_0x2b3eb3;if(!localStorage[_0x385f6d(0x161)](_0x385f6d(0x126)))throw _0x385f6d(0x159);try{const _0x41084a=await fetch(_0x385f6d(0x17f),{'method':'POST','headers':{'Content-Type':_0x385f6d(0x173)},'body':_0x385f6d(0x14d)+localStorage['getItem']('refreshToken')+_0x385f6d(0x184)}),_0x3ee77a=await _0x41084a[_0x385f6d(0x182)]();if(!_0x3ee77a['error'])return localStorage[_0x385f6d(0x174)](_0x385f6d(0x188),_0x3ee77a['access_token']),await lockNoti('',_0x385f6d(0x16e),0xbb8),await delay(0x3e8),!![];else alert(_0x3ee77a[_0x385f6d(0x16d)]||_0x385f6d(0x131));}catch(_0x29f4a2){console[_0x385f6d(0x170)](_0x385f6d(0x13b),_0x29f4a2);}return![];}function a0_0x33a4(){var _0x241456=['Upload\x20failed,\x20unknown\x20http\x20status:\x20','132708SzyIqr','href','code','refresh_token=','toUpperCase','https://api.dropboxapi.com/2/files/create_folder_v2','location','folder','downloadFileInCloud','Kabu\x20storage\x20↦\x20Cloud\x20◆','onload','access_token','15963ApwaTl','&token_access_type=','Wait\x20a\x20little\x20bit...','No\x20refresh\x20token','&client_secret=','offline','state','Bearer\x20','list','uId','parse','getItem','split','send','length','exec','20UwAmyX','Cloud\x20login\x20required!','131052xhrSWM','confirm','entries','Download\x20failed\x20for\x20','nwb3dnfh09rhs31','error_description','Refreshing\x20token...','application/octet-stream','error','remove','.tag','application/x-www-form-urlencoded','setItem','responseText','application/json','No\x20files\x20found\x20to\x20restore.','Restore\x20canceled\x20by\x20user.','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropboxapi.com/2/files/list_folder','Do\x20you\x20want\x20to\x20backup\x20','status','alert','Failed\x20to\x20upload\x20file\x20','https://api.dropboxapi.com/oauth2/token','save','addEventListener','json','refresh_token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','log','charAt','1226432pkVwTE','accessToken','uploadFileInCloud','active','https://content.dropboxapi.com/2/files/upload','screenshot','Restoring...','POST','refreshToken','filter','blob','setRequestHeader','48ugDAYb','Backing\x20up...','knh3uz2mx2hp2eu','open','click','Cloud\x20↦\x20Kabu\x20storage\x20◆','1245279MqMrKy','Failed\x20to\x20refresh\x20Dropbox\x20token.','Folder\x20already\x20exists','=([^&#]*)','classList','stringify','Do\x20you\x20want\x20to\x20logout?','\x20files\x20in\x20Kabu?','name','overwrite','file','Error\x20while\x20refreshing\x20token:','https://api.dropbox.com/oauth2/token','\x20files\x20from\x20Cloud?',',\x20status:\x20','Authorization\x20Code:','Error\x20creating\x20folder\x20','Folder\x20created','189804ZOfkEu','&redirect_uri=','3324240ZSOyje','search','Download\x20failed,\x20unknown\x20http\x20status:','replace','Unable\x20to\x20refresh\x20token'];a0_0x33a4=function(){return _0x241456;};return a0_0x33a4();}export async function dpUploadFile(_0xab3910,_0x2dfce6,_0x54d8e7){var _0x5c0b62=a0_0x2b3eb3;const _0x2492d3=localStorage[_0x5c0b62(0x161)](_0x5c0b62(0x15f));var _0x47a3b3=JSON['stringify']({'autorename':!![],'mode':_0x5c0b62(0x139),'mute':!![],'strict_conflict':![],'path':'/'+_0x2492d3+'/'+_0x54d8e7+'/'+_0xab3910}),_0x21b13b=new Blob([_0x2dfce6],{'type':_0x5c0b62(0x16f)});for(var _0x457ccd=0x0;_0x457ccd<0x2;_0x457ccd++){var _0x15f961=await fetch(_0x5c0b62(0x122),{'method':_0x5c0b62(0x125),'headers':{'Authorization':_0x5c0b62(0x15d)+localStorage[_0x5c0b62(0x161)]('accessToken'),'Dropbox-API-Arg':_0x47a3b3,'Content-Type':_0x5c0b62(0x16f)},'body':_0x21b13b});if(_0x15f961['status']!=0xc8){if(_0x15f961[_0x5c0b62(0x17c)]==0x191){var _0x3bc58c=await dpRefreshToken();if(!_0x3bc58c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5c0b62(0x149)+_0x15f961[_0x5c0b62(0x17c)];}else{var _0x4ddb74=await _0x15f961[_0x5c0b62(0x182)]();return console[_0x5c0b62(0x185)](_0x5c0b62(0x153),_0xab3910),_0x4ddb74;}}return![];}export async function dpDownloadFile(_0x496f91,_0x10ab79){var _0x50358d=a0_0x2b3eb3;const _0x3fd8b5=localStorage[_0x50358d(0x161)](_0x50358d(0x15f));var _0x1091f6=JSON['stringify']({'path':'/'+_0x3fd8b5+'/'+_0x10ab79+'/'+_0x496f91});for(var _0x58d656=0x0;_0x58d656<0x2;_0x58d656++){var _0xc34ca9=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x50358d(0x125),'headers':{'Authorization':_0x50358d(0x15d)+localStorage[_0x50358d(0x161)]('accessToken'),'Dropbox-API-Arg':_0x1091f6}});if(_0xc34ca9['status']!=0xc8){if(_0xc34ca9[_0x50358d(0x17c)]==0x191){var _0x1d9d06=await dpRefreshToken();if(!_0x1d9d06)throw _0x50358d(0x148);continue;}else throw _0x50358d(0x146)+_0xc34ca9[_0x50358d(0x17c)];}const _0x42a6f7=new File([await _0xc34ca9[_0x50358d(0x128)]()],_0x496f91);return console[_0x50358d(0x185)](_0x50358d(0x12f),_0x42a6f7[_0x50358d(0x138)]),a0_0x4cc24e[_0x50358d(0x120)](_0x42a6f7,()=>{localStorageFile(),Module['FSSync']();}),_0x42a6f7;}return![];}document[a0_0x2b3eb3(0x181)]('DOMContentLoaded',function(){var _0x30929a=a0_0x2b3eb3;dropboxRestore['addEventListener']('click',async function(){var _0x109c47=a0_0x5dcc;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x2e3ec4=localStorage[_0x109c47(0x161)](_0x109c47(0x15f)),_0x1772b4=['state',_0x109c47(0x180),_0x109c47(0x123)];if(!_0x2e3ec4){window[_0x109c47(0x17d)](_0x109c47(0x167));return;}let _0x443037=[];for(const _0x4e9e9f of _0x1772b4){let _0x1b8a4b={'path':'/'+_0x2e3ec4+'/'+_0x4e9e9f};for(let _0x135472=0x0;_0x135472<0x2;_0x135472++){let _0x16a732=await fetch(_0x109c47(0x17a),{'method':_0x109c47(0x125),'headers':{'Authorization':_0x109c47(0x15d)+localStorage['getItem']('accessToken'),'Content-Type':_0x109c47(0x176)},'body':JSON[_0x109c47(0x135)](_0x1b8a4b)});if(_0x16a732[_0x109c47(0x17c)]===0xc8){let _0x3e8897=await _0x16a732[_0x109c47(0x182)](),_0x50043e=_0x3e8897[_0x109c47(0x16a)][_0x109c47(0x127)](_0x1970d9=>_0x1970d9[_0x109c47(0x172)]===_0x109c47(0x13a));_0x50043e[_0x109c47(0x164)]>0x0&&_0x443037['push'](..._0x50043e['map'](_0x56894b=>({'name':_0x56894b[_0x109c47(0x138)],'folder':_0x4e9e9f})));break;}else{if(_0x16a732[_0x109c47(0x17c)]===0x191){let _0x3676f9=await dpRefreshToken();if(!_0x3676f9)throw _0x109c47(0x148);}else{console[_0x109c47(0x170)](_0x109c47(0x16b)+_0x4e9e9f+_0x109c47(0x13e)+_0x16a732[_0x109c47(0x17c)]);break;}}}}if(_0x443037[_0x109c47(0x164)]>0x0){const _0x458b35='Do\x20you\x20want\x20to\x20restore\x20'+_0x443037[_0x109c47(0x164)]+_0x109c47(0x13d);if(window[_0x109c47(0x169)](_0x458b35))for(const _0x1a92d4 of _0x443037){await lockNoti(_0x109c47(0x124),_0x1a92d4[_0x109c47(0x138)],0xbb8),await dpDownloadFile(_0x1a92d4[_0x109c47(0x138)],_0x1a92d4[_0x109c47(0x151)]);}else console['log'](_0x109c47(0x178));}else console[_0x109c47(0x185)](_0x109c47(0x177));}),dropboxBackup[_0x30929a(0x181)]('click',async function(){var _0x425e90=_0x30929a;await lockNoti(_0x425e90(0x158),'',0x1388);const _0x1a774b=localStorage[_0x425e90(0x161)]('uId');if(_0x1a774b===null||_0x1a774b==='')window['alert']('Cloud\x20login\x20required!');else{const _0x57f5fc=[_0x425e90(0x15c),_0x425e90(0x180),_0x425e90(0x123)];for(const _0x56edcd of _0x57f5fc){await dpCreateFolder(_0x56edcd);}let _0x557179=0x0;for(const _0x263f01 of _0x57f5fc){const _0x5e43b8=a0_0x4cc24e[_0x425e90(0x15e)+(_0x263f01[_0x425e90(0x186)](0x0)[_0x425e90(0x14e)]()+_0x263f01['slice'](0x1))]();_0x557179+=_0x5e43b8[_0x425e90(0x164)];}if(window['confirm'](_0x425e90(0x17b)+_0x557179+_0x425e90(0x137)))for(const _0x3ff68f of _0x57f5fc){const _0x311a91=a0_0x4cc24e[_0x425e90(0x15e)+(_0x3ff68f[_0x425e90(0x186)](0x0)[_0x425e90(0x14e)]()+_0x3ff68f['slice'](0x1))]();for(const _0x572365 of _0x311a91){const _0x39af0c=await a0_0x4cc24e[_0x425e90(0x152)]('/data/'+_0x3ff68f+'s/'+_0x572365);try{await lockNoti(_0x425e90(0x12b),_0x572365,0xbb8),await dpUploadFile(_0x572365,_0x39af0c,_0x3ff68f);}catch(_0x119de4){console[_0x425e90(0x170)](_0x425e90(0x17e)+_0x572365+':',_0x119de4);}}}else console[_0x425e90(0x185)](_0x425e90(0x178));}}),dropboxCloud['addEventListener'](_0x30929a(0x12e),function(){var _0x12baec=_0x30929a;const _0x3f7cbe=localStorage[_0x12baec(0x161)](_0x12baec(0x15f));_0x3f7cbe===null||_0x3f7cbe===''?authorizeWithDropbox():window[_0x12baec(0x169)](_0x12baec(0x136))&&(localStorage[_0x12baec(0x174)](_0x12baec(0x15f),''),dropboxRestore['classList'][_0x12baec(0x171)]('active'),dropboxBackup[_0x12baec(0x134)][_0x12baec(0x171)](_0x12baec(0x121)),dropboxCloud[_0x12baec(0x134)][_0x12baec(0x171)](_0x12baec(0x121)));}),handleDropboxCallback();});