function a0_0xea4f(_0x2a738b,_0x3c90b0){var _0x2b97d0=a0_0x2b97();return a0_0xea4f=function(_0xea4f5e,_0x3cc57c){_0xea4f5e=_0xea4f5e-0x8c;var _0x5963c5=_0x2b97d0[_0xea4f5e];return _0x5963c5;},a0_0xea4f(_0x2a738b,_0x3c90b0);}var a0_0x199b51=a0_0xea4f;(function(_0x228aec,_0x44cd62){var _0x26d90b=a0_0xea4f,_0x2524d0=_0x228aec();while(!![]){try{var _0x366fa7=parseInt(_0x26d90b(0xda))/0x1*(-parseInt(_0x26d90b(0xf1))/0x2)+-parseInt(_0x26d90b(0xa5))/0x3+-parseInt(_0x26d90b(0x9f))/0x4+-parseInt(_0x26d90b(0xc9))/0x5*(-parseInt(_0x26d90b(0xe9))/0x6)+-parseInt(_0x26d90b(0xb7))/0x7*(-parseInt(_0x26d90b(0xc2))/0x8)+parseInt(_0x26d90b(0xb8))/0x9+-parseInt(_0x26d90b(0xce))/0xa*(-parseInt(_0x26d90b(0xe0))/0xb);if(_0x366fa7===_0x44cd62)break;else _0x2524d0['push'](_0x2524d0['shift']());}catch(_0x14aefe){_0x2524d0['push'](_0x2524d0['shift']());}}}(a0_0x2b97,0x5177c));import*as a0_0x2d9c49 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x199b51(0xbd);function a0_0x2b97(){var _0x243ee0=['folder','code=','Wait\x20a\x20little\x20bit...','https://www.dropbox.com/oauth2/authorize?client_id=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','[\x5c?&#]','1812209aOmSoj','2458350etRSMF','length','Cloud\x20login\x20required!','https://api.dropbox.com/oauth2/token','Error\x20creating\x20folder\x20','nwb3dnfh09rhs31','remove','error_description','location','map','8SkWMvF','status','send','&grant_type=','save','Folder\x20created','active','522920xhtsxA','responseText','alert','Unable\x20to\x20refresh\x20token','application/x-www-form-urlencoded','10gFXIGq','/data/','overwrite','addEventListener','setItem','Folder\x20already\x20exists','name','Error\x20while\x20refreshing\x20token:','classList','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','json','https://api.dropboxapi.com/oauth2/token','166702FrWbhh','push','\x20files\x20in\x20Kabu?','access_token','Do\x20not\x20receive\x20authorization','search','11378543JsKTbf','confirm','&redirect_uri=','replace','accessToken','parse','Do\x20you\x20want\x20to\x20restore\x20','getItem','blob','12CeIHWX','Do\x20you\x20want\x20to\x20logout?','split','refresh_token','Restore\x20canceled\x20by\x20user.','Download\x20failed\x20for\x20','refreshToken','state','8HrsuOC','href','.tag','&token_access_type=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','POST','Failed\x20to\x20upload\x20file\x20','stringify','error','uId','entries','Restoring...','&client_secret=','https://api.dropboxapi.com/2/files/list_folder','uid','file','Download\x20failed,\x20unknown\x20http\x20status:','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','\x20files\x20from\x20Cloud?','authorization_code',',\x20status:\x20','open','Content-Type','refresh_token=','1995064puPdox','No\x20files\x20found\x20to\x20restore.','Backing\x20up...','setRequestHeader','downloadFileInCloud','log','829056obQOhe','=([^&#]*)','Authorization\x20Code:','screenshot','exec','Bearer\x20','https://content.dropboxapi.com/2/files/download','application/octet-stream','uploadFileInCloud','click','application/json','code'];a0_0x2b97=function(){return _0x243ee0;};return a0_0x2b97();}function authorizeWithDropbox(){var _0x1ef0c2=a0_0x199b51,_0x47a81e=window[_0x1ef0c2(0xc0)][_0x1ef0c2(0xf2)]['split']('?')[0x0],_0x357de5=_0x1ef0c2(0xb0),_0x24d4ac='offline',_0x178378=_0x1ef0c2(0xb4)+clientId+'&response_type='+_0x357de5+_0x1ef0c2(0xf4)+_0x24d4ac+'&redirect_uri='+encodeURIComponent(_0x47a81e);window[_0x1ef0c2(0xc0)][_0x1ef0c2(0xf2)]=_0x178378;}function handleDropboxCallback(){var _0x3fd4c0=a0_0x199b51,_0xa8cae0=getUrlParameter('code');_0xa8cae0?(getAccessToken(_0xa8cae0),console[_0x3fd4c0(0xa4)](_0x3fd4c0(0xa7),_0xa8cae0)):console['log'](_0x3fd4c0(0xde));}function getUrlParameter(_0x528162){var _0x535ab2=a0_0x199b51;_0x528162=_0x528162[_0x535ab2(0xe3)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x5ba3ae=new RegExp(_0x535ab2(0xb6)+_0x528162+_0x535ab2(0xa6)),_0x41a9f3=_0x5ba3ae[_0x535ab2(0xa9)](location[_0x535ab2(0xdf)]);return _0x41a9f3===null?'':decodeURIComponent(_0x41a9f3[0x1][_0x535ab2(0xe3)](/\+/g,'\x20'));}function getAccessToken(_0x3e74f0){var _0x435eed=a0_0x199b51,_0x52269b=_0x435eed(0x9a),_0x3c6c7f=window[_0x435eed(0xc0)][_0x435eed(0xf2)][_0x435eed(0xeb)]('?')[0x0],_0x40b971=new XMLHttpRequest();_0x40b971[_0x435eed(0x9c)](_0x435eed(0xf6),_0x435eed(0xbb)),_0x40b971[_0x435eed(0xa2)](_0x435eed(0x9d),_0x435eed(0xcd)),_0x40b971['onload']=function(){var _0x11c711=_0x435eed;if(_0x40b971[_0x11c711(0xc3)]===0xc8){var _0x5c44e9=JSON[_0x11c711(0xe5)](_0x40b971[_0x11c711(0xca)]),_0x2ac62b=_0x5c44e9['access_token'],_0x276336=_0x5c44e9[_0x11c711(0xec)],_0x277f67=_0x5c44e9[_0x11c711(0x94)];localStorage['setItem'](_0x11c711(0xe4),_0x2ac62b),localStorage[_0x11c711(0xd2)](_0x11c711(0xef),_0x276336),localStorage['setItem']('uId',_0x277f67);}else console['log'](_0x11c711(0xd7));},_0x40b971[_0x435eed(0xc4)](_0x435eed(0xb2)+_0x3e74f0+_0x435eed(0xc5)+_0x52269b+'&client_id='+clientId+_0x435eed(0x92)+clientSecret+_0x435eed(0xe2)+encodeURIComponent(_0x3c6c7f));}export async function dpCreateFolder(_0xa28531){var _0x2754c8=a0_0x199b51;const _0x56ee0f=localStorage[_0x2754c8(0xe7)](_0x2754c8(0x8f));let _0x48a265=localStorage[_0x2754c8(0xe7)](_0x2754c8(0xe4));const _0x177c9f='/'+_0x56ee0f+'/'+_0xa28531,_0x35aabb=JSON['stringify']({'path':_0x177c9f,'autorename':![]});for(let _0x5cc928=0x0;_0x5cc928<0x2;_0x5cc928++){try{const _0x1aed06=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x2754c8(0xf6),'headers':{'Authorization':_0x2754c8(0xaa)+_0x48a265,'Content-Type':_0x2754c8(0xaf)},'body':_0x35aabb});if(_0x1aed06['status']===0x191){const _0x49718a=await dpRefreshToken();if(!_0x49718a)throw new Error(_0x2754c8(0xcc));_0x48a265=localStorage[_0x2754c8(0xe7)](_0x2754c8(0xe4));continue;}if(_0x1aed06['status']===0x199)return{'message':_0x2754c8(0xd3),'path':_0xa28531};if(!_0x1aed06['ok'])throw new Error(_0x2754c8(0xbc)+_0xa28531);const _0x55ec93=await _0x1aed06[_0x2754c8(0xd8)]();return await lockNoti(_0x2754c8(0xc7),'',0xbb8),_0x55ec93;}catch(_0x469777){if(_0x5cc928===0x1)throw _0x469777;}}return![];}export async function dpRefreshToken(){var _0x39ec3c=a0_0x199b51;if(!localStorage[_0x39ec3c(0xe7)](_0x39ec3c(0xef)))throw'No\x20refresh\x20token';try{const _0x1df0d4=await fetch(_0x39ec3c(0xd9),{'method':_0x39ec3c(0xf6),'headers':{'Content-Type':_0x39ec3c(0xcd)},'body':_0x39ec3c(0x9e)+localStorage['getItem'](_0x39ec3c(0xef))+_0x39ec3c(0xb5)}),_0x2f9009=await _0x1df0d4[_0x39ec3c(0xd8)]();if(!_0x2f9009[_0x39ec3c(0x8e)])return localStorage['setItem']('accessToken',_0x2f9009[_0x39ec3c(0xdd)]),await lockNoti(_0x39ec3c(0x97),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2f9009[_0x39ec3c(0xbf)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x1f7e70){console['error'](_0x39ec3c(0xd5),_0x1f7e70);}return![];}export async function dpUploadFile(_0x20e0f3,_0x3b49a1,_0x3d2cbe){var _0x2cc058=a0_0x199b51;const _0x449638=localStorage['getItem']('uId');var _0x1b53f0=JSON[_0x2cc058(0x8d)]({'autorename':!![],'mode':_0x2cc058(0xd0),'mute':!![],'strict_conflict':![],'path':'/'+_0x449638+'/'+_0x3d2cbe+'/'+_0x20e0f3}),_0x295a74=new Blob([_0x3b49a1],{'type':_0x2cc058(0xac)});for(var _0x4f5aab=0x0;_0x4f5aab<0x2;_0x4f5aab++){var _0x102b4d=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x2cc058(0xf6),'headers':{'Authorization':_0x2cc058(0xaa)+localStorage[_0x2cc058(0xe7)]('accessToken'),'Dropbox-API-Arg':_0x1b53f0,'Content-Type':'application/octet-stream'},'body':_0x295a74});if(_0x102b4d[_0x2cc058(0xc3)]!=0xc8){if(_0x102b4d[_0x2cc058(0xc3)]==0x191){var _0x8b3b62=await dpRefreshToken();if(!_0x8b3b62)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x2cc058(0xf5)+_0x102b4d[_0x2cc058(0xc3)];}else{var _0x591284=await _0x102b4d[_0x2cc058(0xd8)]();return console[_0x2cc058(0xa4)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x20e0f3),_0x591284;}}return![];}export async function dpDownloadFile(_0x11ce04,_0xba690){var _0x5dd865=a0_0x199b51;const _0x2608e6=localStorage['getItem'](_0x5dd865(0x8f));var _0x46a8cf=JSON[_0x5dd865(0x8d)]({'path':'/'+_0x2608e6+'/'+_0xba690+'/'+_0x11ce04});for(var _0xdeebaf=0x0;_0xdeebaf<0x2;_0xdeebaf++){var _0x4d3629=await fetch(_0x5dd865(0xab),{'method':_0x5dd865(0xf6),'headers':{'Authorization':_0x5dd865(0xaa)+localStorage[_0x5dd865(0xe7)](_0x5dd865(0xe4)),'Dropbox-API-Arg':_0x46a8cf}});if(_0x4d3629['status']!=0xc8){if(_0x4d3629[_0x5dd865(0xc3)]==0x191){var _0x27292d=await dpRefreshToken();if(!_0x27292d)throw _0x5dd865(0xcc);continue;}else throw _0x5dd865(0x96)+_0x4d3629[_0x5dd865(0xc3)];}const _0x501081=new File([await _0x4d3629[_0x5dd865(0xe8)]()],_0x11ce04);return console[_0x5dd865(0xa4)](_0x5dd865(0x98),_0x501081[_0x5dd865(0xd4)]),a0_0x2d9c49[_0x5dd865(0xad)](_0x501081,()=>{}),_0x501081;}return![];}document[a0_0x199b51(0xd1)]('DOMContentLoaded',function(){var _0x40375d=a0_0x199b51;dropboxRestore[_0x40375d(0xd1)](_0x40375d(0xae),async function(){var _0x4ab073=_0x40375d;await lockNoti(_0x4ab073(0xb3),'',0x1388);const _0x42b39a=localStorage['getItem'](_0x4ab073(0x8f)),_0x55e8ab=['state',_0x4ab073(0xc6),_0x4ab073(0xa8)];if(!_0x42b39a){window['alert'](_0x4ab073(0xba));return;}let _0x1ad1cf=[];for(const _0x2d74dd of _0x55e8ab){let _0x44fce4={'path':'/'+_0x42b39a+'/'+_0x2d74dd};for(let _0x3998ea=0x0;_0x3998ea<0x2;_0x3998ea++){let _0x33feba=await fetch(_0x4ab073(0x93),{'method':_0x4ab073(0xf6),'headers':{'Authorization':_0x4ab073(0xaa)+localStorage['getItem']('accessToken'),'Content-Type':_0x4ab073(0xaf)},'body':JSON[_0x4ab073(0x8d)](_0x44fce4)});if(_0x33feba[_0x4ab073(0xc3)]===0xc8){let _0x3f8d59=await _0x33feba['json'](),_0x5689ba=_0x3f8d59[_0x4ab073(0x90)]['filter'](_0x2f8ec6=>_0x2f8ec6[_0x4ab073(0xf3)]===_0x4ab073(0x95));_0x5689ba['length']>0x0&&_0x1ad1cf[_0x4ab073(0xdb)](..._0x5689ba[_0x4ab073(0xc1)](_0x19dd4a=>({'name':_0x19dd4a[_0x4ab073(0xd4)],'folder':_0x2d74dd})));break;}else{if(_0x33feba[_0x4ab073(0xc3)]===0x191){let _0x5360e2=await dpRefreshToken();if(!_0x5360e2)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x4ab073(0x8e)](_0x4ab073(0xee)+_0x2d74dd+_0x4ab073(0x9b)+_0x33feba[_0x4ab073(0xc3)]);break;}}}}if(_0x1ad1cf['length']>0x0){const _0x4365a8=_0x4ab073(0xe6)+_0x1ad1cf['length']+_0x4ab073(0x99);if(window[_0x4ab073(0xe1)](_0x4365a8))for(const _0x38c8b2 of _0x1ad1cf){await lockNoti(_0x4ab073(0x91),_0x38c8b2[_0x4ab073(0xd4)],0xbb8),await dpDownloadFile(_0x38c8b2['name'],_0x38c8b2[_0x4ab073(0xb1)]);}else console['log'](_0x4ab073(0xed));}else console['log'](_0x4ab073(0xa0));}),dropboxBackup['addEventListener'](_0x40375d(0xae),async function(){var _0x293767=_0x40375d;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x589947=localStorage[_0x293767(0xe7)](_0x293767(0x8f));if(_0x589947===null||_0x589947==='')window[_0x293767(0xcb)]('Cloud\x20login\x20required!');else{const _0x424126=[_0x293767(0xf0),'save',_0x293767(0xa8)];for(const _0x3f4e04 of _0x424126){await dpCreateFolder(_0x3f4e04);}let _0x39ad4a=0x0;for(const _0x2ac15d of _0x424126){const _0x37dc43=a0_0x2d9c49['listFiles'](_0x2ac15d+'s');_0x39ad4a+=_0x37dc43[_0x293767(0xb9)];}if(window[_0x293767(0xe1)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x39ad4a+_0x293767(0xdc)))for(const _0x1d67c5 of _0x424126){const _0x1d74e5=a0_0x2d9c49['listFiles'](_0x1d67c5+'s');for(const _0x278300 of _0x1d74e5){const _0x1a89f7=await a0_0x2d9c49[_0x293767(0xa3)](_0x293767(0xcf)+_0x1d67c5+'s/'+_0x278300);try{await lockNoti(_0x293767(0xa1),_0x278300,0xbb8),await dpUploadFile(_0x278300,_0x1a89f7,_0x1d67c5);}catch(_0x47cbcf){console[_0x293767(0x8e)](_0x293767(0x8c)+_0x278300+':',_0x47cbcf);}}}else console[_0x293767(0xa4)](_0x293767(0xed));}}),dropboxCloud['addEventListener'](_0x40375d(0xae),function(){var _0x21d0ee=_0x40375d;const _0x172e21=localStorage['getItem'](_0x21d0ee(0x8f));_0x172e21===null||_0x172e21===''?authorizeWithDropbox():window['confirm'](_0x21d0ee(0xea))&&(localStorage[_0x21d0ee(0xd2)]('uId',''),dropboxRestore[_0x21d0ee(0xd6)]['remove'](_0x21d0ee(0xc8)),dropboxBackup['classList'][_0x21d0ee(0xbe)](_0x21d0ee(0xc8)),dropboxCloud['classList'][_0x21d0ee(0xbe)](_0x21d0ee(0xc8)));}),handleDropboxCallback();});