var a0_0x1ae989=a0_0x1a33;(function(_0x345a44,_0x759489){var _0x1ce8bd=a0_0x1a33,_0x2462d1=_0x345a44();while(!![]){try{var _0x5c5cdc=parseInt(_0x1ce8bd(0x93))/0x1+-parseInt(_0x1ce8bd(0x92))/0x2*(-parseInt(_0x1ce8bd(0xc9))/0x3)+-parseInt(_0x1ce8bd(0xab))/0x4*(-parseInt(_0x1ce8bd(0xa4))/0x5)+parseInt(_0x1ce8bd(0xda))/0x6*(-parseInt(_0x1ce8bd(0xea))/0x7)+parseInt(_0x1ce8bd(0x91))/0x8+parseInt(_0x1ce8bd(0x90))/0x9*(-parseInt(_0x1ce8bd(0xac))/0xa)+-parseInt(_0x1ce8bd(0xe3))/0xb;if(_0x5c5cdc===_0x759489)break;else _0x2462d1['push'](_0x2462d1['shift']());}catch(_0x350c29){_0x2462d1['push'](_0x2462d1['shift']());}}}(a0_0x34df,0xc05ce));import*as a0_0xe9b0a from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1ae989(0x9f),clientSecret=a0_0x1ae989(0xcf);function authorizeWithDropbox(){var _0x2dabbe=a0_0x1ae989,_0x35f315=window['location'][_0x2dabbe(0xe0)][_0x2dabbe(0xd9)]('?')[0x0],_0x2b5cea=_0x2dabbe(0xa8),_0x5bb94c=_0x2dabbe(0xd4),_0x2c453e=_0x2dabbe(0x96)+clientId+'&response_type='+_0x2b5cea+'&token_access_type='+_0x5bb94c+_0x2dabbe(0xc7)+encodeURIComponent(_0x35f315);window['location'][_0x2dabbe(0xe0)]=_0x2c453e;}function a0_0x1a33(_0x1638a9,_0xdabcc7){var _0x34df9c=a0_0x34df();return a0_0x1a33=function(_0x1a33cf,_0x4ad2ca){_0x1a33cf=_0x1a33cf-0x8c;var _0x41d947=_0x34df9c[_0x1a33cf];return _0x41d947;},a0_0x1a33(_0x1638a9,_0xdabcc7);}function handleDropboxCallback(){var _0x2b4f35=a0_0x1ae989,_0x3dd3bb=getUrlParameter(_0x2b4f35(0xa8));_0x3dd3bb?(getAccessToken(_0x3dd3bb),console['log'](_0x2b4f35(0xba),_0x3dd3bb)):console['log'](_0x2b4f35(0xb0));}function getUrlParameter(_0x2c6517){var _0x278eab=a0_0x1ae989;_0x2c6517=_0x2c6517[_0x278eab(0x9b)](/[\[]/,'\x5c[')[_0x278eab(0x9b)](/[\]]/,'\x5c]');var _0x3f1ea4=new RegExp(_0x278eab(0xd7)+_0x2c6517+_0x278eab(0xb3)),_0x5230e8=_0x3f1ea4[_0x278eab(0xb1)](location['search']);return _0x5230e8===null?'':decodeURIComponent(_0x5230e8[0x1][_0x278eab(0x9b)](/\+/g,'\x20'));}function getAccessToken(_0xb30035){var _0x380389=a0_0x1ae989,_0x5f225a='authorization_code',_0x2d4da6=window[_0x380389(0xdc)][_0x380389(0xe0)]['split']('?')[0x0],_0x11cf2a=new XMLHttpRequest();_0x11cf2a[_0x380389(0xc4)](_0x380389(0xb7),'https://api.dropbox.com/oauth2/token'),_0x11cf2a['setRequestHeader'](_0x380389(0xcc),_0x380389(0xb8)),_0x11cf2a[_0x380389(0xe1)]=function(){var _0x2e5167=_0x380389;if(_0x11cf2a[_0x2e5167(0xae)]===0xc8){var _0x444281=JSON[_0x2e5167(0xca)](_0x11cf2a['responseText']),_0x4635bd=_0x444281[_0x2e5167(0xec)],_0x38ef3a=_0x444281[_0x2e5167(0x98)],_0x5ead44=_0x444281['uid'];localStorage[_0x2e5167(0xa0)](_0x2e5167(0x94),_0x4635bd),localStorage[_0x2e5167(0xa0)]('refreshToken',_0x38ef3a),localStorage[_0x2e5167(0xa0)]('uId',_0x5ead44);}else console['log'](_0x2e5167(0xcd));},_0x11cf2a['send']('code='+_0xb30035+_0x380389(0xd8)+_0x5f225a+_0x380389(0xaa)+clientId+_0x380389(0xbd)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x2d4da6));}export async function dpCreateFolder(_0x6b8482){var _0x1d90b9=a0_0x1ae989;const _0x2b448d=localStorage[_0x1d90b9(0xb2)]('uId');let _0x32cdb0=localStorage[_0x1d90b9(0xb2)]('accessToken');const _0xbcf022='/'+_0x2b448d+'/'+_0x6b8482,_0x303877=JSON[_0x1d90b9(0x8c)]({'path':_0xbcf022,'autorename':![]});for(let _0x38ee0a=0x0;_0x38ee0a<0x2;_0x38ee0a++){try{const _0x19f0af=await fetch(_0x1d90b9(0xde),{'method':_0x1d90b9(0xb7),'headers':{'Authorization':_0x1d90b9(0xa6)+_0x32cdb0,'Content-Type':'application/json'},'body':_0x303877});if(_0x19f0af[_0x1d90b9(0xae)]===0x191){const _0xa97892=await dpRefreshToken();if(!_0xa97892)throw new Error(_0x1d90b9(0xe6));_0x32cdb0=localStorage[_0x1d90b9(0xb2)](_0x1d90b9(0x94));continue;}if(_0x19f0af[_0x1d90b9(0xae)]===0x199)return{'message':_0x1d90b9(0xbe),'path':_0x6b8482};if(!_0x19f0af['ok'])throw new Error(_0x1d90b9(0xb4)+_0x6b8482);const _0x318047=await _0x19f0af['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x318047;}catch(_0x32633b){if(_0x38ee0a===0x1)throw _0x32633b;}}return![];}export async function dpRefreshToken(){var _0x37762a=a0_0x1ae989;if(!localStorage[_0x37762a(0xb2)](_0x37762a(0xd0)))throw _0x37762a(0xc6);try{const _0x2b2fd1=await fetch(_0x37762a(0x9e),{'method':_0x37762a(0xb7),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x37762a(0x8d)+localStorage['getItem'](_0x37762a(0xd0))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x307733=await _0x2b2fd1['json']();if(!_0x307733['error'])return localStorage[_0x37762a(0xa0)]('accessToken',_0x307733['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x307733['error_description']||_0x37762a(0xbb));}catch(_0x26321c){console['error']('Error\x20while\x20refreshing\x20token:',_0x26321c);}return![];}export async function dpUploadFile(_0x29e09f,_0x3fc1dd,_0x500530){var _0x15d989=a0_0x1ae989;const _0xec97ad=localStorage[_0x15d989(0xb2)]('uId');var _0x2b5b58=JSON[_0x15d989(0x8c)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0xec97ad+'/'+_0x500530+'/'+_0x29e09f}),_0x2fb3ce=new Blob([_0x3fc1dd],{'type':_0x15d989(0xc0)});for(var _0xe41b96=0x0;_0xe41b96<0x2;_0xe41b96++){var _0x5246c1=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x15d989(0xb7),'headers':{'Authorization':_0x15d989(0xa6)+localStorage['getItem'](_0x15d989(0x94)),'Dropbox-API-Arg':_0x2b5b58,'Content-Type':_0x15d989(0xc0)},'body':_0x2fb3ce});if(_0x5246c1[_0x15d989(0xae)]!=0xc8){if(_0x5246c1['status']==0x191){var _0x2e5c8d=await dpRefreshToken();if(!_0x2e5c8d)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x15d989(0xc3)+_0x5246c1[_0x15d989(0xae)];}else{var _0x5b9dff=await _0x5246c1[_0x15d989(0x9a)]();return console['log'](_0x15d989(0xa5),_0x29e09f),_0x5b9dff;}}return![];}function a0_0x34df(){var _0x4255b4=['status','blob','Do\x20not\x20receive\x20authorization','exec','getItem','=([^&#]*)','Error\x20creating\x20folder\x20','error','active','POST','application/x-www-form-urlencoded','No\x20files\x20found\x20to\x20restore.','Authorization\x20Code:','Failed\x20to\x20refresh\x20Dropbox\x20token.','/data/','&client_secret=','Folder\x20already\x20exists','DOMContentLoaded','application/octet-stream','map','name','Upload\x20failed,\x20unknown\x20http\x20status:\x20','open','Do\x20you\x20want\x20to\x20logout?','No\x20refresh\x20token','&redirect_uri=','Cloud\x20login\x20required!','3coiSZB','parse','file','Content-Type','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','remove','nwb3dnfh09rhs31','refreshToken','length','Do\x20you\x20want\x20to\x20restore\x20','\x20files\x20in\x20Kabu?','offline','entries','classList','[\x5c?&#]','&grant_type=','split','6qNpmEf','application/json','location','Restoring...','https://api.dropboxapi.com/2/files/create_folder_v2','save','href','onload','Cloud\x20↦\x20Kabu\x20storage\x20◆','36646137bHHBXw','uId','listFiles','Unable\x20to\x20refresh\x20token','log','state','https://api.dropboxapi.com/2/files/list_folder','1803914GeKESV','Restore\x20canceled\x20by\x20user.','access_token','stringify','refresh_token=','click','confirm','99jnoTCZ','9716272UankQm','2015284tsorXL','1415022qMRNCy','accessToken','Do\x20you\x20want\x20to\x20backup\x20','https://www.dropbox.com/oauth2/authorize?client_id=','screenshot','refresh_token','push','json','replace','.tag','downloadFileInCloud','https://api.dropboxapi.com/oauth2/token','knh3uz2mx2hp2eu','setItem','addEventListener','https://content.dropboxapi.com/2/files/download','uploadFileInCloud','37865XLawqs','Kabu\x20storage\x20↦\x20Cloud\x20◆','Bearer\x20','alert','code','Wait\x20a\x20little\x20bit...','&client_id=','824wIkaBE','745590VxSCwD','Download\x20failed\x20for\x20'];a0_0x34df=function(){return _0x4255b4;};return a0_0x34df();}export async function dpDownloadFile(_0x3ca085,_0x2870f2){var _0x411164=a0_0x1ae989;const _0x2141bd=localStorage['getItem'](_0x411164(0xe4));var _0xfbc8a8=JSON['stringify']({'path':'/'+_0x2141bd+'/'+_0x2870f2+'/'+_0x3ca085});for(var _0x49605d=0x0;_0x49605d<0x2;_0x49605d++){var _0x201243=await fetch(_0x411164(0xa2),{'method':_0x411164(0xb7),'headers':{'Authorization':_0x411164(0xa6)+localStorage[_0x411164(0xb2)]('accessToken'),'Dropbox-API-Arg':_0xfbc8a8}});if(_0x201243['status']!=0xc8){if(_0x201243['status']==0x191){var _0x373be1=await dpRefreshToken();if(!_0x373be1)throw _0x411164(0xe6);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x201243[_0x411164(0xae)];}const _0x55e683=new File([await _0x201243[_0x411164(0xaf)]()],_0x3ca085);return console['log'](_0x411164(0xe2),_0x55e683[_0x411164(0xc2)]),a0_0xe9b0a[_0x411164(0xa3)](_0x55e683,()=>{}),_0x55e683;}return![];}document['addEventListener'](a0_0x1ae989(0xbf),function(){var _0x3a9edd=a0_0x1ae989;dropboxRestore['addEventListener'](_0x3a9edd(0x8e),async function(){var _0x1a6015=_0x3a9edd;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4839d4=localStorage['getItem'](_0x1a6015(0xe4)),_0x5c7438=[_0x1a6015(0xe8),_0x1a6015(0xdf),_0x1a6015(0x97)];if(!_0x4839d4){window['alert'](_0x1a6015(0xc8));return;}let _0x26094b=[];for(const _0x28c4b5 of _0x5c7438){let _0x350d4c={'path':'/'+_0x4839d4+'/'+_0x28c4b5};for(let _0x44422c=0x0;_0x44422c<0x2;_0x44422c++){let _0x26d6a3=await fetch(_0x1a6015(0xe9),{'method':'POST','headers':{'Authorization':_0x1a6015(0xa6)+localStorage[_0x1a6015(0xb2)]('accessToken'),'Content-Type':_0x1a6015(0xdb)},'body':JSON[_0x1a6015(0x8c)](_0x350d4c)});if(_0x26d6a3['status']===0xc8){let _0x1d2f13=await _0x26d6a3[_0x1a6015(0x9a)](),_0x597ebd=_0x1d2f13[_0x1a6015(0xd5)]['filter'](_0xc1702d=>_0xc1702d[_0x1a6015(0x9c)]===_0x1a6015(0xcb));_0x597ebd[_0x1a6015(0xd1)]>0x0&&_0x26094b[_0x1a6015(0x99)](..._0x597ebd[_0x1a6015(0xc1)](_0x1eab61=>({'name':_0x1eab61[_0x1a6015(0xc2)],'folder':_0x28c4b5})));break;}else{if(_0x26d6a3[_0x1a6015(0xae)]===0x191){let _0x5bbd9e=await dpRefreshToken();if(!_0x5bbd9e)throw _0x1a6015(0xe6);}else{console[_0x1a6015(0xb5)](_0x1a6015(0xad)+_0x28c4b5+',\x20status:\x20'+_0x26d6a3['status']);break;}}}}if(_0x26094b['length']>0x0){const _0x292910=_0x1a6015(0xd2)+_0x26094b[_0x1a6015(0xd1)]+'\x20files\x20from\x20Cloud?';if(window[_0x1a6015(0x8f)](_0x292910))for(const _0x269cc6 of _0x26094b){await lockNoti(_0x1a6015(0xdd),_0x269cc6[_0x1a6015(0xc2)],0xbb8),await dpDownloadFile(_0x269cc6[_0x1a6015(0xc2)],_0x269cc6['folder']);}else console[_0x1a6015(0xe7)](_0x1a6015(0xeb));}else console[_0x1a6015(0xe7)](_0x1a6015(0xb9));}),dropboxBackup['addEventListener']('click',async function(){var _0x4a0641=_0x3a9edd;await lockNoti(_0x4a0641(0xa9),'',0x1388);const _0x36e0c5=localStorage[_0x4a0641(0xb2)](_0x4a0641(0xe4));if(_0x36e0c5===null||_0x36e0c5==='')window[_0x4a0641(0xa7)]('Cloud\x20login\x20required!');else{const _0x5b64c1=[_0x4a0641(0xe8),_0x4a0641(0xdf),_0x4a0641(0x97)];for(const _0x3ea570 of _0x5b64c1){await dpCreateFolder(_0x3ea570);}let _0x1b20ad=0x0;for(const _0x2eeac2 of _0x5b64c1){const _0x12f0b2=a0_0xe9b0a[_0x4a0641(0xe5)](_0x2eeac2+'s');_0x1b20ad+=_0x12f0b2[_0x4a0641(0xd1)];}if(window[_0x4a0641(0x8f)](_0x4a0641(0x95)+_0x1b20ad+_0x4a0641(0xd3)))for(const _0x3119be of _0x5b64c1){const _0x1e2348=a0_0xe9b0a[_0x4a0641(0xe5)](_0x3119be+'s');for(const _0x232b2e of _0x1e2348){const _0x19cb9b=await a0_0xe9b0a[_0x4a0641(0x9d)](_0x4a0641(0xbc)+_0x3119be+'s/'+_0x232b2e);try{await lockNoti('Backing\x20up...',_0x232b2e,0xbb8),await dpUploadFile(_0x232b2e,_0x19cb9b,_0x3119be);}catch(_0x396433){console[_0x4a0641(0xb5)]('Failed\x20to\x20upload\x20file\x20'+_0x232b2e+':',_0x396433);}}}else console['log'](_0x4a0641(0xeb));}}),dropboxCloud[_0x3a9edd(0xa1)](_0x3a9edd(0x8e),function(){var _0x41c217=_0x3a9edd;const _0x35b8d9=localStorage[_0x41c217(0xb2)](_0x41c217(0xe4));_0x35b8d9===null||_0x35b8d9===''?authorizeWithDropbox():window[_0x41c217(0x8f)](_0x41c217(0xc5))&&(localStorage['setItem'](_0x41c217(0xe4),''),dropboxRestore['classList'][_0x41c217(0xce)](_0x41c217(0xb6)),dropboxBackup[_0x41c217(0xd6)]['remove'](_0x41c217(0xb6)),dropboxCloud[_0x41c217(0xd6)][_0x41c217(0xce)]('active'));}),handleDropboxCallback();});