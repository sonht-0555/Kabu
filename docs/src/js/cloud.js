var a0_0x34be8f=a0_0x271f;(function(_0x3ac519,_0x2d9a69){var _0x251485=a0_0x271f,_0x3027b0=_0x3ac519();while(!![]){try{var _0x889baa=-parseInt(_0x251485(0x1f7))/0x1+parseInt(_0x251485(0x1d0))/0x2+-parseInt(_0x251485(0x21c))/0x3+parseInt(_0x251485(0x1dc))/0x4+-parseInt(_0x251485(0x1cc))/0x5*(parseInt(_0x251485(0x20e))/0x6)+-parseInt(_0x251485(0x1df))/0x7*(parseInt(_0x251485(0x1c7))/0x8)+parseInt(_0x251485(0x224))/0x9;if(_0x889baa===_0x2d9a69)break;else _0x3027b0['push'](_0x3027b0['shift']());}catch(_0x59cc42){_0x3027b0['push'](_0x3027b0['shift']());}}}(a0_0x2ed4,0x8f435));import*as a0_0x4a7fd0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x34be8f(0x1fa),clientSecret=a0_0x34be8f(0x1f5);function a0_0x271f(_0x4d08ae,_0x2287b4){var _0x2ed49a=a0_0x2ed4();return a0_0x271f=function(_0x271f92,_0x5a23f2){_0x271f92=_0x271f92-0x1c6;var _0x176ed1=_0x2ed49a[_0x271f92];return _0x176ed1;},a0_0x271f(_0x4d08ae,_0x2287b4);}function a0_0x2ed4(){var _0x3e00b1=['application/x-www-form-urlencoded','replace','status:\x20','.ss2','filter','name','Bearer\x20','stringify','addEventListener','send','Failed\x20to\x20refresh\x20Dropbox\x20token.','access_token','save','915483ayygxf','Kabu\x20storage\x20↦\x20Cloud\x20◆','Restore\x20canceled\x20by\x20user.','state','location','setRequestHeader','error','_imageState','18246195RaUeyE','lastIndexOf','Download\x20failed,\x20unknown\x20http\x20status:','https://content.dropboxapi.com/2/files/upload','Upload\x20failed,\x20unknown\x20http\x20status:\x20','open','&token_access_type=','code','&redirect_uri=','.ss0','uid','search','Refreshing\x20token...','https://www.dropbox.com/oauth2/authorize?client_id=','.ss4','uId','active','Restoring...','/data/','status','POST','\x20files\x20in\x20Cloud?','\x20files\x20in\x20Kabu?','239880yDaPRp','overwrite','Authorization\x20Code:','Download\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','65flyHla','classList','.tag','endsWith','262684LlLxgn','parse','offline','charAt','toUpperCase','confirm','Unable\x20to\x20refresh\x20token','Backing\x20up...','log','.ss1','alert','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','3684972CFoioP','Content-Type','gba','133hxITIV','Do\x20you\x20want\x20to\x20backup\x20','substring','Failed\x20to\x20upload\x20file\x20','.ss5','_dateState','Cloud\x20↦\x20Kabu\x20storage\x20◆','application/json','exec','DOMContentLoaded','.ss3','setItem','error_description','.gba_dateState','uploadSaveOrSaveState','.txt','file','application/octet-stream','[\x5c?&#]','remove','accessToken','https://api.dropbox.com/oauth2/token','nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20logout?','1062756PDUaJt','Do\x20not\x20receive\x20authorization','text/plain','knh3uz2mx2hp2eu','downloadFileInCloud','entries','code=','refresh_token','&response_type=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','length','href','&grant_type=','list','.gba_slot','getItem','slice','.gba_imageState','Cloud\x20login\x20required!','click','.ss7','json','No\x20refresh\x20token','256386MXFtOr'];a0_0x2ed4=function(){return _0x3e00b1;};return a0_0x2ed4();}function authorizeWithDropbox(){var _0x13e3e9=a0_0x34be8f,_0x5c97e9=window[_0x13e3e9(0x220)][_0x13e3e9(0x202)]['split']('?')[0x0],_0x23df43=_0x13e3e9(0x22b),_0x6a0595=_0x13e3e9(0x1d2),_0x38da79=_0x13e3e9(0x231)+clientId+_0x13e3e9(0x1ff)+_0x23df43+_0x13e3e9(0x22a)+_0x6a0595+_0x13e3e9(0x22c)+encodeURIComponent(_0x5c97e9);window[_0x13e3e9(0x220)][_0x13e3e9(0x202)]=_0x38da79;}function handleDropboxCallback(){var _0x39719d=a0_0x34be8f,_0x2553a1=getUrlParameter(_0x39719d(0x22b));_0x2553a1?(getAccessToken(_0x2553a1),console['log'](_0x39719d(0x1c9),_0x2553a1)):console[_0x39719d(0x1d8)](_0x39719d(0x1f8));}function getUrlParameter(_0x115942){var _0xa02201=a0_0x34be8f;_0x115942=_0x115942[_0xa02201(0x210)](/[\[]/,'\x5c[')[_0xa02201(0x210)](/[\]]/,'\x5c]');var _0x37926d=new RegExp(_0xa02201(0x1f1)+_0x115942+'=([^&#]*)'),_0x42a02a=_0x37926d[_0xa02201(0x1e7)](location[_0xa02201(0x22f)]);return _0x42a02a===null?'':decodeURIComponent(_0x42a02a[0x1][_0xa02201(0x210)](/\+/g,'\x20'));}function getAccessToken(_0x4dfd77){var _0x4bf93f=a0_0x34be8f,_0x514882='authorization_code',_0x65c17=window[_0x4bf93f(0x220)]['href']['split']('?')[0x0],_0x4fe4b6=new XMLHttpRequest();_0x4fe4b6[_0x4bf93f(0x229)](_0x4bf93f(0x238),_0x4bf93f(0x1f4)),_0x4fe4b6[_0x4bf93f(0x221)](_0x4bf93f(0x1dd),_0x4bf93f(0x20f)),_0x4fe4b6['onload']=function(){var _0x463da6=_0x4bf93f;if(_0x4fe4b6[_0x463da6(0x237)]===0xc8){var _0x58ac37=JSON[_0x463da6(0x1d1)](_0x4fe4b6['responseText']),_0x2ecc3f=_0x58ac37[_0x463da6(0x21a)],_0x923938=_0x58ac37[_0x463da6(0x1fe)],_0x356bc6=_0x58ac37[_0x463da6(0x22e)];localStorage['setItem'](_0x463da6(0x1f3),_0x2ecc3f),localStorage[_0x463da6(0x1ea)]('refreshToken',_0x923938),localStorage[_0x463da6(0x1ea)]('uId',_0x356bc6);}else console[_0x463da6(0x1d8)](_0x463da6(0x1db));},_0x4fe4b6[_0x4bf93f(0x218)](_0x4bf93f(0x1fd)+_0x4dfd77+_0x4bf93f(0x203)+_0x514882+'&client_id='+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x65c17));}export async function dpRefreshToken(){var _0x146da1=a0_0x34be8f;if(!localStorage['getItem'](_0x146da1(0x1cb)))throw _0x146da1(0x20d);try{const _0x5a112e=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x146da1(0x238),'headers':{'Content-Type':_0x146da1(0x20f)},'body':'refresh_token='+localStorage['getItem']('refreshToken')+_0x146da1(0x200)}),_0x187a01=await _0x5a112e[_0x146da1(0x20c)]();if(!_0x187a01[_0x146da1(0x222)])return localStorage[_0x146da1(0x1ea)](_0x146da1(0x1f3),_0x187a01[_0x146da1(0x21a)]),await lockNoti('',_0x146da1(0x230),0xbb8),await delay(0x3e8),!![];else alert(_0x187a01[_0x146da1(0x1eb)]||_0x146da1(0x219));}catch(_0x455fee){console[_0x146da1(0x222)]('Error\x20while\x20refreshing\x20token:',_0x455fee);}return![];}export async function dpUploadFile(_0x4f17bd,_0x5734e7){var _0x152841=a0_0x34be8f;const _0x234691=localStorage['getItem'](_0x152841(0x233));var _0x33ec76=JSON[_0x152841(0x216)]({'autorename':!![],'mode':_0x152841(0x1c8),'mute':!![],'strict_conflict':![],'path':'/'+_0x234691+'/'+_0x4f17bd}),_0x59f11e=new Blob([_0x5734e7],{'type':_0x152841(0x1f0)});for(var _0x4745d6=0x0;_0x4745d6<0x2;_0x4745d6++){var _0xd33bc6=await fetch(_0x152841(0x227),{'method':_0x152841(0x238),'headers':{'Authorization':_0x152841(0x215)+localStorage[_0x152841(0x206)](_0x152841(0x1f3)),'Dropbox-API-Arg':_0x33ec76,'Content-Type':'application/octet-stream'},'body':_0x59f11e});if(_0xd33bc6[_0x152841(0x237)]!=0xc8){if(_0xd33bc6[_0x152841(0x237)]==0x191){var _0x415ee6=await dpRefreshToken();if(!_0x415ee6)throw _0x152841(0x1d6);continue;}else throw _0x152841(0x228)+_0xd33bc6['status'];}else{var _0x53618d=await _0xd33bc6['json']();return console[_0x152841(0x1d8)](_0x152841(0x21d),_0x4f17bd),_0x53618d;}}return![];}async function dpDownloadFile(_0x4e55f7){var _0x5d2bcf=a0_0x34be8f;const _0x100685=localStorage['getItem'](_0x5d2bcf(0x233));var _0x17b662=JSON['stringify']({'path':'/'+_0x100685+'/'+_0x4e55f7});for(var _0x287d8e=0x0;_0x287d8e<0x2;_0x287d8e++){var _0x1a3a71=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x5d2bcf(0x238),'headers':{'Authorization':_0x5d2bcf(0x215)+localStorage[_0x5d2bcf(0x206)](_0x5d2bcf(0x1f3)),'Dropbox-API-Arg':_0x17b662}});if(_0x1a3a71[_0x5d2bcf(0x237)]!=0xc8){if(_0x1a3a71[_0x5d2bcf(0x237)]==0x191){var _0x47daf4=await dpRefreshToken();if(!_0x47daf4)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5d2bcf(0x226)+_0x1a3a71[_0x5d2bcf(0x237)];}const _0x573653=new File([await _0x1a3a71['blob']()],_0x4e55f7);console[_0x5d2bcf(0x1d8)](_0x5d2bcf(0x1e5),_0x573653[_0x5d2bcf(0x214)]);if(_0x4e55f7[_0x5d2bcf(0x1cf)](_0x5d2bcf(0x1ee))){const _0x34c41b=await _0x573653['text'](),[_0x5b0e49,_0x1a38f2]=_0x34c41b['split']('\x0a\x0a'),_0x1384c9=_0x4e55f7[_0x5d2bcf(0x1e1)](0x0,_0x4e55f7[_0x5d2bcf(0x225)](_0x5d2bcf(0x1de))+0x3),_0x4b203a=_0x4e55f7[_0x5d2bcf(0x1d3)](_0x4e55f7[_0x5d2bcf(0x201)]-0x5);localStorage[_0x5d2bcf(0x1ea)](_0x1384c9+_0x5d2bcf(0x1e4)+_0x4b203a,_0x1a38f2),localStorage[_0x5d2bcf(0x1ea)](_0x1384c9+_0x5d2bcf(0x223)+_0x4b203a,_0x5b0e49);}else a0_0x4a7fd0[_0x5d2bcf(0x1ed)](_0x573653,()=>{localStorageFile(),Module['FSSync']();});return _0x573653;}return![];}document[a0_0x34be8f(0x217)](a0_0x34be8f(0x1e8),function(){var _0x29dd5b=a0_0x34be8f;dropboxRestore[_0x29dd5b(0x217)](_0x29dd5b(0x20a),async function(){var _0x3c1f9a=_0x29dd5b;const _0x360e33=localStorage[_0x3c1f9a(0x206)](_0x3c1f9a(0x233));if(_0x360e33===null||_0x360e33==='')window[_0x3c1f9a(0x1da)](_0x3c1f9a(0x209));else{var _0xbd4bb6={'path':'/'+_0x360e33};for(var _0x10523b=0x0;_0x10523b<0x2;_0x10523b++){var _0x3af30d=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x3c1f9a(0x238),'headers':{'Authorization':_0x3c1f9a(0x215)+localStorage[_0x3c1f9a(0x206)](_0x3c1f9a(0x1f3)),'Content-Type':_0x3c1f9a(0x1e6)},'body':JSON[_0x3c1f9a(0x216)](_0xbd4bb6)});console[_0x3c1f9a(0x1d8)](_0x3c1f9a(0x211),_0x3af30d[_0x3c1f9a(0x237)]);if(_0x3af30d[_0x3c1f9a(0x237)]!=0xc8){if(_0x3af30d[_0x3c1f9a(0x237)]==0x191){var _0x3df471=await dpRefreshToken();if(!_0x3df471)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x3c1f9a(0x1ca)+_0x3af30d['status'];}else{const _0x7a024e=await _0x3af30d[_0x3c1f9a(0x20c)](),_0xa70601=_0x7a024e[_0x3c1f9a(0x1fc)][_0x3c1f9a(0x213)](_0x11a347=>_0x11a347[_0x3c1f9a(0x1ce)]===_0x3c1f9a(0x1ef))['length'],_0x37a185='Do\x20you\x20want\x20to\x20restore\x20'+_0xa70601+_0x3c1f9a(0x239);if(window['confirm'](_0x37a185))for(const _0x1bad68 of _0x7a024e['entries']){_0x1bad68[_0x3c1f9a(0x1ce)]===_0x3c1f9a(0x1ef)&&(await lockNoti(_0x3c1f9a(0x235),_0x1bad68[_0x3c1f9a(0x214)],0xbb8),await dpDownloadFile(_0x1bad68[_0x3c1f9a(0x214)]));}else console['log'](_0x3c1f9a(0x21e));return!![];}}return![];}}),dropboxBackup[_0x29dd5b(0x217)](_0x29dd5b(0x20a),async function(){var _0x1ad7b4=_0x29dd5b;const _0x1e5cdf=localStorage[_0x1ad7b4(0x206)](_0x1ad7b4(0x233));if(_0x1e5cdf===null||_0x1e5cdf==='')window['alert'](_0x1ad7b4(0x209));else{const _0x279020=[_0x1ad7b4(0x21f),_0x1ad7b4(0x21b)];let _0x296648=0x0;for(const _0x1def98 of _0x279020){const _0x207462=a0_0x4a7fd0[_0x1ad7b4(0x204)+(_0x1def98['charAt'](0x0)[_0x1ad7b4(0x1d4)]()+_0x1def98['slice'](0x1))]();_0x296648+=_0x207462[_0x1ad7b4(0x201)];}if(window['confirm'](_0x1ad7b4(0x1e0)+_0x296648+_0x1ad7b4(0x1c6)))for(const _0x1d686c of _0x279020){const _0x45cceb=a0_0x4a7fd0['list'+(_0x1d686c[_0x1ad7b4(0x1d3)](0x0)[_0x1ad7b4(0x1d4)]()+_0x1d686c[_0x1ad7b4(0x207)](0x1))]();for(const _0x4fe1c0 of _0x45cceb){const _0x2634c9=await a0_0x4a7fd0[_0x1ad7b4(0x1fb)](_0x1ad7b4(0x236)+_0x1d686c+'s/'+_0x4fe1c0);try{await lockNoti(_0x1ad7b4(0x1d7),_0x4fe1c0,0xbb8),await dpUploadFile(_0x4fe1c0,_0x2634c9);if(_0x4fe1c0[_0x1ad7b4(0x1cf)](_0x1ad7b4(0x22d))||_0x4fe1c0['endsWith'](_0x1ad7b4(0x1d9))||_0x4fe1c0['endsWith'](_0x1ad7b4(0x212))||_0x4fe1c0[_0x1ad7b4(0x1cf)](_0x1ad7b4(0x1e9))||_0x4fe1c0[_0x1ad7b4(0x1cf)](_0x1ad7b4(0x232))||_0x4fe1c0[_0x1ad7b4(0x1cf)](_0x1ad7b4(0x1e3))||_0x4fe1c0[_0x1ad7b4(0x1cf)]('.ss6')||_0x4fe1c0['endsWith'](_0x1ad7b4(0x20b))){const _0x31ae52=_0x4fe1c0['substring'](0x0,_0x4fe1c0[_0x1ad7b4(0x225)]('.')),_0x4708ae=_0x4fe1c0[_0x1ad7b4(0x1d3)](_0x4fe1c0[_0x1ad7b4(0x201)]-0x1),_0x3f09a4=localStorage[_0x1ad7b4(0x206)](_0x31ae52+_0x1ad7b4(0x208)+_0x4708ae),_0x2d470d=localStorage[_0x1ad7b4(0x206)](_0x31ae52+_0x1ad7b4(0x1ec)+_0x4708ae);if(_0x3f09a4!==null){const _0x45649a=_0x3f09a4+'\x0a\x0a'+_0x2d470d,_0x4c65a4=new Blob([_0x45649a],{'type':_0x1ad7b4(0x1f9)});await lockNoti(_0x1ad7b4(0x1d7),_0x31ae52+_0x1ad7b4(0x205)+_0x4708ae+_0x1ad7b4(0x1ee),0xbb8),await dpUploadFile(_0x31ae52+'.gba_slot'+_0x4708ae+_0x1ad7b4(0x1ee),_0x4c65a4);}}}catch(_0x4267e7){console[_0x1ad7b4(0x222)](_0x1ad7b4(0x1e2)+_0x4fe1c0+':',_0x4267e7);}}}else console['log'](_0x1ad7b4(0x21e));}}),dropboxCloud[_0x29dd5b(0x217)]('click',function(){var _0x3bbc98=_0x29dd5b;const _0x3e4a19=localStorage['getItem'](_0x3bbc98(0x233));_0x3e4a19===null||_0x3e4a19===''?authorizeWithDropbox():window[_0x3bbc98(0x1d5)](_0x3bbc98(0x1f6))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x3bbc98(0x1cd)][_0x3bbc98(0x1f2)](_0x3bbc98(0x234)),dropboxBackup[_0x3bbc98(0x1cd)][_0x3bbc98(0x1f2)]('active'),dropboxCloud['classList']['remove'](_0x3bbc98(0x234)));}),handleDropboxCallback();});