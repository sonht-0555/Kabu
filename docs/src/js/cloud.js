var a0_0x4f8df3=a0_0x34d6;(function(_0x26a96e,_0x490c88){var _0x2f4f17=a0_0x34d6,_0x1e7047=_0x26a96e();while(!![]){try{var _0x3d7d60=-parseInt(_0x2f4f17(0x1c7))/0x1*(parseInt(_0x2f4f17(0x190))/0x2)+parseInt(_0x2f4f17(0x1aa))/0x3+-parseInt(_0x2f4f17(0x1d6))/0x4+-parseInt(_0x2f4f17(0x1ba))/0x5+parseInt(_0x2f4f17(0x1b9))/0x6+-parseInt(_0x2f4f17(0x1e1))/0x7*(parseInt(_0x2f4f17(0x1bb))/0x8)+parseInt(_0x2f4f17(0x1cd))/0x9;if(_0x3d7d60===_0x490c88)break;else _0x1e7047['push'](_0x1e7047['shift']());}catch(_0x3284e5){_0x1e7047['push'](_0x1e7047['shift']());}}}(a0_0x4c50,0xd21dd));function a0_0x4c50(){var _0x4978a9=['stringify','2871726YjYFPs','302495eRmqjj','184QtZCgQ','Failed\x20to\x20refresh\x20Dropbox\x20token.','click','&client_id=','Cloud\x20login\x20required!','replace','Download\x20failed\x20for\x20','knh3uz2mx2hp2eu','push','uId','json','screenshot','450132KVyrSx','Do\x20you\x20want\x20to\x20logout?','Do\x20not\x20receive\x20authorization','location','split','folder','25797105BPLrQF','responseText','Folder\x20already\x20exists','name','classList','https://api.dropboxapi.com/2/files/list_folder','downloadFileInCloud','application/json','search','3683180NLRhcY','Error\x20creating\x20folder\x20','application/x-www-form-urlencoded','Restore\x20canceled\x20by\x20user.','\x20files\x20in\x20Kabu?','listFiles','application/octet-stream','&redirect_uri=','Do\x20you\x20want\x20to\x20backup\x20','length','Restoring...','482958trgFnm','filter','https://content.dropboxapi.com/2/files/download','Wait\x20a\x20little\x20bit...','=([^&#]*)','code=','Kabu\x20storage\x20↦\x20Cloud\x20◆','refreshToken','error','setRequestHeader','https://api.dropboxapi.com/2/files/create_folder_v2','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','addEventListener','No\x20files\x20found\x20to\x20restore.','href','2jyowCe','Cloud\x20↦\x20Kabu\x20storage\x20◆','accessToken','DOMContentLoaded','https://api.dropbox.com/oauth2/token','getItem','status','nwb3dnfh09rhs31','open','Unable\x20to\x20refresh\x20token','Error\x20while\x20refreshing\x20token:','\x20files\x20from\x20Cloud?','active',',\x20status:\x20','save','access_token','overwrite','file','&token_access_type=','alert','https://www.dropbox.com/oauth2/authorize?client_id=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Authorization\x20Code:','Refreshing\x20token...','Failed\x20to\x20upload\x20file\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','1601877NIszpL','confirm','refresh_token','map','POST','code','onload','log','.tag','remove','Bearer\x20','Download\x20failed,\x20unknown\x20http\x20status:','authorization_code','setItem'];a0_0x4c50=function(){return _0x4978a9;};return a0_0x4c50();}function a0_0x34d6(_0x20d06c,_0xb7e3c9){var _0x4c5039=a0_0x4c50();return a0_0x34d6=function(_0x34d61c,_0x231c0e){_0x34d61c=_0x34d61c-0x18b;var _0x35d8e8=_0x4c5039[_0x34d61c];return _0x35d8e8;},a0_0x34d6(_0x20d06c,_0xb7e3c9);}import*as a0_0x487f44 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4f8df3(0x1c2),clientSecret=a0_0x4f8df3(0x197);function authorizeWithDropbox(){var _0x80196c=a0_0x4f8df3,_0xd4c20a=window[_0x80196c(0x1ca)][_0x80196c(0x18f)][_0x80196c(0x1cb)]('?')[0x0],_0xf9fb4b=_0x80196c(0x1af),_0x3ccb9d='offline',_0x592136=_0x80196c(0x1a4)+clientId+'&response_type='+_0xf9fb4b+_0x80196c(0x1a2)+_0x3ccb9d+_0x80196c(0x1dd)+encodeURIComponent(_0xd4c20a);window[_0x80196c(0x1ca)][_0x80196c(0x18f)]=_0x592136;}function handleDropboxCallback(){var _0x59acd1=a0_0x4f8df3,_0x377bf9=getUrlParameter('code');_0x377bf9?(getAccessToken(_0x377bf9),console[_0x59acd1(0x1b1)](_0x59acd1(0x1a6),_0x377bf9)):console[_0x59acd1(0x1b1)](_0x59acd1(0x1c9));}function getUrlParameter(_0x4bb9fc){var _0x4c510=a0_0x4f8df3;_0x4bb9fc=_0x4bb9fc[_0x4c510(0x1c0)](/[\[]/,'\x5c[')[_0x4c510(0x1c0)](/[\]]/,'\x5c]');var _0x2231fe=new RegExp('[\x5c?&#]'+_0x4bb9fc+_0x4c510(0x1e5)),_0x27259c=_0x2231fe['exec'](location[_0x4c510(0x1d5)]);return _0x27259c===null?'':decodeURIComponent(_0x27259c[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x267b73){var _0x34e34f=a0_0x4f8df3,_0x4c2f16=_0x34e34f(0x1b6),_0xb1a0bb=window[_0x34e34f(0x1ca)][_0x34e34f(0x18f)]['split']('?')[0x0],_0x10f7a7=new XMLHttpRequest();_0x10f7a7[_0x34e34f(0x198)](_0x34e34f(0x1ae),_0x34e34f(0x194)),_0x10f7a7[_0x34e34f(0x1ea)]('Content-Type','application/x-www-form-urlencoded'),_0x10f7a7[_0x34e34f(0x1b0)]=function(){var _0x41d1d0=_0x34e34f;if(_0x10f7a7[_0x41d1d0(0x196)]===0xc8){var _0x247162=JSON['parse'](_0x10f7a7[_0x41d1d0(0x1ce)]),_0x59a119=_0x247162[_0x41d1d0(0x19f)],_0x59e30d=_0x247162[_0x41d1d0(0x1ac)],_0x5b4db3=_0x247162['uid'];localStorage[_0x41d1d0(0x1b7)](_0x41d1d0(0x192),_0x59a119),localStorage['setItem']('refreshToken',_0x59e30d),localStorage[_0x41d1d0(0x1b7)]('uId',_0x5b4db3);}else console[_0x41d1d0(0x1b1)](_0x41d1d0(0x1a5));},_0x10f7a7['send'](_0x34e34f(0x1e6)+_0x267b73+'&grant_type='+_0x4c2f16+_0x34e34f(0x1be)+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0xb1a0bb));}export async function dpCreateFolder(_0x1eca42){var _0x75a6ce=a0_0x4f8df3;const _0x57c52f=localStorage['getItem']('uId');let _0x2a2f80=localStorage[_0x75a6ce(0x195)](_0x75a6ce(0x192));const _0x409ef7='/'+_0x57c52f+'/'+_0x1eca42,_0x29d889=JSON[_0x75a6ce(0x1b8)]({'path':_0x409ef7,'autorename':![]});for(let _0xaa91de=0x0;_0xaa91de<0x2;_0xaa91de++){try{const _0x42f100=await fetch(_0x75a6ce(0x18b),{'method':'POST','headers':{'Authorization':_0x75a6ce(0x1b4)+_0x2a2f80,'Content-Type':'application/json'},'body':_0x29d889});if(_0x42f100[_0x75a6ce(0x196)]===0x191){const _0x585c24=await dpRefreshToken();if(!_0x585c24)throw new Error(_0x75a6ce(0x199));_0x2a2f80=localStorage[_0x75a6ce(0x195)](_0x75a6ce(0x192));continue;}if(_0x42f100[_0x75a6ce(0x196)]===0x199)return{'message':_0x75a6ce(0x1cf),'path':_0x1eca42};if(!_0x42f100['ok'])throw new Error(_0x75a6ce(0x1d7)+_0x1eca42);const _0x50f51d=await _0x42f100[_0x75a6ce(0x1c5)]();return await lockNoti('Folder\x20created','',0xbb8),_0x50f51d;}catch(_0x8a7a1c){if(_0xaa91de===0x1)throw _0x8a7a1c;}}return![];}export async function dpRefreshToken(){var _0x1f1fe9=a0_0x4f8df3;if(!localStorage[_0x1f1fe9(0x195)](_0x1f1fe9(0x1e8)))throw'No\x20refresh\x20token';try{const _0x1e9b54=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x1f1fe9(0x1ae),'headers':{'Content-Type':_0x1f1fe9(0x1d8)},'body':'refresh_token='+localStorage['getItem'](_0x1f1fe9(0x1e8))+_0x1f1fe9(0x18c)}),_0x55c7c0=await _0x1e9b54[_0x1f1fe9(0x1c5)]();if(!_0x55c7c0[_0x1f1fe9(0x1e9)])return localStorage[_0x1f1fe9(0x1b7)](_0x1f1fe9(0x192),_0x55c7c0['access_token']),await lockNoti(_0x1f1fe9(0x1a7),'',0xbb8),await delay(0x3e8),!![];else alert(_0x55c7c0['error_description']||_0x1f1fe9(0x1bc));}catch(_0x43d897){console[_0x1f1fe9(0x1e9)](_0x1f1fe9(0x19a),_0x43d897);}return![];}export async function dpUploadFile(_0x37a0b0,_0x4cbbfb,_0x2ea2d9){var _0x294407=a0_0x4f8df3;const _0x38348b=localStorage[_0x294407(0x195)](_0x294407(0x1c4));var _0x5c7160=JSON[_0x294407(0x1b8)]({'autorename':!![],'mode':_0x294407(0x1a0),'mute':!![],'strict_conflict':![],'path':'/'+_0x38348b+'/'+_0x2ea2d9+'/'+_0x37a0b0}),_0x5ccab9=new Blob([_0x4cbbfb],{'type':'application/octet-stream'});for(var _0x3a1322=0x0;_0x3a1322<0x2;_0x3a1322++){var _0x3f9499=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x294407(0x1ae),'headers':{'Authorization':_0x294407(0x1b4)+localStorage[_0x294407(0x195)](_0x294407(0x192)),'Dropbox-API-Arg':_0x5c7160,'Content-Type':_0x294407(0x1dc)},'body':_0x5ccab9});if(_0x3f9499['status']!=0xc8){if(_0x3f9499[_0x294407(0x196)]==0x191){var _0x2c0f34=await dpRefreshToken();if(!_0x2c0f34)throw _0x294407(0x199);continue;}else throw _0x294407(0x1a9)+_0x3f9499[_0x294407(0x196)];}else{var _0x87c9f9=await _0x3f9499['json']();return console[_0x294407(0x1b1)](_0x294407(0x1e7),_0x37a0b0),_0x87c9f9;}}return![];}export async function dpDownloadFile(_0x356c41,_0x17029b){var _0x291b23=a0_0x4f8df3;const _0x420ea9=localStorage[_0x291b23(0x195)](_0x291b23(0x1c4));var _0x3de8dd=JSON[_0x291b23(0x1b8)]({'path':'/'+_0x420ea9+'/'+_0x17029b+'/'+_0x356c41});for(var _0x1f3cf9=0x0;_0x1f3cf9<0x2;_0x1f3cf9++){var _0x47a2b9=await fetch(_0x291b23(0x1e3),{'method':'POST','headers':{'Authorization':_0x291b23(0x1b4)+localStorage['getItem'](_0x291b23(0x192)),'Dropbox-API-Arg':_0x3de8dd}});if(_0x47a2b9[_0x291b23(0x196)]!=0xc8){if(_0x47a2b9['status']==0x191){var _0x5b9c21=await dpRefreshToken();if(!_0x5b9c21)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x291b23(0x1b5)+_0x47a2b9[_0x291b23(0x196)];}const _0x233498=new File([await _0x47a2b9['blob']()],_0x356c41);return console[_0x291b23(0x1b1)](_0x291b23(0x191),_0x233498[_0x291b23(0x1d0)]),a0_0x487f44['uploadFileInCloud'](_0x233498,()=>{}),_0x233498;}return![];}document[a0_0x4f8df3(0x18d)](a0_0x4f8df3(0x193),function(){var _0x5cd2a1=a0_0x4f8df3;dropboxRestore['addEventListener'](_0x5cd2a1(0x1bd),async function(){var _0x4034cc=_0x5cd2a1;await lockNoti(_0x4034cc(0x1e4),'',0x1388);const _0x28cffe=localStorage['getItem']('uId'),_0x472b99=['state',_0x4034cc(0x19e),_0x4034cc(0x1c6)];if(!_0x28cffe){window[_0x4034cc(0x1a3)](_0x4034cc(0x1bf));return;}let _0x4441a6=[];for(const _0x5a001d of _0x472b99){let _0x32c26c={'path':'/'+_0x28cffe+'/'+_0x5a001d};for(let _0x12a0df=0x0;_0x12a0df<0x2;_0x12a0df++){let _0x427b3c=await fetch(_0x4034cc(0x1d2),{'method':_0x4034cc(0x1ae),'headers':{'Authorization':_0x4034cc(0x1b4)+localStorage[_0x4034cc(0x195)](_0x4034cc(0x192)),'Content-Type':_0x4034cc(0x1d4)},'body':JSON['stringify'](_0x32c26c)});if(_0x427b3c[_0x4034cc(0x196)]===0xc8){let _0x5c2936=await _0x427b3c[_0x4034cc(0x1c5)](),_0xeee685=_0x5c2936['entries'][_0x4034cc(0x1e2)](_0x7c74fe=>_0x7c74fe[_0x4034cc(0x1b2)]===_0x4034cc(0x1a1));_0xeee685[_0x4034cc(0x1df)]>0x0&&_0x4441a6[_0x4034cc(0x1c3)](..._0xeee685[_0x4034cc(0x1ad)](_0x310bfb=>({'name':_0x310bfb[_0x4034cc(0x1d0)],'folder':_0x5a001d})));break;}else{if(_0x427b3c[_0x4034cc(0x196)]===0x191){let _0x1a655b=await dpRefreshToken();if(!_0x1a655b)throw _0x4034cc(0x199);}else{console[_0x4034cc(0x1e9)](_0x4034cc(0x1c1)+_0x5a001d+_0x4034cc(0x19d)+_0x427b3c[_0x4034cc(0x196)]);break;}}}}if(_0x4441a6[_0x4034cc(0x1df)]>0x0){const _0x30a1c6='Do\x20you\x20want\x20to\x20restore\x20'+_0x4441a6[_0x4034cc(0x1df)]+_0x4034cc(0x19b);if(window[_0x4034cc(0x1ab)](_0x30a1c6))for(const _0x5b92e8 of _0x4441a6){await lockNoti(_0x4034cc(0x1e0),_0x5b92e8[_0x4034cc(0x1d0)],0xbb8),await dpDownloadFile(_0x5b92e8['name'],_0x5b92e8[_0x4034cc(0x1cc)]);}else console[_0x4034cc(0x1b1)](_0x4034cc(0x1d9));}else console[_0x4034cc(0x1b1)](_0x4034cc(0x18e));}),dropboxBackup[_0x5cd2a1(0x18d)](_0x5cd2a1(0x1bd),async function(){var _0x166f9c=_0x5cd2a1;await lockNoti(_0x166f9c(0x1e4),'',0x1388);const _0x147e8e=localStorage[_0x166f9c(0x195)]('uId');if(_0x147e8e===null||_0x147e8e==='')window[_0x166f9c(0x1a3)]('Cloud\x20login\x20required!');else{const _0x49576f=['state','save',_0x166f9c(0x1c6)];for(const _0x53ee48 of _0x49576f){await dpCreateFolder(_0x53ee48);}let _0x529024=0x0;for(const _0x3f0145 of _0x49576f){const _0x1c6d95=a0_0x487f44['listFiles'](_0x3f0145+'s');_0x529024+=_0x1c6d95[_0x166f9c(0x1df)];}if(window[_0x166f9c(0x1ab)](_0x166f9c(0x1de)+_0x529024+_0x166f9c(0x1da)))for(const _0x50db6f of _0x49576f){const _0x4a0089=a0_0x487f44[_0x166f9c(0x1db)](_0x50db6f+'s');for(const _0x191f9e of _0x4a0089){const _0x30b20b=await a0_0x487f44[_0x166f9c(0x1d3)]('/data/'+_0x50db6f+'s/'+_0x191f9e);try{await lockNoti('Backing\x20up...',_0x191f9e,0xbb8),await dpUploadFile(_0x191f9e,_0x30b20b,_0x50db6f);}catch(_0x2c0fe8){console[_0x166f9c(0x1e9)](_0x166f9c(0x1a8)+_0x191f9e+':',_0x2c0fe8);}}}else console[_0x166f9c(0x1b1)](_0x166f9c(0x1d9));}}),dropboxCloud[_0x5cd2a1(0x18d)](_0x5cd2a1(0x1bd),function(){var _0xbb78ce=_0x5cd2a1;const _0x1af706=localStorage['getItem'](_0xbb78ce(0x1c4));_0x1af706===null||_0x1af706===''?authorizeWithDropbox():window[_0xbb78ce(0x1ab)](_0xbb78ce(0x1c8))&&(localStorage[_0xbb78ce(0x1b7)]('uId',''),dropboxRestore[_0xbb78ce(0x1d1)][_0xbb78ce(0x1b3)]('active'),dropboxBackup['classList']['remove'](_0xbb78ce(0x19c)),dropboxCloud[_0xbb78ce(0x1d1)][_0xbb78ce(0x1b3)](_0xbb78ce(0x19c)));}),handleDropboxCallback();});