var a0_0x3c06fe=a0_0x559c;(function(_0x4b91fa,_0x419ace){var _0x5454a3=a0_0x559c,_0x2891be=_0x4b91fa();while(!![]){try{var _0x55285d=parseInt(_0x5454a3(0x13e))/0x1+-parseInt(_0x5454a3(0x188))/0x2*(-parseInt(_0x5454a3(0x17a))/0x3)+parseInt(_0x5454a3(0x169))/0x4*(-parseInt(_0x5454a3(0x16e))/0x5)+parseInt(_0x5454a3(0x194))/0x6+parseInt(_0x5454a3(0x13d))/0x7*(-parseInt(_0x5454a3(0x177))/0x8)+parseInt(_0x5454a3(0x137))/0x9+parseInt(_0x5454a3(0x176))/0xa*(parseInt(_0x5454a3(0x150))/0xb);if(_0x55285d===_0x419ace)break;else _0x2891be['push'](_0x2891be['shift']());}catch(_0x303a49){_0x2891be['push'](_0x2891be['shift']());}}}(a0_0x392d,0x23c72));import*as a0_0x2bc5cf from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x3c06fe(0x153),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x9837cc=a0_0x3c06fe,_0x39be36=window[_0x9837cc(0x156)][_0x9837cc(0x18b)]['split']('?')[0x0],_0x45e1ff=_0x9837cc(0x15a),_0x3b8e63=_0x9837cc(0x16d),_0x5253e2=_0x9837cc(0x19e)+clientId+_0x9837cc(0x19f)+_0x45e1ff+_0x9837cc(0x15c)+_0x3b8e63+_0x9837cc(0x15b)+encodeURIComponent(_0x39be36);window['location'][_0x9837cc(0x18b)]=_0x5253e2;}function handleDropboxCallback(){var _0x1d18de=a0_0x3c06fe,_0x22ea11=getUrlParameter(_0x1d18de(0x15a));_0x22ea11?(getAccessToken(_0x22ea11),console[_0x1d18de(0x184)](_0x1d18de(0x14b),_0x22ea11)):console[_0x1d18de(0x184)]('Do\x20not\x20receive\x20authorization');}function a0_0x559c(_0x2746fc,_0x30f7bd){var _0x392da6=a0_0x392d();return a0_0x559c=function(_0x559ced,_0x10c940){_0x559ced=_0x559ced-0x133;var _0x22df74=_0x392da6[_0x559ced];return _0x22df74;},a0_0x559c(_0x2746fc,_0x30f7bd);}function a0_0x392d(){var _0x2dec79=['https://api.dropboxapi.com/2/files/list_folder','Failed\x20to\x20upload\x20file\x20','toUpperCase','578982LVnyEo','DOMContentLoaded','Backing\x20up...','downloadFileInCloud','&client_secret=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&grant_type=','stringify','access_token','.ss5','https://www.dropbox.com/oauth2/authorize?client_id=','&response_type=','endsWith','Refreshing\x20token...','entries','status','exec','https://content.dropboxapi.com/2/files/upload','.txt','Cloud\x20login\x20required!','1220346SHADGH','accessToken','FSSync','file','click','Download\x20failed,\x20unknown\x20http\x20status:\x20','49805zSRvDW','36810QcZHDj','code=','refresh_token','addEventListener','.ss3','Do\x20you\x20want\x20to\x20restore\x20','refresh_token=','POST','send','Content-Type','Kabu\x20storage\x20↦\x20Cloud\x20◆','classList','charAt','Authorization\x20Code:','Restoring...','Do\x20you\x20want\x20to\x20logout?','length','application/octet-stream','55DVZUiV','alert','[\x5c?&#]','knh3uz2mx2hp2eu','text/plain','Upload\x20failed,\x20unknown\x20http\x20status:\x20','location','Restore\x20canceled\x20by\x20user.','split','application/x-www-form-urlencoded','code','&redirect_uri=','&token_access_type=','setRequestHeader','name','/data/','No\x20refresh\x20token','error','Unable\x20to\x20refresh\x20token','.tag','list','.ss4','https://api.dropboxapi.com/oauth2/token','slice','\x20files\x20in\x20Cloud?','68edRgLo','.gba_slot','Bearer\x20','parse','offline','47155gJiYOA','https://api.dropbox.com/oauth2/token','application/json','overwrite','active','Download\x20failed,\x20unknown\x20http\x20status:','.ss6','\x20files\x20in\x20Kabu?','335690oguWnk','232rlvbKO','.ss0','json','3cCHqyM','&client_id=','.gba_imageState','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','remove','uId','responseText','refreshToken','open','setItem','log','replace','filter','_dateState','152924UTIiLg','text','substring','href','state','getItem','_imageState','confirm','.ss2'];a0_0x392d=function(){return _0x2dec79;};return a0_0x392d();}function getUrlParameter(_0x54789e){var _0x582eb2=a0_0x3c06fe;_0x54789e=_0x54789e[_0x582eb2(0x185)](/[\[]/,'\x5c[')[_0x582eb2(0x185)](/[\]]/,'\x5c]');var _0x49df17=new RegExp(_0x582eb2(0x152)+_0x54789e+'=([^&#]*)'),_0x53a519=_0x49df17[_0x582eb2(0x133)](location['search']);return _0x53a519===null?'':decodeURIComponent(_0x53a519[0x1][_0x582eb2(0x185)](/\+/g,'\x20'));}function getAccessToken(_0x5ec188){var _0x367a6e=a0_0x3c06fe,_0x33489a='authorization_code',_0x435451=window[_0x367a6e(0x156)][_0x367a6e(0x18b)][_0x367a6e(0x158)]('?')[0x0],_0x1ae06d=new XMLHttpRequest();_0x1ae06d[_0x367a6e(0x182)]('POST',_0x367a6e(0x16f)),_0x1ae06d[_0x367a6e(0x15d)](_0x367a6e(0x147),_0x367a6e(0x159)),_0x1ae06d['onload']=function(){var _0x5400c5=_0x367a6e;if(_0x1ae06d[_0x5400c5(0x1a3)]===0xc8){var _0x259ccc=JSON[_0x5400c5(0x16c)](_0x1ae06d[_0x5400c5(0x180)]),_0x25b6b8=_0x259ccc[_0x5400c5(0x19c)],_0x49c1d0=_0x259ccc[_0x5400c5(0x140)],_0x3c9e9f=_0x259ccc['uid'];localStorage['setItem'](_0x5400c5(0x138),_0x25b6b8),localStorage['setItem'](_0x5400c5(0x181),_0x49c1d0),localStorage[_0x5400c5(0x183)]('uId',_0x3c9e9f);}else console[_0x5400c5(0x184)](_0x5400c5(0x199));},_0x1ae06d[_0x367a6e(0x146)](_0x367a6e(0x13f)+_0x5ec188+_0x367a6e(0x19a)+_0x33489a+_0x367a6e(0x17b)+clientId+_0x367a6e(0x198)+clientSecret+_0x367a6e(0x15b)+encodeURIComponent(_0x435451));}export async function dpRefreshToken(){var _0x591b8a=a0_0x3c06fe;if(!localStorage[_0x591b8a(0x18d)](_0x591b8a(0x181)))throw _0x591b8a(0x160);try{const _0x12fdaf=await fetch(_0x591b8a(0x166),{'method':_0x591b8a(0x145),'headers':{'Content-Type':_0x591b8a(0x159)},'body':_0x591b8a(0x144)+localStorage[_0x591b8a(0x18d)](_0x591b8a(0x181))+_0x591b8a(0x17d)}),_0x651fa8=await _0x12fdaf[_0x591b8a(0x179)]();if(!_0x651fa8[_0x591b8a(0x161)])return localStorage[_0x591b8a(0x183)](_0x591b8a(0x138),_0x651fa8[_0x591b8a(0x19c)]),await lockNoti('',_0x591b8a(0x1a1),0xbb8),await delay(0x3e8),!![];else alert(_0x651fa8['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x319847){console['error']('Error\x20while\x20refreshing\x20token:',_0x319847);}return![];}export async function dpUploadFile(_0x2dd1d0,_0x2b4e30){var _0x36c713=a0_0x3c06fe;const _0x4ff858=localStorage['getItem'](_0x36c713(0x17f));var _0x38c3de=JSON['stringify']({'autorename':!![],'mode':_0x36c713(0x171),'mute':!![],'strict_conflict':![],'path':'/'+_0x4ff858+'/'+_0x2dd1d0}),_0x4aed99=new Blob([_0x2b4e30],{'type':'application/octet-stream'});for(var _0x85371c=0x0;_0x85371c<0x2;_0x85371c++){var _0x26eba2=await fetch(_0x36c713(0x134),{'method':_0x36c713(0x145),'headers':{'Authorization':_0x36c713(0x16b)+localStorage['getItem'](_0x36c713(0x138)),'Dropbox-API-Arg':_0x38c3de,'Content-Type':_0x36c713(0x14f)},'body':_0x4aed99});if(_0x26eba2['status']!=0xc8){if(_0x26eba2[_0x36c713(0x1a3)]==0x191){var _0x392c0f=await dpRefreshToken();if(!_0x392c0f)throw _0x36c713(0x162);continue;}else throw _0x36c713(0x155)+_0x26eba2[_0x36c713(0x1a3)];}else{var _0xc636be=await _0x26eba2['json']();return console['log'](_0x36c713(0x148),_0x2dd1d0),_0xc636be;}}return![];}async function dpDownloadFile(_0xef0e0e){var _0x2bae6a=a0_0x3c06fe;const _0x42aac9=localStorage[_0x2bae6a(0x18d)]('uId');var _0x50ba79=JSON[_0x2bae6a(0x19b)]({'path':'/'+_0x42aac9+'/'+_0xef0e0e});for(var _0x4264cb=0x0;_0x4264cb<0x2;_0x4264cb++){var _0x3e38b7=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x2bae6a(0x16b)+localStorage[_0x2bae6a(0x18d)](_0x2bae6a(0x138)),'Dropbox-API-Arg':_0x50ba79}});if(_0x3e38b7['status']!=0xc8){if(_0x3e38b7[_0x2bae6a(0x1a3)]==0x191){var _0x112929=await dpRefreshToken();if(!_0x112929)throw _0x2bae6a(0x162);continue;}else throw _0x2bae6a(0x173)+_0x3e38b7[_0x2bae6a(0x1a3)];}const _0x1cfc2f=new File([await _0x3e38b7['blob']()],_0xef0e0e);console[_0x2bae6a(0x184)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x1cfc2f['name']);if(_0xef0e0e['endsWith']('.txt')){const _0x12bf7b=await _0x1cfc2f[_0x2bae6a(0x189)](),[_0x472275,_0x1dd910]=_0x12bf7b[_0x2bae6a(0x158)]('\x0a\x0a'),_0x36b366=_0xef0e0e[_0x2bae6a(0x18a)](0x0,_0xef0e0e['lastIndexOf']('gba')+0x3),_0x4f0da0=_0xef0e0e[_0x2bae6a(0x14a)](_0xef0e0e[_0x2bae6a(0x14e)]-0x5);localStorage[_0x2bae6a(0x183)](_0x36b366+_0x2bae6a(0x187)+_0x4f0da0,_0x1dd910),localStorage['setItem'](_0x36b366+_0x2bae6a(0x18e)+_0x4f0da0,_0x472275);}else a0_0x2bc5cf['uploadSaveOrSaveState'](_0x1cfc2f,()=>{var _0x396a7c=_0x2bae6a;localStorageFile(),Module[_0x396a7c(0x139)]();});return _0x1cfc2f;}return![];}document['addEventListener'](a0_0x3c06fe(0x195),function(){var _0x175cea=a0_0x3c06fe;dropboxRestore['addEventListener'](_0x175cea(0x13b),async function(){var _0x5a00e1=_0x175cea;const _0x1cf77b=localStorage[_0x5a00e1(0x18d)](_0x5a00e1(0x17f));if(_0x1cf77b===null||_0x1cf77b==='')window[_0x5a00e1(0x151)](_0x5a00e1(0x136));else{var _0x4d1834={'path':'/'+_0x1cf77b};for(var _0x2ab7c3=0x0;_0x2ab7c3<0x2;_0x2ab7c3++){var _0xe0461a=await fetch(_0x5a00e1(0x191),{'method':'POST','headers':{'Authorization':_0x5a00e1(0x16b)+localStorage['getItem'](_0x5a00e1(0x138)),'Content-Type':_0x5a00e1(0x170)},'body':JSON[_0x5a00e1(0x19b)](_0x4d1834)});console[_0x5a00e1(0x184)]('status:\x20',_0xe0461a['status']);if(_0xe0461a[_0x5a00e1(0x1a3)]!=0xc8){if(_0xe0461a[_0x5a00e1(0x1a3)]==0x191){var _0x46c3c6=await dpRefreshToken();if(!_0x46c3c6)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5a00e1(0x13c)+_0xe0461a['status'];}else{const _0x5308c0=await _0xe0461a[_0x5a00e1(0x179)](),_0x570ba=_0x5308c0[_0x5a00e1(0x1a2)][_0x5a00e1(0x186)](_0x256bbc=>_0x256bbc[_0x5a00e1(0x163)]===_0x5a00e1(0x13a))[_0x5a00e1(0x14e)],_0x2de3c6=_0x5a00e1(0x143)+_0x570ba+_0x5a00e1(0x168);if(window[_0x5a00e1(0x18f)](_0x2de3c6))for(const _0x5a322c of _0x5308c0[_0x5a00e1(0x1a2)]){_0x5a322c['.tag']===_0x5a00e1(0x13a)&&(await lockNoti(_0x5a00e1(0x14c),_0x5a322c[_0x5a00e1(0x15e)],0xbb8),await dpDownloadFile(_0x5a322c[_0x5a00e1(0x15e)]));}else console[_0x5a00e1(0x184)](_0x5a00e1(0x157));return!![];}}return![];}}),dropboxBackup[_0x175cea(0x141)]('click',async function(){var _0x411b8c=_0x175cea;const _0x31feb2=localStorage[_0x411b8c(0x18d)]('uId');if(_0x31feb2===null||_0x31feb2==='')window[_0x411b8c(0x151)]('Cloud\x20login\x20required!');else{const _0x1e1ba6=[_0x411b8c(0x18c),'save'];let _0x4dcdec=0x0;for(const _0x24ddf6 of _0x1e1ba6){const _0x19a63a=a0_0x2bc5cf[_0x411b8c(0x164)+(_0x24ddf6[_0x411b8c(0x14a)](0x0)[_0x411b8c(0x193)]()+_0x24ddf6[_0x411b8c(0x167)](0x1))]();_0x4dcdec+=_0x19a63a[_0x411b8c(0x14e)];}if(window[_0x411b8c(0x18f)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4dcdec+_0x411b8c(0x175)))for(const _0x5ab21f of _0x1e1ba6){const _0x36c6a9=a0_0x2bc5cf[_0x411b8c(0x164)+(_0x5ab21f[_0x411b8c(0x14a)](0x0)[_0x411b8c(0x193)]()+_0x5ab21f[_0x411b8c(0x167)](0x1))]();for(const _0x46c854 of _0x36c6a9){const _0x33c433=await a0_0x2bc5cf[_0x411b8c(0x197)](_0x411b8c(0x15f)+_0x5ab21f+'s/'+_0x46c854);try{await lockNoti(_0x411b8c(0x196),_0x46c854,0xbb8),await dpUploadFile(_0x46c854,_0x33c433);if(_0x46c854['endsWith'](_0x411b8c(0x178))||_0x46c854[_0x411b8c(0x1a0)]('.ss1')||_0x46c854[_0x411b8c(0x1a0)](_0x411b8c(0x190))||_0x46c854[_0x411b8c(0x1a0)](_0x411b8c(0x142))||_0x46c854['endsWith'](_0x411b8c(0x165))||_0x46c854[_0x411b8c(0x1a0)](_0x411b8c(0x19d))||_0x46c854[_0x411b8c(0x1a0)](_0x411b8c(0x174))||_0x46c854['endsWith']('.ss7')){const _0x3ba153=_0x46c854['substring'](0x0,_0x46c854['lastIndexOf']('.')),_0x24abea=_0x46c854[_0x411b8c(0x14a)](_0x46c854[_0x411b8c(0x14e)]-0x1),_0x2de9dc=localStorage[_0x411b8c(0x18d)](_0x3ba153+_0x411b8c(0x17c)+_0x24abea),_0x57e73b=localStorage['getItem'](_0x3ba153+'.gba_dateState'+_0x24abea);if(_0x2de9dc!==null){const _0x360ecb=_0x2de9dc+'\x0a\x0a'+_0x57e73b,_0x8c96a0=new Blob([_0x360ecb],{'type':_0x411b8c(0x154)});await lockNoti(_0x411b8c(0x196),_0x3ba153+_0x411b8c(0x16a)+_0x24abea+_0x411b8c(0x135),0xbb8),await dpUploadFile(_0x3ba153+_0x411b8c(0x16a)+_0x24abea+_0x411b8c(0x135),_0x8c96a0);}}}catch(_0x38e268){console[_0x411b8c(0x161)](_0x411b8c(0x192)+_0x46c854+':',_0x38e268);}}}else console['log'](_0x411b8c(0x157));}}),dropboxCloud['addEventListener'](_0x175cea(0x13b),function(){var _0x36ad54=_0x175cea;const _0x53366e=localStorage[_0x36ad54(0x18d)](_0x36ad54(0x17f));_0x53366e===null||_0x53366e===''?authorizeWithDropbox():window['confirm'](_0x36ad54(0x14d))&&(localStorage['setItem'](_0x36ad54(0x17f),''),dropboxRestore['classList'][_0x36ad54(0x17e)]('active'),dropboxBackup['classList']['remove'](_0x36ad54(0x172)),dropboxCloud[_0x36ad54(0x149)][_0x36ad54(0x17e)](_0x36ad54(0x172)));}),handleDropboxCallback();});