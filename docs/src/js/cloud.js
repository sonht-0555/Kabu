function a0_0x2d1e(_0x4fbdb3,_0x51a680){var _0x5affbc=a0_0x5aff();return a0_0x2d1e=function(_0x2d1ec9,_0x5efea4){_0x2d1ec9=_0x2d1ec9-0xb4;var _0xfea798=_0x5affbc[_0x2d1ec9];return _0xfea798;},a0_0x2d1e(_0x4fbdb3,_0x51a680);}var a0_0x3f2c6f=a0_0x2d1e;(function(_0x254e91,_0x334b5f){var _0x1719ef=a0_0x2d1e,_0xdefa37=_0x254e91();while(!![]){try{var _0x3b8601=parseInt(_0x1719ef(0xce))/0x1+-parseInt(_0x1719ef(0xc1))/0x2*(parseInt(_0x1719ef(0xf4))/0x3)+parseInt(_0x1719ef(0xf6))/0x4+parseInt(_0x1719ef(0xc0))/0x5*(-parseInt(_0x1719ef(0xdf))/0x6)+parseInt(_0x1719ef(0xb7))/0x7+parseInt(_0x1719ef(0xd8))/0x8*(-parseInt(_0x1719ef(0x104))/0x9)+parseInt(_0x1719ef(0xcc))/0xa*(-parseInt(_0x1719ef(0xc5))/0xb);if(_0x3b8601===_0x334b5f)break;else _0xdefa37['push'](_0xdefa37['shift']());}catch(_0x4986ef){_0xdefa37['push'](_0xdefa37['shift']());}}}(a0_0x5aff,0x80954));import*as a0_0x3ba893 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x3f2c6f(0x105);function authorizeWithDropbox(){var _0x3e6acf=a0_0x3f2c6f,_0x155216=window[_0x3e6acf(0xee)][_0x3e6acf(0xff)][_0x3e6acf(0xd0)]('?')[0x0],_0x41fe62=_0x3e6acf(0x106),_0xad669d=_0x3e6acf(0xb8),_0x4afc64=_0x3e6acf(0x101)+clientId+_0x3e6acf(0xc2)+_0x41fe62+_0x3e6acf(0xe4)+_0xad669d+'&redirect_uri='+encodeURIComponent(_0x155216);window['location'][_0x3e6acf(0xff)]=_0x4afc64;}function handleDropboxCallback(){var _0x505af1=a0_0x3f2c6f,_0x438106=getUrlParameter(_0x505af1(0x106));_0x438106?(getAccessToken(_0x438106),console[_0x505af1(0x10c)]('Authorization\x20Code:',_0x438106)):console[_0x505af1(0x10c)](_0x505af1(0xe2));}function getUrlParameter(_0x20d1c2){var _0x573b77=a0_0x3f2c6f;_0x20d1c2=_0x20d1c2[_0x573b77(0xd9)](/[\[]/,'\x5c[')[_0x573b77(0xd9)](/[\]]/,'\x5c]');var _0x383391=new RegExp(_0x573b77(0xbb)+_0x20d1c2+_0x573b77(0xb5)),_0x1678a7=_0x383391[_0x573b77(0xbd)](location[_0x573b77(0xf3)]);return _0x1678a7===null?'':decodeURIComponent(_0x1678a7[0x1][_0x573b77(0xd9)](/\+/g,'\x20'));}function getAccessToken(_0x3b390f){var _0x1853ee=a0_0x3f2c6f,_0xa3d8e3=_0x1853ee(0xf2),_0x1f84ce=window['location'][_0x1853ee(0xff)]['split']('?')[0x0],_0x40ca72=new XMLHttpRequest();_0x40ca72['open']('POST','https://api.dropbox.com/oauth2/token'),_0x40ca72[_0x1853ee(0xe0)]('Content-Type',_0x1853ee(0xcd)),_0x40ca72[_0x1853ee(0xcb)]=function(){var _0x1b69bf=_0x1853ee;if(_0x40ca72[_0x1b69bf(0xd4)]===0xc8){var _0x53cef5=JSON[_0x1b69bf(0x111)](_0x40ca72[_0x1b69bf(0x10d)]),_0x557465=_0x53cef5[_0x1b69bf(0xd3)],_0x35ce41=_0x53cef5[_0x1b69bf(0x102)],_0x3e1876=_0x53cef5[_0x1b69bf(0xf5)];localStorage['setItem']('accessToken',_0x557465),localStorage[_0x1b69bf(0xf9)]('refreshToken',_0x35ce41),localStorage[_0x1b69bf(0xf9)](_0x1b69bf(0xdc),_0x3e1876);}else console[_0x1b69bf(0x10c)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x40ca72[_0x1853ee(0x112)](_0x1853ee(0xbe)+_0x3b390f+_0x1853ee(0xfe)+_0xa3d8e3+'&client_id='+clientId+_0x1853ee(0xc3)+clientSecret+_0x1853ee(0xe5)+encodeURIComponent(_0x1f84ce));}export async function dpCreateFolder(_0x2c3ce9){var _0x41703c=a0_0x3f2c6f;const _0x33f3d5=localStorage[_0x41703c(0xbf)](_0x41703c(0xdc));let _0x4c9ded=localStorage[_0x41703c(0xbf)](_0x41703c(0x108));const _0x2db1c6='/'+_0x33f3d5+'/'+_0x2c3ce9,_0x3c70d8=JSON['stringify']({'path':_0x2db1c6,'autorename':![]});for(let _0x588ac8=0x0;_0x588ac8<0x2;_0x588ac8++){try{const _0x614343=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x41703c(0xe8),'headers':{'Authorization':'Bearer\x20'+_0x4c9ded,'Content-Type':_0x41703c(0xd5)},'body':_0x3c70d8});if(_0x614343[_0x41703c(0xd4)]===0x191){const _0x47591c=await dpRefreshToken();if(!_0x47591c)throw new Error(_0x41703c(0xd2));_0x4c9ded=localStorage['getItem'](_0x41703c(0x108));continue;}if(_0x614343[_0x41703c(0xd4)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x2c3ce9};if(!_0x614343['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x2c3ce9);const _0x54f376=await _0x614343[_0x41703c(0xb6)]();return await lockNoti('Folder\x20created','',0xbb8),_0x54f376;}catch(_0x2575ea){if(_0x588ac8===0x1)throw _0x2575ea;}}return![];}function a0_0x5aff(){var _0x15592a=['refresh_token','length','18xPWbdT','nwb3dnfh09rhs31','code','Download\x20failed\x20for\x20','accessToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','addEventListener','state','log','responseText','save','confirm','refreshToken','parse','send','listFiles','screenshot','blob','Download\x20failed,\x20unknown\x20http\x20status:','=([^&#]*)','json','6202504MshNRZ','offline','filter','classList','[\x5c?&#]','Kabu\x20storage\x20↦\x20Cloud\x20◆','exec','code=','getItem','5udGjUR','435680uhQDNc','&response_type=','&client_secret=','stringify','132IoUrbI','click','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','downloadFileInCloud','file','folder','onload','382810AxwHXN','application/x-www-form-urlencoded','669910KWuyiu','https://content.dropboxapi.com/2/files/upload','split','Error\x20while\x20refreshing\x20token:','Unable\x20to\x20refresh\x20token','access_token','status','application/json','active','Refreshing\x20token...','937520oKfOgh','replace',',\x20status:\x20','entries','uId','Restore\x20canceled\x20by\x20user.','Backing\x20up...','1137108rCqvio','setRequestHeader','.tag','Do\x20not\x20receive\x20authorization','application/octet-stream','&token_access_type=','&redirect_uri=','error_description','No\x20files\x20found\x20to\x20restore.','POST','uploadFileInCloud','Cloud\x20↦\x20Kabu\x20storage\x20◆','Upload\x20failed,\x20unknown\x20http\x20status:\x20','overwrite','/data/','location','name','Restoring...','Wait\x20a\x20little\x20bit...','authorization_code','search','6WzYkbg','uid','1158576AxRNBb','\x20files\x20in\x20Kabu?','remove','setItem','push','Failed\x20to\x20upload\x20file\x20','Bearer\x20','alert','&grant_type=','href','error','https://www.dropbox.com/oauth2/authorize?client_id='];a0_0x5aff=function(){return _0x15592a;};return a0_0x5aff();}export async function dpRefreshToken(){var _0xd3af57=a0_0x3f2c6f;if(!localStorage[_0xd3af57(0xbf)](_0xd3af57(0x110)))throw'No\x20refresh\x20token';try{const _0x4b801d=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0xd3af57(0xbf)](_0xd3af57(0x110))+_0xd3af57(0xc7)}),_0x5a02f4=await _0x4b801d['json']();if(!_0x5a02f4[_0xd3af57(0x100)])return localStorage[_0xd3af57(0xf9)](_0xd3af57(0x108),_0x5a02f4[_0xd3af57(0xd3)]),await lockNoti(_0xd3af57(0xd7),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5a02f4[_0xd3af57(0xe6)]||_0xd3af57(0x109));}catch(_0x4ab8cb){console[_0xd3af57(0x100)](_0xd3af57(0xd1),_0x4ab8cb);}return![];}export async function dpUploadFile(_0x48c058,_0x2944af,_0x2ee80f){var _0x2de958=a0_0x3f2c6f;const _0x2a74c5=localStorage[_0x2de958(0xbf)](_0x2de958(0xdc));var _0x3ff545=JSON[_0x2de958(0xc4)]({'autorename':!![],'mode':_0x2de958(0xec),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a74c5+'/'+_0x2ee80f+'/'+_0x48c058}),_0x18c741=new Blob([_0x2944af],{'type':_0x2de958(0xe3)});for(var _0x27df96=0x0;_0x27df96<0x2;_0x27df96++){var _0x30b732=await fetch(_0x2de958(0xcf),{'method':_0x2de958(0xe8),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x2de958(0x108)),'Dropbox-API-Arg':_0x3ff545,'Content-Type':_0x2de958(0xe3)},'body':_0x18c741});if(_0x30b732['status']!=0xc8){if(_0x30b732[_0x2de958(0xd4)]==0x191){var _0x70a2a3=await dpRefreshToken();if(!_0x70a2a3)throw _0x2de958(0xd2);continue;}else throw _0x2de958(0xeb)+_0x30b732[_0x2de958(0xd4)];}else{var _0x1593c6=await _0x30b732[_0x2de958(0xb6)]();return console['log'](_0x2de958(0xbc),_0x48c058),_0x1593c6;}}return![];}export async function dpDownloadFile(_0x361e28,_0x2d3aeb){var _0x545636=a0_0x3f2c6f;const _0x1c42cd=localStorage['getItem'](_0x545636(0xdc));var _0x3be163=JSON[_0x545636(0xc4)]({'path':'/'+_0x1c42cd+'/'+_0x2d3aeb+'/'+_0x361e28});for(var _0x4f9fe0=0x0;_0x4f9fe0<0x2;_0x4f9fe0++){var _0x137cfd=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x545636(0xe8),'headers':{'Authorization':_0x545636(0xfc)+localStorage['getItem'](_0x545636(0x108)),'Dropbox-API-Arg':_0x3be163}});if(_0x137cfd['status']!=0xc8){if(_0x137cfd[_0x545636(0xd4)]==0x191){var _0x3bfbdb=await dpRefreshToken();if(!_0x3bfbdb)throw _0x545636(0xd2);continue;}else throw _0x545636(0xb4)+_0x137cfd['status'];}const _0x562402=new File([await _0x137cfd[_0x545636(0x115)]()],_0x361e28);return console[_0x545636(0x10c)](_0x545636(0xea),_0x562402[_0x545636(0xef)]),a0_0x3ba893[_0x545636(0xe9)](_0x562402,()=>{}),_0x562402;}return![];}document[a0_0x3f2c6f(0x10a)]('DOMContentLoaded',function(){var _0x262076=a0_0x3f2c6f;dropboxRestore[_0x262076(0x10a)]('click',async function(){var _0x1142c8=_0x262076;await lockNoti(_0x1142c8(0xf1),'',0x1388);const _0x522d51=localStorage[_0x1142c8(0xbf)](_0x1142c8(0xdc)),_0x26a81b=[_0x1142c8(0x10b),_0x1142c8(0x10e),_0x1142c8(0x114)];if(!_0x522d51){window[_0x1142c8(0xfd)]('Cloud\x20login\x20required!');return;}let _0x2b022f=[];for(const _0x6812e4 of _0x26a81b){let _0x45a054={'path':'/'+_0x522d51+'/'+_0x6812e4};for(let _0x22756e=0x0;_0x22756e<0x2;_0x22756e++){let _0x11c741=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x1142c8(0xfc)+localStorage[_0x1142c8(0xbf)](_0x1142c8(0x108)),'Content-Type':_0x1142c8(0xd5)},'body':JSON['stringify'](_0x45a054)});if(_0x11c741[_0x1142c8(0xd4)]===0xc8){let _0x3ce93c=await _0x11c741[_0x1142c8(0xb6)](),_0x360854=_0x3ce93c[_0x1142c8(0xdb)][_0x1142c8(0xb9)](_0x3d0825=>_0x3d0825[_0x1142c8(0xe1)]===_0x1142c8(0xc9));_0x360854[_0x1142c8(0x103)]>0x0&&_0x2b022f[_0x1142c8(0xfa)](..._0x360854['map'](_0x3fbdbc=>({'name':_0x3fbdbc['name'],'folder':_0x6812e4})));break;}else{if(_0x11c741[_0x1142c8(0xd4)]===0x191){let _0x406169=await dpRefreshToken();if(!_0x406169)throw _0x1142c8(0xd2);}else{console[_0x1142c8(0x100)](_0x1142c8(0x107)+_0x6812e4+_0x1142c8(0xda)+_0x11c741[_0x1142c8(0xd4)]);break;}}}}if(_0x2b022f['length']>0x0){const _0x5f2647='Do\x20you\x20want\x20to\x20restore\x20'+_0x2b022f['length']+'\x20files\x20from\x20Cloud?';if(window[_0x1142c8(0x10f)](_0x5f2647))for(const _0x83da65 of _0x2b022f){await lockNoti(_0x1142c8(0xf0),_0x83da65['name'],0xbb8),await dpDownloadFile(_0x83da65[_0x1142c8(0xef)],_0x83da65[_0x1142c8(0xca)]);}else console['log'](_0x1142c8(0xdd));}else console[_0x1142c8(0x10c)](_0x1142c8(0xe7));}),dropboxBackup[_0x262076(0x10a)](_0x262076(0xc6),async function(){var _0x4ca84d=_0x262076;await lockNoti(_0x4ca84d(0xf1),'',0x1388);const _0x41d05c=localStorage['getItem'](_0x4ca84d(0xdc));if(_0x41d05c===null||_0x41d05c==='')window[_0x4ca84d(0xfd)]('Cloud\x20login\x20required!');else{const _0x5b94f0=['state',_0x4ca84d(0x10e),_0x4ca84d(0x114)];for(const _0xac4951 of _0x5b94f0){await dpCreateFolder(_0xac4951);}let _0xc5f067=0x0;for(const _0x1aa185 of _0x5b94f0){const _0x335781=a0_0x3ba893[_0x4ca84d(0x113)](_0x1aa185+'s');_0xc5f067+=_0x335781['length'];}if(window[_0x4ca84d(0x10f)]('Do\x20you\x20want\x20to\x20backup\x20'+_0xc5f067+_0x4ca84d(0xf7)))for(const _0xb7e174 of _0x5b94f0){const _0x220b45=a0_0x3ba893[_0x4ca84d(0x113)](_0xb7e174+'s');for(const _0x3fc69d of _0x220b45){const _0x35fb2b=await a0_0x3ba893[_0x4ca84d(0xc8)](_0x4ca84d(0xed)+_0xb7e174+'s/'+_0x3fc69d);try{await lockNoti(_0x4ca84d(0xde),_0x3fc69d,0xbb8),await dpUploadFile(_0x3fc69d,_0x35fb2b,_0xb7e174);}catch(_0x5644f5){console['error'](_0x4ca84d(0xfb)+_0x3fc69d+':',_0x5644f5);}}}else console['log'](_0x4ca84d(0xdd));}}),dropboxCloud['addEventListener'](_0x262076(0xc6),function(){var _0x3546c0=_0x262076;const _0x4fa21f=localStorage['getItem'](_0x3546c0(0xdc));_0x4fa21f===null||_0x4fa21f===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x3546c0(0xf9)](_0x3546c0(0xdc),''),dropboxRestore[_0x3546c0(0xba)][_0x3546c0(0xf8)](_0x3546c0(0xd6)),dropboxBackup[_0x3546c0(0xba)][_0x3546c0(0xf8)](_0x3546c0(0xd6)),dropboxCloud[_0x3546c0(0xba)][_0x3546c0(0xf8)]('active'));}),handleDropboxCallback();});