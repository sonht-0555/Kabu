var a0_0x4928f7=a0_0x1498;(function(_0x1a01ca,_0x4f17bb){var _0x219029=a0_0x1498,_0x36c536=_0x1a01ca();while(!![]){try{var _0x1c497d=-parseInt(_0x219029(0x1e1))/0x1*(-parseInt(_0x219029(0x1c6))/0x2)+-parseInt(_0x219029(0x210))/0x3+parseInt(_0x219029(0x1dd))/0x4+parseInt(_0x219029(0x1b9))/0x5*(-parseInt(_0x219029(0x1ee))/0x6)+-parseInt(_0x219029(0x203))/0x7*(-parseInt(_0x219029(0x1f6))/0x8)+parseInt(_0x219029(0x1c3))/0x9*(parseInt(_0x219029(0x1ec))/0xa)+-parseInt(_0x219029(0x1d8))/0xb;if(_0x1c497d===_0x4f17bb)break;else _0x36c536['push'](_0x36c536['shift']());}catch(_0x373a8b){_0x36c536['push'](_0x36c536['shift']());}}}(a0_0x25d7,0xdb8ac));import*as a0_0x613dff from'./main.js';function a0_0x25d7(){var _0x1090b1=['send','overwrite','stringify','\x20files\x20from\x20Cloud?','217490OZoUlI','application/json','317358LeUhRo',',\x20status:\x20','addEventListener','search','open','knh3uz2mx2hp2eu','setRequestHeader','offline','8XbQWGK','error','length','Unable\x20to\x20refresh\x20token','json','authorization_code','Cloud\x20↦\x20Kabu\x20storage\x20◆','onload','.tag','https://api.dropbox.com/oauth2/token','state','\x20files\x20in\x20Kabu?','Folder\x20created','7664209XDkyJc','https://api.dropboxapi.com/2/files/create_folder_v2','log','uId','map','uploadFileInCloud','&grant_type=','Wait\x20a\x20little\x20bit...','uid','accessToken','Download\x20failed\x20for\x20','No\x20files\x20found\x20to\x20restore.','replace','3509412GAgkeD','file','Backing\x20up...','Folder\x20already\x20exists','code','entries','Restoring...','Do\x20you\x20want\x20to\x20restore\x20','error_description','&client_secret=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','confirm','POST','&client_id=','parse','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','60iOIzzL','[\x5c?&#]','/data/','https://www.dropbox.com/oauth2/authorize?client_id=','exec','Restore\x20canceled\x20by\x20user.','setItem','&redirect_uri=','location','href','531xUYjaf','Do\x20you\x20want\x20to\x20logout?','&response_type=','2xgGfGH','screenshot','push','Error\x20creating\x20folder\x20','refresh_token=','active','code=','filter','access_token','classList','Cloud\x20login\x20required!','nwb3dnfh09rhs31','application/octet-stream','listFiles','responseText','Error\x20while\x20refreshing\x20token:','https://api.dropboxapi.com/2/files/list_folder','Bearer\x20','17254754PyVSkC','application/x-www-form-urlencoded','status','click','remove','3014268FngUMb','getItem','refreshToken','folder','1140733WhmWtc','blob','Kabu\x20storage\x20↦\x20Cloud\x20◆','DOMContentLoaded','&token_access_type=','Download\x20failed,\x20unknown\x20http\x20status:','https://content.dropboxapi.com/2/files/upload'];a0_0x25d7=function(){return _0x1090b1;};return a0_0x25d7();}import{localStorageFile}from'./storage.js';function a0_0x1498(_0x9f4ddf,_0x563bce){var _0x25d76f=a0_0x25d7();return a0_0x1498=function(_0x1498cf,_0x56677b){_0x1498cf=_0x1498cf-0x1b6;var _0x4ed546=_0x25d76f[_0x1498cf];return _0x4ed546;},a0_0x1498(_0x9f4ddf,_0x563bce);}var clientId=a0_0x4928f7(0x1f3),clientSecret=a0_0x4928f7(0x1d1);function authorizeWithDropbox(){var _0x346b00=a0_0x4928f7,_0x1a58e9=window[_0x346b00(0x1c1)][_0x346b00(0x1c2)]['split']('?')[0x0],_0xea17a=_0x346b00(0x214),_0x20ddce=_0x346b00(0x1f5),_0x587e08=_0x346b00(0x1bc)+clientId+_0x346b00(0x1c5)+_0xea17a+_0x346b00(0x1e5)+_0x20ddce+_0x346b00(0x1c0)+encodeURIComponent(_0x1a58e9);window[_0x346b00(0x1c1)][_0x346b00(0x1c2)]=_0x587e08;}function handleDropboxCallback(){var _0x128f37=a0_0x4928f7,_0x2fb94f=getUrlParameter('code');_0x2fb94f?(getAccessToken(_0x2fb94f),console[_0x128f37(0x205)]('Authorization\x20Code:',_0x2fb94f)):console[_0x128f37(0x205)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x4b87fb){var _0x39436b=a0_0x4928f7;_0x4b87fb=_0x4b87fb['replace'](/[\[]/,'\x5c[')[_0x39436b(0x20f)](/[\]]/,'\x5c]');var _0x3cd724=new RegExp(_0x39436b(0x1ba)+_0x4b87fb+'=([^&#]*)'),_0x548015=_0x3cd724[_0x39436b(0x1bd)](location[_0x39436b(0x1f1)]);return _0x548015===null?'':decodeURIComponent(_0x548015[0x1][_0x39436b(0x20f)](/\+/g,'\x20'));}function getAccessToken(_0x4bdad8){var _0x399cc4=a0_0x4928f7,_0x39c90f=_0x399cc4(0x1fb),_0x233ac7=window[_0x399cc4(0x1c1)][_0x399cc4(0x1c2)]['split']('?')[0x0],_0x33eb78=new XMLHttpRequest();_0x33eb78[_0x399cc4(0x1f2)](_0x399cc4(0x21c),_0x399cc4(0x1ff)),_0x33eb78[_0x399cc4(0x1f4)]('Content-Type','application/x-www-form-urlencoded'),_0x33eb78[_0x399cc4(0x1fd)]=function(){var _0x1a5604=_0x399cc4;if(_0x33eb78['status']===0xc8){var _0x3ecf51=JSON[_0x1a5604(0x1b7)](_0x33eb78[_0x1a5604(0x1d4)]),_0x4f5cb5=_0x3ecf51['access_token'],_0x310b7f=_0x3ecf51['refresh_token'],_0x123091=_0x3ecf51[_0x1a5604(0x20b)];localStorage[_0x1a5604(0x1bf)](_0x1a5604(0x20c),_0x4f5cb5),localStorage[_0x1a5604(0x1bf)](_0x1a5604(0x1df),_0x310b7f),localStorage[_0x1a5604(0x1bf)](_0x1a5604(0x206),_0x123091);}else console[_0x1a5604(0x205)](_0x1a5604(0x1b8));},_0x33eb78[_0x399cc4(0x1e8)](_0x399cc4(0x1cc)+_0x4bdad8+_0x399cc4(0x209)+_0x39c90f+_0x399cc4(0x1b6)+clientId+_0x399cc4(0x219)+clientSecret+_0x399cc4(0x1c0)+encodeURIComponent(_0x233ac7));}export async function dpCreateFolder(_0x1f604f){var _0x4e5fe6=a0_0x4928f7;const _0x192818=localStorage['getItem'](_0x4e5fe6(0x206));let _0x348c52=localStorage[_0x4e5fe6(0x1de)](_0x4e5fe6(0x20c));const _0x2210c4='/'+_0x192818+'/'+_0x1f604f,_0x4f0a94=JSON[_0x4e5fe6(0x1ea)]({'path':_0x2210c4,'autorename':![]});for(let _0x210dea=0x0;_0x210dea<0x2;_0x210dea++){try{const _0x5570e3=await fetch(_0x4e5fe6(0x204),{'method':_0x4e5fe6(0x21c),'headers':{'Authorization':_0x4e5fe6(0x1d7)+_0x348c52,'Content-Type':'application/json'},'body':_0x4f0a94});if(_0x5570e3['status']===0x191){const _0x3cecda=await dpRefreshToken();if(!_0x3cecda)throw new Error(_0x4e5fe6(0x1f9));_0x348c52=localStorage[_0x4e5fe6(0x1de)](_0x4e5fe6(0x20c));continue;}if(_0x5570e3[_0x4e5fe6(0x1da)]===0x199)return{'message':_0x4e5fe6(0x213),'path':_0x1f604f};if(!_0x5570e3['ok'])throw new Error(_0x4e5fe6(0x1c9)+_0x1f604f);const _0x35c10e=await _0x5570e3[_0x4e5fe6(0x1fa)]();return await lockNoti(_0x4e5fe6(0x202),'',0xbb8),_0x35c10e;}catch(_0xcc7548){if(_0x210dea===0x1)throw _0xcc7548;}}return![];}export async function dpRefreshToken(){var _0x111814=a0_0x4928f7;if(!localStorage[_0x111814(0x1de)](_0x111814(0x1df)))throw'No\x20refresh\x20token';try{const _0x394a39=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x111814(0x21c),'headers':{'Content-Type':_0x111814(0x1d9)},'body':_0x111814(0x1ca)+localStorage['getItem'](_0x111814(0x1df))+_0x111814(0x21a)}),_0x3649a0=await _0x394a39[_0x111814(0x1fa)]();if(!_0x3649a0[_0x111814(0x1f7)])return localStorage[_0x111814(0x1bf)](_0x111814(0x20c),_0x3649a0[_0x111814(0x1ce)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x3649a0[_0x111814(0x218)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x11a40f){console[_0x111814(0x1f7)](_0x111814(0x1d5),_0x11a40f);}return![];}export async function dpUploadFile(_0x46be3c,_0x2890a8,_0xabf205){var _0x1a5486=a0_0x4928f7;const _0x1e359c=localStorage[_0x1a5486(0x1de)](_0x1a5486(0x206));var _0x338550=JSON[_0x1a5486(0x1ea)]({'autorename':!![],'mode':_0x1a5486(0x1e9),'mute':!![],'strict_conflict':![],'path':'/'+_0x1e359c+'/'+_0xabf205+'/'+_0x46be3c}),_0x2b382d=new Blob([_0x2890a8],{'type':_0x1a5486(0x1d2)});for(var _0x223991=0x0;_0x223991<0x2;_0x223991++){var _0x30cd78=await fetch(_0x1a5486(0x1e7),{'method':_0x1a5486(0x21c),'headers':{'Authorization':_0x1a5486(0x1d7)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x338550,'Content-Type':'application/octet-stream'},'body':_0x2b382d});if(_0x30cd78[_0x1a5486(0x1da)]!=0xc8){if(_0x30cd78[_0x1a5486(0x1da)]==0x191){var _0x4456b3=await dpRefreshToken();if(!_0x4456b3)throw _0x1a5486(0x1f9);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x30cd78[_0x1a5486(0x1da)];}else{var _0xc749e8=await _0x30cd78[_0x1a5486(0x1fa)]();return console[_0x1a5486(0x205)](_0x1a5486(0x1e3),_0x46be3c),_0xc749e8;}}return![];}export async function dpDownloadFile(_0x55cca8,_0x1b5893){var _0x48c6e4=a0_0x4928f7;const _0x5ca80c=localStorage['getItem'](_0x48c6e4(0x206));var _0x2d6207=JSON['stringify']({'path':'/'+_0x5ca80c+'/'+_0x1b5893+'/'+_0x55cca8});for(var _0xd96a6f=0x0;_0xd96a6f<0x2;_0xd96a6f++){var _0x56be89=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x48c6e4(0x21c),'headers':{'Authorization':_0x48c6e4(0x1d7)+localStorage[_0x48c6e4(0x1de)](_0x48c6e4(0x20c)),'Dropbox-API-Arg':_0x2d6207}});if(_0x56be89[_0x48c6e4(0x1da)]!=0xc8){if(_0x56be89[_0x48c6e4(0x1da)]==0x191){var _0x104eb3=await dpRefreshToken();if(!_0x104eb3)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x48c6e4(0x1e6)+_0x56be89[_0x48c6e4(0x1da)];}const _0x27be05=new File([await _0x56be89[_0x48c6e4(0x1e2)]()],_0x55cca8);return console[_0x48c6e4(0x205)](_0x48c6e4(0x1fc),_0x27be05['name']),a0_0x613dff[_0x48c6e4(0x208)](_0x27be05,()=>{}),_0x27be05;}return![];}document[a0_0x4928f7(0x1f0)](a0_0x4928f7(0x1e4),function(){var _0x165d82=a0_0x4928f7;dropboxRestore[_0x165d82(0x1f0)](_0x165d82(0x1db),async function(){var _0x39dee9=_0x165d82;await lockNoti(_0x39dee9(0x20a),'',0x1388);const _0x224568=localStorage[_0x39dee9(0x1de)]('uId'),_0x38498c=[_0x39dee9(0x200),'save',_0x39dee9(0x1c7)];if(!_0x224568){window['alert']('Cloud\x20login\x20required!');return;}let _0x16fcdf=[];for(const _0xabadd of _0x38498c){let _0x2fa38d={'path':'/'+_0x224568+'/'+_0xabadd};for(let _0x46f07e=0x0;_0x46f07e<0x2;_0x46f07e++){let _0x606622=await fetch(_0x39dee9(0x1d6),{'method':_0x39dee9(0x21c),'headers':{'Authorization':_0x39dee9(0x1d7)+localStorage[_0x39dee9(0x1de)]('accessToken'),'Content-Type':_0x39dee9(0x1ed)},'body':JSON[_0x39dee9(0x1ea)](_0x2fa38d)});if(_0x606622['status']===0xc8){let _0x556cf8=await _0x606622[_0x39dee9(0x1fa)](),_0x376aae=_0x556cf8[_0x39dee9(0x215)][_0x39dee9(0x1cd)](_0x248b63=>_0x248b63[_0x39dee9(0x1fe)]===_0x39dee9(0x211));_0x376aae[_0x39dee9(0x1f8)]>0x0&&_0x16fcdf[_0x39dee9(0x1c8)](..._0x376aae[_0x39dee9(0x207)](_0x5df541=>({'name':_0x5df541['name'],'folder':_0xabadd})));break;}else{if(_0x606622[_0x39dee9(0x1da)]===0x191){let _0x3df3f7=await dpRefreshToken();if(!_0x3df3f7)throw _0x39dee9(0x1f9);}else{console[_0x39dee9(0x1f7)](_0x39dee9(0x20d)+_0xabadd+_0x39dee9(0x1ef)+_0x606622[_0x39dee9(0x1da)]);break;}}}}if(_0x16fcdf[_0x39dee9(0x1f8)]>0x0){const _0x3f00db=_0x39dee9(0x217)+_0x16fcdf['length']+_0x39dee9(0x1eb);if(window[_0x39dee9(0x21b)](_0x3f00db))for(const _0x3750c1 of _0x16fcdf){await lockNoti(_0x39dee9(0x216),_0x3750c1['name'],0xbb8),await dpDownloadFile(_0x3750c1['name'],_0x3750c1[_0x39dee9(0x1e0)]);}else console[_0x39dee9(0x205)]('Restore\x20canceled\x20by\x20user.');}else console[_0x39dee9(0x205)](_0x39dee9(0x20e));}),dropboxBackup[_0x165d82(0x1f0)](_0x165d82(0x1db),async function(){var _0x114c8d=_0x165d82;await lockNoti(_0x114c8d(0x20a),'',0x1388);const _0x21748b=localStorage[_0x114c8d(0x1de)](_0x114c8d(0x206));if(_0x21748b===null||_0x21748b==='')window['alert'](_0x114c8d(0x1d0));else{const _0x4d1e09=['state','save',_0x114c8d(0x1c7)];for(const _0x17bfcc of _0x4d1e09){await dpCreateFolder(_0x17bfcc);}let _0x46f2b2=0x0;for(const _0x5d3ab5 of _0x4d1e09){const _0x142aa2=a0_0x613dff[_0x114c8d(0x1d3)](_0x5d3ab5+'s');_0x46f2b2+=_0x142aa2['length'];}if(window[_0x114c8d(0x21b)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x46f2b2+_0x114c8d(0x201)))for(const _0x58403d of _0x4d1e09){const _0x5dc6f7=a0_0x613dff[_0x114c8d(0x1d3)](_0x58403d+'s');for(const _0xdeaa16 of _0x5dc6f7){const _0x176538=await a0_0x613dff['downloadFileInCloud'](_0x114c8d(0x1bb)+_0x58403d+'s/'+_0xdeaa16);try{await lockNoti(_0x114c8d(0x212),_0xdeaa16,0xbb8),await dpUploadFile(_0xdeaa16,_0x176538,_0x58403d);}catch(_0x13b876){console[_0x114c8d(0x1f7)]('Failed\x20to\x20upload\x20file\x20'+_0xdeaa16+':',_0x13b876);}}}else console[_0x114c8d(0x205)](_0x114c8d(0x1be));}}),dropboxCloud[_0x165d82(0x1f0)]('click',function(){var _0x2a1230=_0x165d82;const _0x53c1a5=localStorage[_0x2a1230(0x1de)](_0x2a1230(0x206));_0x53c1a5===null||_0x53c1a5===''?authorizeWithDropbox():window['confirm'](_0x2a1230(0x1c4))&&(localStorage['setItem'](_0x2a1230(0x206),''),dropboxRestore['classList'][_0x2a1230(0x1dc)](_0x2a1230(0x1cb)),dropboxBackup[_0x2a1230(0x1cf)][_0x2a1230(0x1dc)]('active'),dropboxCloud[_0x2a1230(0x1cf)][_0x2a1230(0x1dc)](_0x2a1230(0x1cb)));}),handleDropboxCallback();});