var a0_0x34348c=a0_0x425c;(function(_0x2e4a65,_0x49ed6a){var _0xdf6e51=a0_0x425c,_0x39f9f9=_0x2e4a65();while(!![]){try{var _0x2a9857=parseInt(_0xdf6e51(0xc5))/0x1+-parseInt(_0xdf6e51(0xc8))/0x2*(parseInt(_0xdf6e51(0x10e))/0x3)+parseInt(_0xdf6e51(0xc9))/0x4*(-parseInt(_0xdf6e51(0xf6))/0x5)+parseInt(_0xdf6e51(0xee))/0x6+-parseInt(_0xdf6e51(0xca))/0x7+-parseInt(_0xdf6e51(0xf4))/0x8+parseInt(_0xdf6e51(0xd4))/0x9*(parseInt(_0xdf6e51(0xcb))/0xa);if(_0x2a9857===_0x49ed6a)break;else _0x39f9f9['push'](_0x39f9f9['shift']());}catch(_0x699db1){_0x39f9f9['push'](_0x39f9f9['shift']());}}}(a0_0x5a71,0xb1826));import*as a0_0x277787 from'./main.js';function a0_0x5a71(){var _0xa526a6=['slice','Failed\x20to\x20upload\x20file\x20','click','=([^&#]*)','offline','access_token','authorization_code','Folder\x20already\x20exists','send','https://www.dropbox.com/oauth2/authorize?client_id=','responseText','Refreshing\x20token...','active','parse','Authorization\x20Code:','getItem','Restoring...','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','&redirect_uri=','[\x5c?&#]','/data/','1212827jfAgEb','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','application/json','8654XrROPs','28ALgWaP','9195816wskhlD','210130rjGcFS','onload','replace','log','length','confirm','open','error_description','https://api.dropboxapi.com/oauth2/token','270hWaNUi','application/x-www-form-urlencoded','name','Cloud\x20login\x20required!','code','&token_access_type=','uId','refreshToken','application/octet-stream','screenshot','https://api.dropboxapi.com/2/files/list_folder','refresh_token','classList','.tag','Bearer\x20','Download\x20failed\x20for\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','stringify','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20you\x20want\x20to\x20restore\x20','https://api.dropbox.com/oauth2/token','&client_id=','https://api.dropboxapi.com/2/files/create_folder_v2','file','knh3uz2mx2hp2eu','uid','6418794MHnEhb','setRequestHeader','Restore\x20canceled\x20by\x20user.','code=','Unable\x20to\x20refresh\x20token','charAt','2538000NQTSVF','entries','207895DWeHjb','split','toUpperCase','blob','Upload\x20failed,\x20unknown\x20http\x20status:\x20','No\x20refresh\x20token','href','Do\x20not\x20receive\x20authorization','downloadFileInCloud','location','POST','remove','Backing\x20up...','FSSync','Wait\x20a\x20little\x20bit...','alert','list','status','&client_secret=','accessToken','exec','setItem','json','&grant_type=','183mWdeSl','https://content.dropboxapi.com/2/files/upload','&response_type=','addEventListener','\x20files\x20in\x20Kabu?','error','Error\x20while\x20refreshing\x20token:','Download\x20failed,\x20unknown\x20http\x20status:'];a0_0x5a71=function(){return _0xa526a6;};return a0_0x5a71();}function a0_0x425c(_0x3e25da,_0x319b57){var _0x5a71f6=a0_0x5a71();return a0_0x425c=function(_0x425c26,_0x419c3a){_0x425c26=_0x425c26-0xad;var _0x1c08e9=_0x5a71f6[_0x425c26];return _0x1c08e9;},a0_0x425c(_0x3e25da,_0x319b57);}import{localStorageFile}from'./storage.js';var clientId=a0_0x34348c(0xec),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0xb510b3=a0_0x34348c,_0x5f3608=window[_0xb510b3(0xff)][_0xb510b3(0xfc)][_0xb510b3(0xf7)]('?')[0x0],_0x2ff55c=_0xb510b3(0xd8),_0x3954a6=_0xb510b3(0xb4),_0x25a48d=_0xb510b3(0xb9)+clientId+_0xb510b3(0x110)+_0x2ff55c+_0xb510b3(0xd9)+_0x3954a6+_0xb510b3(0xc2)+encodeURIComponent(_0x5f3608);window[_0xb510b3(0xff)]['href']=_0x25a48d;}function handleDropboxCallback(){var _0x339cc6=a0_0x34348c,_0x547e36=getUrlParameter(_0x339cc6(0xd8));_0x547e36?(getAccessToken(_0x547e36),console[_0x339cc6(0xce)](_0x339cc6(0xbe),_0x547e36)):console['log'](_0x339cc6(0xfd));}function getUrlParameter(_0x268e62){var _0x4af7d7=a0_0x34348c;_0x268e62=_0x268e62[_0x4af7d7(0xcd)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2d9a33=new RegExp(_0x4af7d7(0xc3)+_0x268e62+_0x4af7d7(0xb3)),_0x335ef9=_0x2d9a33[_0x4af7d7(0x10a)](location['search']);return _0x335ef9===null?'':decodeURIComponent(_0x335ef9[0x1][_0x4af7d7(0xcd)](/\+/g,'\x20'));}function getAccessToken(_0x1fd0ee){var _0x5ba51a=a0_0x34348c,_0x60d2f=_0x5ba51a(0xb6),_0x5d2b89=window[_0x5ba51a(0xff)][_0x5ba51a(0xfc)][_0x5ba51a(0xf7)]('?')[0x0],_0x59054a=new XMLHttpRequest();_0x59054a[_0x5ba51a(0xd1)](_0x5ba51a(0x100),_0x5ba51a(0xe8)),_0x59054a[_0x5ba51a(0xef)]('Content-Type',_0x5ba51a(0xd5)),_0x59054a[_0x5ba51a(0xcc)]=function(){var _0x4040f6=_0x5ba51a;if(_0x59054a[_0x4040f6(0x107)]===0xc8){var _0x3f9ab2=JSON[_0x4040f6(0xbd)](_0x59054a[_0x4040f6(0xba)]),_0x3bde99=_0x3f9ab2[_0x4040f6(0xb5)],_0x1a375a=_0x3f9ab2[_0x4040f6(0xdf)],_0x4c1847=_0x3f9ab2[_0x4040f6(0xed)];localStorage[_0x4040f6(0x10b)](_0x4040f6(0x109),_0x3bde99),localStorage['setItem']('refreshToken',_0x1a375a),localStorage['setItem'](_0x4040f6(0xda),_0x4c1847);}else console[_0x4040f6(0xce)](_0x4040f6(0xc6));},_0x59054a[_0x5ba51a(0xb8)](_0x5ba51a(0xf1)+_0x1fd0ee+_0x5ba51a(0x10d)+_0x60d2f+_0x5ba51a(0xe9)+clientId+_0x5ba51a(0x108)+clientSecret+_0x5ba51a(0xc2)+encodeURIComponent(_0x5d2b89));}export async function dpCreateFolder(_0x5b0c13){var _0x25e11f=a0_0x34348c;const _0x2ad90f=localStorage[_0x25e11f(0xbf)](_0x25e11f(0xda));let _0x2d300c=localStorage['getItem'](_0x25e11f(0x109));const _0x1617d2='/'+_0x2ad90f+'/'+_0x5b0c13,_0x51d4c7=JSON[_0x25e11f(0xe5)]({'path':_0x1617d2,'autorename':![]});for(let _0xb58b83=0x0;_0xb58b83<0x2;_0xb58b83++){try{const _0x5ae211=await fetch(_0x25e11f(0xea),{'method':_0x25e11f(0x100),'headers':{'Authorization':_0x25e11f(0xe2)+_0x2d300c,'Content-Type':_0x25e11f(0xc7)},'body':_0x51d4c7});if(_0x5ae211[_0x25e11f(0x107)]===0x191){const _0x5a0641=await dpRefreshToken();if(!_0x5a0641)throw new Error('Unable\x20to\x20refresh\x20token');_0x2d300c=localStorage[_0x25e11f(0xbf)](_0x25e11f(0x109));continue;}if(_0x5ae211['status']===0x199)return{'message':_0x25e11f(0xb7),'path':_0x5b0c13};if(!_0x5ae211['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x5b0c13);const _0x50a96c=await _0x5ae211[_0x25e11f(0x10c)]();return await lockNoti('Folder\x20created','',0xbb8),_0x50a96c;}catch(_0xc49163){if(_0xb58b83===0x1)throw _0xc49163;}}return![];}export async function dpRefreshToken(){var _0x3e4add=a0_0x34348c;if(!localStorage[_0x3e4add(0xbf)](_0x3e4add(0xdb)))throw _0x3e4add(0xfb);try{const _0x433341=await fetch(_0x3e4add(0xd3),{'method':_0x3e4add(0x100),'headers':{'Content-Type':_0x3e4add(0xd5)},'body':'refresh_token='+localStorage[_0x3e4add(0xbf)](_0x3e4add(0xdb))+_0x3e4add(0xc1)}),_0x1868f5=await _0x433341['json']();if(!_0x1868f5['error'])return localStorage[_0x3e4add(0x10b)](_0x3e4add(0x109),_0x1868f5['access_token']),await lockNoti(_0x3e4add(0xbb),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1868f5[_0x3e4add(0xd2)]||_0x3e4add(0xe4));}catch(_0x36744f){console[_0x3e4add(0xad)](_0x3e4add(0xae),_0x36744f);}return![];}export async function dpUploadFile(_0x2b500b,_0x5ea8c1,_0x31299b){var _0x3249cf=a0_0x34348c;const _0x4eb127=localStorage['getItem'](_0x3249cf(0xda));var _0x2729f4=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x4eb127+'/'+_0x31299b+'/'+_0x2b500b}),_0x4caaa5=new Blob([_0x5ea8c1],{'type':_0x3249cf(0xdc)});for(var _0x5d476a=0x0;_0x5d476a<0x2;_0x5d476a++){var _0xb0251c=await fetch(_0x3249cf(0x10f),{'method':_0x3249cf(0x100),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3249cf(0xbf)](_0x3249cf(0x109)),'Dropbox-API-Arg':_0x2729f4,'Content-Type':'application/octet-stream'},'body':_0x4caaa5});if(_0xb0251c['status']!=0xc8){if(_0xb0251c[_0x3249cf(0x107)]==0x191){var _0xf67c19=await dpRefreshToken();if(!_0xf67c19)throw _0x3249cf(0xf2);continue;}else throw _0x3249cf(0xfa)+_0xb0251c[_0x3249cf(0x107)];}else{var _0x182252=await _0xb0251c[_0x3249cf(0x10c)]();return console[_0x3249cf(0xce)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x2b500b),_0x182252;}}return![];}export async function dpDownloadFile(_0x549184,_0x27c1be){var _0x1e7ff0=a0_0x34348c;const _0x50c2b1=localStorage[_0x1e7ff0(0xbf)]('uId');var _0x1492d1=JSON['stringify']({'path':'/'+_0x50c2b1+'/'+_0x27c1be+'/'+_0x549184});for(var _0x1c965e=0x0;_0x1c965e<0x2;_0x1c965e++){var _0xcc0fc3=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1e7ff0(0x100),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x1e7ff0(0xbf)]('accessToken'),'Dropbox-API-Arg':_0x1492d1}});if(_0xcc0fc3['status']!=0xc8){if(_0xcc0fc3[_0x1e7ff0(0x107)]==0x191){var _0xf92674=await dpRefreshToken();if(!_0xf92674)throw _0x1e7ff0(0xf2);continue;}else throw _0x1e7ff0(0xaf)+_0xcc0fc3[_0x1e7ff0(0x107)];}const _0x59b174=new File([await _0xcc0fc3[_0x1e7ff0(0xf9)]()],_0x549184);return console[_0x1e7ff0(0xce)](_0x1e7ff0(0xe6),_0x59b174['name']),a0_0x277787['uploadFileInCloud'](_0x59b174,()=>{var _0x214408=_0x1e7ff0;localStorageFile(),Module[_0x214408(0x103)]();}),_0x59b174;}return![];}document[a0_0x34348c(0x111)]('DOMContentLoaded',function(){var _0x5a788f=a0_0x34348c;dropboxRestore[_0x5a788f(0x111)](_0x5a788f(0xb2),async function(){var _0x365813=_0x5a788f;await lockNoti(_0x365813(0x104),'',0x1388);const _0x43c1fb=localStorage[_0x365813(0xbf)](_0x365813(0xda)),_0x57c241=['state','save',_0x365813(0xdd)];if(!_0x43c1fb){window[_0x365813(0x105)]('Cloud\x20login\x20required!');return;}let _0x19735a=[];for(const _0x3cdc41 of _0x57c241){let _0x1970d9={'path':'/'+_0x43c1fb+'/'+_0x3cdc41};for(let _0x2e52f3=0x0;_0x2e52f3<0x2;_0x2e52f3++){let _0xbac112=await fetch(_0x365813(0xde),{'method':_0x365813(0x100),'headers':{'Authorization':_0x365813(0xe2)+localStorage[_0x365813(0xbf)](_0x365813(0x109)),'Content-Type':_0x365813(0xc7)},'body':JSON[_0x365813(0xe5)](_0x1970d9)});if(_0xbac112[_0x365813(0x107)]===0xc8){let _0x322983=await _0xbac112['json'](),_0x726951=_0x322983[_0x365813(0xf5)]['filter'](_0xa0c7df=>_0xa0c7df[_0x365813(0xe1)]===_0x365813(0xeb));_0x726951[_0x365813(0xcf)]>0x0&&_0x19735a['push'](..._0x726951['map'](_0x282ab9=>({'name':_0x282ab9[_0x365813(0xd6)],'folder':_0x3cdc41})));break;}else{if(_0xbac112['status']===0x191){let _0x4812f7=await dpRefreshToken();if(!_0x4812f7)throw _0x365813(0xf2);}else{console[_0x365813(0xad)](_0x365813(0xe3)+_0x3cdc41+',\x20status:\x20'+_0xbac112['status']);break;}}}}if(_0x19735a[_0x365813(0xcf)]>0x0){const _0x521913=_0x365813(0xe7)+_0x19735a[_0x365813(0xcf)]+'\x20files\x20from\x20Cloud?';if(window[_0x365813(0xd0)](_0x521913))for(const _0xf00216 of _0x19735a){await lockNoti(_0x365813(0xc0),_0xf00216[_0x365813(0xd6)],0xbb8),await dpDownloadFile(_0xf00216['name'],_0xf00216['folder']);}else console[_0x365813(0xce)](_0x365813(0xf0));}else console[_0x365813(0xce)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x5a788f(0x111)](_0x5a788f(0xb2),async function(){var _0x746df2=_0x5a788f;await lockNoti(_0x746df2(0x104),'',0x1388);const _0x5e6a48=localStorage[_0x746df2(0xbf)](_0x746df2(0xda));if(_0x5e6a48===null||_0x5e6a48==='')window[_0x746df2(0x105)](_0x746df2(0xd7));else{const _0x441dd7=['state','save','screenshot'];for(const _0x520018 of _0x441dd7){await dpCreateFolder(_0x520018);}let _0x52b810=0x0;for(const _0x1d0c45 of _0x441dd7){const _0xfb96cc=a0_0x277787[_0x746df2(0x106)+(_0x1d0c45[_0x746df2(0xf3)](0x0)['toUpperCase']()+_0x1d0c45[_0x746df2(0xb0)](0x1))]();_0x52b810+=_0xfb96cc[_0x746df2(0xcf)];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x52b810+_0x746df2(0x112)))for(const _0xcb6e15 of _0x441dd7){const _0xbfc5f0=a0_0x277787['list'+(_0xcb6e15[_0x746df2(0xf3)](0x0)[_0x746df2(0xf8)]()+_0xcb6e15[_0x746df2(0xb0)](0x1))]();for(const _0x79dea4 of _0xbfc5f0){const _0x33377e=await a0_0x277787[_0x746df2(0xfe)](_0x746df2(0xc4)+_0xcb6e15+'s/'+_0x79dea4);try{await lockNoti(_0x746df2(0x102),_0x79dea4,0xbb8),await dpUploadFile(_0x79dea4,_0x33377e,_0xcb6e15);}catch(_0x379b22){console['error'](_0x746df2(0xb1)+_0x79dea4+':',_0x379b22);}}}else console[_0x746df2(0xce)](_0x746df2(0xf0));}}),dropboxCloud[_0x5a788f(0x111)](_0x5a788f(0xb2),function(){var _0x50eb60=_0x5a788f;const _0x3f7e00=localStorage[_0x50eb60(0xbf)](_0x50eb60(0xda));_0x3f7e00===null||_0x3f7e00===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x50eb60(0x10b)](_0x50eb60(0xda),''),dropboxRestore[_0x50eb60(0xe0)]['remove'](_0x50eb60(0xbc)),dropboxBackup[_0x50eb60(0xe0)][_0x50eb60(0x101)](_0x50eb60(0xbc)),dropboxCloud[_0x50eb60(0xe0)][_0x50eb60(0x101)](_0x50eb60(0xbc)));}),handleDropboxCallback();});