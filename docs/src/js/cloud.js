function a0_0x1f10(){var _0x1c55b2=['confirm','&token_access_type=','refresh_token=','code','search','Restoring...','remove','downloadFileInCloud','onload','location','No\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','log','status','offline','Do\x20you\x20want\x20to\x20backup\x20','https://api.dropbox.com/oauth2/token','\x20files\x20from\x20Cloud?','json','22484EfjnZi','https://api.dropboxapi.com/oauth2/token','entries','553497jBCmDu','nwb3dnfh09rhs31','active','uId','open','24xFQRpM','state','.tag','Error\x20while\x20refreshing\x20token:','Error\x20creating\x20folder\x20','split','&client_secret=','href','&client_id=','https://www.dropbox.com/oauth2/authorize?client_id=','setItem','addEventListener','&response_type=','Restore\x20canceled\x20by\x20user.','6771330aTKMRz','No\x20files\x20found\x20to\x20restore.','responseText','\x20files\x20in\x20Kabu?','length','file','Backing\x20up...','application/x-www-form-urlencoded','Unable\x20to\x20refresh\x20token','Cloud\x20login\x20required!','Authorization\x20Code:','access_token','POST','Cloud\x20↦\x20Kabu\x20storage\x20◆','application/json','accessToken','classList','uploadFileInCloud','DOMContentLoaded','Upload\x20failed,\x20unknown\x20http\x20status:\x20','exec','/data/','Wait\x20a\x20little\x20bit...','screenshot','10040100aPGzoi','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','knh3uz2mx2hp2eu','Refreshing\x20token...','refreshToken','https://api.dropboxapi.com/2/files/create_folder_v2','stringify','Kabu\x20storage\x20↦\x20Cloud\x20◆','push','396pzdbEi','code=','Bearer\x20','parse','3905145iXtyqi','&redirect_uri=','2441658DtYxpL','alert','filter','Failed\x20to\x20refresh\x20Dropbox\x20token.','name','Download\x20failed,\x20unknown\x20http\x20status:','getItem','application/octet-stream','folder','uid','save','click','Folder\x20created','authorization_code','https://content.dropboxapi.com/2/files/download','1296360XKTDps','replace','https://content.dropboxapi.com/2/files/upload','send','Folder\x20already\x20exists','error'];a0_0x1f10=function(){return _0x1c55b2;};return a0_0x1f10();}var a0_0x1ab38b=a0_0x1981;(function(_0x4efd46,_0x297bcf){var _0x28d5fe=a0_0x1981,_0x129097=_0x4efd46();while(!![]){try{var _0x2dc4fc=parseInt(_0x28d5fe(0x150))/0x1+-parseInt(_0x28d5fe(0x125))/0x2+parseInt(_0x28d5fe(0x11f))/0x3*(parseInt(_0x28d5fe(0x14d))/0x4)+-parseInt(_0x28d5fe(0x134))/0x5+parseInt(_0x28d5fe(0x163))/0x6+-parseInt(_0x28d5fe(0x116))/0x7+parseInt(_0x28d5fe(0x155))/0x8*(parseInt(_0x28d5fe(0x123))/0x9);if(_0x2dc4fc===_0x297bcf)break;else _0x129097['push'](_0x129097['shift']());}catch(_0x3eedb7){_0x129097['push'](_0x129097['shift']());}}}(a0_0x1f10,0xc614a));import*as a0_0x3cc328 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1981(_0x517f1d,_0xd99740){var _0x1f1048=a0_0x1f10();return a0_0x1981=function(_0x198114,_0x199b8f){_0x198114=_0x198114-0x103;var _0x15925e=_0x1f1048[_0x198114];return _0x15925e;},a0_0x1981(_0x517f1d,_0xd99740);}var clientId=a0_0x1ab38b(0x118),clientSecret=a0_0x1ab38b(0x151);function authorizeWithDropbox(){var _0x164090=a0_0x1ab38b,_0x1484bb=window[_0x164090(0x143)][_0x164090(0x15c)]['split']('?')[0x0],_0x45bf94=_0x164090(0x13d),_0x2bc3b7=_0x164090(0x148),_0x33de16=_0x164090(0x15e)+clientId+_0x164090(0x161)+_0x45bf94+_0x164090(0x13b)+_0x2bc3b7+_0x164090(0x124)+encodeURIComponent(_0x1484bb);window[_0x164090(0x143)][_0x164090(0x15c)]=_0x33de16;}function handleDropboxCallback(){var _0xb2dc66=a0_0x1ab38b,_0x58bb57=getUrlParameter('code');_0x58bb57?(getAccessToken(_0x58bb57),console[_0xb2dc66(0x146)](_0xb2dc66(0x108),_0x58bb57)):console[_0xb2dc66(0x146)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x512fd8){var _0x4abe55=a0_0x1ab38b;_0x512fd8=_0x512fd8[_0x4abe55(0x135)](/[\[]/,'\x5c[')[_0x4abe55(0x135)](/[\]]/,'\x5c]');var _0x38580c=new RegExp('[\x5c?&#]'+_0x512fd8+'=([^&#]*)'),_0x5c3126=_0x38580c[_0x4abe55(0x112)](location[_0x4abe55(0x13e)]);return _0x5c3126===null?'':decodeURIComponent(_0x5c3126[0x1][_0x4abe55(0x135)](/\+/g,'\x20'));}function getAccessToken(_0x211873){var _0x10c8e5=a0_0x1ab38b,_0x5009ff=_0x10c8e5(0x132),_0x37b274=window[_0x10c8e5(0x143)][_0x10c8e5(0x15c)][_0x10c8e5(0x15a)]('?')[0x0],_0x199fb0=new XMLHttpRequest();_0x199fb0[_0x10c8e5(0x154)](_0x10c8e5(0x10a),_0x10c8e5(0x14a)),_0x199fb0['setRequestHeader']('Content-Type',_0x10c8e5(0x105)),_0x199fb0[_0x10c8e5(0x142)]=function(){var _0x6be060=_0x10c8e5;if(_0x199fb0[_0x6be060(0x147)]===0xc8){var _0x4954b9=JSON[_0x6be060(0x122)](_0x199fb0[_0x6be060(0x165)]),_0x24c690=_0x4954b9[_0x6be060(0x109)],_0x286a96=_0x4954b9['refresh_token'],_0x26e0c7=_0x4954b9[_0x6be060(0x12e)];localStorage[_0x6be060(0x15f)](_0x6be060(0x10d),_0x24c690),localStorage[_0x6be060(0x15f)]('refreshToken',_0x286a96),localStorage['setItem'](_0x6be060(0x153),_0x26e0c7);}else console[_0x6be060(0x146)](_0x6be060(0x117));},_0x199fb0[_0x10c8e5(0x137)](_0x10c8e5(0x120)+_0x211873+'&grant_type='+_0x5009ff+_0x10c8e5(0x15d)+clientId+_0x10c8e5(0x15b)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x37b274));}export async function dpCreateFolder(_0x23e37f){var _0x398bc0=a0_0x1ab38b;const _0x28e18b=localStorage[_0x398bc0(0x12b)](_0x398bc0(0x153));let _0x41df90=localStorage[_0x398bc0(0x12b)](_0x398bc0(0x10d));const _0x486596='/'+_0x28e18b+'/'+_0x23e37f,_0x21bb05=JSON[_0x398bc0(0x11c)]({'path':_0x486596,'autorename':![]});for(let _0x4fc563=0x0;_0x4fc563<0x2;_0x4fc563++){try{const _0x4de35=await fetch(_0x398bc0(0x11b),{'method':'POST','headers':{'Authorization':_0x398bc0(0x121)+_0x41df90,'Content-Type':_0x398bc0(0x10c)},'body':_0x21bb05});if(_0x4de35[_0x398bc0(0x147)]===0x191){const _0x283a5f=await dpRefreshToken();if(!_0x283a5f)throw new Error(_0x398bc0(0x106));_0x41df90=localStorage['getItem'](_0x398bc0(0x10d));continue;}if(_0x4de35['status']===0x199)return{'message':_0x398bc0(0x138),'path':_0x23e37f};if(!_0x4de35['ok'])throw new Error(_0x398bc0(0x159)+_0x23e37f);const _0x3b91ab=await _0x4de35[_0x398bc0(0x14c)]();return await lockNoti(_0x398bc0(0x131),'',0xbb8),_0x3b91ab;}catch(_0x555dfd){if(_0x4fc563===0x1)throw _0x555dfd;}}return![];}export async function dpRefreshToken(){var _0x2507af=a0_0x1ab38b;if(!localStorage['getItem'](_0x2507af(0x11a)))throw _0x2507af(0x144);try{const _0x4962ad=await fetch(_0x2507af(0x14e),{'method':'POST','headers':{'Content-Type':_0x2507af(0x105)},'body':_0x2507af(0x13c)+localStorage[_0x2507af(0x12b)](_0x2507af(0x11a))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x1f7e49=await _0x4962ad[_0x2507af(0x14c)]();if(!_0x1f7e49['error'])return localStorage[_0x2507af(0x15f)](_0x2507af(0x10d),_0x1f7e49[_0x2507af(0x109)]),await lockNoti(_0x2507af(0x119),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1f7e49['error_description']||_0x2507af(0x128));}catch(_0x155099){console['error'](_0x2507af(0x158),_0x155099);}return![];}export async function dpUploadFile(_0x4bfe6c,_0x36f502,_0x13b4a3){var _0x4d384d=a0_0x1ab38b;const _0x197acd=localStorage['getItem']('uId');var _0x30688a=JSON[_0x4d384d(0x11c)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x197acd+'/'+_0x13b4a3+'/'+_0x4bfe6c}),_0x44c5fe=new Blob([_0x36f502],{'type':'application/octet-stream'});for(var _0x5c3f99=0x0;_0x5c3f99<0x2;_0x5c3f99++){var _0x13ae36=await fetch(_0x4d384d(0x136),{'method':'POST','headers':{'Authorization':_0x4d384d(0x121)+localStorage[_0x4d384d(0x12b)](_0x4d384d(0x10d)),'Dropbox-API-Arg':_0x30688a,'Content-Type':_0x4d384d(0x12c)},'body':_0x44c5fe});if(_0x13ae36[_0x4d384d(0x147)]!=0xc8){if(_0x13ae36[_0x4d384d(0x147)]==0x191){var _0xc590e9=await dpRefreshToken();if(!_0xc590e9)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4d384d(0x111)+_0x13ae36[_0x4d384d(0x147)];}else{var _0x16843c=await _0x13ae36[_0x4d384d(0x14c)]();return console[_0x4d384d(0x146)](_0x4d384d(0x11d),_0x4bfe6c),_0x16843c;}}return![];}export async function dpDownloadFile(_0x38c507,_0x348edf){var _0x5a67a8=a0_0x1ab38b;const _0x2cacbd=localStorage[_0x5a67a8(0x12b)](_0x5a67a8(0x153));var _0x10ecb1=JSON['stringify']({'path':'/'+_0x2cacbd+'/'+_0x348edf+'/'+_0x38c507});for(var _0x3ba59f=0x0;_0x3ba59f<0x2;_0x3ba59f++){var _0x12aa91=await fetch(_0x5a67a8(0x133),{'method':_0x5a67a8(0x10a),'headers':{'Authorization':_0x5a67a8(0x121)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x10ecb1}});if(_0x12aa91[_0x5a67a8(0x147)]!=0xc8){if(_0x12aa91[_0x5a67a8(0x147)]==0x191){var _0x440de0=await dpRefreshToken();if(!_0x440de0)throw _0x5a67a8(0x106);continue;}else throw _0x5a67a8(0x12a)+_0x12aa91[_0x5a67a8(0x147)];}const _0x534756=new File([await _0x12aa91['blob']()],_0x38c507);return console['log'](_0x5a67a8(0x10b),_0x534756[_0x5a67a8(0x129)]),a0_0x3cc328[_0x5a67a8(0x10f)](_0x534756,()=>{}),_0x534756;}return![];}document[a0_0x1ab38b(0x160)](a0_0x1ab38b(0x110),function(){var _0x45bd78=a0_0x1ab38b;dropboxRestore[_0x45bd78(0x160)](_0x45bd78(0x130),async function(){var _0x187e31=_0x45bd78;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x49d999=localStorage[_0x187e31(0x12b)](_0x187e31(0x153)),_0x1b683c=[_0x187e31(0x156),_0x187e31(0x12f),_0x187e31(0x115)];if(!_0x49d999){window[_0x187e31(0x126)](_0x187e31(0x107));return;}let _0x5b0346=[];for(const _0x486e97 of _0x1b683c){let _0x423c3a={'path':'/'+_0x49d999+'/'+_0x486e97};for(let _0x42a8ae=0x0;_0x42a8ae<0x2;_0x42a8ae++){let _0x9d660e=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x187e31(0x10a),'headers':{'Authorization':_0x187e31(0x121)+localStorage[_0x187e31(0x12b)](_0x187e31(0x10d)),'Content-Type':_0x187e31(0x10c)},'body':JSON['stringify'](_0x423c3a)});if(_0x9d660e[_0x187e31(0x147)]===0xc8){let _0x26a995=await _0x9d660e['json'](),_0x438099=_0x26a995[_0x187e31(0x14f)][_0x187e31(0x127)](_0xb02669=>_0xb02669[_0x187e31(0x157)]===_0x187e31(0x103));_0x438099[_0x187e31(0x167)]>0x0&&_0x5b0346[_0x187e31(0x11e)](..._0x438099['map'](_0x1110af=>({'name':_0x1110af['name'],'folder':_0x486e97})));break;}else{if(_0x9d660e['status']===0x191){let _0x58e480=await dpRefreshToken();if(!_0x58e480)throw _0x187e31(0x106);}else{console[_0x187e31(0x139)]('Download\x20failed\x20for\x20'+_0x486e97+',\x20status:\x20'+_0x9d660e['status']);break;}}}}if(_0x5b0346[_0x187e31(0x167)]>0x0){const _0x482cab=_0x187e31(0x145)+_0x5b0346['length']+_0x187e31(0x14b);if(window[_0x187e31(0x13a)](_0x482cab))for(const _0x380363 of _0x5b0346){await lockNoti(_0x187e31(0x13f),_0x380363['name'],0xbb8),await dpDownloadFile(_0x380363[_0x187e31(0x129)],_0x380363[_0x187e31(0x12d)]);}else console[_0x187e31(0x146)]('Restore\x20canceled\x20by\x20user.');}else console[_0x187e31(0x146)](_0x187e31(0x164));}),dropboxBackup[_0x45bd78(0x160)](_0x45bd78(0x130),async function(){var _0x568975=_0x45bd78;await lockNoti(_0x568975(0x114),'',0x1388);const _0x30bd77=localStorage[_0x568975(0x12b)]('uId');if(_0x30bd77===null||_0x30bd77==='')window[_0x568975(0x126)](_0x568975(0x107));else{const _0x5ed02e=[_0x568975(0x156),_0x568975(0x12f),'screenshot'];for(const _0x38da76 of _0x5ed02e){await dpCreateFolder(_0x38da76);}let _0x26bb49=0x0;for(const _0x14928d of _0x5ed02e){const _0x27defe=a0_0x3cc328['listFiles'](_0x14928d+'s');_0x26bb49+=_0x27defe[_0x568975(0x167)];}if(window[_0x568975(0x13a)](_0x568975(0x149)+_0x26bb49+_0x568975(0x166)))for(const _0x352da5 of _0x5ed02e){const _0x547523=a0_0x3cc328['listFiles'](_0x352da5+'s');for(const _0x54190c of _0x547523){const _0x5f273f=await a0_0x3cc328[_0x568975(0x141)](_0x568975(0x113)+_0x352da5+'s/'+_0x54190c);try{await lockNoti(_0x568975(0x104),_0x54190c,0xbb8),await dpUploadFile(_0x54190c,_0x5f273f,_0x352da5);}catch(_0x32789f){console[_0x568975(0x139)]('Failed\x20to\x20upload\x20file\x20'+_0x54190c+':',_0x32789f);}}}else console['log'](_0x568975(0x162));}}),dropboxCloud[_0x45bd78(0x160)](_0x45bd78(0x130),function(){var _0x6a5657=_0x45bd78;const _0x164715=localStorage['getItem']('uId');_0x164715===null||_0x164715===''?authorizeWithDropbox():window[_0x6a5657(0x13a)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x6a5657(0x153),''),dropboxRestore[_0x6a5657(0x10e)][_0x6a5657(0x140)](_0x6a5657(0x152)),dropboxBackup[_0x6a5657(0x10e)][_0x6a5657(0x140)](_0x6a5657(0x152)),dropboxCloud['classList']['remove'](_0x6a5657(0x152)));}),handleDropboxCallback();});