var a0_0x411911=a0_0x52ec;(function(_0xd81b6a,_0x128efb){var _0x3d68b2=a0_0x52ec,_0x34aea2=_0xd81b6a();while(!![]){try{var _0x3421ff=parseInt(_0x3d68b2(0x173))/0x1+parseInt(_0x3d68b2(0x178))/0x2+parseInt(_0x3d68b2(0x195))/0x3*(parseInt(_0x3d68b2(0x1c3))/0x4)+-parseInt(_0x3d68b2(0x1a8))/0x5*(parseInt(_0x3d68b2(0x1c9))/0x6)+parseInt(_0x3d68b2(0x1a4))/0x7+parseInt(_0x3d68b2(0x19b))/0x8+-parseInt(_0x3d68b2(0x199))/0x9;if(_0x3421ff===_0x128efb)break;else _0x34aea2['push'](_0x34aea2['shift']());}catch(_0x4a9956){_0x34aea2['push'](_0x34aea2['shift']());}}}(a0_0x4c31,0x370f2));function a0_0x4c31(){var _0x2a2fb8=['application/x-www-form-urlencoded','search','split','confirm','Content-Type','getItem','alert','classList','Cloud\x20login\x20required!','send','Wait\x20a\x20little\x20bit...','/data/','parse','=([^&#]*)','Failed\x20to\x20upload\x20file\x20','Restore\x20canceled\x20by\x20user.','refresh_token=','accessToken','log','href','Backing\x20up...','active','Cloud\x20↦\x20Kabu\x20storage\x20◆','status','290648RLYeyq','Download\x20failed,\x20unknown\x20http\x20status:','json','Error\x20creating\x20folder\x20','https://content.dropboxapi.com/2/files/download','Unable\x20to\x20refresh\x20token','6OTnwik','refreshToken','save','state','Folder\x20created','uid','https://api.dropbox.com/oauth2/token','.tag','Folder\x20already\x20exists','&grant_type=','addEventListener','setItem','setRequestHeader','404161dTfAii','blob','knh3uz2mx2hp2eu','location','name','818042OgxXrm','remove','Do\x20not\x20receive\x20authorization','Bearer\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','code','screenshot','&redirect_uri=','overwrite','uId','uploadFileInCloud','error','&client_id=','[\x5c?&#]','listFiles','Error\x20while\x20refreshing\x20token:','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/2/files/create_folder_v2','open','&response_type=','\x20files\x20in\x20Kabu?','Refreshing\x20token...','entries','Do\x20you\x20want\x20to\x20backup\x20','Download\x20failed\x20for\x20','application/json','error_description','filter','6vSsAJq','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','POST','length','9431244vkpTKF','application/octet-stream','1771512imlAvQ','&token_access_type=','Kabu\x20storage\x20↦\x20Cloud\x20◆','access_token','https://api.dropboxapi.com/oauth2/token','click','downloadFileInCloud','onload','stringify','1287734tsyvua','Failed\x20to\x20refresh\x20Dropbox\x20token.','No\x20files\x20found\x20to\x20restore.','refresh_token','452345TNOjEc','Do\x20you\x20want\x20to\x20logout?','folder'];a0_0x4c31=function(){return _0x2a2fb8;};return a0_0x4c31();}function a0_0x52ec(_0x2acc01,_0x4f989c){var _0x4c313c=a0_0x4c31();return a0_0x52ec=function(_0x52ec46,_0x404cc9){_0x52ec46=_0x52ec46-0x170;var _0x22818a=_0x4c313c[_0x52ec46];return _0x22818a;},a0_0x52ec(_0x2acc01,_0x4f989c);}import*as a0_0x37d9f8 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x411911(0x175),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x27fb90=a0_0x411911,_0x297b5c=window[_0x27fb90(0x176)][_0x27fb90(0x1be)]['split']('?')[0x0],_0x43a1af=_0x27fb90(0x17e),_0xb2dd08='offline',_0x1f2e39='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x27fb90(0x18c)+_0x43a1af+_0x27fb90(0x19c)+_0xb2dd08+_0x27fb90(0x180)+encodeURIComponent(_0x297b5c);window[_0x27fb90(0x176)][_0x27fb90(0x1be)]=_0x1f2e39;}function handleDropboxCallback(){var _0x7d408b=a0_0x411911,_0x18514d=getUrlParameter(_0x7d408b(0x17e));_0x18514d?(getAccessToken(_0x18514d),console[_0x7d408b(0x1bd)]('Authorization\x20Code:',_0x18514d)):console[_0x7d408b(0x1bd)](_0x7d408b(0x17a));}function getUrlParameter(_0xecaa89){var _0x16c4c9=a0_0x411911;_0xecaa89=_0xecaa89['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x265bb8=new RegExp(_0x16c4c9(0x186)+_0xecaa89+_0x16c4c9(0x1b8)),_0x2d163b=_0x265bb8['exec'](location[_0x16c4c9(0x1ac)]);return _0x2d163b===null?'':decodeURIComponent(_0x2d163b[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x36f302){var _0x2b1d92=a0_0x411911,_0x20ac90='authorization_code',_0x1bcacd=window['location']['href'][_0x2b1d92(0x1ad)]('?')[0x0],_0x4f53bd=new XMLHttpRequest();_0x4f53bd[_0x2b1d92(0x18b)](_0x2b1d92(0x197),_0x2b1d92(0x1cf)),_0x4f53bd[_0x2b1d92(0x172)](_0x2b1d92(0x1af),_0x2b1d92(0x1ab)),_0x4f53bd[_0x2b1d92(0x1a2)]=function(){var _0x17a3bd=_0x2b1d92;if(_0x4f53bd[_0x17a3bd(0x1c2)]===0xc8){var _0x3aee02=JSON[_0x17a3bd(0x1b7)](_0x4f53bd['responseText']),_0x596b12=_0x3aee02[_0x17a3bd(0x19e)],_0x26972f=_0x3aee02[_0x17a3bd(0x1a7)],_0x3f8127=_0x3aee02[_0x17a3bd(0x1ce)];localStorage['setItem'](_0x17a3bd(0x1bc),_0x596b12),localStorage[_0x17a3bd(0x171)](_0x17a3bd(0x1ca),_0x26972f),localStorage['setItem']('uId',_0x3f8127);}else console[_0x17a3bd(0x1bd)](_0x17a3bd(0x196));},_0x4f53bd[_0x2b1d92(0x1b4)]('code='+_0x36f302+_0x2b1d92(0x1d2)+_0x20ac90+_0x2b1d92(0x185)+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x1bcacd));}export async function dpCreateFolder(_0x5a32b4){var _0x4c6b06=a0_0x411911;const _0x1e2efc=localStorage[_0x4c6b06(0x1b0)](_0x4c6b06(0x182));let _0x5414fe=localStorage[_0x4c6b06(0x1b0)](_0x4c6b06(0x1bc));const _0x4a33d5='/'+_0x1e2efc+'/'+_0x5a32b4,_0x5f5431=JSON[_0x4c6b06(0x1a3)]({'path':_0x4a33d5,'autorename':![]});for(let _0x36c379=0x0;_0x36c379<0x2;_0x36c379++){try{const _0x4af5bc=await fetch(_0x4c6b06(0x18a),{'method':_0x4c6b06(0x197),'headers':{'Authorization':_0x4c6b06(0x17b)+_0x5414fe,'Content-Type':_0x4c6b06(0x192)},'body':_0x5f5431});if(_0x4af5bc[_0x4c6b06(0x1c2)]===0x191){const _0x213da8=await dpRefreshToken();if(!_0x213da8)throw new Error(_0x4c6b06(0x1c8));_0x5414fe=localStorage[_0x4c6b06(0x1b0)](_0x4c6b06(0x1bc));continue;}if(_0x4af5bc[_0x4c6b06(0x1c2)]===0x199)return{'message':_0x4c6b06(0x1d1),'path':_0x5a32b4};if(!_0x4af5bc['ok'])throw new Error(_0x4c6b06(0x1c6)+_0x5a32b4);const _0x573068=await _0x4af5bc[_0x4c6b06(0x1c5)]();return await lockNoti(_0x4c6b06(0x1cd),'',0xbb8),_0x573068;}catch(_0x70ba6f){if(_0x36c379===0x1)throw _0x70ba6f;}}return![];}export async function dpRefreshToken(){var _0x3e0aea=a0_0x411911;if(!localStorage[_0x3e0aea(0x1b0)](_0x3e0aea(0x1ca)))throw'No\x20refresh\x20token';try{const _0xe9c279=await fetch(_0x3e0aea(0x19f),{'method':_0x3e0aea(0x197),'headers':{'Content-Type':_0x3e0aea(0x1ab)},'body':_0x3e0aea(0x1bb)+localStorage['getItem']('refreshToken')+_0x3e0aea(0x17d)}),_0xdf8c8f=await _0xe9c279[_0x3e0aea(0x1c5)]();if(!_0xdf8c8f[_0x3e0aea(0x184)])return localStorage[_0x3e0aea(0x171)]('accessToken',_0xdf8c8f[_0x3e0aea(0x19e)]),await lockNoti(_0x3e0aea(0x18e),'',0xbb8),await delay(0x3e8),!![];else alert(_0xdf8c8f[_0x3e0aea(0x193)]||_0x3e0aea(0x1a5));}catch(_0x109aa1){console['error'](_0x3e0aea(0x188),_0x109aa1);}return![];}export async function dpUploadFile(_0x3fdd1d,_0x24a0f5,_0x531b0a){var _0x2419d1=a0_0x411911;const _0x212038=localStorage[_0x2419d1(0x1b0)]('uId');var _0x26e421=JSON[_0x2419d1(0x1a3)]({'autorename':!![],'mode':_0x2419d1(0x181),'mute':!![],'strict_conflict':![],'path':'/'+_0x212038+'/'+_0x531b0a+'/'+_0x3fdd1d}),_0x2b424d=new Blob([_0x24a0f5],{'type':_0x2419d1(0x19a)});for(var _0x52aa58=0x0;_0x52aa58<0x2;_0x52aa58++){var _0x4affbf=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x2419d1(0x197),'headers':{'Authorization':_0x2419d1(0x17b)+localStorage[_0x2419d1(0x1b0)](_0x2419d1(0x1bc)),'Dropbox-API-Arg':_0x26e421,'Content-Type':_0x2419d1(0x19a)},'body':_0x2b424d});if(_0x4affbf[_0x2419d1(0x1c2)]!=0xc8){if(_0x4affbf[_0x2419d1(0x1c2)]==0x191){var _0x509d46=await dpRefreshToken();if(!_0x509d46)throw _0x2419d1(0x1c8);continue;}else throw _0x2419d1(0x17c)+_0x4affbf[_0x2419d1(0x1c2)];}else{var _0x24c8a8=await _0x4affbf[_0x2419d1(0x1c5)]();return console['log'](_0x2419d1(0x19d),_0x3fdd1d),_0x24c8a8;}}return![];}export async function dpDownloadFile(_0xa7634c,_0x22b15f){var _0x42bc2d=a0_0x411911;const _0x212369=localStorage[_0x42bc2d(0x1b0)](_0x42bc2d(0x182));var _0x5e8583=JSON[_0x42bc2d(0x1a3)]({'path':'/'+_0x212369+'/'+_0x22b15f+'/'+_0xa7634c});for(var _0x4d9a1d=0x0;_0x4d9a1d<0x2;_0x4d9a1d++){var _0x186ca3=await fetch(_0x42bc2d(0x1c7),{'method':'POST','headers':{'Authorization':_0x42bc2d(0x17b)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x5e8583}});if(_0x186ca3[_0x42bc2d(0x1c2)]!=0xc8){if(_0x186ca3[_0x42bc2d(0x1c2)]==0x191){var _0x2d5774=await dpRefreshToken();if(!_0x2d5774)throw _0x42bc2d(0x1c8);continue;}else throw _0x42bc2d(0x1c4)+_0x186ca3[_0x42bc2d(0x1c2)];}const _0x36207e=new File([await _0x186ca3[_0x42bc2d(0x174)]()],_0xa7634c);return console[_0x42bc2d(0x1bd)](_0x42bc2d(0x1c1),_0x36207e[_0x42bc2d(0x177)]),a0_0x37d9f8[_0x42bc2d(0x183)](_0x36207e,()=>{}),_0x36207e;}return![];}document[a0_0x411911(0x170)]('DOMContentLoaded',function(){var _0x8033f5=a0_0x411911;dropboxRestore[_0x8033f5(0x170)]('click',async function(){var _0x3a5a30=_0x8033f5;await lockNoti(_0x3a5a30(0x1b5),'',0x1388);const _0x8f34a4=localStorage[_0x3a5a30(0x1b0)](_0x3a5a30(0x182)),_0x3ffbe7=[_0x3a5a30(0x1cc),_0x3a5a30(0x1cb),_0x3a5a30(0x17f)];if(!_0x8f34a4){window[_0x3a5a30(0x1b1)](_0x3a5a30(0x1b3));return;}let _0x2a01e4=[];for(const _0x5035f1 of _0x3ffbe7){let _0x630c92={'path':'/'+_0x8f34a4+'/'+_0x5035f1};for(let _0x323c7d=0x0;_0x323c7d<0x2;_0x323c7d++){let _0x5b36eb=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x3a5a30(0x17b)+localStorage[_0x3a5a30(0x1b0)](_0x3a5a30(0x1bc)),'Content-Type':_0x3a5a30(0x192)},'body':JSON[_0x3a5a30(0x1a3)](_0x630c92)});if(_0x5b36eb[_0x3a5a30(0x1c2)]===0xc8){let _0x2c76a0=await _0x5b36eb[_0x3a5a30(0x1c5)](),_0x2d9f0f=_0x2c76a0[_0x3a5a30(0x18f)][_0x3a5a30(0x194)](_0x1ab95f=>_0x1ab95f[_0x3a5a30(0x1d0)]==='file');_0x2d9f0f[_0x3a5a30(0x198)]>0x0&&_0x2a01e4['push'](..._0x2d9f0f['map'](_0x4a5d11=>({'name':_0x4a5d11[_0x3a5a30(0x177)],'folder':_0x5035f1})));break;}else{if(_0x5b36eb[_0x3a5a30(0x1c2)]===0x191){let _0x4a30ae=await dpRefreshToken();if(!_0x4a30ae)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x3a5a30(0x184)](_0x3a5a30(0x191)+_0x5035f1+',\x20status:\x20'+_0x5b36eb[_0x3a5a30(0x1c2)]);break;}}}}if(_0x2a01e4[_0x3a5a30(0x198)]>0x0){const _0x3c86e2='Do\x20you\x20want\x20to\x20restore\x20'+_0x2a01e4[_0x3a5a30(0x198)]+_0x3a5a30(0x189);if(window[_0x3a5a30(0x1ae)](_0x3c86e2))for(const _0x2c63cb of _0x2a01e4){await lockNoti('Restoring...',_0x2c63cb['name'],0xbb8),await dpDownloadFile(_0x2c63cb[_0x3a5a30(0x177)],_0x2c63cb[_0x3a5a30(0x1aa)]);}else console[_0x3a5a30(0x1bd)](_0x3a5a30(0x1ba));}else console['log'](_0x3a5a30(0x1a6));}),dropboxBackup['addEventListener'](_0x8033f5(0x1a0),async function(){var _0x4488d5=_0x8033f5;await lockNoti(_0x4488d5(0x1b5),'',0x1388);const _0x310da8=localStorage[_0x4488d5(0x1b0)](_0x4488d5(0x182));if(_0x310da8===null||_0x310da8==='')window[_0x4488d5(0x1b1)](_0x4488d5(0x1b3));else{const _0x561265=['state',_0x4488d5(0x1cb),_0x4488d5(0x17f)];for(const _0x33783e of _0x561265){await dpCreateFolder(_0x33783e);}let _0x565680=0x0;for(const _0x1edefa of _0x561265){const _0x29ec87=a0_0x37d9f8[_0x4488d5(0x187)](_0x1edefa+'s');_0x565680+=_0x29ec87[_0x4488d5(0x198)];}if(window[_0x4488d5(0x1ae)](_0x4488d5(0x190)+_0x565680+_0x4488d5(0x18d)))for(const _0x4389ba of _0x561265){const _0x52ce49=a0_0x37d9f8[_0x4488d5(0x187)](_0x4389ba+'s');for(const _0x159b9e of _0x52ce49){const _0x4fab42=await a0_0x37d9f8[_0x4488d5(0x1a1)](_0x4488d5(0x1b6)+_0x4389ba+'s/'+_0x159b9e);try{await lockNoti(_0x4488d5(0x1bf),_0x159b9e,0xbb8),await dpUploadFile(_0x159b9e,_0x4fab42,_0x4389ba);}catch(_0x76537f){console[_0x4488d5(0x184)](_0x4488d5(0x1b9)+_0x159b9e+':',_0x76537f);}}}else console['log'](_0x4488d5(0x1ba));}}),dropboxCloud[_0x8033f5(0x170)](_0x8033f5(0x1a0),function(){var _0x547e37=_0x8033f5;const _0x34cb8a=localStorage[_0x547e37(0x1b0)](_0x547e37(0x182));_0x34cb8a===null||_0x34cb8a===''?authorizeWithDropbox():window[_0x547e37(0x1ae)](_0x547e37(0x1a9))&&(localStorage[_0x547e37(0x171)]('uId',''),dropboxRestore[_0x547e37(0x1b2)]['remove'](_0x547e37(0x1c0)),dropboxBackup[_0x547e37(0x1b2)][_0x547e37(0x179)](_0x547e37(0x1c0)),dropboxCloud[_0x547e37(0x1b2)][_0x547e37(0x179)]('active'));}),handleDropboxCallback();});