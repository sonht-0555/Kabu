var a0_0x407cf5=a0_0x1d30;(function(_0x843ab0,_0x119f48){var _0x18c895=a0_0x1d30,_0x1f70d5=_0x843ab0();while(!![]){try{var _0x29e703=parseInt(_0x18c895(0x81))/0x1*(parseInt(_0x18c895(0xc9))/0x2)+-parseInt(_0x18c895(0xbd))/0x3+parseInt(_0x18c895(0xb4))/0x4+-parseInt(_0x18c895(0x88))/0x5+-parseInt(_0x18c895(0xa4))/0x6*(parseInt(_0x18c895(0x95))/0x7)+-parseInt(_0x18c895(0x79))/0x8+parseInt(_0x18c895(0x8c))/0x9;if(_0x29e703===_0x119f48)break;else _0x1f70d5['push'](_0x1f70d5['shift']());}catch(_0x491d86){_0x1f70d5['push'](_0x1f70d5['shift']());}}}(a0_0x460a,0xe4805));import*as a0_0x284b70 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret='nwb3dnfh09rhs31';function a0_0x460a(){var _0x196cfa=['Cloud\x20login\x20required!','Folder\x20already\x20exists','entries','&redirect_uri=','accessToken','Wait\x20a\x20little\x20bit...','=([^&#]*)','uid','parse','&response_type=','file','state','authorization_code','refreshToken','getItem','code','classList','Kabu\x20storage\x20↦\x20Cloud\x20◆','Restoring...','3700000gOdBpO','overwrite','&grant_type=','href','application/json','No\x20refresh\x20token','Download\x20failed,\x20unknown\x20http\x20status:','log','6463LFqaAd','error_description','&client_id=',',\x20status:\x20','Do\x20you\x20want\x20to\x20backup\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://api.dropboxapi.com/oauth2/token','578500RGlpZB','Authorization\x20Code:','filter','&client_secret=','4706604OLJUyR','location','blob','downloadFileInCloud','onload','Error\x20creating\x20folder\x20','https://content.dropboxapi.com/2/files/download','https://api.dropboxapi.com/2/files/list_folder','addEventListener','819qtJFtw','save','confirm','name','Do\x20not\x20receive\x20authorization','split','&token_access_type=','application/x-www-form-urlencoded','application/octet-stream','uId','Cloud\x20↦\x20Kabu\x20storage\x20◆','Error\x20while\x20refreshing\x20token:','refresh_token=','uploadFileInCloud','map','34578cHNrOt','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','listFiles','Folder\x20created','Do\x20you\x20want\x20to\x20restore\x20','responseText','https://www.dropbox.com/oauth2/authorize?client_id=','[\x5c?&#]','alert','Download\x20failed\x20for\x20','active','access_token','click','setItem','https://content.dropboxapi.com/2/files/upload','stringify','7239676hEjOIe','https://api.dropboxapi.com/2/files/create_folder_v2','https://api.dropbox.com/oauth2/token','POST','replace','Restore\x20canceled\x20by\x20user.','screenshot','Unable\x20to\x20refresh\x20token','.tag','549723xVowhE','Failed\x20to\x20upload\x20file\x20','status','length','Refreshing\x20token...','error','offline','json','Bearer\x20','exec','Content-Type','remove','12ObFKUc'];a0_0x460a=function(){return _0x196cfa;};return a0_0x460a();}function authorizeWithDropbox(){var _0x3bbaec=a0_0x1d30,_0x44ed3b=window[_0x3bbaec(0x8d)][_0x3bbaec(0x7c)]['split']('?')[0x0],_0x581c60='code',_0x19257f=_0x3bbaec(0xc3),_0x252877=_0x3bbaec(0xaa)+clientId+_0x3bbaec(0x6f)+_0x581c60+_0x3bbaec(0x9b)+_0x19257f+_0x3bbaec(0xcd)+encodeURIComponent(_0x44ed3b);window[_0x3bbaec(0x8d)][_0x3bbaec(0x7c)]=_0x252877;}function handleDropboxCallback(){var _0x4e9db8=a0_0x1d30,_0x23e9e0=getUrlParameter(_0x4e9db8(0x75));_0x23e9e0?(getAccessToken(_0x23e9e0),console['log'](_0x4e9db8(0x89),_0x23e9e0)):console['log'](_0x4e9db8(0x99));}function getUrlParameter(_0x3e2f57){var _0x46069b=a0_0x1d30;_0x3e2f57=_0x3e2f57[_0x46069b(0xb8)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x3746de=new RegExp(_0x46069b(0xab)+_0x3e2f57+_0x46069b(0xd0)),_0x18a6a2=_0x3746de[_0x46069b(0xc6)](location['search']);return _0x18a6a2===null?'':decodeURIComponent(_0x18a6a2[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x347a3e){var _0x288de3=a0_0x1d30,_0x3b253a=_0x288de3(0x72),_0x11b34d=window[_0x288de3(0x8d)]['href'][_0x288de3(0x9a)]('?')[0x0],_0x2f6409=new XMLHttpRequest();_0x2f6409['open'](_0x288de3(0xb7),_0x288de3(0xb6)),_0x2f6409['setRequestHeader'](_0x288de3(0xc7),_0x288de3(0x9c)),_0x2f6409[_0x288de3(0x90)]=function(){var _0x2d15ff=_0x288de3;if(_0x2f6409[_0x2d15ff(0xbf)]===0xc8){var _0x1758d4=JSON[_0x2d15ff(0x6e)](_0x2f6409[_0x2d15ff(0xa9)]),_0x3beff5=_0x1758d4['access_token'],_0x579bd5=_0x1758d4['refresh_token'],_0x2fca2d=_0x1758d4[_0x2d15ff(0xd1)];localStorage[_0x2d15ff(0xb1)](_0x2d15ff(0xce),_0x3beff5),localStorage['setItem'](_0x2d15ff(0x73),_0x579bd5),localStorage['setItem'](_0x2d15ff(0x9e),_0x2fca2d);}else console[_0x2d15ff(0x80)](_0x2d15ff(0xa5));},_0x2f6409['send']('code='+_0x347a3e+_0x288de3(0x7b)+_0x3b253a+_0x288de3(0x83)+clientId+_0x288de3(0x8b)+clientSecret+_0x288de3(0xcd)+encodeURIComponent(_0x11b34d));}function a0_0x1d30(_0x6815a8,_0x2806ce){var _0x460af7=a0_0x460a();return a0_0x1d30=function(_0x1d306b,_0x43bd3d){_0x1d306b=_0x1d306b-0x6e;var _0x26559f=_0x460af7[_0x1d306b];return _0x26559f;},a0_0x1d30(_0x6815a8,_0x2806ce);}export async function dpCreateFolder(_0x5e752e){var _0x133096=a0_0x1d30;const _0x414fbb=localStorage[_0x133096(0x74)](_0x133096(0x9e));let _0x5c5b61=localStorage[_0x133096(0x74)](_0x133096(0xce));const _0x330c66='/'+_0x414fbb+'/'+_0x5e752e,_0x1bd708=JSON[_0x133096(0xb3)]({'path':_0x330c66,'autorename':![]});for(let _0x19b345=0x0;_0x19b345<0x2;_0x19b345++){try{const _0x5930fa=await fetch(_0x133096(0xb5),{'method':_0x133096(0xb7),'headers':{'Authorization':'Bearer\x20'+_0x5c5b61,'Content-Type':_0x133096(0x7d)},'body':_0x1bd708});if(_0x5930fa['status']===0x191){const _0x455303=await dpRefreshToken();if(!_0x455303)throw new Error(_0x133096(0xbb));_0x5c5b61=localStorage['getItem'](_0x133096(0xce));continue;}if(_0x5930fa[_0x133096(0xbf)]===0x199)return{'message':_0x133096(0xcb),'path':_0x5e752e};if(!_0x5930fa['ok'])throw new Error(_0x133096(0x91)+_0x5e752e);const _0x38cdb9=await _0x5930fa['json']();return await lockNoti(_0x133096(0xa7),'',0xbb8),_0x38cdb9;}catch(_0x9f5628){if(_0x19b345===0x1)throw _0x9f5628;}}return![];}export async function dpRefreshToken(){var _0x5c115e=a0_0x1d30;if(!localStorage['getItem'](_0x5c115e(0x73)))throw _0x5c115e(0x7e);try{const _0x20cac0=await fetch(_0x5c115e(0x87),{'method':_0x5c115e(0xb7),'headers':{'Content-Type':_0x5c115e(0x9c)},'body':_0x5c115e(0xa1)+localStorage[_0x5c115e(0x74)](_0x5c115e(0x73))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x548b0c=await _0x20cac0[_0x5c115e(0xc4)]();if(!_0x548b0c[_0x5c115e(0xc2)])return localStorage[_0x5c115e(0xb1)]('accessToken',_0x548b0c[_0x5c115e(0xaf)]),await lockNoti(_0x5c115e(0xc1),'',0xbb8),await delay(0x3e8),!![];else alert(_0x548b0c[_0x5c115e(0x82)]||_0x5c115e(0x86));}catch(_0x3d7aa2){console[_0x5c115e(0xc2)](_0x5c115e(0xa0),_0x3d7aa2);}return![];}export async function dpUploadFile(_0x5cbee8,_0x356b51,_0x479cf6){var _0x37f4bf=a0_0x1d30;const _0x2a5745=localStorage['getItem'](_0x37f4bf(0x9e));var _0x297f77=JSON[_0x37f4bf(0xb3)]({'autorename':!![],'mode':_0x37f4bf(0x7a),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a5745+'/'+_0x479cf6+'/'+_0x5cbee8}),_0x315bb6=new Blob([_0x356b51],{'type':_0x37f4bf(0x9d)});for(var _0x365b3e=0x0;_0x365b3e<0x2;_0x365b3e++){var _0x46f414=await fetch(_0x37f4bf(0xb2),{'method':_0x37f4bf(0xb7),'headers':{'Authorization':_0x37f4bf(0xc5)+localStorage[_0x37f4bf(0x74)](_0x37f4bf(0xce)),'Dropbox-API-Arg':_0x297f77,'Content-Type':_0x37f4bf(0x9d)},'body':_0x315bb6});if(_0x46f414[_0x37f4bf(0xbf)]!=0xc8){if(_0x46f414[_0x37f4bf(0xbf)]==0x191){var _0x351825=await dpRefreshToken();if(!_0x351825)throw _0x37f4bf(0xbb);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x46f414[_0x37f4bf(0xbf)];}else{var _0x9b5f7a=await _0x46f414[_0x37f4bf(0xc4)]();return console['log'](_0x37f4bf(0x77),_0x5cbee8),_0x9b5f7a;}}return![];}export async function dpDownloadFile(_0x1071e6,_0x366782){var _0x133536=a0_0x1d30;const _0x474f86=localStorage['getItem'](_0x133536(0x9e));var _0x167d2c=JSON['stringify']({'path':'/'+_0x474f86+'/'+_0x366782+'/'+_0x1071e6});for(var _0x5a65bb=0x0;_0x5a65bb<0x2;_0x5a65bb++){var _0x2725ef=await fetch(_0x133536(0x92),{'method':'POST','headers':{'Authorization':_0x133536(0xc5)+localStorage[_0x133536(0x74)](_0x133536(0xce)),'Dropbox-API-Arg':_0x167d2c}});if(_0x2725ef[_0x133536(0xbf)]!=0xc8){if(_0x2725ef['status']==0x191){var _0x1b79d0=await dpRefreshToken();if(!_0x1b79d0)throw _0x133536(0xbb);continue;}else throw _0x133536(0x7f)+_0x2725ef[_0x133536(0xbf)];}const _0xef1554=new File([await _0x2725ef[_0x133536(0x8e)]()],_0x1071e6);return console[_0x133536(0x80)](_0x133536(0x9f),_0xef1554[_0x133536(0x98)]),a0_0x284b70[_0x133536(0xa2)](_0xef1554,()=>{}),_0xef1554;}return![];}document[a0_0x407cf5(0x94)]('DOMContentLoaded',function(){var _0x54ffa7=a0_0x407cf5;dropboxRestore[_0x54ffa7(0x94)](_0x54ffa7(0xb0),async function(){var _0x2f4e26=_0x54ffa7;await lockNoti(_0x2f4e26(0xcf),'',0x1388);const _0x5cfc46=localStorage[_0x2f4e26(0x74)](_0x2f4e26(0x9e)),_0x4408af=[_0x2f4e26(0x71),_0x2f4e26(0x96),_0x2f4e26(0xba)];if(!_0x5cfc46){window['alert'](_0x2f4e26(0xca));return;}let _0x2d7408=[];for(const _0x544e16 of _0x4408af){let _0xb59a8f={'path':'/'+_0x5cfc46+'/'+_0x544e16};for(let _0x4d83df=0x0;_0x4d83df<0x2;_0x4d83df++){let _0x55ef53=await fetch(_0x2f4e26(0x93),{'method':_0x2f4e26(0xb7),'headers':{'Authorization':_0x2f4e26(0xc5)+localStorage[_0x2f4e26(0x74)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x2f4e26(0xb3)](_0xb59a8f)});if(_0x55ef53[_0x2f4e26(0xbf)]===0xc8){let _0x345fa5=await _0x55ef53['json'](),_0x3dc4fa=_0x345fa5[_0x2f4e26(0xcc)][_0x2f4e26(0x8a)](_0x5ba834=>_0x5ba834[_0x2f4e26(0xbc)]===_0x2f4e26(0x70));_0x3dc4fa[_0x2f4e26(0xc0)]>0x0&&_0x2d7408['push'](..._0x3dc4fa[_0x2f4e26(0xa3)](_0x19215b=>({'name':_0x19215b[_0x2f4e26(0x98)],'folder':_0x544e16})));break;}else{if(_0x55ef53[_0x2f4e26(0xbf)]===0x191){let _0x30fc1a=await dpRefreshToken();if(!_0x30fc1a)throw _0x2f4e26(0xbb);}else{console[_0x2f4e26(0xc2)](_0x2f4e26(0xad)+_0x544e16+_0x2f4e26(0x84)+_0x55ef53['status']);break;}}}}if(_0x2d7408[_0x2f4e26(0xc0)]>0x0){const _0x3a47fc=_0x2f4e26(0xa8)+_0x2d7408[_0x2f4e26(0xc0)]+'\x20files\x20from\x20Cloud?';if(window[_0x2f4e26(0x97)](_0x3a47fc))for(const _0x528cc1 of _0x2d7408){await lockNoti(_0x2f4e26(0x78),_0x528cc1[_0x2f4e26(0x98)],0xbb8),await dpDownloadFile(_0x528cc1['name'],_0x528cc1['folder']);}else console['log'](_0x2f4e26(0xb9));}else console[_0x2f4e26(0x80)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x54ffa7(0x94)](_0x54ffa7(0xb0),async function(){var _0x22ee64=_0x54ffa7;await lockNoti(_0x22ee64(0xcf),'',0x1388);const _0x553936=localStorage['getItem'](_0x22ee64(0x9e));if(_0x553936===null||_0x553936==='')window[_0x22ee64(0xac)]('Cloud\x20login\x20required!');else{const _0x3c9e51=['state',_0x22ee64(0x96),_0x22ee64(0xba)];for(const _0x5d1e51 of _0x3c9e51){await dpCreateFolder(_0x5d1e51);}let _0x486428=0x0;for(const _0x5aa17a of _0x3c9e51){const _0x489809=a0_0x284b70[_0x22ee64(0xa6)](_0x5aa17a+'s');_0x486428+=_0x489809[_0x22ee64(0xc0)];}if(window[_0x22ee64(0x97)](_0x22ee64(0x85)+_0x486428+'\x20files\x20in\x20Kabu?'))for(const _0x4d98ca of _0x3c9e51){const _0x55fdad=a0_0x284b70['listFiles'](_0x4d98ca+'s');for(const _0x305852 of _0x55fdad){const _0x3a9c2a=await a0_0x284b70[_0x22ee64(0x8f)]('/data/'+_0x4d98ca+'s/'+_0x305852);try{await lockNoti('Backing\x20up...',_0x305852,0xbb8),await dpUploadFile(_0x305852,_0x3a9c2a,_0x4d98ca);}catch(_0x13abf2){console[_0x22ee64(0xc2)](_0x22ee64(0xbe)+_0x305852+':',_0x13abf2);}}}else console[_0x22ee64(0x80)](_0x22ee64(0xb9));}}),dropboxCloud[_0x54ffa7(0x94)]('click',function(){var _0x1fec27=_0x54ffa7;const _0x5e6bf4=localStorage[_0x1fec27(0x74)](_0x1fec27(0x9e));_0x5e6bf4===null||_0x5e6bf4===''?authorizeWithDropbox():window[_0x1fec27(0x97)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x1fec27(0xb1)](_0x1fec27(0x9e),''),dropboxRestore[_0x1fec27(0x76)][_0x1fec27(0xc8)]('active'),dropboxBackup[_0x1fec27(0x76)]['remove'](_0x1fec27(0xae)),dropboxCloud[_0x1fec27(0x76)][_0x1fec27(0xc8)](_0x1fec27(0xae)));}),handleDropboxCallback();});