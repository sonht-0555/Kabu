var a0_0x1d6ee3=a0_0x19d0;(function(_0x18ad2a,_0x3d61ed){var _0x2f65cf=a0_0x19d0,_0x477718=_0x18ad2a();while(!![]){try{var _0x3a79ac=parseInt(_0x2f65cf(0xf4))/0x1+-parseInt(_0x2f65cf(0xec))/0x2*(-parseInt(_0x2f65cf(0x13e))/0x3)+parseInt(_0x2f65cf(0x133))/0x4+parseInt(_0x2f65cf(0xff))/0x5*(parseInt(_0x2f65cf(0xe1))/0x6)+-parseInt(_0x2f65cf(0x130))/0x7*(parseInt(_0x2f65cf(0x137))/0x8)+parseInt(_0x2f65cf(0x139))/0x9*(parseInt(_0x2f65cf(0x11b))/0xa)+-parseInt(_0x2f65cf(0x106))/0xb;if(_0x3a79ac===_0x3d61ed)break;else _0x477718['push'](_0x477718['shift']());}catch(_0x6da91a){_0x477718['push'](_0x477718['shift']());}}}(a0_0x5edd,0x32289));import*as a0_0x415703 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1d6ee3(0x142),clientSecret=a0_0x1d6ee3(0x12b);function authorizeWithDropbox(){var _0x275f71=a0_0x1d6ee3,_0x43869a=window[_0x275f71(0x101)][_0x275f71(0x134)][_0x275f71(0x124)]('?')[0x0],_0x49a954=_0x275f71(0xfb),_0x545938=_0x275f71(0x121),_0x1f62e5=_0x275f71(0xf7)+clientId+_0x275f71(0x118)+_0x49a954+_0x275f71(0x13b)+_0x545938+_0x275f71(0x141)+encodeURIComponent(_0x43869a);window[_0x275f71(0x101)][_0x275f71(0x134)]=_0x1f62e5;}function handleDropboxCallback(){var _0x1d296f=a0_0x1d6ee3,_0x3baaa1=getUrlParameter('code');_0x3baaa1?(getAccessToken(_0x3baaa1),console['log'](_0x1d296f(0x11c),_0x3baaa1)):console['log'](_0x1d296f(0x12a));}function a0_0x5edd(){var _0x23134b=['Folder\x20created','No\x20files\x20found\x20to\x20restore.','\x20files\x20from\x20Cloud?','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','addEventListener','application/octet-stream','uId','log','name','Do\x20you\x20want\x20to\x20backup\x20','toUpperCase','classList','https://content.dropboxapi.com/2/files/download','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&response_type=','confirm','click','3986770SnQfnY','Authorization\x20Code:','No\x20refresh\x20token','/data/','Bearer\x20','alert','offline','[\x5c?&#]','send','split','filter','.tag','Cloud\x20login\x20required!','https://api.dropboxapi.com/2/files/list_folder','file','Do\x20not\x20receive\x20authorization','nwb3dnfh09rhs31','blob','https://content.dropboxapi.com/2/files/upload','Error\x20while\x20refreshing\x20token:','list','21357WGlhnN','getItem','remove','629804NttRAp','href','setItem','https://api.dropbox.com/oauth2/token','24sjxfey','length','9PVOoVz','Unable\x20to\x20refresh\x20token','&token_access_type=','refreshToken','Folder\x20already\x20exists','37548sGbOoU','Download\x20failed\x20for\x20','https://api.dropboxapi.com/oauth2/token','&redirect_uri=','knh3uz2mx2hp2eu','Cloud\x20↦\x20Kabu\x20storage\x20◆','POST','screenshot','Restore\x20canceled\x20by\x20user.','refresh_token=','entries','error','overwrite','12BiQwCI','state','Backing\x20up...','uploadFileInCloud','parse','slice','push','code=','replace','DOMContentLoaded','&client_secret=','56oFumva','map','application/json','Failed\x20to\x20refresh\x20Dropbox\x20token.','&client_id=','stringify','uid','save','202891lVZMvO','Download\x20failed,\x20unknown\x20http\x20status:','charAt','https://www.dropbox.com/oauth2/authorize?client_id=','Failed\x20to\x20upload\x20file\x20','status','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','code','Error\x20creating\x20folder\x20','active','accessToken','634150vYxlnb','https://api.dropboxapi.com/2/files/create_folder_v2','location','FSSync','access_token','&grant_type=','Wait\x20a\x20little\x20bit...','12633775NFjBDK','json','=([^&#]*)','Content-Type'];a0_0x5edd=function(){return _0x23134b;};return a0_0x5edd();}function getUrlParameter(_0x3a20e7){var _0x19e2dd=a0_0x1d6ee3;_0x3a20e7=_0x3a20e7[_0x19e2dd(0xe9)](/[\[]/,'\x5c[')[_0x19e2dd(0xe9)](/[\]]/,'\x5c]');var _0x366e09=new RegExp(_0x19e2dd(0x122)+_0x3a20e7+_0x19e2dd(0x108)),_0x97d753=_0x366e09['exec'](location['search']);return _0x97d753===null?'':decodeURIComponent(_0x97d753[0x1][_0x19e2dd(0xe9)](/\+/g,'\x20'));}function getAccessToken(_0x569b5d){var _0x50a6dd=a0_0x1d6ee3,_0x2b1640='authorization_code',_0x5aec1e=window[_0x50a6dd(0x101)][_0x50a6dd(0x134)]['split']('?')[0x0],_0x43ed9e=new XMLHttpRequest();_0x43ed9e['open'](_0x50a6dd(0xda),_0x50a6dd(0x136)),_0x43ed9e['setRequestHeader'](_0x50a6dd(0x109),'application/x-www-form-urlencoded'),_0x43ed9e['onload']=function(){var _0x47a691=_0x50a6dd;if(_0x43ed9e[_0x47a691(0xf9)]===0xc8){var _0x13fbcd=JSON[_0x47a691(0xe5)](_0x43ed9e['responseText']),_0x439c70=_0x13fbcd[_0x47a691(0x103)],_0x3cabf4=_0x13fbcd['refresh_token'],_0x892efb=_0x13fbcd[_0x47a691(0xf2)];localStorage[_0x47a691(0x135)](_0x47a691(0xfe),_0x439c70),localStorage[_0x47a691(0x135)](_0x47a691(0x13c),_0x3cabf4),localStorage[_0x47a691(0x135)]('uId',_0x892efb);}else console[_0x47a691(0x111)](_0x47a691(0xfa));},_0x43ed9e[_0x50a6dd(0x123)](_0x50a6dd(0xe8)+_0x569b5d+_0x50a6dd(0x104)+_0x2b1640+_0x50a6dd(0xf0)+clientId+_0x50a6dd(0xeb)+clientSecret+_0x50a6dd(0x141)+encodeURIComponent(_0x5aec1e));}export async function dpCreateFolder(_0x6482a3){var _0x2a938d=a0_0x1d6ee3;const _0xdf4f5f=localStorage[_0x2a938d(0x131)](_0x2a938d(0x110));let _0x1a9dd7=localStorage[_0x2a938d(0x131)]('accessToken');const _0x5d43e7='/'+_0xdf4f5f+'/'+_0x6482a3,_0x8e84a6=JSON['stringify']({'path':_0x5d43e7,'autorename':![]});for(let _0x3816ee=0x0;_0x3816ee<0x2;_0x3816ee++){try{const _0x3d20fa=await fetch(_0x2a938d(0x100),{'method':_0x2a938d(0xda),'headers':{'Authorization':_0x2a938d(0x11f)+_0x1a9dd7,'Content-Type':'application/json'},'body':_0x8e84a6});if(_0x3d20fa[_0x2a938d(0xf9)]===0x191){const _0x290af5=await dpRefreshToken();if(!_0x290af5)throw new Error(_0x2a938d(0x13a));_0x1a9dd7=localStorage[_0x2a938d(0x131)]('accessToken');continue;}if(_0x3d20fa[_0x2a938d(0xf9)]===0x199)return{'message':_0x2a938d(0x13d),'path':_0x6482a3};if(!_0x3d20fa['ok'])throw new Error(_0x2a938d(0xfc)+_0x6482a3);const _0x357c47=await _0x3d20fa[_0x2a938d(0x107)]();return await lockNoti(_0x2a938d(0x10a),'',0xbb8),_0x357c47;}catch(_0x4cf923){if(_0x3816ee===0x1)throw _0x4cf923;}}return![];}export async function dpRefreshToken(){var _0x3b044e=a0_0x1d6ee3;if(!localStorage[_0x3b044e(0x131)]('refreshToken'))throw _0x3b044e(0x11d);try{const _0x50008c=await fetch(_0x3b044e(0x140),{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x3b044e(0xdd)+localStorage[_0x3b044e(0x131)](_0x3b044e(0x13c))+_0x3b044e(0x10d)}),_0x3bcb4a=await _0x50008c[_0x3b044e(0x107)]();if(!_0x3bcb4a[_0x3b044e(0xdf)])return localStorage[_0x3b044e(0x135)](_0x3b044e(0xfe),_0x3bcb4a[_0x3b044e(0x103)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x3bcb4a['error_description']||_0x3b044e(0xef));}catch(_0x409543){console['error'](_0x3b044e(0x12e),_0x409543);}return![];}function a0_0x19d0(_0x174460,_0x3de743){var _0x5edd9f=a0_0x5edd();return a0_0x19d0=function(_0x19d0b2,_0x5d8c3d){_0x19d0b2=_0x19d0b2-0xda;var _0x12f490=_0x5edd9f[_0x19d0b2];return _0x12f490;},a0_0x19d0(_0x174460,_0x3de743);}export async function dpUploadFile(_0x572c70,_0x164fc9,_0x4f015c){var _0x44726c=a0_0x1d6ee3;const _0x4451da=localStorage[_0x44726c(0x131)](_0x44726c(0x110));var _0x29e4a4=JSON['stringify']({'autorename':!![],'mode':_0x44726c(0xe0),'mute':!![],'strict_conflict':![],'path':'/'+_0x4451da+'/'+_0x4f015c+'/'+_0x572c70}),_0x1f097a=new Blob([_0x164fc9],{'type':_0x44726c(0x10f)});for(var _0x19828b=0x0;_0x19828b<0x2;_0x19828b++){var _0x16e12b=await fetch(_0x44726c(0x12d),{'method':_0x44726c(0xda),'headers':{'Authorization':_0x44726c(0x11f)+localStorage[_0x44726c(0x131)]('accessToken'),'Dropbox-API-Arg':_0x29e4a4,'Content-Type':_0x44726c(0x10f)},'body':_0x1f097a});if(_0x16e12b[_0x44726c(0xf9)]!=0xc8){if(_0x16e12b[_0x44726c(0xf9)]==0x191){var _0x32f5f2=await dpRefreshToken();if(!_0x32f5f2)throw _0x44726c(0x13a);continue;}else throw _0x44726c(0x117)+_0x16e12b[_0x44726c(0xf9)];}else{var _0x53c841=await _0x16e12b['json']();return console[_0x44726c(0x111)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x572c70),_0x53c841;}}return![];}export async function dpDownloadFile(_0x324eea,_0x5940c4){var _0x29cc68=a0_0x1d6ee3;const _0x454b45=localStorage[_0x29cc68(0x131)](_0x29cc68(0x110));var _0x179b44=JSON[_0x29cc68(0xf1)]({'path':'/'+_0x454b45+'/'+_0x5940c4+'/'+_0x324eea});for(var _0x2028f8=0x0;_0x2028f8<0x2;_0x2028f8++){var _0x34a6e5=await fetch(_0x29cc68(0x116),{'method':_0x29cc68(0xda),'headers':{'Authorization':_0x29cc68(0x11f)+localStorage[_0x29cc68(0x131)](_0x29cc68(0xfe)),'Dropbox-API-Arg':_0x179b44}});if(_0x34a6e5[_0x29cc68(0xf9)]!=0xc8){if(_0x34a6e5[_0x29cc68(0xf9)]==0x191){var _0x217d29=await dpRefreshToken();if(!_0x217d29)throw _0x29cc68(0x13a);continue;}else throw _0x29cc68(0xf5)+_0x34a6e5[_0x29cc68(0xf9)];}const _0x5e9485=new File([await _0x34a6e5[_0x29cc68(0x12c)]()],_0x324eea);return console['log'](_0x29cc68(0x143),_0x5e9485['name']),a0_0x415703[_0x29cc68(0xe4)](_0x5e9485,()=>{var _0x223a64=_0x29cc68;localStorageFile(),Module[_0x223a64(0x102)]();}),_0x5e9485;}return![];}document[a0_0x1d6ee3(0x10e)](a0_0x1d6ee3(0xea),function(){var _0x1ed944=a0_0x1d6ee3;dropboxRestore[_0x1ed944(0x10e)]('click',async function(){var _0x513fc1=_0x1ed944;await lockNoti(_0x513fc1(0x105),'',0x1388);const _0x1d269b=localStorage['getItem'](_0x513fc1(0x110)),_0x649d3e=[_0x513fc1(0xe2),_0x513fc1(0xf3),_0x513fc1(0xdb)];if(!_0x1d269b){window[_0x513fc1(0x120)](_0x513fc1(0x127));return;}let _0x5becf4=[];for(const _0x5c10e8 of _0x649d3e){let _0x20e663={'path':'/'+_0x1d269b+'/'+_0x5c10e8};for(let _0x4b0e37=0x0;_0x4b0e37<0x2;_0x4b0e37++){let _0x92e94d=await fetch(_0x513fc1(0x128),{'method':_0x513fc1(0xda),'headers':{'Authorization':_0x513fc1(0x11f)+localStorage[_0x513fc1(0x131)](_0x513fc1(0xfe)),'Content-Type':_0x513fc1(0xee)},'body':JSON[_0x513fc1(0xf1)](_0x20e663)});if(_0x92e94d[_0x513fc1(0xf9)]===0xc8){let _0xcd3246=await _0x92e94d[_0x513fc1(0x107)](),_0x75e449=_0xcd3246[_0x513fc1(0xde)][_0x513fc1(0x125)](_0x11ebd6=>_0x11ebd6[_0x513fc1(0x126)]===_0x513fc1(0x129));_0x75e449[_0x513fc1(0x138)]>0x0&&_0x5becf4[_0x513fc1(0xe7)](..._0x75e449[_0x513fc1(0xed)](_0x2d486f=>({'name':_0x2d486f[_0x513fc1(0x112)],'folder':_0x5c10e8})));break;}else{if(_0x92e94d[_0x513fc1(0xf9)]===0x191){let _0x5839ec=await dpRefreshToken();if(!_0x5839ec)throw _0x513fc1(0x13a);}else{console['error'](_0x513fc1(0x13f)+_0x5c10e8+',\x20status:\x20'+_0x92e94d[_0x513fc1(0xf9)]);break;}}}}if(_0x5becf4['length']>0x0){const _0x4fb2e1='Do\x20you\x20want\x20to\x20restore\x20'+_0x5becf4[_0x513fc1(0x138)]+_0x513fc1(0x10c);if(window[_0x513fc1(0x119)](_0x4fb2e1))for(const _0x25eb7f of _0x5becf4){await lockNoti('Restoring...',_0x25eb7f[_0x513fc1(0x112)],0xbb8),await dpDownloadFile(_0x25eb7f[_0x513fc1(0x112)],_0x25eb7f['folder']);}else console['log'](_0x513fc1(0xdc));}else console['log'](_0x513fc1(0x10b));}),dropboxBackup[_0x1ed944(0x10e)](_0x1ed944(0x11a),async function(){var _0x387478=_0x1ed944;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x555831=localStorage[_0x387478(0x131)](_0x387478(0x110));if(_0x555831===null||_0x555831==='')window['alert'](_0x387478(0x127));else{const _0x4ca066=[_0x387478(0xe2),'save',_0x387478(0xdb)];for(const _0x4f7414 of _0x4ca066){await dpCreateFolder(_0x4f7414);}let _0x100fcc=0x0;for(const _0x577f85 of _0x4ca066){const _0x3e05a2=a0_0x415703[_0x387478(0x12f)+(_0x577f85[_0x387478(0xf6)](0x0)[_0x387478(0x114)]()+_0x577f85[_0x387478(0xe6)](0x1))]();_0x100fcc+=_0x3e05a2[_0x387478(0x138)];}if(window[_0x387478(0x119)](_0x387478(0x113)+_0x100fcc+'\x20files\x20in\x20Kabu?'))for(const _0x222795 of _0x4ca066){const _0x382ffb=a0_0x415703['list'+(_0x222795[_0x387478(0xf6)](0x0)[_0x387478(0x114)]()+_0x222795[_0x387478(0xe6)](0x1))]();for(const _0x3f6e17 of _0x382ffb){const _0x384c5d=await a0_0x415703['downloadFileInCloud'](_0x387478(0x11e)+_0x222795+'s/'+_0x3f6e17);try{await lockNoti(_0x387478(0xe3),_0x3f6e17,0xbb8),await dpUploadFile(_0x3f6e17,_0x384c5d,_0x222795);}catch(_0x38eabb){console[_0x387478(0xdf)](_0x387478(0xf8)+_0x3f6e17+':',_0x38eabb);}}}else console[_0x387478(0x111)](_0x387478(0xdc));}}),dropboxCloud[_0x1ed944(0x10e)](_0x1ed944(0x11a),function(){var _0x2fa2a4=_0x1ed944;const _0x2f9689=localStorage[_0x2fa2a4(0x131)](_0x2fa2a4(0x110));_0x2f9689===null||_0x2f9689===''?authorizeWithDropbox():window[_0x2fa2a4(0x119)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x2fa2a4(0x135)](_0x2fa2a4(0x110),''),dropboxRestore[_0x2fa2a4(0x115)]['remove'](_0x2fa2a4(0xfd)),dropboxBackup[_0x2fa2a4(0x115)][_0x2fa2a4(0x132)]('active'),dropboxCloud['classList'][_0x2fa2a4(0x132)](_0x2fa2a4(0xfd)));}),handleDropboxCallback();});