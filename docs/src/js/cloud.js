var a0_0x1ed157=a0_0x433f;(function(_0x4b2d7d,_0x379ccb){var _0x294748=a0_0x433f,_0x4cdc91=_0x4b2d7d();while(!![]){try{var _0x6320fe=parseInt(_0x294748(0x120))/0x1*(parseInt(_0x294748(0x123))/0x2)+parseInt(_0x294748(0x12a))/0x3*(-parseInt(_0x294748(0x149))/0x4)+-parseInt(_0x294748(0x135))/0x5+parseInt(_0x294748(0x118))/0x6*(parseInt(_0x294748(0x116))/0x7)+parseInt(_0x294748(0x11b))/0x8+-parseInt(_0x294748(0x143))/0x9+parseInt(_0x294748(0x15d))/0xa*(parseInt(_0x294748(0x126))/0xb);if(_0x6320fe===_0x379ccb)break;else _0x4cdc91['push'](_0x4cdc91['shift']());}catch(_0x1e6f5b){_0x4cdc91['push'](_0x4cdc91['shift']());}}}(a0_0x4b4d,0xa0afa));function a0_0x4b4d(){var _0x19cd47=['Backing\x20up...','refreshToken','10975257kYxIWk','code','Cloud\x20login\x20required!','Restore\x20canceled\x20by\x20user.','confirm','replace','28DpZiJe','addEventListener','stringify','=([^&#]*)','\x20files\x20in\x20Kabu?','Wait\x20a\x20little\x20bit...','downloadFileInCloud','&response_type=','setItem','name','&client_secret=','json','application/x-www-form-urlencoded','https://www.dropbox.com/oauth2/authorize?client_id=','uId','Folder\x20created','knh3uz2mx2hp2eu','&grant_type=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','log','80Ifiida',',\x20status:\x20','href','[\x5c?&#]','responseText','slice','getItem','Error\x20creating\x20folder\x20','alert','refresh_token','toUpperCase','click','entries','Do\x20you\x20want\x20to\x20backup\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://api.dropboxapi.com/oauth2/token','error_description','application/octet-stream','active','setRequestHeader','Content-Type','Unable\x20to\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','accessToken','send','search','save','open','Cloud\x20↦\x20Kabu\x20storage\x20◆','nwb3dnfh09rhs31','code=','No\x20refresh\x20token','refresh_token=','https://api.dropboxapi.com/2/files/create_folder_v2','https://content.dropboxapi.com/2/files/upload','No\x20files\x20found\x20to\x20restore.','/data/','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','offline','8743jTFwRp','list','3048pnrezB','uploadFileInCloud','location','430288zKbxyU','https://api.dropbox.com/oauth2/token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Download\x20failed,\x20unknown\x20http\x20status:','map','5HdhdWY','Failed\x20to\x20upload\x20file\x20','authorization_code','153586QzymPD','Error\x20while\x20refreshing\x20token:','\x20files\x20from\x20Cloud?','2137696YjCmIi','.tag','state','error','79539YsPRbY','FSSync','Bearer\x20','Do\x20not\x20receive\x20authorization','file','Failed\x20to\x20refresh\x20Dropbox\x20token.','screenshot','&token_access_type=','DOMContentLoaded','POST','&redirect_uri=','2818485akONCA','status','overwrite','classList','Refreshing\x20token...','blob','https://api.dropboxapi.com/2/files/list_folder','&client_id=','folder','length','Do\x20you\x20want\x20to\x20logout?','remove'];a0_0x4b4d=function(){return _0x19cd47;};return a0_0x4b4d();}function a0_0x433f(_0x28770b,_0x464eba){var _0x4b4d51=a0_0x4b4d();return a0_0x433f=function(_0x433f56,_0x51654c){_0x433f56=_0x433f56-0x100;var _0x180a58=_0x4b4d51[_0x433f56];return _0x180a58;},a0_0x433f(_0x28770b,_0x464eba);}import*as a0_0x15b321 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1ed157(0x159),clientSecret=a0_0x1ed157(0x10c);function authorizeWithDropbox(){var _0x24a03e=a0_0x1ed157,_0x11734a=window[_0x24a03e(0x11a)][_0x24a03e(0x15f)]['split']('?')[0x0],_0x3ce1e0=_0x24a03e(0x144),_0x437386=_0x24a03e(0x115),_0x2ae56b=_0x24a03e(0x156)+clientId+_0x24a03e(0x150)+_0x3ce1e0+_0x24a03e(0x131)+_0x437386+_0x24a03e(0x134)+encodeURIComponent(_0x11734a);window['location']['href']=_0x2ae56b;}function handleDropboxCallback(){var _0x1ce4c2=a0_0x1ed157,_0x35bf35=getUrlParameter(_0x1ce4c2(0x144));_0x35bf35?(getAccessToken(_0x35bf35),console[_0x1ce4c2(0x15c)]('Authorization\x20Code:',_0x35bf35)):console[_0x1ce4c2(0x15c)](_0x1ce4c2(0x12d));}function getUrlParameter(_0x1717da){var _0x2952f7=a0_0x1ed157;_0x1717da=_0x1717da[_0x2952f7(0x148)](/[\[]/,'\x5c[')[_0x2952f7(0x148)](/[\]]/,'\x5c]');var _0x53157e=new RegExp(_0x2952f7(0x160)+_0x1717da+_0x2952f7(0x14c)),_0x3585f3=_0x53157e['exec'](location[_0x2952f7(0x108)]);return _0x3585f3===null?'':decodeURIComponent(_0x3585f3[0x1][_0x2952f7(0x148)](/\+/g,'\x20'));}function getAccessToken(_0xb48a55){var _0xa9c3e0=a0_0x1ed157,_0x4bf4fd=_0xa9c3e0(0x122),_0x43d577=window['location'][_0xa9c3e0(0x15f)]['split']('?')[0x0],_0x58c504=new XMLHttpRequest();_0x58c504[_0xa9c3e0(0x10a)]('POST',_0xa9c3e0(0x11c)),_0x58c504[_0xa9c3e0(0x102)](_0xa9c3e0(0x103),'application/x-www-form-urlencoded'),_0x58c504['onload']=function(){var _0x24836b=_0xa9c3e0;if(_0x58c504[_0x24836b(0x136)]===0xc8){var _0x378d4a=JSON['parse'](_0x58c504[_0x24836b(0x161)]),_0x2e15f6=_0x378d4a['access_token'],_0x2241cf=_0x378d4a[_0x24836b(0x166)],_0x2e4203=_0x378d4a['uid'];localStorage[_0x24836b(0x151)](_0x24836b(0x106),_0x2e15f6),localStorage[_0x24836b(0x151)](_0x24836b(0x142),_0x2241cf),localStorage[_0x24836b(0x151)](_0x24836b(0x157),_0x2e4203);}else console[_0x24836b(0x15c)](_0x24836b(0x114));},_0x58c504[_0xa9c3e0(0x107)](_0xa9c3e0(0x10d)+_0xb48a55+_0xa9c3e0(0x15a)+_0x4bf4fd+_0xa9c3e0(0x13c)+clientId+_0xa9c3e0(0x153)+clientSecret+_0xa9c3e0(0x134)+encodeURIComponent(_0x43d577));}export async function dpCreateFolder(_0x507978){var _0x1d147a=a0_0x1ed157;const _0x3282b1=localStorage['getItem'](_0x1d147a(0x157));let _0x29a1dc=localStorage[_0x1d147a(0x163)](_0x1d147a(0x106));const _0x2cd12f='/'+_0x3282b1+'/'+_0x507978,_0x1fd904=JSON[_0x1d147a(0x14b)]({'path':_0x2cd12f,'autorename':![]});for(let _0x410cc8=0x0;_0x410cc8<0x2;_0x410cc8++){try{const _0x59bb84=await fetch(_0x1d147a(0x110),{'method':_0x1d147a(0x133),'headers':{'Authorization':_0x1d147a(0x12c)+_0x29a1dc,'Content-Type':'application/json'},'body':_0x1fd904});if(_0x59bb84[_0x1d147a(0x136)]===0x191){const _0x7989fe=await dpRefreshToken();if(!_0x7989fe)throw new Error(_0x1d147a(0x104));_0x29a1dc=localStorage['getItem'](_0x1d147a(0x106));continue;}if(_0x59bb84[_0x1d147a(0x136)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x507978};if(!_0x59bb84['ok'])throw new Error(_0x1d147a(0x164)+_0x507978);const _0xac5c9b=await _0x59bb84[_0x1d147a(0x154)]();return await lockNoti(_0x1d147a(0x158),'',0xbb8),_0xac5c9b;}catch(_0x545300){if(_0x410cc8===0x1)throw _0x545300;}}return![];}export async function dpRefreshToken(){var _0x3ea6e0=a0_0x1ed157;if(!localStorage[_0x3ea6e0(0x163)]('refreshToken'))throw _0x3ea6e0(0x10e);try{const _0x58ae7a=await fetch(_0x3ea6e0(0x16c),{'method':_0x3ea6e0(0x133),'headers':{'Content-Type':_0x3ea6e0(0x155)},'body':_0x3ea6e0(0x10f)+localStorage[_0x3ea6e0(0x163)](_0x3ea6e0(0x142))+_0x3ea6e0(0x11d)}),_0x2c0424=await _0x58ae7a[_0x3ea6e0(0x154)]();if(!_0x2c0424['error'])return localStorage['setItem'](_0x3ea6e0(0x106),_0x2c0424['access_token']),await lockNoti(_0x3ea6e0(0x139),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2c0424[_0x3ea6e0(0x16d)]||_0x3ea6e0(0x12f));}catch(_0x1af264){console['error'](_0x3ea6e0(0x124),_0x1af264);}return![];}export async function dpUploadFile(_0x1d8e18,_0x2bb0af,_0x33062c){var _0x225065=a0_0x1ed157;const _0x1306df=localStorage[_0x225065(0x163)](_0x225065(0x157));var _0x68f294=JSON[_0x225065(0x14b)]({'autorename':!![],'mode':_0x225065(0x137),'mute':!![],'strict_conflict':![],'path':'/'+_0x1306df+'/'+_0x33062c+'/'+_0x1d8e18}),_0x2d7b7b=new Blob([_0x2bb0af],{'type':_0x225065(0x100)});for(var _0x2e806d=0x0;_0x2e806d<0x2;_0x2e806d++){var _0x19ec7a=await fetch(_0x225065(0x111),{'method':_0x225065(0x133),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x225065(0x106)),'Dropbox-API-Arg':_0x68f294,'Content-Type':_0x225065(0x100)},'body':_0x2d7b7b});if(_0x19ec7a[_0x225065(0x136)]!=0xc8){if(_0x19ec7a[_0x225065(0x136)]==0x191){var _0x19da5c=await dpRefreshToken();if(!_0x19da5c)throw _0x225065(0x104);continue;}else throw _0x225065(0x15b)+_0x19ec7a[_0x225065(0x136)];}else{var _0xa26913=await _0x19ec7a[_0x225065(0x154)]();return console[_0x225065(0x15c)](_0x225065(0x16b),_0x1d8e18),_0xa26913;}}return![];}export async function dpDownloadFile(_0x1f58a5,_0x1218da){var _0x19dd60=a0_0x1ed157;const _0x540df7=localStorage[_0x19dd60(0x163)](_0x19dd60(0x157));var _0x135c28=JSON[_0x19dd60(0x14b)]({'path':'/'+_0x540df7+'/'+_0x1218da+'/'+_0x1f58a5});for(var _0x35873a=0x0;_0x35873a<0x2;_0x35873a++){var _0x4128fc=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x19dd60(0x133),'headers':{'Authorization':_0x19dd60(0x12c)+localStorage[_0x19dd60(0x163)](_0x19dd60(0x106)),'Dropbox-API-Arg':_0x135c28}});if(_0x4128fc[_0x19dd60(0x136)]!=0xc8){if(_0x4128fc[_0x19dd60(0x136)]==0x191){var _0x461bb1=await dpRefreshToken();if(!_0x461bb1)throw _0x19dd60(0x104);continue;}else throw _0x19dd60(0x11e)+_0x4128fc[_0x19dd60(0x136)];}const _0x189e95=new File([await _0x4128fc[_0x19dd60(0x13a)]()],_0x1f58a5);return console['log'](_0x19dd60(0x10b),_0x189e95['name']),a0_0x15b321[_0x19dd60(0x119)](_0x189e95,()=>{var _0x24f979=_0x19dd60;localStorageFile(),Module[_0x24f979(0x12b)]();}),_0x189e95;}return![];}document[a0_0x1ed157(0x14a)](a0_0x1ed157(0x132),function(){var _0x250046=a0_0x1ed157;dropboxRestore[_0x250046(0x14a)]('click',async function(){var _0x4a93a2=_0x250046;await lockNoti(_0x4a93a2(0x14e),'',0x1388);const _0x1e9a53=localStorage[_0x4a93a2(0x163)](_0x4a93a2(0x157)),_0x32b58f=[_0x4a93a2(0x128),_0x4a93a2(0x109),'screenshot'];if(!_0x1e9a53){window[_0x4a93a2(0x165)]('Cloud\x20login\x20required!');return;}let _0x3edf27=[];for(const _0x23e338 of _0x32b58f){let _0x1216d3={'path':'/'+_0x1e9a53+'/'+_0x23e338};for(let _0x16ab7f=0x0;_0x16ab7f<0x2;_0x16ab7f++){let _0x541f27=await fetch(_0x4a93a2(0x13b),{'method':_0x4a93a2(0x133),'headers':{'Authorization':_0x4a93a2(0x12c)+localStorage[_0x4a93a2(0x163)](_0x4a93a2(0x106)),'Content-Type':'application/json'},'body':JSON[_0x4a93a2(0x14b)](_0x1216d3)});if(_0x541f27[_0x4a93a2(0x136)]===0xc8){let _0x2345d5=await _0x541f27[_0x4a93a2(0x154)](),_0x3aa3cf=_0x2345d5[_0x4a93a2(0x169)]['filter'](_0x143e15=>_0x143e15[_0x4a93a2(0x127)]===_0x4a93a2(0x12e));_0x3aa3cf[_0x4a93a2(0x13e)]>0x0&&_0x3edf27['push'](..._0x3aa3cf[_0x4a93a2(0x11f)](_0x42c91d=>({'name':_0x42c91d[_0x4a93a2(0x152)],'folder':_0x23e338})));break;}else{if(_0x541f27[_0x4a93a2(0x136)]===0x191){let _0x2441d6=await dpRefreshToken();if(!_0x2441d6)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x4a93a2(0x129)]('Download\x20failed\x20for\x20'+_0x23e338+_0x4a93a2(0x15e)+_0x541f27['status']);break;}}}}if(_0x3edf27[_0x4a93a2(0x13e)]>0x0){const _0x12f6a4=_0x4a93a2(0x105)+_0x3edf27[_0x4a93a2(0x13e)]+_0x4a93a2(0x125);if(window[_0x4a93a2(0x147)](_0x12f6a4))for(const _0x56fc1b of _0x3edf27){await lockNoti('Restoring...',_0x56fc1b[_0x4a93a2(0x152)],0xbb8),await dpDownloadFile(_0x56fc1b[_0x4a93a2(0x152)],_0x56fc1b[_0x4a93a2(0x13d)]);}else console[_0x4a93a2(0x15c)](_0x4a93a2(0x146));}else console[_0x4a93a2(0x15c)](_0x4a93a2(0x112));}),dropboxBackup[_0x250046(0x14a)](_0x250046(0x168),async function(){var _0x4a3753=_0x250046;await lockNoti(_0x4a3753(0x14e),'',0x1388);const _0x500586=localStorage[_0x4a3753(0x163)]('uId');if(_0x500586===null||_0x500586==='')window[_0x4a3753(0x165)](_0x4a3753(0x145));else{const _0x3353e2=[_0x4a3753(0x128),_0x4a3753(0x109),_0x4a3753(0x130)];for(const _0xab10bb of _0x3353e2){await dpCreateFolder(_0xab10bb);}let _0x2fa4ae=0x0;for(const _0x3f8781 of _0x3353e2){const _0x442c0b=a0_0x15b321['list'+(_0x3f8781['charAt'](0x0)[_0x4a3753(0x167)]()+_0x3f8781[_0x4a3753(0x162)](0x1))]();_0x2fa4ae+=_0x442c0b['length'];}if(window[_0x4a3753(0x147)](_0x4a3753(0x16a)+_0x2fa4ae+_0x4a3753(0x14d)))for(const _0x3dc31d of _0x3353e2){const _0x98ace1=a0_0x15b321[_0x4a3753(0x117)+(_0x3dc31d['charAt'](0x0)[_0x4a3753(0x167)]()+_0x3dc31d[_0x4a3753(0x162)](0x1))]();for(const _0x19e4be of _0x98ace1){const _0x115c09=await a0_0x15b321[_0x4a3753(0x14f)](_0x4a3753(0x113)+_0x3dc31d+'s/'+_0x19e4be);try{await lockNoti(_0x4a3753(0x141),_0x19e4be,0xbb8),await dpUploadFile(_0x19e4be,_0x115c09,_0x3dc31d);}catch(_0x30d350){console[_0x4a3753(0x129)](_0x4a3753(0x121)+_0x19e4be+':',_0x30d350);}}}else console['log'](_0x4a3753(0x146));}}),dropboxCloud[_0x250046(0x14a)](_0x250046(0x168),function(){var _0x1c2c90=_0x250046;const _0x2d2063=localStorage[_0x1c2c90(0x163)]('uId');_0x2d2063===null||_0x2d2063===''?authorizeWithDropbox():window['confirm'](_0x1c2c90(0x13f))&&(localStorage['setItem'](_0x1c2c90(0x157),''),dropboxRestore['classList'][_0x1c2c90(0x140)](_0x1c2c90(0x101)),dropboxBackup[_0x1c2c90(0x138)][_0x1c2c90(0x140)](_0x1c2c90(0x101)),dropboxCloud['classList'][_0x1c2c90(0x140)]('active'));}),handleDropboxCallback();});