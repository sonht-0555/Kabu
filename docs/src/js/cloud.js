function a0_0x2fa3(_0x3a96a7,_0x356efd){var _0x581641=a0_0x5816();return a0_0x2fa3=function(_0x2fa397,_0x99fe76){_0x2fa397=_0x2fa397-0x1cc;var _0x46b9d5=_0x581641[_0x2fa397];return _0x46b9d5;},a0_0x2fa3(_0x3a96a7,_0x356efd);}var a0_0x1c1e77=a0_0x2fa3;(function(_0x13fa6c,_0x18661c){var _0x4601b0=a0_0x2fa3,_0xba848c=_0x13fa6c();while(!![]){try{var _0x312ecf=parseInt(_0x4601b0(0x21f))/0x1+parseInt(_0x4601b0(0x216))/0x2+-parseInt(_0x4601b0(0x1f2))/0x3*(parseInt(_0x4601b0(0x1f3))/0x4)+-parseInt(_0x4601b0(0x1df))/0x5+-parseInt(_0x4601b0(0x1d1))/0x6+-parseInt(_0x4601b0(0x1ef))/0x7+parseInt(_0x4601b0(0x200))/0x8*(parseInt(_0x4601b0(0x1d9))/0x9);if(_0x312ecf===_0x18661c)break;else _0xba848c['push'](_0xba848c['shift']());}catch(_0x3ed31b){_0xba848c['push'](_0xba848c['shift']());}}}(a0_0x5816,0xc2639));import*as a0_0x2a498d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1c1e77(0x201),clientSecret=a0_0x1c1e77(0x22a);function authorizeWithDropbox(){var _0x2d0a26=a0_0x1c1e77,_0x1a4eba=window['location']['href']['split']('?')[0x0],_0x1609bd='code',_0x238fee='offline',_0x40a4c4=_0x2d0a26(0x1f4)+clientId+'&response_type='+_0x1609bd+_0x2d0a26(0x1e6)+_0x238fee+_0x2d0a26(0x1f8)+encodeURIComponent(_0x1a4eba);window[_0x2d0a26(0x1e5)][_0x2d0a26(0x20a)]=_0x40a4c4;}function handleDropboxCallback(){var _0x32bc75=a0_0x1c1e77,_0x27f3bd=getUrlParameter(_0x32bc75(0x1da));_0x27f3bd?(getAccessToken(_0x27f3bd),console[_0x32bc75(0x220)](_0x32bc75(0x209),_0x27f3bd)):console['log'](_0x32bc75(0x1e1));}function getUrlParameter(_0x57580b){var _0x2d661f=a0_0x1c1e77;_0x57580b=_0x57580b['replace'](/[\[]/,'\x5c[')[_0x2d661f(0x1cc)](/[\]]/,'\x5c]');var _0xd6885d=new RegExp('[\x5c?&#]'+_0x57580b+_0x2d661f(0x210)),_0x33a76c=_0xd6885d[_0x2d661f(0x1ea)](location['search']);return _0x33a76c===null?'':decodeURIComponent(_0x33a76c[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x144ca3){var _0x340971=a0_0x1c1e77,_0x4bd7a4=_0x340971(0x203),_0xcd5226=window[_0x340971(0x1e5)][_0x340971(0x20a)][_0x340971(0x21e)]('?')[0x0],_0x4f790b=new XMLHttpRequest();_0x4f790b[_0x340971(0x21c)](_0x340971(0x1fc),'https://api.dropbox.com/oauth2/token'),_0x4f790b[_0x340971(0x20b)](_0x340971(0x1db),'application/x-www-form-urlencoded'),_0x4f790b[_0x340971(0x20d)]=function(){var _0x365853=_0x340971;if(_0x4f790b[_0x365853(0x1f1)]===0xc8){var _0x5cd454=JSON[_0x365853(0x211)](_0x4f790b[_0x365853(0x1ce)]),_0x256696=_0x5cd454[_0x365853(0x1f5)],_0xb52c17=_0x5cd454['refresh_token'],_0x496519=_0x5cd454[_0x365853(0x1e9)];localStorage[_0x365853(0x206)](_0x365853(0x1eb),_0x256696),localStorage[_0x365853(0x206)]('refreshToken',_0xb52c17),localStorage['setItem'](_0x365853(0x1d7),_0x496519);}else console[_0x365853(0x220)](_0x365853(0x222));},_0x4f790b[_0x340971(0x213)](_0x340971(0x1e8)+_0x144ca3+_0x340971(0x1dd)+_0x4bd7a4+_0x340971(0x1cf)+clientId+_0x340971(0x228)+clientSecret+_0x340971(0x1f8)+encodeURIComponent(_0xcd5226));}export async function dpCreateFolder(_0x5184c3){var _0x489722=a0_0x1c1e77;const _0x1007eb=localStorage[_0x489722(0x1d8)](_0x489722(0x1d7));let _0x47873f=localStorage['getItem'](_0x489722(0x1eb));const _0x152d49='/'+_0x1007eb+'/'+_0x5184c3,_0x1359c2=JSON[_0x489722(0x1e4)]({'path':_0x152d49,'autorename':![]});for(let _0x46ac5c=0x0;_0x46ac5c<0x2;_0x46ac5c++){try{const _0x4ceedb=await fetch(_0x489722(0x21b),{'method':'POST','headers':{'Authorization':_0x489722(0x22c)+_0x47873f,'Content-Type':_0x489722(0x204)},'body':_0x1359c2});if(_0x4ceedb[_0x489722(0x1f1)]===0x191){const _0x3ff726=await dpRefreshToken();if(!_0x3ff726)throw new Error(_0x489722(0x1e0));_0x47873f=localStorage[_0x489722(0x1d8)](_0x489722(0x1eb));continue;}if(_0x4ceedb[_0x489722(0x1f1)]===0x199)return{'message':_0x489722(0x1d0),'path':_0x5184c3};if(!_0x4ceedb['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x5184c3);const _0x11cfb2=await _0x4ceedb[_0x489722(0x1dc)]();return await lockNoti(_0x489722(0x20c),'',0xbb8),_0x11cfb2;}catch(_0x2946a8){if(_0x46ac5c===0x1)throw _0x2946a8;}}return![];}export async function dpRefreshToken(){var _0x335153=a0_0x1c1e77;if(!localStorage[_0x335153(0x1d8)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x2ac92f=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x335153(0x1fc),'headers':{'Content-Type':_0x335153(0x20f)},'body':'refresh_token='+localStorage['getItem'](_0x335153(0x214))+_0x335153(0x1e3)}),_0x23824d=await _0x2ac92f['json']();if(!_0x23824d[_0x335153(0x1d6)])return localStorage[_0x335153(0x206)](_0x335153(0x1eb),_0x23824d[_0x335153(0x1f5)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x23824d[_0x335153(0x217)]||_0x335153(0x229));}catch(_0x42c52e){console['error']('Error\x20while\x20refreshing\x20token:',_0x42c52e);}return![];}export async function dpUploadFile(_0x1cab19,_0x2ccc10,_0x98701a){var _0x27eeb1=a0_0x1c1e77;const _0x547c2a=localStorage[_0x27eeb1(0x1d8)](_0x27eeb1(0x1d7));var _0x1c5c7d=JSON[_0x27eeb1(0x1e4)]({'autorename':!![],'mode':_0x27eeb1(0x218),'mute':!![],'strict_conflict':![],'path':'/'+_0x547c2a+'/'+_0x98701a+'/'+_0x1cab19}),_0x35fee3=new Blob([_0x2ccc10],{'type':_0x27eeb1(0x20e)});for(var _0x593f77=0x0;_0x593f77<0x2;_0x593f77++){var _0x27499c=await fetch(_0x27eeb1(0x1f6),{'method':_0x27eeb1(0x1fc),'headers':{'Authorization':_0x27eeb1(0x22c)+localStorage[_0x27eeb1(0x1d8)](_0x27eeb1(0x1eb)),'Dropbox-API-Arg':_0x1c5c7d,'Content-Type':_0x27eeb1(0x20e)},'body':_0x35fee3});if(_0x27499c[_0x27eeb1(0x1f1)]!=0xc8){if(_0x27499c[_0x27eeb1(0x1f1)]==0x191){var _0x47c9e3=await dpRefreshToken();if(!_0x47c9e3)throw _0x27eeb1(0x1e0);continue;}else throw _0x27eeb1(0x207)+_0x27499c[_0x27eeb1(0x1f1)];}else{var _0x2960bc=await _0x27499c[_0x27eeb1(0x1dc)]();return console[_0x27eeb1(0x220)](_0x27eeb1(0x1fb),_0x1cab19),_0x2960bc;}}return![];}function a0_0x5816(){var _0x551392=['172KfHLUL','https://www.dropbox.com/oauth2/authorize?client_id=','access_token','https://content.dropboxapi.com/2/files/upload','remove','&redirect_uri=','entries','toUpperCase','Kabu\x20storage\x20↦\x20Cloud\x20◆','POST','save','Cloud\x20login\x20required!','filter','33448HQORsJ','knh3uz2mx2hp2eu','length','authorization_code','application/json','uploadFileInCloud','setItem','Upload\x20failed,\x20unknown\x20http\x20status:\x20','map','Authorization\x20Code:','href','setRequestHeader','Folder\x20created','onload','application/octet-stream','application/x-www-form-urlencoded','=([^&#]*)','parse','Download\x20failed\x20for\x20','send','refreshToken',',\x20status:\x20','622792iAufyo','error_description','overwrite','Failed\x20to\x20upload\x20file\x20','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/2/files/create_folder_v2','open','Do\x20you\x20want\x20to\x20backup\x20','split','1064919xMPOtA','log','slice','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','name','push','Restore\x20canceled\x20by\x20user.','https://content.dropboxapi.com/2/files/download','https://api.dropboxapi.com/2/files/list_folder','&client_secret=','Failed\x20to\x20refresh\x20Dropbox\x20token.','nwb3dnfh09rhs31','downloadFileInCloud','Bearer\x20','Restoring...','addEventListener','click','Wait\x20a\x20little\x20bit...','classList','blob','charAt','replace','state','responseText','&client_id=','Folder\x20already\x20exists','1554690aOWPxq','Cloud\x20↦\x20Kabu\x20storage\x20◆','.tag','confirm','/data/','error','uId','getItem','7704MZoppP','code','Content-Type','json','&grant_type=','folder','7040580bCzwGp','Unable\x20to\x20refresh\x20token','Do\x20not\x20receive\x20authorization','file','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','stringify','location','&token_access_type=','\x20files\x20in\x20Kabu?','code=','uid','exec','accessToken','active','list','DOMContentLoaded','6372142djAaod','Do\x20you\x20want\x20to\x20restore\x20','status','110337OpsTJG'];a0_0x5816=function(){return _0x551392;};return a0_0x5816();}export async function dpDownloadFile(_0xfb88eb,_0x21083f){var _0x3c4b5d=a0_0x1c1e77;const _0x3b84f7=localStorage[_0x3c4b5d(0x1d8)]('uId');var _0xc1d1c0=JSON[_0x3c4b5d(0x1e4)]({'path':'/'+_0x3b84f7+'/'+_0x21083f+'/'+_0xfb88eb});for(var _0x520c09=0x0;_0x520c09<0x2;_0x520c09++){var _0x5501ad=await fetch(_0x3c4b5d(0x226),{'method':_0x3c4b5d(0x1fc),'headers':{'Authorization':_0x3c4b5d(0x22c)+localStorage[_0x3c4b5d(0x1d8)](_0x3c4b5d(0x1eb)),'Dropbox-API-Arg':_0xc1d1c0}});if(_0x5501ad['status']!=0xc8){if(_0x5501ad[_0x3c4b5d(0x1f1)]==0x191){var _0x3b5101=await dpRefreshToken();if(!_0x3b5101)throw _0x3c4b5d(0x1e0);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x5501ad[_0x3c4b5d(0x1f1)];}const _0x34a2e6=new File([await _0x5501ad[_0x3c4b5d(0x232)]()],_0xfb88eb);return console['log'](_0x3c4b5d(0x1d2),_0x34a2e6[_0x3c4b5d(0x223)]),a0_0x2a498d[_0x3c4b5d(0x205)](_0x34a2e6,()=>{localStorageFile(),Module['FSSync']();}),_0x34a2e6;}return![];}document[a0_0x1c1e77(0x22e)](a0_0x1c1e77(0x1ee),function(){var _0x23c540=a0_0x1c1e77;dropboxRestore[_0x23c540(0x22e)]('click',async function(){var _0x1bcf8d=_0x23c540;await lockNoti(_0x1bcf8d(0x230),'',0x1388);const _0xbc45e=localStorage['getItem'](_0x1bcf8d(0x1d7)),_0x1f8e80=[_0x1bcf8d(0x1cd),_0x1bcf8d(0x1fd),'screenshot'];if(!_0xbc45e){window['alert'](_0x1bcf8d(0x1fe));return;}let _0x36ed21=[];for(const _0x58c0c4 of _0x1f8e80){let _0x1173f6={'path':'/'+_0xbc45e+'/'+_0x58c0c4};for(let _0x4a63e0=0x0;_0x4a63e0<0x2;_0x4a63e0++){let _0x4f3395=await fetch(_0x1bcf8d(0x227),{'method':_0x1bcf8d(0x1fc),'headers':{'Authorization':_0x1bcf8d(0x22c)+localStorage[_0x1bcf8d(0x1d8)](_0x1bcf8d(0x1eb)),'Content-Type':_0x1bcf8d(0x204)},'body':JSON[_0x1bcf8d(0x1e4)](_0x1173f6)});if(_0x4f3395[_0x1bcf8d(0x1f1)]===0xc8){let _0xfb7fb8=await _0x4f3395[_0x1bcf8d(0x1dc)](),_0x35d0e7=_0xfb7fb8[_0x1bcf8d(0x1f9)][_0x1bcf8d(0x1ff)](_0x30f093=>_0x30f093[_0x1bcf8d(0x1d3)]===_0x1bcf8d(0x1e2));_0x35d0e7[_0x1bcf8d(0x202)]>0x0&&_0x36ed21[_0x1bcf8d(0x224)](..._0x35d0e7[_0x1bcf8d(0x208)](_0x56ce2a=>({'name':_0x56ce2a[_0x1bcf8d(0x223)],'folder':_0x58c0c4})));break;}else{if(_0x4f3395[_0x1bcf8d(0x1f1)]===0x191){let _0x1fdcc5=await dpRefreshToken();if(!_0x1fdcc5)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x1bcf8d(0x212)+_0x58c0c4+_0x1bcf8d(0x215)+_0x4f3395[_0x1bcf8d(0x1f1)]);break;}}}}if(_0x36ed21[_0x1bcf8d(0x202)]>0x0){const _0x15a871=_0x1bcf8d(0x1f0)+_0x36ed21[_0x1bcf8d(0x202)]+_0x1bcf8d(0x21a);if(window['confirm'](_0x15a871))for(const _0x1afd8d of _0x36ed21){await lockNoti(_0x1bcf8d(0x22d),_0x1afd8d[_0x1bcf8d(0x223)],0xbb8),await dpDownloadFile(_0x1afd8d[_0x1bcf8d(0x223)],_0x1afd8d[_0x1bcf8d(0x1de)]);}else console[_0x1bcf8d(0x220)](_0x1bcf8d(0x225));}else console[_0x1bcf8d(0x220)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x23c540(0x22e)](_0x23c540(0x22f),async function(){var _0x555610=_0x23c540;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x20978c=localStorage[_0x555610(0x1d8)]('uId');if(_0x20978c===null||_0x20978c==='')window['alert'](_0x555610(0x1fe));else{const _0x246c78=['state',_0x555610(0x1fd),'screenshot'];for(const _0x5a760b of _0x246c78){await dpCreateFolder(_0x5a760b);}let _0x2b520c=0x0;for(const _0x3d94eb of _0x246c78){const _0x5b6454=a0_0x2a498d[_0x555610(0x1ed)+(_0x3d94eb[_0x555610(0x233)](0x0)[_0x555610(0x1fa)]()+_0x3d94eb[_0x555610(0x221)](0x1))]();_0x2b520c+=_0x5b6454[_0x555610(0x202)];}if(window[_0x555610(0x1d4)](_0x555610(0x21d)+_0x2b520c+_0x555610(0x1e7)))for(const _0x1c7dea of _0x246c78){const _0x543df2=a0_0x2a498d[_0x555610(0x1ed)+(_0x1c7dea[_0x555610(0x233)](0x0)[_0x555610(0x1fa)]()+_0x1c7dea['slice'](0x1))]();for(const _0x511fe8 of _0x543df2){const _0x2d6236=await a0_0x2a498d[_0x555610(0x22b)](_0x555610(0x1d5)+_0x1c7dea+'s/'+_0x511fe8);try{await lockNoti('Backing\x20up...',_0x511fe8,0xbb8),await dpUploadFile(_0x511fe8,_0x2d6236,_0x1c7dea);}catch(_0x53f34b){console[_0x555610(0x1d6)](_0x555610(0x219)+_0x511fe8+':',_0x53f34b);}}}else console['log'](_0x555610(0x225));}}),dropboxCloud['addEventListener'](_0x23c540(0x22f),function(){var _0x9ce211=_0x23c540;const _0x46b04d=localStorage[_0x9ce211(0x1d8)](_0x9ce211(0x1d7));_0x46b04d===null||_0x46b04d===''?authorizeWithDropbox():window[_0x9ce211(0x1d4)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x9ce211(0x206)](_0x9ce211(0x1d7),''),dropboxRestore['classList'][_0x9ce211(0x1f7)](_0x9ce211(0x1ec)),dropboxBackup['classList'][_0x9ce211(0x1f7)](_0x9ce211(0x1ec)),dropboxCloud[_0x9ce211(0x231)][_0x9ce211(0x1f7)](_0x9ce211(0x1ec)));}),handleDropboxCallback();});