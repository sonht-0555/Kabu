var a0_0xa23c3b=a0_0x352e;(function(_0x1281b5,_0xda42d8){var _0x5e7146=a0_0x352e,_0x352315=_0x1281b5();while(!![]){try{var _0x5191d7=parseInt(_0x5e7146(0xf9))/0x1*(parseInt(_0x5e7146(0xea))/0x2)+-parseInt(_0x5e7146(0x114))/0x3*(parseInt(_0x5e7146(0x117))/0x4)+-parseInt(_0x5e7146(0x108))/0x5+-parseInt(_0x5e7146(0xfa))/0x6*(parseInt(_0x5e7146(0x139))/0x7)+parseInt(_0x5e7146(0x13e))/0x8+parseInt(_0x5e7146(0x116))/0x9*(-parseInt(_0x5e7146(0x12b))/0xa)+-parseInt(_0x5e7146(0x12c))/0xb*(-parseInt(_0x5e7146(0x121))/0xc);if(_0x5191d7===_0xda42d8)break;else _0x352315['push'](_0x352315['shift']());}catch(_0x49539b){_0x352315['push'](_0x352315['shift']());}}}(a0_0x6d07,0xd3f33));import*as a0_0x42819e from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0xa23c3b(0xe4);function authorizeWithDropbox(){var _0x266a2e=a0_0xa23c3b,_0x5f3316=window[_0x266a2e(0x122)][_0x266a2e(0x106)][_0x266a2e(0xeb)]('?')[0x0],_0x3d8845='code',_0x37d9cb=_0x266a2e(0x12f),_0x3f8ea9=_0x266a2e(0x13a)+clientId+_0x266a2e(0xed)+_0x3d8845+_0x266a2e(0xf1)+_0x37d9cb+'&redirect_uri='+encodeURIComponent(_0x5f3316);window[_0x266a2e(0x122)][_0x266a2e(0x106)]=_0x3f8ea9;}function handleDropboxCallback(){var _0x1cd24f=a0_0xa23c3b,_0x2ffcb3=getUrlParameter('code');_0x2ffcb3?(getAccessToken(_0x2ffcb3),console[_0x1cd24f(0x111)]('Authorization\x20Code:',_0x2ffcb3)):console[_0x1cd24f(0x111)](_0x1cd24f(0x104));}function getUrlParameter(_0x4758c2){var _0x56d591=a0_0xa23c3b;_0x4758c2=_0x4758c2[_0x56d591(0x147)](/[\[]/,'\x5c[')[_0x56d591(0x147)](/[\]]/,'\x5c]');var _0x427f44=new RegExp(_0x56d591(0x137)+_0x4758c2+'=([^&#]*)'),_0x295e95=_0x427f44[_0x56d591(0x103)](location['search']);return _0x295e95===null?'':decodeURIComponent(_0x295e95[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x9daea2){var _0x2dbed0=a0_0xa23c3b,_0x53b36c=_0x2dbed0(0x11c),_0x1ff4f0=window[_0x2dbed0(0x122)][_0x2dbed0(0x106)][_0x2dbed0(0xeb)]('?')[0x0],_0x93f38b=new XMLHttpRequest();_0x93f38b[_0x2dbed0(0xf0)]('POST',_0x2dbed0(0xfd)),_0x93f38b['setRequestHeader'](_0x2dbed0(0x11b),'application/x-www-form-urlencoded'),_0x93f38b[_0x2dbed0(0x102)]=function(){var _0x1c8c1c=_0x2dbed0;if(_0x93f38b[_0x1c8c1c(0x123)]===0xc8){var _0x1a9789=JSON[_0x1c8c1c(0x143)](_0x93f38b[_0x1c8c1c(0x118)]),_0x327db9=_0x1a9789[_0x1c8c1c(0xff)],_0x175893=_0x1a9789[_0x1c8c1c(0x138)],_0x4687e3=_0x1a9789[_0x1c8c1c(0x126)];localStorage[_0x1c8c1c(0xfe)](_0x1c8c1c(0x115),_0x327db9),localStorage[_0x1c8c1c(0xfe)](_0x1c8c1c(0x149),_0x175893),localStorage[_0x1c8c1c(0xfe)]('uId',_0x4687e3);}else console['log'](_0x1c8c1c(0x11e));},_0x93f38b[_0x2dbed0(0xe5)]('code='+_0x9daea2+'&grant_type='+_0x53b36c+_0x2dbed0(0x10d)+clientId+_0x2dbed0(0xef)+clientSecret+_0x2dbed0(0xe3)+encodeURIComponent(_0x1ff4f0));}export async function dpCreateFolder(_0x219120){var _0x2ced8e=a0_0xa23c3b;const _0x1b4c3a=localStorage['getItem'](_0x2ced8e(0x132));let _0x47a30f=localStorage['getItem'](_0x2ced8e(0x115));const _0x349113='/'+_0x1b4c3a+'/'+_0x219120,_0x40497e=JSON['stringify']({'path':_0x349113,'autorename':![]});for(let _0x4aac4f=0x0;_0x4aac4f<0x2;_0x4aac4f++){try{const _0xd7b61a=await fetch(_0x2ced8e(0x10e),{'method':_0x2ced8e(0xec),'headers':{'Authorization':_0x2ced8e(0xf2)+_0x47a30f,'Content-Type':'application/json'},'body':_0x40497e});if(_0xd7b61a[_0x2ced8e(0x123)]===0x191){const _0x199c07=await dpRefreshToken();if(!_0x199c07)throw new Error(_0x2ced8e(0xf5));_0x47a30f=localStorage[_0x2ced8e(0x129)](_0x2ced8e(0x115));continue;}if(_0xd7b61a['status']===0x199)return{'message':_0x2ced8e(0xf6),'path':_0x219120};if(!_0xd7b61a['ok'])throw new Error(_0x2ced8e(0x13f)+_0x219120);const _0x4cd447=await _0xd7b61a[_0x2ced8e(0x109)]();return await lockNoti(_0x2ced8e(0xf8),'',0xbb8),_0x4cd447;}catch(_0x219afe){if(_0x4aac4f===0x1)throw _0x219afe;}}return![];}export async function dpRefreshToken(){var _0x506365=a0_0xa23c3b;if(!localStorage['getItem'](_0x506365(0x149)))throw _0x506365(0x112);try{const _0x412165=await fetch(_0x506365(0x144),{'method':'POST','headers':{'Content-Type':_0x506365(0x142)},'body':_0x506365(0xf3)+localStorage[_0x506365(0x129)](_0x506365(0x149))+_0x506365(0x12e)}),_0x3407d6=await _0x412165[_0x506365(0x109)]();if(!_0x3407d6[_0x506365(0xe8)])return localStorage[_0x506365(0xfe)]('accessToken',_0x3407d6[_0x506365(0xff)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x3407d6[_0x506365(0x135)]||_0x506365(0x11a));}catch(_0x34ae99){console[_0x506365(0xe8)](_0x506365(0x134),_0x34ae99);}return![];}function a0_0x6d07(){var _0x5a5000=['refresh_token','2933cOEsJB','https://www.dropbox.com/oauth2/authorize?client_id=','Failed\x20to\x20upload\x20file\x20','Restore\x20canceled\x20by\x20user.','classList','9377856nhIXBB','Error\x20creating\x20folder\x20','folder','remove','application/x-www-form-urlencoded','parse','https://api.dropboxapi.com/oauth2/token','uploadFileInCloud','Do\x20you\x20want\x20to\x20backup\x20','replace','entries','refreshToken','&redirect_uri=','nwb3dnfh09rhs31','send','confirm','screenshot','error','No\x20files\x20found\x20to\x20restore.','135138DhgCkk','split','POST','&response_type=','Cloud\x20login\x20required!','&client_secret=','open','&token_access_type=','Bearer\x20','refresh_token=','/data/','Unable\x20to\x20refresh\x20token','Folder\x20already\x20exists','Kabu\x20storage\x20↦\x20Cloud\x20◆','Folder\x20created','13NiTLGC','17214USQLSr','Restoring...','application/json','https://api.dropbox.com/oauth2/token','setItem','access_token','DOMContentLoaded','Do\x20you\x20want\x20to\x20restore\x20','onload','exec','Do\x20not\x20receive\x20authorization','click','href','active','3240485zPBRjQ','json','filter','Cloud\x20↦\x20Kabu\x20storage\x20◆','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&client_id=','https://api.dropboxapi.com/2/files/create_folder_v2','name','length','log','No\x20refresh\x20token','Backing\x20up...','15wWxkXN','accessToken','19026ZoXQME','128060IsCIlU','responseText','listFiles','Failed\x20to\x20refresh\x20Dropbox\x20token.','Content-Type','authorization_code','alert','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','state','application/octet-stream','19212PViAzl','location','status','\x20files\x20in\x20Kabu?','blob','uid','file','push','getItem','stringify','1590fsfFcx','7997prttYy','https://api.dropboxapi.com/2/files/list_folder','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','offline','addEventListener','save','uId','\x20files\x20from\x20Cloud?','Error\x20while\x20refreshing\x20token:','error_description','Download\x20failed,\x20unknown\x20http\x20status:','[\x5c?&#]'];a0_0x6d07=function(){return _0x5a5000;};return a0_0x6d07();}export async function dpUploadFile(_0x156494,_0x3146d6,_0xf2345){var _0x1bc4b1=a0_0xa23c3b;const _0x5786ff=localStorage[_0x1bc4b1(0x129)]('uId');var _0x5561cd=JSON[_0x1bc4b1(0x12a)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x5786ff+'/'+_0xf2345+'/'+_0x156494}),_0x44626f=new Blob([_0x3146d6],{'type':_0x1bc4b1(0x120)});for(var _0x1b27da=0x0;_0x1b27da<0x2;_0x1b27da++){var _0x53c295=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x1bc4b1(0xf2)+localStorage[_0x1bc4b1(0x129)]('accessToken'),'Dropbox-API-Arg':_0x5561cd,'Content-Type':'application/octet-stream'},'body':_0x44626f});if(_0x53c295[_0x1bc4b1(0x123)]!=0xc8){if(_0x53c295['status']==0x191){var _0x170961=await dpRefreshToken();if(!_0x170961)throw _0x1bc4b1(0xf5);continue;}else throw _0x1bc4b1(0x10c)+_0x53c295['status'];}else{var _0x5070e9=await _0x53c295[_0x1bc4b1(0x109)]();return console[_0x1bc4b1(0x111)](_0x1bc4b1(0xf7),_0x156494),_0x5070e9;}}return![];}function a0_0x352e(_0xc211ae,_0x2c1278){var _0x6d07de=a0_0x6d07();return a0_0x352e=function(_0x352e1d,_0x5c60df){_0x352e1d=_0x352e1d-0xe3;var _0x3188fd=_0x6d07de[_0x352e1d];return _0x3188fd;},a0_0x352e(_0xc211ae,_0x2c1278);}export async function dpDownloadFile(_0x5bee72,_0x20c072){var _0x4351fe=a0_0xa23c3b;const _0x220315=localStorage[_0x4351fe(0x129)]('uId');var _0xf936e1=JSON[_0x4351fe(0x12a)]({'path':'/'+_0x220315+'/'+_0x20c072+'/'+_0x5bee72});for(var _0x5a097b=0x0;_0x5a097b<0x2;_0x5a097b++){var _0x504b35=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x4351fe(0xec),'headers':{'Authorization':_0x4351fe(0xf2)+localStorage[_0x4351fe(0x129)](_0x4351fe(0x115)),'Dropbox-API-Arg':_0xf936e1}});if(_0x504b35['status']!=0xc8){if(_0x504b35[_0x4351fe(0x123)]==0x191){var _0x1f22d8=await dpRefreshToken();if(!_0x1f22d8)throw _0x4351fe(0xf5);continue;}else throw _0x4351fe(0x136)+_0x504b35[_0x4351fe(0x123)];}const _0x636908=new File([await _0x504b35[_0x4351fe(0x125)]()],_0x5bee72);return console[_0x4351fe(0x111)](_0x4351fe(0x10b),_0x636908[_0x4351fe(0x10f)]),a0_0x42819e[_0x4351fe(0x145)](_0x636908,()=>{}),_0x636908;}return![];}document[a0_0xa23c3b(0x130)](a0_0xa23c3b(0x100),function(){var _0x51fe2e=a0_0xa23c3b;dropboxRestore[_0x51fe2e(0x130)](_0x51fe2e(0x105),async function(){var _0x3236c2=_0x51fe2e;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x306294=localStorage[_0x3236c2(0x129)](_0x3236c2(0x132)),_0x2fa0b6=[_0x3236c2(0x11f),_0x3236c2(0x131),_0x3236c2(0xe7)];if(!_0x306294){window[_0x3236c2(0x11d)](_0x3236c2(0xee));return;}let _0x2d1180=[];for(const _0x1fcf97 of _0x2fa0b6){let _0xe01f0={'path':'/'+_0x306294+'/'+_0x1fcf97};for(let _0x2f62b9=0x0;_0x2f62b9<0x2;_0x2f62b9++){let _0x46599a=await fetch(_0x3236c2(0x12d),{'method':_0x3236c2(0xec),'headers':{'Authorization':_0x3236c2(0xf2)+localStorage['getItem'](_0x3236c2(0x115)),'Content-Type':_0x3236c2(0xfc)},'body':JSON[_0x3236c2(0x12a)](_0xe01f0)});if(_0x46599a['status']===0xc8){let _0x1eea2e=await _0x46599a[_0x3236c2(0x109)](),_0x33dd89=_0x1eea2e[_0x3236c2(0x148)][_0x3236c2(0x10a)](_0xab3a09=>_0xab3a09['.tag']===_0x3236c2(0x127));_0x33dd89['length']>0x0&&_0x2d1180[_0x3236c2(0x128)](..._0x33dd89['map'](_0x37bca1=>({'name':_0x37bca1[_0x3236c2(0x10f)],'folder':_0x1fcf97})));break;}else{if(_0x46599a[_0x3236c2(0x123)]===0x191){let _0x2292b7=await dpRefreshToken();if(!_0x2292b7)throw _0x3236c2(0xf5);}else{console[_0x3236c2(0xe8)]('Download\x20failed\x20for\x20'+_0x1fcf97+',\x20status:\x20'+_0x46599a[_0x3236c2(0x123)]);break;}}}}if(_0x2d1180['length']>0x0){const _0xa4d526=_0x3236c2(0x101)+_0x2d1180['length']+_0x3236c2(0x133);if(window[_0x3236c2(0xe6)](_0xa4d526))for(const _0x380d45 of _0x2d1180){await lockNoti(_0x3236c2(0xfb),_0x380d45[_0x3236c2(0x10f)],0xbb8),await dpDownloadFile(_0x380d45[_0x3236c2(0x10f)],_0x380d45[_0x3236c2(0x140)]);}else console[_0x3236c2(0x111)](_0x3236c2(0x13c));}else console[_0x3236c2(0x111)](_0x3236c2(0xe9));}),dropboxBackup[_0x51fe2e(0x130)](_0x51fe2e(0x105),async function(){var _0x2b9b34=_0x51fe2e;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0xc19de8=localStorage[_0x2b9b34(0x129)](_0x2b9b34(0x132));if(_0xc19de8===null||_0xc19de8==='')window[_0x2b9b34(0x11d)](_0x2b9b34(0xee));else{const _0x4b667e=['state',_0x2b9b34(0x131),'screenshot'];for(const _0x1fe15b of _0x4b667e){await dpCreateFolder(_0x1fe15b);}let _0xca6912=0x0;for(const _0x4c344e of _0x4b667e){const _0x50bac7=a0_0x42819e['listFiles'](_0x4c344e+'s');_0xca6912+=_0x50bac7[_0x2b9b34(0x110)];}if(window[_0x2b9b34(0xe6)](_0x2b9b34(0x146)+_0xca6912+_0x2b9b34(0x124)))for(const _0x19a98e of _0x4b667e){const _0x4e6826=a0_0x42819e[_0x2b9b34(0x119)](_0x19a98e+'s');for(const _0x184dd2 of _0x4e6826){const _0x263bc4=await a0_0x42819e['downloadFileInCloud'](_0x2b9b34(0xf4)+_0x19a98e+'s/'+_0x184dd2);try{await lockNoti(_0x2b9b34(0x113),_0x184dd2,0xbb8),await dpUploadFile(_0x184dd2,_0x263bc4,_0x19a98e);}catch(_0x412c1e){console[_0x2b9b34(0xe8)](_0x2b9b34(0x13b)+_0x184dd2+':',_0x412c1e);}}}else console['log'](_0x2b9b34(0x13c));}}),dropboxCloud[_0x51fe2e(0x130)]('click',function(){var _0x393dd2=_0x51fe2e;const _0x57a010=localStorage[_0x393dd2(0x129)](_0x393dd2(0x132));_0x57a010===null||_0x57a010===''?authorizeWithDropbox():window[_0x393dd2(0xe6)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x393dd2(0xfe)]('uId',''),dropboxRestore[_0x393dd2(0x13d)][_0x393dd2(0x141)]('active'),dropboxBackup[_0x393dd2(0x13d)][_0x393dd2(0x141)](_0x393dd2(0x107)),dropboxCloud[_0x393dd2(0x13d)][_0x393dd2(0x141)](_0x393dd2(0x107)));}),handleDropboxCallback();});