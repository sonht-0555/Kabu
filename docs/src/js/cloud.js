var a0_0x41d26f=a0_0x549e;(function(_0x4e649e,_0x4eaf21){var _0x5e2569=a0_0x549e,_0x37a2ac=_0x4e649e();while(!![]){try{var _0x348b5f=-parseInt(_0x5e2569(0x180))/0x1+parseInt(_0x5e2569(0x17d))/0x2*(-parseInt(_0x5e2569(0x139))/0x3)+parseInt(_0x5e2569(0x147))/0x4*(parseInt(_0x5e2569(0x133))/0x5)+-parseInt(_0x5e2569(0x132))/0x6*(-parseInt(_0x5e2569(0x183))/0x7)+parseInt(_0x5e2569(0x127))/0x8+parseInt(_0x5e2569(0x170))/0x9+-parseInt(_0x5e2569(0x18d))/0xa*(parseInt(_0x5e2569(0x146))/0xb);if(_0x348b5f===_0x4eaf21)break;else _0x37a2ac['push'](_0x37a2ac['shift']());}catch(_0x45426f){_0x37a2ac['push'](_0x37a2ac['shift']());}}}(a0_0x5625,0x53d12));import*as a0_0x215afc from'./main.js';function a0_0x5625(){var _0x4bd7e9=['[\x5c?&#]','18258MEbfjX','25mHEKRT','search','push','Do\x20you\x20want\x20to\x20backup\x20','confirm','=([^&#]*)','7932isAnxv','screenshot','entries','Refreshing\x20token...','getItem','DOMContentLoaded','save',',\x20status:\x20','setRequestHeader','remove','Do\x20you\x20want\x20to\x20restore\x20','https://api.dropboxapi.com/oauth2/token','No\x20refresh\x20token','11275066SmUsGs','529788VXjfbF','overwrite','Authorization\x20Code:','uploadFileInCloud','parse','application/json','href','charAt','uid','Cloud\x20login\x20required!','split','\x20files\x20from\x20Cloud?','stringify','application/x-www-form-urlencoded','status','code=','length','setItem','blob','access_token','json','location','addEventListener','uId','POST','onload','Do\x20not\x20receive\x20authorization','FSSync','https://api.dropbox.com/oauth2/token','&token_access_type=','Cloud\x20↦\x20Kabu\x20storage\x20◆','Wait\x20a\x20little\x20bit...','error_description','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','active','offline','click','open','list','&client_id=','refresh_token','5781087GcEqHT','map','exec','Folder\x20created','https://content.dropboxapi.com/2/files/download','authorization_code','No\x20files\x20found\x20to\x20restore.','filter','name','application/octet-stream','code','knh3uz2mx2hp2eu','.tag','98nIZKys','send','https://www.dropbox.com/oauth2/authorize?client_id=','437852OnjfKI','Folder\x20already\x20exists','slice','1113hzqIco','https://api.dropboxapi.com/2/files/list_folder','toUpperCase','accessToken','Failed\x20to\x20upload\x20file\x20','alert','&redirect_uri=','Bearer\x20','Content-Type','Backing\x20up...','10xNHfrs','error','classList','replace','1178504ejytap','/data/','responseText','Do\x20you\x20want\x20to\x20logout?','state','Unable\x20to\x20refresh\x20token','https://api.dropboxapi.com/2/files/create_folder_v2','log','refreshToken','Download\x20failed,\x20unknown\x20http\x20status:'];a0_0x5625=function(){return _0x4bd7e9;};return a0_0x5625();}import{localStorageFile}from'./storage.js';var clientId=a0_0x41d26f(0x17b),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4512c0=a0_0x41d26f,_0x730734=window[_0x4512c0(0x15c)][_0x4512c0(0x14d)][_0x4512c0(0x151)]('?')[0x0],_0x4deec9=_0x4512c0(0x17a),_0x53147b=_0x4512c0(0x16a),_0x21fd9f=_0x4512c0(0x17f)+clientId+'&response_type='+_0x4deec9+_0x4512c0(0x164)+_0x53147b+_0x4512c0(0x189)+encodeURIComponent(_0x730734);window[_0x4512c0(0x15c)][_0x4512c0(0x14d)]=_0x21fd9f;}function a0_0x549e(_0x26f07a,_0x30b724){var _0x5625d7=a0_0x5625();return a0_0x549e=function(_0x549e61,_0x3e3276){_0x549e61=_0x549e61-0x124;var _0x55175a=_0x5625d7[_0x549e61];return _0x55175a;},a0_0x549e(_0x26f07a,_0x30b724);}function handleDropboxCallback(){var _0x24c975=a0_0x41d26f,_0x282f5a=getUrlParameter(_0x24c975(0x17a));_0x282f5a?(getAccessToken(_0x282f5a),console[_0x24c975(0x12e)](_0x24c975(0x149),_0x282f5a)):console[_0x24c975(0x12e)](_0x24c975(0x161));}function getUrlParameter(_0x3c5497){var _0x1648b6=a0_0x41d26f;_0x3c5497=_0x3c5497[_0x1648b6(0x126)](/[\[]/,'\x5c[')[_0x1648b6(0x126)](/[\]]/,'\x5c]');var _0x1c49a2=new RegExp(_0x1648b6(0x131)+_0x3c5497+_0x1648b6(0x138)),_0x3eaf41=_0x1c49a2[_0x1648b6(0x172)](location[_0x1648b6(0x134)]);return _0x3eaf41===null?'':decodeURIComponent(_0x3eaf41[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x19390d){var _0x1c977d=a0_0x41d26f,_0x18b1f4=_0x1c977d(0x175),_0x93d1bc=window[_0x1c977d(0x15c)][_0x1c977d(0x14d)][_0x1c977d(0x151)]('?')[0x0],_0x1b8cc9=new XMLHttpRequest();_0x1b8cc9[_0x1c977d(0x16c)](_0x1c977d(0x15f),_0x1c977d(0x163)),_0x1b8cc9[_0x1c977d(0x141)](_0x1c977d(0x18b),_0x1c977d(0x154)),_0x1b8cc9[_0x1c977d(0x160)]=function(){var _0x54fd0d=_0x1c977d;if(_0x1b8cc9[_0x54fd0d(0x155)]===0xc8){var _0x22ccc9=JSON[_0x54fd0d(0x14b)](_0x1b8cc9[_0x54fd0d(0x129)]),_0x337620=_0x22ccc9[_0x54fd0d(0x15a)],_0xd828e3=_0x22ccc9[_0x54fd0d(0x16f)],_0x525cfb=_0x22ccc9[_0x54fd0d(0x14f)];localStorage[_0x54fd0d(0x158)](_0x54fd0d(0x186),_0x337620),localStorage[_0x54fd0d(0x158)](_0x54fd0d(0x12f),_0xd828e3),localStorage[_0x54fd0d(0x158)]('uId',_0x525cfb);}else console[_0x54fd0d(0x12e)](_0x54fd0d(0x168));},_0x1b8cc9[_0x1c977d(0x17e)](_0x1c977d(0x156)+_0x19390d+'&grant_type='+_0x18b1f4+_0x1c977d(0x16e)+clientId+'&client_secret='+clientSecret+_0x1c977d(0x189)+encodeURIComponent(_0x93d1bc));}export async function dpCreateFolder(_0x45e051){var _0x4b664d=a0_0x41d26f;const _0x2f1607=localStorage['getItem'](_0x4b664d(0x15e));let _0x56a6db=localStorage[_0x4b664d(0x13d)](_0x4b664d(0x186));const _0x51742a='/'+_0x2f1607+'/'+_0x45e051,_0x329e2e=JSON['stringify']({'path':_0x51742a,'autorename':![]});for(let _0xab43f6=0x0;_0xab43f6<0x2;_0xab43f6++){try{const _0x52f78d=await fetch(_0x4b664d(0x12d),{'method':'POST','headers':{'Authorization':_0x4b664d(0x18a)+_0x56a6db,'Content-Type':_0x4b664d(0x14c)},'body':_0x329e2e});if(_0x52f78d[_0x4b664d(0x155)]===0x191){const _0x408752=await dpRefreshToken();if(!_0x408752)throw new Error('Unable\x20to\x20refresh\x20token');_0x56a6db=localStorage[_0x4b664d(0x13d)](_0x4b664d(0x186));continue;}if(_0x52f78d[_0x4b664d(0x155)]===0x199)return{'message':_0x4b664d(0x181),'path':_0x45e051};if(!_0x52f78d['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x45e051);const _0x47db75=await _0x52f78d[_0x4b664d(0x15b)]();return await lockNoti(_0x4b664d(0x173),'',0xbb8),_0x47db75;}catch(_0x7e733f){if(_0xab43f6===0x1)throw _0x7e733f;}}return![];}export async function dpRefreshToken(){var _0x25d2f8=a0_0x41d26f;if(!localStorage[_0x25d2f8(0x13d)](_0x25d2f8(0x12f)))throw _0x25d2f8(0x145);try{const _0x4ed03c=await fetch(_0x25d2f8(0x144),{'method':_0x25d2f8(0x15f),'headers':{'Content-Type':_0x25d2f8(0x154)},'body':'refresh_token='+localStorage[_0x25d2f8(0x13d)](_0x25d2f8(0x12f))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x58e5bb=await _0x4ed03c[_0x25d2f8(0x15b)]();if(!_0x58e5bb[_0x25d2f8(0x124)])return localStorage[_0x25d2f8(0x158)](_0x25d2f8(0x186),_0x58e5bb[_0x25d2f8(0x15a)]),await lockNoti('',_0x25d2f8(0x13c),0xbb8),await delay(0x3e8),!![];else alert(_0x58e5bb[_0x25d2f8(0x167)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x535c65){console['error']('Error\x20while\x20refreshing\x20token:',_0x535c65);}return![];}export async function dpUploadFile(_0x3ec025,_0x4e2ee8,_0x376ba7){var _0x393b5c=a0_0x41d26f;const _0x7097bc=localStorage[_0x393b5c(0x13d)](_0x393b5c(0x15e));var _0x108711=JSON[_0x393b5c(0x153)]({'autorename':!![],'mode':_0x393b5c(0x148),'mute':!![],'strict_conflict':![],'path':'/'+_0x7097bc+'/'+_0x376ba7+'/'+_0x3ec025}),_0x4d4e5a=new Blob([_0x4e2ee8],{'type':_0x393b5c(0x179)});for(var _0xe07317=0x0;_0xe07317<0x2;_0xe07317++){var _0x12834a=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x393b5c(0x15f),'headers':{'Authorization':_0x393b5c(0x18a)+localStorage['getItem'](_0x393b5c(0x186)),'Dropbox-API-Arg':_0x108711,'Content-Type':'application/octet-stream'},'body':_0x4d4e5a});if(_0x12834a[_0x393b5c(0x155)]!=0xc8){if(_0x12834a[_0x393b5c(0x155)]==0x191){var _0x27eb68=await dpRefreshToken();if(!_0x27eb68)throw _0x393b5c(0x12c);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x12834a['status'];}else{var _0x430593=await _0x12834a[_0x393b5c(0x15b)]();return console[_0x393b5c(0x12e)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x3ec025),_0x430593;}}return![];}export async function dpDownloadFile(_0x4ccb4a,_0x46bb70){var _0x4108ee=a0_0x41d26f;const _0x3ebb49=localStorage[_0x4108ee(0x13d)](_0x4108ee(0x15e));var _0x16cd0a=JSON['stringify']({'path':'/'+_0x3ebb49+'/'+_0x46bb70+'/'+_0x4ccb4a});for(var _0x1c5b42=0x0;_0x1c5b42<0x2;_0x1c5b42++){var _0x3df2ad=await fetch(_0x4108ee(0x174),{'method':_0x4108ee(0x15f),'headers':{'Authorization':_0x4108ee(0x18a)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x16cd0a}});if(_0x3df2ad[_0x4108ee(0x155)]!=0xc8){if(_0x3df2ad[_0x4108ee(0x155)]==0x191){var _0x24ded7=await dpRefreshToken();if(!_0x24ded7)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4108ee(0x130)+_0x3df2ad[_0x4108ee(0x155)];}const _0x2ee5d4=new File([await _0x3df2ad[_0x4108ee(0x159)]()],_0x4ccb4a);return console[_0x4108ee(0x12e)](_0x4108ee(0x165),_0x2ee5d4['name']),a0_0x215afc[_0x4108ee(0x14a)](_0x2ee5d4,()=>{var _0x2a43f3=_0x4108ee;localStorageFile(),Module[_0x2a43f3(0x162)]();}),_0x2ee5d4;}return![];}document[a0_0x41d26f(0x15d)](a0_0x41d26f(0x13e),function(){var _0xa7aaaf=a0_0x41d26f;dropboxRestore['addEventListener'](_0xa7aaaf(0x16b),async function(){var _0x2fe44a=_0xa7aaaf;await lockNoti(_0x2fe44a(0x166),'',0x1388);const _0x30021c=localStorage[_0x2fe44a(0x13d)]('uId'),_0x5424c4=[_0x2fe44a(0x12b),_0x2fe44a(0x13f),_0x2fe44a(0x13a)];if(!_0x30021c){window[_0x2fe44a(0x188)](_0x2fe44a(0x150));return;}let _0x3367a6=[];for(const _0x320930 of _0x5424c4){let _0x368fc8={'path':'/'+_0x30021c+'/'+_0x320930};for(let _0xedfbdf=0x0;_0xedfbdf<0x2;_0xedfbdf++){let _0x15498b=await fetch(_0x2fe44a(0x184),{'method':_0x2fe44a(0x15f),'headers':{'Authorization':_0x2fe44a(0x18a)+localStorage[_0x2fe44a(0x13d)](_0x2fe44a(0x186)),'Content-Type':'application/json'},'body':JSON[_0x2fe44a(0x153)](_0x368fc8)});if(_0x15498b['status']===0xc8){let _0x292001=await _0x15498b[_0x2fe44a(0x15b)](),_0x500901=_0x292001[_0x2fe44a(0x13b)][_0x2fe44a(0x177)](_0x3fc411=>_0x3fc411[_0x2fe44a(0x17c)]==='file');_0x500901[_0x2fe44a(0x157)]>0x0&&_0x3367a6[_0x2fe44a(0x135)](..._0x500901[_0x2fe44a(0x171)](_0x5884bf=>({'name':_0x5884bf['name'],'folder':_0x320930})));break;}else{if(_0x15498b[_0x2fe44a(0x155)]===0x191){let _0x5efca9=await dpRefreshToken();if(!_0x5efca9)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x2fe44a(0x124)]('Download\x20failed\x20for\x20'+_0x320930+_0x2fe44a(0x140)+_0x15498b[_0x2fe44a(0x155)]);break;}}}}if(_0x3367a6[_0x2fe44a(0x157)]>0x0){const _0x551dc1=_0x2fe44a(0x143)+_0x3367a6[_0x2fe44a(0x157)]+_0x2fe44a(0x152);if(window[_0x2fe44a(0x137)](_0x551dc1))for(const _0x28cb69 of _0x3367a6){await lockNoti('Restoring...',_0x28cb69[_0x2fe44a(0x178)],0xbb8),await dpDownloadFile(_0x28cb69[_0x2fe44a(0x178)],_0x28cb69['folder']);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console['log'](_0x2fe44a(0x176));}),dropboxBackup[_0xa7aaaf(0x15d)](_0xa7aaaf(0x16b),async function(){var _0xacbfbb=_0xa7aaaf;await lockNoti(_0xacbfbb(0x166),'',0x1388);const _0x41af82=localStorage[_0xacbfbb(0x13d)]('uId');if(_0x41af82===null||_0x41af82==='')window['alert'](_0xacbfbb(0x150));else{const _0x43805e=[_0xacbfbb(0x12b),_0xacbfbb(0x13f),_0xacbfbb(0x13a)];for(const _0x8f96ca of _0x43805e){await dpCreateFolder(_0x8f96ca);}let _0x1c5d3d=0x0;for(const _0x5e7b7f of _0x43805e){const _0x318b00=a0_0x215afc[_0xacbfbb(0x16d)+(_0x5e7b7f[_0xacbfbb(0x14e)](0x0)[_0xacbfbb(0x185)]()+_0x5e7b7f[_0xacbfbb(0x182)](0x1))]();_0x1c5d3d+=_0x318b00[_0xacbfbb(0x157)];}if(window[_0xacbfbb(0x137)](_0xacbfbb(0x136)+_0x1c5d3d+'\x20files\x20in\x20Kabu?'))for(const _0x27d4bd of _0x43805e){const _0x2df27c=a0_0x215afc[_0xacbfbb(0x16d)+(_0x27d4bd[_0xacbfbb(0x14e)](0x0)['toUpperCase']()+_0x27d4bd['slice'](0x1))]();for(const _0x419f52 of _0x2df27c){const _0x1f4511=await a0_0x215afc['downloadFileInCloud'](_0xacbfbb(0x128)+_0x27d4bd+'s/'+_0x419f52);try{await lockNoti(_0xacbfbb(0x18c),_0x419f52,0xbb8),await dpUploadFile(_0x419f52,_0x1f4511,_0x27d4bd);}catch(_0x529d76){console[_0xacbfbb(0x124)](_0xacbfbb(0x187)+_0x419f52+':',_0x529d76);}}}else console[_0xacbfbb(0x12e)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener'](_0xa7aaaf(0x16b),function(){var _0x65f58=_0xa7aaaf;const _0x1bf26a=localStorage[_0x65f58(0x13d)]('uId');_0x1bf26a===null||_0x1bf26a===''?authorizeWithDropbox():window[_0x65f58(0x137)](_0x65f58(0x12a))&&(localStorage['setItem'](_0x65f58(0x15e),''),dropboxRestore[_0x65f58(0x125)][_0x65f58(0x142)](_0x65f58(0x169)),dropboxBackup['classList']['remove']('active'),dropboxCloud[_0x65f58(0x125)]['remove']('active'));}),handleDropboxCallback();});