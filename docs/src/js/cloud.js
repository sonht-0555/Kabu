var a0_0x5a5cd0=a0_0x2ad0;(function(_0x1c7721,_0xb77322){var _0x5ef666=a0_0x2ad0,_0x475159=_0x1c7721();while(!![]){try{var _0x44b25b=parseInt(_0x5ef666(0xa7))/0x1+parseInt(_0x5ef666(0x101))/0x2*(-parseInt(_0x5ef666(0xf4))/0x3)+parseInt(_0x5ef666(0xc0))/0x4*(-parseInt(_0x5ef666(0xc9))/0x5)+parseInt(_0x5ef666(0xcf))/0x6+-parseInt(_0x5ef666(0xfa))/0x7*(-parseInt(_0x5ef666(0xe7))/0x8)+-parseInt(_0x5ef666(0xfd))/0x9+-parseInt(_0x5ef666(0xcd))/0xa*(-parseInt(_0x5ef666(0xd6))/0xb);if(_0x44b25b===_0xb77322)break;else _0x475159['push'](_0x475159['shift']());}catch(_0x408a49){_0x475159['push'](_0x475159['shift']());}}}(a0_0x4285,0xa1eaa));import*as a0_0x2467ba from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5a5cd0(0xf3),clientSecret=a0_0x5a5cd0(0xce);function authorizeWithDropbox(){var _0x1217e7=a0_0x5a5cd0,_0x2db6be=window[_0x1217e7(0xed)][_0x1217e7(0xf6)][_0x1217e7(0xec)]('?')[0x0],_0x48bee8=_0x1217e7(0xaf),_0x17013e=_0x1217e7(0xbb),_0xcfed03='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x1217e7(0xe0)+_0x48bee8+'&token_access_type='+_0x17013e+_0x1217e7(0x106)+encodeURIComponent(_0x2db6be);window[_0x1217e7(0xed)]['href']=_0xcfed03;}function a0_0x4285(){var _0x1d042e=['click','refreshToken','&redirect_uri=','exec','https://api.dropbox.com/oauth2/token','stringify','uid','848755YymelY','error','Bearer\x20','Folder\x20created','\x20files\x20in\x20Kabu?','filter','send','status','code','Failed\x20to\x20upload\x20file\x20','&client_secret=',',\x20status:\x20','overwrite','refresh_token=','Do\x20you\x20want\x20to\x20logout?','json','Error\x20creating\x20folder\x20','Error\x20while\x20refreshing\x20token:','&client_id=','https://content.dropboxapi.com/2/files/upload','offline','classList','confirm','Wait\x20a\x20little\x20bit...','&grant_type=','76pejner','\x20files\x20from\x20Cloud?','active','Failed\x20to\x20refresh\x20Dropbox\x20token.','Do\x20you\x20want\x20to\x20backup\x20','accessToken','replace','DOMContentLoaded','blob','279575gkhfPy','=([^&#]*)','map','state','188470tcDHgH','nwb3dnfh09rhs31','4879356EDlZzT','search','application/json','error_description','setItem','Content-Type','No\x20files\x20found\x20to\x20restore.','374YOyPcP','remove','application/x-www-form-urlencoded','screenshot','open','Do\x20you\x20want\x20to\x20restore\x20','Cloud\x20↦\x20Kabu\x20storage\x20◆','uId','POST','name','&response_type=','save','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Cloud\x20login\x20required!','getItem','uploadFileInCloud','https://api.dropboxapi.com/2/files/create_folder_v2','123800iqHSJa','https://api.dropboxapi.com/2/files/list_folder','Restore\x20canceled\x20by\x20user.','.tag','addEventListener','split','location','Do\x20not\x20receive\x20authorization','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Download\x20failed\x20for\x20','Backing\x20up...','setRequestHeader','knh3uz2mx2hp2eu','18wkOmNY','application/octet-stream','href','Unable\x20to\x20refresh\x20token','[\x5c?&#]','folder','245wecpyP','refresh_token','alert','6454035XXOzdC','parse','length','file','133898oUPdYu','access_token','log'];a0_0x4285=function(){return _0x1d042e;};return a0_0x4285();}function handleDropboxCallback(){var _0x34538c=a0_0x5a5cd0,_0x519b09=getUrlParameter(_0x34538c(0xaf));_0x519b09?(getAccessToken(_0x519b09),console[_0x34538c(0x103)]('Authorization\x20Code:',_0x519b09)):console[_0x34538c(0x103)](_0x34538c(0xee));}function getUrlParameter(_0x5e1112){var _0x23b27a=a0_0x5a5cd0;_0x5e1112=_0x5e1112[_0x23b27a(0xc6)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x1e853b=new RegExp(_0x23b27a(0xf8)+_0x5e1112+_0x23b27a(0xca)),_0x3da91b=_0x1e853b[_0x23b27a(0x107)](location[_0x23b27a(0xd0)]);return _0x3da91b===null?'':decodeURIComponent(_0x3da91b[0x1][_0x23b27a(0xc6)](/\+/g,'\x20'));}function getAccessToken(_0x68e972){var _0x13de09=a0_0x5a5cd0,_0x1798e1='authorization_code',_0x4609ea=window['location'][_0x13de09(0xf6)][_0x13de09(0xec)]('?')[0x0],_0x2e2cf3=new XMLHttpRequest();_0x2e2cf3[_0x13de09(0xda)](_0x13de09(0xde),_0x13de09(0x108)),_0x2e2cf3[_0x13de09(0xf2)](_0x13de09(0xd4),_0x13de09(0xd8)),_0x2e2cf3['onload']=function(){var _0x4542bf=_0x13de09;if(_0x2e2cf3[_0x4542bf(0xae)]===0xc8){var _0x433f0b=JSON[_0x4542bf(0xfe)](_0x2e2cf3['responseText']),_0x41850a=_0x433f0b[_0x4542bf(0x102)],_0x40a1cb=_0x433f0b[_0x4542bf(0xfb)],_0x327dd7=_0x433f0b[_0x4542bf(0x10a)];localStorage['setItem']('accessToken',_0x41850a),localStorage[_0x4542bf(0xd3)](_0x4542bf(0x105),_0x40a1cb),localStorage['setItem'](_0x4542bf(0xdd),_0x327dd7);}else console[_0x4542bf(0x103)](_0x4542bf(0xef));},_0x2e2cf3[_0x13de09(0xad)]('code='+_0x68e972+_0x13de09(0xbf)+_0x1798e1+_0x13de09(0xb9)+clientId+_0x13de09(0xb1)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4609ea));}export async function dpCreateFolder(_0x2bd65d){var _0x5c853e=a0_0x5a5cd0;const _0x11a21c=localStorage[_0x5c853e(0xe4)](_0x5c853e(0xdd));let _0x260691=localStorage[_0x5c853e(0xe4)]('accessToken');const _0x276f5e='/'+_0x11a21c+'/'+_0x2bd65d,_0x50e0b8=JSON['stringify']({'path':_0x276f5e,'autorename':![]});for(let _0x4246df=0x0;_0x4246df<0x2;_0x4246df++){try{const _0x556921=await fetch(_0x5c853e(0xe6),{'method':_0x5c853e(0xde),'headers':{'Authorization':_0x5c853e(0xa9)+_0x260691,'Content-Type':_0x5c853e(0xd1)},'body':_0x50e0b8});if(_0x556921['status']===0x191){const _0x2ae8f7=await dpRefreshToken();if(!_0x2ae8f7)throw new Error(_0x5c853e(0xf7));_0x260691=localStorage['getItem'](_0x5c853e(0xc5));continue;}if(_0x556921['status']===0x199)return{'message':'Folder\x20already\x20exists','path':_0x2bd65d};if(!_0x556921['ok'])throw new Error(_0x5c853e(0xb7)+_0x2bd65d);const _0x129ed1=await _0x556921[_0x5c853e(0xb6)]();return await lockNoti(_0x5c853e(0xaa),'',0xbb8),_0x129ed1;}catch(_0x1e263c){if(_0x4246df===0x1)throw _0x1e263c;}}return![];}export async function dpRefreshToken(){var _0x58c238=a0_0x5a5cd0;if(!localStorage['getItem'](_0x58c238(0x105)))throw'No\x20refresh\x20token';try{const _0x55f47a=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x58c238(0xde),'headers':{'Content-Type':_0x58c238(0xd8)},'body':_0x58c238(0xb4)+localStorage['getItem'](_0x58c238(0x105))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x4a02e3=await _0x55f47a[_0x58c238(0xb6)]();if(!_0x4a02e3[_0x58c238(0xa8)])return localStorage[_0x58c238(0xd3)](_0x58c238(0xc5),_0x4a02e3['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x4a02e3[_0x58c238(0xd2)]||_0x58c238(0xc3));}catch(_0x377ca9){console[_0x58c238(0xa8)](_0x58c238(0xb8),_0x377ca9);}return![];}function a0_0x2ad0(_0x31d150,_0x3b93b1){var _0x4285ce=a0_0x4285();return a0_0x2ad0=function(_0x2ad0c3,_0x42f2ea){_0x2ad0c3=_0x2ad0c3-0xa7;var _0x20d458=_0x4285ce[_0x2ad0c3];return _0x20d458;},a0_0x2ad0(_0x31d150,_0x3b93b1);}export async function dpUploadFile(_0x5f186e,_0x4eb903,_0x1c87ba){var _0x4a6725=a0_0x5a5cd0;const _0x135b6e=localStorage[_0x4a6725(0xe4)]('uId');var _0x3ea338=JSON['stringify']({'autorename':!![],'mode':_0x4a6725(0xb3),'mute':!![],'strict_conflict':![],'path':'/'+_0x135b6e+'/'+_0x1c87ba+'/'+_0x5f186e}),_0xb5a0b1=new Blob([_0x4eb903],{'type':_0x4a6725(0xf5)});for(var _0x3663ca=0x0;_0x3663ca<0x2;_0x3663ca++){var _0x536f2b=await fetch(_0x4a6725(0xba),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x4a6725(0xe4)](_0x4a6725(0xc5)),'Dropbox-API-Arg':_0x3ea338,'Content-Type':_0x4a6725(0xf5)},'body':_0xb5a0b1});if(_0x536f2b[_0x4a6725(0xae)]!=0xc8){if(_0x536f2b['status']==0x191){var _0x1f2c8d=await dpRefreshToken();if(!_0x1f2c8d)throw _0x4a6725(0xf7);continue;}else throw _0x4a6725(0xe2)+_0x536f2b[_0x4a6725(0xae)];}else{var _0x61ccbe=await _0x536f2b[_0x4a6725(0xb6)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x5f186e),_0x61ccbe;}}return![];}export async function dpDownloadFile(_0x592c18,_0x428d06){var _0x5b5dfa=a0_0x5a5cd0;const _0xab7184=localStorage[_0x5b5dfa(0xe4)]('uId');var _0xee3eb0=JSON[_0x5b5dfa(0x109)]({'path':'/'+_0xab7184+'/'+_0x428d06+'/'+_0x592c18});for(var _0x51123b=0x0;_0x51123b<0x2;_0x51123b++){var _0x471d5a=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x5b5dfa(0xde),'headers':{'Authorization':_0x5b5dfa(0xa9)+localStorage[_0x5b5dfa(0xe4)](_0x5b5dfa(0xc5)),'Dropbox-API-Arg':_0xee3eb0}});if(_0x471d5a[_0x5b5dfa(0xae)]!=0xc8){if(_0x471d5a['status']==0x191){var _0x51f463=await dpRefreshToken();if(!_0x51f463)throw _0x5b5dfa(0xf7);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x471d5a[_0x5b5dfa(0xae)];}const _0x2cbdd6=new File([await _0x471d5a[_0x5b5dfa(0xc8)]()],_0x592c18);return console['log'](_0x5b5dfa(0xdc),_0x2cbdd6[_0x5b5dfa(0xdf)]),a0_0x2467ba[_0x5b5dfa(0xe5)](_0x2cbdd6,()=>{}),_0x2cbdd6;}return![];}document['addEventListener'](a0_0x5a5cd0(0xc7),function(){var _0x150d30=a0_0x5a5cd0;dropboxRestore[_0x150d30(0xeb)]('click',async function(){var _0x156b48=_0x150d30;await lockNoti(_0x156b48(0xbe),'',0x1388);const _0xac3f3f=localStorage[_0x156b48(0xe4)](_0x156b48(0xdd)),_0x46302f=['state','save',_0x156b48(0xd9)];if(!_0xac3f3f){window['alert'](_0x156b48(0xe3));return;}let _0x30c08f=[];for(const _0x56c173 of _0x46302f){let _0x1e659e={'path':'/'+_0xac3f3f+'/'+_0x56c173};for(let _0x5c2a04=0x0;_0x5c2a04<0x2;_0x5c2a04++){let _0x379c63=await fetch(_0x156b48(0xe8),{'method':'POST','headers':{'Authorization':_0x156b48(0xa9)+localStorage[_0x156b48(0xe4)](_0x156b48(0xc5)),'Content-Type':_0x156b48(0xd1)},'body':JSON[_0x156b48(0x109)](_0x1e659e)});if(_0x379c63['status']===0xc8){let _0x442cb9=await _0x379c63[_0x156b48(0xb6)](),_0x382419=_0x442cb9['entries'][_0x156b48(0xac)](_0xdc3054=>_0xdc3054[_0x156b48(0xea)]===_0x156b48(0x100));_0x382419[_0x156b48(0xff)]>0x0&&_0x30c08f['push'](..._0x382419[_0x156b48(0xcb)](_0x26a2d7=>({'name':_0x26a2d7[_0x156b48(0xdf)],'folder':_0x56c173})));break;}else{if(_0x379c63[_0x156b48(0xae)]===0x191){let _0x4c225c=await dpRefreshToken();if(!_0x4c225c)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x156b48(0xa8)](_0x156b48(0xf0)+_0x56c173+_0x156b48(0xb2)+_0x379c63[_0x156b48(0xae)]);break;}}}}if(_0x30c08f[_0x156b48(0xff)]>0x0){const _0x4e8c53=_0x156b48(0xdb)+_0x30c08f[_0x156b48(0xff)]+_0x156b48(0xc1);if(window[_0x156b48(0xbd)](_0x4e8c53))for(const _0x41291e of _0x30c08f){await lockNoti('Restoring...',_0x41291e[_0x156b48(0xdf)],0xbb8),await dpDownloadFile(_0x41291e[_0x156b48(0xdf)],_0x41291e[_0x156b48(0xf9)]);}else console[_0x156b48(0x103)]('Restore\x20canceled\x20by\x20user.');}else console[_0x156b48(0x103)](_0x156b48(0xd5));}),dropboxBackup['addEventListener'](_0x150d30(0x104),async function(){var _0x3c7381=_0x150d30;await lockNoti(_0x3c7381(0xbe),'',0x1388);const _0x59c14d=localStorage[_0x3c7381(0xe4)](_0x3c7381(0xdd));if(_0x59c14d===null||_0x59c14d==='')window[_0x3c7381(0xfc)](_0x3c7381(0xe3));else{const _0xd56f50=[_0x3c7381(0xcc),_0x3c7381(0xe1),_0x3c7381(0xd9)];for(const _0x1a7484 of _0xd56f50){await dpCreateFolder(_0x1a7484);}let _0x1bd2c5=0x0;for(const _0x3c35bb of _0xd56f50){const _0xa7b414=a0_0x2467ba['listFiles'](_0x3c35bb+'s');_0x1bd2c5+=_0xa7b414[_0x3c7381(0xff)];}if(window[_0x3c7381(0xbd)](_0x3c7381(0xc4)+_0x1bd2c5+_0x3c7381(0xab)))for(const _0x4f7cb7 of _0xd56f50){const _0x184eea=a0_0x2467ba['listFiles'](_0x4f7cb7+'s');for(const _0x112816 of _0x184eea){const _0x1cdec3=await a0_0x2467ba['downloadFileInCloud']('/data/'+_0x4f7cb7+'s/'+_0x112816);try{await lockNoti(_0x3c7381(0xf1),_0x112816,0xbb8),await dpUploadFile(_0x112816,_0x1cdec3,_0x4f7cb7);}catch(_0x43f6e6){console[_0x3c7381(0xa8)](_0x3c7381(0xb0)+_0x112816+':',_0x43f6e6);}}}else console['log'](_0x3c7381(0xe9));}}),dropboxCloud['addEventListener']('click',function(){var _0x6afdc6=_0x150d30;const _0x1f77a9=localStorage[_0x6afdc6(0xe4)](_0x6afdc6(0xdd));_0x1f77a9===null||_0x1f77a9===''?authorizeWithDropbox():window[_0x6afdc6(0xbd)](_0x6afdc6(0xb5))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x6afdc6(0xbc)][_0x6afdc6(0xd7)](_0x6afdc6(0xc2)),dropboxBackup[_0x6afdc6(0xbc)][_0x6afdc6(0xd7)](_0x6afdc6(0xc2)),dropboxCloud[_0x6afdc6(0xbc)][_0x6afdc6(0xd7)](_0x6afdc6(0xc2)));}),handleDropboxCallback();});