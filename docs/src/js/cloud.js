function a0_0x409c(){var _0xfc83ff=['&token_access_type=','application/x-www-form-urlencoded','uId','click','refresh_token=','access_token','name','Do\x20you\x20want\x20to\x20backup\x20','8tEnedz','Failed\x20to\x20upload\x20file\x20','toUpperCase','Content-Type','overwrite','json','active','list','split','accessToken','error_description','[\x5c?&#]','Bearer\x20','Download\x20failed\x20for\x20','stringify','error','remove','Folder\x20already\x20exists','POST','2208052ixZlIi','filter','addEventListener','&grant_type=','=([^&#]*)','setRequestHeader','code','location','Error\x20while\x20refreshing\x20token:','uid','Folder\x20created','uploadFileInCloud','122147fhUXuc','slice','screenshot','log','application/json','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','2351419zDbnBo','1035ZbWKrs','map','application/octet-stream','push','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Wait\x20a\x20little\x20bit...','length','alert','Cloud\x20login\x20required!','refresh_token','Restoring...','charAt','Do\x20not\x20receive\x20authorization','setItem','exec','entries','Do\x20you\x20want\x20to\x20logout?','Unable\x20to\x20refresh\x20token','Authorization\x20Code:','https://content.dropboxapi.com/2/files/download','code=','&client_id=','/data/','Restore\x20canceled\x20by\x20user.','open','&redirect_uri=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','file','Download\x20failed,\x20unknown\x20http\x20status:','classList','56050hoKYcY','nwb3dnfh09rhs31','https://api.dropboxapi.com/oauth2/token','228jHgllR','No\x20refresh\x20token','replace','state','30430RLcHPC','Refreshing\x20token...','refreshToken','confirm','getItem','send','\x20files\x20from\x20Cloud?','FSSync','DOMContentLoaded','1772142QPFOpw','https://content.dropboxapi.com/2/files/upload','Kabu\x20storage\x20↦\x20Cloud\x20◆','1049200fEejHA','responseText','\x20files\x20in\x20Kabu?','status','href','parse','&client_secret='];a0_0x409c=function(){return _0xfc83ff;};return a0_0x409c();}var a0_0x37b311=a0_0x422f;(function(_0x40f5aa,_0x303c5e){var _0x383d68=a0_0x422f,_0x8dfd5b=_0x40f5aa();while(!![]){try{var _0x36fad6=-parseInt(_0x383d68(0xfa))/0x1+parseInt(_0x383d68(0xcc))/0x2+parseInt(_0x383d68(0x12f))/0x3+-parseInt(_0x383d68(0xee))/0x4+-parseInt(_0x383d68(0x126))/0x5*(-parseInt(_0x383d68(0x122))/0x6)+-parseInt(_0x383d68(0x100))/0x7*(-parseInt(_0x383d68(0xdb))/0x8)+parseInt(_0x383d68(0x101))/0x9*(-parseInt(_0x383d68(0x11f))/0xa);if(_0x36fad6===_0x303c5e)break;else _0x8dfd5b['push'](_0x8dfd5b['shift']());}catch(_0x3988f7){_0x8dfd5b['push'](_0x8dfd5b['shift']());}}}(a0_0x409c,0x58cf4));import*as a0_0x2cb22a from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x37b311(0x120);function authorizeWithDropbox(){var _0x4c1a87=a0_0x37b311,_0xf8edbe=window[_0x4c1a87(0xf5)][_0x4c1a87(0xd0)][_0x4c1a87(0xe3)]('?')[0x0],_0x169c80='code',_0x4b8b82='offline',_0x269c01='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x169c80+_0x4c1a87(0xd3)+_0x4b8b82+'&redirect_uri='+encodeURIComponent(_0xf8edbe);window['location'][_0x4c1a87(0xd0)]=_0x269c01;}function handleDropboxCallback(){var _0x557b81=a0_0x37b311,_0x19d9ab=getUrlParameter(_0x557b81(0xf4));_0x19d9ab?(getAccessToken(_0x19d9ab),console['log'](_0x557b81(0x113),_0x19d9ab)):console['log'](_0x557b81(0x10d));}function a0_0x422f(_0x2d75e5,_0xe4501){var _0x409c7a=a0_0x409c();return a0_0x422f=function(_0x422f80,_0x966eee){_0x422f80=_0x422f80-0xcb;var _0x5b4d64=_0x409c7a[_0x422f80];return _0x5b4d64;},a0_0x422f(_0x2d75e5,_0xe4501);}function getUrlParameter(_0x595283){var _0x153ebb=a0_0x37b311;_0x595283=_0x595283[_0x153ebb(0x124)](/[\[]/,'\x5c[')[_0x153ebb(0x124)](/[\]]/,'\x5c]');var _0x259cf3=new RegExp(_0x153ebb(0xe6)+_0x595283+_0x153ebb(0xf2)),_0x4e61e0=_0x259cf3[_0x153ebb(0x10f)](location['search']);return _0x4e61e0===null?'':decodeURIComponent(_0x4e61e0[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x43007b){var _0x43e498=a0_0x37b311,_0xbcd25='authorization_code',_0x4fee6b=window['location'][_0x43e498(0xd0)]['split']('?')[0x0],_0x502436=new XMLHttpRequest();_0x502436[_0x43e498(0x119)]('POST','https://api.dropbox.com/oauth2/token'),_0x502436[_0x43e498(0xf3)](_0x43e498(0xde),_0x43e498(0xd4)),_0x502436['onload']=function(){var _0x28c39b=_0x43e498;if(_0x502436[_0x28c39b(0xcf)]===0xc8){var _0x403490=JSON[_0x28c39b(0xd1)](_0x502436[_0x28c39b(0xcd)]),_0x19b965=_0x403490[_0x28c39b(0xd8)],_0x3092fd=_0x403490[_0x28c39b(0x10a)],_0x3de2cc=_0x403490[_0x28c39b(0xf7)];localStorage[_0x28c39b(0x10e)](_0x28c39b(0xe4),_0x19b965),localStorage[_0x28c39b(0x10e)](_0x28c39b(0x128),_0x3092fd),localStorage[_0x28c39b(0x10e)](_0x28c39b(0xd5),_0x3de2cc);}else console[_0x28c39b(0xfd)](_0x28c39b(0x105));},_0x502436[_0x43e498(0x12b)](_0x43e498(0x115)+_0x43007b+_0x43e498(0xf1)+_0xbcd25+_0x43e498(0x116)+clientId+_0x43e498(0xd2)+clientSecret+_0x43e498(0x11a)+encodeURIComponent(_0x4fee6b));}export async function dpCreateFolder(_0x19ee7d){var _0x55c71a=a0_0x37b311;const _0x6b0ae9=localStorage['getItem'](_0x55c71a(0xd5));let _0x29cac2=localStorage['getItem'](_0x55c71a(0xe4));const _0x560704='/'+_0x6b0ae9+'/'+_0x19ee7d,_0x4c0505=JSON[_0x55c71a(0xe9)]({'path':_0x560704,'autorename':![]});for(let _0x23a1f3=0x0;_0x23a1f3<0x2;_0x23a1f3++){try{const _0x35bc0e=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x55c71a(0xed),'headers':{'Authorization':'Bearer\x20'+_0x29cac2,'Content-Type':_0x55c71a(0xfe)},'body':_0x4c0505});if(_0x35bc0e['status']===0x191){const _0x4750e2=await dpRefreshToken();if(!_0x4750e2)throw new Error(_0x55c71a(0x112));_0x29cac2=localStorage['getItem'](_0x55c71a(0xe4));continue;}if(_0x35bc0e[_0x55c71a(0xcf)]===0x199)return{'message':_0x55c71a(0xec),'path':_0x19ee7d};if(!_0x35bc0e['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x19ee7d);const _0x303aa6=await _0x35bc0e['json']();return await lockNoti(_0x55c71a(0xf8),'',0xbb8),_0x303aa6;}catch(_0x3fabf6){if(_0x23a1f3===0x1)throw _0x3fabf6;}}return![];}export async function dpRefreshToken(){var _0x388d2e=a0_0x37b311;if(!localStorage[_0x388d2e(0x12a)]('refreshToken'))throw _0x388d2e(0x123);try{const _0x4a1735=await fetch(_0x388d2e(0x121),{'method':_0x388d2e(0xed),'headers':{'Content-Type':_0x388d2e(0xd4)},'body':_0x388d2e(0xd7)+localStorage[_0x388d2e(0x12a)](_0x388d2e(0x128))+_0x388d2e(0xff)}),_0x1156b7=await _0x4a1735['json']();if(!_0x1156b7[_0x388d2e(0xea)])return localStorage[_0x388d2e(0x10e)](_0x388d2e(0xe4),_0x1156b7[_0x388d2e(0xd8)]),await lockNoti(_0x388d2e(0x127),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1156b7[_0x388d2e(0xe5)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x409086){console[_0x388d2e(0xea)](_0x388d2e(0xf6),_0x409086);}return![];}export async function dpUploadFile(_0x1c3efc,_0xa5923a,_0x3e0c5b){var _0x4edeb3=a0_0x37b311;const _0x422fbd=localStorage['getItem'](_0x4edeb3(0xd5));var _0x59f3ff=JSON['stringify']({'autorename':!![],'mode':_0x4edeb3(0xdf),'mute':!![],'strict_conflict':![],'path':'/'+_0x422fbd+'/'+_0x3e0c5b+'/'+_0x1c3efc}),_0x37d532=new Blob([_0xa5923a],{'type':'application/octet-stream'});for(var _0xbfd86=0x0;_0xbfd86<0x2;_0xbfd86++){var _0x44c42d=await fetch(_0x4edeb3(0x130),{'method':_0x4edeb3(0xed),'headers':{'Authorization':_0x4edeb3(0xe7)+localStorage[_0x4edeb3(0x12a)](_0x4edeb3(0xe4)),'Dropbox-API-Arg':_0x59f3ff,'Content-Type':_0x4edeb3(0x103)},'body':_0x37d532});if(_0x44c42d[_0x4edeb3(0xcf)]!=0xc8){if(_0x44c42d[_0x4edeb3(0xcf)]==0x191){var _0x295baa=await dpRefreshToken();if(!_0x295baa)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4edeb3(0x11b)+_0x44c42d[_0x4edeb3(0xcf)];}else{var _0x2a6a8c=await _0x44c42d['json']();return console[_0x4edeb3(0xfd)](_0x4edeb3(0xcb),_0x1c3efc),_0x2a6a8c;}}return![];}export async function dpDownloadFile(_0xc9a819,_0x1e877b){var _0x4316ed=a0_0x37b311;const _0x31cd48=localStorage['getItem'](_0x4316ed(0xd5));var _0x27a3ab=JSON[_0x4316ed(0xe9)]({'path':'/'+_0x31cd48+'/'+_0x1e877b+'/'+_0xc9a819});for(var _0x321f00=0x0;_0x321f00<0x2;_0x321f00++){var _0x4238c7=await fetch(_0x4316ed(0x114),{'method':_0x4316ed(0xed),'headers':{'Authorization':_0x4316ed(0xe7)+localStorage[_0x4316ed(0x12a)](_0x4316ed(0xe4)),'Dropbox-API-Arg':_0x27a3ab}});if(_0x4238c7['status']!=0xc8){if(_0x4238c7['status']==0x191){var _0x59b7b8=await dpRefreshToken();if(!_0x59b7b8)throw _0x4316ed(0x112);continue;}else throw _0x4316ed(0x11d)+_0x4238c7[_0x4316ed(0xcf)];}const _0x4e9b0f=new File([await _0x4238c7['blob']()],_0xc9a819);return console[_0x4316ed(0xfd)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x4e9b0f[_0x4316ed(0xd9)]),a0_0x2cb22a[_0x4316ed(0xf9)](_0x4e9b0f,()=>{var _0x189a97=_0x4316ed;localStorageFile(),Module[_0x189a97(0x12d)]();}),_0x4e9b0f;}return![];}document['addEventListener'](a0_0x37b311(0x12e),function(){var _0x1f993a=a0_0x37b311;dropboxRestore['addEventListener'](_0x1f993a(0xd6),async function(){var _0x2900e9=_0x1f993a;await lockNoti(_0x2900e9(0x106),'',0x1388);const _0x270405=localStorage[_0x2900e9(0x12a)](_0x2900e9(0xd5)),_0x579de3=[_0x2900e9(0x125),'save',_0x2900e9(0xfc)];if(!_0x270405){window[_0x2900e9(0x108)](_0x2900e9(0x109));return;}let _0x124937=[];for(const _0x43340e of _0x579de3){let _0x387da0={'path':'/'+_0x270405+'/'+_0x43340e};for(let _0x85a8c=0x0;_0x85a8c<0x2;_0x85a8c++){let _0x1bab14=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x2900e9(0xed),'headers':{'Authorization':_0x2900e9(0xe7)+localStorage['getItem']('accessToken'),'Content-Type':_0x2900e9(0xfe)},'body':JSON['stringify'](_0x387da0)});if(_0x1bab14[_0x2900e9(0xcf)]===0xc8){let _0x468bb2=await _0x1bab14[_0x2900e9(0xe0)](),_0x5d92e0=_0x468bb2[_0x2900e9(0x110)][_0x2900e9(0xef)](_0x2009cc=>_0x2009cc['.tag']===_0x2900e9(0x11c));_0x5d92e0[_0x2900e9(0x107)]>0x0&&_0x124937[_0x2900e9(0x104)](..._0x5d92e0[_0x2900e9(0x102)](_0x1948dc=>({'name':_0x1948dc['name'],'folder':_0x43340e})));break;}else{if(_0x1bab14[_0x2900e9(0xcf)]===0x191){let _0x5e1421=await dpRefreshToken();if(!_0x5e1421)throw _0x2900e9(0x112);}else{console[_0x2900e9(0xea)](_0x2900e9(0xe8)+_0x43340e+',\x20status:\x20'+_0x1bab14['status']);break;}}}}if(_0x124937['length']>0x0){const _0x11063f='Do\x20you\x20want\x20to\x20restore\x20'+_0x124937['length']+_0x2900e9(0x12c);if(window['confirm'](_0x11063f))for(const _0x29c83f of _0x124937){await lockNoti(_0x2900e9(0x10b),_0x29c83f['name'],0xbb8),await dpDownloadFile(_0x29c83f['name'],_0x29c83f['folder']);}else console[_0x2900e9(0xfd)](_0x2900e9(0x118));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x1f993a(0xd6),async function(){var _0x1706f2=_0x1f993a;await lockNoti(_0x1706f2(0x106),'',0x1388);const _0x48f43c=localStorage[_0x1706f2(0x12a)](_0x1706f2(0xd5));if(_0x48f43c===null||_0x48f43c==='')window[_0x1706f2(0x108)](_0x1706f2(0x109));else{const _0x1b8cd5=[_0x1706f2(0x125),'save','screenshot'];for(const _0x204e80 of _0x1b8cd5){await dpCreateFolder(_0x204e80);}let _0x3d8cfa=0x0;for(const _0x108342 of _0x1b8cd5){const _0x1f23da=a0_0x2cb22a[_0x1706f2(0xe2)+(_0x108342[_0x1706f2(0x10c)](0x0)[_0x1706f2(0xdd)]()+_0x108342[_0x1706f2(0xfb)](0x1))]();_0x3d8cfa+=_0x1f23da[_0x1706f2(0x107)];}if(window[_0x1706f2(0x129)](_0x1706f2(0xda)+_0x3d8cfa+_0x1706f2(0xce)))for(const _0x35da00 of _0x1b8cd5){const _0x2d7d04=a0_0x2cb22a['list'+(_0x35da00[_0x1706f2(0x10c)](0x0)['toUpperCase']()+_0x35da00['slice'](0x1))]();for(const _0x9f7908 of _0x2d7d04){const _0x154e4d=await a0_0x2cb22a['downloadFileInCloud'](_0x1706f2(0x117)+_0x35da00+'s/'+_0x9f7908);try{await lockNoti('Backing\x20up...',_0x9f7908,0xbb8),await dpUploadFile(_0x9f7908,_0x154e4d,_0x35da00);}catch(_0x3681ac){console[_0x1706f2(0xea)](_0x1706f2(0xdc)+_0x9f7908+':',_0x3681ac);}}}else console[_0x1706f2(0xfd)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x1f993a(0xf0)](_0x1f993a(0xd6),function(){var _0x149c8a=_0x1f993a;const _0x1ba3f5=localStorage[_0x149c8a(0x12a)](_0x149c8a(0xd5));_0x1ba3f5===null||_0x1ba3f5===''?authorizeWithDropbox():window[_0x149c8a(0x129)](_0x149c8a(0x111))&&(localStorage[_0x149c8a(0x10e)](_0x149c8a(0xd5),''),dropboxRestore['classList'][_0x149c8a(0xeb)]('active'),dropboxBackup[_0x149c8a(0x11e)][_0x149c8a(0xeb)](_0x149c8a(0xe1)),dropboxCloud[_0x149c8a(0x11e)]['remove'](_0x149c8a(0xe1)));}),handleDropboxCallback();});