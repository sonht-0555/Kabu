var a0_0x5c58e8=a0_0x5bc0;(function(_0x50da9f,_0x470c4b){var _0x9bb328=a0_0x5bc0,_0x355d58=_0x50da9f();while(!![]){try{var _0x140712=parseInt(_0x9bb328(0x1d8))/0x1+-parseInt(_0x9bb328(0x1c4))/0x2+parseInt(_0x9bb328(0x1d6))/0x3+parseInt(_0x9bb328(0x1ac))/0x4*(parseInt(_0x9bb328(0x183))/0x5)+-parseInt(_0x9bb328(0x18f))/0x6*(-parseInt(_0x9bb328(0x1b7))/0x7)+-parseInt(_0x9bb328(0x1cd))/0x8+parseInt(_0x9bb328(0x1a9))/0x9*(parseInt(_0x9bb328(0x188))/0xa);if(_0x140712===_0x470c4b)break;else _0x355d58['push'](_0x355d58['shift']());}catch(_0x2183bf){_0x355d58['push'](_0x355d58['shift']());}}}(a0_0x391a,0xb9f37));import*as a0_0x282358 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5c58e8(0x1aa),clientSecret=a0_0x5c58e8(0x185);function authorizeWithDropbox(){var _0x36a310=a0_0x5c58e8,_0x515136=window[_0x36a310(0x1da)][_0x36a310(0x1a6)][_0x36a310(0x182)]('?')[0x0],_0x7ae993=_0x36a310(0x1b2),_0x32b0c7=_0x36a310(0x1b8),_0x426501=_0x36a310(0x1dc)+clientId+_0x36a310(0x186)+_0x7ae993+'&token_access_type='+_0x32b0c7+'&redirect_uri='+encodeURIComponent(_0x515136);window['location'][_0x36a310(0x1a6)]=_0x426501;}function handleDropboxCallback(){var _0x4a24bc=a0_0x5c58e8,_0x317e1c=getUrlParameter('code');_0x317e1c?(getAccessToken(_0x317e1c),console['log'](_0x4a24bc(0x1d7),_0x317e1c)):console[_0x4a24bc(0x1b3)]('Do\x20not\x20receive\x20authorization');}function a0_0x5bc0(_0x20e0e0,_0x10e40d){var _0x391a6e=a0_0x391a();return a0_0x5bc0=function(_0x5bc0df,_0x4a71e9){_0x5bc0df=_0x5bc0df-0x17e;var _0x539a4e=_0x391a6e[_0x5bc0df];return _0x539a4e;},a0_0x5bc0(_0x20e0e0,_0x10e40d);}function getUrlParameter(_0x269944){var _0x33b067=a0_0x5c58e8;_0x269944=_0x269944[_0x33b067(0x1ca)](/[\[]/,'\x5c[')[_0x33b067(0x1ca)](/[\]]/,'\x5c]');var _0xcf664b=new RegExp('[\x5c?&#]'+_0x269944+_0x33b067(0x18e)),_0x1c995f=_0xcf664b[_0x33b067(0x1b1)](location['search']);return _0x1c995f===null?'':decodeURIComponent(_0x1c995f[0x1][_0x33b067(0x1ca)](/\+/g,'\x20'));}function getAccessToken(_0x26d2d4){var _0x8c491d=a0_0x5c58e8,_0x30fb3c='authorization_code',_0x2b7f6f=window[_0x8c491d(0x1da)]['href'][_0x8c491d(0x182)]('?')[0x0],_0x59aacc=new XMLHttpRequest();_0x59aacc[_0x8c491d(0x1bc)](_0x8c491d(0x1d1),_0x8c491d(0x1c9)),_0x59aacc[_0x8c491d(0x17e)]('Content-Type',_0x8c491d(0x187)),_0x59aacc[_0x8c491d(0x1ae)]=function(){var _0x5eaab4=_0x8c491d;if(_0x59aacc[_0x5eaab4(0x19f)]===0xc8){var _0x38377b=JSON['parse'](_0x59aacc['responseText']),_0x5ed447=_0x38377b[_0x5eaab4(0x193)],_0x3b9ff2=_0x38377b[_0x5eaab4(0x1c7)],_0x60ba12=_0x38377b[_0x5eaab4(0x1bd)];localStorage[_0x5eaab4(0x191)](_0x5eaab4(0x1a7),_0x5ed447),localStorage['setItem']('refreshToken',_0x3b9ff2),localStorage['setItem'](_0x5eaab4(0x1b6),_0x60ba12);}else console[_0x5eaab4(0x1b3)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x59aacc[_0x8c491d(0x1d0)](_0x8c491d(0x18a)+_0x26d2d4+_0x8c491d(0x184)+_0x30fb3c+_0x8c491d(0x181)+clientId+_0x8c491d(0x1d4)+clientSecret+_0x8c491d(0x1ce)+encodeURIComponent(_0x2b7f6f));}export async function dpCreateFolder(_0x3a1241){var _0x495685=a0_0x5c58e8;const _0x563067=localStorage['getItem'](_0x495685(0x1b6));let _0xf59b9f=localStorage[_0x495685(0x1c1)]('accessToken');const _0x321d93='/'+_0x563067+'/'+_0x3a1241,_0x4f276d=JSON[_0x495685(0x199)]({'path':_0x321d93,'autorename':![]});for(let _0x3350b9=0x0;_0x3350b9<0x2;_0x3350b9++){try{const _0x4d991b=await fetch(_0x495685(0x196),{'method':_0x495685(0x1d1),'headers':{'Authorization':'Bearer\x20'+_0xf59b9f,'Content-Type':'application/json'},'body':_0x4f276d});if(_0x4d991b[_0x495685(0x19f)]===0x191){const _0x18cd1d=await dpRefreshToken();if(!_0x18cd1d)throw new Error('Unable\x20to\x20refresh\x20token');_0xf59b9f=localStorage['getItem']('accessToken');continue;}if(_0x4d991b[_0x495685(0x19f)]===0x199)return{'message':_0x495685(0x17f),'path':_0x3a1241};if(!_0x4d991b['ok'])throw new Error(_0x495685(0x1db)+_0x3a1241);const _0x54dabe=await _0x4d991b[_0x495685(0x18c)]();return await lockNoti(_0x495685(0x18d),'',0xbb8),_0x54dabe;}catch(_0x3fa600){if(_0x3350b9===0x1)throw _0x3fa600;}}return![];}function a0_0x391a(){var _0x1c0f41=['slice','send','POST','Do\x20you\x20want\x20to\x20backup\x20','refresh_token=','&client_secret=','application/json','3553095BNAWUQ','Authorization\x20Code:','363731uISeKS','classList','location','Error\x20creating\x20folder\x20','https://www.dropbox.com/oauth2/authorize?client_id=','No\x20files\x20found\x20to\x20restore.','Unable\x20to\x20refresh\x20token','/data/','Bearer\x20','FSSync','setRequestHeader','Folder\x20already\x20exists','folder','&client_id=','split','2590EeMNnp','&grant_type=','nwb3dnfh09rhs31','&response_type=','application/x-www-form-urlencoded','10knJQGE','state','code=','Failed\x20to\x20upload\x20file\x20','json','Folder\x20created','=([^&#]*)','2849502cskcNS','map','setItem','error','access_token','Cloud\x20login\x20required!','Restoring...','https://api.dropboxapi.com/2/files/create_folder_v2','alert','Do\x20you\x20want\x20to\x20restore\x20','stringify','Kabu\x20storage\x20↦\x20Cloud\x20◆','list','active','length','https://api.dropboxapi.com/oauth2/token','status','uploadFileInCloud','Do\x20you\x20want\x20to\x20logout?','error_description','\x20files\x20in\x20Kabu?','Download\x20failed,\x20unknown\x20http\x20status:','screenshot','href','accessToken','Download\x20failed\x20for\x20','2825001TzUQUh','knh3uz2mx2hp2eu','save','756NYGSgi','addEventListener','onload','toUpperCase','Failed\x20to\x20refresh\x20Dropbox\x20token.','exec','code','log','blob','https://api.dropboxapi.com/2/files/list_folder','uId','14bzuOYe','offline','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','Wait\x20a\x20little\x20bit...','open','uid','click','confirm','charAt','getItem','application/octet-stream','name','1624684XAXZTs','filter','Refreshing\x20token...','refresh_token','file','https://api.dropbox.com/oauth2/token','replace','.tag','remove','10685792cGhDUF','&redirect_uri='];a0_0x391a=function(){return _0x1c0f41;};return a0_0x391a();}export async function dpRefreshToken(){var _0x4a1d0a=a0_0x5c58e8;if(!localStorage[_0x4a1d0a(0x1c1)](_0x4a1d0a(0x1ba)))throw'No\x20refresh\x20token';try{const _0x4c67e3=await fetch(_0x4a1d0a(0x19e),{'method':_0x4a1d0a(0x1d1),'headers':{'Content-Type':_0x4a1d0a(0x187)},'body':_0x4a1d0a(0x1d3)+localStorage['getItem'](_0x4a1d0a(0x1ba))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x49ec29=await _0x4c67e3[_0x4a1d0a(0x18c)]();if(!_0x49ec29['error'])return localStorage[_0x4a1d0a(0x191)](_0x4a1d0a(0x1a7),_0x49ec29[_0x4a1d0a(0x193)]),await lockNoti(_0x4a1d0a(0x1c6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x49ec29[_0x4a1d0a(0x1a2)]||_0x4a1d0a(0x1b0));}catch(_0x8e8544){console[_0x4a1d0a(0x192)]('Error\x20while\x20refreshing\x20token:',_0x8e8544);}return![];}export async function dpUploadFile(_0x35e7f8,_0x15bb77,_0x1f6e88){var _0x38eac9=a0_0x5c58e8;const _0x355ab3=localStorage['getItem'](_0x38eac9(0x1b6));var _0x5bff70=JSON[_0x38eac9(0x199)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x355ab3+'/'+_0x1f6e88+'/'+_0x35e7f8}),_0x4e436c=new Blob([_0x15bb77],{'type':_0x38eac9(0x1c2)});for(var _0x429fb9=0x0;_0x429fb9<0x2;_0x429fb9++){var _0x45bdfd=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x38eac9(0x1d1),'headers':{'Authorization':_0x38eac9(0x1e0)+localStorage['getItem'](_0x38eac9(0x1a7)),'Dropbox-API-Arg':_0x5bff70,'Content-Type':_0x38eac9(0x1c2)},'body':_0x4e436c});if(_0x45bdfd[_0x38eac9(0x19f)]!=0xc8){if(_0x45bdfd[_0x38eac9(0x19f)]==0x191){var _0xf76155=await dpRefreshToken();if(!_0xf76155)throw _0x38eac9(0x1de);continue;}else throw _0x38eac9(0x1b9)+_0x45bdfd[_0x38eac9(0x19f)];}else{var _0x27b1ae=await _0x45bdfd[_0x38eac9(0x18c)]();return console[_0x38eac9(0x1b3)](_0x38eac9(0x19a),_0x35e7f8),_0x27b1ae;}}return![];}export async function dpDownloadFile(_0x57a9f2,_0x1f71cf){var _0x177cf4=a0_0x5c58e8;const _0x1e2dcc=localStorage[_0x177cf4(0x1c1)](_0x177cf4(0x1b6));var _0x367d4f=JSON['stringify']({'path':'/'+_0x1e2dcc+'/'+_0x1f71cf+'/'+_0x57a9f2});for(var _0x4c1ff2=0x0;_0x4c1ff2<0x2;_0x4c1ff2++){var _0x5d62d1=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x177cf4(0x1d1),'headers':{'Authorization':_0x177cf4(0x1e0)+localStorage[_0x177cf4(0x1c1)](_0x177cf4(0x1a7)),'Dropbox-API-Arg':_0x367d4f}});if(_0x5d62d1[_0x177cf4(0x19f)]!=0xc8){if(_0x5d62d1['status']==0x191){var _0x6ac403=await dpRefreshToken();if(!_0x6ac403)throw _0x177cf4(0x1de);continue;}else throw _0x177cf4(0x1a4)+_0x5d62d1['status'];}const _0x576f9f=new File([await _0x5d62d1[_0x177cf4(0x1b4)]()],_0x57a9f2);return console[_0x177cf4(0x1b3)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x576f9f['name']),a0_0x282358[_0x177cf4(0x1a0)](_0x576f9f,()=>{var _0x38f330=_0x177cf4;localStorageFile(),Module[_0x38f330(0x1e1)]();}),_0x576f9f;}return![];}document[a0_0x5c58e8(0x1ad)]('DOMContentLoaded',function(){var _0x5a537a=a0_0x5c58e8;dropboxRestore[_0x5a537a(0x1ad)](_0x5a537a(0x1be),async function(){var _0xead177=_0x5a537a;await lockNoti(_0xead177(0x1bb),'',0x1388);const _0x5c61a4=localStorage[_0xead177(0x1c1)](_0xead177(0x1b6)),_0x3570ed=[_0xead177(0x189),_0xead177(0x1ab),_0xead177(0x1a5)];if(!_0x5c61a4){window[_0xead177(0x197)]('Cloud\x20login\x20required!');return;}let _0x5a788a=[];for(const _0x12adbf of _0x3570ed){let _0x347813={'path':'/'+_0x5c61a4+'/'+_0x12adbf};for(let _0x3a1206=0x0;_0x3a1206<0x2;_0x3a1206++){let _0x2698e1=await fetch(_0xead177(0x1b5),{'method':_0xead177(0x1d1),'headers':{'Authorization':_0xead177(0x1e0)+localStorage['getItem'](_0xead177(0x1a7)),'Content-Type':_0xead177(0x1d5)},'body':JSON[_0xead177(0x199)](_0x347813)});if(_0x2698e1[_0xead177(0x19f)]===0xc8){let _0x205cdc=await _0x2698e1[_0xead177(0x18c)](),_0xd2ac84=_0x205cdc['entries'][_0xead177(0x1c5)](_0x24f2f0=>_0x24f2f0[_0xead177(0x1cb)]===_0xead177(0x1c8));_0xd2ac84[_0xead177(0x19d)]>0x0&&_0x5a788a['push'](..._0xd2ac84[_0xead177(0x190)](_0x32af17=>({'name':_0x32af17[_0xead177(0x1c3)],'folder':_0x12adbf})));break;}else{if(_0x2698e1[_0xead177(0x19f)]===0x191){let _0x804cd=await dpRefreshToken();if(!_0x804cd)throw _0xead177(0x1de);}else{console[_0xead177(0x192)](_0xead177(0x1a8)+_0x12adbf+',\x20status:\x20'+_0x2698e1[_0xead177(0x19f)]);break;}}}}if(_0x5a788a[_0xead177(0x19d)]>0x0){const _0x34028a=_0xead177(0x198)+_0x5a788a[_0xead177(0x19d)]+'\x20files\x20from\x20Cloud?';if(window[_0xead177(0x1bf)](_0x34028a))for(const _0x4e99d0 of _0x5a788a){await lockNoti(_0xead177(0x195),_0x4e99d0[_0xead177(0x1c3)],0xbb8),await dpDownloadFile(_0x4e99d0[_0xead177(0x1c3)],_0x4e99d0[_0xead177(0x180)]);}else console[_0xead177(0x1b3)]('Restore\x20canceled\x20by\x20user.');}else console[_0xead177(0x1b3)](_0xead177(0x1dd));}),dropboxBackup[_0x5a537a(0x1ad)](_0x5a537a(0x1be),async function(){var _0x156c2c=_0x5a537a;await lockNoti(_0x156c2c(0x1bb),'',0x1388);const _0x3f2f4c=localStorage['getItem'](_0x156c2c(0x1b6));if(_0x3f2f4c===null||_0x3f2f4c==='')window['alert'](_0x156c2c(0x194));else{const _0x32b797=[_0x156c2c(0x189),_0x156c2c(0x1ab),_0x156c2c(0x1a5)];for(const _0x190aff of _0x32b797){await dpCreateFolder(_0x190aff);}let _0x536004=0x0;for(const _0x461aab of _0x32b797){const _0x2c5acc=a0_0x282358[_0x156c2c(0x19b)+(_0x461aab[_0x156c2c(0x1c0)](0x0)[_0x156c2c(0x1af)]()+_0x461aab[_0x156c2c(0x1cf)](0x1))]();_0x536004+=_0x2c5acc['length'];}if(window[_0x156c2c(0x1bf)](_0x156c2c(0x1d2)+_0x536004+_0x156c2c(0x1a3)))for(const _0x4f6776 of _0x32b797){const _0x16a929=a0_0x282358[_0x156c2c(0x19b)+(_0x4f6776[_0x156c2c(0x1c0)](0x0)['toUpperCase']()+_0x4f6776[_0x156c2c(0x1cf)](0x1))]();for(const _0x2ffa0d of _0x16a929){const _0x4fc056=await a0_0x282358['downloadFileInCloud'](_0x156c2c(0x1df)+_0x4f6776+'s/'+_0x2ffa0d);try{await lockNoti('Backing\x20up...',_0x2ffa0d,0xbb8),await dpUploadFile(_0x2ffa0d,_0x4fc056,_0x4f6776);}catch(_0x4c3e91){console[_0x156c2c(0x192)](_0x156c2c(0x18b)+_0x2ffa0d+':',_0x4c3e91);}}}else console[_0x156c2c(0x1b3)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x5a537a(0x1ad)](_0x5a537a(0x1be),function(){var _0x18fa77=_0x5a537a;const _0x2f0ccf=localStorage['getItem'](_0x18fa77(0x1b6));_0x2f0ccf===null||_0x2f0ccf===''?authorizeWithDropbox():window[_0x18fa77(0x1bf)](_0x18fa77(0x1a1))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x18fa77(0x1d9)]['remove']('active'),dropboxBackup[_0x18fa77(0x1d9)][_0x18fa77(0x1cc)]('active'),dropboxCloud[_0x18fa77(0x1d9)][_0x18fa77(0x1cc)](_0x18fa77(0x19c)));}),handleDropboxCallback();});