function a0_0x85ab(_0x20f0b3,_0x5c34e6){var _0x2d68e2=a0_0x2d68();return a0_0x85ab=function(_0x85ab25,_0x5e8cc0){_0x85ab25=_0x85ab25-0xa4;var _0x34bea7=_0x2d68e2[_0x85ab25];return _0x34bea7;},a0_0x85ab(_0x20f0b3,_0x5c34e6);}var a0_0x36b66b=a0_0x85ab;(function(_0x2d3dd9,_0x4b237e){var _0xcaed8e=a0_0x85ab,_0x3080b1=_0x2d3dd9();while(!![]){try{var _0x271a69=-parseInt(_0xcaed8e(0xf1))/0x1*(parseInt(_0xcaed8e(0xd8))/0x2)+parseInt(_0xcaed8e(0xe0))/0x3*(parseInt(_0xcaed8e(0xd9))/0x4)+parseInt(_0xcaed8e(0x103))/0x5*(-parseInt(_0xcaed8e(0xb7))/0x6)+parseInt(_0xcaed8e(0x101))/0x7+parseInt(_0xcaed8e(0xfc))/0x8*(parseInt(_0xcaed8e(0xc6))/0x9)+parseInt(_0xcaed8e(0xa4))/0xa+parseInt(_0xcaed8e(0x111))/0xb;if(_0x271a69===_0x4b237e)break;else _0x3080b1['push'](_0x3080b1['shift']());}catch(_0x39d16d){_0x3080b1['push'](_0x3080b1['shift']());}}}(a0_0x2d68,0x6265e));import*as a0_0x192932 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x36b66b(0xcb),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4ad047=a0_0x36b66b,_0x27b30d=window[_0x4ad047(0xe1)][_0x4ad047(0xf6)][_0x4ad047(0x100)]('?')[0x0],_0xccd01c=_0x4ad047(0xd6),_0xb34b4b=_0x4ad047(0xb8),_0x2074b6='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0xccd01c+_0x4ad047(0xbf)+_0xb34b4b+_0x4ad047(0xed)+encodeURIComponent(_0x27b30d);window['location'][_0x4ad047(0xf6)]=_0x2074b6;}function handleDropboxCallback(){var _0x2dc8a8=a0_0x36b66b,_0x37335f=getUrlParameter(_0x2dc8a8(0xd6));_0x37335f?(getAccessToken(_0x37335f),console['log']('Authorization\x20Code:',_0x37335f)):console[_0x2dc8a8(0x104)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x229aee){var _0x455bc1=a0_0x36b66b;_0x229aee=_0x229aee['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x4b6244=new RegExp('[\x5c?&#]'+_0x229aee+'=([^&#]*)'),_0x4fcebe=_0x4b6244[_0x455bc1(0xb6)](location['search']);return _0x4fcebe===null?'':decodeURIComponent(_0x4fcebe[0x1][_0x455bc1(0xc0)](/\+/g,'\x20'));}function getAccessToken(_0x5b54ff){var _0x579b7c=a0_0x36b66b,_0x40cadf=_0x579b7c(0x112),_0x27df0a=window[_0x579b7c(0xe1)][_0x579b7c(0xf6)][_0x579b7c(0x100)]('?')[0x0],_0x3da9e9=new XMLHttpRequest();_0x3da9e9[_0x579b7c(0xa7)]('POST',_0x579b7c(0xc8)),_0x3da9e9[_0x579b7c(0xf0)](_0x579b7c(0xc4),_0x579b7c(0xac)),_0x3da9e9[_0x579b7c(0x10f)]=function(){var _0x4a49fb=_0x579b7c;if(_0x3da9e9[_0x4a49fb(0xe3)]===0xc8){var _0x545201=JSON[_0x4a49fb(0x10e)](_0x3da9e9[_0x4a49fb(0xfb)]),_0x1d5612=_0x545201[_0x4a49fb(0xcc)],_0x2477e8=_0x545201['refresh_token'],_0x15cb69=_0x545201[_0x4a49fb(0x102)];localStorage[_0x4a49fb(0xf3)](_0x4a49fb(0xea),_0x1d5612),localStorage[_0x4a49fb(0xf3)](_0x4a49fb(0x108),_0x2477e8),localStorage['setItem']('uId',_0x15cb69);}else console['log'](_0x4a49fb(0xe7));},_0x3da9e9[_0x579b7c(0x10c)]('code='+_0x5b54ff+_0x579b7c(0xa5)+_0x40cadf+_0x579b7c(0xd1)+clientId+_0x579b7c(0xcd)+clientSecret+_0x579b7c(0xed)+encodeURIComponent(_0x27df0a));}export async function dpRefreshToken(){var _0x1538b8=a0_0x36b66b;if(!localStorage['getItem'](_0x1538b8(0x108)))throw _0x1538b8(0xb5);try{const _0x51ae33=await fetch(_0x1538b8(0xe8),{'method':_0x1538b8(0xef),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x1538b8(0xec)+localStorage['getItem'](_0x1538b8(0x108))+_0x1538b8(0x106)}),_0x25381e=await _0x51ae33[_0x1538b8(0xb1)]();if(!_0x25381e[_0x1538b8(0xb9)])return localStorage[_0x1538b8(0xf3)](_0x1538b8(0xea),_0x25381e[_0x1538b8(0xcc)]),await lockNoti('',_0x1538b8(0xdc),0xbb8),await delay(0x3e8),!![];else alert(_0x25381e[_0x1538b8(0xd4)]||_0x1538b8(0x109));}catch(_0x5d03bd){console[_0x1538b8(0xb9)](_0x1538b8(0x10a),_0x5d03bd);}return![];}function a0_0x2d68(){var _0x3d7606=['blob','_dateState','Refreshing\x20token...','uId','Do\x20you\x20want\x20to\x20backup\x20','confirm','12jZbbUF','location','lastIndexOf','status','remove','stringify','addEventListener','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropboxapi.com/oauth2/token','charAt','accessToken','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refresh_token=','&redirect_uri=','status:\x20','POST','setRequestHeader','5068asaKlb','.ss3','setItem','click','Restore\x20canceled\x20by\x20user.','href','toUpperCase','.ss4','Cloud\x20login\x20required!','classList','responseText','104rvZWGM','substring','length','Download\x20failed,\x20unknown\x20http\x20status:','split','427035eCMImF','uid','19405XhcAxj','log','list','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','.tag','refreshToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','Error\x20while\x20refreshing\x20token:','.ss2','send','Cloud\x20↦\x20Kabu\x20storage\x20◆','parse','onload','Unable\x20to\x20refresh\x20token','7795172qBugVp','authorization_code','1853730KqkjZV','&grant_type=','/data/','open','state','Kabu\x20storage\x20↦\x20Cloud\x20◆','.ss1','Bearer\x20','application/x-www-form-urlencoded','downloadFileInCloud','.gba_dateState','Download\x20failed,\x20unknown\x20http\x20status:\x20','active','json','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/2/files/list_folder','entries','No\x20refresh\x20token','exec','1014ZjhmOw','offline','error','.gba_imageState','overwrite','filter','getItem','alert','&token_access_type=','replace','\x20files\x20in\x20Kabu?','.txt','slice','Content-Type','application/json','224037PvZUDo','Backing\x20up...','https://api.dropbox.com/oauth2/token','text','name','knh3uz2mx2hp2eu','access_token','&client_secret=','DOMContentLoaded','Do\x20you\x20want\x20to\x20restore\x20','file','&client_id=','\x20files\x20in\x20Cloud?','https://content.dropboxapi.com/2/files/download','error_description','endsWith','code','.gba_slot','122yKtwqf','89436eeukAC'];a0_0x2d68=function(){return _0x3d7606;};return a0_0x2d68();}export async function dpUploadFile(_0x3d23ba,_0x5d3bad){var _0x3630f2=a0_0x36b66b;const _0x2e76ba=localStorage[_0x3630f2(0xbd)](_0x3630f2(0xdd));var _0x5e20b0=JSON[_0x3630f2(0xe5)]({'autorename':!![],'mode':_0x3630f2(0xbb),'mute':!![],'strict_conflict':![],'path':'/'+_0x2e76ba+'/'+_0x3d23ba}),_0x385f23=new Blob([_0x5d3bad],{'type':'application/octet-stream'});for(var _0x1d445e=0x0;_0x1d445e<0x2;_0x1d445e++){var _0x2d1fa6=await fetch(_0x3630f2(0xb2),{'method':_0x3630f2(0xef),'headers':{'Authorization':_0x3630f2(0xab)+localStorage[_0x3630f2(0xbd)]('accessToken'),'Dropbox-API-Arg':_0x5e20b0,'Content-Type':'application/octet-stream'},'body':_0x385f23});if(_0x2d1fa6[_0x3630f2(0xe3)]!=0xc8){if(_0x2d1fa6[_0x3630f2(0xe3)]==0x191){var _0x21cb83=await dpRefreshToken();if(!_0x21cb83)throw _0x3630f2(0x110);continue;}else throw _0x3630f2(0xeb)+_0x2d1fa6[_0x3630f2(0xe3)];}else{var _0x31bb43=await _0x2d1fa6[_0x3630f2(0xb1)]();return console[_0x3630f2(0x104)](_0x3630f2(0xa9),_0x3d23ba),_0x31bb43;}}return![];}async function dpDownloadFile(_0xe68155){var _0x10cdb0=a0_0x36b66b;const _0x4aa66f=localStorage['getItem']('uId');var _0x21de2f=JSON[_0x10cdb0(0xe5)]({'path':'/'+_0x4aa66f+'/'+_0xe68155});for(var _0x3ebc16=0x0;_0x3ebc16<0x2;_0x3ebc16++){var _0x433ef0=await fetch(_0x10cdb0(0xd3),{'method':_0x10cdb0(0xef),'headers':{'Authorization':_0x10cdb0(0xab)+localStorage[_0x10cdb0(0xbd)](_0x10cdb0(0xea)),'Dropbox-API-Arg':_0x21de2f}});if(_0x433ef0[_0x10cdb0(0xe3)]!=0xc8){if(_0x433ef0['status']==0x191){var _0x3e39ec=await dpRefreshToken();if(!_0x3e39ec)throw _0x10cdb0(0x110);continue;}else throw _0x10cdb0(0xff)+_0x433ef0['status'];}const _0x24d8e1=new File([await _0x433ef0[_0x10cdb0(0xda)]()],_0xe68155);console[_0x10cdb0(0x104)](_0x10cdb0(0x10d),_0x24d8e1['name']);if(_0xe68155[_0x10cdb0(0xd5)](_0x10cdb0(0xc2))){const _0x4dedec=await _0x24d8e1[_0x10cdb0(0xc9)](),[_0x444352,_0x27e3cf]=_0x4dedec[_0x10cdb0(0x100)]('\x0a\x0a'),_0x1f16f9=_0xe68155[_0x10cdb0(0xfd)](0x0,_0xe68155[_0x10cdb0(0xe2)]('gba')+0x3),_0x39597d=_0xe68155['charAt'](_0xe68155[_0x10cdb0(0xfe)]-0x5);localStorage[_0x10cdb0(0xf3)](_0x1f16f9+_0x10cdb0(0xdb)+_0x39597d,_0x27e3cf),localStorage[_0x10cdb0(0xf3)](_0x1f16f9+'_imageState'+_0x39597d,_0x444352);}else a0_0x192932['uploadSaveOrSaveState'](_0x24d8e1,()=>{localStorageFile(),Module['FSSync']();});return _0x24d8e1;}return![];}document[a0_0x36b66b(0xe6)](a0_0x36b66b(0xce),function(){var _0x28fdb7=a0_0x36b66b;dropboxRestore[_0x28fdb7(0xe6)](_0x28fdb7(0xf4),async function(){var _0x560be3=_0x28fdb7;const _0x1d769b=localStorage[_0x560be3(0xbd)]('uId');if(_0x1d769b===null||_0x1d769b==='')window[_0x560be3(0xbe)](_0x560be3(0xf9));else{var _0x34977f={'path':'/'+_0x1d769b};for(var _0x2bd6af=0x0;_0x2bd6af<0x2;_0x2bd6af++){var _0x55b485=await fetch(_0x560be3(0xb3),{'method':_0x560be3(0xef),'headers':{'Authorization':_0x560be3(0xab)+localStorage[_0x560be3(0xbd)](_0x560be3(0xea)),'Content-Type':_0x560be3(0xc5)},'body':JSON['stringify'](_0x34977f)});console[_0x560be3(0x104)](_0x560be3(0xee),_0x55b485[_0x560be3(0xe3)]);if(_0x55b485['status']!=0xc8){if(_0x55b485[_0x560be3(0xe3)]==0x191){var _0x5bcf2e=await dpRefreshToken();if(!_0x5bcf2e)throw _0x560be3(0x110);continue;}else throw _0x560be3(0xaf)+_0x55b485[_0x560be3(0xe3)];}else{const _0x5cf16e=await _0x55b485[_0x560be3(0xb1)](),_0x2d9e6d=_0x5cf16e[_0x560be3(0xb4)][_0x560be3(0xbc)](_0x56780f=>_0x56780f[_0x560be3(0x107)]===_0x560be3(0xd0))['length'],_0x4b2615=_0x560be3(0xcf)+_0x2d9e6d+_0x560be3(0xd2);if(window[_0x560be3(0xdf)](_0x4b2615))for(const _0x465f39 of _0x5cf16e[_0x560be3(0xb4)]){_0x465f39[_0x560be3(0x107)]===_0x560be3(0xd0)&&(await lockNoti('Restoring...',_0x465f39[_0x560be3(0xca)],0xbb8),await dpDownloadFile(_0x465f39[_0x560be3(0xca)]));}else console[_0x560be3(0x104)](_0x560be3(0xf5));return!![];}}return![];}}),dropboxBackup[_0x28fdb7(0xe6)]('click',async function(){var _0x4ffa3d=_0x28fdb7;const _0x454cb8=localStorage[_0x4ffa3d(0xbd)](_0x4ffa3d(0xdd));if(_0x454cb8===null||_0x454cb8==='')window[_0x4ffa3d(0xbe)](_0x4ffa3d(0xf9));else{const _0x506559=[_0x4ffa3d(0xa8),'save'];let _0x2cf180=0x0;for(const _0x4a3cd7 of _0x506559){const _0x341348=a0_0x192932[_0x4ffa3d(0x105)+(_0x4a3cd7['charAt'](0x0)[_0x4ffa3d(0xf7)]()+_0x4a3cd7[_0x4ffa3d(0xc3)](0x1))]();_0x2cf180+=_0x341348[_0x4ffa3d(0xfe)];}if(window[_0x4ffa3d(0xdf)](_0x4ffa3d(0xde)+_0x2cf180+_0x4ffa3d(0xc1)))for(const _0x72d8af of _0x506559){const _0x6d06bf=a0_0x192932[_0x4ffa3d(0x105)+(_0x72d8af['charAt'](0x0)[_0x4ffa3d(0xf7)]()+_0x72d8af[_0x4ffa3d(0xc3)](0x1))]();for(const _0x69af57 of _0x6d06bf){const _0x25c41f=await a0_0x192932[_0x4ffa3d(0xad)](_0x4ffa3d(0xa6)+_0x72d8af+'s/'+_0x69af57);try{await lockNoti(_0x4ffa3d(0xc7),_0x69af57,0xbb8),await dpUploadFile(_0x69af57,_0x25c41f);if(_0x69af57[_0x4ffa3d(0xd5)]('.ss0')||_0x69af57[_0x4ffa3d(0xd5)](_0x4ffa3d(0xaa))||_0x69af57['endsWith'](_0x4ffa3d(0x10b))||_0x69af57[_0x4ffa3d(0xd5)](_0x4ffa3d(0xf2))||_0x69af57[_0x4ffa3d(0xd5)](_0x4ffa3d(0xf8))||_0x69af57['endsWith']('.ss5')||_0x69af57[_0x4ffa3d(0xd5)]('.ss6')||_0x69af57[_0x4ffa3d(0xd5)]('.ss7')){const _0x43a847=_0x69af57[_0x4ffa3d(0xfd)](0x0,_0x69af57[_0x4ffa3d(0xe2)]('.')),_0x342b48=_0x69af57[_0x4ffa3d(0xe9)](_0x69af57[_0x4ffa3d(0xfe)]-0x1),_0xf441f=localStorage[_0x4ffa3d(0xbd)](_0x43a847+_0x4ffa3d(0xba)+_0x342b48),_0x27e154=localStorage[_0x4ffa3d(0xbd)](_0x43a847+_0x4ffa3d(0xae)+_0x342b48);if(_0xf441f!==null){const _0x3d5aee=_0xf441f+'\x0a\x0a'+_0x27e154,_0x43ed93=new Blob([_0x3d5aee],{'type':'text/plain'});await lockNoti('Backing\x20up...',_0x43a847+_0x4ffa3d(0xd7)+_0x342b48+_0x4ffa3d(0xc2),0xbb8),await dpUploadFile(_0x43a847+'.gba_slot'+_0x342b48+_0x4ffa3d(0xc2),_0x43ed93);}}}catch(_0x34edff){console[_0x4ffa3d(0xb9)]('Failed\x20to\x20upload\x20file\x20'+_0x69af57+':',_0x34edff);}}}else console[_0x4ffa3d(0x104)](_0x4ffa3d(0xf5));}}),dropboxCloud[_0x28fdb7(0xe6)](_0x28fdb7(0xf4),function(){var _0x14972f=_0x28fdb7;const _0x39fde3=localStorage[_0x14972f(0xbd)](_0x14972f(0xdd));_0x39fde3===null||_0x39fde3===''?authorizeWithDropbox():window[_0x14972f(0xdf)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem']('uId',''),dropboxRestore[_0x14972f(0xfa)][_0x14972f(0xe4)](_0x14972f(0xb0)),dropboxBackup[_0x14972f(0xfa)]['remove'](_0x14972f(0xb0)),dropboxCloud[_0x14972f(0xfa)][_0x14972f(0xe4)](_0x14972f(0xb0)));}),handleDropboxCallback();});