var a0_0x82281c=a0_0x4e6f;(function(_0x1ca819,_0x44e579){var _0x1f2b81=a0_0x4e6f,_0x550499=_0x1ca819();while(!![]){try{var _0x23dca2=parseInt(_0x1f2b81(0x11f))/0x1*(-parseInt(_0x1f2b81(0xe1))/0x2)+-parseInt(_0x1f2b81(0x134))/0x3*(-parseInt(_0x1f2b81(0x109))/0x4)+parseInt(_0x1f2b81(0x112))/0x5+-parseInt(_0x1f2b81(0xec))/0x6+-parseInt(_0x1f2b81(0xe7))/0x7+parseInt(_0x1f2b81(0x138))/0x8*(parseInt(_0x1f2b81(0x114))/0x9)+-parseInt(_0x1f2b81(0x12d))/0xa*(-parseInt(_0x1f2b81(0xf1))/0xb);if(_0x23dca2===_0x44e579)break;else _0x550499['push'](_0x550499['shift']());}catch(_0x3fa126){_0x550499['push'](_0x550499['shift']());}}}(a0_0xf79d,0xbfd17));import*as a0_0x25a93f from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x82281c(0xf7);function a0_0x4e6f(_0xd9bd8c,_0x110a86){var _0xf79dd2=a0_0xf79d();return a0_0x4e6f=function(_0x4e6f72,_0x3f7d47){_0x4e6f72=_0x4e6f72-0xdb;var _0x4f70d9=_0xf79dd2[_0x4e6f72];return _0x4f70d9;},a0_0x4e6f(_0xd9bd8c,_0x110a86);}function authorizeWithDropbox(){var _0x488cc6=a0_0x82281c,_0x4357c2=window['location'][_0x488cc6(0x123)][_0x488cc6(0x10a)]('?')[0x0],_0x15c891=_0x488cc6(0xfb),_0x1be48e=_0x488cc6(0x12e),_0x450b13=_0x488cc6(0xf0)+clientId+_0x488cc6(0x127)+_0x15c891+_0x488cc6(0x12f)+_0x1be48e+_0x488cc6(0xe9)+encodeURIComponent(_0x4357c2);window[_0x488cc6(0x128)][_0x488cc6(0x123)]=_0x450b13;}function handleDropboxCallback(){var _0x1cd9e6=a0_0x82281c,_0xe2e6c1=getUrlParameter(_0x1cd9e6(0xfb));_0xe2e6c1?(getAccessToken(_0xe2e6c1),console[_0x1cd9e6(0x104)](_0x1cd9e6(0x10b),_0xe2e6c1)):console['log'](_0x1cd9e6(0xe3));}function a0_0xf79d(){var _0x3d871d=['Failed\x20to\x20upload\x20file\x20','save','length','https://api.dropbox.com/oauth2/token','entries','json','open','Download\x20failed,\x20unknown\x20http\x20status:','\x20files\x20in\x20Kabu?','onload','listFiles','14066iJpogl','No\x20files\x20found\x20to\x20restore.','Do\x20not\x20receive\x20authorization','Wait\x20a\x20little\x20bit...','&client_id=','addEventListener','5508601rRSgTE','Unable\x20to\x20refresh\x20token','&redirect_uri=','[\x5c?&#]','push','3169662aqQpIs','filter','file','uid','https://www.dropbox.com/oauth2/authorize?client_id=','1749tOSwZw','downloadFileInCloud','Failed\x20to\x20refresh\x20Dropbox\x20token.','POST','.tag','accessToken','nwb3dnfh09rhs31','application/json','/data/','code=','code','classList','application/octet-stream','active','Download\x20failed\x20for\x20','name','\x20files\x20from\x20Cloud?','getItem','error','log','refresh_token=','Cloud\x20login\x20required!','refresh_token','replace','4ECaTxZ','split','Authorization\x20Code:','Refreshing\x20token...','error_description','application/x-www-form-urlencoded','refreshToken','search','folder','4763280BchwOr','remove','900HAMJgz','exec','map','setRequestHeader','uId','Folder\x20already\x20exists','stringify','setItem','Backing\x20up...','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Restore\x20canceled\x20by\x20user.','47nLfpOo','state','screenshot','click','href','DOMContentLoaded','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20you\x20want\x20to\x20logout?','&response_type=','location','status','access_token','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20you\x20want\x20to\x20backup\x20','53270SSdpVw','offline','&token_access_type=','alert','confirm','No\x20refresh\x20token','=([^&#]*)','144927ADPZdK','Restoring...','responseText','Error\x20while\x20refreshing\x20token:','46680UkBxks','Bearer\x20','Folder\x20created'];a0_0xf79d=function(){return _0x3d871d;};return a0_0xf79d();}function getUrlParameter(_0x2da841){var _0x110956=a0_0x82281c;_0x2da841=_0x2da841[_0x110956(0x108)](/[\[]/,'\x5c[')[_0x110956(0x108)](/[\]]/,'\x5c]');var _0xc3667a=new RegExp(_0x110956(0xea)+_0x2da841+_0x110956(0x133)),_0x1253cd=_0xc3667a[_0x110956(0x115)](location[_0x110956(0x110)]);return _0x1253cd===null?'':decodeURIComponent(_0x1253cd[0x1][_0x110956(0x108)](/\+/g,'\x20'));}function getAccessToken(_0x29bc13){var _0x835ae1=a0_0x82281c,_0x3dfa2e='authorization_code',_0x55be4c=window[_0x835ae1(0x128)][_0x835ae1(0x123)][_0x835ae1(0x10a)]('?')[0x0],_0x4778fb=new XMLHttpRequest();_0x4778fb[_0x835ae1(0xdc)](_0x835ae1(0xf4),_0x835ae1(0x13e)),_0x4778fb[_0x835ae1(0x117)]('Content-Type','application/x-www-form-urlencoded'),_0x4778fb[_0x835ae1(0xdf)]=function(){var _0x4b73a6=_0x835ae1;if(_0x4778fb['status']===0xc8){var _0x56e565=JSON['parse'](_0x4778fb[_0x4b73a6(0x136)]),_0x58e00c=_0x56e565[_0x4b73a6(0x12a)],_0x59dee4=_0x56e565[_0x4b73a6(0x107)],_0x302f79=_0x56e565[_0x4b73a6(0xef)];localStorage['setItem']('accessToken',_0x58e00c),localStorage['setItem'](_0x4b73a6(0x10f),_0x59dee4),localStorage[_0x4b73a6(0x11b)](_0x4b73a6(0x118),_0x302f79);}else console[_0x4b73a6(0x104)](_0x4b73a6(0x125));},_0x4778fb['send'](_0x835ae1(0xfa)+_0x29bc13+'&grant_type='+_0x3dfa2e+_0x835ae1(0xe5)+clientId+'&client_secret='+clientSecret+_0x835ae1(0xe9)+encodeURIComponent(_0x55be4c));}export async function dpCreateFolder(_0x529813){var _0x2bf29b=a0_0x82281c;const _0x18271a=localStorage[_0x2bf29b(0x102)](_0x2bf29b(0x118));let _0x1b218e=localStorage[_0x2bf29b(0x102)](_0x2bf29b(0xf6));const _0x448614='/'+_0x18271a+'/'+_0x529813,_0x5d0e62=JSON[_0x2bf29b(0x11a)]({'path':_0x448614,'autorename':![]});for(let _0x40ef1a=0x0;_0x40ef1a<0x2;_0x40ef1a++){try{const _0x5ee324=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x2bf29b(0x139)+_0x1b218e,'Content-Type':_0x2bf29b(0xf8)},'body':_0x5d0e62});if(_0x5ee324['status']===0x191){const _0x342569=await dpRefreshToken();if(!_0x342569)throw new Error(_0x2bf29b(0xe8));_0x1b218e=localStorage[_0x2bf29b(0x102)](_0x2bf29b(0xf6));continue;}if(_0x5ee324[_0x2bf29b(0x129)]===0x199)return{'message':_0x2bf29b(0x119),'path':_0x529813};if(!_0x5ee324['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x529813);const _0x18339d=await _0x5ee324[_0x2bf29b(0xdb)]();return await lockNoti(_0x2bf29b(0x13a),'',0xbb8),_0x18339d;}catch(_0xfe61c7){if(_0x40ef1a===0x1)throw _0xfe61c7;}}return![];}export async function dpRefreshToken(){var _0x3ecd55=a0_0x82281c;if(!localStorage[_0x3ecd55(0x102)](_0x3ecd55(0x10f)))throw _0x3ecd55(0x132);try{const _0x41177a=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x3ecd55(0x10e)},'body':_0x3ecd55(0x105)+localStorage[_0x3ecd55(0x102)](_0x3ecd55(0x10f))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x77fdeb=await _0x41177a['json']();if(!_0x77fdeb[_0x3ecd55(0x103)])return localStorage[_0x3ecd55(0x11b)]('accessToken',_0x77fdeb[_0x3ecd55(0x12a)]),await lockNoti(_0x3ecd55(0x10c),'',0xbb8),await delay(0x3e8),!![];else alert(_0x77fdeb[_0x3ecd55(0x10d)]||_0x3ecd55(0xf3));}catch(_0xfc6123){console[_0x3ecd55(0x103)](_0x3ecd55(0x137),_0xfc6123);}return![];}export async function dpUploadFile(_0x45940c,_0x126500,_0x5ff8f8){var _0x42cfc4=a0_0x82281c;const _0x3ecf00=localStorage['getItem'](_0x42cfc4(0x118));var _0x691c0f=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x3ecf00+'/'+_0x5ff8f8+'/'+_0x45940c}),_0x24aef6=new Blob([_0x126500],{'type':_0x42cfc4(0xfd)});for(var _0x27e18c=0x0;_0x27e18c<0x2;_0x27e18c++){var _0x5368f3=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x42cfc4(0xf4),'headers':{'Authorization':_0x42cfc4(0x139)+localStorage['getItem'](_0x42cfc4(0xf6)),'Dropbox-API-Arg':_0x691c0f,'Content-Type':_0x42cfc4(0xfd)},'body':_0x24aef6});if(_0x5368f3['status']!=0xc8){if(_0x5368f3[_0x42cfc4(0x129)]==0x191){var _0x289486=await dpRefreshToken();if(!_0x289486)throw _0x42cfc4(0xe8);continue;}else throw _0x42cfc4(0x11d)+_0x5368f3['status'];}else{var _0x160549=await _0x5368f3[_0x42cfc4(0xdb)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x45940c),_0x160549;}}return![];}export async function dpDownloadFile(_0x5e29e4,_0x596c7c){var _0x28309e=a0_0x82281c;const _0x158a4f=localStorage[_0x28309e(0x102)](_0x28309e(0x118));var _0x3768d5=JSON['stringify']({'path':'/'+_0x158a4f+'/'+_0x596c7c+'/'+_0x5e29e4});for(var _0x190d07=0x0;_0x190d07<0x2;_0x190d07++){var _0x371cca=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x28309e(0x139)+localStorage[_0x28309e(0x102)](_0x28309e(0xf6)),'Dropbox-API-Arg':_0x3768d5}});if(_0x371cca[_0x28309e(0x129)]!=0xc8){if(_0x371cca[_0x28309e(0x129)]==0x191){var _0x1d1367=await dpRefreshToken();if(!_0x1d1367)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x28309e(0xdd)+_0x371cca[_0x28309e(0x129)];}const _0x17ed28=new File([await _0x371cca['blob']()],_0x5e29e4);return console[_0x28309e(0x104)](_0x28309e(0x12b),_0x17ed28[_0x28309e(0x100)]),a0_0x25a93f['uploadFileInCloud'](_0x17ed28,()=>{}),_0x17ed28;}return![];}document[a0_0x82281c(0xe6)](a0_0x82281c(0x124),function(){var _0x339b51=a0_0x82281c;dropboxRestore[_0x339b51(0xe6)](_0x339b51(0x122),async function(){var _0x23acdf=_0x339b51;await lockNoti(_0x23acdf(0xe4),'',0x1388);const _0xb55188=localStorage['getItem']('uId'),_0x38e91d=[_0x23acdf(0x120),_0x23acdf(0x13c),_0x23acdf(0x121)];if(!_0xb55188){window[_0x23acdf(0x130)](_0x23acdf(0x106));return;}let _0x16bd4a=[];for(const _0x2b93e2 of _0x38e91d){let _0x2842bc={'path':'/'+_0xb55188+'/'+_0x2b93e2};for(let _0x28bc7f=0x0;_0x28bc7f<0x2;_0x28bc7f++){let _0x56bf6b=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x23acdf(0xf4),'headers':{'Authorization':_0x23acdf(0x139)+localStorage[_0x23acdf(0x102)](_0x23acdf(0xf6)),'Content-Type':_0x23acdf(0xf8)},'body':JSON[_0x23acdf(0x11a)](_0x2842bc)});if(_0x56bf6b[_0x23acdf(0x129)]===0xc8){let _0x92062d=await _0x56bf6b[_0x23acdf(0xdb)](),_0x596d13=_0x92062d[_0x23acdf(0x13f)][_0x23acdf(0xed)](_0x1cab65=>_0x1cab65[_0x23acdf(0xf5)]===_0x23acdf(0xee));_0x596d13[_0x23acdf(0x13d)]>0x0&&_0x16bd4a[_0x23acdf(0xeb)](..._0x596d13[_0x23acdf(0x116)](_0x51ee31=>({'name':_0x51ee31['name'],'folder':_0x2b93e2})));break;}else{if(_0x56bf6b[_0x23acdf(0x129)]===0x191){let _0x3e9070=await dpRefreshToken();if(!_0x3e9070)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x23acdf(0xff)+_0x2b93e2+',\x20status:\x20'+_0x56bf6b['status']);break;}}}}if(_0x16bd4a[_0x23acdf(0x13d)]>0x0){const _0x1cd185='Do\x20you\x20want\x20to\x20restore\x20'+_0x16bd4a[_0x23acdf(0x13d)]+_0x23acdf(0x101);if(window[_0x23acdf(0x131)](_0x1cd185))for(const _0x25dcaa of _0x16bd4a){await lockNoti(_0x23acdf(0x135),_0x25dcaa['name'],0xbb8),await dpDownloadFile(_0x25dcaa['name'],_0x25dcaa[_0x23acdf(0x111)]);}else console['log'](_0x23acdf(0x11e));}else console[_0x23acdf(0x104)](_0x23acdf(0xe2));}),dropboxBackup[_0x339b51(0xe6)](_0x339b51(0x122),async function(){var _0x468fbb=_0x339b51;await lockNoti(_0x468fbb(0xe4),'',0x1388);const _0x9976b5=localStorage[_0x468fbb(0x102)](_0x468fbb(0x118));if(_0x9976b5===null||_0x9976b5==='')window['alert'](_0x468fbb(0x106));else{const _0x17a093=[_0x468fbb(0x120),_0x468fbb(0x13c),_0x468fbb(0x121)];for(const _0x20c739 of _0x17a093){await dpCreateFolder(_0x20c739);}let _0x358bea=0x0;for(const _0x20302a of _0x17a093){const _0xb704d6=a0_0x25a93f[_0x468fbb(0xe0)](_0x20302a+'s');_0x358bea+=_0xb704d6['length'];}if(window[_0x468fbb(0x131)](_0x468fbb(0x12c)+_0x358bea+_0x468fbb(0xde)))for(const _0x3cbbc4 of _0x17a093){const _0x507673=a0_0x25a93f['listFiles'](_0x3cbbc4+'s');for(const _0x129ed6 of _0x507673){const _0x1d3127=await a0_0x25a93f[_0x468fbb(0xf2)](_0x468fbb(0xf9)+_0x3cbbc4+'s/'+_0x129ed6);try{await lockNoti(_0x468fbb(0x11c),_0x129ed6,0xbb8),await dpUploadFile(_0x129ed6,_0x1d3127,_0x3cbbc4);}catch(_0x53cba5){console[_0x468fbb(0x103)](_0x468fbb(0x13b)+_0x129ed6+':',_0x53cba5);}}}else console[_0x468fbb(0x104)](_0x468fbb(0x11e));}}),dropboxCloud[_0x339b51(0xe6)](_0x339b51(0x122),function(){var _0xb2de29=_0x339b51;const _0xc77755=localStorage[_0xb2de29(0x102)](_0xb2de29(0x118));_0xc77755===null||_0xc77755===''?authorizeWithDropbox():window['confirm'](_0xb2de29(0x126))&&(localStorage[_0xb2de29(0x11b)](_0xb2de29(0x118),''),dropboxRestore['classList']['remove'](_0xb2de29(0xfe)),dropboxBackup[_0xb2de29(0xfc)]['remove'](_0xb2de29(0xfe)),dropboxCloud['classList'][_0xb2de29(0x113)](_0xb2de29(0xfe)));}),handleDropboxCallback();});