function a0_0x3400(_0x1b8d98,_0x4c1eb4){var _0x33f446=a0_0x33f4();return a0_0x3400=function(_0x340005,_0x409374){_0x340005=_0x340005-0x121;var _0x2d3b00=_0x33f446[_0x340005];return _0x2d3b00;},a0_0x3400(_0x1b8d98,_0x4c1eb4);}function a0_0x33f4(){var _0xbf4ad=['7YqHyDO','498912fmoPai','551182qcQkcn','downloadFileInCloud','Authorization\x20Code:','file','application/x-www-form-urlencoded','error_description','https://content.dropboxapi.com/2/files/download','access_token','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','https://www.dropbox.com/oauth2/authorize?client_id=','alert','441408DZROSL','status','active','https://api.dropboxapi.com/oauth2/token','folder','send','&client_secret=','replace','https://api.dropboxapi.com/2/files/list_folder','Do\x20you\x20want\x20to\x20logout?','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Wait\x20a\x20little\x20bit...','authorization_code','log','Restore\x20canceled\x20by\x20user.','Do\x20not\x20receive\x20authorization','Bearer\x20','Restoring...','accessToken','setItem','remove','responseText','overwrite','uid','href','setRequestHeader','application/octet-stream','split','40509XnoAXM',',\x20status:\x20','Refreshing\x20token...','push','save','Cloud\x20login\x20required!','Unable\x20to\x20refresh\x20token','&client_id=','nwb3dnfh09rhs31','code','/data/','state','Do\x20you\x20want\x20to\x20restore\x20','524xToFoe','586846uuSjQp','Download\x20failed,\x20unknown\x20http\x20status:','entries','Folder\x20already\x20exists','POST','refresh_token=','classList','=([^&#]*)','uId','Backing\x20up...','screenshot','listFiles','getItem','.tag','372HWjvtY','confirm','Do\x20you\x20want\x20to\x20backup\x20','[\x5c?&#]','stringify','Error\x20while\x20refreshing\x20token:','Error\x20creating\x20folder\x20','name','addEventListener','\x20files\x20from\x20Cloud?','length','Cloud\x20↦\x20Kabu\x20storage\x20◆','search','&redirect_uri=','1370ZozcFa','code=','error','json','3052545nqMtUP','\x20files\x20in\x20Kabu?','location','No\x20refresh\x20token','Folder\x20created','No\x20files\x20found\x20to\x20restore.','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/json','click'];a0_0x33f4=function(){return _0xbf4ad;};return a0_0x33f4();}var a0_0x4cb76f=a0_0x3400;(function(_0x3df2a1,_0x566e57){var _0x181fbe=a0_0x3400,_0xecc6f1=_0x3df2a1();while(!![]){try{var _0x416aea=parseInt(_0x181fbe(0x159))/0x1+-parseInt(_0x181fbe(0x123))/0x2+parseInt(_0x181fbe(0x167))/0x3*(parseInt(_0x181fbe(0x158))/0x4)+parseInt(_0x181fbe(0x179))/0x5+-parseInt(_0x181fbe(0x12f))/0x6+parseInt(_0x181fbe(0x121))/0x7*(parseInt(_0x181fbe(0x122))/0x8)+-parseInt(_0x181fbe(0x14b))/0x9*(parseInt(_0x181fbe(0x175))/0xa);if(_0x416aea===_0x566e57)break;else _0xecc6f1['push'](_0xecc6f1['shift']());}catch(_0x4a4385){_0xecc6f1['push'](_0xecc6f1['shift']());}}}(a0_0x33f4,0x4bb97));import*as a0_0x4cec61 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x4cb76f(0x153);function authorizeWithDropbox(){var _0x223d24=a0_0x4cb76f,_0x28c732=window[_0x223d24(0x17b)]['href']['split']('?')[0x0],_0x20c4c5=_0x223d24(0x154),_0x2a6608='offline',_0x666f19=_0x223d24(0x12d)+clientId+'&response_type='+_0x20c4c5+'&token_access_type='+_0x2a6608+_0x223d24(0x174)+encodeURIComponent(_0x28c732);window['location'][_0x223d24(0x147)]=_0x666f19;}function handleDropboxCallback(){var _0x2d97a4=a0_0x4cb76f,_0x515025=getUrlParameter('code');_0x515025?(getAccessToken(_0x515025),console[_0x2d97a4(0x13c)](_0x2d97a4(0x125),_0x515025)):console[_0x2d97a4(0x13c)](_0x2d97a4(0x13e));}function getUrlParameter(_0x2c1401){var _0x25537c=a0_0x4cb76f;_0x2c1401=_0x2c1401[_0x25537c(0x136)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x1ee4e4=new RegExp(_0x25537c(0x16a)+_0x2c1401+_0x25537c(0x160)),_0xffbec8=_0x1ee4e4['exec'](location[_0x25537c(0x173)]);return _0xffbec8===null?'':decodeURIComponent(_0xffbec8[0x1][_0x25537c(0x136)](/\+/g,'\x20'));}function getAccessToken(_0x31335d){var _0x4fdf2c=a0_0x4cb76f,_0x1a2a26=_0x4fdf2c(0x13b),_0x492c12=window['location']['href'][_0x4fdf2c(0x14a)]('?')[0x0],_0x2faa1a=new XMLHttpRequest();_0x2faa1a['open']('POST','https://api.dropbox.com/oauth2/token'),_0x2faa1a[_0x4fdf2c(0x148)]('Content-Type',_0x4fdf2c(0x127)),_0x2faa1a['onload']=function(){var _0x4ff7ff=_0x4fdf2c;if(_0x2faa1a[_0x4ff7ff(0x130)]===0xc8){var _0x2e9c26=JSON['parse'](_0x2faa1a[_0x4ff7ff(0x144)]),_0x5e79bf=_0x2e9c26[_0x4ff7ff(0x12a)],_0x43af41=_0x2e9c26['refresh_token'],_0x41b755=_0x2e9c26[_0x4ff7ff(0x146)];localStorage[_0x4ff7ff(0x142)]('accessToken',_0x5e79bf),localStorage['setItem'](_0x4ff7ff(0x12c),_0x43af41),localStorage[_0x4ff7ff(0x142)](_0x4ff7ff(0x161),_0x41b755);}else console[_0x4ff7ff(0x13c)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x2faa1a[_0x4fdf2c(0x134)](_0x4fdf2c(0x176)+_0x31335d+'&grant_type='+_0x1a2a26+_0x4fdf2c(0x152)+clientId+_0x4fdf2c(0x135)+clientSecret+_0x4fdf2c(0x174)+encodeURIComponent(_0x492c12));}export async function dpCreateFolder(_0x3a784c){var _0x919d43=a0_0x4cb76f;const _0x43c578=localStorage[_0x919d43(0x165)]('uId');let _0x336758=localStorage[_0x919d43(0x165)](_0x919d43(0x141));const _0x332c6e='/'+_0x43c578+'/'+_0x3a784c,_0x579a28=JSON['stringify']({'path':_0x332c6e,'autorename':![]});for(let _0x11d6ad=0x0;_0x11d6ad<0x2;_0x11d6ad++){try{const _0x423dc9=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x919d43(0x15d),'headers':{'Authorization':'Bearer\x20'+_0x336758,'Content-Type':_0x919d43(0x180)},'body':_0x579a28});if(_0x423dc9['status']===0x191){const _0x2afb06=await dpRefreshToken();if(!_0x2afb06)throw new Error('Unable\x20to\x20refresh\x20token');_0x336758=localStorage[_0x919d43(0x165)](_0x919d43(0x141));continue;}if(_0x423dc9['status']===0x199)return{'message':_0x919d43(0x15c),'path':_0x3a784c};if(!_0x423dc9['ok'])throw new Error(_0x919d43(0x16d)+_0x3a784c);const _0x25940b=await _0x423dc9[_0x919d43(0x178)]();return await lockNoti(_0x919d43(0x17d),'',0xbb8),_0x25940b;}catch(_0x4d1b5e){if(_0x11d6ad===0x1)throw _0x4d1b5e;}}return![];}export async function dpRefreshToken(){var _0x5e5141=a0_0x4cb76f;if(!localStorage[_0x5e5141(0x165)](_0x5e5141(0x12c)))throw _0x5e5141(0x17c);try{const _0x214faa=await fetch(_0x5e5141(0x132),{'method':_0x5e5141(0x15d),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x5e5141(0x15e)+localStorage[_0x5e5141(0x165)](_0x5e5141(0x12c))+_0x5e5141(0x139)}),_0x5da0ca=await _0x214faa['json']();if(!_0x5da0ca['error'])return localStorage[_0x5e5141(0x142)]('accessToken',_0x5da0ca[_0x5e5141(0x12a)]),await lockNoti(_0x5e5141(0x14d),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5da0ca[_0x5e5141(0x128)]||_0x5e5141(0x17f));}catch(_0x2daf9c){console[_0x5e5141(0x177)](_0x5e5141(0x16c),_0x2daf9c);}return![];}export async function dpUploadFile(_0x3598aa,_0xb20cd8,_0x11e0b3){var _0x552557=a0_0x4cb76f;const _0x14de02=localStorage['getItem'](_0x552557(0x161));var _0x30865e=JSON[_0x552557(0x16b)]({'autorename':!![],'mode':_0x552557(0x145),'mute':!![],'strict_conflict':![],'path':'/'+_0x14de02+'/'+_0x11e0b3+'/'+_0x3598aa}),_0x9250be=new Blob([_0xb20cd8],{'type':_0x552557(0x149)});for(var _0x5824df=0x0;_0x5824df<0x2;_0x5824df++){var _0x4ddecf=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x552557(0x15d),'headers':{'Authorization':_0x552557(0x13f)+localStorage[_0x552557(0x165)](_0x552557(0x141)),'Dropbox-API-Arg':_0x30865e,'Content-Type':'application/octet-stream'},'body':_0x9250be});if(_0x4ddecf[_0x552557(0x130)]!=0xc8){if(_0x4ddecf[_0x552557(0x130)]==0x191){var _0x58d11e=await dpRefreshToken();if(!_0x58d11e)throw _0x552557(0x151);continue;}else throw _0x552557(0x12b)+_0x4ddecf[_0x552557(0x130)];}else{var _0x1fd8bc=await _0x4ddecf[_0x552557(0x178)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x3598aa),_0x1fd8bc;}}return![];}export async function dpDownloadFile(_0x38c0d4,_0x3cd282){var _0x11b32e=a0_0x4cb76f;const _0xb86974=localStorage[_0x11b32e(0x165)]('uId');var _0x2ec5a1=JSON[_0x11b32e(0x16b)]({'path':'/'+_0xb86974+'/'+_0x3cd282+'/'+_0x38c0d4});for(var _0x359796=0x0;_0x359796<0x2;_0x359796++){var _0x21614e=await fetch(_0x11b32e(0x129),{'method':_0x11b32e(0x15d),'headers':{'Authorization':_0x11b32e(0x13f)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x2ec5a1}});if(_0x21614e['status']!=0xc8){if(_0x21614e[_0x11b32e(0x130)]==0x191){var _0x47917d=await dpRefreshToken();if(!_0x47917d)throw _0x11b32e(0x151);continue;}else throw _0x11b32e(0x15a)+_0x21614e['status'];}const _0x242e21=new File([await _0x21614e['blob']()],_0x38c0d4);return console[_0x11b32e(0x13c)](_0x11b32e(0x172),_0x242e21['name']),a0_0x4cec61['uploadFileInCloud'](_0x242e21,()=>{}),_0x242e21;}return![];}document[a0_0x4cb76f(0x16f)]('DOMContentLoaded',function(){var _0xb25cdd=a0_0x4cb76f;dropboxRestore[_0xb25cdd(0x16f)](_0xb25cdd(0x181),async function(){var _0x51ad00=_0xb25cdd;await lockNoti(_0x51ad00(0x13a),'',0x1388);const _0x3b5cb8=localStorage[_0x51ad00(0x165)]('uId'),_0x327caf=[_0x51ad00(0x156),_0x51ad00(0x14f),_0x51ad00(0x163)];if(!_0x3b5cb8){window[_0x51ad00(0x12e)](_0x51ad00(0x150));return;}let _0x1944a1=[];for(const _0x2ad268 of _0x327caf){let _0x1e0fc9={'path':'/'+_0x3b5cb8+'/'+_0x2ad268};for(let _0x2f3f70=0x0;_0x2f3f70<0x2;_0x2f3f70++){let _0x376f0d=await fetch(_0x51ad00(0x137),{'method':'POST','headers':{'Authorization':_0x51ad00(0x13f)+localStorage[_0x51ad00(0x165)](_0x51ad00(0x141)),'Content-Type':_0x51ad00(0x180)},'body':JSON[_0x51ad00(0x16b)](_0x1e0fc9)});if(_0x376f0d[_0x51ad00(0x130)]===0xc8){let _0x5a3fb6=await _0x376f0d['json'](),_0x168c1f=_0x5a3fb6[_0x51ad00(0x15b)]['filter'](_0x5bdeaf=>_0x5bdeaf[_0x51ad00(0x166)]===_0x51ad00(0x126));_0x168c1f['length']>0x0&&_0x1944a1[_0x51ad00(0x14e)](..._0x168c1f['map'](_0x2d7afd=>({'name':_0x2d7afd[_0x51ad00(0x16e)],'folder':_0x2ad268})));break;}else{if(_0x376f0d['status']===0x191){let _0x4f20d5=await dpRefreshToken();if(!_0x4f20d5)throw _0x51ad00(0x151);}else{console['error']('Download\x20failed\x20for\x20'+_0x2ad268+_0x51ad00(0x14c)+_0x376f0d['status']);break;}}}}if(_0x1944a1['length']>0x0){const _0x27e58c=_0x51ad00(0x157)+_0x1944a1[_0x51ad00(0x171)]+_0x51ad00(0x170);if(window[_0x51ad00(0x168)](_0x27e58c))for(const _0x2df828 of _0x1944a1){await lockNoti(_0x51ad00(0x140),_0x2df828[_0x51ad00(0x16e)],0xbb8),await dpDownloadFile(_0x2df828[_0x51ad00(0x16e)],_0x2df828[_0x51ad00(0x133)]);}else console[_0x51ad00(0x13c)](_0x51ad00(0x13d));}else console[_0x51ad00(0x13c)](_0x51ad00(0x17e));}),dropboxBackup['addEventListener'](_0xb25cdd(0x181),async function(){var _0x3ff41e=_0xb25cdd;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x56c085=localStorage[_0x3ff41e(0x165)]('uId');if(_0x56c085===null||_0x56c085==='')window['alert'](_0x3ff41e(0x150));else{const _0x1afb08=[_0x3ff41e(0x156),'save',_0x3ff41e(0x163)];for(const _0x55bdf4 of _0x1afb08){await dpCreateFolder(_0x55bdf4);}let _0x529d17=0x0;for(const _0xd1c586 of _0x1afb08){const _0x52d50c=a0_0x4cec61['listFiles'](_0xd1c586+'s');_0x529d17+=_0x52d50c['length'];}if(window['confirm'](_0x3ff41e(0x169)+_0x529d17+_0x3ff41e(0x17a)))for(const _0x336321 of _0x1afb08){const _0x42b3c9=a0_0x4cec61[_0x3ff41e(0x164)](_0x336321+'s');for(const _0x1905bb of _0x42b3c9){const _0x4a0a79=await a0_0x4cec61[_0x3ff41e(0x124)](_0x3ff41e(0x155)+_0x336321+'s/'+_0x1905bb);try{await lockNoti(_0x3ff41e(0x162),_0x1905bb,0xbb8),await dpUploadFile(_0x1905bb,_0x4a0a79,_0x336321);}catch(_0x66ad9){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x1905bb+':',_0x66ad9);}}}else console[_0x3ff41e(0x13c)](_0x3ff41e(0x13d));}}),dropboxCloud[_0xb25cdd(0x16f)](_0xb25cdd(0x181),function(){var _0x5bfe9b=_0xb25cdd;const _0xd9592c=localStorage[_0x5bfe9b(0x165)]('uId');_0xd9592c===null||_0xd9592c===''?authorizeWithDropbox():window[_0x5bfe9b(0x168)](_0x5bfe9b(0x138))&&(localStorage[_0x5bfe9b(0x142)](_0x5bfe9b(0x161),''),dropboxRestore['classList'][_0x5bfe9b(0x143)]('active'),dropboxBackup['classList']['remove'](_0x5bfe9b(0x131)),dropboxCloud[_0x5bfe9b(0x15f)][_0x5bfe9b(0x143)](_0x5bfe9b(0x131)));}),handleDropboxCallback();});