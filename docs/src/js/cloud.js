var a0_0x2ead4a=a0_0x107a;(function(_0x450647,_0x447062){var _0x213d92=a0_0x107a,_0x3b9879=_0x450647();while(!![]){try{var _0x593a49=-parseInt(_0x213d92(0x1bf))/0x1*(-parseInt(_0x213d92(0x181))/0x2)+parseInt(_0x213d92(0x1a5))/0x3+parseInt(_0x213d92(0x1cc))/0x4*(-parseInt(_0x213d92(0x18c))/0x5)+-parseInt(_0x213d92(0x171))/0x6*(-parseInt(_0x213d92(0x192))/0x7)+-parseInt(_0x213d92(0x1aa))/0x8+-parseInt(_0x213d92(0x16f))/0x9+-parseInt(_0x213d92(0x1c8))/0xa*(-parseInt(_0x213d92(0x168))/0xb);if(_0x593a49===_0x447062)break;else _0x3b9879['push'](_0x3b9879['shift']());}catch(_0x4188a7){_0x3b9879['push'](_0x3b9879['shift']());}}}(a0_0x5497,0xd4c6d));import*as a0_0x5b1aff from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2ead4a(0x198),clientSecret=a0_0x2ead4a(0x19d);function authorizeWithDropbox(){var _0x3906d9=a0_0x2ead4a,_0x3b5f6e=window[_0x3906d9(0x176)]['href'][_0x3906d9(0x183)]('?')[0x0],_0x1f5e30='code',_0x1b216e=_0x3906d9(0x1b9),_0x523104=_0x3906d9(0x1ac)+clientId+_0x3906d9(0x1bd)+_0x1f5e30+_0x3906d9(0x17d)+_0x1b216e+_0x3906d9(0x1c9)+encodeURIComponent(_0x3b5f6e);window['location'][_0x3906d9(0x17e)]=_0x523104;}function handleDropboxCallback(){var _0xe3d430=a0_0x2ead4a,_0x5c7918=getUrlParameter(_0xe3d430(0x1b6));_0x5c7918?(getAccessToken(_0x5c7918),console[_0xe3d430(0x1c0)](_0xe3d430(0x1c6),_0x5c7918)):console[_0xe3d430(0x1c0)](_0xe3d430(0x1ad));}function getUrlParameter(_0x341009){var _0x231d96=a0_0x2ead4a;_0x341009=_0x341009[_0x231d96(0x172)](/[\[]/,'\x5c[')[_0x231d96(0x172)](/[\]]/,'\x5c]');var _0x4feb92=new RegExp(_0x231d96(0x174)+_0x341009+_0x231d96(0x18b)),_0xdaeb37=_0x4feb92[_0x231d96(0x1cd)](location['search']);return _0xdaeb37===null?'':decodeURIComponent(_0xdaeb37[0x1][_0x231d96(0x172)](/\+/g,'\x20'));}function getAccessToken(_0xd738dc){var _0x56a777=a0_0x2ead4a,_0x5082fe=_0x56a777(0x1be),_0x5f48a9=window[_0x56a777(0x176)][_0x56a777(0x17e)][_0x56a777(0x183)]('?')[0x0],_0x380266=new XMLHttpRequest();_0x380266[_0x56a777(0x1ae)]('POST','https://api.dropbox.com/oauth2/token'),_0x380266['setRequestHeader'](_0x56a777(0x170),_0x56a777(0x1a9)),_0x380266[_0x56a777(0x1c3)]=function(){var _0x54043a=_0x56a777;if(_0x380266['status']===0xc8){var _0x4bac27=JSON['parse'](_0x380266[_0x54043a(0x1b3)]),_0x3af040=_0x4bac27[_0x54043a(0x19a)],_0x1e8051=_0x4bac27[_0x54043a(0x175)],_0x182a7b=_0x4bac27[_0x54043a(0x1a7)];localStorage[_0x54043a(0x16c)](_0x54043a(0x177),_0x3af040),localStorage['setItem'](_0x54043a(0x17a),_0x1e8051),localStorage['setItem'](_0x54043a(0x1b1),_0x182a7b);}else console[_0x54043a(0x1c0)](_0x54043a(0x196));},_0x380266[_0x56a777(0x17b)](_0x56a777(0x16e)+_0xd738dc+'&grant_type='+_0x5082fe+'&client_id='+clientId+_0x56a777(0x194)+clientSecret+_0x56a777(0x1c9)+encodeURIComponent(_0x5f48a9));}function a0_0x5497(){var _0x8fbcc8=['uploadFileInCloud','Do\x20you\x20want\x20to\x20restore\x20','click','=([^&#]*)','105MEYjVT','Failed\x20to\x20upload\x20file\x20','Wait\x20a\x20little\x20bit...','blob','application/octet-stream','Backing\x20up...','7npkijg','active','&client_secret=','confirm','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','\x20files\x20from\x20Cloud?','knh3uz2mx2hp2eu','DOMContentLoaded','access_token','Folder\x20already\x20exists','state','nwb3dnfh09rhs31','file','entries','https://content.dropboxapi.com/2/files/download','Do\x20you\x20want\x20to\x20backup\x20','json','Error\x20while\x20refreshing\x20token:','getItem','2366061ulFcfu','Error\x20creating\x20folder\x20','uid','addEventListener','application/x-www-form-urlencoded','3279704pWcxkT','Restore\x20canceled\x20by\x20user.','https://www.dropbox.com/oauth2/authorize?client_id=','Do\x20not\x20receive\x20authorization','open','remove','error_description','uId','Do\x20you\x20want\x20to\x20logout?','responseText','/data/','push','code',',\x20status:\x20','folder','offline','stringify','https://content.dropboxapi.com/2/files/upload','No\x20refresh\x20token','&response_type=','authorization_code','2WlTxvm','log','Failed\x20to\x20refresh\x20Dropbox\x20token.','classList','onload','.tag','map','Authorization\x20Code:','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','30BLeHAy','&redirect_uri=','Unable\x20to\x20refresh\x20token','screenshot','252104CCeZmx','exec','Download\x20failed,\x20unknown\x20http\x20status:','POST','status','https://api.dropboxapi.com/2/files/list_folder','name','571329okxAYs','overwrite','Download\x20failed\x20for\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','setItem','alert','code=','3683853CZruRb','Content-Type','7569654zCFPxp','replace','Cloud\x20↦\x20Kabu\x20storage\x20◆','[\x5c?&#]','refresh_token','location','accessToken','error','https://api.dropboxapi.com/oauth2/token','refreshToken','send','Folder\x20created','&token_access_type=','href','Bearer\x20','listFiles','808246UQasUG','length','split','Cloud\x20login\x20required!','save','filter','Refreshing\x20token...'];a0_0x5497=function(){return _0x8fbcc8;};return a0_0x5497();}export async function dpCreateFolder(_0x4a6444){var _0x5f5821=a0_0x2ead4a;const _0x5c032a=localStorage[_0x5f5821(0x1a4)]('uId');let _0x165cbe=localStorage[_0x5f5821(0x1a4)](_0x5f5821(0x177));const _0x122dd0='/'+_0x5c032a+'/'+_0x4a6444,_0x2c9159=JSON[_0x5f5821(0x1ba)]({'path':_0x122dd0,'autorename':![]});for(let _0x41744d=0x0;_0x41744d<0x2;_0x41744d++){try{const _0x3ffd6e=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x5f5821(0x17f)+_0x165cbe,'Content-Type':'application/json'},'body':_0x2c9159});if(_0x3ffd6e[_0x5f5821(0x1d0)]===0x191){const _0x3cea1b=await dpRefreshToken();if(!_0x3cea1b)throw new Error(_0x5f5821(0x1ca));_0x165cbe=localStorage['getItem'](_0x5f5821(0x177));continue;}if(_0x3ffd6e[_0x5f5821(0x1d0)]===0x199)return{'message':_0x5f5821(0x19b),'path':_0x4a6444};if(!_0x3ffd6e['ok'])throw new Error(_0x5f5821(0x1a6)+_0x4a6444);const _0x25a93b=await _0x3ffd6e[_0x5f5821(0x1a2)]();return await lockNoti(_0x5f5821(0x17c),'',0xbb8),_0x25a93b;}catch(_0x12450c){if(_0x41744d===0x1)throw _0x12450c;}}return![];}export async function dpRefreshToken(){var _0x40ae13=a0_0x2ead4a;if(!localStorage[_0x40ae13(0x1a4)](_0x40ae13(0x17a)))throw _0x40ae13(0x1bc);try{const _0x43d1c2=await fetch(_0x40ae13(0x179),{'method':_0x40ae13(0x1cf),'headers':{'Content-Type':_0x40ae13(0x1a9)},'body':'refresh_token='+localStorage[_0x40ae13(0x1a4)](_0x40ae13(0x17a))+_0x40ae13(0x1c7)}),_0x503601=await _0x43d1c2[_0x40ae13(0x1a2)]();if(!_0x503601[_0x40ae13(0x178)])return localStorage[_0x40ae13(0x16c)](_0x40ae13(0x177),_0x503601[_0x40ae13(0x19a)]),await lockNoti(_0x40ae13(0x187),'',0xbb8),await delay(0x3e8),!![];else alert(_0x503601[_0x40ae13(0x1b0)]||_0x40ae13(0x1c1));}catch(_0x309d92){console[_0x40ae13(0x178)](_0x40ae13(0x1a3),_0x309d92);}return![];}export async function dpUploadFile(_0x61d4c4,_0x270224,_0x30ac1e){var _0x1ca75f=a0_0x2ead4a;const _0x43c847=localStorage[_0x1ca75f(0x1a4)](_0x1ca75f(0x1b1));var _0x59c990=JSON[_0x1ca75f(0x1ba)]({'autorename':!![],'mode':_0x1ca75f(0x169),'mute':!![],'strict_conflict':![],'path':'/'+_0x43c847+'/'+_0x30ac1e+'/'+_0x61d4c4}),_0x4061f1=new Blob([_0x270224],{'type':_0x1ca75f(0x190)});for(var _0x499ebd=0x0;_0x499ebd<0x2;_0x499ebd++){var _0x3ad0b1=await fetch(_0x1ca75f(0x1bb),{'method':'POST','headers':{'Authorization':_0x1ca75f(0x17f)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x59c990,'Content-Type':_0x1ca75f(0x190)},'body':_0x4061f1});if(_0x3ad0b1['status']!=0xc8){if(_0x3ad0b1[_0x1ca75f(0x1d0)]==0x191){var _0x43b607=await dpRefreshToken();if(!_0x43b607)throw _0x1ca75f(0x1ca);continue;}else throw _0x1ca75f(0x16b)+_0x3ad0b1[_0x1ca75f(0x1d0)];}else{var _0xf25e8d=await _0x3ad0b1[_0x1ca75f(0x1a2)]();return console[_0x1ca75f(0x1c0)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x61d4c4),_0xf25e8d;}}return![];}function a0_0x107a(_0x21f561,_0x148bca){var _0x549721=a0_0x5497();return a0_0x107a=function(_0x107a0d,_0x2d25d0){_0x107a0d=_0x107a0d-0x167;var _0x519696=_0x549721[_0x107a0d];return _0x519696;},a0_0x107a(_0x21f561,_0x148bca);}export async function dpDownloadFile(_0x2aae32,_0x551829){var _0x289b58=a0_0x2ead4a;const _0x2ac9b3=localStorage['getItem'](_0x289b58(0x1b1));var _0x20c74d=JSON['stringify']({'path':'/'+_0x2ac9b3+'/'+_0x551829+'/'+_0x2aae32});for(var _0x5b3220=0x0;_0x5b3220<0x2;_0x5b3220++){var _0x413e09=await fetch(_0x289b58(0x1a0),{'method':_0x289b58(0x1cf),'headers':{'Authorization':_0x289b58(0x17f)+localStorage[_0x289b58(0x1a4)](_0x289b58(0x177)),'Dropbox-API-Arg':_0x20c74d}});if(_0x413e09[_0x289b58(0x1d0)]!=0xc8){if(_0x413e09[_0x289b58(0x1d0)]==0x191){var _0x303467=await dpRefreshToken();if(!_0x303467)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x289b58(0x1ce)+_0x413e09[_0x289b58(0x1d0)];}const _0x3ad991=new File([await _0x413e09[_0x289b58(0x18f)]()],_0x2aae32);return console[_0x289b58(0x1c0)](_0x289b58(0x173),_0x3ad991[_0x289b58(0x167)]),a0_0x5b1aff[_0x289b58(0x188)](_0x3ad991,()=>{}),_0x3ad991;}return![];}document['addEventListener'](a0_0x2ead4a(0x199),function(){var _0x113ab1=a0_0x2ead4a;dropboxRestore[_0x113ab1(0x1a8)](_0x113ab1(0x18a),async function(){var _0x4163cc=_0x113ab1;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x423145=localStorage[_0x4163cc(0x1a4)](_0x4163cc(0x1b1)),_0x486f31=[_0x4163cc(0x19c),_0x4163cc(0x185),_0x4163cc(0x1cb)];if(!_0x423145){window[_0x4163cc(0x16d)]('Cloud\x20login\x20required!');return;}let _0x5213d0=[];for(const _0x15d6eb of _0x486f31){let _0x3febbd={'path':'/'+_0x423145+'/'+_0x15d6eb};for(let _0x3db545=0x0;_0x3db545<0x2;_0x3db545++){let _0x723bbe=await fetch(_0x4163cc(0x1d1),{'method':_0x4163cc(0x1cf),'headers':{'Authorization':_0x4163cc(0x17f)+localStorage[_0x4163cc(0x1a4)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x4163cc(0x1ba)](_0x3febbd)});if(_0x723bbe['status']===0xc8){let _0x351e3e=await _0x723bbe['json'](),_0x2f6912=_0x351e3e[_0x4163cc(0x19f)][_0x4163cc(0x186)](_0xf3437=>_0xf3437[_0x4163cc(0x1c4)]===_0x4163cc(0x19e));_0x2f6912[_0x4163cc(0x182)]>0x0&&_0x5213d0[_0x4163cc(0x1b5)](..._0x2f6912[_0x4163cc(0x1c5)](_0x2ed75f=>({'name':_0x2ed75f[_0x4163cc(0x167)],'folder':_0x15d6eb})));break;}else{if(_0x723bbe[_0x4163cc(0x1d0)]===0x191){let _0x9f9ab0=await dpRefreshToken();if(!_0x9f9ab0)throw _0x4163cc(0x1ca);}else{console['error'](_0x4163cc(0x16a)+_0x15d6eb+_0x4163cc(0x1b7)+_0x723bbe[_0x4163cc(0x1d0)]);break;}}}}if(_0x5213d0[_0x4163cc(0x182)]>0x0){const _0x1b065a=_0x4163cc(0x189)+_0x5213d0[_0x4163cc(0x182)]+_0x4163cc(0x197);if(window[_0x4163cc(0x195)](_0x1b065a))for(const _0x2fbdbc of _0x5213d0){await lockNoti('Restoring...',_0x2fbdbc['name'],0xbb8),await dpDownloadFile(_0x2fbdbc[_0x4163cc(0x167)],_0x2fbdbc[_0x4163cc(0x1b8)]);}else console[_0x4163cc(0x1c0)](_0x4163cc(0x1ab));}else console[_0x4163cc(0x1c0)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener']('click',async function(){var _0x1fd2ec=_0x113ab1;await lockNoti(_0x1fd2ec(0x18e),'',0x1388);const _0x5af927=localStorage[_0x1fd2ec(0x1a4)](_0x1fd2ec(0x1b1));if(_0x5af927===null||_0x5af927==='')window['alert'](_0x1fd2ec(0x184));else{const _0x30305a=[_0x1fd2ec(0x19c),_0x1fd2ec(0x185),'screenshot'];for(const _0x5ba35b of _0x30305a){await dpCreateFolder(_0x5ba35b);}let _0xee0751=0x0;for(const _0x28688a of _0x30305a){const _0x51d095=a0_0x5b1aff['listFiles'](_0x28688a+'s');_0xee0751+=_0x51d095['length'];}if(window[_0x1fd2ec(0x195)](_0x1fd2ec(0x1a1)+_0xee0751+'\x20files\x20in\x20Kabu?'))for(const _0x3271e8 of _0x30305a){const _0x47c094=a0_0x5b1aff[_0x1fd2ec(0x180)](_0x3271e8+'s');for(const _0x164b77 of _0x47c094){const _0x1f0104=await a0_0x5b1aff['downloadFileInCloud'](_0x1fd2ec(0x1b4)+_0x3271e8+'s/'+_0x164b77);try{await lockNoti(_0x1fd2ec(0x191),_0x164b77,0xbb8),await dpUploadFile(_0x164b77,_0x1f0104,_0x3271e8);}catch(_0x3bf98b){console[_0x1fd2ec(0x178)](_0x1fd2ec(0x18d)+_0x164b77+':',_0x3bf98b);}}}else console[_0x1fd2ec(0x1c0)](_0x1fd2ec(0x1ab));}}),dropboxCloud[_0x113ab1(0x1a8)]('click',function(){var _0x8208aa=_0x113ab1;const _0x288f3f=localStorage['getItem'](_0x8208aa(0x1b1));_0x288f3f===null||_0x288f3f===''?authorizeWithDropbox():window[_0x8208aa(0x195)](_0x8208aa(0x1b2))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x8208aa(0x1c2)][_0x8208aa(0x1af)](_0x8208aa(0x193)),dropboxBackup['classList'][_0x8208aa(0x1af)](_0x8208aa(0x193)),dropboxCloud[_0x8208aa(0x1c2)]['remove'](_0x8208aa(0x193)));}),handleDropboxCallback();});