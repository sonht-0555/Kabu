var a0_0x308479=a0_0x329e;(function(_0x186f5c,_0x36692f){var _0x35de01=a0_0x329e,_0x3155f9=_0x186f5c();while(!![]){try{var _0x55ecea=-parseInt(_0x35de01(0xe6))/0x1+parseInt(_0x35de01(0xf5))/0x2*(-parseInt(_0x35de01(0x120))/0x3)+parseInt(_0x35de01(0x144))/0x4+-parseInt(_0x35de01(0x106))/0x5+-parseInt(_0x35de01(0x123))/0x6+-parseInt(_0x35de01(0x107))/0x7+parseInt(_0x35de01(0x11c))/0x8;if(_0x55ecea===_0x36692f)break;else _0x3155f9['push'](_0x3155f9['shift']());}catch(_0x26b4db){_0x3155f9['push'](_0x3155f9['shift']());}}}(a0_0x5caa,0x56352));import*as a0_0x1e2686 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x308479(0x142),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x28d5f2=a0_0x308479,_0x4ed0b0=window[_0x28d5f2(0x113)][_0x28d5f2(0x10a)][_0x28d5f2(0xf0)]('?')[0x0],_0x213b5c='code',_0x4c7697=_0x28d5f2(0x111),_0x4cd045='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x28d5f2(0x12a)+_0x213b5c+_0x28d5f2(0x10c)+_0x4c7697+_0x28d5f2(0x13f)+encodeURIComponent(_0x4ed0b0);window[_0x28d5f2(0x113)][_0x28d5f2(0x10a)]=_0x4cd045;}function handleDropboxCallback(){var _0x50866d=a0_0x308479,_0x5da0a5=getUrlParameter(_0x50866d(0xe7));_0x5da0a5?(getAccessToken(_0x5da0a5),console['log'](_0x50866d(0xf2),_0x5da0a5)):console[_0x50866d(0x13b)](_0x50866d(0x11d));}function getUrlParameter(_0x3892c5){var _0x41c149=a0_0x308479;_0x3892c5=_0x3892c5[_0x41c149(0x11f)](/[\[]/,'\x5c[')[_0x41c149(0x11f)](/[\]]/,'\x5c]');var _0x20e4e8=new RegExp(_0x41c149(0x10d)+_0x3892c5+_0x41c149(0x103)),_0x40934b=_0x20e4e8[_0x41c149(0x125)](location['search']);return _0x40934b===null?'':decodeURIComponent(_0x40934b[0x1][_0x41c149(0x11f)](/\+/g,'\x20'));}function a0_0x329e(_0x1af944,_0x247209){var _0x5caa89=a0_0x5caa();return a0_0x329e=function(_0x329ed4,_0x2dad14){_0x329ed4=_0x329ed4-0xdc;var _0x33c1eb=_0x5caa89[_0x329ed4];return _0x33c1eb;},a0_0x329e(_0x1af944,_0x247209);}function getAccessToken(_0x46b86a){var _0x563040=a0_0x308479,_0x1ed694=_0x563040(0xfb),_0x8a3295=window[_0x563040(0x113)][_0x563040(0x10a)][_0x563040(0xf0)]('?')[0x0],_0x1d6d3e=new XMLHttpRequest();_0x1d6d3e[_0x563040(0xe8)](_0x563040(0x13d),_0x563040(0xe1)),_0x1d6d3e[_0x563040(0x10b)](_0x563040(0x116),_0x563040(0xf7)),_0x1d6d3e[_0x563040(0x135)]=function(){var _0x57d298=_0x563040;if(_0x1d6d3e[_0x57d298(0x101)]===0xc8){var _0x436542=JSON[_0x57d298(0xfa)](_0x1d6d3e['responseText']),_0x2b2d7b=_0x436542[_0x57d298(0x115)],_0x52f1fb=_0x436542[_0x57d298(0x13e)],_0x76c41=_0x436542[_0x57d298(0xff)];localStorage[_0x57d298(0x126)](_0x57d298(0x12d),_0x2b2d7b),localStorage[_0x57d298(0x126)](_0x57d298(0x129),_0x52f1fb),localStorage[_0x57d298(0x126)](_0x57d298(0x11b),_0x76c41);}else console[_0x57d298(0x13b)](_0x57d298(0xef));},_0x1d6d3e[_0x563040(0x100)](_0x563040(0xfe)+_0x46b86a+_0x563040(0xf1)+_0x1ed694+_0x563040(0x147)+clientId+_0x563040(0xf9)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x8a3295));}export async function dpCreateFolder(_0x121eb4){var _0x462f0d=a0_0x308479;const _0x31479f=localStorage[_0x462f0d(0x128)](_0x462f0d(0x11b));let _0x48c0bf=localStorage[_0x462f0d(0x128)](_0x462f0d(0x12d));const _0x1478dd='/'+_0x31479f+'/'+_0x121eb4,_0x1e9226=JSON[_0x462f0d(0xe5)]({'path':_0x1478dd,'autorename':![]});for(let _0x419843=0x0;_0x419843<0x2;_0x419843++){try{const _0x1a09b1=await fetch(_0x462f0d(0xf6),{'method':'POST','headers':{'Authorization':_0x462f0d(0x12e)+_0x48c0bf,'Content-Type':'application/json'},'body':_0x1e9226});if(_0x1a09b1['status']===0x191){const _0x201943=await dpRefreshToken();if(!_0x201943)throw new Error(_0x462f0d(0x131));_0x48c0bf=localStorage[_0x462f0d(0x128)]('accessToken');continue;}if(_0x1a09b1[_0x462f0d(0x101)]===0x199)return{'message':_0x462f0d(0x130),'path':_0x121eb4};if(!_0x1a09b1['ok'])throw new Error(_0x462f0d(0x119)+_0x121eb4);const _0xc3beb=await _0x1a09b1[_0x462f0d(0xf3)]();return await lockNoti(_0x462f0d(0x112),'',0xbb8),_0xc3beb;}catch(_0x523dad){if(_0x419843===0x1)throw _0x523dad;}}return![];}function a0_0x5caa(){var _0x27de39=['Download\x20failed\x20for\x20','POST','refresh_token','&redirect_uri=','Do\x20you\x20want\x20to\x20logout?','.tag','knh3uz2mx2hp2eu','No\x20files\x20found\x20to\x20restore.','2120428RTIenY','error_description','length','&client_id=','Download\x20failed,\x20unknown\x20http\x20status:','Restoring...','https://content.dropboxapi.com/2/files/upload','file','name','https://api.dropbox.com/oauth2/token','downloadFileInCloud','map','DOMContentLoaded','stringify','375476WVhDQe','code','open','application/json','error','Do\x20you\x20want\x20to\x20backup\x20','Cloud\x20login\x20required!','No\x20refresh\x20token','https://api.dropboxapi.com/oauth2/token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','split','&grant_type=','Authorization\x20Code:','json','Failed\x20to\x20upload\x20file\x20','344636wXbRxh','https://api.dropboxapi.com/2/files/create_folder_v2','application/x-www-form-urlencoded','confirm','&client_secret=','parse','authorization_code','listFiles','https://content.dropboxapi.com/2/files/download','code=','uid','send','status','active','=([^&#]*)','classList','Restore\x20canceled\x20by\x20user.','1018945xaqFhv','3675280wReiYI','https://api.dropboxapi.com/2/files/list_folder','state','href','setRequestHeader','&token_access_type=','[\x5c?&#]','Backing\x20up...','alert','overwrite','offline','Folder\x20created','location','application/octet-stream','access_token','Content-Type','blob','Failed\x20to\x20refresh\x20Dropbox\x20token.','Error\x20creating\x20folder\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','uId','13352744KtaOcU','Do\x20not\x20receive\x20authorization','uploadFileInCloud','replace','6gEOwEA','click','Cloud\x20↦\x20Kabu\x20storage\x20◆','2382918SYTOzl','Error\x20while\x20refreshing\x20token:','exec','setItem','screenshot','getItem','refreshToken','&response_type=','Refreshing\x20token...','filter','accessToken','Bearer\x20','addEventListener','Folder\x20already\x20exists','Unable\x20to\x20refresh\x20token','\x20files\x20in\x20Kabu?',',\x20status:\x20','remove','onload','Wait\x20a\x20little\x20bit...','entries','\x20files\x20from\x20Cloud?','Do\x20you\x20want\x20to\x20restore\x20','save','log'];a0_0x5caa=function(){return _0x27de39;};return a0_0x5caa();}export async function dpRefreshToken(){var _0x5e1082=a0_0x308479;if(!localStorage[_0x5e1082(0x128)]('refreshToken'))throw _0x5e1082(0xed);try{const _0xd29d71=await fetch(_0x5e1082(0xee),{'method':_0x5e1082(0x13d),'headers':{'Content-Type':_0x5e1082(0xf7)},'body':'refresh_token='+localStorage[_0x5e1082(0x128)](_0x5e1082(0x129))+_0x5e1082(0x11a)}),_0x48eaa1=await _0xd29d71[_0x5e1082(0xf3)]();if(!_0x48eaa1[_0x5e1082(0xea)])return localStorage['setItem'](_0x5e1082(0x12d),_0x48eaa1['access_token']),await lockNoti(_0x5e1082(0x12b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x48eaa1[_0x5e1082(0x145)]||_0x5e1082(0x118));}catch(_0x2ad1ff){console[_0x5e1082(0xea)](_0x5e1082(0x124),_0x2ad1ff);}return![];}export async function dpUploadFile(_0x1c1071,_0x235d48,_0x188fb3){var _0x1cede7=a0_0x308479;const _0x4b13b3=localStorage['getItem']('uId');var _0x35f2a3=JSON['stringify']({'autorename':!![],'mode':_0x1cede7(0x110),'mute':!![],'strict_conflict':![],'path':'/'+_0x4b13b3+'/'+_0x188fb3+'/'+_0x1c1071}),_0x110285=new Blob([_0x235d48],{'type':_0x1cede7(0x114)});for(var _0x214117=0x0;_0x214117<0x2;_0x214117++){var _0x38cfb6=await fetch(_0x1cede7(0xde),{'method':_0x1cede7(0x13d),'headers':{'Authorization':_0x1cede7(0x12e)+localStorage[_0x1cede7(0x128)](_0x1cede7(0x12d)),'Dropbox-API-Arg':_0x35f2a3,'Content-Type':_0x1cede7(0x114)},'body':_0x110285});if(_0x38cfb6[_0x1cede7(0x101)]!=0xc8){if(_0x38cfb6[_0x1cede7(0x101)]==0x191){var _0x1e46bd=await dpRefreshToken();if(!_0x1e46bd)throw _0x1cede7(0x131);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x38cfb6[_0x1cede7(0x101)];}else{var _0x243f31=await _0x38cfb6[_0x1cede7(0xf3)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x1c1071),_0x243f31;}}return![];}export async function dpDownloadFile(_0x31e6c9,_0xb26f46){var _0x2762be=a0_0x308479;const _0x2c7ca7=localStorage[_0x2762be(0x128)](_0x2762be(0x11b));var _0x4c3729=JSON[_0x2762be(0xe5)]({'path':'/'+_0x2c7ca7+'/'+_0xb26f46+'/'+_0x31e6c9});for(var _0x3116ef=0x0;_0x3116ef<0x2;_0x3116ef++){var _0x4e9be6=await fetch(_0x2762be(0xfd),{'method':_0x2762be(0x13d),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x2762be(0x12d)),'Dropbox-API-Arg':_0x4c3729}});if(_0x4e9be6[_0x2762be(0x101)]!=0xc8){if(_0x4e9be6[_0x2762be(0x101)]==0x191){var _0xddc749=await dpRefreshToken();if(!_0xddc749)throw _0x2762be(0x131);continue;}else throw _0x2762be(0xdc)+_0x4e9be6[_0x2762be(0x101)];}const _0x55fbbb=new File([await _0x4e9be6[_0x2762be(0x117)]()],_0x31e6c9);return console[_0x2762be(0x13b)](_0x2762be(0x122),_0x55fbbb[_0x2762be(0xe0)]),a0_0x1e2686[_0x2762be(0x11e)](_0x55fbbb,()=>{}),_0x55fbbb;}return![];}document[a0_0x308479(0x12f)](a0_0x308479(0xe4),function(){var _0x472fde=a0_0x308479;dropboxRestore[_0x472fde(0x12f)](_0x472fde(0x121),async function(){var _0x37151f=_0x472fde;await lockNoti(_0x37151f(0x136),'',0x1388);const _0x5659ca=localStorage[_0x37151f(0x128)](_0x37151f(0x11b)),_0xbe2ab5=[_0x37151f(0x109),_0x37151f(0x13a),_0x37151f(0x127)];if(!_0x5659ca){window[_0x37151f(0x10f)](_0x37151f(0xec));return;}let _0x348995=[];for(const _0x58500b of _0xbe2ab5){let _0x3b3520={'path':'/'+_0x5659ca+'/'+_0x58500b};for(let _0x437121=0x0;_0x437121<0x2;_0x437121++){let _0x2a0b21=await fetch(_0x37151f(0x108),{'method':'POST','headers':{'Authorization':_0x37151f(0x12e)+localStorage[_0x37151f(0x128)](_0x37151f(0x12d)),'Content-Type':_0x37151f(0xe9)},'body':JSON[_0x37151f(0xe5)](_0x3b3520)});if(_0x2a0b21[_0x37151f(0x101)]===0xc8){let _0x3382f5=await _0x2a0b21[_0x37151f(0xf3)](),_0x4cb569=_0x3382f5[_0x37151f(0x137)][_0x37151f(0x12c)](_0x570238=>_0x570238[_0x37151f(0x141)]===_0x37151f(0xdf));_0x4cb569[_0x37151f(0x146)]>0x0&&_0x348995['push'](..._0x4cb569[_0x37151f(0xe3)](_0x1d609b=>({'name':_0x1d609b['name'],'folder':_0x58500b})));break;}else{if(_0x2a0b21[_0x37151f(0x101)]===0x191){let _0x30f4f9=await dpRefreshToken();if(!_0x30f4f9)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x37151f(0x13c)+_0x58500b+_0x37151f(0x133)+_0x2a0b21[_0x37151f(0x101)]);break;}}}}if(_0x348995[_0x37151f(0x146)]>0x0){const _0x122843=_0x37151f(0x139)+_0x348995[_0x37151f(0x146)]+_0x37151f(0x138);if(window['confirm'](_0x122843))for(const _0xb7bb81 of _0x348995){await lockNoti(_0x37151f(0xdd),_0xb7bb81[_0x37151f(0xe0)],0xbb8),await dpDownloadFile(_0xb7bb81[_0x37151f(0xe0)],_0xb7bb81['folder']);}else console[_0x37151f(0x13b)](_0x37151f(0x105));}else console[_0x37151f(0x13b)](_0x37151f(0x143));}),dropboxBackup[_0x472fde(0x12f)](_0x472fde(0x121),async function(){var _0x841dcf=_0x472fde;await lockNoti(_0x841dcf(0x136),'',0x1388);const _0x4a8155=localStorage[_0x841dcf(0x128)]('uId');if(_0x4a8155===null||_0x4a8155==='')window[_0x841dcf(0x10f)](_0x841dcf(0xec));else{const _0x4f7432=[_0x841dcf(0x109),_0x841dcf(0x13a),_0x841dcf(0x127)];for(const _0x587599 of _0x4f7432){await dpCreateFolder(_0x587599);}let _0x539434=0x0;for(const _0x4cd515 of _0x4f7432){const _0x107b9a=a0_0x1e2686[_0x841dcf(0xfc)](_0x4cd515+'s');_0x539434+=_0x107b9a[_0x841dcf(0x146)];}if(window[_0x841dcf(0xf8)](_0x841dcf(0xeb)+_0x539434+_0x841dcf(0x132)))for(const _0xf31c36 of _0x4f7432){const _0x52b323=a0_0x1e2686[_0x841dcf(0xfc)](_0xf31c36+'s');for(const _0xde7b19 of _0x52b323){const _0x23baaf=await a0_0x1e2686[_0x841dcf(0xe2)]('/data/'+_0xf31c36+'s/'+_0xde7b19);try{await lockNoti(_0x841dcf(0x10e),_0xde7b19,0xbb8),await dpUploadFile(_0xde7b19,_0x23baaf,_0xf31c36);}catch(_0x589fa7){console['error'](_0x841dcf(0xf4)+_0xde7b19+':',_0x589fa7);}}}else console[_0x841dcf(0x13b)](_0x841dcf(0x105));}}),dropboxCloud[_0x472fde(0x12f)](_0x472fde(0x121),function(){var _0x4ba116=_0x472fde;const _0x39a383=localStorage[_0x4ba116(0x128)](_0x4ba116(0x11b));_0x39a383===null||_0x39a383===''?authorizeWithDropbox():window['confirm'](_0x4ba116(0x140))&&(localStorage[_0x4ba116(0x126)](_0x4ba116(0x11b),''),dropboxRestore[_0x4ba116(0x104)][_0x4ba116(0x134)](_0x4ba116(0x102)),dropboxBackup[_0x4ba116(0x104)][_0x4ba116(0x134)](_0x4ba116(0x102)),dropboxCloud[_0x4ba116(0x104)][_0x4ba116(0x134)](_0x4ba116(0x102)));}),handleDropboxCallback();});