var a0_0x17d382=a0_0x1ad6;(function(_0xb71db8,_0x19e58a){var _0x270b5e=a0_0x1ad6,_0x20d699=_0xb71db8();while(!![]){try{var _0x2fba90=parseInt(_0x270b5e(0x1c8))/0x1+-parseInt(_0x270b5e(0x1ef))/0x2+parseInt(_0x270b5e(0x21b))/0x3+-parseInt(_0x270b5e(0x203))/0x4*(parseInt(_0x270b5e(0x1d6))/0x5)+parseInt(_0x270b5e(0x1cf))/0x6*(parseInt(_0x270b5e(0x22c))/0x7)+parseInt(_0x270b5e(0x1dc))/0x8+parseInt(_0x270b5e(0x1ec))/0x9*(parseInt(_0x270b5e(0x21d))/0xa);if(_0x2fba90===_0x19e58a)break;else _0x20d699['push'](_0x20d699['shift']());}catch(_0x3d5f25){_0x20d699['push'](_0x20d699['shift']());}}}(a0_0x5c24,0xb9064));import*as a0_0x4c982f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x17d382(0x1d3),clientSecret=a0_0x17d382(0x21c);function a0_0x5c24(){var _0x1be73f=['Do\x20not\x20receive\x20authorization','error','application/json','charAt','uid','name','json','folder','application/x-www-form-urlencoded','onload','650823OBOiuH','nwb3dnfh09rhs31','30ruEXYt','screenshot','save','downloadFileInCloud','No\x20refresh\x20token','search','setRequestHeader','map','Folder\x20created','Bearer\x20','https://api.dropboxapi.com/2/files/list_folder','open','addEventListener','Do\x20you\x20want\x20to\x20logout?','slice','7476UxtrKS','Content-Type','Do\x20you\x20want\x20to\x20restore\x20','code','blob','offline','Error\x20creating\x20folder\x20','push','Unable\x20to\x20refresh\x20token','overwrite','https://api.dropbox.com/oauth2/token','https://api.dropboxapi.com/oauth2/token','98184OIyAkT','https://www.dropbox.com/oauth2/authorize?client_id=','FSSync','Error\x20while\x20refreshing\x20token:','access_token','classList','authorization_code','2118nYRZqr','&redirect_uri=','Folder\x20already\x20exists','/data/','knh3uz2mx2hp2eu','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://content.dropboxapi.com/2/files/upload','4090uJOrDu','&token_access_type=','filter','\x20files\x20in\x20Kabu?','status','Authorization\x20Code:','5985032uhhBGy','Kabu\x20storage\x20↦\x20Cloud\x20◆','error_description','\x20files\x20from\x20Cloud?','Download\x20failed\x20for\x20','getItem','uId','.tag','toUpperCase','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','uploadFileInCloud','log','responseText','Restore\x20canceled\x20by\x20user.','=([^&#]*)','setItem','2591793PxuLYt','click','Restoring...','756450diKPqP','entries','active','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','length','split','refresh_token','&client_secret=','Failed\x20to\x20upload\x20file\x20','location','accessToken','Wait\x20a\x20little\x20bit...','&client_id=','&grant_type=','&response_type=','exec','Download\x20failed,\x20unknown\x20http\x20status:','alert','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','5712ookwDG','POST','remove','send','application/octet-stream','https://content.dropboxapi.com/2/files/download','href','stringify','[\x5c?&#]','confirm','replace','list','state','file'];a0_0x5c24=function(){return _0x1be73f;};return a0_0x5c24();}function authorizeWithDropbox(){var _0x93f7f7=a0_0x17d382,_0x1fe1c1=window['location'][_0x93f7f7(0x209)]['split']('?')[0x0],_0x4ef4a5='code',_0x34b8ee=_0x93f7f7(0x1c1),_0x143545=_0x93f7f7(0x1c9)+clientId+_0x93f7f7(0x1fe)+_0x4ef4a5+_0x93f7f7(0x1d7)+_0x34b8ee+_0x93f7f7(0x1d0)+encodeURIComponent(_0x1fe1c1);window[_0x93f7f7(0x1f9)]['href']=_0x143545;}function a0_0x1ad6(_0x2671c8,_0x446d3a){var _0x5c2453=a0_0x5c24();return a0_0x1ad6=function(_0x1ad63b,_0x4a0f53){_0x1ad63b=_0x1ad63b-0x1c1;var _0x27854c=_0x5c2453[_0x1ad63b];return _0x27854c;},a0_0x1ad6(_0x2671c8,_0x446d3a);}function handleDropboxCallback(){var _0x2b364e=a0_0x17d382,_0x9359c4=getUrlParameter(_0x2b364e(0x22f));_0x9359c4?(getAccessToken(_0x9359c4),console[_0x2b364e(0x1e7)](_0x2b364e(0x1db),_0x9359c4)):console[_0x2b364e(0x1e7)](_0x2b364e(0x211));}function getUrlParameter(_0x19cfdb){var _0xf2e27d=a0_0x17d382;_0x19cfdb=_0x19cfdb[_0xf2e27d(0x20d)](/[\[]/,'\x5c[')[_0xf2e27d(0x20d)](/[\]]/,'\x5c]');var _0x375245=new RegExp(_0xf2e27d(0x20b)+_0x19cfdb+_0xf2e27d(0x1ea)),_0x42369a=_0x375245[_0xf2e27d(0x1ff)](location[_0xf2e27d(0x222)]);return _0x42369a===null?'':decodeURIComponent(_0x42369a[0x1][_0xf2e27d(0x20d)](/\+/g,'\x20'));}function getAccessToken(_0x75b2d8){var _0x244b31=a0_0x17d382,_0x1d8e78=_0x244b31(0x1ce),_0x38072e=window[_0x244b31(0x1f9)][_0x244b31(0x209)][_0x244b31(0x1f5)]('?')[0x0],_0x2248d6=new XMLHttpRequest();_0x2248d6[_0x244b31(0x228)](_0x244b31(0x204),_0x244b31(0x1c6)),_0x2248d6[_0x244b31(0x223)](_0x244b31(0x22d),'application/x-www-form-urlencoded'),_0x2248d6[_0x244b31(0x21a)]=function(){var _0x5b104c=_0x244b31;if(_0x2248d6['status']===0xc8){var _0x227ee8=JSON['parse'](_0x2248d6[_0x5b104c(0x1e8)]),_0x2f1c9e=_0x227ee8[_0x5b104c(0x1cc)],_0x3c7d6b=_0x227ee8[_0x5b104c(0x1f6)],_0x2ab09b=_0x227ee8[_0x5b104c(0x215)];localStorage[_0x5b104c(0x1eb)](_0x5b104c(0x1fa),_0x2f1c9e),localStorage['setItem'](_0x5b104c(0x1f3),_0x3c7d6b),localStorage['setItem'](_0x5b104c(0x1e2),_0x2ab09b);}else console[_0x5b104c(0x1e7)](_0x5b104c(0x1e5));},_0x2248d6[_0x244b31(0x206)]('code='+_0x75b2d8+_0x244b31(0x1fd)+_0x1d8e78+_0x244b31(0x1fc)+clientId+_0x244b31(0x1f7)+clientSecret+_0x244b31(0x1d0)+encodeURIComponent(_0x38072e));}export async function dpCreateFolder(_0x3f1208){var _0x5bf586=a0_0x17d382;const _0x1c1b04=localStorage[_0x5bf586(0x1e1)](_0x5bf586(0x1e2));let _0x2bc61a=localStorage[_0x5bf586(0x1e1)](_0x5bf586(0x1fa));const _0x3a9af7='/'+_0x1c1b04+'/'+_0x3f1208,_0x16c6bd=JSON[_0x5bf586(0x20a)]({'path':_0x3a9af7,'autorename':![]});for(let _0x428f39=0x0;_0x428f39<0x2;_0x428f39++){try{const _0x4751ab=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x5bf586(0x204),'headers':{'Authorization':'Bearer\x20'+_0x2bc61a,'Content-Type':_0x5bf586(0x213)},'body':_0x16c6bd});if(_0x4751ab[_0x5bf586(0x1da)]===0x191){const _0x278ffa=await dpRefreshToken();if(!_0x278ffa)throw new Error('Unable\x20to\x20refresh\x20token');_0x2bc61a=localStorage[_0x5bf586(0x1e1)](_0x5bf586(0x1fa));continue;}if(_0x4751ab[_0x5bf586(0x1da)]===0x199)return{'message':_0x5bf586(0x1d1),'path':_0x3f1208};if(!_0x4751ab['ok'])throw new Error(_0x5bf586(0x1c2)+_0x3f1208);const _0x23f975=await _0x4751ab[_0x5bf586(0x217)]();return await lockNoti(_0x5bf586(0x225),'',0xbb8),_0x23f975;}catch(_0x7b0658){if(_0x428f39===0x1)throw _0x7b0658;}}return![];}export async function dpRefreshToken(){var _0x446a41=a0_0x17d382;if(!localStorage[_0x446a41(0x1e1)](_0x446a41(0x1f3)))throw _0x446a41(0x221);try{const _0x593745=await fetch(_0x446a41(0x1c7),{'method':_0x446a41(0x204),'headers':{'Content-Type':_0x446a41(0x219)},'body':'refresh_token='+localStorage[_0x446a41(0x1e1)](_0x446a41(0x1f3))+_0x446a41(0x202)}),_0x35bd67=await _0x593745[_0x446a41(0x217)]();if(!_0x35bd67[_0x446a41(0x212)])return localStorage['setItem']('accessToken',_0x35bd67[_0x446a41(0x1cc)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x35bd67[_0x446a41(0x1de)]||_0x446a41(0x1d4));}catch(_0x3bc515){console[_0x446a41(0x212)](_0x446a41(0x1cb),_0x3bc515);}return![];}export async function dpUploadFile(_0x1e1c87,_0x198ce9,_0x166bc2){var _0x2fdcc1=a0_0x17d382;const _0x49e12a=localStorage[_0x2fdcc1(0x1e1)](_0x2fdcc1(0x1e2));var _0x5086ab=JSON[_0x2fdcc1(0x20a)]({'autorename':!![],'mode':_0x2fdcc1(0x1c5),'mute':!![],'strict_conflict':![],'path':'/'+_0x49e12a+'/'+_0x166bc2+'/'+_0x1e1c87}),_0x26a08c=new Blob([_0x198ce9],{'type':_0x2fdcc1(0x207)});for(var _0x24c14d=0x0;_0x24c14d<0x2;_0x24c14d++){var _0x1ea5ad=await fetch(_0x2fdcc1(0x1d5),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x2fdcc1(0x1e1)](_0x2fdcc1(0x1fa)),'Dropbox-API-Arg':_0x5086ab,'Content-Type':'application/octet-stream'},'body':_0x26a08c});if(_0x1ea5ad['status']!=0xc8){if(_0x1ea5ad[_0x2fdcc1(0x1da)]==0x191){var _0x4db2d6=await dpRefreshToken();if(!_0x4db2d6)throw _0x2fdcc1(0x1c4);continue;}else throw _0x2fdcc1(0x1f2)+_0x1ea5ad[_0x2fdcc1(0x1da)];}else{var _0x3baa13=await _0x1ea5ad[_0x2fdcc1(0x217)]();return console[_0x2fdcc1(0x1e7)](_0x2fdcc1(0x1dd),_0x1e1c87),_0x3baa13;}}return![];}export async function dpDownloadFile(_0x30d866,_0x7e8aca){var _0x19d97e=a0_0x17d382;const _0x5d279c=localStorage[_0x19d97e(0x1e1)](_0x19d97e(0x1e2));var _0x14f9b1=JSON[_0x19d97e(0x20a)]({'path':'/'+_0x5d279c+'/'+_0x7e8aca+'/'+_0x30d866});for(var _0x433a74=0x0;_0x433a74<0x2;_0x433a74++){var _0x4c8543=await fetch(_0x19d97e(0x208),{'method':'POST','headers':{'Authorization':_0x19d97e(0x226)+localStorage[_0x19d97e(0x1e1)](_0x19d97e(0x1fa)),'Dropbox-API-Arg':_0x14f9b1}});if(_0x4c8543[_0x19d97e(0x1da)]!=0xc8){if(_0x4c8543[_0x19d97e(0x1da)]==0x191){var _0x255548=await dpRefreshToken();if(!_0x255548)throw _0x19d97e(0x1c4);continue;}else throw _0x19d97e(0x200)+_0x4c8543['status'];}const _0x4a25a6=new File([await _0x4c8543[_0x19d97e(0x230)]()],_0x30d866);return console[_0x19d97e(0x1e7)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x4a25a6['name']),a0_0x4c982f[_0x19d97e(0x1e6)](_0x4a25a6,()=>{var _0x12665c=_0x19d97e;localStorageFile(),Module[_0x12665c(0x1ca)]();}),_0x4a25a6;}return![];}document[a0_0x17d382(0x229)]('DOMContentLoaded',function(){var _0x2b1480=a0_0x17d382;dropboxRestore[_0x2b1480(0x229)](_0x2b1480(0x1ed),async function(){var _0x3ef542=_0x2b1480;await lockNoti(_0x3ef542(0x1fb),'',0x1388);const _0x7fa510=localStorage['getItem']('uId'),_0x16fa7e=[_0x3ef542(0x20f),_0x3ef542(0x21f),_0x3ef542(0x21e)];if(!_0x7fa510){window[_0x3ef542(0x201)]('Cloud\x20login\x20required!');return;}let _0x470f77=[];for(const _0x5d4b08 of _0x16fa7e){let _0xb108a0={'path':'/'+_0x7fa510+'/'+_0x5d4b08};for(let _0x5dd7b2=0x0;_0x5dd7b2<0x2;_0x5dd7b2++){let _0x589249=await fetch(_0x3ef542(0x227),{'method':_0x3ef542(0x204),'headers':{'Authorization':_0x3ef542(0x226)+localStorage['getItem'](_0x3ef542(0x1fa)),'Content-Type':'application/json'},'body':JSON[_0x3ef542(0x20a)](_0xb108a0)});if(_0x589249[_0x3ef542(0x1da)]===0xc8){let _0x22d3a8=await _0x589249['json'](),_0x5d0461=_0x22d3a8[_0x3ef542(0x1f0)][_0x3ef542(0x1d8)](_0xd0ef68=>_0xd0ef68[_0x3ef542(0x1e3)]===_0x3ef542(0x210));_0x5d0461[_0x3ef542(0x1f4)]>0x0&&_0x470f77[_0x3ef542(0x1c3)](..._0x5d0461[_0x3ef542(0x224)](_0x221a6d=>({'name':_0x221a6d[_0x3ef542(0x216)],'folder':_0x5d4b08})));break;}else{if(_0x589249[_0x3ef542(0x1da)]===0x191){let _0x337375=await dpRefreshToken();if(!_0x337375)throw _0x3ef542(0x1c4);}else{console[_0x3ef542(0x212)](_0x3ef542(0x1e0)+_0x5d4b08+',\x20status:\x20'+_0x589249['status']);break;}}}}if(_0x470f77[_0x3ef542(0x1f4)]>0x0){const _0x3a746d=_0x3ef542(0x22e)+_0x470f77[_0x3ef542(0x1f4)]+_0x3ef542(0x1df);if(window[_0x3ef542(0x20c)](_0x3a746d))for(const _0xf4b614 of _0x470f77){await lockNoti(_0x3ef542(0x1ee),_0xf4b614[_0x3ef542(0x216)],0xbb8),await dpDownloadFile(_0xf4b614[_0x3ef542(0x216)],_0xf4b614[_0x3ef542(0x218)]);}else console[_0x3ef542(0x1e7)](_0x3ef542(0x1e9));}else console[_0x3ef542(0x1e7)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x2b1480(0x229)](_0x2b1480(0x1ed),async function(){var _0x361524=_0x2b1480;await lockNoti(_0x361524(0x1fb),'',0x1388);const _0x332909=localStorage[_0x361524(0x1e1)]('uId');if(_0x332909===null||_0x332909==='')window[_0x361524(0x201)]('Cloud\x20login\x20required!');else{const _0x30b248=[_0x361524(0x20f),_0x361524(0x21f),'screenshot'];for(const _0x5eee67 of _0x30b248){await dpCreateFolder(_0x5eee67);}let _0x840493=0x0;for(const _0x5ad767 of _0x30b248){const _0x927e17=a0_0x4c982f[_0x361524(0x20e)+(_0x5ad767[_0x361524(0x214)](0x0)[_0x361524(0x1e4)]()+_0x5ad767[_0x361524(0x22b)](0x1))]();_0x840493+=_0x927e17[_0x361524(0x1f4)];}if(window[_0x361524(0x20c)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x840493+_0x361524(0x1d9)))for(const _0x105cf6 of _0x30b248){const _0x3fdce3=a0_0x4c982f[_0x361524(0x20e)+(_0x105cf6[_0x361524(0x214)](0x0)[_0x361524(0x1e4)]()+_0x105cf6[_0x361524(0x22b)](0x1))]();for(const _0x2fa318 of _0x3fdce3){const _0x5319e2=await a0_0x4c982f[_0x361524(0x220)](_0x361524(0x1d2)+_0x105cf6+'s/'+_0x2fa318);try{await lockNoti('Backing\x20up...',_0x2fa318,0xbb8),await dpUploadFile(_0x2fa318,_0x5319e2,_0x105cf6);}catch(_0x4db020){console[_0x361524(0x212)](_0x361524(0x1f8)+_0x2fa318+':',_0x4db020);}}}else console[_0x361524(0x1e7)](_0x361524(0x1e9));}}),dropboxCloud[_0x2b1480(0x229)](_0x2b1480(0x1ed),function(){var _0x2f100c=_0x2b1480;const _0x1bc507=localStorage['getItem'](_0x2f100c(0x1e2));_0x1bc507===null||_0x1bc507===''?authorizeWithDropbox():window[_0x2f100c(0x20c)](_0x2f100c(0x22a))&&(localStorage['setItem'](_0x2f100c(0x1e2),''),dropboxRestore[_0x2f100c(0x1cd)][_0x2f100c(0x205)](_0x2f100c(0x1f1)),dropboxBackup[_0x2f100c(0x1cd)]['remove'](_0x2f100c(0x1f1)),dropboxCloud[_0x2f100c(0x1cd)][_0x2f100c(0x205)](_0x2f100c(0x1f1)));}),handleDropboxCallback();});