var a0_0x4e4208=a0_0x4566;(function(_0x28ea89,_0x32d30c){var _0x4ae02e=a0_0x4566,_0xd7999e=_0x28ea89();while(!![]){try{var _0x79fb09=parseInt(_0x4ae02e(0x172))/0x1+-parseInt(_0x4ae02e(0x134))/0x2+-parseInt(_0x4ae02e(0x139))/0x3*(-parseInt(_0x4ae02e(0x15c))/0x4)+parseInt(_0x4ae02e(0x151))/0x5*(-parseInt(_0x4ae02e(0x168))/0x6)+-parseInt(_0x4ae02e(0x142))/0x7*(-parseInt(_0x4ae02e(0x193))/0x8)+parseInt(_0x4ae02e(0x150))/0x9*(parseInt(_0x4ae02e(0x157))/0xa)+parseInt(_0x4ae02e(0x183))/0xb*(-parseInt(_0x4ae02e(0x155))/0xc);if(_0x79fb09===_0x32d30c)break;else _0xd7999e['push'](_0xd7999e['shift']());}catch(_0xca0dba){_0xd7999e['push'](_0xd7999e['shift']());}}}(a0_0x1be9,0x206d2));import*as a0_0x39a3aa from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4e4208(0x184),clientSecret=a0_0x4e4208(0x13e);function authorizeWithDropbox(){var _0x3861e7=a0_0x4e4208,_0x3cf111=window[_0x3861e7(0x17a)]['href'][_0x3861e7(0x156)]('?')[0x0],_0x246e14=_0x3861e7(0x140),_0x45dfdc='offline',_0x37ac1f=_0x3861e7(0x13b)+clientId+'&response_type='+_0x246e14+'&token_access_type='+_0x45dfdc+_0x3861e7(0x189)+encodeURIComponent(_0x3cf111);window[_0x3861e7(0x17a)][_0x3861e7(0x176)]=_0x37ac1f;}function handleDropboxCallback(){var _0x26c8d2=a0_0x4e4208,_0x46cf26=getUrlParameter(_0x26c8d2(0x140));_0x46cf26?(getAccessToken(_0x46cf26),console[_0x26c8d2(0x133)]('Authorization\x20Code:',_0x46cf26)):console[_0x26c8d2(0x133)](_0x26c8d2(0x162));}function getUrlParameter(_0x33ba8e){var _0x4843e8=a0_0x4e4208;_0x33ba8e=_0x33ba8e['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x8f130d=new RegExp(_0x4843e8(0x152)+_0x33ba8e+_0x4843e8(0x165)),_0x10fcd9=_0x8f130d[_0x4843e8(0x163)](location[_0x4843e8(0x16e)]);return _0x10fcd9===null?'':decodeURIComponent(_0x10fcd9[0x1]['replace'](/\+/g,'\x20'));}function a0_0x1be9(){var _0x23024c=['error','status','Cloud\x20login\x20required!','filter','&client_id=','search','No\x20files\x20found\x20to\x20restore.','No\x20refresh\x20token','\x20files\x20in\x20Kabu?','258164VshAUf','/data/','&client_secret=','accessToken','href','Failed\x20to\x20upload\x20file\x20','setItem','Restore\x20canceled\x20by\x20user.','location','onload','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/octet-stream','Restoring...','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','overwrite','click','Backing\x20up...','671ktMXjs','knh3uz2mx2hp2eu','blob','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','json','application/json','&redirect_uri=','state','remove','refresh_token=','https://api.dropbox.com/oauth2/token','Do\x20you\x20want\x20to\x20restore\x20','folder','map','Refreshing\x20token...','Wait\x20a\x20little\x20bit...','1469168Hgqsnr','.tag','https://api.dropboxapi.com/2/files/list_folder','authorization_code','stringify','confirm','error_description','access_token','uId','refresh_token','log','446546UkwbPM','length','classList','application/x-www-form-urlencoded','parse','253959fhCtHd','file','https://www.dropbox.com/oauth2/authorize?client_id=','refreshToken','getItem','nwb3dnfh09rhs31','code=','code','active','7VviVVO','Folder\x20already\x20exists','DOMContentLoaded','name','Do\x20you\x20want\x20to\x20logout?','alert','\x20files\x20from\x20Cloud?','Unable\x20to\x20refresh\x20token','downloadFileInCloud','listFiles','addEventListener','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Folder\x20created','uid','9HgmFoQ','5RssvCC','[\x5c?&#]','setRequestHeader','save','36576Ebwdlm','split','476390AIfKkd','https://api.dropboxapi.com/2/files/create_folder_v2','Bearer\x20','Error\x20creating\x20folder\x20','responseText','4PRcIqs','https://api.dropboxapi.com/oauth2/token','&grant_type=','Do\x20you\x20want\x20to\x20backup\x20','POST','Kabu\x20storage\x20↦\x20Cloud\x20◆','Do\x20not\x20receive\x20authorization','exec','screenshot','=([^&#]*)','send','Content-Type','192498Bvdumb'];a0_0x1be9=function(){return _0x23024c;};return a0_0x1be9();}function getAccessToken(_0xcc09a7){var _0x56ce8a=a0_0x4e4208,_0x516839=_0x56ce8a(0x196),_0x4e3a9f=window['location'][_0x56ce8a(0x176)][_0x56ce8a(0x156)]('?')[0x0],_0x3bb1c8=new XMLHttpRequest();_0x3bb1c8['open']('POST',_0x56ce8a(0x18d)),_0x3bb1c8[_0x56ce8a(0x153)](_0x56ce8a(0x167),_0x56ce8a(0x137)),_0x3bb1c8[_0x56ce8a(0x17b)]=function(){var _0x15db2c=_0x56ce8a;if(_0x3bb1c8[_0x15db2c(0x16a)]===0xc8){var _0x2e4132=JSON[_0x15db2c(0x138)](_0x3bb1c8[_0x15db2c(0x15b)]),_0xfe739c=_0x2e4132[_0x15db2c(0x19a)],_0x3e49c9=_0x2e4132[_0x15db2c(0x19c)],_0x5c40ff=_0x2e4132[_0x15db2c(0x14f)];localStorage[_0x15db2c(0x178)]('accessToken',_0xfe739c),localStorage[_0x15db2c(0x178)]('refreshToken',_0x3e49c9),localStorage[_0x15db2c(0x178)]('uId',_0x5c40ff);}else console[_0x15db2c(0x133)](_0x15db2c(0x17f));},_0x3bb1c8[_0x56ce8a(0x166)](_0x56ce8a(0x13f)+_0xcc09a7+_0x56ce8a(0x15e)+_0x516839+_0x56ce8a(0x16d)+clientId+_0x56ce8a(0x174)+clientSecret+_0x56ce8a(0x189)+encodeURIComponent(_0x4e3a9f));}export async function dpCreateFolder(_0x10f6ce){var _0x4f63c1=a0_0x4e4208;const _0x865127=localStorage[_0x4f63c1(0x13d)](_0x4f63c1(0x19b));let _0x39322f=localStorage[_0x4f63c1(0x13d)]('accessToken');const _0x30b2aa='/'+_0x865127+'/'+_0x10f6ce,_0x7bb990=JSON[_0x4f63c1(0x197)]({'path':_0x30b2aa,'autorename':![]});for(let _0x3ddb4e=0x0;_0x3ddb4e<0x2;_0x3ddb4e++){try{const _0x49b0f2=await fetch(_0x4f63c1(0x158),{'method':_0x4f63c1(0x160),'headers':{'Authorization':'Bearer\x20'+_0x39322f,'Content-Type':_0x4f63c1(0x188)},'body':_0x7bb990});if(_0x49b0f2[_0x4f63c1(0x16a)]===0x191){const _0x4df823=await dpRefreshToken();if(!_0x4df823)throw new Error(_0x4f63c1(0x149));_0x39322f=localStorage[_0x4f63c1(0x13d)]('accessToken');continue;}if(_0x49b0f2[_0x4f63c1(0x16a)]===0x199)return{'message':_0x4f63c1(0x143),'path':_0x10f6ce};if(!_0x49b0f2['ok'])throw new Error(_0x4f63c1(0x15a)+_0x10f6ce);const _0x14dc87=await _0x49b0f2[_0x4f63c1(0x187)]();return await lockNoti(_0x4f63c1(0x14e),'',0xbb8),_0x14dc87;}catch(_0xe0031b){if(_0x3ddb4e===0x1)throw _0xe0031b;}}return![];}export async function dpRefreshToken(){var _0x3bd1ef=a0_0x4e4208;if(!localStorage[_0x3bd1ef(0x13d)](_0x3bd1ef(0x13c)))throw _0x3bd1ef(0x170);try{const _0x2eb2c4=await fetch(_0x3bd1ef(0x15d),{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x3bd1ef(0x18c)+localStorage[_0x3bd1ef(0x13d)](_0x3bd1ef(0x13c))+_0x3bd1ef(0x186)}),_0x556c2d=await _0x2eb2c4[_0x3bd1ef(0x187)]();if(!_0x556c2d[_0x3bd1ef(0x169)])return localStorage[_0x3bd1ef(0x178)](_0x3bd1ef(0x175),_0x556c2d[_0x3bd1ef(0x19a)]),await lockNoti(_0x3bd1ef(0x191),'',0xbb8),await delay(0x3e8),!![];else alert(_0x556c2d[_0x3bd1ef(0x199)]||_0x3bd1ef(0x17c));}catch(_0x347ced){console[_0x3bd1ef(0x169)]('Error\x20while\x20refreshing\x20token:',_0x347ced);}return![];}export async function dpUploadFile(_0x4060df,_0x309307,_0x4d4ab0){var _0x161a10=a0_0x4e4208;const _0x1b4d4e=localStorage[_0x161a10(0x13d)]('uId');var _0x20a82c=JSON[_0x161a10(0x197)]({'autorename':!![],'mode':_0x161a10(0x180),'mute':!![],'strict_conflict':![],'path':'/'+_0x1b4d4e+'/'+_0x4d4ab0+'/'+_0x4060df}),_0x31ac49=new Blob([_0x309307],{'type':_0x161a10(0x17d)});for(var _0x5a0dac=0x0;_0x5a0dac<0x2;_0x5a0dac++){var _0x2547a7=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x161a10(0x160),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x161a10(0x13d)](_0x161a10(0x175)),'Dropbox-API-Arg':_0x20a82c,'Content-Type':_0x161a10(0x17d)},'body':_0x31ac49});if(_0x2547a7[_0x161a10(0x16a)]!=0xc8){if(_0x2547a7[_0x161a10(0x16a)]==0x191){var _0x30d579=await dpRefreshToken();if(!_0x30d579)throw _0x161a10(0x149);continue;}else throw _0x161a10(0x14d)+_0x2547a7[_0x161a10(0x16a)];}else{var _0x8b28e2=await _0x2547a7['json']();return console['log'](_0x161a10(0x161),_0x4060df),_0x8b28e2;}}return![];}function a0_0x4566(_0x79e9fa,_0x4bbdcc){var _0x1be96e=a0_0x1be9();return a0_0x4566=function(_0x4566f3,_0x834cff){_0x4566f3=_0x4566f3-0x133;var _0x47aa01=_0x1be96e[_0x4566f3];return _0x47aa01;},a0_0x4566(_0x79e9fa,_0x4bbdcc);}export async function dpDownloadFile(_0x95ae0,_0x53b0ac){var _0x145783=a0_0x4e4208;const _0x1af218=localStorage[_0x145783(0x13d)](_0x145783(0x19b));var _0x32f53c=JSON[_0x145783(0x197)]({'path':'/'+_0x1af218+'/'+_0x53b0ac+'/'+_0x95ae0});for(var _0xcdc429=0x0;_0xcdc429<0x2;_0xcdc429++){var _0x57add6=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x145783(0x159)+localStorage[_0x145783(0x13d)](_0x145783(0x175)),'Dropbox-API-Arg':_0x32f53c}});if(_0x57add6[_0x145783(0x16a)]!=0xc8){if(_0x57add6[_0x145783(0x16a)]==0x191){var _0x4f236c=await dpRefreshToken();if(!_0x4f236c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x57add6[_0x145783(0x16a)];}const _0x2a1690=new File([await _0x57add6[_0x145783(0x185)]()],_0x95ae0);return console['log']('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2a1690[_0x145783(0x145)]),a0_0x39a3aa['uploadFileInCloud'](_0x2a1690,()=>{}),_0x2a1690;}return![];}document['addEventListener'](a0_0x4e4208(0x144),function(){var _0x5e8c47=a0_0x4e4208;dropboxRestore[_0x5e8c47(0x14c)](_0x5e8c47(0x181),async function(){var _0x2dcc3d=_0x5e8c47;await lockNoti(_0x2dcc3d(0x192),'',0x1388);const _0x4d51e7=localStorage[_0x2dcc3d(0x13d)](_0x2dcc3d(0x19b)),_0x495faf=[_0x2dcc3d(0x18a),_0x2dcc3d(0x154),_0x2dcc3d(0x164)];if(!_0x4d51e7){window[_0x2dcc3d(0x147)](_0x2dcc3d(0x16b));return;}let _0x4614ca=[];for(const _0xa90419 of _0x495faf){let _0x4e21e4={'path':'/'+_0x4d51e7+'/'+_0xa90419};for(let _0x1c7202=0x0;_0x1c7202<0x2;_0x1c7202++){let _0x236e91=await fetch(_0x2dcc3d(0x195),{'method':_0x2dcc3d(0x160),'headers':{'Authorization':_0x2dcc3d(0x159)+localStorage[_0x2dcc3d(0x13d)]('accessToken'),'Content-Type':_0x2dcc3d(0x188)},'body':JSON['stringify'](_0x4e21e4)});if(_0x236e91[_0x2dcc3d(0x16a)]===0xc8){let _0x35cacb=await _0x236e91[_0x2dcc3d(0x187)](),_0x5cd811=_0x35cacb['entries'][_0x2dcc3d(0x16c)](_0x591d8c=>_0x591d8c[_0x2dcc3d(0x194)]===_0x2dcc3d(0x13a));_0x5cd811[_0x2dcc3d(0x135)]>0x0&&_0x4614ca['push'](..._0x5cd811[_0x2dcc3d(0x190)](_0x516aba=>({'name':_0x516aba['name'],'folder':_0xa90419})));break;}else{if(_0x236e91['status']===0x191){let _0x991456=await dpRefreshToken();if(!_0x991456)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x2dcc3d(0x169)]('Download\x20failed\x20for\x20'+_0xa90419+',\x20status:\x20'+_0x236e91[_0x2dcc3d(0x16a)]);break;}}}}if(_0x4614ca[_0x2dcc3d(0x135)]>0x0){const _0xfe9a58=_0x2dcc3d(0x18e)+_0x4614ca['length']+_0x2dcc3d(0x148);if(window['confirm'](_0xfe9a58))for(const _0x4ca896 of _0x4614ca){await lockNoti(_0x2dcc3d(0x17e),_0x4ca896[_0x2dcc3d(0x145)],0xbb8),await dpDownloadFile(_0x4ca896[_0x2dcc3d(0x145)],_0x4ca896[_0x2dcc3d(0x18f)]);}else console[_0x2dcc3d(0x133)](_0x2dcc3d(0x179));}else console[_0x2dcc3d(0x133)](_0x2dcc3d(0x16f));}),dropboxBackup[_0x5e8c47(0x14c)]('click',async function(){var _0xfd12d8=_0x5e8c47;await lockNoti(_0xfd12d8(0x192),'',0x1388);const _0x4af231=localStorage['getItem'](_0xfd12d8(0x19b));if(_0x4af231===null||_0x4af231==='')window[_0xfd12d8(0x147)](_0xfd12d8(0x16b));else{const _0x29c7a3=[_0xfd12d8(0x18a),_0xfd12d8(0x154),'screenshot'];for(const _0x425909 of _0x29c7a3){await dpCreateFolder(_0x425909);}let _0x315744=0x0;for(const _0x3db0a8 of _0x29c7a3){const _0x1f5855=a0_0x39a3aa[_0xfd12d8(0x14b)](_0x3db0a8+'s');_0x315744+=_0x1f5855[_0xfd12d8(0x135)];}if(window[_0xfd12d8(0x198)](_0xfd12d8(0x15f)+_0x315744+_0xfd12d8(0x171)))for(const _0x3889f7 of _0x29c7a3){const _0x2334a7=a0_0x39a3aa['listFiles'](_0x3889f7+'s');for(const _0x41907a of _0x2334a7){const _0x3a4ba8=await a0_0x39a3aa[_0xfd12d8(0x14a)](_0xfd12d8(0x173)+_0x3889f7+'s/'+_0x41907a);try{await lockNoti(_0xfd12d8(0x182),_0x41907a,0xbb8),await dpUploadFile(_0x41907a,_0x3a4ba8,_0x3889f7);}catch(_0x21fa67){console[_0xfd12d8(0x169)](_0xfd12d8(0x177)+_0x41907a+':',_0x21fa67);}}}else console[_0xfd12d8(0x133)](_0xfd12d8(0x179));}}),dropboxCloud[_0x5e8c47(0x14c)](_0x5e8c47(0x181),function(){var _0x14cf4b=_0x5e8c47;const _0xbd2a67=localStorage[_0x14cf4b(0x13d)](_0x14cf4b(0x19b));_0xbd2a67===null||_0xbd2a67===''?authorizeWithDropbox():window[_0x14cf4b(0x198)](_0x14cf4b(0x146))&&(localStorage[_0x14cf4b(0x178)]('uId',''),dropboxRestore[_0x14cf4b(0x136)][_0x14cf4b(0x18b)]('active'),dropboxBackup[_0x14cf4b(0x136)][_0x14cf4b(0x18b)](_0x14cf4b(0x141)),dropboxCloud[_0x14cf4b(0x136)][_0x14cf4b(0x18b)](_0x14cf4b(0x141)));}),handleDropboxCallback();});