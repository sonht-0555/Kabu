var a0_0x2a3616=a0_0x4069;function a0_0x4069(_0x1bd74c,_0x5c74d8){var _0x105946=a0_0x1059();return a0_0x4069=function(_0x40698f,_0x4b70fc){_0x40698f=_0x40698f-0xc1;var _0x445c07=_0x105946[_0x40698f];return _0x445c07;},a0_0x4069(_0x1bd74c,_0x5c74d8);}(function(_0x3bf1f7,_0x3c6518){var _0x299637=a0_0x4069,_0x2b42c1=_0x3bf1f7();while(!![]){try{var _0x2a6020=parseInt(_0x299637(0x11b))/0x1*(parseInt(_0x299637(0xfd))/0x2)+parseInt(_0x299637(0xe5))/0x3+-parseInt(_0x299637(0xcb))/0x4*(-parseInt(_0x299637(0x129))/0x5)+parseInt(_0x299637(0xde))/0x6+-parseInt(_0x299637(0xe1))/0x7*(parseInt(_0x299637(0xe2))/0x8)+parseInt(_0x299637(0xd2))/0x9*(parseInt(_0x299637(0xf2))/0xa)+-parseInt(_0x299637(0x109))/0xb;if(_0x2a6020===_0x3c6518)break;else _0x2b42c1['push'](_0x2b42c1['shift']());}catch(_0x3b7f21){_0x2b42c1['push'](_0x2b42c1['shift']());}}}(a0_0x1059,0xf2065));import*as a0_0x586f8e from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2a3616(0xd0),clientSecret=a0_0x2a3616(0x11e);function authorizeWithDropbox(){var _0x149e05=a0_0x2a3616,_0x493560=window['location'][_0x149e05(0x11f)][_0x149e05(0x11d)]('?')[0x0],_0x5aa000=_0x149e05(0x11c),_0x59adc1=_0x149e05(0xf1),_0x587374=_0x149e05(0x119)+clientId+_0x149e05(0x122)+_0x5aa000+_0x149e05(0x10f)+_0x59adc1+_0x149e05(0xc1)+encodeURIComponent(_0x493560);window[_0x149e05(0xdd)]['href']=_0x587374;}function a0_0x1059(){var _0x409423=['Cloud\x20↦\x20Kabu\x20storage\x20◆','confirm','open','json','list','offline','742460XDuCod','file','toUpperCase','Folder\x20already\x20exists','Do\x20not\x20receive\x20authorization','POST','onload','uId','log','blob','setRequestHeader','583176YMMrqA','error','search','Refreshing\x20token...','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20logout?','stringify','Download\x20failed,\x20unknown\x20http\x20status:','setItem','\x20files\x20from\x20Cloud?','/data/','accessToken','45945812PFuhle','Authorization\x20Code:','Failed\x20to\x20upload\x20file\x20','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Kabu\x20storage\x20↦\x20Cloud\x20◆','charAt','&token_access_type=','Bearer\x20','exec','https://api.dropbox.com/oauth2/token','status','refreshToken','addEventListener','replace','\x20files\x20in\x20Kabu?','access_token','https://www.dropbox.com/oauth2/authorize?client_id=','downloadFileInCloud','1ShVBAC','code','split','nwb3dnfh09rhs31','href','state','alert','&response_type=','filter','refresh_token','refresh_token=','click','error_description','slice','145YkzaKT','[\x5c?&#]','Error\x20creating\x20folder\x20','uid','&redirect_uri=','send','remove','Do\x20you\x20want\x20to\x20restore\x20','Download\x20failed\x20for\x20','application/octet-stream','No\x20refresh\x20token','length','uploadFileInCloud','Failed\x20to\x20refresh\x20Dropbox\x20token.','31268qvMxbQ','code=','name','=([^&#]*)','Restore\x20canceled\x20by\x20user.','knh3uz2mx2hp2eu','overwrite','234RpjbWI','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Content-Type','folder','https://content.dropboxapi.com/2/files/download','active','Cloud\x20login\x20required!','.tag','DOMContentLoaded','https://api.dropboxapi.com/oauth2/token','responseText','location','11807448NQBRIO','Do\x20you\x20want\x20to\x20backup\x20','authorization_code','28kDHWWu','869112zZrkTz','application/json','Unable\x20to\x20refresh\x20token','3558588dMYIDK','Wait\x20a\x20little\x20bit...','classList','screenshot','save','getItem','Folder\x20created'];a0_0x1059=function(){return _0x409423;};return a0_0x1059();}function handleDropboxCallback(){var _0x388d5d=a0_0x2a3616,_0x4c0208=getUrlParameter(_0x388d5d(0x11c));_0x4c0208?(getAccessToken(_0x4c0208),console['log'](_0x388d5d(0x10a),_0x4c0208)):console[_0x388d5d(0xfa)](_0x388d5d(0xf6));}function getUrlParameter(_0x1bbc6d){var _0x2e241f=a0_0x2a3616;_0x1bbc6d=_0x1bbc6d[_0x2e241f(0x116)](/[\[]/,'\x5c[')[_0x2e241f(0x116)](/[\]]/,'\x5c]');var _0x44775c=new RegExp(_0x2e241f(0x12a)+_0x1bbc6d+_0x2e241f(0xce)),_0x14c372=_0x44775c[_0x2e241f(0x111)](location[_0x2e241f(0xff)]);return _0x14c372===null?'':decodeURIComponent(_0x14c372[0x1][_0x2e241f(0x116)](/\+/g,'\x20'));}function getAccessToken(_0x5263b0){var _0xf460cc=a0_0x2a3616,_0x4b0050=_0xf460cc(0xe0),_0x505c43=window[_0xf460cc(0xdd)][_0xf460cc(0x11f)]['split']('?')[0x0],_0x567ffb=new XMLHttpRequest();_0x567ffb[_0xf460cc(0xee)]('POST',_0xf460cc(0x112)),_0x567ffb[_0xf460cc(0xfc)](_0xf460cc(0xd4),_0xf460cc(0x101)),_0x567ffb[_0xf460cc(0xf8)]=function(){var _0x4e5de9=_0xf460cc;if(_0x567ffb['status']===0xc8){var _0x364194=JSON['parse'](_0x567ffb[_0x4e5de9(0xdc)]),_0x56193f=_0x364194[_0x4e5de9(0x118)],_0x42cbf8=_0x364194[_0x4e5de9(0x124)],_0x3e596e=_0x364194[_0x4e5de9(0x12c)];localStorage['setItem'](_0x4e5de9(0x108),_0x56193f),localStorage[_0x4e5de9(0x105)](_0x4e5de9(0x114),_0x42cbf8),localStorage[_0x4e5de9(0x105)](_0x4e5de9(0xf9),_0x3e596e);}else console[_0x4e5de9(0xfa)](_0x4e5de9(0x10c));},_0x567ffb[_0xf460cc(0xc2)](_0xf460cc(0xcc)+_0x5263b0+'&grant_type='+_0x4b0050+'&client_id='+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x505c43));}export async function dpCreateFolder(_0x30f145){var _0xa6bb8c=a0_0x2a3616;const _0x87e401=localStorage['getItem'](_0xa6bb8c(0xf9));let _0x23b1b4=localStorage[_0xa6bb8c(0xea)]('accessToken');const _0x354977='/'+_0x87e401+'/'+_0x30f145,_0x329e28=JSON[_0xa6bb8c(0x103)]({'path':_0x354977,'autorename':![]});for(let _0x5a2edc=0x0;_0x5a2edc<0x2;_0x5a2edc++){try{const _0x4d17cd=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0xa6bb8c(0xf7),'headers':{'Authorization':'Bearer\x20'+_0x23b1b4,'Content-Type':_0xa6bb8c(0xe3)},'body':_0x329e28});if(_0x4d17cd['status']===0x191){const _0x2eeb1e=await dpRefreshToken();if(!_0x2eeb1e)throw new Error('Unable\x20to\x20refresh\x20token');_0x23b1b4=localStorage[_0xa6bb8c(0xea)]('accessToken');continue;}if(_0x4d17cd[_0xa6bb8c(0x113)]===0x199)return{'message':_0xa6bb8c(0xf5),'path':_0x30f145};if(!_0x4d17cd['ok'])throw new Error(_0xa6bb8c(0x12b)+_0x30f145);const _0x32f9ca=await _0x4d17cd[_0xa6bb8c(0xef)]();return await lockNoti(_0xa6bb8c(0xeb),'',0xbb8),_0x32f9ca;}catch(_0x2b4da6){if(_0x5a2edc===0x1)throw _0x2b4da6;}}return![];}export async function dpRefreshToken(){var _0x27383c=a0_0x2a3616;if(!localStorage['getItem']('refreshToken'))throw _0x27383c(0xc7);try{const _0x2d6f08=await fetch(_0x27383c(0xdb),{'method':_0x27383c(0xf7),'headers':{'Content-Type':_0x27383c(0x101)},'body':_0x27383c(0x125)+localStorage[_0x27383c(0xea)]('refreshToken')+_0x27383c(0xd3)}),_0xa58b25=await _0x2d6f08[_0x27383c(0xef)]();if(!_0xa58b25['error'])return localStorage[_0x27383c(0x105)](_0x27383c(0x108),_0xa58b25['access_token']),await lockNoti(_0x27383c(0x100),'',0xbb8),await delay(0x3e8),!![];else alert(_0xa58b25[_0x27383c(0x127)]||_0x27383c(0xca));}catch(_0x40d0ac){console[_0x27383c(0xfe)]('Error\x20while\x20refreshing\x20token:',_0x40d0ac);}return![];}export async function dpUploadFile(_0x188008,_0x52aa69,_0x2465b0){var _0x53c557=a0_0x2a3616;const _0x25ca9e=localStorage[_0x53c557(0xea)](_0x53c557(0xf9));var _0x520bdb=JSON[_0x53c557(0x103)]({'autorename':!![],'mode':_0x53c557(0xd1),'mute':!![],'strict_conflict':![],'path':'/'+_0x25ca9e+'/'+_0x2465b0+'/'+_0x188008}),_0x50cbc8=new Blob([_0x52aa69],{'type':_0x53c557(0xc6)});for(var _0x23ed9c=0x0;_0x23ed9c<0x2;_0x23ed9c++){var _0x1b11f0=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x53c557(0xf7),'headers':{'Authorization':_0x53c557(0x110)+localStorage[_0x53c557(0xea)]('accessToken'),'Dropbox-API-Arg':_0x520bdb,'Content-Type':_0x53c557(0xc6)},'body':_0x50cbc8});if(_0x1b11f0[_0x53c557(0x113)]!=0xc8){if(_0x1b11f0[_0x53c557(0x113)]==0x191){var _0x392a5b=await dpRefreshToken();if(!_0x392a5b)throw _0x53c557(0xe4);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1b11f0[_0x53c557(0x113)];}else{var _0x3da16a=await _0x1b11f0[_0x53c557(0xef)]();return console[_0x53c557(0xfa)](_0x53c557(0x10d),_0x188008),_0x3da16a;}}return![];}export async function dpDownloadFile(_0x4329e7,_0x26697e){var _0x5b423b=a0_0x2a3616;const _0x55da77=localStorage[_0x5b423b(0xea)](_0x5b423b(0xf9));var _0x137112=JSON['stringify']({'path':'/'+_0x55da77+'/'+_0x26697e+'/'+_0x4329e7});for(var _0x3af0e9=0x0;_0x3af0e9<0x2;_0x3af0e9++){var _0xe101de=await fetch(_0x5b423b(0xd6),{'method':_0x5b423b(0xf7),'headers':{'Authorization':_0x5b423b(0x110)+localStorage[_0x5b423b(0xea)](_0x5b423b(0x108)),'Dropbox-API-Arg':_0x137112}});if(_0xe101de[_0x5b423b(0x113)]!=0xc8){if(_0xe101de[_0x5b423b(0x113)]==0x191){var _0x1659cd=await dpRefreshToken();if(!_0x1659cd)throw _0x5b423b(0xe4);continue;}else throw _0x5b423b(0x104)+_0xe101de[_0x5b423b(0x113)];}const _0x134315=new File([await _0xe101de[_0x5b423b(0xfb)]()],_0x4329e7);return console[_0x5b423b(0xfa)](_0x5b423b(0xec),_0x134315[_0x5b423b(0xcd)]),a0_0x586f8e[_0x5b423b(0xc9)](_0x134315,()=>{}),_0x134315;}return![];}document[a0_0x2a3616(0x115)](a0_0x2a3616(0xda),function(){var _0x5e4c85=a0_0x2a3616;dropboxRestore[_0x5e4c85(0x115)]('click',async function(){var _0x1f47c9=_0x5e4c85;await lockNoti(_0x1f47c9(0xe6),'',0x1388);const _0x5bc61b=localStorage[_0x1f47c9(0xea)](_0x1f47c9(0xf9)),_0x2f475c=[_0x1f47c9(0x120),_0x1f47c9(0xe9),_0x1f47c9(0xe8)];if(!_0x5bc61b){window[_0x1f47c9(0x121)](_0x1f47c9(0xd8));return;}let _0xa3558d=[];for(const _0xb8eaae of _0x2f475c){let _0x25f93e={'path':'/'+_0x5bc61b+'/'+_0xb8eaae};for(let _0x3ec364=0x0;_0x3ec364<0x2;_0x3ec364++){let _0x5992a9=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x1f47c9(0xf7),'headers':{'Authorization':_0x1f47c9(0x110)+localStorage[_0x1f47c9(0xea)](_0x1f47c9(0x108)),'Content-Type':_0x1f47c9(0xe3)},'body':JSON[_0x1f47c9(0x103)](_0x25f93e)});if(_0x5992a9[_0x1f47c9(0x113)]===0xc8){let _0x3023df=await _0x5992a9['json'](),_0x28fd91=_0x3023df['entries'][_0x1f47c9(0x123)](_0x59e360=>_0x59e360[_0x1f47c9(0xd9)]===_0x1f47c9(0xf3));_0x28fd91[_0x1f47c9(0xc8)]>0x0&&_0xa3558d['push'](..._0x28fd91['map'](_0x1c5ff4=>({'name':_0x1c5ff4[_0x1f47c9(0xcd)],'folder':_0xb8eaae})));break;}else{if(_0x5992a9[_0x1f47c9(0x113)]===0x191){let _0x2e6a1d=await dpRefreshToken();if(!_0x2e6a1d)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x1f47c9(0xfe)](_0x1f47c9(0xc5)+_0xb8eaae+',\x20status:\x20'+_0x5992a9['status']);break;}}}}if(_0xa3558d['length']>0x0){const _0x8ac1ab=_0x1f47c9(0xc4)+_0xa3558d['length']+_0x1f47c9(0x106);if(window[_0x1f47c9(0xed)](_0x8ac1ab))for(const _0x5ca3d8 of _0xa3558d){await lockNoti('Restoring...',_0x5ca3d8[_0x1f47c9(0xcd)],0xbb8),await dpDownloadFile(_0x5ca3d8[_0x1f47c9(0xcd)],_0x5ca3d8[_0x1f47c9(0xd5)]);}else console['log'](_0x1f47c9(0xcf));}else console[_0x1f47c9(0xfa)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener']('click',async function(){var _0x1504ca=_0x5e4c85;await lockNoti(_0x1504ca(0xe6),'',0x1388);const _0x52700b=localStorage[_0x1504ca(0xea)]('uId');if(_0x52700b===null||_0x52700b==='')window[_0x1504ca(0x121)](_0x1504ca(0xd8));else{const _0x4f9f0a=[_0x1504ca(0x120),_0x1504ca(0xe9),_0x1504ca(0xe8)];for(const _0x6dc4e3 of _0x4f9f0a){await dpCreateFolder(_0x6dc4e3);}let _0x401f19=0x0;for(const _0x4a5506 of _0x4f9f0a){const _0x2c631c=a0_0x586f8e[_0x1504ca(0xf0)+(_0x4a5506[_0x1504ca(0x10e)](0x0)['toUpperCase']()+_0x4a5506[_0x1504ca(0x128)](0x1))]();_0x401f19+=_0x2c631c[_0x1504ca(0xc8)];}if(window[_0x1504ca(0xed)](_0x1504ca(0xdf)+_0x401f19+_0x1504ca(0x117)))for(const _0x3b1da7 of _0x4f9f0a){const _0x25526d=a0_0x586f8e[_0x1504ca(0xf0)+(_0x3b1da7['charAt'](0x0)[_0x1504ca(0xf4)]()+_0x3b1da7[_0x1504ca(0x128)](0x1))]();for(const _0x39db3c of _0x25526d){const _0x4e928a=await a0_0x586f8e[_0x1504ca(0x11a)](_0x1504ca(0x107)+_0x3b1da7+'s/'+_0x39db3c);try{await lockNoti('Backing\x20up...',_0x39db3c,0xbb8),await dpUploadFile(_0x39db3c,_0x4e928a,_0x3b1da7);}catch(_0x1f7830){console[_0x1504ca(0xfe)](_0x1504ca(0x10b)+_0x39db3c+':',_0x1f7830);}}}else console[_0x1504ca(0xfa)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x5e4c85(0x115)](_0x5e4c85(0x126),function(){var _0x556921=_0x5e4c85;const _0x26aa65=localStorage['getItem'](_0x556921(0xf9));_0x26aa65===null||_0x26aa65===''?authorizeWithDropbox():window[_0x556921(0xed)](_0x556921(0x102))&&(localStorage[_0x556921(0x105)](_0x556921(0xf9),''),dropboxRestore[_0x556921(0xe7)][_0x556921(0xc3)](_0x556921(0xd7)),dropboxBackup['classList'][_0x556921(0xc3)](_0x556921(0xd7)),dropboxCloud[_0x556921(0xe7)][_0x556921(0xc3)](_0x556921(0xd7)));}),handleDropboxCallback();});