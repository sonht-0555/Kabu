function a0_0x2fa2(){var _0x53c749=['Backing\x20up...','\x20files\x20in\x20Kabu?','1246620sFJwTN','length','charAt','error','error_description','uid','json','open','542796nFDZpy','click','111309txLkCA','\x20files\x20from\x20Cloud?','&client_secret=','uId',',\x20status:\x20','href','code=','https://api.dropboxapi.com/oauth2/token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','4470PUeIiK','application/x-www-form-urlencoded','save','POST','https://api.dropbox.com/oauth2/token','map','Content-Type','entries','slice','send','name','refreshToken','Restore\x20canceled\x20by\x20user.','application/octet-stream','Do\x20you\x20want\x20to\x20restore\x20','application/json','setItem','toUpperCase','location','remove','offline','&grant_type=','Cloud\x20login\x20required!','Do\x20not\x20receive\x20authorization','confirm','Failed\x20to\x20refresh\x20Dropbox\x20token.','6245OYvOPF','https://www.dropbox.com/oauth2/authorize?client_id=','setRequestHeader','Cloud\x20↦\x20Kabu\x20storage\x20◆','3252ZmLUTt','split','addEventListener','Download\x20failed,\x20unknown\x20http\x20status:','Error\x20while\x20refreshing\x20token:','active','Download\x20failed\x20for\x20','Restoring...','access_token','1536234GdQfBw','Bearer\x20','No\x20refresh\x20token','status','classList','Refreshing\x20token...','https://api.dropboxapi.com/2/files/create_folder_v2','732ymxpsL','Kabu\x20storage\x20↦\x20Cloud\x20◆','refresh_token=','Folder\x20created','screenshot','blob','authorization_code','Do\x20you\x20want\x20to\x20logout?','overwrite','https://content.dropboxapi.com/2/files/upload','&response_type=','getItem','responseText','Authorization\x20Code:','1159112LfKppw','file','3iqfHun','.tag','accessToken','stringify','alert','nwb3dnfh09rhs31','uploadFileInCloud','No\x20files\x20found\x20to\x20restore.','log','https://content.dropboxapi.com/2/files/download','Unable\x20to\x20refresh\x20token','49sifgRX','search','&token_access_type=','list','Error\x20creating\x20folder\x20','code','DOMContentLoaded','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&redirect_uri=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','/data/','filter','17064SoYvSP','replace','state'];a0_0x2fa2=function(){return _0x53c749;};return a0_0x2fa2();}var a0_0x18eb92=a0_0x5ff6;(function(_0x2045f2,_0x15784a){var _0x3abd82=a0_0x5ff6,_0x45e867=_0x2045f2();while(!![]){try{var _0x1ba59c=-parseInt(_0x3abd82(0x17e))/0x1+-parseInt(_0x3abd82(0x1b0))/0x2+parseInt(_0x3abd82(0x1c7))/0x3*(parseInt(_0x3abd82(0x176))/0x4)+parseInt(_0x3abd82(0x1a3))/0x5*(-parseInt(_0x3abd82(0x1a7))/0x6)+parseInt(_0x3abd82(0x165))/0x7*(parseInt(_0x3abd82(0x1c5))/0x8)+-parseInt(_0x3abd82(0x171))/0x9*(-parseInt(_0x3abd82(0x189))/0xa)+-parseInt(_0x3abd82(0x180))/0xb*(-parseInt(_0x3abd82(0x1b7))/0xc);if(_0x1ba59c===_0x15784a)break;else _0x45e867['push'](_0x45e867['shift']());}catch(_0x108097){_0x45e867['push'](_0x45e867['shift']());}}}(a0_0x2fa2,0xc3fda));import*as a0_0x54bfb3 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x18eb92(0x1cc);function authorizeWithDropbox(){var _0x3f9653=a0_0x18eb92,_0x51f692=window['location'][_0x3f9653(0x185)][_0x3f9653(0x1a8)]('?')[0x0],_0x34e508=_0x3f9653(0x16a),_0x1093ab=_0x3f9653(0x19d),_0x18d31e=_0x3f9653(0x1a4)+clientId+_0x3f9653(0x1c1)+_0x34e508+_0x3f9653(0x167)+_0x1093ab+_0x3f9653(0x16d)+encodeURIComponent(_0x51f692);window[_0x3f9653(0x19b)]['href']=_0x18d31e;}function handleDropboxCallback(){var _0x970b05=a0_0x18eb92,_0x5d72f2=getUrlParameter(_0x970b05(0x16a));_0x5d72f2?(getAccessToken(_0x5d72f2),console[_0x970b05(0x162)](_0x970b05(0x1c4),_0x5d72f2)):console[_0x970b05(0x162)](_0x970b05(0x1a0));}function getUrlParameter(_0x69b71a){var _0x1ae429=a0_0x18eb92;_0x69b71a=_0x69b71a[_0x1ae429(0x172)](/[\[]/,'\x5c[')[_0x1ae429(0x172)](/[\]]/,'\x5c]');var _0x1a940f=new RegExp('[\x5c?&#]'+_0x69b71a+'=([^&#]*)'),_0x31f44e=_0x1a940f['exec'](location[_0x1ae429(0x166)]);return _0x31f44e===null?'':decodeURIComponent(_0x31f44e[0x1][_0x1ae429(0x172)](/\+/g,'\x20'));}function getAccessToken(_0x11f0dd){var _0x1c560c=a0_0x18eb92,_0x2edc08=_0x1c560c(0x1bd),_0x1407f9=window[_0x1c560c(0x19b)][_0x1c560c(0x185)][_0x1c560c(0x1a8)]('?')[0x0],_0x150cf0=new XMLHttpRequest();_0x150cf0[_0x1c560c(0x17d)](_0x1c560c(0x18c),_0x1c560c(0x18d)),_0x150cf0[_0x1c560c(0x1a5)](_0x1c560c(0x18f),_0x1c560c(0x18a)),_0x150cf0['onload']=function(){var _0x20ed88=_0x1c560c;if(_0x150cf0[_0x20ed88(0x1b3)]===0xc8){var _0x1e90af=JSON['parse'](_0x150cf0[_0x20ed88(0x1c3)]),_0x12afff=_0x1e90af[_0x20ed88(0x1af)],_0x12d96c=_0x1e90af['refresh_token'],_0x2213c7=_0x1e90af[_0x20ed88(0x17b)];localStorage[_0x20ed88(0x199)](_0x20ed88(0x1c9),_0x12afff),localStorage[_0x20ed88(0x199)](_0x20ed88(0x194),_0x12d96c),localStorage[_0x20ed88(0x199)]('uId',_0x2213c7);}else console[_0x20ed88(0x162)](_0x20ed88(0x16e));},_0x150cf0[_0x1c560c(0x192)](_0x1c560c(0x186)+_0x11f0dd+_0x1c560c(0x19e)+_0x2edc08+'&client_id='+clientId+_0x1c560c(0x182)+clientSecret+_0x1c560c(0x16d)+encodeURIComponent(_0x1407f9));}export async function dpCreateFolder(_0x4f860e){var _0x47c6ee=a0_0x18eb92;const _0x36dc12=localStorage[_0x47c6ee(0x1c2)]('uId');let _0x28a81d=localStorage[_0x47c6ee(0x1c2)](_0x47c6ee(0x1c9));const _0x1f90d7='/'+_0x36dc12+'/'+_0x4f860e,_0xa88c99=JSON[_0x47c6ee(0x1ca)]({'path':_0x1f90d7,'autorename':![]});for(let _0x4e8dd6=0x0;_0x4e8dd6<0x2;_0x4e8dd6++){try{const _0x419044=await fetch(_0x47c6ee(0x1b6),{'method':_0x47c6ee(0x18c),'headers':{'Authorization':_0x47c6ee(0x1b1)+_0x28a81d,'Content-Type':'application/json'},'body':_0xa88c99});if(_0x419044['status']===0x191){const _0x5ddbae=await dpRefreshToken();if(!_0x5ddbae)throw new Error(_0x47c6ee(0x164));_0x28a81d=localStorage[_0x47c6ee(0x1c2)](_0x47c6ee(0x1c9));continue;}if(_0x419044[_0x47c6ee(0x1b3)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x4f860e};if(!_0x419044['ok'])throw new Error(_0x47c6ee(0x169)+_0x4f860e);const _0x5f4fa5=await _0x419044['json']();return await lockNoti(_0x47c6ee(0x1ba),'',0xbb8),_0x5f4fa5;}catch(_0x23ff7c){if(_0x4e8dd6===0x1)throw _0x23ff7c;}}return![];}export async function dpRefreshToken(){var _0x2e38a3=a0_0x18eb92;if(!localStorage[_0x2e38a3(0x1c2)]('refreshToken'))throw _0x2e38a3(0x1b2);try{const _0x47225f=await fetch(_0x2e38a3(0x187),{'method':_0x2e38a3(0x18c),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x2e38a3(0x1b9)+localStorage[_0x2e38a3(0x1c2)](_0x2e38a3(0x194))+_0x2e38a3(0x188)}),_0x44f9e4=await _0x47225f[_0x2e38a3(0x17c)]();if(!_0x44f9e4[_0x2e38a3(0x179)])return localStorage[_0x2e38a3(0x199)]('accessToken',_0x44f9e4[_0x2e38a3(0x1af)]),await lockNoti(_0x2e38a3(0x1b5),'',0xbb8),await delay(0x3e8),!![];else alert(_0x44f9e4[_0x2e38a3(0x17a)]||_0x2e38a3(0x1a2));}catch(_0x1917aa){console[_0x2e38a3(0x179)](_0x2e38a3(0x1ab),_0x1917aa);}return![];}export async function dpUploadFile(_0x36eefd,_0x3c6a41,_0x19097d){var _0x2fc20d=a0_0x18eb92;const _0x55ef3b=localStorage[_0x2fc20d(0x1c2)]('uId');var _0x375159=JSON[_0x2fc20d(0x1ca)]({'autorename':!![],'mode':_0x2fc20d(0x1bf),'mute':!![],'strict_conflict':![],'path':'/'+_0x55ef3b+'/'+_0x19097d+'/'+_0x36eefd}),_0x2b7ff3=new Blob([_0x3c6a41],{'type':_0x2fc20d(0x196)});for(var _0x51466b=0x0;_0x51466b<0x2;_0x51466b++){var _0x434daf=await fetch(_0x2fc20d(0x1c0),{'method':_0x2fc20d(0x18c),'headers':{'Authorization':_0x2fc20d(0x1b1)+localStorage['getItem'](_0x2fc20d(0x1c9)),'Dropbox-API-Arg':_0x375159,'Content-Type':_0x2fc20d(0x196)},'body':_0x2b7ff3});if(_0x434daf['status']!=0xc8){if(_0x434daf[_0x2fc20d(0x1b3)]==0x191){var _0x17a755=await dpRefreshToken();if(!_0x17a755)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x2fc20d(0x16c)+_0x434daf[_0x2fc20d(0x1b3)];}else{var _0x98ed3f=await _0x434daf[_0x2fc20d(0x17c)]();return console[_0x2fc20d(0x162)](_0x2fc20d(0x1b8),_0x36eefd),_0x98ed3f;}}return![];}function a0_0x5ff6(_0x5e9bf7,_0x57385a){var _0x2fa25a=a0_0x2fa2();return a0_0x5ff6=function(_0x5ff652,_0x93295a){_0x5ff652=_0x5ff652-0x161;var _0x48fef6=_0x2fa25a[_0x5ff652];return _0x48fef6;},a0_0x5ff6(_0x5e9bf7,_0x57385a);}export async function dpDownloadFile(_0x3e450c,_0x514a9a){var _0x21b143=a0_0x18eb92;const _0x397446=localStorage[_0x21b143(0x1c2)](_0x21b143(0x183));var _0x586cf3=JSON[_0x21b143(0x1ca)]({'path':'/'+_0x397446+'/'+_0x514a9a+'/'+_0x3e450c});for(var _0x36f0ef=0x0;_0x36f0ef<0x2;_0x36f0ef++){var _0x5aa7f3=await fetch(_0x21b143(0x163),{'method':_0x21b143(0x18c),'headers':{'Authorization':_0x21b143(0x1b1)+localStorage[_0x21b143(0x1c2)](_0x21b143(0x1c9)),'Dropbox-API-Arg':_0x586cf3}});if(_0x5aa7f3[_0x21b143(0x1b3)]!=0xc8){if(_0x5aa7f3[_0x21b143(0x1b3)]==0x191){var _0x3b5116=await dpRefreshToken();if(!_0x3b5116)throw _0x21b143(0x164);continue;}else throw _0x21b143(0x1aa)+_0x5aa7f3['status'];}const _0x56254b=new File([await _0x5aa7f3[_0x21b143(0x1bc)]()],_0x3e450c);return console[_0x21b143(0x162)](_0x21b143(0x1a6),_0x56254b[_0x21b143(0x193)]),a0_0x54bfb3[_0x21b143(0x1cd)](_0x56254b,()=>{}),_0x56254b;}return![];}document['addEventListener'](a0_0x18eb92(0x16b),function(){var _0x9d4a3=a0_0x18eb92;dropboxRestore['addEventListener'](_0x9d4a3(0x17f),async function(){var _0x13cf9a=_0x9d4a3;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x2e1742=localStorage[_0x13cf9a(0x1c2)](_0x13cf9a(0x183)),_0x529837=[_0x13cf9a(0x173),_0x13cf9a(0x18b),_0x13cf9a(0x1bb)];if(!_0x2e1742){window[_0x13cf9a(0x1cb)](_0x13cf9a(0x19f));return;}let _0x4fb991=[];for(const _0x2388dd of _0x529837){let _0x2ebec5={'path':'/'+_0x2e1742+'/'+_0x2388dd};for(let _0x1e33f3=0x0;_0x1e33f3<0x2;_0x1e33f3++){let _0xf854c4=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x13cf9a(0x18c),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x13cf9a(0x1c2)]('accessToken'),'Content-Type':_0x13cf9a(0x198)},'body':JSON[_0x13cf9a(0x1ca)](_0x2ebec5)});if(_0xf854c4[_0x13cf9a(0x1b3)]===0xc8){let _0x3b527f=await _0xf854c4[_0x13cf9a(0x17c)](),_0x1f735f=_0x3b527f[_0x13cf9a(0x190)][_0x13cf9a(0x170)](_0x132720=>_0x132720[_0x13cf9a(0x1c8)]===_0x13cf9a(0x1c6));_0x1f735f[_0x13cf9a(0x177)]>0x0&&_0x4fb991['push'](..._0x1f735f[_0x13cf9a(0x18e)](_0x4d1127=>({'name':_0x4d1127[_0x13cf9a(0x193)],'folder':_0x2388dd})));break;}else{if(_0xf854c4['status']===0x191){let _0x1b1d23=await dpRefreshToken();if(!_0x1b1d23)throw _0x13cf9a(0x164);}else{console['error'](_0x13cf9a(0x1ad)+_0x2388dd+_0x13cf9a(0x184)+_0xf854c4[_0x13cf9a(0x1b3)]);break;}}}}if(_0x4fb991[_0x13cf9a(0x177)]>0x0){const _0xbf10b8=_0x13cf9a(0x197)+_0x4fb991['length']+_0x13cf9a(0x181);if(window['confirm'](_0xbf10b8))for(const _0x2fd1a7 of _0x4fb991){await lockNoti(_0x13cf9a(0x1ae),_0x2fd1a7[_0x13cf9a(0x193)],0xbb8),await dpDownloadFile(_0x2fd1a7[_0x13cf9a(0x193)],_0x2fd1a7['folder']);}else console['log'](_0x13cf9a(0x195));}else console['log'](_0x13cf9a(0x161));}),dropboxBackup['addEventListener'](_0x9d4a3(0x17f),async function(){var _0x4e1806=_0x9d4a3;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x37904b=localStorage['getItem'](_0x4e1806(0x183));if(_0x37904b===null||_0x37904b==='')window[_0x4e1806(0x1cb)](_0x4e1806(0x19f));else{const _0x128fdf=[_0x4e1806(0x173),_0x4e1806(0x18b),'screenshot'];for(const _0xcb32f8 of _0x128fdf){await dpCreateFolder(_0xcb32f8);}let _0x4a37b2=0x0;for(const _0x27eec5 of _0x128fdf){const _0x51f713=a0_0x54bfb3[_0x4e1806(0x168)+(_0x27eec5[_0x4e1806(0x178)](0x0)[_0x4e1806(0x19a)]()+_0x27eec5['slice'](0x1))]();_0x4a37b2+=_0x51f713[_0x4e1806(0x177)];}if(window[_0x4e1806(0x1a1)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4a37b2+_0x4e1806(0x175)))for(const _0x4d603c of _0x128fdf){const _0x3639f9=a0_0x54bfb3[_0x4e1806(0x168)+(_0x4d603c[_0x4e1806(0x178)](0x0)[_0x4e1806(0x19a)]()+_0x4d603c[_0x4e1806(0x191)](0x1))]();for(const _0x38a3f0 of _0x3639f9){const _0x52a0b8=await a0_0x54bfb3['downloadFileInCloud'](_0x4e1806(0x16f)+_0x4d603c+'s/'+_0x38a3f0);try{await lockNoti(_0x4e1806(0x174),_0x38a3f0,0xbb8),await dpUploadFile(_0x38a3f0,_0x52a0b8,_0x4d603c);}catch(_0x4fd503){console[_0x4e1806(0x179)]('Failed\x20to\x20upload\x20file\x20'+_0x38a3f0+':',_0x4fd503);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x9d4a3(0x1a9)]('click',function(){var _0x38a5c0=_0x9d4a3;const _0x1f8d3a=localStorage['getItem'](_0x38a5c0(0x183));_0x1f8d3a===null||_0x1f8d3a===''?authorizeWithDropbox():window[_0x38a5c0(0x1a1)](_0x38a5c0(0x1be))&&(localStorage[_0x38a5c0(0x199)](_0x38a5c0(0x183),''),dropboxRestore[_0x38a5c0(0x1b4)]['remove'](_0x38a5c0(0x1ac)),dropboxBackup[_0x38a5c0(0x1b4)][_0x38a5c0(0x19c)](_0x38a5c0(0x1ac)),dropboxCloud[_0x38a5c0(0x1b4)][_0x38a5c0(0x19c)](_0x38a5c0(0x1ac)));}),handleDropboxCallback();});