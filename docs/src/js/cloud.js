var a0_0x57dc99=a0_0x5655;(function(_0x2d9e9b,_0x29c6c5){var _0x20ef9b=a0_0x5655,_0x38b38d=_0x2d9e9b();while(!![]){try{var _0x37cc7d=-parseInt(_0x20ef9b(0xbc))/0x1*(-parseInt(_0x20ef9b(0xdd))/0x2)+-parseInt(_0x20ef9b(0x9d))/0x3+parseInt(_0x20ef9b(0x95))/0x4*(-parseInt(_0x20ef9b(0xe7))/0x5)+parseInt(_0x20ef9b(0xc4))/0x6*(parseInt(_0x20ef9b(0xed))/0x7)+-parseInt(_0x20ef9b(0xb9))/0x8+parseInt(_0x20ef9b(0xb5))/0x9*(parseInt(_0x20ef9b(0xf5))/0xa)+-parseInt(_0x20ef9b(0xda))/0xb*(-parseInt(_0x20ef9b(0xa1))/0xc);if(_0x37cc7d===_0x29c6c5)break;else _0x38b38d['push'](_0x38b38d['shift']());}catch(_0x300017){_0x38b38d['push'](_0x38b38d['shift']());}}}(a0_0x408f,0x7016d));import*as a0_0x4c9128 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x57dc99(0xa4),clientSecret=a0_0x57dc99(0x91);function authorizeWithDropbox(){var _0x207906=a0_0x57dc99,_0x3b740c=window[_0x207906(0xec)][_0x207906(0x9f)][_0x207906(0xdf)]('?')[0x0],_0x5c373a='code',_0x4a7fd2=_0x207906(0xd2),_0x301c21='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x207906(0xfb)+_0x5c373a+_0x207906(0xe6)+_0x4a7fd2+'&redirect_uri='+encodeURIComponent(_0x3b740c);window[_0x207906(0xec)][_0x207906(0x9f)]=_0x301c21;}function handleDropboxCallback(){var _0x30aaf1=a0_0x57dc99,_0x47bc60=getUrlParameter(_0x30aaf1(0xf6));_0x47bc60?(getAccessToken(_0x47bc60),console[_0x30aaf1(0xfc)](_0x30aaf1(0x90),_0x47bc60)):console['log'](_0x30aaf1(0xd6));}function getUrlParameter(_0xf2d3f2){var _0x20482f=a0_0x57dc99;_0xf2d3f2=_0xf2d3f2[_0x20482f(0x101)](/[\[]/,'\x5c[')[_0x20482f(0x101)](/[\]]/,'\x5c]');var _0x48a9b6=new RegExp(_0x20482f(0xf7)+_0xf2d3f2+_0x20482f(0xd9)),_0x7e583c=_0x48a9b6[_0x20482f(0x98)](location[_0x20482f(0xbd)]);return _0x7e583c===null?'':decodeURIComponent(_0x7e583c[0x1]['replace'](/\+/g,'\x20'));}function a0_0x5655(_0x3c351f,_0x3bd95d){var _0x408f0f=a0_0x408f();return a0_0x5655=function(_0x565590,_0x461b01){_0x565590=_0x565590-0x8e;var _0x36a099=_0x408f0f[_0x565590];return _0x36a099;},a0_0x5655(_0x3c351f,_0x3bd95d);}function getAccessToken(_0x3bc221){var _0x48acef=a0_0x57dc99,_0x364dfc=_0x48acef(0xcc),_0x4102f2=window[_0x48acef(0xec)][_0x48acef(0x9f)][_0x48acef(0xdf)]('?')[0x0],_0x16d2b4=new XMLHttpRequest();_0x16d2b4[_0x48acef(0xe9)]('POST','https://api.dropbox.com/oauth2/token'),_0x16d2b4[_0x48acef(0xf8)](_0x48acef(0xa3),_0x48acef(0x93)),_0x16d2b4['onload']=function(){var _0x568b2b=_0x48acef;if(_0x16d2b4[_0x568b2b(0xba)]===0xc8){var _0x231a34=JSON['parse'](_0x16d2b4[_0x568b2b(0xee)]),_0x6c073a=_0x231a34[_0x568b2b(0x99)],_0x13f0b6=_0x231a34[_0x568b2b(0xb2)],_0x36e12f=_0x231a34['uid'];localStorage['setItem']('accessToken',_0x6c073a),localStorage[_0x568b2b(0xe5)]('refreshToken',_0x13f0b6),localStorage['setItem'](_0x568b2b(0x100),_0x36e12f);}else console[_0x568b2b(0xfc)](_0x568b2b(0xc3));},_0x16d2b4[_0x48acef(0xcb)](_0x48acef(0xaf)+_0x3bc221+'&grant_type='+_0x364dfc+_0x48acef(0xbe)+clientId+_0x48acef(0x8f)+clientSecret+_0x48acef(0xbb)+encodeURIComponent(_0x4102f2));}export async function dpRefreshToken(){var _0x43d9b6=a0_0x57dc99;if(!localStorage['getItem'](_0x43d9b6(0x9c)))throw _0x43d9b6(0xac);try{const _0x7db381=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x43d9b6(0xfa),'headers':{'Content-Type':_0x43d9b6(0x93)},'body':'refresh_token='+localStorage[_0x43d9b6(0x97)](_0x43d9b6(0x9c))+_0x43d9b6(0xc1)}),_0x142756=await _0x7db381[_0x43d9b6(0xce)]();if(!_0x142756[_0x43d9b6(0xd4)])return localStorage['setItem']('accessToken',_0x142756[_0x43d9b6(0x99)]),await lockNoti('',_0x43d9b6(0xc6),0xbb8),await delay(0x3e8),!![];else alert(_0x142756['error_description']||_0x43d9b6(0xff));}catch(_0x2b6618){console[_0x43d9b6(0xd4)](_0x43d9b6(0xcd),_0x2b6618);}return![];}export async function dpUploadFile(_0x41b0e8,_0x37ecc2){var _0x3f20b1=a0_0x57dc99;const _0x27bdc3=localStorage['getItem']('uId');var _0x5e4bba=JSON[_0x3f20b1(0xd7)]({'autorename':!![],'mode':_0x3f20b1(0xc0),'mute':!![],'strict_conflict':![],'path':'/'+_0x27bdc3+'/'+_0x41b0e8}),_0x72283e=new Blob([_0x37ecc2],{'type':_0x3f20b1(0xc8)});for(var _0x289b00=0x0;_0x289b00<0x2;_0x289b00++){var _0x319c74=await fetch(_0x3f20b1(0x96),{'method':'POST','headers':{'Authorization':_0x3f20b1(0x9b)+localStorage[_0x3f20b1(0x97)]('accessToken'),'Dropbox-API-Arg':_0x5e4bba,'Content-Type':_0x3f20b1(0xc8)},'body':_0x72283e});if(_0x319c74[_0x3f20b1(0xba)]!=0xc8){if(_0x319c74[_0x3f20b1(0xba)]==0x191){var _0x3261e5=await dpRefreshToken();if(!_0x3261e5)throw _0x3f20b1(0xf4);continue;}else throw _0x3f20b1(0xaa)+_0x319c74[_0x3f20b1(0xba)];}else{var _0x24e46e=await _0x319c74[_0x3f20b1(0xce)]();return console[_0x3f20b1(0xfc)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x41b0e8),_0x24e46e;}}return![];}async function dpDownloadFile(_0x5bc539){var _0x6ab143=a0_0x57dc99;const _0x5f2d42=localStorage['getItem'](_0x6ab143(0x100));var _0x514091=JSON['stringify']({'path':'/'+_0x5f2d42+'/'+_0x5bc539});for(var _0x8a52ee=0x0;_0x8a52ee<0x2;_0x8a52ee++){var _0x1d7e35=await fetch(_0x6ab143(0xb1),{'method':_0x6ab143(0xfa),'headers':{'Authorization':_0x6ab143(0x9b)+localStorage[_0x6ab143(0x97)](_0x6ab143(0xfd)),'Dropbox-API-Arg':_0x514091}});if(_0x1d7e35['status']!=0xc8){if(_0x1d7e35[_0x6ab143(0xba)]==0x191){var _0xa339e9=await dpRefreshToken();if(!_0xa339e9)throw _0x6ab143(0xf4);continue;}else throw _0x6ab143(0x9a)+_0x1d7e35[_0x6ab143(0xba)];}const _0x214be7=new File([await _0x1d7e35[_0x6ab143(0xad)]()],_0x5bc539);console[_0x6ab143(0xfc)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x214be7[_0x6ab143(0xab)]);if(_0x5bc539[_0x6ab143(0xe8)](_0x6ab143(0xf0))){const _0x4283d3=await _0x214be7[_0x6ab143(0xbf)](),[_0x595d5e,_0x30b9d8]=_0x4283d3[_0x6ab143(0xdf)]('\x0a\x0a'),_0x5c3f1e=_0x5bc539[_0x6ab143(0xb4)](0x0,_0x5bc539['lastIndexOf']('gba')+0x3),_0x5db792=_0x5bc539[_0x6ab143(0xe2)](_0x5bc539['length']-0x5);localStorage[_0x6ab143(0xe5)](_0x5c3f1e+'_dateState'+_0x5db792,_0x30b9d8),localStorage[_0x6ab143(0xe5)](_0x5c3f1e+_0x6ab143(0xdb)+_0x5db792,_0x595d5e);}else a0_0x4c9128[_0x6ab143(0x8e)](_0x214be7,()=>{var _0x31a860=_0x6ab143;localStorageFile(),Module[_0x31a860(0xde)]();});return _0x214be7;}return![];}function a0_0x408f(){var _0x2bfdb2=['json','.ss2','length','addEventListener','offline','lastIndexOf','error','alert','Do\x20not\x20receive\x20authorization','stringify','entries','=([^&#]*)','5088292Khyizg','_imageState','DOMContentLoaded','1701180bVkxBo','FSSync','split','/data/','.ss7','charAt','.gba_imageState','application/json','setItem','&token_access_type=','85PaNtBQ','endsWith','open','slice','.gba_dateState','location','119091idtuDG','responseText','Do\x20you\x20want\x20to\x20backup\x20','.txt','downloadFileInCloud','Backing\x20up...','.ss1','Unable\x20to\x20refresh\x20token','10NBSrAu','code','[\x5c?&#]','setRequestHeader','toUpperCase','POST','&response_type=','log','accessToken','classList','Failed\x20to\x20refresh\x20Dropbox\x20token.','uId','replace','list','uploadSaveOrSaveState','&client_secret=','Authorization\x20Code:','nwb3dnfh09rhs31','.gba_slot','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20restore\x20','155224VHhvOA','https://content.dropboxapi.com/2/files/upload','getItem','exec','access_token','Download\x20failed,\x20unknown\x20http\x20status:','Bearer\x20','refreshToken','1897458UkuTTR','https://api.dropboxapi.com/2/files/list_folder','href','active','12nLIymI','remove','Content-Type','knh3uz2mx2hp2eu','.ss5','confirm','click','Restore\x20canceled\x20by\x20user.','Failed\x20to\x20upload\x20file\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','name','No\x20refresh\x20token','blob','Cloud\x20login\x20required!','code=','.ss4','https://content.dropboxapi.com/2/files/download','refresh_token','status:\x20','substring','2711367PuNGEb','save','.ss3','.ss0','5301848ZhYvec','status','&redirect_uri=','1qGOIEw','search','&client_id=','text','overwrite','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','.tag','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','282yFJxnM','filter','Refreshing\x20token...','file','application/octet-stream','Restoring...','state','send','authorization_code','Error\x20while\x20refreshing\x20token:'];a0_0x408f=function(){return _0x2bfdb2;};return a0_0x408f();}document['addEventListener'](a0_0x57dc99(0xdc),function(){var _0x50b64e=a0_0x57dc99;dropboxRestore[_0x50b64e(0xd1)](_0x50b64e(0xa7),async function(){var _0x35ca5f=_0x50b64e;const _0x104a0d=localStorage[_0x35ca5f(0x97)](_0x35ca5f(0x100));if(_0x104a0d===null||_0x104a0d==='')window[_0x35ca5f(0xd5)]('Cloud\x20login\x20required!');else{var _0x43e659={'path':'/'+_0x104a0d};for(var _0x2a7c41=0x0;_0x2a7c41<0x2;_0x2a7c41++){var _0xca9f55=await fetch(_0x35ca5f(0x9e),{'method':'POST','headers':{'Authorization':_0x35ca5f(0x9b)+localStorage[_0x35ca5f(0x97)](_0x35ca5f(0xfd)),'Content-Type':_0x35ca5f(0xe4)},'body':JSON[_0x35ca5f(0xd7)](_0x43e659)});console[_0x35ca5f(0xfc)](_0x35ca5f(0xb3),_0xca9f55[_0x35ca5f(0xba)]);if(_0xca9f55[_0x35ca5f(0xba)]!=0xc8){if(_0xca9f55['status']==0x191){var _0x161e86=await dpRefreshToken();if(!_0x161e86)throw _0x35ca5f(0xf4);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0xca9f55[_0x35ca5f(0xba)];}else{const _0x23b96a=await _0xca9f55[_0x35ca5f(0xce)](),_0x63fcbe=_0x23b96a['entries'][_0x35ca5f(0xc5)](_0x47f019=>_0x47f019[_0x35ca5f(0xc2)]==='file')[_0x35ca5f(0xd0)],_0x5f4eaa=_0x35ca5f(0x94)+_0x63fcbe+'\x20files\x20in\x20Cloud?';if(window[_0x35ca5f(0xa6)](_0x5f4eaa))for(const _0x1d9a94 of _0x23b96a[_0x35ca5f(0xd8)]){_0x1d9a94[_0x35ca5f(0xc2)]===_0x35ca5f(0xc7)&&(await lockNoti(_0x35ca5f(0xc9),_0x1d9a94[_0x35ca5f(0xab)],0xbb8),await dpDownloadFile(_0x1d9a94['name']));}else console['log'](_0x35ca5f(0xa8));return!![];}}return![];}}),dropboxBackup[_0x50b64e(0xd1)](_0x50b64e(0xa7),async function(){var _0x4c5477=_0x50b64e;const _0x5719ce=localStorage['getItem'](_0x4c5477(0x100));if(_0x5719ce===null||_0x5719ce==='')window['alert'](_0x4c5477(0xae));else{const _0xe5e544=[_0x4c5477(0xca),_0x4c5477(0xb6)];let _0x2168c8=0x0;for(const _0x4c094f of _0xe5e544){const _0x569fba=a0_0x4c9128[_0x4c5477(0x102)+(_0x4c094f[_0x4c5477(0xe2)](0x0)[_0x4c5477(0xf9)]()+_0x4c094f['slice'](0x1))]();_0x2168c8+=_0x569fba[_0x4c5477(0xd0)];}if(window[_0x4c5477(0xa6)](_0x4c5477(0xef)+_0x2168c8+'\x20files\x20in\x20Kabu?'))for(const _0x45a999 of _0xe5e544){const _0x5bbf10=a0_0x4c9128['list'+(_0x45a999[_0x4c5477(0xe2)](0x0)[_0x4c5477(0xf9)]()+_0x45a999[_0x4c5477(0xea)](0x1))]();for(const _0x23694d of _0x5bbf10){const _0x5376ac=await a0_0x4c9128[_0x4c5477(0xf1)](_0x4c5477(0xe0)+_0x45a999+'s/'+_0x23694d);try{await lockNoti(_0x4c5477(0xf2),_0x23694d,0xbb8),await dpUploadFile(_0x23694d,_0x5376ac);if(_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xb8))||_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xf3))||_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xcf))||_0x23694d['endsWith'](_0x4c5477(0xb7))||_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xb0))||_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xa5))||_0x23694d['endsWith']('.ss6')||_0x23694d[_0x4c5477(0xe8)](_0x4c5477(0xe1))){const _0x28b918=_0x23694d[_0x4c5477(0xb4)](0x0,_0x23694d[_0x4c5477(0xd3)]('.')),_0x27bc05=_0x23694d[_0x4c5477(0xe2)](_0x23694d['length']-0x1),_0x16be4c=localStorage[_0x4c5477(0x97)](_0x28b918+_0x4c5477(0xe3)+_0x27bc05),_0x3aa25a=localStorage[_0x4c5477(0x97)](_0x28b918+_0x4c5477(0xeb)+_0x27bc05);if(_0x16be4c!==null){const _0x2d6d60=_0x16be4c+'\x0a\x0a'+_0x3aa25a,_0x1b4065=new Blob([_0x2d6d60],{'type':'text/plain'});await lockNoti(_0x4c5477(0xf2),_0x28b918+_0x4c5477(0x92)+_0x27bc05+_0x4c5477(0xf0),0xbb8),await dpUploadFile(_0x28b918+_0x4c5477(0x92)+_0x27bc05+_0x4c5477(0xf0),_0x1b4065);}}}catch(_0x317a61){console[_0x4c5477(0xd4)](_0x4c5477(0xa9)+_0x23694d+':',_0x317a61);}}}else console[_0x4c5477(0xfc)](_0x4c5477(0xa8));}}),dropboxCloud['addEventListener'](_0x50b64e(0xa7),function(){var _0x358c8f=_0x50b64e;const _0x80b13=localStorage[_0x358c8f(0x97)]('uId');_0x80b13===null||_0x80b13===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x358c8f(0xe5)]('uId',''),dropboxRestore[_0x358c8f(0xfe)][_0x358c8f(0xa2)]('active'),dropboxBackup[_0x358c8f(0xfe)][_0x358c8f(0xa2)](_0x358c8f(0xa0)),dropboxCloud[_0x358c8f(0xfe)][_0x358c8f(0xa2)](_0x358c8f(0xa0)));}),handleDropboxCallback();});