var a0_0x30d2d9=a0_0x5a72;(function(_0x40ea51,_0x248769){var _0x43dba8=a0_0x5a72,_0x4655de=_0x40ea51();while(!![]){try{var _0x653314=parseInt(_0x43dba8(0x206))/0x1+parseInt(_0x43dba8(0x207))/0x2*(-parseInt(_0x43dba8(0x1bc))/0x3)+-parseInt(_0x43dba8(0x1ca))/0x4*(-parseInt(_0x43dba8(0x1e5))/0x5)+parseInt(_0x43dba8(0x1cf))/0x6*(parseInt(_0x43dba8(0x1ec))/0x7)+-parseInt(_0x43dba8(0x1dc))/0x8+parseInt(_0x43dba8(0x1f2))/0x9+-parseInt(_0x43dba8(0x1ef))/0xa;if(_0x653314===_0x248769)break;else _0x4655de['push'](_0x4655de['shift']());}catch(_0x1b5ecf){_0x4655de['push'](_0x4655de['shift']());}}}(a0_0x3917,0x71847));import*as a0_0x2000ac from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x30d2d9(0x1ba),clientSecret=a0_0x30d2d9(0x1b5);function authorizeWithDropbox(){var _0x235c1c=a0_0x30d2d9,_0x10ec4b=window[_0x235c1c(0x1bf)][_0x235c1c(0x1e4)]['split']('?')[0x0],_0x4adce5=_0x235c1c(0x201),_0x5b9dd6=_0x235c1c(0x1c7),_0x514d59='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x4adce5+_0x235c1c(0x1db)+_0x5b9dd6+_0x235c1c(0x1e3)+encodeURIComponent(_0x10ec4b);window[_0x235c1c(0x1bf)]['href']=_0x514d59;}function handleDropboxCallback(){var _0x219d76=a0_0x30d2d9,_0x14621c=getUrlParameter(_0x219d76(0x201));_0x14621c?(getAccessToken(_0x14621c),console[_0x219d76(0x1c4)](_0x219d76(0x1e7),_0x14621c)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x5d3a5e){var _0xa593b=a0_0x30d2d9;_0x5d3a5e=_0x5d3a5e[_0xa593b(0x1b0)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x5883d7=new RegExp('[\x5c?&#]'+_0x5d3a5e+_0xa593b(0x1c0)),_0x414570=_0x5883d7[_0xa593b(0x1e2)](location[_0xa593b(0x209)]);return _0x414570===null?'':decodeURIComponent(_0x414570[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x8c78d7){var _0x45734b=a0_0x30d2d9,_0x1a7d90=_0x45734b(0x1d5),_0x1d869e=window[_0x45734b(0x1bf)][_0x45734b(0x1e4)][_0x45734b(0x1af)]('?')[0x0],_0x4fd28d=new XMLHttpRequest();_0x4fd28d['open'](_0x45734b(0x1ed),_0x45734b(0x1d9)),_0x4fd28d[_0x45734b(0x1b1)]('Content-Type',_0x45734b(0x1de)),_0x4fd28d[_0x45734b(0x204)]=function(){var _0x467379=_0x45734b;if(_0x4fd28d['status']===0xc8){var _0x3b84e5=JSON[_0x467379(0x1f8)](_0x4fd28d[_0x467379(0x1fc)]),_0x28482f=_0x3b84e5[_0x467379(0x1e6)],_0x57c888=_0x3b84e5['refresh_token'],_0x5c8076=_0x3b84e5[_0x467379(0x1aa)];localStorage[_0x467379(0x1fa)]('accessToken',_0x28482f),localStorage['setItem']('refreshToken',_0x57c888),localStorage[_0x467379(0x1fa)](_0x467379(0x1ae),_0x5c8076);}else console[_0x467379(0x1c4)](_0x467379(0x1f9));},_0x4fd28d['send'](_0x45734b(0x1ac)+_0x8c78d7+_0x45734b(0x1e9)+_0x1a7d90+_0x45734b(0x1df)+clientId+_0x45734b(0x1b9)+clientSecret+_0x45734b(0x1e3)+encodeURIComponent(_0x1d869e));}export async function dpCreateFolder(_0x1003bb){var _0x1d8721=a0_0x30d2d9;const _0x4d360d=localStorage[_0x1d8721(0x1c8)](_0x1d8721(0x1ae));let _0x37b42b=localStorage[_0x1d8721(0x1c8)](_0x1d8721(0x1c6));const _0x390936='/'+_0x4d360d+'/'+_0x1003bb,_0x32d6ee=JSON['stringify']({'path':_0x390936,'autorename':![]});for(let _0x3c84d4=0x0;_0x3c84d4<0x2;_0x3c84d4++){try{const _0x326346=await fetch(_0x1d8721(0x1f0),{'method':_0x1d8721(0x1ed),'headers':{'Authorization':_0x1d8721(0x20a)+_0x37b42b,'Content-Type':_0x1d8721(0x1c2)},'body':_0x32d6ee});if(_0x326346[_0x1d8721(0x205)]===0x191){const _0x59254f=await dpRefreshToken();if(!_0x59254f)throw new Error(_0x1d8721(0x200));_0x37b42b=localStorage[_0x1d8721(0x1c8)](_0x1d8721(0x1c6));continue;}if(_0x326346[_0x1d8721(0x205)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x1003bb};if(!_0x326346['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x1003bb);const _0x3099ab=await _0x326346[_0x1d8721(0x1da)]();return await lockNoti(_0x1d8721(0x1f3),'',0xbb8),_0x3099ab;}catch(_0x580d8b){if(_0x3c84d4===0x1)throw _0x580d8b;}}return![];}export async function dpRefreshToken(){var _0x929462=a0_0x30d2d9;if(!localStorage[_0x929462(0x1c8)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x176007=await fetch(_0x929462(0x1c5),{'method':_0x929462(0x1ed),'headers':{'Content-Type':_0x929462(0x1de)},'body':_0x929462(0x1c9)+localStorage[_0x929462(0x1c8)]('refreshToken')+_0x929462(0x1c1)}),_0x19ddf8=await _0x176007[_0x929462(0x1da)]();if(!_0x19ddf8[_0x929462(0x1c3)])return localStorage[_0x929462(0x1fa)](_0x929462(0x1c6),_0x19ddf8[_0x929462(0x1e6)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x19ddf8['error_description']||_0x929462(0x1fe));}catch(_0x11515f){console['error'](_0x929462(0x1ce),_0x11515f);}return![];}function a0_0x5a72(_0xeac06c,_0x3ec726){var _0x391793=a0_0x3917();return a0_0x5a72=function(_0x5a7227,_0x8fe358){_0x5a7227=_0x5a7227-0x1aa;var _0x2fb43f=_0x391793[_0x5a7227];return _0x2fb43f;},a0_0x5a72(_0xeac06c,_0x3ec726);}export async function dpUploadFile(_0x2c6fae,_0x59f9d3,_0x460c35){var _0x1f67c7=a0_0x30d2d9;const _0x3e0881=localStorage['getItem'](_0x1f67c7(0x1ae));var _0x256511=JSON[_0x1f67c7(0x1ea)]({'autorename':!![],'mode':_0x1f67c7(0x1ff),'mute':!![],'strict_conflict':![],'path':'/'+_0x3e0881+'/'+_0x460c35+'/'+_0x2c6fae}),_0x5695ba=new Blob([_0x59f9d3],{'type':'application/octet-stream'});for(var _0x4695c2=0x0;_0x4695c2<0x2;_0x4695c2++){var _0x12d9d6=await fetch(_0x1f67c7(0x1f1),{'method':_0x1f67c7(0x1ed),'headers':{'Authorization':_0x1f67c7(0x20a)+localStorage[_0x1f67c7(0x1c8)](_0x1f67c7(0x1c6)),'Dropbox-API-Arg':_0x256511,'Content-Type':_0x1f67c7(0x1ee)},'body':_0x5695ba});if(_0x12d9d6[_0x1f67c7(0x205)]!=0xc8){if(_0x12d9d6[_0x1f67c7(0x205)]==0x191){var _0x32beff=await dpRefreshToken();if(!_0x32beff)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x1f67c7(0x1f6)+_0x12d9d6[_0x1f67c7(0x205)];}else{var _0x4c55f8=await _0x12d9d6['json']();return console[_0x1f67c7(0x1c4)](_0x1f67c7(0x1f4),_0x2c6fae),_0x4c55f8;}}return![];}function a0_0x3917(){var _0x31d86c=['5611072KqOtUV','entries','application/x-www-form-urlencoded','&client_id=','classList','Restoring...','exec','&redirect_uri=','href','375HJxaEm','access_token','Authorization\x20Code:','slice','&grant_type=','stringify','addEventListener','5558063ccKQXd','POST','application/octet-stream','9772560ejOKGW','https://api.dropboxapi.com/2/files/create_folder_v2','https://content.dropboxapi.com/2/files/upload','280521NkRhKF','Folder\x20created','Kabu\x20storage\x20↦\x20Cloud\x20◆','state','Upload\x20failed,\x20unknown\x20http\x20status:\x20','folder','parse','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','setItem','screenshot','responseText','remove','Failed\x20to\x20refresh\x20Dropbox\x20token.','overwrite','Unable\x20to\x20refresh\x20token','code','charAt','DOMContentLoaded','onload','status','856628xKzPrM','5378KFcASa','Download\x20failed\x20for\x20','search','Bearer\x20','Do\x20you\x20want\x20to\x20restore\x20','Backing\x20up...','uid','uploadFileInCloud','code=','list','uId','split','replace','setRequestHeader','Restore\x20canceled\x20by\x20user.','Wait\x20a\x20little\x20bit...','save','nwb3dnfh09rhs31','https://content.dropboxapi.com/2/files/download','\x20files\x20in\x20Kabu?','.tag','&client_secret=','knh3uz2mx2hp2eu','confirm','498YIZHJX','Cloud\x20↦\x20Kabu\x20storage\x20◆','toUpperCase','location','=([^&#]*)','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','application/json','error','log','https://api.dropboxapi.com/oauth2/token','accessToken','offline','getItem','refresh_token=','48436AKRsYA','map','alert','Cloud\x20login\x20required!','Error\x20while\x20refreshing\x20token:','6FGGkkS','Do\x20you\x20want\x20to\x20backup\x20','length','https://api.dropboxapi.com/2/files/list_folder','name','/data/','authorization_code','active','No\x20files\x20found\x20to\x20restore.','click','https://api.dropbox.com/oauth2/token','json','&token_access_type='];a0_0x3917=function(){return _0x31d86c;};return a0_0x3917();}export async function dpDownloadFile(_0x426a1e,_0x3c907f){var _0x2dc55d=a0_0x30d2d9;const _0x58ac32=localStorage['getItem'](_0x2dc55d(0x1ae));var _0x27cec3=JSON[_0x2dc55d(0x1ea)]({'path':'/'+_0x58ac32+'/'+_0x3c907f+'/'+_0x426a1e});for(var _0x10ad28=0x0;_0x10ad28<0x2;_0x10ad28++){var _0x174876=await fetch(_0x2dc55d(0x1b6),{'method':'POST','headers':{'Authorization':_0x2dc55d(0x20a)+localStorage['getItem'](_0x2dc55d(0x1c6)),'Dropbox-API-Arg':_0x27cec3}});if(_0x174876[_0x2dc55d(0x205)]!=0xc8){if(_0x174876[_0x2dc55d(0x205)]==0x191){var _0x548688=await dpRefreshToken();if(!_0x548688)throw _0x2dc55d(0x200);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x174876[_0x2dc55d(0x205)];}const _0x23e7db=new File([await _0x174876['blob']()],_0x426a1e);return console['log'](_0x2dc55d(0x1bd),_0x23e7db[_0x2dc55d(0x1d3)]),a0_0x2000ac[_0x2dc55d(0x1ab)](_0x23e7db,()=>{}),_0x23e7db;}return![];}document[a0_0x30d2d9(0x1eb)](a0_0x30d2d9(0x203),function(){var _0x35dca2=a0_0x30d2d9;dropboxRestore[_0x35dca2(0x1eb)](_0x35dca2(0x1d8),async function(){var _0xf316f7=_0x35dca2;await lockNoti(_0xf316f7(0x1b3),'',0x1388);const _0x14e53f=localStorage[_0xf316f7(0x1c8)](_0xf316f7(0x1ae)),_0x3b945d=[_0xf316f7(0x1f5),_0xf316f7(0x1b4),_0xf316f7(0x1fb)];if(!_0x14e53f){window[_0xf316f7(0x1cc)](_0xf316f7(0x1cd));return;}let _0x30fdc5=[];for(const _0x5ac3b9 of _0x3b945d){let _0x535ff7={'path':'/'+_0x14e53f+'/'+_0x5ac3b9};for(let _0x5d111c=0x0;_0x5d111c<0x2;_0x5d111c++){let _0x375103=await fetch(_0xf316f7(0x1d2),{'method':_0xf316f7(0x1ed),'headers':{'Authorization':_0xf316f7(0x20a)+localStorage[_0xf316f7(0x1c8)](_0xf316f7(0x1c6)),'Content-Type':_0xf316f7(0x1c2)},'body':JSON[_0xf316f7(0x1ea)](_0x535ff7)});if(_0x375103[_0xf316f7(0x205)]===0xc8){let _0x48b112=await _0x375103['json'](),_0x287c84=_0x48b112[_0xf316f7(0x1dd)]['filter'](_0x1ebd3c=>_0x1ebd3c[_0xf316f7(0x1b8)]==='file');_0x287c84[_0xf316f7(0x1d1)]>0x0&&_0x30fdc5['push'](..._0x287c84[_0xf316f7(0x1cb)](_0x2b9ef4=>({'name':_0x2b9ef4[_0xf316f7(0x1d3)],'folder':_0x5ac3b9})));break;}else{if(_0x375103[_0xf316f7(0x205)]===0x191){let _0x17590a=await dpRefreshToken();if(!_0x17590a)throw _0xf316f7(0x200);}else{console[_0xf316f7(0x1c3)](_0xf316f7(0x208)+_0x5ac3b9+',\x20status:\x20'+_0x375103['status']);break;}}}}if(_0x30fdc5[_0xf316f7(0x1d1)]>0x0){const _0x5e02aa=_0xf316f7(0x20b)+_0x30fdc5[_0xf316f7(0x1d1)]+'\x20files\x20from\x20Cloud?';if(window[_0xf316f7(0x1bb)](_0x5e02aa))for(const _0x4cc4db of _0x30fdc5){await lockNoti(_0xf316f7(0x1e1),_0x4cc4db[_0xf316f7(0x1d3)],0xbb8),await dpDownloadFile(_0x4cc4db[_0xf316f7(0x1d3)],_0x4cc4db[_0xf316f7(0x1f7)]);}else console[_0xf316f7(0x1c4)]('Restore\x20canceled\x20by\x20user.');}else console[_0xf316f7(0x1c4)](_0xf316f7(0x1d7));}),dropboxBackup[_0x35dca2(0x1eb)]('click',async function(){var _0x509d9e=_0x35dca2;await lockNoti(_0x509d9e(0x1b3),'',0x1388);const _0x29210b=localStorage['getItem'](_0x509d9e(0x1ae));if(_0x29210b===null||_0x29210b==='')window[_0x509d9e(0x1cc)](_0x509d9e(0x1cd));else{const _0x3c5719=['state',_0x509d9e(0x1b4),'screenshot'];for(const _0x590836 of _0x3c5719){await dpCreateFolder(_0x590836);}let _0x47b96b=0x0;for(const _0x1e227e of _0x3c5719){const _0x4cdb02=a0_0x2000ac[_0x509d9e(0x1ad)+(_0x1e227e[_0x509d9e(0x202)](0x0)['toUpperCase']()+_0x1e227e[_0x509d9e(0x1e8)](0x1))]();_0x47b96b+=_0x4cdb02[_0x509d9e(0x1d1)];}if(window['confirm'](_0x509d9e(0x1d0)+_0x47b96b+_0x509d9e(0x1b7)))for(const _0x2c610c of _0x3c5719){const _0x1d4aeb=a0_0x2000ac['list'+(_0x2c610c['charAt'](0x0)[_0x509d9e(0x1be)]()+_0x2c610c[_0x509d9e(0x1e8)](0x1))]();for(const _0x64a148 of _0x1d4aeb){const _0x41d65f=await a0_0x2000ac['downloadFileInCloud'](_0x509d9e(0x1d4)+_0x2c610c+'s/'+_0x64a148);try{await lockNoti(_0x509d9e(0x20c),_0x64a148,0xbb8),await dpUploadFile(_0x64a148,_0x41d65f,_0x2c610c);}catch(_0x1e04ce){console[_0x509d9e(0x1c3)]('Failed\x20to\x20upload\x20file\x20'+_0x64a148+':',_0x1e04ce);}}}else console[_0x509d9e(0x1c4)](_0x509d9e(0x1b2));}}),dropboxCloud['addEventListener'](_0x35dca2(0x1d8),function(){var _0x2d7b98=_0x35dca2;const _0x97c0c0=localStorage[_0x2d7b98(0x1c8)](_0x2d7b98(0x1ae));_0x97c0c0===null||_0x97c0c0===''?authorizeWithDropbox():window[_0x2d7b98(0x1bb)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x2d7b98(0x1fa)](_0x2d7b98(0x1ae),''),dropboxRestore[_0x2d7b98(0x1e0)][_0x2d7b98(0x1fd)](_0x2d7b98(0x1d6)),dropboxBackup['classList']['remove'](_0x2d7b98(0x1d6)),dropboxCloud[_0x2d7b98(0x1e0)]['remove'](_0x2d7b98(0x1d6)));}),handleDropboxCallback();});