var a0_0x2407c6=a0_0x19cf;(function(_0x1fbada,_0x38fb4f){var _0x4c5a24=a0_0x19cf,_0x2c4380=_0x1fbada();while(!![]){try{var _0x56f053=parseInt(_0x4c5a24(0x1c6))/0x1*(parseInt(_0x4c5a24(0x19b))/0x2)+-parseInt(_0x4c5a24(0x1a9))/0x3+parseInt(_0x4c5a24(0x1c1))/0x4+parseInt(_0x4c5a24(0x1c2))/0x5+parseInt(_0x4c5a24(0x178))/0x6+-parseInt(_0x4c5a24(0x18f))/0x7+-parseInt(_0x4c5a24(0x1be))/0x8*(-parseInt(_0x4c5a24(0x198))/0x9);if(_0x56f053===_0x38fb4f)break;else _0x2c4380['push'](_0x2c4380['shift']());}catch(_0x51a749){_0x2c4380['push'](_0x2c4380['shift']());}}}(a0_0x1750,0x677fb));import*as a0_0x1e2cd0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2407c6(0x1c7),clientSecret=a0_0x2407c6(0x1ca);function authorizeWithDropbox(){var _0x359c61=a0_0x2407c6,_0x5a0f47=window['location'][_0x359c61(0x1b9)][_0x359c61(0x19e)]('?')[0x0],_0x511991=_0x359c61(0x1ab),_0x5c7750=_0x359c61(0x1a4),_0x362e0c='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x359c61(0x16f)+_0x511991+_0x359c61(0x19d)+_0x5c7750+_0x359c61(0x188)+encodeURIComponent(_0x5a0f47);window[_0x359c61(0x18e)]['href']=_0x362e0c;}function handleDropboxCallback(){var _0x482b7e=a0_0x2407c6,_0x3a7363=getUrlParameter('code');_0x3a7363?(getAccessToken(_0x3a7363),console[_0x482b7e(0x1ac)](_0x482b7e(0x1bc),_0x3a7363)):console[_0x482b7e(0x1ac)](_0x482b7e(0x17b));}function a0_0x19cf(_0x19651e,_0x2a14ba){var _0x175099=a0_0x1750();return a0_0x19cf=function(_0x19cf76,_0x1d9c44){_0x19cf76=_0x19cf76-0x167;var _0x1f7811=_0x175099[_0x19cf76];return _0x1f7811;},a0_0x19cf(_0x19651e,_0x2a14ba);}function getUrlParameter(_0x37db37){var _0x2746f0=a0_0x2407c6;_0x37db37=_0x37db37[_0x2746f0(0x19f)](/[\[]/,'\x5c[')[_0x2746f0(0x19f)](/[\]]/,'\x5c]');var _0x4ec592=new RegExp('[\x5c?&#]'+_0x37db37+'=([^&#]*)'),_0x2a1d9a=_0x4ec592[_0x2746f0(0x16e)](location[_0x2746f0(0x192)]);return _0x2a1d9a===null?'':decodeURIComponent(_0x2a1d9a[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x6785f9){var _0x5e5fd8=a0_0x2407c6,_0x1fa70e=_0x5e5fd8(0x184),_0x522713=window[_0x5e5fd8(0x18e)]['href'][_0x5e5fd8(0x19e)]('?')[0x0],_0x474ce2=new XMLHttpRequest();_0x474ce2[_0x5e5fd8(0x176)](_0x5e5fd8(0x1a7),_0x5e5fd8(0x1b8)),_0x474ce2[_0x5e5fd8(0x1b0)](_0x5e5fd8(0x1a3),'application/x-www-form-urlencoded'),_0x474ce2[_0x5e5fd8(0x180)]=function(){var _0x49e692=_0x5e5fd8;if(_0x474ce2[_0x49e692(0x1a8)]===0xc8){var _0x3ee421=JSON[_0x49e692(0x190)](_0x474ce2[_0x49e692(0x18a)]),_0xf28e8e=_0x3ee421[_0x49e692(0x1b6)],_0xcc1881=_0x3ee421['refresh_token'],_0x1d9563=_0x3ee421[_0x49e692(0x194)];localStorage[_0x49e692(0x175)]('accessToken',_0xf28e8e),localStorage[_0x49e692(0x175)](_0x49e692(0x17c),_0xcc1881),localStorage[_0x49e692(0x175)](_0x49e692(0x187),_0x1d9563);}else console[_0x49e692(0x1ac)](_0x49e692(0x195));},_0x474ce2[_0x5e5fd8(0x1a1)](_0x5e5fd8(0x189)+_0x6785f9+_0x5e5fd8(0x174)+_0x1fa70e+'&client_id='+clientId+_0x5e5fd8(0x18c)+clientSecret+_0x5e5fd8(0x188)+encodeURIComponent(_0x522713));}export async function dpCreateFolder(_0x25613a){var _0x25ecf3=a0_0x2407c6;const _0x4bc548=localStorage[_0x25ecf3(0x16d)](_0x25ecf3(0x187));let _0x1cb3d9=localStorage[_0x25ecf3(0x16d)](_0x25ecf3(0x1b4));const _0x1a59cf='/'+_0x4bc548+'/'+_0x25613a,_0x55765b=JSON[_0x25ecf3(0x185)]({'path':_0x1a59cf,'autorename':![]});for(let _0x3105f7=0x0;_0x3105f7<0x2;_0x3105f7++){try{const _0x273656=await fetch(_0x25ecf3(0x183),{'method':_0x25ecf3(0x1a7),'headers':{'Authorization':_0x25ecf3(0x1bb)+_0x1cb3d9,'Content-Type':_0x25ecf3(0x19c)},'body':_0x55765b});if(_0x273656['status']===0x191){const _0x337278=await dpRefreshToken();if(!_0x337278)throw new Error('Unable\x20to\x20refresh\x20token');_0x1cb3d9=localStorage[_0x25ecf3(0x16d)]('accessToken');continue;}if(_0x273656[_0x25ecf3(0x1a8)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x25613a};if(!_0x273656['ok'])throw new Error(_0x25ecf3(0x18b)+_0x25613a);const _0x4de0aa=await _0x273656[_0x25ecf3(0x1c8)]();return await lockNoti(_0x25ecf3(0x196),'',0xbb8),_0x4de0aa;}catch(_0x30f096){if(_0x3105f7===0x1)throw _0x30f096;}}return![];}export async function dpRefreshToken(){var _0x68e01=a0_0x2407c6;if(!localStorage[_0x68e01(0x16d)](_0x68e01(0x17c)))throw _0x68e01(0x186);try{const _0x35fcdc=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x68e01(0x1a7),'headers':{'Content-Type':_0x68e01(0x1c9)},'body':_0x68e01(0x1bd)+localStorage['getItem'](_0x68e01(0x17c))+_0x68e01(0x1aa)}),_0x3f1411=await _0x35fcdc[_0x68e01(0x1c8)]();if(!_0x3f1411[_0x68e01(0x1b7)])return localStorage[_0x68e01(0x175)]('accessToken',_0x3f1411['access_token']),await lockNoti(_0x68e01(0x191),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3f1411[_0x68e01(0x182)]||_0x68e01(0x173));}catch(_0x4a88a1){console[_0x68e01(0x1b7)](_0x68e01(0x17d),_0x4a88a1);}return![];}export async function dpUploadFile(_0x57ad4d,_0x40dd3b,_0x44e51a){var _0x16f828=a0_0x2407c6;const _0x2a5ee8=localStorage[_0x16f828(0x16d)](_0x16f828(0x187));var _0x4ee396=JSON[_0x16f828(0x185)]({'autorename':!![],'mode':_0x16f828(0x1c5),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a5ee8+'/'+_0x44e51a+'/'+_0x57ad4d}),_0x4b10c6=new Blob([_0x40dd3b],{'type':_0x16f828(0x199)});for(var _0x546b9a=0x0;_0x546b9a<0x2;_0x546b9a++){var _0x285e8b=await fetch(_0x16f828(0x1b2),{'method':_0x16f828(0x1a7),'headers':{'Authorization':_0x16f828(0x1bb)+localStorage[_0x16f828(0x16d)](_0x16f828(0x1b4)),'Dropbox-API-Arg':_0x4ee396,'Content-Type':_0x16f828(0x199)},'body':_0x4b10c6});if(_0x285e8b['status']!=0xc8){if(_0x285e8b['status']==0x191){var _0x559f3b=await dpRefreshToken();if(!_0x559f3b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x16f828(0x17a)+_0x285e8b[_0x16f828(0x1a8)];}else{var _0x4f8d31=await _0x285e8b[_0x16f828(0x1c8)]();return console[_0x16f828(0x1ac)](_0x16f828(0x1c0),_0x57ad4d),_0x4f8d31;}}return![];}export async function dpDownloadFile(_0x4d998e,_0x19ecb4){var _0x3ad33e=a0_0x2407c6;const _0x39f160=localStorage[_0x3ad33e(0x16d)](_0x3ad33e(0x187));var _0x2252f6=JSON[_0x3ad33e(0x185)]({'path':'/'+_0x39f160+'/'+_0x19ecb4+'/'+_0x4d998e});for(var _0x1d3c26=0x0;_0x1d3c26<0x2;_0x1d3c26++){var _0x375d1f=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x3ad33e(0x1a7),'headers':{'Authorization':_0x3ad33e(0x1bb)+localStorage[_0x3ad33e(0x16d)](_0x3ad33e(0x1b4)),'Dropbox-API-Arg':_0x2252f6}});if(_0x375d1f['status']!=0xc8){if(_0x375d1f[_0x3ad33e(0x1a8)]==0x191){var _0x4fedd1=await dpRefreshToken();if(!_0x4fedd1)throw _0x3ad33e(0x1b3);continue;}else throw _0x3ad33e(0x1ad)+_0x375d1f[_0x3ad33e(0x1a8)];}const _0x5be093=new File([await _0x375d1f[_0x3ad33e(0x18d)]()],_0x4d998e);return console[_0x3ad33e(0x1ac)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x5be093[_0x3ad33e(0x1a5)]),a0_0x1e2cd0[_0x3ad33e(0x1c3)](_0x5be093,()=>{}),_0x5be093;}return![];}function a0_0x1750(){var _0x53918b=['overwrite','3NcDooj','knh3uz2mx2hp2eu','json','application/x-www-form-urlencoded','nwb3dnfh09rhs31','entries','push','file','No\x20files\x20found\x20to\x20restore.','Download\x20failed\x20for\x20','\x20files\x20in\x20Kabu?','getItem','exec','&response_type=','Wait\x20a\x20little\x20bit...','.tag','folder','Failed\x20to\x20refresh\x20Dropbox\x20token.','&grant_type=','setItem','open','screenshot','4416294kAvZaj','Restore\x20canceled\x20by\x20user.','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Do\x20not\x20receive\x20authorization','refreshToken','Error\x20while\x20refreshing\x20token:','length','state','onload','Do\x20you\x20want\x20to\x20logout?','error_description','https://api.dropboxapi.com/2/files/create_folder_v2','authorization_code','stringify','No\x20refresh\x20token','uId','&redirect_uri=','code=','responseText','Error\x20creating\x20folder\x20','&client_secret=','blob','location','3812067QoJfiR','parse','Refreshing\x20token...','search','remove','uid','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Folder\x20created','Backing\x20up...','5841nTmqKC','application/octet-stream','alert','26196GIFokx','application/json','&token_access_type=','split','replace','click','send','Restoring...','Content-Type','offline','name','confirm','POST','status','2004804KkPhNx','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','code','log','Download\x20failed,\x20unknown\x20http\x20status:','active','filter','setRequestHeader','classList','https://content.dropboxapi.com/2/files/upload','Unable\x20to\x20refresh\x20token','accessToken','Cloud\x20login\x20required!','access_token','error','https://api.dropbox.com/oauth2/token','href','addEventListener','Bearer\x20','Authorization\x20Code:','refresh_token=','2344WwmlNV','listFiles','Kabu\x20storage\x20↦\x20Cloud\x20◆','714204MjdKfN','2463645ObfRPr','uploadFileInCloud','save'];a0_0x1750=function(){return _0x53918b;};return a0_0x1750();}document[a0_0x2407c6(0x1ba)]('DOMContentLoaded',function(){var _0x9decc4=a0_0x2407c6;dropboxRestore[_0x9decc4(0x1ba)]('click',async function(){var _0x84c1cc=_0x9decc4;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x5a8458=localStorage[_0x84c1cc(0x16d)](_0x84c1cc(0x187)),_0x3a907e=['state','save',_0x84c1cc(0x177)];if(!_0x5a8458){window[_0x84c1cc(0x19a)](_0x84c1cc(0x1b5));return;}let _0x53a4ac=[];for(const _0x1e8338 of _0x3a907e){let _0x104321={'path':'/'+_0x5a8458+'/'+_0x1e8338};for(let _0x207022=0x0;_0x207022<0x2;_0x207022++){let _0x598214=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x84c1cc(0x1b4)),'Content-Type':_0x84c1cc(0x19c)},'body':JSON[_0x84c1cc(0x185)](_0x104321)});if(_0x598214[_0x84c1cc(0x1a8)]===0xc8){let _0x2aecf7=await _0x598214[_0x84c1cc(0x1c8)](),_0x25bcb5=_0x2aecf7[_0x84c1cc(0x167)][_0x84c1cc(0x1af)](_0x410d4b=>_0x410d4b[_0x84c1cc(0x171)]===_0x84c1cc(0x169));_0x25bcb5[_0x84c1cc(0x17e)]>0x0&&_0x53a4ac[_0x84c1cc(0x168)](..._0x25bcb5['map'](_0x38bc68=>({'name':_0x38bc68[_0x84c1cc(0x1a5)],'folder':_0x1e8338})));break;}else{if(_0x598214[_0x84c1cc(0x1a8)]===0x191){let _0x3f8a71=await dpRefreshToken();if(!_0x3f8a71)throw _0x84c1cc(0x1b3);}else{console[_0x84c1cc(0x1b7)](_0x84c1cc(0x16b)+_0x1e8338+',\x20status:\x20'+_0x598214[_0x84c1cc(0x1a8)]);break;}}}}if(_0x53a4ac[_0x84c1cc(0x17e)]>0x0){const _0x19398f='Do\x20you\x20want\x20to\x20restore\x20'+_0x53a4ac[_0x84c1cc(0x17e)]+'\x20files\x20from\x20Cloud?';if(window[_0x84c1cc(0x1a6)](_0x19398f))for(const _0xedf37a of _0x53a4ac){await lockNoti(_0x84c1cc(0x1a2),_0xedf37a['name'],0xbb8),await dpDownloadFile(_0xedf37a[_0x84c1cc(0x1a5)],_0xedf37a[_0x84c1cc(0x172)]);}else console[_0x84c1cc(0x1ac)](_0x84c1cc(0x179));}else console[_0x84c1cc(0x1ac)](_0x84c1cc(0x16a));}),dropboxBackup[_0x9decc4(0x1ba)]('click',async function(){var _0x35888f=_0x9decc4;await lockNoti(_0x35888f(0x170),'',0x1388);const _0x5a2224=localStorage['getItem'](_0x35888f(0x187));if(_0x5a2224===null||_0x5a2224==='')window[_0x35888f(0x19a)](_0x35888f(0x1b5));else{const _0x40af17=[_0x35888f(0x17f),_0x35888f(0x1c4),_0x35888f(0x177)];for(const _0x409d4a of _0x40af17){await dpCreateFolder(_0x409d4a);}let _0x2042ab=0x0;for(const _0x5b5538 of _0x40af17){const _0xd1d47f=a0_0x1e2cd0[_0x35888f(0x1bf)](_0x5b5538+'s');_0x2042ab+=_0xd1d47f[_0x35888f(0x17e)];}if(window[_0x35888f(0x1a6)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x2042ab+_0x35888f(0x16c)))for(const _0x5cb596 of _0x40af17){const _0x40c227=a0_0x1e2cd0['listFiles'](_0x5cb596+'s');for(const _0x1eec4f of _0x40c227){const _0x5a4dc0=await a0_0x1e2cd0['downloadFileInCloud']('/data/'+_0x5cb596+'s/'+_0x1eec4f);try{await lockNoti(_0x35888f(0x197),_0x1eec4f,0xbb8),await dpUploadFile(_0x1eec4f,_0x5a4dc0,_0x5cb596);}catch(_0x4b6fe2){console[_0x35888f(0x1b7)]('Failed\x20to\x20upload\x20file\x20'+_0x1eec4f+':',_0x4b6fe2);}}}else console[_0x35888f(0x1ac)](_0x35888f(0x179));}}),dropboxCloud['addEventListener'](_0x9decc4(0x1a0),function(){var _0x4931aa=_0x9decc4;const _0x5b1d79=localStorage[_0x4931aa(0x16d)](_0x4931aa(0x187));_0x5b1d79===null||_0x5b1d79===''?authorizeWithDropbox():window[_0x4931aa(0x1a6)](_0x4931aa(0x181))&&(localStorage['setItem'](_0x4931aa(0x187),''),dropboxRestore[_0x4931aa(0x1b1)]['remove']('active'),dropboxBackup['classList'][_0x4931aa(0x193)]('active'),dropboxCloud[_0x4931aa(0x1b1)][_0x4931aa(0x193)](_0x4931aa(0x1ae)));}),handleDropboxCallback();});