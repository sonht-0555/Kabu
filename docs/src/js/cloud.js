var a0_0x5d6c26=a0_0x1e41;(function(_0x179d1a,_0x54c70c){var _0x101779=a0_0x1e41,_0x3299a9=_0x179d1a();while(!![]){try{var _0x974f42=parseInt(_0x101779(0x123))/0x1*(-parseInt(_0x101779(0x124))/0x2)+-parseInt(_0x101779(0x161))/0x3+parseInt(_0x101779(0x117))/0x4+-parseInt(_0x101779(0x168))/0x5*(-parseInt(_0x101779(0x153))/0x6)+-parseInt(_0x101779(0x12b))/0x7*(-parseInt(_0x101779(0x132))/0x8)+parseInt(_0x101779(0x114))/0x9+parseInt(_0x101779(0x171))/0xa*(-parseInt(_0x101779(0x16c))/0xb);if(_0x974f42===_0x54c70c)break;else _0x3299a9['push'](_0x3299a9['shift']());}catch(_0x5eee79){_0x3299a9['push'](_0x3299a9['shift']());}}}(a0_0x34e3,0x71e2b));function a0_0x1e41(_0x24cc83,_0x3e564f){var _0x34e327=a0_0x34e3();return a0_0x1e41=function(_0x1e4196,_0xd8c19d){_0x1e4196=_0x1e4196-0x113;var _0x49fbcc=_0x34e327[_0x1e4196];return _0x49fbcc;},a0_0x1e41(_0x24cc83,_0x3e564f);}function a0_0x34e3(){var _0x1d6ee4=['json','uId','length','Cloud\x20login\x20required!','Restore\x20canceled\x20by\x20user.','POST','accessToken','850182EWerNk','Wait\x20a\x20little\x20bit...','/data/','refreshToken','authorization_code','&client_id=','&token_access_type=','&response_type=','nwb3dnfh09rhs31','knh3uz2mx2hp2eu','\x20files\x20in\x20Kabu?','https://www.dropbox.com/oauth2/authorize?client_id=','Download\x20failed,\x20unknown\x20http\x20status:','Content-Type','457665dYtkcg','https://api.dropboxapi.com/2/files/create_folder_v2','Failed\x20to\x20refresh\x20Dropbox\x20token.','state','DOMContentLoaded','click','classList','25gnknQb','Download\x20failed\x20for\x20','Do\x20you\x20want\x20to\x20logout?','downloadFileInCloud','934637FjjVzD','offline','active','alert','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','110kBePqr','Folder\x20created','refresh_token=','No\x20refresh\x20token','send','setItem','Bearer\x20','slice','Error\x20while\x20refreshing\x20token:','search','name','save','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','code=','\x20files\x20from\x20Cloud?','parse','refresh_token','overwrite','4046472XmpTkn','list','application/x-www-form-urlencoded','2853448SDJFyk','uploadFileInCloud','stringify','Upload\x20failed,\x20unknown\x20http\x20status:\x20','error','file','application/octet-stream','push','replace','exec','href','.tag','427vrPpSl','2074hDDmgA','error_description','status','responseText','log','Folder\x20already\x20exists','https://content.dropboxapi.com/2/files/upload','1043RhhHrN','code','blob','remove','access_token','setRequestHeader','&client_secret=','6712QISQlV','folder','Authorization\x20Code:','Cloud\x20↦\x20Kabu\x20storage\x20◆','split','&redirect_uri=','Do\x20you\x20want\x20to\x20backup\x20','FSSync','https://api.dropboxapi.com/2/files/list_folder','No\x20files\x20found\x20to\x20restore.','filter','Unable\x20to\x20refresh\x20token','toUpperCase','Refreshing\x20token...','uid','charAt','getItem','open','map','Restoring...',',\x20status:\x20','location','application/json','confirm','Error\x20creating\x20folder\x20','screenshot'];a0_0x34e3=function(){return _0x1d6ee4;};return a0_0x34e3();}import*as a0_0xc91c7a from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5d6c26(0x15c),clientSecret=a0_0x5d6c26(0x15b);function authorizeWithDropbox(){var _0x1e95c1=a0_0x5d6c26,_0x419ae0=window[_0x1e95c1(0x147)][_0x1e95c1(0x121)][_0x1e95c1(0x136)]('?')[0x0],_0x3a5572=_0x1e95c1(0x12c),_0x3d9a92=_0x1e95c1(0x16d),_0x386d5d=_0x1e95c1(0x15e)+clientId+_0x1e95c1(0x15a)+_0x3a5572+_0x1e95c1(0x159)+_0x3d9a92+'&redirect_uri='+encodeURIComponent(_0x419ae0);window[_0x1e95c1(0x147)][_0x1e95c1(0x121)]=_0x386d5d;}function handleDropboxCallback(){var _0xae9629=a0_0x5d6c26,_0x4203ea=getUrlParameter(_0xae9629(0x12c));_0x4203ea?(getAccessToken(_0x4203ea),console['log'](_0xae9629(0x134),_0x4203ea)):console[_0xae9629(0x128)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0xa564e3){var _0x3f4896=a0_0x5d6c26;_0xa564e3=_0xa564e3[_0x3f4896(0x11f)](/[\[]/,'\x5c[')[_0x3f4896(0x11f)](/[\]]/,'\x5c]');var _0x20c7c6=new RegExp('[\x5c?&#]'+_0xa564e3+'=([^&#]*)'),_0x3fff3b=_0x20c7c6[_0x3f4896(0x120)](location[_0x3f4896(0x17a)]);return _0x3fff3b===null?'':decodeURIComponent(_0x3fff3b[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x1ace19){var _0x389bc2=a0_0x5d6c26,_0x467878=_0x389bc2(0x157),_0x4b1e46=window[_0x389bc2(0x147)][_0x389bc2(0x121)][_0x389bc2(0x136)]('?')[0x0],_0x1f657d=new XMLHttpRequest();_0x1f657d[_0x389bc2(0x143)]('POST','https://api.dropbox.com/oauth2/token'),_0x1f657d[_0x389bc2(0x130)](_0x389bc2(0x160),_0x389bc2(0x116)),_0x1f657d['onload']=function(){var _0x5c3f61=_0x389bc2;if(_0x1f657d[_0x5c3f61(0x126)]===0xc8){var _0x37ddf6=JSON[_0x5c3f61(0x180)](_0x1f657d[_0x5c3f61(0x127)]),_0x32993b=_0x37ddf6['access_token'],_0x2ccc9d=_0x37ddf6[_0x5c3f61(0x181)],_0x206c3c=_0x37ddf6[_0x5c3f61(0x140)];localStorage[_0x5c3f61(0x176)]('accessToken',_0x32993b),localStorage[_0x5c3f61(0x176)](_0x5c3f61(0x156),_0x2ccc9d),localStorage[_0x5c3f61(0x176)](_0x5c3f61(0x14d),_0x206c3c);}else console[_0x5c3f61(0x128)](_0x5c3f61(0x170));},_0x1f657d[_0x389bc2(0x175)](_0x389bc2(0x17e)+_0x1ace19+'&grant_type='+_0x467878+_0x389bc2(0x158)+clientId+_0x389bc2(0x131)+clientSecret+_0x389bc2(0x137)+encodeURIComponent(_0x4b1e46));}export async function dpCreateFolder(_0x52aeb1){var _0x5d043e=a0_0x5d6c26;const _0x2a80fd=localStorage[_0x5d043e(0x142)]('uId');let _0x2c91ea=localStorage[_0x5d043e(0x142)](_0x5d043e(0x152));const _0x5062cf='/'+_0x2a80fd+'/'+_0x52aeb1,_0x32bac9=JSON['stringify']({'path':_0x5062cf,'autorename':![]});for(let _0x21129b=0x0;_0x21129b<0x2;_0x21129b++){try{const _0x3d2603=await fetch(_0x5d043e(0x162),{'method':_0x5d043e(0x151),'headers':{'Authorization':'Bearer\x20'+_0x2c91ea,'Content-Type':_0x5d043e(0x148)},'body':_0x32bac9});if(_0x3d2603[_0x5d043e(0x126)]===0x191){const _0x3c5e16=await dpRefreshToken();if(!_0x3c5e16)throw new Error(_0x5d043e(0x13d));_0x2c91ea=localStorage[_0x5d043e(0x142)]('accessToken');continue;}if(_0x3d2603[_0x5d043e(0x126)]===0x199)return{'message':_0x5d043e(0x129),'path':_0x52aeb1};if(!_0x3d2603['ok'])throw new Error(_0x5d043e(0x14a)+_0x52aeb1);const _0x1ba5de=await _0x3d2603['json']();return await lockNoti(_0x5d043e(0x172),'',0xbb8),_0x1ba5de;}catch(_0x98f61a){if(_0x21129b===0x1)throw _0x98f61a;}}return![];}export async function dpRefreshToken(){var _0x314476=a0_0x5d6c26;if(!localStorage[_0x314476(0x142)](_0x314476(0x156)))throw _0x314476(0x174);try{const _0x37640f=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x314476(0x151),'headers':{'Content-Type':_0x314476(0x116)},'body':_0x314476(0x173)+localStorage[_0x314476(0x142)](_0x314476(0x156))+_0x314476(0x17d)}),_0x300ff3=await _0x37640f[_0x314476(0x14c)]();if(!_0x300ff3[_0x314476(0x11b)])return localStorage[_0x314476(0x176)](_0x314476(0x152),_0x300ff3[_0x314476(0x12f)]),await lockNoti(_0x314476(0x13f),'',0xbb8),await delay(0x3e8),!![];else alert(_0x300ff3[_0x314476(0x125)]||_0x314476(0x163));}catch(_0x524608){console['error'](_0x314476(0x179),_0x524608);}return![];}export async function dpUploadFile(_0x1f3a58,_0x2d70da,_0xd68c5c){var _0x18a428=a0_0x5d6c26;const _0x594da1=localStorage[_0x18a428(0x142)](_0x18a428(0x14d));var _0x26ef0f=JSON[_0x18a428(0x119)]({'autorename':!![],'mode':_0x18a428(0x113),'mute':!![],'strict_conflict':![],'path':'/'+_0x594da1+'/'+_0xd68c5c+'/'+_0x1f3a58}),_0x322ac6=new Blob([_0x2d70da],{'type':_0x18a428(0x11d)});for(var _0x4a9865=0x0;_0x4a9865<0x2;_0x4a9865++){var _0x33a474=await fetch(_0x18a428(0x12a),{'method':'POST','headers':{'Authorization':_0x18a428(0x177)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x26ef0f,'Content-Type':_0x18a428(0x11d)},'body':_0x322ac6});if(_0x33a474[_0x18a428(0x126)]!=0xc8){if(_0x33a474[_0x18a428(0x126)]==0x191){var _0x485363=await dpRefreshToken();if(!_0x485363)throw _0x18a428(0x13d);continue;}else throw _0x18a428(0x11a)+_0x33a474[_0x18a428(0x126)];}else{var _0x43d490=await _0x33a474[_0x18a428(0x14c)]();return console[_0x18a428(0x128)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x1f3a58),_0x43d490;}}return![];}export async function dpDownloadFile(_0x52893a,_0x454918){var _0x20fa9c=a0_0x5d6c26;const _0x29c270=localStorage[_0x20fa9c(0x142)](_0x20fa9c(0x14d));var _0x37529a=JSON['stringify']({'path':'/'+_0x29c270+'/'+_0x454918+'/'+_0x52893a});for(var _0x4935c1=0x0;_0x4935c1<0x2;_0x4935c1++){var _0x3e3e9f=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x20fa9c(0x151),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x20fa9c(0x152)),'Dropbox-API-Arg':_0x37529a}});if(_0x3e3e9f[_0x20fa9c(0x126)]!=0xc8){if(_0x3e3e9f[_0x20fa9c(0x126)]==0x191){var _0x55a87f=await dpRefreshToken();if(!_0x55a87f)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x20fa9c(0x15f)+_0x3e3e9f[_0x20fa9c(0x126)];}const _0x19bab4=new File([await _0x3e3e9f[_0x20fa9c(0x12d)]()],_0x52893a);return console[_0x20fa9c(0x128)](_0x20fa9c(0x135),_0x19bab4[_0x20fa9c(0x17b)]),a0_0xc91c7a[_0x20fa9c(0x118)](_0x19bab4,()=>{var _0x520cf6=_0x20fa9c;localStorageFile(),Module[_0x520cf6(0x139)]();}),_0x19bab4;}return![];}document['addEventListener'](a0_0x5d6c26(0x165),function(){var _0x2b1d61=a0_0x5d6c26;dropboxRestore['addEventListener'](_0x2b1d61(0x166),async function(){var _0x545f79=_0x2b1d61;await lockNoti(_0x545f79(0x154),'',0x1388);const _0x227e79=localStorage[_0x545f79(0x142)](_0x545f79(0x14d)),_0x5d7f29=['state',_0x545f79(0x17c),_0x545f79(0x14b)];if(!_0x227e79){window['alert'](_0x545f79(0x14f));return;}let _0x3f169d=[];for(const _0x1703ec of _0x5d7f29){let _0x3ada56={'path':'/'+_0x227e79+'/'+_0x1703ec};for(let _0x1f878d=0x0;_0x1f878d<0x2;_0x1f878d++){let _0x54425e=await fetch(_0x545f79(0x13a),{'method':'POST','headers':{'Authorization':_0x545f79(0x177)+localStorage[_0x545f79(0x142)](_0x545f79(0x152)),'Content-Type':_0x545f79(0x148)},'body':JSON[_0x545f79(0x119)](_0x3ada56)});if(_0x54425e[_0x545f79(0x126)]===0xc8){let _0x53ef9d=await _0x54425e[_0x545f79(0x14c)](),_0x37ebca=_0x53ef9d['entries'][_0x545f79(0x13c)](_0x52c1d9=>_0x52c1d9[_0x545f79(0x122)]===_0x545f79(0x11c));_0x37ebca[_0x545f79(0x14e)]>0x0&&_0x3f169d[_0x545f79(0x11e)](..._0x37ebca[_0x545f79(0x144)](_0x214155=>({'name':_0x214155[_0x545f79(0x17b)],'folder':_0x1703ec})));break;}else{if(_0x54425e['status']===0x191){let _0x34de85=await dpRefreshToken();if(!_0x34de85)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x545f79(0x11b)](_0x545f79(0x169)+_0x1703ec+_0x545f79(0x146)+_0x54425e['status']);break;}}}}if(_0x3f169d[_0x545f79(0x14e)]>0x0){const _0x38ef40='Do\x20you\x20want\x20to\x20restore\x20'+_0x3f169d[_0x545f79(0x14e)]+_0x545f79(0x17f);if(window[_0x545f79(0x149)](_0x38ef40))for(const _0x5ec1ca of _0x3f169d){await lockNoti(_0x545f79(0x145),_0x5ec1ca['name'],0xbb8),await dpDownloadFile(_0x5ec1ca[_0x545f79(0x17b)],_0x5ec1ca[_0x545f79(0x133)]);}else console['log'](_0x545f79(0x150));}else console['log'](_0x545f79(0x13b));}),dropboxBackup['addEventListener'](_0x2b1d61(0x166),async function(){var _0x46ceea=_0x2b1d61;await lockNoti(_0x46ceea(0x154),'',0x1388);const _0x480f04=localStorage[_0x46ceea(0x142)](_0x46ceea(0x14d));if(_0x480f04===null||_0x480f04==='')window[_0x46ceea(0x16f)](_0x46ceea(0x14f));else{const _0x25e895=[_0x46ceea(0x164),'save',_0x46ceea(0x14b)];for(const _0x5b1eb9 of _0x25e895){await dpCreateFolder(_0x5b1eb9);}let _0x4cc406=0x0;for(const _0x42451a of _0x25e895){const _0x4bba3d=a0_0xc91c7a[_0x46ceea(0x115)+(_0x42451a['charAt'](0x0)[_0x46ceea(0x13e)]()+_0x42451a[_0x46ceea(0x178)](0x1))]();_0x4cc406+=_0x4bba3d[_0x46ceea(0x14e)];}if(window['confirm'](_0x46ceea(0x138)+_0x4cc406+_0x46ceea(0x15d)))for(const _0x1d785e of _0x25e895){const _0x31f7cb=a0_0xc91c7a[_0x46ceea(0x115)+(_0x1d785e[_0x46ceea(0x141)](0x0)[_0x46ceea(0x13e)]()+_0x1d785e[_0x46ceea(0x178)](0x1))]();for(const _0x4d15f0 of _0x31f7cb){const _0x3f0cb1=await a0_0xc91c7a[_0x46ceea(0x16b)](_0x46ceea(0x155)+_0x1d785e+'s/'+_0x4d15f0);try{await lockNoti('Backing\x20up...',_0x4d15f0,0xbb8),await dpUploadFile(_0x4d15f0,_0x3f0cb1,_0x1d785e);}catch(_0x1b5452){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x4d15f0+':',_0x1b5452);}}}else console['log'](_0x46ceea(0x150));}}),dropboxCloud['addEventListener'](_0x2b1d61(0x166),function(){var _0x21a645=_0x2b1d61;const _0x410792=localStorage[_0x21a645(0x142)](_0x21a645(0x14d));_0x410792===null||_0x410792===''?authorizeWithDropbox():window['confirm'](_0x21a645(0x16a))&&(localStorage[_0x21a645(0x176)]('uId',''),dropboxRestore[_0x21a645(0x167)][_0x21a645(0x12e)](_0x21a645(0x16e)),dropboxBackup[_0x21a645(0x167)]['remove']('active'),dropboxCloud['classList'][_0x21a645(0x12e)](_0x21a645(0x16e)));}),handleDropboxCallback();});