var a0_0x74e20e=a0_0xb09a;(function(_0x48ff75,_0x349516){var _0x59edcd=a0_0xb09a,_0x1048b1=_0x48ff75();while(!![]){try{var _0x90b661=-parseInt(_0x59edcd(0x1cc))/0x1+-parseInt(_0x59edcd(0x1fc))/0x2*(parseInt(_0x59edcd(0x1ef))/0x3)+parseInt(_0x59edcd(0x1c8))/0x4*(-parseInt(_0x59edcd(0x1ec))/0x5)+-parseInt(_0x59edcd(0x1cb))/0x6+-parseInt(_0x59edcd(0x1ee))/0x7*(parseInt(_0x59edcd(0x1de))/0x8)+-parseInt(_0x59edcd(0x1fd))/0x9*(parseInt(_0x59edcd(0x1fe))/0xa)+parseInt(_0x59edcd(0x1dd))/0xb;if(_0x90b661===_0x349516)break;else _0x1048b1['push'](_0x1048b1['shift']());}catch(_0x426d85){_0x1048b1['push'](_0x1048b1['shift']());}}}(a0_0xc7ae,0x9ff0f));function a0_0xc7ae(){var _0x5714bb=['status','POST','Content-Type','active','Download\x20failed\x20for\x20','&client_id=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','https://content.dropboxapi.com/2/files/upload','search','https://api.dropboxapi.com/2/files/list_folder','https://content.dropboxapi.com/2/files/download','overwrite','38048450YxqYgJ','8mdAiIm','[\x5c?&#]','Restoring...','addEventListener','nwb3dnfh09rhs31','map','Do\x20you\x20want\x20to\x20logout?','Failed\x20to\x20upload\x20file\x20','uploadFileInCloud','classList','refresh_token=','send','Authorization\x20Code:','refreshToken','1410trxUKR','offline','2945138gQpOQn','63tQPDrg','state','No\x20files\x20found\x20to\x20restore.','getItem','refresh_token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','length','uId','save','alert','code=','Download\x20failed,\x20unknown\x20http\x20status:','https://www.dropbox.com/oauth2/authorize?client_id=','99530qmTWHP','117dMiPRN','24890vBSlIz','folder','filter','location','entries','access_token','name','=([^&#]*)','open','Folder\x20created','application/json','/data/','downloadFileInCloud','log','application/octet-stream','confirm','Restore\x20canceled\x20by\x20user.','&grant_type=','uid','error_description','screenshot','Folder\x20already\x20exists','error','authorization_code','https://api.dropboxapi.com/oauth2/token','click','&token_access_type=','json','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20restore\x20','accessToken','onload','split','listFiles','code','&response_type=','&redirect_uri=','setItem','Bearer\x20','stringify','replace','\x20files\x20in\x20Kabu?','3728qgzsrL','knh3uz2mx2hp2eu','No\x20refresh\x20token','4278066gpCLJp','329840vpzZHE','Cloud\x20login\x20required!','href','Unable\x20to\x20refresh\x20token','Wait\x20a\x20little\x20bit...'];a0_0xc7ae=function(){return _0x5714bb;};return a0_0xc7ae();}import*as a0_0x50e221 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x74e20e(0x1c9),clientSecret=a0_0x74e20e(0x1e2);function authorizeWithDropbox(){var _0x3efd98=a0_0x74e20e,_0xda384e=window[_0x3efd98(0x201)][_0x3efd98(0x1ce)][_0x3efd98(0x21e)]('?')[0x0],_0x5a5540=_0x3efd98(0x1c0),_0x47aaff=_0x3efd98(0x1ed),_0x21ad86=_0x3efd98(0x1fb)+clientId+_0x3efd98(0x1c1)+_0x5a5540+_0x3efd98(0x218)+_0x47aaff+_0x3efd98(0x1c2)+encodeURIComponent(_0xda384e);window['location'][_0x3efd98(0x1ce)]=_0x21ad86;}function handleDropboxCallback(){var _0x53e4ff=a0_0x74e20e,_0x57e546=getUrlParameter(_0x53e4ff(0x1c0));_0x57e546?(getAccessToken(_0x57e546),console[_0x53e4ff(0x20b)](_0x53e4ff(0x1ea),_0x57e546)):console['log']('Do\x20not\x20receive\x20authorization');}function a0_0xb09a(_0x414894,_0x2a431a){var _0xc7ae19=a0_0xc7ae();return a0_0xb09a=function(_0xb09a1e,_0xf4b394){_0xb09a1e=_0xb09a1e-0x1c0;var _0xcaf78c=_0xc7ae19[_0xb09a1e];return _0xcaf78c;},a0_0xb09a(_0x414894,_0x2a431a);}function getUrlParameter(_0x6eebae){var _0x256cc2=a0_0x74e20e;_0x6eebae=_0x6eebae[_0x256cc2(0x1c6)](/[\[]/,'\x5c[')[_0x256cc2(0x1c6)](/[\]]/,'\x5c]');var _0xc6b37b=new RegExp(_0x256cc2(0x1df)+_0x6eebae+_0x256cc2(0x205)),_0x4c7edb=_0xc6b37b['exec'](location[_0x256cc2(0x1d9)]);return _0x4c7edb===null?'':decodeURIComponent(_0x4c7edb[0x1][_0x256cc2(0x1c6)](/\+/g,'\x20'));}function getAccessToken(_0x547633){var _0x305a6f=a0_0x74e20e,_0xcf08cb=_0x305a6f(0x215),_0x3b8a7e=window[_0x305a6f(0x201)][_0x305a6f(0x1ce)]['split']('?')[0x0],_0x3938f1=new XMLHttpRequest();_0x3938f1[_0x305a6f(0x206)](_0x305a6f(0x1d2),'https://api.dropbox.com/oauth2/token'),_0x3938f1['setRequestHeader'](_0x305a6f(0x1d3),_0x305a6f(0x21a)),_0x3938f1[_0x305a6f(0x21d)]=function(){var _0x1f5674=_0x305a6f;if(_0x3938f1[_0x1f5674(0x1d1)]===0xc8){var _0x2f7eeb=JSON['parse'](_0x3938f1['responseText']),_0x23c8b8=_0x2f7eeb[_0x1f5674(0x203)],_0x1fab63=_0x2f7eeb[_0x1f5674(0x1f3)],_0x57b1e0=_0x2f7eeb[_0x1f5674(0x210)];localStorage[_0x1f5674(0x1c3)](_0x1f5674(0x21c),_0x23c8b8),localStorage[_0x1f5674(0x1c3)](_0x1f5674(0x1eb),_0x1fab63),localStorage['setItem'](_0x1f5674(0x1f6),_0x57b1e0);}else console[_0x1f5674(0x20b)](_0x1f5674(0x1f4));},_0x3938f1[_0x305a6f(0x1e9)](_0x305a6f(0x1f9)+_0x547633+_0x305a6f(0x20f)+_0xcf08cb+_0x305a6f(0x1d6)+clientId+'&client_secret='+clientSecret+_0x305a6f(0x1c2)+encodeURIComponent(_0x3b8a7e));}export async function dpCreateFolder(_0x4ae42f){var _0x2ef0e5=a0_0x74e20e;const _0x457106=localStorage[_0x2ef0e5(0x1f2)](_0x2ef0e5(0x1f6));let _0x21818a=localStorage[_0x2ef0e5(0x1f2)](_0x2ef0e5(0x21c));const _0x75a68e='/'+_0x457106+'/'+_0x4ae42f,_0x4ef526=JSON[_0x2ef0e5(0x1c5)]({'path':_0x75a68e,'autorename':![]});for(let _0x405643=0x0;_0x405643<0x2;_0x405643++){try{const _0x205e5a=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x2ef0e5(0x1c4)+_0x21818a,'Content-Type':_0x2ef0e5(0x208)},'body':_0x4ef526});if(_0x205e5a[_0x2ef0e5(0x1d1)]===0x191){const _0x8a8c33=await dpRefreshToken();if(!_0x8a8c33)throw new Error(_0x2ef0e5(0x1cf));_0x21818a=localStorage[_0x2ef0e5(0x1f2)](_0x2ef0e5(0x21c));continue;}if(_0x205e5a[_0x2ef0e5(0x1d1)]===0x199)return{'message':_0x2ef0e5(0x213),'path':_0x4ae42f};if(!_0x205e5a['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x4ae42f);const _0x3d8212=await _0x205e5a['json']();return await lockNoti(_0x2ef0e5(0x207),'',0xbb8),_0x3d8212;}catch(_0x50f4ba){if(_0x405643===0x1)throw _0x50f4ba;}}return![];}export async function dpRefreshToken(){var _0x1e235e=a0_0x74e20e;if(!localStorage['getItem'](_0x1e235e(0x1eb)))throw _0x1e235e(0x1ca);try{const _0x2aafbb=await fetch(_0x1e235e(0x216),{'method':_0x1e235e(0x1d2),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x1e235e(0x1e8)+localStorage[_0x1e235e(0x1f2)](_0x1e235e(0x1eb))+_0x1e235e(0x1d7)}),_0x4e9bec=await _0x2aafbb['json']();if(!_0x4e9bec[_0x1e235e(0x214)])return localStorage[_0x1e235e(0x1c3)]('accessToken',_0x4e9bec[_0x1e235e(0x203)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x4e9bec[_0x1e235e(0x211)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x4216f3){console['error']('Error\x20while\x20refreshing\x20token:',_0x4216f3);}return![];}export async function dpUploadFile(_0x49463e,_0x554f36,_0x2414af){var _0x50ed45=a0_0x74e20e;const _0x36b44b=localStorage[_0x50ed45(0x1f2)](_0x50ed45(0x1f6));var _0x41bf63=JSON['stringify']({'autorename':!![],'mode':_0x50ed45(0x1dc),'mute':!![],'strict_conflict':![],'path':'/'+_0x36b44b+'/'+_0x2414af+'/'+_0x49463e}),_0x781798=new Blob([_0x554f36],{'type':_0x50ed45(0x20c)});for(var _0x517220=0x0;_0x517220<0x2;_0x517220++){var _0x35b6bc=await fetch(_0x50ed45(0x1d8),{'method':_0x50ed45(0x1d2),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x50ed45(0x1f2)](_0x50ed45(0x21c)),'Dropbox-API-Arg':_0x41bf63,'Content-Type':'application/octet-stream'},'body':_0x781798});if(_0x35b6bc['status']!=0xc8){if(_0x35b6bc['status']==0x191){var _0x28b56e=await dpRefreshToken();if(!_0x28b56e)throw _0x50ed45(0x1cf);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x35b6bc[_0x50ed45(0x1d1)];}else{var _0x9d3236=await _0x35b6bc[_0x50ed45(0x219)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x49463e),_0x9d3236;}}return![];}export async function dpDownloadFile(_0x3900ad,_0x44bf21){var _0x1d0af1=a0_0x74e20e;const _0x4ed191=localStorage['getItem'](_0x1d0af1(0x1f6));var _0x5f500d=JSON[_0x1d0af1(0x1c5)]({'path':'/'+_0x4ed191+'/'+_0x44bf21+'/'+_0x3900ad});for(var _0x22ab69=0x0;_0x22ab69<0x2;_0x22ab69++){var _0x4506ea=await fetch(_0x1d0af1(0x1db),{'method':_0x1d0af1(0x1d2),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x1d0af1(0x1f2)](_0x1d0af1(0x21c)),'Dropbox-API-Arg':_0x5f500d}});if(_0x4506ea[_0x1d0af1(0x1d1)]!=0xc8){if(_0x4506ea[_0x1d0af1(0x1d1)]==0x191){var _0xee4053=await dpRefreshToken();if(!_0xee4053)throw _0x1d0af1(0x1cf);continue;}else throw _0x1d0af1(0x1fa)+_0x4506ea[_0x1d0af1(0x1d1)];}const _0x5a2693=new File([await _0x4506ea['blob']()],_0x3900ad);return console[_0x1d0af1(0x20b)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x5a2693[_0x1d0af1(0x204)]),a0_0x50e221[_0x1d0af1(0x1e6)](_0x5a2693,()=>{}),_0x5a2693;}return![];}document[a0_0x74e20e(0x1e1)]('DOMContentLoaded',function(){var _0x293dc0=a0_0x74e20e;dropboxRestore['addEventListener'](_0x293dc0(0x217),async function(){var _0x6d471d=_0x293dc0;await lockNoti(_0x6d471d(0x1d0),'',0x1388);const _0x2d7acf=localStorage[_0x6d471d(0x1f2)](_0x6d471d(0x1f6)),_0x123794=[_0x6d471d(0x1f0),_0x6d471d(0x1f7),'screenshot'];if(!_0x2d7acf){window['alert'](_0x6d471d(0x1cd));return;}let _0x579190=[];for(const _0x50ad22 of _0x123794){let _0x56fabc={'path':'/'+_0x2d7acf+'/'+_0x50ad22};for(let _0x30d6b4=0x0;_0x30d6b4<0x2;_0x30d6b4++){let _0x5753b0=await fetch(_0x6d471d(0x1da),{'method':_0x6d471d(0x1d2),'headers':{'Authorization':_0x6d471d(0x1c4)+localStorage[_0x6d471d(0x1f2)](_0x6d471d(0x21c)),'Content-Type':_0x6d471d(0x208)},'body':JSON[_0x6d471d(0x1c5)](_0x56fabc)});if(_0x5753b0[_0x6d471d(0x1d1)]===0xc8){let _0x1fda8a=await _0x5753b0[_0x6d471d(0x219)](),_0x3e216e=_0x1fda8a[_0x6d471d(0x202)][_0x6d471d(0x200)](_0x780c68=>_0x780c68['.tag']==='file');_0x3e216e[_0x6d471d(0x1f5)]>0x0&&_0x579190['push'](..._0x3e216e[_0x6d471d(0x1e3)](_0x30893c=>({'name':_0x30893c[_0x6d471d(0x204)],'folder':_0x50ad22})));break;}else{if(_0x5753b0['status']===0x191){let _0x21d493=await dpRefreshToken();if(!_0x21d493)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x6d471d(0x1d5)+_0x50ad22+',\x20status:\x20'+_0x5753b0[_0x6d471d(0x1d1)]);break;}}}}if(_0x579190[_0x6d471d(0x1f5)]>0x0){const _0x4450fd=_0x6d471d(0x21b)+_0x579190[_0x6d471d(0x1f5)]+'\x20files\x20from\x20Cloud?';if(window[_0x6d471d(0x20d)](_0x4450fd))for(const _0xb40b85 of _0x579190){await lockNoti(_0x6d471d(0x1e0),_0xb40b85[_0x6d471d(0x204)],0xbb8),await dpDownloadFile(_0xb40b85[_0x6d471d(0x204)],_0xb40b85[_0x6d471d(0x1ff)]);}else console[_0x6d471d(0x20b)](_0x6d471d(0x20e));}else console[_0x6d471d(0x20b)](_0x6d471d(0x1f1));}),dropboxBackup[_0x293dc0(0x1e1)](_0x293dc0(0x217),async function(){var _0x307c13=_0x293dc0;await lockNoti(_0x307c13(0x1d0),'',0x1388);const _0x317655=localStorage[_0x307c13(0x1f2)](_0x307c13(0x1f6));if(_0x317655===null||_0x317655==='')window[_0x307c13(0x1f8)]('Cloud\x20login\x20required!');else{const _0x32b037=[_0x307c13(0x1f0),_0x307c13(0x1f7),_0x307c13(0x212)];for(const _0x235a43 of _0x32b037){await dpCreateFolder(_0x235a43);}let _0x43a0bd=0x0;for(const _0x3e3064 of _0x32b037){const _0x437db2=a0_0x50e221[_0x307c13(0x21f)](_0x3e3064+'s');_0x43a0bd+=_0x437db2[_0x307c13(0x1f5)];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x43a0bd+_0x307c13(0x1c7)))for(const _0x4ae82e of _0x32b037){const _0x6b12e=a0_0x50e221[_0x307c13(0x21f)](_0x4ae82e+'s');for(const _0x336d57 of _0x6b12e){const _0x48efd6=await a0_0x50e221[_0x307c13(0x20a)](_0x307c13(0x209)+_0x4ae82e+'s/'+_0x336d57);try{await lockNoti('Backing\x20up...',_0x336d57,0xbb8),await dpUploadFile(_0x336d57,_0x48efd6,_0x4ae82e);}catch(_0x40dade){console['error'](_0x307c13(0x1e5)+_0x336d57+':',_0x40dade);}}}else console[_0x307c13(0x20b)](_0x307c13(0x20e));}}),dropboxCloud[_0x293dc0(0x1e1)](_0x293dc0(0x217),function(){var _0x205888=_0x293dc0;const _0x1e0701=localStorage[_0x205888(0x1f2)](_0x205888(0x1f6));_0x1e0701===null||_0x1e0701===''?authorizeWithDropbox():window[_0x205888(0x20d)](_0x205888(0x1e4))&&(localStorage[_0x205888(0x1c3)](_0x205888(0x1f6),''),dropboxRestore[_0x205888(0x1e7)]['remove'](_0x205888(0x1d4)),dropboxBackup[_0x205888(0x1e7)]['remove'](_0x205888(0x1d4)),dropboxCloud['classList']['remove'](_0x205888(0x1d4)));}),handleDropboxCallback();});