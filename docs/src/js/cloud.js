var a0_0x1f081d=a0_0xc8a9;(function(_0x448253,_0x7e3ace){var _0x520f98=a0_0xc8a9,_0x268064=_0x448253();while(!![]){try{var _0x1e2553=-parseInt(_0x520f98(0x1e7))/0x1*(parseInt(_0x520f98(0x1bb))/0x2)+parseInt(_0x520f98(0x1d2))/0x3*(-parseInt(_0x520f98(0x19e))/0x4)+parseInt(_0x520f98(0x1d4))/0x5*(-parseInt(_0x520f98(0x1ac))/0x6)+parseInt(_0x520f98(0x1c7))/0x7*(parseInt(_0x520f98(0x1eb))/0x8)+parseInt(_0x520f98(0x1d1))/0x9*(parseInt(_0x520f98(0x1d8))/0xa)+-parseInt(_0x520f98(0x1ef))/0xb+-parseInt(_0x520f98(0x1db))/0xc*(-parseInt(_0x520f98(0x1dd))/0xd);if(_0x1e2553===_0x7e3ace)break;else _0x268064['push'](_0x268064['shift']());}catch(_0x755b){_0x268064['push'](_0x268064['shift']());}}}(a0_0x31fe,0x98715));function a0_0xc8a9(_0x8bcab8,_0x1c6af4){var _0x31fe75=a0_0x31fe();return a0_0xc8a9=function(_0xc8a9b5,_0x33035a){_0xc8a9b5=_0xc8a9b5-0x18c;var _0x307518=_0x31fe75[_0xc8a9b5];return _0x307518;},a0_0xc8a9(_0x8bcab8,_0x1c6af4);}import*as a0_0x25881a from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x1f081d(0x1f8);function authorizeWithDropbox(){var _0x14c86b=a0_0x1f081d,_0x8b76d6=window['location']['href'][_0x14c86b(0x1a4)]('?')[0x0],_0x1f53cd=_0x14c86b(0x1cd),_0x42e68d=_0x14c86b(0x1b9),_0x4021e9='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x14c86b(0x1c2)+_0x1f53cd+_0x14c86b(0x1de)+_0x42e68d+_0x14c86b(0x1f0)+encodeURIComponent(_0x8b76d6);window[_0x14c86b(0x1e3)][_0x14c86b(0x1c1)]=_0x4021e9;}function a0_0x31fe(){var _0x256844=['No\x20files\x20found\x20to\x20restore.','accessToken','application/octet-stream','toUpperCase','https://api.dropboxapi.com/oauth2/token','nwb3dnfh09rhs31','Failed\x20to\x20refresh\x20Dropbox\x20token.','getItem','setRequestHeader','uid','https://api.dropbox.com/oauth2/token','blob','=([^&#]*)','Cloud\x20↦\x20Kabu\x20storage\x20◆','list','setItem','screenshot','click','POST','entries','alert','https://content.dropboxapi.com/2/files/download','Do\x20you\x20want\x20to\x20logout?','Folder\x20already\x20exists','&grant_type=','error','application/x-www-form-urlencoded','1736716oxEanX','Error\x20creating\x20folder\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','No\x20refresh\x20token','Bearer\x20','confirm','split','&client_secret=','refresh_token','access_token','Backing\x20up...','Download\x20failed,\x20unknown\x20http\x20status:','log','&client_id=','284076lesPhA','save','Upload\x20failed,\x20unknown\x20http\x20status:\x20','charAt','https://content.dropboxapi.com/2/files/upload','search','Refreshing\x20token...','Authorization\x20Code:','Folder\x20created','name','filter','json','open','offline','code=','1034946seHuME','classList','onload','exec','slice','refresh_token=','href','&response_type=','authorization_code','Failed\x20to\x20upload\x20file\x20','Restore\x20canceled\x20by\x20user.','downloadFileInCloud','119MRhRsS','replace','https://api.dropboxapi.com/2/files/list_folder','addEventListener','remove','uId','code','DOMContentLoaded','overwrite','.tag','345429VznWrz','3ddbFtu','map','65Evyzio','stringify','[\x5c?&#]','Do\x20you\x20want\x20to\x20restore\x20','140tcxuFb','Cloud\x20login\x20required!','parse','36GyOmDR','folder','6750757FCEbRu','&token_access_type=','length','push','Restoring...','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','location','uploadFileInCloud','refreshToken','active','1DnjOYp','application/json','Wait\x20a\x20little\x20bit...','status','479992XyUnhA','error_description','\x20files\x20from\x20Cloud?','state','10159919cPmKTU','&redirect_uri=','Content-Type','Unable\x20to\x20refresh\x20token'];a0_0x31fe=function(){return _0x256844;};return a0_0x31fe();}function handleDropboxCallback(){var _0x1f4ee5=a0_0x1f081d,_0x42b449=getUrlParameter('code');_0x42b449?(getAccessToken(_0x42b449),console[_0x1f4ee5(0x1aa)](_0x1f4ee5(0x1b3),_0x42b449)):console[_0x1f4ee5(0x1aa)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x202a60){var _0x34e924=a0_0x1f081d;_0x202a60=_0x202a60[_0x34e924(0x1c8)](/[\[]/,'\x5c[')[_0x34e924(0x1c8)](/[\]]/,'\x5c]');var _0x17eaf3=new RegExp(_0x34e924(0x1d6)+_0x202a60+_0x34e924(0x18f)),_0x4e01d4=_0x17eaf3[_0x34e924(0x1be)](location[_0x34e924(0x1b1)]);return _0x4e01d4===null?'':decodeURIComponent(_0x4e01d4[0x1][_0x34e924(0x1c8)](/\+/g,'\x20'));}function getAccessToken(_0x45f470){var _0x2bd547=a0_0x1f081d,_0xcf047d=_0x2bd547(0x1c3),_0x453e18=window[_0x2bd547(0x1e3)]['href'][_0x2bd547(0x1a4)]('?')[0x0],_0x2805dd=new XMLHttpRequest();_0x2805dd[_0x2bd547(0x1b8)](_0x2bd547(0x195),_0x2bd547(0x18d)),_0x2805dd[_0x2bd547(0x1fb)](_0x2bd547(0x1f1),_0x2bd547(0x19d)),_0x2805dd[_0x2bd547(0x1bd)]=function(){var _0x3f6a47=_0x2bd547;if(_0x2805dd[_0x3f6a47(0x1ea)]===0xc8){var _0x146427=JSON[_0x3f6a47(0x1da)](_0x2805dd['responseText']),_0x425b86=_0x146427[_0x3f6a47(0x1a7)],_0x241674=_0x146427[_0x3f6a47(0x1a6)],_0x269e7e=_0x146427[_0x3f6a47(0x18c)];localStorage['setItem']('accessToken',_0x425b86),localStorage[_0x3f6a47(0x192)](_0x3f6a47(0x1e5),_0x241674),localStorage[_0x3f6a47(0x192)](_0x3f6a47(0x1cc),_0x269e7e);}else console[_0x3f6a47(0x1aa)](_0x3f6a47(0x1e2));},_0x2805dd['send'](_0x2bd547(0x1ba)+_0x45f470+_0x2bd547(0x19b)+_0xcf047d+_0x2bd547(0x1ab)+clientId+_0x2bd547(0x1a5)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x453e18));}export async function dpCreateFolder(_0xabc581){var _0x11fdd3=a0_0x1f081d;const _0x2751a5=localStorage[_0x11fdd3(0x1fa)]('uId');let _0x5e4bda=localStorage[_0x11fdd3(0x1fa)](_0x11fdd3(0x1f4));const _0x2194e8='/'+_0x2751a5+'/'+_0xabc581,_0x3c36ae=JSON[_0x11fdd3(0x1d5)]({'path':_0x2194e8,'autorename':![]});for(let _0x772b5e=0x0;_0x772b5e<0x2;_0x772b5e++){try{const _0x46affa=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x11fdd3(0x195),'headers':{'Authorization':_0x11fdd3(0x1a2)+_0x5e4bda,'Content-Type':_0x11fdd3(0x1e8)},'body':_0x3c36ae});if(_0x46affa[_0x11fdd3(0x1ea)]===0x191){const _0x1491d5=await dpRefreshToken();if(!_0x1491d5)throw new Error('Unable\x20to\x20refresh\x20token');_0x5e4bda=localStorage[_0x11fdd3(0x1fa)](_0x11fdd3(0x1f4));continue;}if(_0x46affa['status']===0x199)return{'message':_0x11fdd3(0x19a),'path':_0xabc581};if(!_0x46affa['ok'])throw new Error(_0x11fdd3(0x19f)+_0xabc581);const _0x39ddc1=await _0x46affa[_0x11fdd3(0x1b7)]();return await lockNoti(_0x11fdd3(0x1b4),'',0xbb8),_0x39ddc1;}catch(_0x4208ad){if(_0x772b5e===0x1)throw _0x4208ad;}}return![];}export async function dpRefreshToken(){var _0x570834=a0_0x1f081d;if(!localStorage[_0x570834(0x1fa)]('refreshToken'))throw _0x570834(0x1a1);try{const _0xb12411=await fetch(_0x570834(0x1f7),{'method':_0x570834(0x195),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x570834(0x1c0)+localStorage[_0x570834(0x1fa)](_0x570834(0x1e5))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x22ca06=await _0xb12411[_0x570834(0x1b7)]();if(!_0x22ca06[_0x570834(0x19c)])return localStorage[_0x570834(0x192)](_0x570834(0x1f4),_0x22ca06[_0x570834(0x1a7)]),await lockNoti(_0x570834(0x1b2),'',0xbb8),await delay(0x3e8),!![];else alert(_0x22ca06[_0x570834(0x1ec)]||_0x570834(0x1f9));}catch(_0x53759d){console['error']('Error\x20while\x20refreshing\x20token:',_0x53759d);}return![];}export async function dpUploadFile(_0x3802f8,_0x2c7033,_0x496eed){var _0xd3b710=a0_0x1f081d;const _0x1c9b2b=localStorage[_0xd3b710(0x1fa)](_0xd3b710(0x1cc));var _0x505ffd=JSON[_0xd3b710(0x1d5)]({'autorename':!![],'mode':_0xd3b710(0x1cf),'mute':!![],'strict_conflict':![],'path':'/'+_0x1c9b2b+'/'+_0x496eed+'/'+_0x3802f8}),_0x531f0e=new Blob([_0x2c7033],{'type':'application/octet-stream'});for(var _0x3e7e50=0x0;_0x3e7e50<0x2;_0x3e7e50++){var _0x4e7ee3=await fetch(_0xd3b710(0x1b0),{'method':_0xd3b710(0x195),'headers':{'Authorization':_0xd3b710(0x1a2)+localStorage[_0xd3b710(0x1fa)]('accessToken'),'Dropbox-API-Arg':_0x505ffd,'Content-Type':_0xd3b710(0x1f5)},'body':_0x531f0e});if(_0x4e7ee3[_0xd3b710(0x1ea)]!=0xc8){if(_0x4e7ee3[_0xd3b710(0x1ea)]==0x191){var _0x5824b7=await dpRefreshToken();if(!_0x5824b7)throw _0xd3b710(0x1f2);continue;}else throw _0xd3b710(0x1ae)+_0x4e7ee3[_0xd3b710(0x1ea)];}else{var _0x88cf5=await _0x4e7ee3[_0xd3b710(0x1b7)]();return console[_0xd3b710(0x1aa)](_0xd3b710(0x1a0),_0x3802f8),_0x88cf5;}}return![];}export async function dpDownloadFile(_0xc4f306,_0xbd9357){var _0x5b4fb9=a0_0x1f081d;const _0x543999=localStorage['getItem']('uId');var _0x582c09=JSON['stringify']({'path':'/'+_0x543999+'/'+_0xbd9357+'/'+_0xc4f306});for(var _0x59cdc9=0x0;_0x59cdc9<0x2;_0x59cdc9++){var _0x40a798=await fetch(_0x5b4fb9(0x198),{'method':_0x5b4fb9(0x195),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5b4fb9(0x1fa)](_0x5b4fb9(0x1f4)),'Dropbox-API-Arg':_0x582c09}});if(_0x40a798[_0x5b4fb9(0x1ea)]!=0xc8){if(_0x40a798[_0x5b4fb9(0x1ea)]==0x191){var _0x2ce1cb=await dpRefreshToken();if(!_0x2ce1cb)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5b4fb9(0x1a9)+_0x40a798[_0x5b4fb9(0x1ea)];}const _0x6d3495=new File([await _0x40a798[_0x5b4fb9(0x18e)]()],_0xc4f306);return console[_0x5b4fb9(0x1aa)](_0x5b4fb9(0x190),_0x6d3495[_0x5b4fb9(0x1b5)]),a0_0x25881a[_0x5b4fb9(0x1e4)](_0x6d3495,()=>{localStorageFile(),Module['FSSync']();}),_0x6d3495;}return![];}document[a0_0x1f081d(0x1ca)](a0_0x1f081d(0x1ce),function(){var _0x50919b=a0_0x1f081d;dropboxRestore[_0x50919b(0x1ca)](_0x50919b(0x194),async function(){var _0x43a162=_0x50919b;await lockNoti(_0x43a162(0x1e9),'',0x1388);const _0x38f13f=localStorage['getItem'](_0x43a162(0x1cc)),_0x58b7ec=['state',_0x43a162(0x1ad),_0x43a162(0x193)];if(!_0x38f13f){window[_0x43a162(0x197)]('Cloud\x20login\x20required!');return;}let _0x3ce68b=[];for(const _0x454e66 of _0x58b7ec){let _0x3639bf={'path':'/'+_0x38f13f+'/'+_0x454e66};for(let _0x3d905e=0x0;_0x3d905e<0x2;_0x3d905e++){let _0x2d4b5a=await fetch(_0x43a162(0x1c9),{'method':_0x43a162(0x195),'headers':{'Authorization':_0x43a162(0x1a2)+localStorage[_0x43a162(0x1fa)](_0x43a162(0x1f4)),'Content-Type':_0x43a162(0x1e8)},'body':JSON[_0x43a162(0x1d5)](_0x3639bf)});if(_0x2d4b5a[_0x43a162(0x1ea)]===0xc8){let _0x250d21=await _0x2d4b5a[_0x43a162(0x1b7)](),_0x2fbef5=_0x250d21[_0x43a162(0x196)][_0x43a162(0x1b6)](_0x5b8c19=>_0x5b8c19[_0x43a162(0x1d0)]==='file');_0x2fbef5[_0x43a162(0x1df)]>0x0&&_0x3ce68b[_0x43a162(0x1e0)](..._0x2fbef5[_0x43a162(0x1d3)](_0x32c94b=>({'name':_0x32c94b['name'],'folder':_0x454e66})));break;}else{if(_0x2d4b5a[_0x43a162(0x1ea)]===0x191){let _0x383df5=await dpRefreshToken();if(!_0x383df5)throw _0x43a162(0x1f2);}else{console[_0x43a162(0x19c)]('Download\x20failed\x20for\x20'+_0x454e66+',\x20status:\x20'+_0x2d4b5a[_0x43a162(0x1ea)]);break;}}}}if(_0x3ce68b['length']>0x0){const _0x59c04d=_0x43a162(0x1d7)+_0x3ce68b['length']+_0x43a162(0x1ed);if(window['confirm'](_0x59c04d))for(const _0x242b8d of _0x3ce68b){await lockNoti(_0x43a162(0x1e1),_0x242b8d[_0x43a162(0x1b5)],0xbb8),await dpDownloadFile(_0x242b8d['name'],_0x242b8d[_0x43a162(0x1dc)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x43a162(0x1aa)](_0x43a162(0x1f3));}),dropboxBackup[_0x50919b(0x1ca)](_0x50919b(0x194),async function(){var _0x4b3361=_0x50919b;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x36f64c=localStorage['getItem'](_0x4b3361(0x1cc));if(_0x36f64c===null||_0x36f64c==='')window[_0x4b3361(0x197)](_0x4b3361(0x1d9));else{const _0x3333c8=[_0x4b3361(0x1ee),'save',_0x4b3361(0x193)];for(const _0x1177a8 of _0x3333c8){await dpCreateFolder(_0x1177a8);}let _0x495c8d=0x0;for(const _0x104270 of _0x3333c8){const _0x184792=a0_0x25881a[_0x4b3361(0x191)+(_0x104270[_0x4b3361(0x1af)](0x0)[_0x4b3361(0x1f6)]()+_0x104270['slice'](0x1))]();_0x495c8d+=_0x184792[_0x4b3361(0x1df)];}if(window[_0x4b3361(0x1a3)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x495c8d+'\x20files\x20in\x20Kabu?'))for(const _0x2faeac of _0x3333c8){const _0x2730a2=a0_0x25881a[_0x4b3361(0x191)+(_0x2faeac[_0x4b3361(0x1af)](0x0)[_0x4b3361(0x1f6)]()+_0x2faeac[_0x4b3361(0x1bf)](0x1))]();for(const _0x5dec3d of _0x2730a2){const _0x300461=await a0_0x25881a[_0x4b3361(0x1c6)]('/data/'+_0x2faeac+'s/'+_0x5dec3d);try{await lockNoti(_0x4b3361(0x1a8),_0x5dec3d,0xbb8),await dpUploadFile(_0x5dec3d,_0x300461,_0x2faeac);}catch(_0x1da5f0){console[_0x4b3361(0x19c)](_0x4b3361(0x1c4)+_0x5dec3d+':',_0x1da5f0);}}}else console['log'](_0x4b3361(0x1c5));}}),dropboxCloud[_0x50919b(0x1ca)]('click',function(){var _0x1bb375=_0x50919b;const _0x1cf41c=localStorage[_0x1bb375(0x1fa)](_0x1bb375(0x1cc));_0x1cf41c===null||_0x1cf41c===''?authorizeWithDropbox():window[_0x1bb375(0x1a3)](_0x1bb375(0x199))&&(localStorage['setItem'](_0x1bb375(0x1cc),''),dropboxRestore[_0x1bb375(0x1bc)][_0x1bb375(0x1cb)](_0x1bb375(0x1e6)),dropboxBackup['classList'][_0x1bb375(0x1cb)]('active'),dropboxCloud[_0x1bb375(0x1bc)]['remove'](_0x1bb375(0x1e6)));}),handleDropboxCallback();});