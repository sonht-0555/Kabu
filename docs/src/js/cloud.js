var a0_0x1c7406=a0_0x4a1c;(function(_0x4ee7e5,_0x4403b7){var _0x4ba1f9=a0_0x4a1c,_0x33cc04=_0x4ee7e5();while(!![]){try{var _0x2fe11b=parseInt(_0x4ba1f9(0x1a0))/0x1+-parseInt(_0x4ba1f9(0x1ca))/0x2*(parseInt(_0x4ba1f9(0x17a))/0x3)+parseInt(_0x4ba1f9(0x1d1))/0x4*(-parseInt(_0x4ba1f9(0x177))/0x5)+parseInt(_0x4ba1f9(0x1c9))/0x6*(parseInt(_0x4ba1f9(0x1c4))/0x7)+parseInt(_0x4ba1f9(0x17f))/0x8*(parseInt(_0x4ba1f9(0x186))/0x9)+parseInt(_0x4ba1f9(0x1cb))/0xa+parseInt(_0x4ba1f9(0x185))/0xb*(-parseInt(_0x4ba1f9(0x193))/0xc);if(_0x2fe11b===_0x4403b7)break;else _0x33cc04['push'](_0x33cc04['shift']());}catch(_0x1bbf6b){_0x33cc04['push'](_0x33cc04['shift']());}}}(a0_0x2214,0x88def));import*as a0_0x18d5d5 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1c7406(0x182),clientSecret=a0_0x1c7406(0x1aa);function authorizeWithDropbox(){var _0xaa464b=a0_0x1c7406,_0x4f62f8=window[_0xaa464b(0x192)][_0xaa464b(0x1a4)][_0xaa464b(0x1c3)]('?')[0x0],_0x7987d5='code',_0x2683de=_0xaa464b(0x18c),_0x413b96='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0xaa464b(0x1bc)+_0x7987d5+_0xaa464b(0x179)+_0x2683de+_0xaa464b(0x1af)+encodeURIComponent(_0x4f62f8);window['location'][_0xaa464b(0x1a4)]=_0x413b96;}function handleDropboxCallback(){var _0x2d7f17=a0_0x1c7406,_0x46e95c=getUrlParameter('code');_0x46e95c?(getAccessToken(_0x46e95c),console[_0x2d7f17(0x1b4)](_0x2d7f17(0x1a3),_0x46e95c)):console['log'](_0x2d7f17(0x1ad));}function a0_0x4a1c(_0x384754,_0x50e140){var _0x2214aa=a0_0x2214();return a0_0x4a1c=function(_0x4a1c68,_0x42c4bb){_0x4a1c68=_0x4a1c68-0x173;var _0x4b1ce1=_0x2214aa[_0x4a1c68];return _0x4b1ce1;},a0_0x4a1c(_0x384754,_0x50e140);}function getUrlParameter(_0x4c6365){var _0x3e37a1=a0_0x1c7406;_0x4c6365=_0x4c6365['replace'](/[\[]/,'\x5c[')[_0x3e37a1(0x198)](/[\]]/,'\x5c]');var _0x420e8e=new RegExp('[\x5c?&#]'+_0x4c6365+_0x3e37a1(0x1d4)),_0x3bb71e=_0x420e8e['exec'](location[_0x3e37a1(0x178)]);return _0x3bb71e===null?'':decodeURIComponent(_0x3bb71e[0x1][_0x3e37a1(0x198)](/\+/g,'\x20'));}function getAccessToken(_0x257a3e){var _0x5ae645=a0_0x1c7406,_0x46cf29='authorization_code',_0x3de173=window['location'][_0x5ae645(0x1a4)][_0x5ae645(0x1c3)]('?')[0x0],_0x3703a3=new XMLHttpRequest();_0x3703a3[_0x5ae645(0x1b3)]('POST',_0x5ae645(0x1dc)),_0x3703a3[_0x5ae645(0x18a)](_0x5ae645(0x1b2),_0x5ae645(0x191)),_0x3703a3[_0x5ae645(0x18b)]=function(){var _0x272ded=_0x5ae645;if(_0x3703a3[_0x272ded(0x1a8)]===0xc8){var _0x49bfb6=JSON[_0x272ded(0x19a)](_0x3703a3[_0x272ded(0x1a1)]),_0x2ed83d=_0x49bfb6[_0x272ded(0x194)],_0xde3764=_0x49bfb6[_0x272ded(0x1d3)],_0xa07632=_0x49bfb6[_0x272ded(0x1cd)];localStorage['setItem'](_0x272ded(0x1b8),_0x2ed83d),localStorage['setItem'](_0x272ded(0x1c5),_0xde3764),localStorage[_0x272ded(0x1d8)](_0x272ded(0x1be),_0xa07632);}else console[_0x272ded(0x1b4)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x3703a3[_0x5ae645(0x17d)](_0x5ae645(0x1ce)+_0x257a3e+_0x5ae645(0x174)+_0x46cf29+'&client_id='+clientId+_0x5ae645(0x17e)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x3de173));}export async function dpCreateFolder(_0x51f087){var _0x5633f6=a0_0x1c7406;const _0x44b3c2=localStorage[_0x5633f6(0x1da)](_0x5633f6(0x1be));let _0x2e3f17=localStorage[_0x5633f6(0x1da)](_0x5633f6(0x1b8));const _0x526895='/'+_0x44b3c2+'/'+_0x51f087,_0x162778=JSON[_0x5633f6(0x18d)]({'path':_0x526895,'autorename':![]});for(let _0x586a6c=0x0;_0x586a6c<0x2;_0x586a6c++){try{const _0x352a04=await fetch(_0x5633f6(0x1d5),{'method':_0x5633f6(0x1d0),'headers':{'Authorization':'Bearer\x20'+_0x2e3f17,'Content-Type':_0x5633f6(0x180)},'body':_0x162778});if(_0x352a04[_0x5633f6(0x1a8)]===0x191){const _0x2b4508=await dpRefreshToken();if(!_0x2b4508)throw new Error(_0x5633f6(0x1d6));_0x2e3f17=localStorage[_0x5633f6(0x1da)](_0x5633f6(0x1b8));continue;}if(_0x352a04[_0x5633f6(0x1a8)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x51f087};if(!_0x352a04['ok'])throw new Error(_0x5633f6(0x18e)+_0x51f087);const _0x5f527d=await _0x352a04[_0x5633f6(0x1b1)]();return await lockNoti('Folder\x20created','',0xbb8),_0x5f527d;}catch(_0xbeeca5){if(_0x586a6c===0x1)throw _0xbeeca5;}}return![];}function a0_0x2214(){var _0x4742b4=['uId','error','Download\x20failed\x20for\x20','uploadFileInCloud','https://api.dropboxapi.com/oauth2/token','split','72107hWsQyf','refreshToken','Backing\x20up...','screenshot','Restore\x20canceled\x20by\x20user.','462uILOcN','560808yblMYS','4882170rAhUEh','error_description','uid','code=','https://api.dropboxapi.com/2/files/list_folder','POST','80900tpdKYy','Cloud\x20login\x20required!','refresh_token','=([^&#]*)','https://api.dropboxapi.com/2/files/create_folder_v2','Unable\x20to\x20refresh\x20token','Kabu\x20storage\x20↦\x20Cloud\x20◆','setItem','blob','getItem','classList','https://api.dropbox.com/oauth2/token','name','&grant_type=','Download\x20failed,\x20unknown\x20http\x20status:','Bearer\x20','175LeBXxQ','search','&token_access_type=','3vBUTWM','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','refresh_token=','send','&client_secret=','970328oToyak','application/json','Wait\x20a\x20little\x20bit...','knh3uz2mx2hp2eu','alert','overwrite','22kneDXO','36LeNJzh','Failed\x20to\x20upload\x20file\x20','save','Do\x20you\x20want\x20to\x20restore\x20','setRequestHeader','onload','offline','stringify','Error\x20creating\x20folder\x20','listFiles','map','application/x-www-form-urlencoded','location','6839268ThdtzW','access_token','downloadFileInCloud','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://content.dropboxapi.com/2/files/download','replace','No\x20refresh\x20token','parse','length','active','push','Error\x20while\x20refreshing\x20token:','Do\x20you\x20want\x20to\x20logout?','922222IYiGfT','responseText','DOMContentLoaded','Authorization\x20Code:','href','\x20files\x20from\x20Cloud?','Refreshing\x20token...','click','status','\x20files\x20in\x20Kabu?','nwb3dnfh09rhs31','remove','confirm','Do\x20not\x20receive\x20authorization','state','&redirect_uri=','No\x20files\x20found\x20to\x20restore.','json','Content-Type','open','log','Failed\x20to\x20refresh\x20Dropbox\x20token.','/data/','entries','accessToken','addEventListener','Upload\x20failed,\x20unknown\x20http\x20status:\x20','https://content.dropboxapi.com/2/files/upload','&response_type=','Restoring...'];a0_0x2214=function(){return _0x4742b4;};return a0_0x2214();}export async function dpRefreshToken(){var _0xe670cd=a0_0x1c7406;if(!localStorage['getItem']('refreshToken'))throw _0xe670cd(0x199);try{const _0x4b5ab3=await fetch(_0xe670cd(0x1c2),{'method':_0xe670cd(0x1d0),'headers':{'Content-Type':_0xe670cd(0x191)},'body':_0xe670cd(0x17c)+localStorage[_0xe670cd(0x1da)]('refreshToken')+_0xe670cd(0x17b)}),_0xf8ccdc=await _0x4b5ab3['json']();if(!_0xf8ccdc[_0xe670cd(0x1bf)])return localStorage[_0xe670cd(0x1d8)](_0xe670cd(0x1b8),_0xf8ccdc[_0xe670cd(0x194)]),await lockNoti(_0xe670cd(0x1a6),'',0xbb8),await delay(0x3e8),!![];else alert(_0xf8ccdc[_0xe670cd(0x1cc)]||_0xe670cd(0x1b5));}catch(_0x4b9b82){console[_0xe670cd(0x1bf)](_0xe670cd(0x19e),_0x4b9b82);}return![];}export async function dpUploadFile(_0x3a9d4e,_0x3f9025,_0x150577){var _0x35ad68=a0_0x1c7406;const _0x681b12=localStorage[_0x35ad68(0x1da)](_0x35ad68(0x1be));var _0x3d9d88=JSON[_0x35ad68(0x18d)]({'autorename':!![],'mode':_0x35ad68(0x184),'mute':!![],'strict_conflict':![],'path':'/'+_0x681b12+'/'+_0x150577+'/'+_0x3a9d4e}),_0x31d993=new Blob([_0x3f9025],{'type':'application/octet-stream'});for(var _0x3870bf=0x0;_0x3870bf<0x2;_0x3870bf++){var _0x2c923d=await fetch(_0x35ad68(0x1bb),{'method':'POST','headers':{'Authorization':_0x35ad68(0x176)+localStorage[_0x35ad68(0x1da)](_0x35ad68(0x1b8)),'Dropbox-API-Arg':_0x3d9d88,'Content-Type':'application/octet-stream'},'body':_0x31d993});if(_0x2c923d['status']!=0xc8){if(_0x2c923d['status']==0x191){var _0x51b22b=await dpRefreshToken();if(!_0x51b22b)throw _0x35ad68(0x1d6);continue;}else throw _0x35ad68(0x1ba)+_0x2c923d['status'];}else{var _0xe75461=await _0x2c923d[_0x35ad68(0x1b1)]();return console[_0x35ad68(0x1b4)](_0x35ad68(0x1d7),_0x3a9d4e),_0xe75461;}}return![];}export async function dpDownloadFile(_0x18078f,_0x1fcbe8){var _0x373c86=a0_0x1c7406;const _0x519abf=localStorage[_0x373c86(0x1da)](_0x373c86(0x1be));var _0x48491a=JSON[_0x373c86(0x18d)]({'path':'/'+_0x519abf+'/'+_0x1fcbe8+'/'+_0x18078f});for(var _0x8644fe=0x0;_0x8644fe<0x2;_0x8644fe++){var _0x550009=await fetch(_0x373c86(0x197),{'method':'POST','headers':{'Authorization':_0x373c86(0x176)+localStorage['getItem'](_0x373c86(0x1b8)),'Dropbox-API-Arg':_0x48491a}});if(_0x550009['status']!=0xc8){if(_0x550009['status']==0x191){var _0x4aad58=await dpRefreshToken();if(!_0x4aad58)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x373c86(0x175)+_0x550009[_0x373c86(0x1a8)];}const _0x54a4d4=new File([await _0x550009[_0x373c86(0x1d9)]()],_0x18078f);return console[_0x373c86(0x1b4)](_0x373c86(0x196),_0x54a4d4[_0x373c86(0x173)]),a0_0x18d5d5[_0x373c86(0x1c1)](_0x54a4d4,()=>{}),_0x54a4d4;}return![];}document[a0_0x1c7406(0x1b9)](a0_0x1c7406(0x1a2),function(){var _0x562c17=a0_0x1c7406;dropboxRestore[_0x562c17(0x1b9)]('click',async function(){var _0x59c4bd=_0x562c17;await lockNoti(_0x59c4bd(0x181),'',0x1388);const _0x1a4fec=localStorage['getItem'](_0x59c4bd(0x1be)),_0x19509e=[_0x59c4bd(0x1ae),_0x59c4bd(0x188),_0x59c4bd(0x1c7)];if(!_0x1a4fec){window[_0x59c4bd(0x183)](_0x59c4bd(0x1d2));return;}let _0x1d9b6a=[];for(const _0x1fd41f of _0x19509e){let _0x5b72b0={'path':'/'+_0x1a4fec+'/'+_0x1fd41f};for(let _0x15f155=0x0;_0x15f155<0x2;_0x15f155++){let _0x4e2406=await fetch(_0x59c4bd(0x1cf),{'method':_0x59c4bd(0x1d0),'headers':{'Authorization':_0x59c4bd(0x176)+localStorage[_0x59c4bd(0x1da)](_0x59c4bd(0x1b8)),'Content-Type':_0x59c4bd(0x180)},'body':JSON[_0x59c4bd(0x18d)](_0x5b72b0)});if(_0x4e2406[_0x59c4bd(0x1a8)]===0xc8){let _0x1c8d7e=await _0x4e2406['json'](),_0x4a7f11=_0x1c8d7e[_0x59c4bd(0x1b7)]['filter'](_0x366015=>_0x366015['.tag']==='file');_0x4a7f11[_0x59c4bd(0x19b)]>0x0&&_0x1d9b6a[_0x59c4bd(0x19d)](..._0x4a7f11[_0x59c4bd(0x190)](_0x574ef3=>({'name':_0x574ef3['name'],'folder':_0x1fd41f})));break;}else{if(_0x4e2406[_0x59c4bd(0x1a8)]===0x191){let _0x535f85=await dpRefreshToken();if(!_0x535f85)throw _0x59c4bd(0x1d6);}else{console['error'](_0x59c4bd(0x1c0)+_0x1fd41f+',\x20status:\x20'+_0x4e2406['status']);break;}}}}if(_0x1d9b6a['length']>0x0){const _0x254121=_0x59c4bd(0x189)+_0x1d9b6a[_0x59c4bd(0x19b)]+_0x59c4bd(0x1a5);if(window[_0x59c4bd(0x1ac)](_0x254121))for(const _0x5abd61 of _0x1d9b6a){await lockNoti(_0x59c4bd(0x1bd),_0x5abd61['name'],0xbb8),await dpDownloadFile(_0x5abd61['name'],_0x5abd61['folder']);}else console[_0x59c4bd(0x1b4)]('Restore\x20canceled\x20by\x20user.');}else console[_0x59c4bd(0x1b4)](_0x59c4bd(0x1b0));}),dropboxBackup['addEventListener'](_0x562c17(0x1a7),async function(){var _0x384b66=_0x562c17;await lockNoti(_0x384b66(0x181),'',0x1388);const _0x423ed6=localStorage['getItem'](_0x384b66(0x1be));if(_0x423ed6===null||_0x423ed6==='')window[_0x384b66(0x183)](_0x384b66(0x1d2));else{const _0x361256=[_0x384b66(0x1ae),_0x384b66(0x188),_0x384b66(0x1c7)];for(const _0x567cde of _0x361256){await dpCreateFolder(_0x567cde);}let _0x51ab34=0x0;for(const _0x5ae415 of _0x361256){const _0x1ca0b1=a0_0x18d5d5[_0x384b66(0x18f)](_0x5ae415+'s');_0x51ab34+=_0x1ca0b1[_0x384b66(0x19b)];}if(window[_0x384b66(0x1ac)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x51ab34+_0x384b66(0x1a9)))for(const _0x3a8b0b of _0x361256){const _0x5a1ab0=a0_0x18d5d5[_0x384b66(0x18f)](_0x3a8b0b+'s');for(const _0x36a4f4 of _0x5a1ab0){const _0x2ecf66=await a0_0x18d5d5[_0x384b66(0x195)](_0x384b66(0x1b6)+_0x3a8b0b+'s/'+_0x36a4f4);try{await lockNoti(_0x384b66(0x1c6),_0x36a4f4,0xbb8),await dpUploadFile(_0x36a4f4,_0x2ecf66,_0x3a8b0b);}catch(_0xe80675){console[_0x384b66(0x1bf)](_0x384b66(0x187)+_0x36a4f4+':',_0xe80675);}}}else console['log'](_0x384b66(0x1c8));}}),dropboxCloud[_0x562c17(0x1b9)]('click',function(){var _0x56192b=_0x562c17;const _0x3a7471=localStorage['getItem'](_0x56192b(0x1be));_0x3a7471===null||_0x3a7471===''?authorizeWithDropbox():window['confirm'](_0x56192b(0x19f))&&(localStorage[_0x56192b(0x1d8)](_0x56192b(0x1be),''),dropboxRestore[_0x56192b(0x1db)]['remove']('active'),dropboxBackup[_0x56192b(0x1db)][_0x56192b(0x1ab)](_0x56192b(0x19c)),dropboxCloud[_0x56192b(0x1db)][_0x56192b(0x1ab)](_0x56192b(0x19c)));}),handleDropboxCallback();});