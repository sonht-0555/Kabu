var a0_0x5d63ad=a0_0x52e4;function a0_0x52e4(_0x55582a,_0x5a53c4){var _0x4ed1ed=a0_0x4ed1();return a0_0x52e4=function(_0x52e4ac,_0x125660){_0x52e4ac=_0x52e4ac-0x12a;var _0x58007b=_0x4ed1ed[_0x52e4ac];return _0x58007b;},a0_0x52e4(_0x55582a,_0x5a53c4);}(function(_0x52597e,_0x59dc0e){var _0x1ae2c8=a0_0x52e4,_0x17dcf6=_0x52597e();while(!![]){try{var _0x54c5c1=parseInt(_0x1ae2c8(0x178))/0x1+-parseInt(_0x1ae2c8(0x137))/0x2+parseInt(_0x1ae2c8(0x171))/0x3+-parseInt(_0x1ae2c8(0x13a))/0x4+parseInt(_0x1ae2c8(0x146))/0x5+parseInt(_0x1ae2c8(0x16b))/0x6*(-parseInt(_0x1ae2c8(0x148))/0x7)+-parseInt(_0x1ae2c8(0x166))/0x8*(-parseInt(_0x1ae2c8(0x147))/0x9);if(_0x54c5c1===_0x59dc0e)break;else _0x17dcf6['push'](_0x17dcf6['shift']());}catch(_0x313f6b){_0x17dcf6['push'](_0x17dcf6['shift']());}}}(a0_0x4ed1,0xdde6a));function a0_0x4ed1(){var _0x3f3bad=['list','uid','toUpperCase','location','No\x20refresh\x20token','6646495qyLial','27KTAeWR','14QsNTBY','Unable\x20to\x20refresh\x20token','application/octet-stream','refresh_token','downloadFileInCloud','https://api.dropboxapi.com/2/files/list_folder','POST','&token_access_type=','exec','accessToken','confirm','href','Do\x20you\x20want\x20to\x20backup\x20','code=','parse','Download\x20failed\x20for\x20',',\x20status:\x20','&redirect_uri=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','open','.tag','uploadFileInCloud','remove','authorization_code','uId','Folder\x20already\x20exists','active','push','alert','folder','2839624RaJaCq','onload','DOMContentLoaded','access_token','getItem','203946jKRsUh','Download\x20failed,\x20unknown\x20http\x20status:','refreshToken','setItem','search','&grant_type=','1164000kyIIfD','send','&client_id=','Do\x20you\x20want\x20to\x20logout?','Do\x20you\x20want\x20to\x20restore\x20','&client_secret=','Bearer\x20','959848qsjVpe','application/x-www-form-urlencoded','classList','Cloud\x20↦\x20Kabu\x20storage\x20◆','slice','Authorization\x20Code:','Do\x20not\x20receive\x20authorization','click','https://content.dropboxapi.com/2/files/download','\x20files\x20from\x20Cloud?','Restoring...','code','https://api.dropbox.com/oauth2/token','replace','refresh_token=','addEventListener','Cloud\x20login\x20required!','log','length','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','error','nwb3dnfh09rhs31','split','blob','map','file','setRequestHeader','state','&response_type=','/data/','charAt','error_description','Error\x20creating\x20folder\x20','https://www.dropbox.com/oauth2/authorize?client_id=','name','status','knh3uz2mx2hp2eu','2650670qgMYlw','Restore\x20canceled\x20by\x20user.','overwrite','5759132gPFzoz','stringify','json','screenshot','https://api.dropboxapi.com/oauth2/token','Wait\x20a\x20little\x20bit...','save'];a0_0x4ed1=function(){return _0x3f3bad;};return a0_0x4ed1();}import*as a0_0x235a7c from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5d63ad(0x136),clientSecret=a0_0x5d63ad(0x18d);function authorizeWithDropbox(){var _0x3daf4c=a0_0x5d63ad,_0x198d6f=window[_0x3daf4c(0x144)][_0x3daf4c(0x153)][_0x3daf4c(0x18e)]('?')[0x0],_0x472268=_0x3daf4c(0x183),_0x127a4b='offline',_0x578017=_0x3daf4c(0x133)+clientId+_0x3daf4c(0x12e)+_0x472268+_0x3daf4c(0x14f)+_0x127a4b+_0x3daf4c(0x159)+encodeURIComponent(_0x198d6f);window[_0x3daf4c(0x144)][_0x3daf4c(0x153)]=_0x578017;}function handleDropboxCallback(){var _0x17fc9a=a0_0x5d63ad,_0x545405=getUrlParameter(_0x17fc9a(0x183));_0x545405?(getAccessToken(_0x545405),console[_0x17fc9a(0x189)](_0x17fc9a(0x17d),_0x545405)):console[_0x17fc9a(0x189)](_0x17fc9a(0x17e));}function getUrlParameter(_0x442ccf){var _0x58e242=a0_0x5d63ad;_0x442ccf=_0x442ccf['replace'](/[\[]/,'\x5c[')[_0x58e242(0x185)](/[\]]/,'\x5c]');var _0x8a0b48=new RegExp('[\x5c?&#]'+_0x442ccf+'=([^&#]*)'),_0x22b827=_0x8a0b48[_0x58e242(0x150)](location[_0x58e242(0x16f)]);return _0x22b827===null?'':decodeURIComponent(_0x22b827[0x1][_0x58e242(0x185)](/\+/g,'\x20'));}function getAccessToken(_0x37472c){var _0x4a66e8=a0_0x5d63ad,_0x2baef2=_0x4a66e8(0x15f),_0x3551e7=window[_0x4a66e8(0x144)][_0x4a66e8(0x153)][_0x4a66e8(0x18e)]('?')[0x0],_0x3b6d74=new XMLHttpRequest();_0x3b6d74[_0x4a66e8(0x15b)](_0x4a66e8(0x14e),_0x4a66e8(0x184)),_0x3b6d74[_0x4a66e8(0x12c)]('Content-Type','application/x-www-form-urlencoded'),_0x3b6d74[_0x4a66e8(0x167)]=function(){var _0x233f09=_0x4a66e8;if(_0x3b6d74['status']===0xc8){var _0x218912=JSON[_0x233f09(0x156)](_0x3b6d74['responseText']),_0x38e098=_0x218912[_0x233f09(0x169)],_0x1e6fdf=_0x218912[_0x233f09(0x14b)],_0x440fdf=_0x218912[_0x233f09(0x142)];localStorage[_0x233f09(0x16e)](_0x233f09(0x151),_0x38e098),localStorage['setItem']('refreshToken',_0x1e6fdf),localStorage[_0x233f09(0x16e)](_0x233f09(0x160),_0x440fdf);}else console['log'](_0x233f09(0x18b));},_0x3b6d74[_0x4a66e8(0x172)](_0x4a66e8(0x155)+_0x37472c+_0x4a66e8(0x170)+_0x2baef2+_0x4a66e8(0x173)+clientId+_0x4a66e8(0x176)+clientSecret+_0x4a66e8(0x159)+encodeURIComponent(_0x3551e7));}export async function dpCreateFolder(_0x23c806){var _0x101dc8=a0_0x5d63ad;const _0xea67db=localStorage['getItem'](_0x101dc8(0x160));let _0x586fc5=localStorage[_0x101dc8(0x16a)]('accessToken');const _0x49a6ea='/'+_0xea67db+'/'+_0x23c806,_0x479b47=JSON[_0x101dc8(0x13b)]({'path':_0x49a6ea,'autorename':![]});for(let _0x1633b3=0x0;_0x1633b3<0x2;_0x1633b3++){try{const _0x86a25c=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x101dc8(0x14e),'headers':{'Authorization':_0x101dc8(0x177)+_0x586fc5,'Content-Type':'application/json'},'body':_0x479b47});if(_0x86a25c['status']===0x191){const _0x3c9884=await dpRefreshToken();if(!_0x3c9884)throw new Error(_0x101dc8(0x149));_0x586fc5=localStorage[_0x101dc8(0x16a)]('accessToken');continue;}if(_0x86a25c[_0x101dc8(0x135)]===0x199)return{'message':_0x101dc8(0x161),'path':_0x23c806};if(!_0x86a25c['ok'])throw new Error(_0x101dc8(0x132)+_0x23c806);const _0x3f7dc9=await _0x86a25c[_0x101dc8(0x13c)]();return await lockNoti('Folder\x20created','',0xbb8),_0x3f7dc9;}catch(_0x375352){if(_0x1633b3===0x1)throw _0x375352;}}return![];}export async function dpRefreshToken(){var _0x3adc25=a0_0x5d63ad;if(!localStorage['getItem'](_0x3adc25(0x16d)))throw _0x3adc25(0x145);try{const _0x314314=await fetch(_0x3adc25(0x13e),{'method':_0x3adc25(0x14e),'headers':{'Content-Type':_0x3adc25(0x179)},'body':_0x3adc25(0x186)+localStorage[_0x3adc25(0x16a)](_0x3adc25(0x16d))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2cbc76=await _0x314314['json']();if(!_0x2cbc76[_0x3adc25(0x18c)])return localStorage[_0x3adc25(0x16e)](_0x3adc25(0x151),_0x2cbc76[_0x3adc25(0x169)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x2cbc76[_0x3adc25(0x131)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x595717){console['error']('Error\x20while\x20refreshing\x20token:',_0x595717);}return![];}export async function dpUploadFile(_0x2c0ab3,_0x57a132,_0x162d0b){var _0x5c7ac1=a0_0x5d63ad;const _0x2bc520=localStorage[_0x5c7ac1(0x16a)]('uId');var _0x25bbf5=JSON[_0x5c7ac1(0x13b)]({'autorename':!![],'mode':_0x5c7ac1(0x139),'mute':!![],'strict_conflict':![],'path':'/'+_0x2bc520+'/'+_0x162d0b+'/'+_0x2c0ab3}),_0x1bff2c=new Blob([_0x57a132],{'type':_0x5c7ac1(0x14a)});for(var _0x5a62df=0x0;_0x5a62df<0x2;_0x5a62df++){var _0x20d157=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x5c7ac1(0x14e),'headers':{'Authorization':_0x5c7ac1(0x177)+localStorage[_0x5c7ac1(0x16a)](_0x5c7ac1(0x151)),'Dropbox-API-Arg':_0x25bbf5,'Content-Type':_0x5c7ac1(0x14a)},'body':_0x1bff2c});if(_0x20d157['status']!=0xc8){if(_0x20d157[_0x5c7ac1(0x135)]==0x191){var _0x58d0c1=await dpRefreshToken();if(!_0x58d0c1)throw _0x5c7ac1(0x149);continue;}else throw _0x5c7ac1(0x15a)+_0x20d157[_0x5c7ac1(0x135)];}else{var _0x15e105=await _0x20d157[_0x5c7ac1(0x13c)]();return console[_0x5c7ac1(0x189)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x2c0ab3),_0x15e105;}}return![];}export async function dpDownloadFile(_0x531cbd,_0x425e68){var _0x37d585=a0_0x5d63ad;const _0x18d3c5=localStorage[_0x37d585(0x16a)](_0x37d585(0x160));var _0x1c2023=JSON['stringify']({'path':'/'+_0x18d3c5+'/'+_0x425e68+'/'+_0x531cbd});for(var _0x956215=0x0;_0x956215<0x2;_0x956215++){var _0x1bea9d=await fetch(_0x37d585(0x180),{'method':_0x37d585(0x14e),'headers':{'Authorization':_0x37d585(0x177)+localStorage[_0x37d585(0x16a)](_0x37d585(0x151)),'Dropbox-API-Arg':_0x1c2023}});if(_0x1bea9d[_0x37d585(0x135)]!=0xc8){if(_0x1bea9d[_0x37d585(0x135)]==0x191){var _0x14a85c=await dpRefreshToken();if(!_0x14a85c)throw _0x37d585(0x149);continue;}else throw _0x37d585(0x16c)+_0x1bea9d[_0x37d585(0x135)];}const _0x4f8c1f=new File([await _0x1bea9d[_0x37d585(0x18f)]()],_0x531cbd);return console[_0x37d585(0x189)](_0x37d585(0x17b),_0x4f8c1f[_0x37d585(0x134)]),a0_0x235a7c[_0x37d585(0x15d)](_0x4f8c1f,()=>{localStorageFile(),Module['FSSync']();}),_0x4f8c1f;}return![];}document[a0_0x5d63ad(0x187)](a0_0x5d63ad(0x168),function(){var _0x428d77=a0_0x5d63ad;dropboxRestore['addEventListener'](_0x428d77(0x17f),async function(){var _0x398023=_0x428d77;await lockNoti(_0x398023(0x13f),'',0x1388);const _0x5d14a6=localStorage[_0x398023(0x16a)](_0x398023(0x160)),_0x475a7c=[_0x398023(0x12d),_0x398023(0x140),_0x398023(0x13d)];if(!_0x5d14a6){window['alert']('Cloud\x20login\x20required!');return;}let _0x5980c4=[];for(const _0xff11ac of _0x475a7c){let _0x56e828={'path':'/'+_0x5d14a6+'/'+_0xff11ac};for(let _0x42de2f=0x0;_0x42de2f<0x2;_0x42de2f++){let _0x18a158=await fetch(_0x398023(0x14d),{'method':_0x398023(0x14e),'headers':{'Authorization':_0x398023(0x177)+localStorage[_0x398023(0x16a)](_0x398023(0x151)),'Content-Type':'application/json'},'body':JSON[_0x398023(0x13b)](_0x56e828)});if(_0x18a158[_0x398023(0x135)]===0xc8){let _0x4bca85=await _0x18a158['json'](),_0x303374=_0x4bca85['entries']['filter'](_0x10790b=>_0x10790b[_0x398023(0x15c)]===_0x398023(0x12b));_0x303374[_0x398023(0x18a)]>0x0&&_0x5980c4[_0x398023(0x163)](..._0x303374[_0x398023(0x12a)](_0x2235ba=>({'name':_0x2235ba[_0x398023(0x134)],'folder':_0xff11ac})));break;}else{if(_0x18a158[_0x398023(0x135)]===0x191){let _0x1457fd=await dpRefreshToken();if(!_0x1457fd)throw _0x398023(0x149);}else{console[_0x398023(0x18c)](_0x398023(0x157)+_0xff11ac+_0x398023(0x158)+_0x18a158['status']);break;}}}}if(_0x5980c4[_0x398023(0x18a)]>0x0){const _0x3439bd=_0x398023(0x175)+_0x5980c4['length']+_0x398023(0x181);if(window[_0x398023(0x152)](_0x3439bd))for(const _0x1b1de2 of _0x5980c4){await lockNoti(_0x398023(0x182),_0x1b1de2[_0x398023(0x134)],0xbb8),await dpDownloadFile(_0x1b1de2[_0x398023(0x134)],_0x1b1de2[_0x398023(0x165)]);}else console['log'](_0x398023(0x138));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x428d77(0x187)]('click',async function(){var _0x23dcf3=_0x428d77;await lockNoti(_0x23dcf3(0x13f),'',0x1388);const _0x2e915d=localStorage[_0x23dcf3(0x16a)]('uId');if(_0x2e915d===null||_0x2e915d==='')window[_0x23dcf3(0x164)](_0x23dcf3(0x188));else{const _0x58ceb6=[_0x23dcf3(0x12d),_0x23dcf3(0x140),_0x23dcf3(0x13d)];for(const _0x2621b2 of _0x58ceb6){await dpCreateFolder(_0x2621b2);}let _0x2b965f=0x0;for(const _0x588285 of _0x58ceb6){const _0x54f20f=a0_0x235a7c[_0x23dcf3(0x141)+(_0x588285[_0x23dcf3(0x130)](0x0)[_0x23dcf3(0x143)]()+_0x588285[_0x23dcf3(0x17c)](0x1))]();_0x2b965f+=_0x54f20f[_0x23dcf3(0x18a)];}if(window[_0x23dcf3(0x152)](_0x23dcf3(0x154)+_0x2b965f+'\x20files\x20in\x20Kabu?'))for(const _0x281d7f of _0x58ceb6){const _0x488e70=a0_0x235a7c[_0x23dcf3(0x141)+(_0x281d7f['charAt'](0x0)[_0x23dcf3(0x143)]()+_0x281d7f['slice'](0x1))]();for(const _0x4f7bc3 of _0x488e70){const _0x273ffe=await a0_0x235a7c[_0x23dcf3(0x14c)](_0x23dcf3(0x12f)+_0x281d7f+'s/'+_0x4f7bc3);try{await lockNoti('Backing\x20up...',_0x4f7bc3,0xbb8),await dpUploadFile(_0x4f7bc3,_0x273ffe,_0x281d7f);}catch(_0x2f0477){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x4f7bc3+':',_0x2f0477);}}}else console['log'](_0x23dcf3(0x138));}}),dropboxCloud[_0x428d77(0x187)](_0x428d77(0x17f),function(){var _0x851771=_0x428d77;const _0x59fc9e=localStorage[_0x851771(0x16a)](_0x851771(0x160));_0x59fc9e===null||_0x59fc9e===''?authorizeWithDropbox():window['confirm'](_0x851771(0x174))&&(localStorage[_0x851771(0x16e)](_0x851771(0x160),''),dropboxRestore[_0x851771(0x17a)][_0x851771(0x15e)](_0x851771(0x162)),dropboxBackup[_0x851771(0x17a)][_0x851771(0x15e)](_0x851771(0x162)),dropboxCloud[_0x851771(0x17a)]['remove'](_0x851771(0x162)));}),handleDropboxCallback();});