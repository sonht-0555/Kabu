var a0_0x2b9468=a0_0x71db;(function(_0x5dc4a2,_0x4e6c4a){var _0x5a5228=a0_0x71db,_0x33b6f7=_0x5dc4a2();while(!![]){try{var _0x10c049=-parseInt(_0x5a5228(0x1c0))/0x1*(parseInt(_0x5a5228(0x193))/0x2)+parseInt(_0x5a5228(0x196))/0x3+parseInt(_0x5a5228(0x1b6))/0x4+parseInt(_0x5a5228(0x1d4))/0x5*(parseInt(_0x5a5228(0x1c2))/0x6)+parseInt(_0x5a5228(0x194))/0x7+-parseInt(_0x5a5228(0x1af))/0x8*(parseInt(_0x5a5228(0x1db))/0x9)+-parseInt(_0x5a5228(0x1b9))/0xa;if(_0x10c049===_0x4e6c4a)break;else _0x33b6f7['push'](_0x33b6f7['shift']());}catch(_0x120564){_0x33b6f7['push'](_0x33b6f7['shift']());}}}(a0_0x2018,0x6c6d7));import*as a0_0x4d5dba from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x2b9468(0x1a2);function a0_0x71db(_0x5ebeb9,_0x17dd9b){var _0x2018b9=a0_0x2018();return a0_0x71db=function(_0x71db7c,_0x1ae7e6){_0x71db7c=_0x71db7c-0x17a;var _0x59ea17=_0x2018b9[_0x71db7c];return _0x59ea17;},a0_0x71db(_0x5ebeb9,_0x17dd9b);}function authorizeWithDropbox(){var _0x55c4a5=a0_0x2b9468,_0x24bfbf=window['location'][_0x55c4a5(0x1d8)][_0x55c4a5(0x1ce)]('?')[0x0],_0x2cb1bd=_0x55c4a5(0x1c4),_0x34aafa=_0x55c4a5(0x18d),_0x445667=_0x55c4a5(0x1a3)+clientId+_0x55c4a5(0x1b4)+_0x2cb1bd+_0x55c4a5(0x17f)+_0x34aafa+_0x55c4a5(0x17a)+encodeURIComponent(_0x24bfbf);window[_0x55c4a5(0x19b)][_0x55c4a5(0x1d8)]=_0x445667;}function handleDropboxCallback(){var _0x511fe4=a0_0x2b9468,_0x1bb5e0=getUrlParameter('code');_0x1bb5e0?(getAccessToken(_0x1bb5e0),console[_0x511fe4(0x18a)](_0x511fe4(0x1be),_0x1bb5e0)):console['log'](_0x511fe4(0x1dd));}function getUrlParameter(_0x5d040a){var _0x628390=a0_0x2b9468;_0x5d040a=_0x5d040a[_0x628390(0x180)](/[\[]/,'\x5c[')[_0x628390(0x180)](/[\]]/,'\x5c]');var _0x55981a=new RegExp(_0x628390(0x1d2)+_0x5d040a+_0x628390(0x1cf)),_0x3265d5=_0x55981a[_0x628390(0x181)](location[_0x628390(0x187)]);return _0x3265d5===null?'':decodeURIComponent(_0x3265d5[0x1][_0x628390(0x180)](/\+/g,'\x20'));}function getAccessToken(_0x174f24){var _0x43fc45=a0_0x2b9468,_0x13f881=_0x43fc45(0x19a),_0x26e821=window['location'][_0x43fc45(0x1d8)][_0x43fc45(0x1ce)]('?')[0x0],_0x410dda=new XMLHttpRequest();_0x410dda['open'](_0x43fc45(0x19f),_0x43fc45(0x1e0)),_0x410dda[_0x43fc45(0x1a8)](_0x43fc45(0x182),_0x43fc45(0x186)),_0x410dda[_0x43fc45(0x1da)]=function(){var _0x5637a9=_0x43fc45;if(_0x410dda[_0x5637a9(0x1b2)]===0xc8){var _0x48fa79=JSON[_0x5637a9(0x19c)](_0x410dda[_0x5637a9(0x1a5)]),_0x13f975=_0x48fa79[_0x5637a9(0x17e)],_0x218809=_0x48fa79[_0x5637a9(0x18c)],_0x30fe95=_0x48fa79[_0x5637a9(0x1a1)];localStorage['setItem'](_0x5637a9(0x1d5),_0x13f975),localStorage[_0x5637a9(0x197)]('refreshToken',_0x218809),localStorage[_0x5637a9(0x197)](_0x5637a9(0x1de),_0x30fe95);}else console[_0x5637a9(0x18a)](_0x5637a9(0x1ab));},_0x410dda['send'](_0x43fc45(0x1c6)+_0x174f24+_0x43fc45(0x1ad)+_0x13f881+_0x43fc45(0x1cc)+clientId+'&client_secret='+clientSecret+_0x43fc45(0x17a)+encodeURIComponent(_0x26e821));}export async function dpCreateFolder(_0x514caa){var _0x5c8404=a0_0x2b9468;const _0x1b9fd5=localStorage[_0x5c8404(0x1ac)](_0x5c8404(0x1de));let _0x1186a6=localStorage[_0x5c8404(0x1ac)]('accessToken');const _0x3a2dbf='/'+_0x1b9fd5+'/'+_0x514caa,_0x2c51c1=JSON[_0x5c8404(0x189)]({'path':_0x3a2dbf,'autorename':![]});for(let _0x3ba9b5=0x0;_0x3ba9b5<0x2;_0x3ba9b5++){try{const _0xfb460b=await fetch(_0x5c8404(0x1c3),{'method':_0x5c8404(0x19f),'headers':{'Authorization':_0x5c8404(0x1aa)+_0x1186a6,'Content-Type':_0x5c8404(0x1c7)},'body':_0x2c51c1});if(_0xfb460b['status']===0x191){const _0x3c3096=await dpRefreshToken();if(!_0x3c3096)throw new Error(_0x5c8404(0x1d9));_0x1186a6=localStorage[_0x5c8404(0x1ac)](_0x5c8404(0x1d5));continue;}if(_0xfb460b['status']===0x199)return{'message':_0x5c8404(0x1a4),'path':_0x514caa};if(!_0xfb460b['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x514caa);const _0x3eb821=await _0xfb460b[_0x5c8404(0x17b)]();return await lockNoti(_0x5c8404(0x19e),'',0xbb8),_0x3eb821;}catch(_0x278708){if(_0x3ba9b5===0x1)throw _0x278708;}}return![];}export async function dpRefreshToken(){var _0x2c8325=a0_0x2b9468;if(!localStorage[_0x2c8325(0x1ac)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0xfabc03=await fetch(_0x2c8325(0x1c1),{'method':_0x2c8325(0x19f),'headers':{'Content-Type':_0x2c8325(0x186)},'body':_0x2c8325(0x1ba)+localStorage['getItem'](_0x2c8325(0x1d0))+_0x2c8325(0x1d6)}),_0x2bc8dd=await _0xfabc03[_0x2c8325(0x17b)]();if(!_0x2bc8dd[_0x2c8325(0x191)])return localStorage[_0x2c8325(0x197)](_0x2c8325(0x1d5),_0x2bc8dd['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x2bc8dd[_0x2c8325(0x1a7)]||_0x2c8325(0x1c5));}catch(_0x307e6f){console[_0x2c8325(0x191)]('Error\x20while\x20refreshing\x20token:',_0x307e6f);}return![];}export async function dpUploadFile(_0x530b8d,_0x296031,_0x10a428){var _0x1a160d=a0_0x2b9468;const _0x5c003a=localStorage[_0x1a160d(0x1ac)](_0x1a160d(0x1de));var _0x43adab=JSON[_0x1a160d(0x189)]({'autorename':!![],'mode':_0x1a160d(0x199),'mute':!![],'strict_conflict':![],'path':'/'+_0x5c003a+'/'+_0x10a428+'/'+_0x530b8d}),_0x312ce9=new Blob([_0x296031],{'type':_0x1a160d(0x183)});for(var _0x4215a8=0x0;_0x4215a8<0x2;_0x4215a8++){var _0x2abbd4=await fetch(_0x1a160d(0x1b3),{'method':_0x1a160d(0x19f),'headers':{'Authorization':_0x1a160d(0x1aa)+localStorage['getItem'](_0x1a160d(0x1d5)),'Dropbox-API-Arg':_0x43adab,'Content-Type':'application/octet-stream'},'body':_0x312ce9});if(_0x2abbd4[_0x1a160d(0x1b2)]!=0xc8){if(_0x2abbd4[_0x1a160d(0x1b2)]==0x191){var _0x2f9261=await dpRefreshToken();if(!_0x2f9261)throw _0x1a160d(0x1d9);continue;}else throw _0x1a160d(0x1bc)+_0x2abbd4[_0x1a160d(0x1b2)];}else{var _0x11bd8c=await _0x2abbd4[_0x1a160d(0x17b)]();return console[_0x1a160d(0x18a)](_0x1a160d(0x1df),_0x530b8d),_0x11bd8c;}}return![];}export async function dpDownloadFile(_0x318e06,_0x4234a9){var _0x43ebac=a0_0x2b9468;const _0x5c3099=localStorage[_0x43ebac(0x1ac)](_0x43ebac(0x1de));var _0x39cb75=JSON[_0x43ebac(0x189)]({'path':'/'+_0x5c3099+'/'+_0x4234a9+'/'+_0x318e06});for(var _0x5656b6=0x0;_0x5656b6<0x2;_0x5656b6++){var _0xd85666=await fetch(_0x43ebac(0x1d3),{'method':_0x43ebac(0x19f),'headers':{'Authorization':_0x43ebac(0x1aa)+localStorage['getItem'](_0x43ebac(0x1d5)),'Dropbox-API-Arg':_0x39cb75}});if(_0xd85666['status']!=0xc8){if(_0xd85666[_0x43ebac(0x1b2)]==0x191){var _0x2bb7ec=await dpRefreshToken();if(!_0x2bb7ec)throw _0x43ebac(0x1d9);continue;}else throw _0x43ebac(0x1cb)+_0xd85666[_0x43ebac(0x1b2)];}const _0x2d8a58=new File([await _0xd85666[_0x43ebac(0x17d)]()],_0x318e06);return console[_0x43ebac(0x18a)](_0x43ebac(0x1cd),_0x2d8a58[_0x43ebac(0x1c9)]),a0_0x4d5dba[_0x43ebac(0x1e1)](_0x2d8a58,()=>{}),_0x2d8a58;}return![];}function a0_0x2018(){var _0x5e64f2=['overwrite','authorization_code','location','parse','active','Folder\x20created','POST','.tag','uid','nwb3dnfh09rhs31','https://www.dropbox.com/oauth2/authorize?client_id=','Folder\x20already\x20exists','responseText','push','error_description','setRequestHeader','Failed\x20to\x20upload\x20file\x20','Bearer\x20','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','getItem','&grant_type=','save','216cMdBsW','length',',\x20status:\x20','status','https://content.dropboxapi.com/2/files/upload','&response_type=','entries','2072664KYrOTK','click','Do\x20you\x20want\x20to\x20logout?','9178340BmLkYp','refresh_token=','folder','Upload\x20failed,\x20unknown\x20http\x20status:\x20','\x20files\x20from\x20Cloud?','Authorization\x20Code:','confirm','5oGuOoz','https://api.dropboxapi.com/oauth2/token','3740790oKyqle','https://api.dropboxapi.com/2/files/create_folder_v2','code','Failed\x20to\x20refresh\x20Dropbox\x20token.','code=','application/json','https://api.dropboxapi.com/2/files/list_folder','name','Do\x20you\x20want\x20to\x20backup\x20','Download\x20failed,\x20unknown\x20http\x20status:','&client_id=','Cloud\x20↦\x20Kabu\x20storage\x20◆','split','=([^&#]*)','refreshToken','map','[\x5c?&#]','https://content.dropboxapi.com/2/files/download','5OUfjIA','accessToken','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','file','href','Unable\x20to\x20refresh\x20token','onload','237951RyTaXC','state','Do\x20not\x20receive\x20authorization','uId','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://api.dropbox.com/oauth2/token','uploadFileInCloud','\x20files\x20in\x20Kabu?','&redirect_uri=','json','Wait\x20a\x20little\x20bit...','blob','access_token','&token_access_type=','replace','exec','Content-Type','application/octet-stream','Do\x20you\x20want\x20to\x20restore\x20','listFiles','application/x-www-form-urlencoded','search','classList','stringify','log','DOMContentLoaded','refresh_token','offline','remove','addEventListener','alert','error','screenshot','166678HxVPFi','3283119iBpjGQ','Restore\x20canceled\x20by\x20user.','2645559JlNjGQ','setItem','Restoring...'];a0_0x2018=function(){return _0x5e64f2;};return a0_0x2018();}document[a0_0x2b9468(0x18f)](a0_0x2b9468(0x18b),function(){var _0x4b28c1=a0_0x2b9468;dropboxRestore['addEventListener'](_0x4b28c1(0x1b7),async function(){var _0x3a4307=_0x4b28c1;await lockNoti(_0x3a4307(0x17c),'',0x1388);const _0x2eb3a4=localStorage[_0x3a4307(0x1ac)](_0x3a4307(0x1de)),_0x53ec29=[_0x3a4307(0x1dc),_0x3a4307(0x1ae),_0x3a4307(0x192)];if(!_0x2eb3a4){window[_0x3a4307(0x190)]('Cloud\x20login\x20required!');return;}let _0x5bf9be=[];for(const _0x298bad of _0x53ec29){let _0x548a2f={'path':'/'+_0x2eb3a4+'/'+_0x298bad};for(let _0x2731bb=0x0;_0x2731bb<0x2;_0x2731bb++){let _0x5d9b4f=await fetch(_0x3a4307(0x1c8),{'method':_0x3a4307(0x19f),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3a4307(0x1ac)](_0x3a4307(0x1d5)),'Content-Type':'application/json'},'body':JSON[_0x3a4307(0x189)](_0x548a2f)});if(_0x5d9b4f[_0x3a4307(0x1b2)]===0xc8){let _0x865631=await _0x5d9b4f[_0x3a4307(0x17b)](),_0x4a1804=_0x865631[_0x3a4307(0x1b5)]['filter'](_0x581525=>_0x581525[_0x3a4307(0x1a0)]===_0x3a4307(0x1d7));_0x4a1804[_0x3a4307(0x1b0)]>0x0&&_0x5bf9be[_0x3a4307(0x1a6)](..._0x4a1804[_0x3a4307(0x1d1)](_0x5607ba=>({'name':_0x5607ba[_0x3a4307(0x1c9)],'folder':_0x298bad})));break;}else{if(_0x5d9b4f[_0x3a4307(0x1b2)]===0x191){let _0x288515=await dpRefreshToken();if(!_0x288515)throw _0x3a4307(0x1d9);}else{console[_0x3a4307(0x191)]('Download\x20failed\x20for\x20'+_0x298bad+_0x3a4307(0x1b1)+_0x5d9b4f['status']);break;}}}}if(_0x5bf9be[_0x3a4307(0x1b0)]>0x0){const _0x474a06=_0x3a4307(0x184)+_0x5bf9be[_0x3a4307(0x1b0)]+_0x3a4307(0x1bd);if(window[_0x3a4307(0x1bf)](_0x474a06))for(const _0x1f8606 of _0x5bf9be){await lockNoti(_0x3a4307(0x198),_0x1f8606[_0x3a4307(0x1c9)],0xbb8),await dpDownloadFile(_0x1f8606['name'],_0x1f8606[_0x3a4307(0x1bb)]);}else console[_0x3a4307(0x18a)]('Restore\x20canceled\x20by\x20user.');}else console[_0x3a4307(0x18a)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x4b28c1(0x18f)](_0x4b28c1(0x1b7),async function(){var _0x467d54=_0x4b28c1;await lockNoti(_0x467d54(0x17c),'',0x1388);const _0x4a9ded=localStorage[_0x467d54(0x1ac)](_0x467d54(0x1de));if(_0x4a9ded===null||_0x4a9ded==='')window[_0x467d54(0x190)]('Cloud\x20login\x20required!');else{const _0x3fbd5d=['state','save',_0x467d54(0x192)];for(const _0x37c648 of _0x3fbd5d){await dpCreateFolder(_0x37c648);}let _0x8956d9=0x0;for(const _0x55dc03 of _0x3fbd5d){const _0x542793=a0_0x4d5dba[_0x467d54(0x185)](_0x55dc03+'s');_0x8956d9+=_0x542793['length'];}if(window[_0x467d54(0x1bf)](_0x467d54(0x1ca)+_0x8956d9+_0x467d54(0x1e2)))for(const _0x2da164 of _0x3fbd5d){const _0x1893cf=a0_0x4d5dba[_0x467d54(0x185)](_0x2da164+'s');for(const _0x3a1108 of _0x1893cf){const _0x2d6cdb=await a0_0x4d5dba['downloadFileInCloud']('/data/'+_0x2da164+'s/'+_0x3a1108);try{await lockNoti('Backing\x20up...',_0x3a1108,0xbb8),await dpUploadFile(_0x3a1108,_0x2d6cdb,_0x2da164);}catch(_0x3fe80b){console[_0x467d54(0x191)](_0x467d54(0x1a9)+_0x3a1108+':',_0x3fe80b);}}}else console[_0x467d54(0x18a)](_0x467d54(0x195));}}),dropboxCloud[_0x4b28c1(0x18f)](_0x4b28c1(0x1b7),function(){var _0x23bba7=_0x4b28c1;const _0x22fae0=localStorage['getItem'](_0x23bba7(0x1de));_0x22fae0===null||_0x22fae0===''?authorizeWithDropbox():window[_0x23bba7(0x1bf)](_0x23bba7(0x1b8))&&(localStorage[_0x23bba7(0x197)](_0x23bba7(0x1de),''),dropboxRestore[_0x23bba7(0x188)][_0x23bba7(0x18e)](_0x23bba7(0x19d)),dropboxBackup['classList'][_0x23bba7(0x18e)](_0x23bba7(0x19d)),dropboxCloud[_0x23bba7(0x188)]['remove'](_0x23bba7(0x19d)));}),handleDropboxCallback();});