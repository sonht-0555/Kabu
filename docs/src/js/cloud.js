var a0_0x458b83=a0_0x16b8;(function(_0x468348,_0x395c6c){var _0x5a5c52=a0_0x16b8,_0x563b24=_0x468348();while(!![]){try{var _0x323d32=parseInt(_0x5a5c52(0x20f))/0x1*(parseInt(_0x5a5c52(0x234))/0x2)+parseInt(_0x5a5c52(0x21a))/0x3*(parseInt(_0x5a5c52(0x1c7))/0x4)+parseInt(_0x5a5c52(0x1e6))/0x5*(-parseInt(_0x5a5c52(0x239))/0x6)+parseInt(_0x5a5c52(0x20e))/0x7*(-parseInt(_0x5a5c52(0x1d7))/0x8)+-parseInt(_0x5a5c52(0x1e8))/0x9*(-parseInt(_0x5a5c52(0x211))/0xa)+parseInt(_0x5a5c52(0x1d2))/0xb+parseInt(_0x5a5c52(0x216))/0xc*(-parseInt(_0x5a5c52(0x22e))/0xd);if(_0x323d32===_0x395c6c)break;else _0x563b24['push'](_0x563b24['shift']());}catch(_0x48bf03){_0x563b24['push'](_0x563b24['shift']());}}}(a0_0x3bae,0xeb024));import*as a0_0x270da1 from'./main.js';function a0_0x3bae(){var _0x13f0ac=['2270166jTICtE','search','.ss5','file','confirm','2884opZrVU','Restore\x20canceled\x20by\x20user.','endsWith','lastIndexOf','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Backing\x20up...','toUpperCase','uId','setItem','text','active','1048905Sfvisa','error_description','https://api.dropboxapi.com/oauth2/token','.ss6','stringify','496HBgeYZ','https://api.dropboxapi.com/2/files/list_folder','remove','Failed\x20to\x20upload\x20file\x20','uploadSaveOrSaveState','parse','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Upload\x20failed,\x20unknown\x20http\x20status:\x20','blob','FSSync','split','&client_id=','knh3uz2mx2hp2eu','length','slice','5mhDaST','getItem','18450EIRqrL','json','=([^&#]*)','text/plain','addEventListener','state','.ss0','&client_secret=','refresh_token=','/data/','&token_access_type=','.ss2','Error\x20while\x20refreshing\x20token:','setRequestHeader','substring','[\x5c?&#]','Failed\x20to\x20refresh\x20Dropbox\x20token.','Content-Type','application/x-www-form-urlencoded','https://www.dropbox.com/oauth2/authorize?client_id=','send','status:\x20','downloadFileInCloud','https://content.dropboxapi.com/2/files/download','.ss4','\x20files\x20in\x20Kabu?','onload','&redirect_uri=','code=','click','nwb3dnfh09rhs31','POST','\x20files\x20in\x20Cloud?','.txt','exec','error','No\x20refresh\x20token','Cloud\x20login\x20required!','43064SzUYQy','95721nOIwhK','.gba_slot','6290szQBif','refreshToken','DOMContentLoaded','classList','Do\x20you\x20want\x20to\x20restore\x20','48eiJqyl','Download\x20failed,\x20unknown\x20http\x20status:\x20','href','charAt','2283QWpVdS','name','Download\x20failed,\x20unknown\x20http\x20status:','application/octet-stream','filter','Cloud\x20↦\x20Kabu\x20storage\x20◆','save','responseText','Unable\x20to\x20refresh\x20token','Refreshing\x20token...','Authorization\x20Code:','access_token','.ss1','list','Do\x20not\x20receive\x20authorization','replace','code','alert','Do\x20you\x20want\x20to\x20logout?','accessToken','6596863kTXjAp','.tag','log','location','overwrite','open','38NbJoKn','status','.gba_dateState','Bearer\x20','gba'];a0_0x3bae=function(){return _0x13f0ac;};return a0_0x3bae();}import{localStorageFile}from'./storage.js';var clientId=a0_0x458b83(0x1e3),clientSecret=a0_0x458b83(0x206);function a0_0x16b8(_0x52071e,_0x3d2f6d){var _0x3bae25=a0_0x3bae();return a0_0x16b8=function(_0x16b85e,_0x2e6201){_0x16b85e=_0x16b85e-0x1c7;var _0x2842a8=_0x3bae25[_0x16b85e];return _0x2842a8;},a0_0x16b8(_0x52071e,_0x3d2f6d);}function authorizeWithDropbox(){var _0x111322=a0_0x458b83,_0x45cf61=window[_0x111322(0x231)][_0x111322(0x218)][_0x111322(0x1e1)]('?')[0x0],_0x4ace45=_0x111322(0x22a),_0x37ea40='offline',_0x15eec1=_0x111322(0x1fb)+clientId+'&response_type='+_0x4ace45+_0x111322(0x1f2)+_0x37ea40+_0x111322(0x203)+encodeURIComponent(_0x45cf61);window[_0x111322(0x231)]['href']=_0x15eec1;}function handleDropboxCallback(){var _0x45751f=a0_0x458b83,_0x4553d8=getUrlParameter(_0x45751f(0x22a));_0x4553d8?(getAccessToken(_0x4553d8),console['log'](_0x45751f(0x224),_0x4553d8)):console[_0x45751f(0x230)](_0x45751f(0x228));}function getUrlParameter(_0xe89462){var _0x27fc9f=a0_0x458b83;_0xe89462=_0xe89462['replace'](/[\[]/,'\x5c[')[_0x27fc9f(0x229)](/[\]]/,'\x5c]');var _0x2143f7=new RegExp(_0x27fc9f(0x1f7)+_0xe89462+_0x27fc9f(0x1ea)),_0x5e0525=_0x2143f7[_0x27fc9f(0x20a)](location[_0x27fc9f(0x23a)]);return _0x5e0525===null?'':decodeURIComponent(_0x5e0525[0x1][_0x27fc9f(0x229)](/\+/g,'\x20'));}function getAccessToken(_0x32a57e){var _0x46ec42=a0_0x458b83,_0x4b59fd='authorization_code',_0x244a18=window['location'][_0x46ec42(0x218)]['split']('?')[0x0],_0x30ceef=new XMLHttpRequest();_0x30ceef[_0x46ec42(0x233)](_0x46ec42(0x207),'https://api.dropbox.com/oauth2/token'),_0x30ceef[_0x46ec42(0x1f5)](_0x46ec42(0x1f9),_0x46ec42(0x1fa)),_0x30ceef[_0x46ec42(0x202)]=function(){var _0x5f0cde=_0x46ec42;if(_0x30ceef['status']===0xc8){var _0x301f7e=JSON[_0x5f0cde(0x1dc)](_0x30ceef[_0x5f0cde(0x221)]),_0x397c0e=_0x301f7e[_0x5f0cde(0x225)],_0x2ada9c=_0x301f7e['refresh_token'],_0x393cf8=_0x301f7e['uid'];localStorage[_0x5f0cde(0x1cf)](_0x5f0cde(0x22d),_0x397c0e),localStorage[_0x5f0cde(0x1cf)](_0x5f0cde(0x212),_0x2ada9c),localStorage[_0x5f0cde(0x1cf)](_0x5f0cde(0x1ce),_0x393cf8);}else console[_0x5f0cde(0x230)](_0x5f0cde(0x1cb));},_0x30ceef[_0x46ec42(0x1fc)](_0x46ec42(0x204)+_0x32a57e+'&grant_type='+_0x4b59fd+_0x46ec42(0x1e2)+clientId+_0x46ec42(0x1ef)+clientSecret+_0x46ec42(0x203)+encodeURIComponent(_0x244a18));}export async function dpRefreshToken(){var _0x34a253=a0_0x458b83;if(!localStorage[_0x34a253(0x1e7)](_0x34a253(0x212)))throw _0x34a253(0x20c);try{const _0x39d7e4=await fetch(_0x34a253(0x1d4),{'method':_0x34a253(0x207),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x34a253(0x1f0)+localStorage['getItem'](_0x34a253(0x212))+_0x34a253(0x1dd)}),_0x3effe0=await _0x39d7e4[_0x34a253(0x1e9)]();if(!_0x3effe0[_0x34a253(0x20b)])return localStorage[_0x34a253(0x1cf)]('accessToken',_0x3effe0[_0x34a253(0x225)]),await lockNoti('',_0x34a253(0x223),0xbb8),await delay(0x3e8),!![];else alert(_0x3effe0[_0x34a253(0x1d3)]||_0x34a253(0x1f8));}catch(_0x124d09){console[_0x34a253(0x20b)](_0x34a253(0x1f4),_0x124d09);}return![];}export async function dpUploadFile(_0x5f0e85,_0x3cb7ad){var _0x6d89e4=a0_0x458b83;const _0x4bd44c=localStorage['getItem'](_0x6d89e4(0x1ce));var _0x334a03=JSON['stringify']({'autorename':!![],'mode':_0x6d89e4(0x232),'mute':!![],'strict_conflict':![],'path':'/'+_0x4bd44c+'/'+_0x5f0e85}),_0x451be1=new Blob([_0x3cb7ad],{'type':'application/octet-stream'});for(var _0x5516b0=0x0;_0x5516b0<0x2;_0x5516b0++){var _0x255f88=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x6d89e4(0x237)+localStorage[_0x6d89e4(0x1e7)]('accessToken'),'Dropbox-API-Arg':_0x334a03,'Content-Type':_0x6d89e4(0x21d)},'body':_0x451be1});if(_0x255f88[_0x6d89e4(0x235)]!=0xc8){if(_0x255f88[_0x6d89e4(0x235)]==0x191){var _0x5caf7b=await dpRefreshToken();if(!_0x5caf7b)throw _0x6d89e4(0x222);continue;}else throw _0x6d89e4(0x1de)+_0x255f88[_0x6d89e4(0x235)];}else{var _0x161e2a=await _0x255f88[_0x6d89e4(0x1e9)]();return console[_0x6d89e4(0x230)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x5f0e85),_0x161e2a;}}return![];}async function dpDownloadFile(_0x435ed8){var _0x5952de=a0_0x458b83;const _0x52a474=localStorage[_0x5952de(0x1e7)](_0x5952de(0x1ce));var _0x875b1=JSON[_0x5952de(0x1d6)]({'path':'/'+_0x52a474+'/'+_0x435ed8});for(var _0x4c3527=0x0;_0x4c3527<0x2;_0x4c3527++){var _0x27a8ed=await fetch(_0x5952de(0x1ff),{'method':_0x5952de(0x207),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x5952de(0x22d)),'Dropbox-API-Arg':_0x875b1}});if(_0x27a8ed['status']!=0xc8){if(_0x27a8ed[_0x5952de(0x235)]==0x191){var _0x4d8c67=await dpRefreshToken();if(!_0x4d8c67)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5952de(0x21c)+_0x27a8ed[_0x5952de(0x235)];}const _0x14bfce=new File([await _0x27a8ed[_0x5952de(0x1df)]()],_0x435ed8);console['log'](_0x5952de(0x21f),_0x14bfce[_0x5952de(0x21b)]);if(_0x435ed8['endsWith'](_0x5952de(0x209))){const _0x2a22e5=await _0x14bfce[_0x5952de(0x1d0)](),[_0x31e279,_0x2603ac]=_0x2a22e5[_0x5952de(0x1e1)]('\x0a\x0a'),_0x5a6686=_0x435ed8['substring'](0x0,_0x435ed8[_0x5952de(0x1ca)](_0x5952de(0x238))+0x3),_0x2e5d44=_0x435ed8[_0x5952de(0x219)](_0x435ed8[_0x5952de(0x1e4)]-0x5);localStorage[_0x5952de(0x1cf)](_0x5a6686+'_dateState'+_0x2e5d44,_0x2603ac),localStorage[_0x5952de(0x1cf)](_0x5a6686+'_imageState'+_0x2e5d44,_0x31e279);}else a0_0x270da1[_0x5952de(0x1db)](_0x14bfce,()=>{var _0x5a6e7a=_0x5952de;localStorageFile(),Module[_0x5a6e7a(0x1e0)]();});return _0x14bfce;}return![];}document[a0_0x458b83(0x1ec)](a0_0x458b83(0x213),function(){var _0x2260c5=a0_0x458b83;dropboxRestore[_0x2260c5(0x1ec)]('click',async function(){var _0x9c6f6e=_0x2260c5;const _0x37d9d5=localStorage[_0x9c6f6e(0x1e7)](_0x9c6f6e(0x1ce));if(_0x37d9d5===null||_0x37d9d5==='')window['alert'](_0x9c6f6e(0x20d));else{var _0x234481={'path':'/'+_0x37d9d5};for(var _0x2fe683=0x0;_0x2fe683<0x2;_0x2fe683++){var _0x4c7de3=await fetch(_0x9c6f6e(0x1d8),{'method':_0x9c6f6e(0x207),'headers':{'Authorization':_0x9c6f6e(0x237)+localStorage[_0x9c6f6e(0x1e7)](_0x9c6f6e(0x22d)),'Content-Type':'application/json'},'body':JSON[_0x9c6f6e(0x1d6)](_0x234481)});console[_0x9c6f6e(0x230)](_0x9c6f6e(0x1fd),_0x4c7de3[_0x9c6f6e(0x235)]);if(_0x4c7de3['status']!=0xc8){if(_0x4c7de3[_0x9c6f6e(0x235)]==0x191){var _0x3b728c=await dpRefreshToken();if(!_0x3b728c)throw _0x9c6f6e(0x222);continue;}else throw _0x9c6f6e(0x217)+_0x4c7de3[_0x9c6f6e(0x235)];}else{const _0x275979=await _0x4c7de3[_0x9c6f6e(0x1e9)](),_0x542267=_0x275979['entries'][_0x9c6f6e(0x21e)](_0x159db0=>_0x159db0['.tag']===_0x9c6f6e(0x23c))[_0x9c6f6e(0x1e4)],_0x4ef3e3=_0x9c6f6e(0x215)+_0x542267+_0x9c6f6e(0x208);if(window[_0x9c6f6e(0x23d)](_0x4ef3e3))for(const _0x15c335 of _0x275979['entries']){_0x15c335[_0x9c6f6e(0x22f)]===_0x9c6f6e(0x23c)&&(await lockNoti('Restoring...',_0x15c335[_0x9c6f6e(0x21b)],0xbb8),await dpDownloadFile(_0x15c335[_0x9c6f6e(0x21b)]));}else console['log'](_0x9c6f6e(0x1c8));return!![];}}return![];}}),dropboxBackup[_0x2260c5(0x1ec)](_0x2260c5(0x205),async function(){var _0x2bd326=_0x2260c5;const _0x24f01d=localStorage[_0x2bd326(0x1e7)]('uId');if(_0x24f01d===null||_0x24f01d==='')window[_0x2bd326(0x22b)]('Cloud\x20login\x20required!');else{const _0x22b17b=[_0x2bd326(0x1ed),_0x2bd326(0x220)];let _0x2586d8=0x0;for(const _0x5522ff of _0x22b17b){const _0x5727e3=a0_0x270da1['list'+(_0x5522ff[_0x2bd326(0x219)](0x0)['toUpperCase']()+_0x5522ff['slice'](0x1))]();_0x2586d8+=_0x5727e3[_0x2bd326(0x1e4)];}if(window[_0x2bd326(0x23d)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x2586d8+_0x2bd326(0x201)))for(const _0x33a242 of _0x22b17b){const _0x171af9=a0_0x270da1[_0x2bd326(0x227)+(_0x33a242[_0x2bd326(0x219)](0x0)[_0x2bd326(0x1cd)]()+_0x33a242[_0x2bd326(0x1e5)](0x1))]();for(const _0x1bd493 of _0x171af9){const _0x18365b=await a0_0x270da1[_0x2bd326(0x1fe)](_0x2bd326(0x1f1)+_0x33a242+'s/'+_0x1bd493);try{await lockNoti(_0x2bd326(0x1cc),_0x1bd493,0xbb8),await dpUploadFile(_0x1bd493,_0x18365b);if(_0x1bd493[_0x2bd326(0x1c9)](_0x2bd326(0x1ee))||_0x1bd493['endsWith'](_0x2bd326(0x226))||_0x1bd493[_0x2bd326(0x1c9)](_0x2bd326(0x1f3))||_0x1bd493[_0x2bd326(0x1c9)]('.ss3')||_0x1bd493['endsWith'](_0x2bd326(0x200))||_0x1bd493[_0x2bd326(0x1c9)](_0x2bd326(0x23b))||_0x1bd493[_0x2bd326(0x1c9)](_0x2bd326(0x1d5))||_0x1bd493[_0x2bd326(0x1c9)]('.ss7')){const _0x170e14=_0x1bd493[_0x2bd326(0x1f6)](0x0,_0x1bd493[_0x2bd326(0x1ca)]('.')),_0xdff469=_0x1bd493[_0x2bd326(0x219)](_0x1bd493['length']-0x1),_0x4b17cb=localStorage[_0x2bd326(0x1e7)](_0x170e14+'.gba_imageState'+_0xdff469),_0x3af4d1=localStorage[_0x2bd326(0x1e7)](_0x170e14+_0x2bd326(0x236)+_0xdff469);if(_0x4b17cb!==null){const _0x234fb8=_0x4b17cb+'\x0a\x0a'+_0x3af4d1,_0x59d37e=new Blob([_0x234fb8],{'type':_0x2bd326(0x1eb)});await lockNoti(_0x2bd326(0x1cc),_0x170e14+_0x2bd326(0x210)+_0xdff469+_0x2bd326(0x209),0xbb8),await dpUploadFile(_0x170e14+_0x2bd326(0x210)+_0xdff469+_0x2bd326(0x209),_0x59d37e);}}}catch(_0x5b1216){console['error'](_0x2bd326(0x1da)+_0x1bd493+':',_0x5b1216);}}}else console['log'](_0x2bd326(0x1c8));}}),dropboxCloud[_0x2260c5(0x1ec)]('click',function(){var _0x191ab2=_0x2260c5;const _0x387c6d=localStorage[_0x191ab2(0x1e7)](_0x191ab2(0x1ce));_0x387c6d===null||_0x387c6d===''?authorizeWithDropbox():window[_0x191ab2(0x23d)](_0x191ab2(0x22c))&&(localStorage[_0x191ab2(0x1cf)](_0x191ab2(0x1ce),''),dropboxRestore['classList'][_0x191ab2(0x1d9)](_0x191ab2(0x1d1)),dropboxBackup[_0x191ab2(0x214)][_0x191ab2(0x1d9)](_0x191ab2(0x1d1)),dropboxCloud['classList'][_0x191ab2(0x1d9)](_0x191ab2(0x1d1)));}),handleDropboxCallback();});