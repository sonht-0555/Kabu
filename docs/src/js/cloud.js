var a0_0x15e2c3=a0_0x3229;function a0_0x5661(){var _0x2e59f8=['uid','refresh_token=','Restoring...','search','Do\x20you\x20want\x20to\x20restore\x20','state','location','file','https://api.dropboxapi.com/oauth2/token','open','10568iuLQUU','remove','length','1593SFgRKq','save','Do\x20not\x20receive\x20authorization','slice','code','split','charAt','https://www.dropbox.com/oauth2/authorize?client_id=','&redirect_uri=','2428045jclhaz','json','https://content.dropboxapi.com/2/files/download','confirm','blob','6zZgfIp','Error\x20creating\x20folder\x20','parse','list','Folder\x20already\x20exists','https://api.dropboxapi.com/2/files/create_folder_v2','/data/','=([^&#]*)','https://api.dropboxapi.com/2/files/list_folder','Cloud\x20login\x20required!','filter','responseText','Do\x20you\x20want\x20to\x20logout?','alert','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Bearer\x20','5081082gBgoEf','setItem','accessToken','active','access_token','POST','uId','entries','Wait\x20a\x20little\x20bit...','Unable\x20to\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','toUpperCase','log','knh3uz2mx2hp2eu','code=','Folder\x20created','application/x-www-form-urlencoded','addEventListener','push','277947AhvEQv','Error\x20while\x20refreshing\x20token:','Content-Type','uploadFileInCloud','8iSnBGE','23863060psbbTY','replace','send','downloadFileInCloud','error','application/json','classList','[\x5c?&#]','stringify','Backing\x20up...','Kabu\x20storage\x20↦\x20Cloud\x20◆','Restore\x20canceled\x20by\x20user.','10400761BRVwPx','Cloud\x20↦\x20Kabu\x20storage\x20◆','Refreshing\x20token...','788966iJSRrx','nwb3dnfh09rhs31','onload','No\x20refresh\x20token','getItem','Authorization\x20Code:','DOMContentLoaded','click','status','overwrite','offline','&client_id=','refreshToken','\x20files\x20from\x20Cloud?','Failed\x20to\x20upload\x20file\x20',',\x20status:\x20','href','name','screenshot','map'];a0_0x5661=function(){return _0x2e59f8;};return a0_0x5661();}(function(_0x173b1e,_0x7a3c6c){var _0x1709db=a0_0x3229,_0x288ddb=_0x173b1e();while(!![]){try{var _0x4e0869=parseInt(_0x1709db(0x1fc))/0x1+parseInt(_0x1709db(0x210))/0x2*(-parseInt(_0x1709db(0x1d9))/0x3)+parseInt(_0x1709db(0x200))/0x4*(parseInt(_0x1709db(0x1d4))/0x5)+-parseInt(_0x1709db(0x1e9))/0x6+-parseInt(_0x1709db(0x20d))/0x7+-parseInt(_0x1709db(0x1c8))/0x8*(-parseInt(_0x1709db(0x1cb))/0x9)+parseInt(_0x1709db(0x201))/0xa;if(_0x4e0869===_0x7a3c6c)break;else _0x288ddb['push'](_0x288ddb['shift']());}catch(_0x5af022){_0x288ddb['push'](_0x288ddb['shift']());}}}(a0_0x5661,0xb6884));function a0_0x3229(_0x286546,_0x215f55){var _0x56618a=a0_0x5661();return a0_0x3229=function(_0x3229f8,_0x5143dc){_0x3229f8=_0x3229f8-0x1c3;var _0x501198=_0x56618a[_0x3229f8];return _0x501198;},a0_0x3229(_0x286546,_0x215f55);}import*as a0_0xbab4d4 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x15e2c3(0x1f6),clientSecret=a0_0x15e2c3(0x211);function authorizeWithDropbox(){var _0x4e6119=a0_0x15e2c3,_0x3d723e=window[_0x4e6119(0x1c4)][_0x4e6119(0x220)][_0x4e6119(0x1d0)]('?')[0x0],_0x325906=_0x4e6119(0x1cf),_0x49f243=_0x4e6119(0x21a),_0x11a78e=_0x4e6119(0x1d2)+clientId+'&response_type='+_0x325906+'&token_access_type='+_0x49f243+_0x4e6119(0x1d3)+encodeURIComponent(_0x3d723e);window[_0x4e6119(0x1c4)][_0x4e6119(0x220)]=_0x11a78e;}function handleDropboxCallback(){var _0x444090=a0_0x15e2c3,_0xc4fc5f=getUrlParameter(_0x444090(0x1cf));_0xc4fc5f?(getAccessToken(_0xc4fc5f),console[_0x444090(0x1f5)](_0x444090(0x215),_0xc4fc5f)):console[_0x444090(0x1f5)](_0x444090(0x1cd));}function getUrlParameter(_0x2d1516){var _0xe7d50f=a0_0x15e2c3;_0x2d1516=_0x2d1516[_0xe7d50f(0x202)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2e7ee4=new RegExp(_0xe7d50f(0x208)+_0x2d1516+_0xe7d50f(0x1e0)),_0x3977fe=_0x2e7ee4['exec'](location[_0xe7d50f(0x227)]);return _0x3977fe===null?'':decodeURIComponent(_0x3977fe[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x598b0d){var _0xe95bd8=a0_0x15e2c3,_0x1be8d2='authorization_code',_0x524462=window[_0xe95bd8(0x1c4)][_0xe95bd8(0x220)][_0xe95bd8(0x1d0)]('?')[0x0],_0x4c81f0=new XMLHttpRequest();_0x4c81f0[_0xe95bd8(0x1c7)]('POST','https://api.dropbox.com/oauth2/token'),_0x4c81f0['setRequestHeader'](_0xe95bd8(0x1fe),'application/x-www-form-urlencoded'),_0x4c81f0[_0xe95bd8(0x212)]=function(){var _0x3589a5=_0xe95bd8;if(_0x4c81f0[_0x3589a5(0x218)]===0xc8){var _0x2a79c2=JSON[_0x3589a5(0x1db)](_0x4c81f0[_0x3589a5(0x1e4)]),_0x265b9d=_0x2a79c2[_0x3589a5(0x1ed)],_0x4220d3=_0x2a79c2['refresh_token'],_0x30fcb4=_0x2a79c2[_0x3589a5(0x224)];localStorage[_0x3589a5(0x1ea)]('accessToken',_0x265b9d),localStorage['setItem'](_0x3589a5(0x21c),_0x4220d3),localStorage['setItem'](_0x3589a5(0x1ef),_0x30fcb4);}else console[_0x3589a5(0x1f5)](_0x3589a5(0x1e7));},_0x4c81f0[_0xe95bd8(0x203)](_0xe95bd8(0x1f7)+_0x598b0d+'&grant_type='+_0x1be8d2+_0xe95bd8(0x21b)+clientId+'&client_secret='+clientSecret+_0xe95bd8(0x1d3)+encodeURIComponent(_0x524462));}export async function dpCreateFolder(_0x395ef3){var _0x4128c5=a0_0x15e2c3;const _0x50d219=localStorage[_0x4128c5(0x214)](_0x4128c5(0x1ef));let _0x141168=localStorage[_0x4128c5(0x214)](_0x4128c5(0x1eb));const _0x293358='/'+_0x50d219+'/'+_0x395ef3,_0x32bad9=JSON[_0x4128c5(0x209)]({'path':_0x293358,'autorename':![]});for(let _0x4f0466=0x0;_0x4f0466<0x2;_0x4f0466++){try{const _0x26c27c=await fetch(_0x4128c5(0x1de),{'method':_0x4128c5(0x1ee),'headers':{'Authorization':_0x4128c5(0x1e8)+_0x141168,'Content-Type':_0x4128c5(0x206)},'body':_0x32bad9});if(_0x26c27c[_0x4128c5(0x218)]===0x191){const _0xe74e8a=await dpRefreshToken();if(!_0xe74e8a)throw new Error(_0x4128c5(0x1f2));_0x141168=localStorage[_0x4128c5(0x214)](_0x4128c5(0x1eb));continue;}if(_0x26c27c['status']===0x199)return{'message':_0x4128c5(0x1dd),'path':_0x395ef3};if(!_0x26c27c['ok'])throw new Error(_0x4128c5(0x1da)+_0x395ef3);const _0x4bf96b=await _0x26c27c[_0x4128c5(0x1d5)]();return await lockNoti(_0x4128c5(0x1f8),'',0xbb8),_0x4bf96b;}catch(_0x5863a3){if(_0x4f0466===0x1)throw _0x5863a3;}}return![];}export async function dpRefreshToken(){var _0x49a3e7=a0_0x15e2c3;if(!localStorage[_0x49a3e7(0x214)](_0x49a3e7(0x21c)))throw _0x49a3e7(0x213);try{const _0x207b8a=await fetch(_0x49a3e7(0x1c6),{'method':'POST','headers':{'Content-Type':_0x49a3e7(0x1f9)},'body':_0x49a3e7(0x225)+localStorage[_0x49a3e7(0x214)](_0x49a3e7(0x21c))+_0x49a3e7(0x1f3)}),_0x2472eb=await _0x207b8a[_0x49a3e7(0x1d5)]();if(!_0x2472eb[_0x49a3e7(0x205)])return localStorage['setItem'](_0x49a3e7(0x1eb),_0x2472eb[_0x49a3e7(0x1ed)]),await lockNoti(_0x49a3e7(0x20f),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2472eb['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x1bd81f){console[_0x49a3e7(0x205)](_0x49a3e7(0x1fd),_0x1bd81f);}return![];}export async function dpUploadFile(_0x5ef6aa,_0x1c7d4a,_0xfe8352){var _0x52797e=a0_0x15e2c3;const _0x51ebf2=localStorage[_0x52797e(0x214)](_0x52797e(0x1ef));var _0xfc31da=JSON[_0x52797e(0x209)]({'autorename':!![],'mode':_0x52797e(0x219),'mute':!![],'strict_conflict':![],'path':'/'+_0x51ebf2+'/'+_0xfe8352+'/'+_0x5ef6aa}),_0x123774=new Blob([_0x1c7d4a],{'type':'application/octet-stream'});for(var _0x4df136=0x0;_0x4df136<0x2;_0x4df136++){var _0x37b77b=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x52797e(0x214)](_0x52797e(0x1eb)),'Dropbox-API-Arg':_0xfc31da,'Content-Type':'application/octet-stream'},'body':_0x123774});if(_0x37b77b[_0x52797e(0x218)]!=0xc8){if(_0x37b77b[_0x52797e(0x218)]==0x191){var _0x173e35=await dpRefreshToken();if(!_0x173e35)throw _0x52797e(0x1f2);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x37b77b[_0x52797e(0x218)];}else{var _0x22d438=await _0x37b77b[_0x52797e(0x1d5)]();return console['log'](_0x52797e(0x20b),_0x5ef6aa),_0x22d438;}}return![];}export async function dpDownloadFile(_0x35ade1,_0x165b91){var _0xfc5903=a0_0x15e2c3;const _0x109a38=localStorage['getItem'](_0xfc5903(0x1ef));var _0x4ec240=JSON[_0xfc5903(0x209)]({'path':'/'+_0x109a38+'/'+_0x165b91+'/'+_0x35ade1});for(var _0x36e23=0x0;_0x36e23<0x2;_0x36e23++){var _0x3e0957=await fetch(_0xfc5903(0x1d6),{'method':_0xfc5903(0x1ee),'headers':{'Authorization':_0xfc5903(0x1e8)+localStorage[_0xfc5903(0x214)]('accessToken'),'Dropbox-API-Arg':_0x4ec240}});if(_0x3e0957['status']!=0xc8){if(_0x3e0957['status']==0x191){var _0x1d343c=await dpRefreshToken();if(!_0x1d343c)throw _0xfc5903(0x1f2);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3e0957[_0xfc5903(0x218)];}const _0x48745c=new File([await _0x3e0957[_0xfc5903(0x1d8)]()],_0x35ade1);return console[_0xfc5903(0x1f5)](_0xfc5903(0x20e),_0x48745c[_0xfc5903(0x221)]),a0_0xbab4d4[_0xfc5903(0x1ff)](_0x48745c,()=>{localStorageFile(),Module['FSSync']();}),_0x48745c;}return![];}document[a0_0x15e2c3(0x1fa)](a0_0x15e2c3(0x216),function(){var _0x2f6c45=a0_0x15e2c3;dropboxRestore[_0x2f6c45(0x1fa)](_0x2f6c45(0x217),async function(){var _0x9fcdc8=_0x2f6c45;await lockNoti(_0x9fcdc8(0x1f1),'',0x1388);const _0x5c5106=localStorage[_0x9fcdc8(0x214)](_0x9fcdc8(0x1ef)),_0x30badd=[_0x9fcdc8(0x1c3),_0x9fcdc8(0x1cc),_0x9fcdc8(0x222)];if(!_0x5c5106){window[_0x9fcdc8(0x1e6)](_0x9fcdc8(0x1e2));return;}let _0x591938=[];for(const _0x2345c3 of _0x30badd){let _0xa067a3={'path':'/'+_0x5c5106+'/'+_0x2345c3};for(let _0x94e5aa=0x0;_0x94e5aa<0x2;_0x94e5aa++){let _0x4a3893=await fetch(_0x9fcdc8(0x1e1),{'method':'POST','headers':{'Authorization':_0x9fcdc8(0x1e8)+localStorage[_0x9fcdc8(0x214)](_0x9fcdc8(0x1eb)),'Content-Type':_0x9fcdc8(0x206)},'body':JSON['stringify'](_0xa067a3)});if(_0x4a3893[_0x9fcdc8(0x218)]===0xc8){let _0x271b6c=await _0x4a3893['json'](),_0x2ee919=_0x271b6c[_0x9fcdc8(0x1f0)][_0x9fcdc8(0x1e3)](_0x13883c=>_0x13883c['.tag']===_0x9fcdc8(0x1c5));_0x2ee919[_0x9fcdc8(0x1ca)]>0x0&&_0x591938[_0x9fcdc8(0x1fb)](..._0x2ee919[_0x9fcdc8(0x223)](_0x2c987c=>({'name':_0x2c987c['name'],'folder':_0x2345c3})));break;}else{if(_0x4a3893['status']===0x191){let _0xba879b=await dpRefreshToken();if(!_0xba879b)throw _0x9fcdc8(0x1f2);}else{console[_0x9fcdc8(0x205)]('Download\x20failed\x20for\x20'+_0x2345c3+_0x9fcdc8(0x21f)+_0x4a3893['status']);break;}}}}if(_0x591938['length']>0x0){const _0x590fcf=_0x9fcdc8(0x228)+_0x591938['length']+_0x9fcdc8(0x21d);if(window[_0x9fcdc8(0x1d7)](_0x590fcf))for(const _0x468f90 of _0x591938){await lockNoti(_0x9fcdc8(0x226),_0x468f90['name'],0xbb8),await dpDownloadFile(_0x468f90['name'],_0x468f90['folder']);}else console[_0x9fcdc8(0x1f5)](_0x9fcdc8(0x20c));}else console[_0x9fcdc8(0x1f5)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x2f6c45(0x1fa)](_0x2f6c45(0x217),async function(){var _0x31542c=_0x2f6c45;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x43daa9=localStorage[_0x31542c(0x214)](_0x31542c(0x1ef));if(_0x43daa9===null||_0x43daa9==='')window[_0x31542c(0x1e6)]('Cloud\x20login\x20required!');else{const _0x54ba00=[_0x31542c(0x1c3),_0x31542c(0x1cc),_0x31542c(0x222)];for(const _0x42acfd of _0x54ba00){await dpCreateFolder(_0x42acfd);}let _0x5626d4=0x0;for(const _0x4a083c of _0x54ba00){const _0x55f615=a0_0xbab4d4[_0x31542c(0x1dc)+(_0x4a083c[_0x31542c(0x1d1)](0x0)[_0x31542c(0x1f4)]()+_0x4a083c[_0x31542c(0x1ce)](0x1))]();_0x5626d4+=_0x55f615[_0x31542c(0x1ca)];}if(window[_0x31542c(0x1d7)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x5626d4+'\x20files\x20in\x20Kabu?'))for(const _0x3f1769 of _0x54ba00){const _0x4ef025=a0_0xbab4d4['list'+(_0x3f1769[_0x31542c(0x1d1)](0x0)[_0x31542c(0x1f4)]()+_0x3f1769[_0x31542c(0x1ce)](0x1))]();for(const _0xfa4510 of _0x4ef025){const _0x7bdcdc=await a0_0xbab4d4[_0x31542c(0x204)](_0x31542c(0x1df)+_0x3f1769+'s/'+_0xfa4510);try{await lockNoti(_0x31542c(0x20a),_0xfa4510,0xbb8),await dpUploadFile(_0xfa4510,_0x7bdcdc,_0x3f1769);}catch(_0x5ef3c3){console['error'](_0x31542c(0x21e)+_0xfa4510+':',_0x5ef3c3);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x2f6c45(0x1fa)](_0x2f6c45(0x217),function(){var _0x4be4bc=_0x2f6c45;const _0x30579e=localStorage[_0x4be4bc(0x214)]('uId');_0x30579e===null||_0x30579e===''?authorizeWithDropbox():window[_0x4be4bc(0x1d7)](_0x4be4bc(0x1e5))&&(localStorage[_0x4be4bc(0x1ea)](_0x4be4bc(0x1ef),''),dropboxRestore['classList'][_0x4be4bc(0x1c9)](_0x4be4bc(0x1ec)),dropboxBackup[_0x4be4bc(0x207)][_0x4be4bc(0x1c9)](_0x4be4bc(0x1ec)),dropboxCloud[_0x4be4bc(0x207)][_0x4be4bc(0x1c9)]('active'));}),handleDropboxCallback();});