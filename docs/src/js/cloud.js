var a0_0x4cbaac=a0_0x3bea;(function(_0x1faf5f,_0x20c136){var _0xa4d64f=a0_0x3bea,_0x1ded4f=_0x1faf5f();while(!![]){try{var _0x300374=parseInt(_0xa4d64f(0x1f7))/0x1+-parseInt(_0xa4d64f(0x204))/0x2*(parseInt(_0xa4d64f(0x20c))/0x3)+-parseInt(_0xa4d64f(0x1e7))/0x4*(parseInt(_0xa4d64f(0x1f6))/0x5)+parseInt(_0xa4d64f(0x207))/0x6*(-parseInt(_0xa4d64f(0x1de))/0x7)+-parseInt(_0xa4d64f(0x1d4))/0x8+parseInt(_0xa4d64f(0x218))/0x9+parseInt(_0xa4d64f(0x22b))/0xa;if(_0x300374===_0x20c136)break;else _0x1ded4f['push'](_0x1ded4f['shift']());}catch(_0x3607da){_0x1ded4f['push'](_0x1ded4f['shift']());}}}(a0_0x15b5,0x9b7c4));import*as a0_0x328dcb from'./main.js';function a0_0x3bea(_0x1605a2,_0x226d3a){var _0x15b5ce=a0_0x15b5();return a0_0x3bea=function(_0x3beae6,_0x406d12){_0x3beae6=_0x3beae6-0x1d3;var _0xa731f7=_0x15b5ce[_0x3beae6];return _0xa731f7;},a0_0x3bea(_0x1605a2,_0x226d3a);}import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x4cbaac(0x219);function authorizeWithDropbox(){var _0x3d37fa=a0_0x4cbaac,_0x3a4366=window[_0x3d37fa(0x227)][_0x3d37fa(0x1ff)][_0x3d37fa(0x206)]('?')[0x0],_0xcdf8d9=_0x3d37fa(0x205),_0x4c6764='offline',_0x31f445=_0x3d37fa(0x1d3)+clientId+_0x3d37fa(0x22e)+_0xcdf8d9+'&token_access_type='+_0x4c6764+'&redirect_uri='+encodeURIComponent(_0x3a4366);window[_0x3d37fa(0x227)]['href']=_0x31f445;}function handleDropboxCallback(){var _0x522442=a0_0x4cbaac,_0x21dedc=getUrlParameter(_0x522442(0x205));_0x21dedc?(getAccessToken(_0x21dedc),console[_0x522442(0x202)](_0x522442(0x211),_0x21dedc)):console[_0x522442(0x202)](_0x522442(0x1df));}function getUrlParameter(_0x31cd21){var _0x7d616a=a0_0x4cbaac;_0x31cd21=_0x31cd21[_0x7d616a(0x1d6)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x46cc53=new RegExp('[\x5c?&#]'+_0x31cd21+_0x7d616a(0x1ea)),_0x4ff51e=_0x46cc53[_0x7d616a(0x1ef)](location['search']);return _0x4ff51e===null?'':decodeURIComponent(_0x4ff51e[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x1a4ea1){var _0x332530=a0_0x4cbaac,_0x3621cf=_0x332530(0x228),_0x5e5a5e=window[_0x332530(0x227)]['href'][_0x332530(0x206)]('?')[0x0],_0x4c61b0=new XMLHttpRequest();_0x4c61b0[_0x332530(0x209)]('POST','https://api.dropbox.com/oauth2/token'),_0x4c61b0['setRequestHeader'](_0x332530(0x1e3),_0x332530(0x1e0)),_0x4c61b0[_0x332530(0x1db)]=function(){var _0x409505=_0x332530;if(_0x4c61b0['status']===0xc8){var _0x32e38d=JSON[_0x409505(0x238)](_0x4c61b0[_0x409505(0x20d)]),_0x22bfff=_0x32e38d[_0x409505(0x200)],_0xef2b07=_0x32e38d[_0x409505(0x1f9)],_0x255c8b=_0x32e38d[_0x409505(0x225)];localStorage['setItem'](_0x409505(0x1d7),_0x22bfff),localStorage[_0x409505(0x234)](_0x409505(0x223),_0xef2b07),localStorage[_0x409505(0x234)](_0x409505(0x229),_0x255c8b);}else console[_0x409505(0x202)](_0x409505(0x236));},_0x4c61b0[_0x332530(0x1fc)]('code='+_0x1a4ea1+_0x332530(0x1d5)+_0x3621cf+_0x332530(0x1e8)+clientId+_0x332530(0x224)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5e5a5e));}export async function dpCreateFolder(_0x13306){var _0x5501a5=a0_0x4cbaac;const _0x4aba18=localStorage[_0x5501a5(0x20e)](_0x5501a5(0x229));let _0x2710eb=localStorage['getItem']('accessToken');const _0x4f956d='/'+_0x4aba18+'/'+_0x13306,_0x1cc492=JSON[_0x5501a5(0x20f)]({'path':_0x4f956d,'autorename':![]});for(let _0x2dd17d=0x0;_0x2dd17d<0x2;_0x2dd17d++){try{const _0x478b2a=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x2710eb,'Content-Type':_0x5501a5(0x1f8)},'body':_0x1cc492});if(_0x478b2a[_0x5501a5(0x226)]===0x191){const _0x351ffb=await dpRefreshToken();if(!_0x351ffb)throw new Error('Unable\x20to\x20refresh\x20token');_0x2710eb=localStorage[_0x5501a5(0x20e)](_0x5501a5(0x1d7));continue;}if(_0x478b2a['status']===0x199)return{'message':_0x5501a5(0x1ec),'path':_0x13306};if(!_0x478b2a['ok'])throw new Error(_0x5501a5(0x1e1)+_0x13306);const _0x55f942=await _0x478b2a[_0x5501a5(0x20b)]();return await lockNoti(_0x5501a5(0x220),'',0xbb8),_0x55f942;}catch(_0x4c1456){if(_0x2dd17d===0x1)throw _0x4c1456;}}return![];}export async function dpRefreshToken(){var _0x3585e7=a0_0x4cbaac;if(!localStorage[_0x3585e7(0x20e)]('refreshToken'))throw _0x3585e7(0x1eb);try{const _0x25fc1c=await fetch(_0x3585e7(0x230),{'method':_0x3585e7(0x1f1),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0x3585e7(0x20e)]('refreshToken')+_0x3585e7(0x1ee)}),_0x3e4c7f=await _0x25fc1c[_0x3585e7(0x20b)]();if(!_0x3e4c7f[_0x3585e7(0x21f)])return localStorage[_0x3585e7(0x234)](_0x3585e7(0x1d7),_0x3e4c7f[_0x3585e7(0x200)]),await lockNoti(_0x3585e7(0x21a),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3e4c7f[_0x3585e7(0x21e)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x232a79){console[_0x3585e7(0x21f)](_0x3585e7(0x232),_0x232a79);}return![];}function a0_0x15b5(){var _0x24465c=['exec','save','POST','https://content.dropboxapi.com/2/files/download','Do\x20you\x20want\x20to\x20logout?','https://api.dropboxapi.com/2/files/list_folder','blob','5KWHUsv','65588CSrCgR','application/json','refresh_token','length','Restore\x20canceled\x20by\x20user.','send','push','list','href','access_token','downloadFileInCloud','log','file','74bVZwFi','code','split','6ZYOtAi','Backing\x20up...','open','confirm','json','96267XyLHWd','responseText','getItem','stringify','screenshot','Authorization\x20Code:','Wait\x20a\x20little\x20bit...','state','Unable\x20to\x20refresh\x20token','toUpperCase','entries','Kabu\x20storage\x20↦\x20Cloud\x20◆','10960506ZsBRUZ','nwb3dnfh09rhs31','Refreshing\x20token...','Download\x20failed,\x20unknown\x20http\x20status:','Cloud\x20login\x20required!','https://content.dropboxapi.com/2/files/upload','error_description','error','Folder\x20created','slice','\x20files\x20from\x20Cloud?','refreshToken','&client_secret=','uid','status','location','authorization_code','uId','name','25228870pcHPBy','Failed\x20to\x20upload\x20file\x20','uploadFileInCloud','&response_type=','FSSync','https://api.dropboxapi.com/oauth2/token','Restoring...','Error\x20while\x20refreshing\x20token:','addEventListener','setItem','overwrite','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','alert','parse','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://www.dropbox.com/oauth2/authorize?client_id=','8083912tLMxNN','&grant_type=','replace','accessToken','charAt',',\x20status:\x20','classList','onload','click','\x20files\x20in\x20Kabu?','5753881kMkNlm','Do\x20not\x20receive\x20authorization','application/x-www-form-urlencoded','Error\x20creating\x20folder\x20','.tag','Content-Type','Bearer\x20','remove','active','598704ooGktZ','&client_id=','folder','=([^&#]*)','No\x20refresh\x20token','Folder\x20already\x20exists','filter','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'];a0_0x15b5=function(){return _0x24465c;};return a0_0x15b5();}export async function dpUploadFile(_0xa70426,_0x6545ce,_0x36b7e7){var _0x5f9ae9=a0_0x4cbaac;const _0x36206c=localStorage['getItem'](_0x5f9ae9(0x229));var _0x8e6e0b=JSON[_0x5f9ae9(0x20f)]({'autorename':!![],'mode':_0x5f9ae9(0x235),'mute':!![],'strict_conflict':![],'path':'/'+_0x36206c+'/'+_0x36b7e7+'/'+_0xa70426}),_0x13d6ad=new Blob([_0x6545ce],{'type':'application/octet-stream'});for(var _0x4b504d=0x0;_0x4b504d<0x2;_0x4b504d++){var _0x3063f7=await fetch(_0x5f9ae9(0x21d),{'method':_0x5f9ae9(0x1f1),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5f9ae9(0x20e)]('accessToken'),'Dropbox-API-Arg':_0x8e6e0b,'Content-Type':'application/octet-stream'},'body':_0x13d6ad});if(_0x3063f7[_0x5f9ae9(0x226)]!=0xc8){if(_0x3063f7[_0x5f9ae9(0x226)]==0x191){var _0x287d98=await dpRefreshToken();if(!_0x287d98)throw _0x5f9ae9(0x214);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3063f7[_0x5f9ae9(0x226)];}else{var _0x32cbd7=await _0x3063f7[_0x5f9ae9(0x20b)]();return console[_0x5f9ae9(0x202)](_0x5f9ae9(0x217),_0xa70426),_0x32cbd7;}}return![];}export async function dpDownloadFile(_0x1c28fd,_0x16a296){var _0x31e64c=a0_0x4cbaac;const _0x11df22=localStorage['getItem'](_0x31e64c(0x229));var _0x3d5817=JSON[_0x31e64c(0x20f)]({'path':'/'+_0x11df22+'/'+_0x16a296+'/'+_0x1c28fd});for(var _0x371fc5=0x0;_0x371fc5<0x2;_0x371fc5++){var _0x54cab5=await fetch(_0x31e64c(0x1f2),{'method':_0x31e64c(0x1f1),'headers':{'Authorization':_0x31e64c(0x1e4)+localStorage[_0x31e64c(0x20e)](_0x31e64c(0x1d7)),'Dropbox-API-Arg':_0x3d5817}});if(_0x54cab5[_0x31e64c(0x226)]!=0xc8){if(_0x54cab5['status']==0x191){var _0x7da570=await dpRefreshToken();if(!_0x7da570)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x31e64c(0x21b)+_0x54cab5[_0x31e64c(0x226)];}const _0x33c118=new File([await _0x54cab5[_0x31e64c(0x1f5)]()],_0x1c28fd);return console[_0x31e64c(0x202)](_0x31e64c(0x239),_0x33c118[_0x31e64c(0x22a)]),a0_0x328dcb[_0x31e64c(0x22d)](_0x33c118,()=>{var _0xcb1be1=_0x31e64c;localStorageFile(),Module[_0xcb1be1(0x22f)]();}),_0x33c118;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x54c19c=a0_0x4cbaac;dropboxRestore[_0x54c19c(0x233)](_0x54c19c(0x1dc),async function(){var _0x27e887=_0x54c19c;await lockNoti(_0x27e887(0x212),'',0x1388);const _0x220f55=localStorage['getItem'](_0x27e887(0x229)),_0x1a123e=[_0x27e887(0x213),_0x27e887(0x1f0),_0x27e887(0x210)];if(!_0x220f55){window[_0x27e887(0x237)](_0x27e887(0x21c));return;}let _0x3df473=[];for(const _0x46c439 of _0x1a123e){let _0x5eebc7={'path':'/'+_0x220f55+'/'+_0x46c439};for(let _0x1be269=0x0;_0x1be269<0x2;_0x1be269++){let _0x46ddca=await fetch(_0x27e887(0x1f4),{'method':_0x27e887(0x1f1),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x27e887(0x1d7)),'Content-Type':_0x27e887(0x1f8)},'body':JSON['stringify'](_0x5eebc7)});if(_0x46ddca[_0x27e887(0x226)]===0xc8){let _0x587d84=await _0x46ddca[_0x27e887(0x20b)](),_0x1b9e21=_0x587d84[_0x27e887(0x216)][_0x27e887(0x1ed)](_0x2c865c=>_0x2c865c[_0x27e887(0x1e2)]===_0x27e887(0x203));_0x1b9e21[_0x27e887(0x1fa)]>0x0&&_0x3df473[_0x27e887(0x1fd)](..._0x1b9e21['map'](_0x5a7ff9=>({'name':_0x5a7ff9[_0x27e887(0x22a)],'folder':_0x46c439})));break;}else{if(_0x46ddca[_0x27e887(0x226)]===0x191){let _0x36c0e4=await dpRefreshToken();if(!_0x36c0e4)throw _0x27e887(0x214);}else{console[_0x27e887(0x21f)]('Download\x20failed\x20for\x20'+_0x46c439+_0x27e887(0x1d9)+_0x46ddca[_0x27e887(0x226)]);break;}}}}if(_0x3df473[_0x27e887(0x1fa)]>0x0){const _0x3e68cf='Do\x20you\x20want\x20to\x20restore\x20'+_0x3df473['length']+_0x27e887(0x222);if(window[_0x27e887(0x20a)](_0x3e68cf))for(const _0x1465ef of _0x3df473){await lockNoti(_0x27e887(0x231),_0x1465ef[_0x27e887(0x22a)],0xbb8),await dpDownloadFile(_0x1465ef[_0x27e887(0x22a)],_0x1465ef[_0x27e887(0x1e9)]);}else console[_0x27e887(0x202)](_0x27e887(0x1fb));}else console[_0x27e887(0x202)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x54c19c(0x233)](_0x54c19c(0x1dc),async function(){var _0x5599b1=_0x54c19c;await lockNoti(_0x5599b1(0x212),'',0x1388);const _0x2555dc=localStorage[_0x5599b1(0x20e)]('uId');if(_0x2555dc===null||_0x2555dc==='')window[_0x5599b1(0x237)](_0x5599b1(0x21c));else{const _0x10de57=[_0x5599b1(0x213),_0x5599b1(0x1f0),_0x5599b1(0x210)];for(const _0x2c1d8a of _0x10de57){await dpCreateFolder(_0x2c1d8a);}let _0x594574=0x0;for(const _0x49501d of _0x10de57){const _0x2cd3f8=a0_0x328dcb[_0x5599b1(0x1fe)+(_0x49501d[_0x5599b1(0x1d8)](0x0)[_0x5599b1(0x215)]()+_0x49501d['slice'](0x1))]();_0x594574+=_0x2cd3f8[_0x5599b1(0x1fa)];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x594574+_0x5599b1(0x1dd)))for(const _0x30fde9 of _0x10de57){const _0xab04b=a0_0x328dcb[_0x5599b1(0x1fe)+(_0x30fde9['charAt'](0x0)[_0x5599b1(0x215)]()+_0x30fde9[_0x5599b1(0x221)](0x1))]();for(const _0x505914 of _0xab04b){const _0x584731=await a0_0x328dcb[_0x5599b1(0x201)]('/data/'+_0x30fde9+'s/'+_0x505914);try{await lockNoti(_0x5599b1(0x208),_0x505914,0xbb8),await dpUploadFile(_0x505914,_0x584731,_0x30fde9);}catch(_0x3235a4){console[_0x5599b1(0x21f)](_0x5599b1(0x22c)+_0x505914+':',_0x3235a4);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x54c19c(0x233)](_0x54c19c(0x1dc),function(){var _0x22e7e0=_0x54c19c;const _0x560f5d=localStorage['getItem'](_0x22e7e0(0x229));_0x560f5d===null||_0x560f5d===''?authorizeWithDropbox():window[_0x22e7e0(0x20a)](_0x22e7e0(0x1f3))&&(localStorage[_0x22e7e0(0x234)](_0x22e7e0(0x229),''),dropboxRestore[_0x22e7e0(0x1da)][_0x22e7e0(0x1e5)]('active'),dropboxBackup[_0x22e7e0(0x1da)][_0x22e7e0(0x1e5)]('active'),dropboxCloud['classList'][_0x22e7e0(0x1e5)](_0x22e7e0(0x1e6)));}),handleDropboxCallback();});