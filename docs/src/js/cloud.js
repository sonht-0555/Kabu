var a0_0x370a3d=a0_0x4d24;function a0_0x2a23(){var _0x5a0756=['application/octet-stream','884240CBoztT','save','application/json','overwrite','blob','application/x-www-form-urlencoded','290fImHAt','Do\x20not\x20receive\x20authorization','status','https://api.dropboxapi.com/2/files/create_folder_v2','Failed\x20to\x20refresh\x20Dropbox\x20token.','folder','send','Bearer\x20','195327jinWex','onload','json','Unable\x20to\x20refresh\x20token','https://api.dropboxapi.com/2/files/list_folder','747388bxTCNF','active','href','Authorization\x20Code:','filter','refresh_token','Restore\x20canceled\x20by\x20user.','https://content.dropboxapi.com/2/files/upload','remove','583344TlrBNR','Cloud\x20login\x20required!','error','Folder\x20created','\x20files\x20from\x20Cloud?','classList','&redirect_uri=','replace','&grant_type=','No\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','getItem','Failed\x20to\x20upload\x20file\x20','uId','&client_secret=','code=','Error\x20while\x20refreshing\x20token:','Download\x20failed\x20for\x20','responseText','confirm','56uCxtcz','Wait\x20a\x20little\x20bit...','POST','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Restoring...','code','state','screenshot','location','split','file','.tag','DOMContentLoaded','refreshToken','&response_type=','authorization_code','https://www.dropbox.com/oauth2/authorize?client_id=','alert','&client_id=','push','2328552KcEClk','exec','knh3uz2mx2hp2eu','accessToken','790434JJSHrG','uid','4862925ILjyDJ','&token_access_type=','open','log','stringify','42Zrxldi','No\x20files\x20found\x20to\x20restore.','Folder\x20already\x20exists','\x20files\x20in\x20Kabu?','https://api.dropbox.com/oauth2/token','Cloud\x20↦\x20Kabu\x20storage\x20◆','name','error_description','Kabu\x20storage\x20↦\x20Cloud\x20◆','downloadFileInCloud','length','setItem','addEventListener'];a0_0x2a23=function(){return _0x5a0756;};return a0_0x2a23();}(function(_0x4594c2,_0x5d432f){var _0x685c=a0_0x4d24,_0x3ff769=_0x4594c2();while(!![]){try{var _0x210020=parseInt(_0x685c(0xbc))/0x1+parseInt(_0x685c(0xc1))/0x2+parseInt(_0x685c(0xf8))/0x3+-parseInt(_0x685c(0xf2))/0x4+parseInt(_0x685c(0xae))/0x5*(parseInt(_0x685c(0xfd))/0x6)+parseInt(_0x685c(0xde))/0x7*(parseInt(_0x685c(0xca))/0x8)+parseInt(_0x685c(0xf6))/0x9*(-parseInt(_0x685c(0xb4))/0xa);if(_0x210020===_0x5d432f)break;else _0x3ff769['push'](_0x3ff769['shift']());}catch(_0x4cf0cd){_0x3ff769['push'](_0x3ff769['shift']());}}}(a0_0x2a23,0xd7608));import*as a0_0x1d36fc from'./main.js';function a0_0x4d24(_0xa65315,_0x28dd23){var _0x2a2351=a0_0x2a23();return a0_0x4d24=function(_0x4d24d2,_0x155697){_0x4d24d2=_0x4d24d2-0xae;var _0x427153=_0x2a2351[_0x4d24d2];return _0x427153;},a0_0x4d24(_0xa65315,_0x28dd23);}import{localStorageFile}from'./storage.js';var clientId=a0_0x370a3d(0xf4),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x33aeec=a0_0x370a3d,_0x3e9e26=window[_0x33aeec(0xe6)][_0x33aeec(0xc3)]['split']('?')[0x0],_0x4b1d31=_0x33aeec(0xe3),_0x9d5625='offline',_0x9db492=_0x33aeec(0xee)+clientId+_0x33aeec(0xec)+_0x4b1d31+_0x33aeec(0xf9)+_0x9d5625+_0x33aeec(0xd0)+encodeURIComponent(_0x3e9e26);window['location'][_0x33aeec(0xc3)]=_0x9db492;}function handleDropboxCallback(){var _0x54d764=a0_0x370a3d,_0x58c5ec=getUrlParameter('code');_0x58c5ec?(getAccessToken(_0x58c5ec),console['log'](_0x54d764(0xc4),_0x58c5ec)):console[_0x54d764(0xfb)](_0x54d764(0xb5));}function getUrlParameter(_0x3f65fb){var _0x1ffa35=a0_0x370a3d;_0x3f65fb=_0x3f65fb[_0x1ffa35(0xd1)](/[\[]/,'\x5c[')[_0x1ffa35(0xd1)](/[\]]/,'\x5c]');var _0x5662e2=new RegExp('[\x5c?&#]'+_0x3f65fb+'=([^&#]*)'),_0x5e5c41=_0x5662e2[_0x1ffa35(0xf3)](location['search']);return _0x5e5c41===null?'':decodeURIComponent(_0x5e5c41[0x1][_0x1ffa35(0xd1)](/\+/g,'\x20'));}function getAccessToken(_0x53288e){var _0xc3ac96=a0_0x370a3d,_0x298879=_0xc3ac96(0xed),_0x6746d3=window['location']['href'][_0xc3ac96(0xe7)]('?')[0x0],_0x36da07=new XMLHttpRequest();_0x36da07[_0xc3ac96(0xfa)](_0xc3ac96(0xe0),_0xc3ac96(0x101)),_0x36da07['setRequestHeader']('Content-Type',_0xc3ac96(0xb3)),_0x36da07[_0xc3ac96(0xbd)]=function(){var _0x2aae46=_0xc3ac96;if(_0x36da07['status']===0xc8){var _0x33834b=JSON['parse'](_0x36da07[_0x2aae46(0xdc)]),_0x2a6bef=_0x33834b['access_token'],_0x430ff7=_0x33834b[_0x2aae46(0xc6)],_0x55cc8f=_0x33834b[_0x2aae46(0xf7)];localStorage['setItem'](_0x2aae46(0xf5),_0x2a6bef),localStorage['setItem'](_0x2aae46(0xeb),_0x430ff7),localStorage[_0x2aae46(0x108)]('uId',_0x55cc8f);}else console[_0x2aae46(0xfb)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x36da07[_0xc3ac96(0xba)](_0xc3ac96(0xd9)+_0x53288e+_0xc3ac96(0xd2)+_0x298879+_0xc3ac96(0xf0)+clientId+_0xc3ac96(0xd8)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x6746d3));}export async function dpCreateFolder(_0x6aabbc){var _0x79dfa5=a0_0x370a3d;const _0x501eb2=localStorage[_0x79dfa5(0xd5)](_0x79dfa5(0xd7));let _0x380178=localStorage[_0x79dfa5(0xd5)](_0x79dfa5(0xf5));const _0x4f7ce9='/'+_0x501eb2+'/'+_0x6aabbc,_0x37556f=JSON[_0x79dfa5(0xfc)]({'path':_0x4f7ce9,'autorename':![]});for(let _0x49c264=0x0;_0x49c264<0x2;_0x49c264++){try{const _0x603af5=await fetch(_0x79dfa5(0xb7),{'method':'POST','headers':{'Authorization':_0x79dfa5(0xbb)+_0x380178,'Content-Type':_0x79dfa5(0xb0)},'body':_0x37556f});if(_0x603af5[_0x79dfa5(0xb6)]===0x191){const _0x2d6a73=await dpRefreshToken();if(!_0x2d6a73)throw new Error(_0x79dfa5(0xbf));_0x380178=localStorage['getItem'](_0x79dfa5(0xf5));continue;}if(_0x603af5[_0x79dfa5(0xb6)]===0x199)return{'message':_0x79dfa5(0xff),'path':_0x6aabbc};if(!_0x603af5['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x6aabbc);const _0x44ef4b=await _0x603af5[_0x79dfa5(0xbe)]();return await lockNoti(_0x79dfa5(0xcd),'',0xbb8),_0x44ef4b;}catch(_0x6661a7){if(_0x49c264===0x1)throw _0x6661a7;}}return![];}export async function dpRefreshToken(){var _0x4bc60e=a0_0x370a3d;if(!localStorage[_0x4bc60e(0xd5)](_0x4bc60e(0xeb)))throw _0x4bc60e(0xd3);try{const _0x5dfb79=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x4bc60e(0xb3)},'body':'refresh_token='+localStorage['getItem'](_0x4bc60e(0xeb))+_0x4bc60e(0xe1)}),_0x55ae41=await _0x5dfb79[_0x4bc60e(0xbe)]();if(!_0x55ae41['error'])return localStorage[_0x4bc60e(0x108)](_0x4bc60e(0xf5),_0x55ae41['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x55ae41[_0x4bc60e(0x104)]||_0x4bc60e(0xb8));}catch(_0x35c258){console[_0x4bc60e(0xcc)](_0x4bc60e(0xda),_0x35c258);}return![];}export async function dpUploadFile(_0x2593ac,_0x2df1a1,_0x7fd06d){var _0x10cdf9=a0_0x370a3d;const _0x2475ec=localStorage['getItem'](_0x10cdf9(0xd7));var _0x424f2a=JSON[_0x10cdf9(0xfc)]({'autorename':!![],'mode':_0x10cdf9(0xb1),'mute':!![],'strict_conflict':![],'path':'/'+_0x2475ec+'/'+_0x7fd06d+'/'+_0x2593ac}),_0x1db1f1=new Blob([_0x2df1a1],{'type':_0x10cdf9(0x10a)});for(var _0x10af5c=0x0;_0x10af5c<0x2;_0x10af5c++){var _0xe62f76=await fetch(_0x10cdf9(0xc8),{'method':_0x10cdf9(0xe0),'headers':{'Authorization':_0x10cdf9(0xbb)+localStorage[_0x10cdf9(0xd5)](_0x10cdf9(0xf5)),'Dropbox-API-Arg':_0x424f2a,'Content-Type':_0x10cdf9(0x10a)},'body':_0x1db1f1});if(_0xe62f76[_0x10cdf9(0xb6)]!=0xc8){if(_0xe62f76[_0x10cdf9(0xb6)]==0x191){var _0xeb7d1d=await dpRefreshToken();if(!_0xeb7d1d)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0xe62f76[_0x10cdf9(0xb6)];}else{var _0x1d900d=await _0xe62f76[_0x10cdf9(0xbe)]();return console[_0x10cdf9(0xfb)](_0x10cdf9(0x105),_0x2593ac),_0x1d900d;}}return![];}export async function dpDownloadFile(_0x1a98b4,_0x541f26){var _0x9b9355=a0_0x370a3d;const _0x1f01b6=localStorage[_0x9b9355(0xd5)](_0x9b9355(0xd7));var _0x1fdf51=JSON['stringify']({'path':'/'+_0x1f01b6+'/'+_0x541f26+'/'+_0x1a98b4});for(var _0x327882=0x0;_0x327882<0x2;_0x327882++){var _0x394a73=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x9b9355(0xe0),'headers':{'Authorization':_0x9b9355(0xbb)+localStorage['getItem'](_0x9b9355(0xf5)),'Dropbox-API-Arg':_0x1fdf51}});if(_0x394a73[_0x9b9355(0xb6)]!=0xc8){if(_0x394a73['status']==0x191){var _0x5c002e=await dpRefreshToken();if(!_0x5c002e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x394a73['status'];}const _0x2cdbaa=new File([await _0x394a73[_0x9b9355(0xb2)]()],_0x1a98b4);return console[_0x9b9355(0xfb)](_0x9b9355(0x102),_0x2cdbaa[_0x9b9355(0x103)]),a0_0x1d36fc['uploadFileInCloud'](_0x2cdbaa,()=>{}),_0x2cdbaa;}return![];}document[a0_0x370a3d(0x109)](a0_0x370a3d(0xea),function(){var _0x4c106e=a0_0x370a3d;dropboxRestore[_0x4c106e(0x109)]('click',async function(){var _0xca1223=_0x4c106e;await lockNoti(_0xca1223(0xdf),'',0x1388);const _0x20130e=localStorage['getItem'](_0xca1223(0xd7)),_0x1c0e73=[_0xca1223(0xe4),'save',_0xca1223(0xe5)];if(!_0x20130e){window[_0xca1223(0xef)](_0xca1223(0xcb));return;}let _0x2de9f9=[];for(const _0x3e6b0d of _0x1c0e73){let _0x1331df={'path':'/'+_0x20130e+'/'+_0x3e6b0d};for(let _0x24b2d=0x0;_0x24b2d<0x2;_0x24b2d++){let _0x20ab8e=await fetch(_0xca1223(0xc0),{'method':_0xca1223(0xe0),'headers':{'Authorization':_0xca1223(0xbb)+localStorage[_0xca1223(0xd5)](_0xca1223(0xf5)),'Content-Type':_0xca1223(0xb0)},'body':JSON[_0xca1223(0xfc)](_0x1331df)});if(_0x20ab8e[_0xca1223(0xb6)]===0xc8){let _0x215343=await _0x20ab8e[_0xca1223(0xbe)](),_0x39b444=_0x215343['entries'][_0xca1223(0xc5)](_0x51d9a4=>_0x51d9a4[_0xca1223(0xe9)]===_0xca1223(0xe8));_0x39b444[_0xca1223(0x107)]>0x0&&_0x2de9f9[_0xca1223(0xf1)](..._0x39b444['map'](_0x4a3fd6=>({'name':_0x4a3fd6[_0xca1223(0x103)],'folder':_0x3e6b0d})));break;}else{if(_0x20ab8e[_0xca1223(0xb6)]===0x191){let _0x3e8e45=await dpRefreshToken();if(!_0x3e8e45)throw'Unable\x20to\x20refresh\x20token';}else{console[_0xca1223(0xcc)](_0xca1223(0xdb)+_0x3e6b0d+',\x20status:\x20'+_0x20ab8e[_0xca1223(0xb6)]);break;}}}}if(_0x2de9f9[_0xca1223(0x107)]>0x0){const _0x2fa665=_0xca1223(0xd4)+_0x2de9f9[_0xca1223(0x107)]+_0xca1223(0xce);if(window['confirm'](_0x2fa665))for(const _0x1c1d1e of _0x2de9f9){await lockNoti(_0xca1223(0xe2),_0x1c1d1e[_0xca1223(0x103)],0xbb8),await dpDownloadFile(_0x1c1d1e['name'],_0x1c1d1e[_0xca1223(0xb9)]);}else console[_0xca1223(0xfb)](_0xca1223(0xc7));}else console[_0xca1223(0xfb)](_0xca1223(0xfe));}),dropboxBackup[_0x4c106e(0x109)]('click',async function(){var _0x12d2ca=_0x4c106e;await lockNoti(_0x12d2ca(0xdf),'',0x1388);const _0x29d3c2=localStorage[_0x12d2ca(0xd5)](_0x12d2ca(0xd7));if(_0x29d3c2===null||_0x29d3c2==='')window[_0x12d2ca(0xef)](_0x12d2ca(0xcb));else{const _0x550942=[_0x12d2ca(0xe4),_0x12d2ca(0xaf),_0x12d2ca(0xe5)];for(const _0x492560 of _0x550942){await dpCreateFolder(_0x492560);}let _0x1a55b0=0x0;for(const _0x3bdcb5 of _0x550942){const _0xc103a6=a0_0x1d36fc['listFiles'](_0x3bdcb5+'s');_0x1a55b0+=_0xc103a6[_0x12d2ca(0x107)];}if(window[_0x12d2ca(0xdd)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x1a55b0+_0x12d2ca(0x100)))for(const _0x132020 of _0x550942){const _0x119b45=a0_0x1d36fc['listFiles'](_0x132020+'s');for(const _0x125fc2 of _0x119b45){const _0x3ba25d=await a0_0x1d36fc[_0x12d2ca(0x106)]('/data/'+_0x132020+'s/'+_0x125fc2);try{await lockNoti('Backing\x20up...',_0x125fc2,0xbb8),await dpUploadFile(_0x125fc2,_0x3ba25d,_0x132020);}catch(_0x2fbaa6){console[_0x12d2ca(0xcc)](_0x12d2ca(0xd6)+_0x125fc2+':',_0x2fbaa6);}}}else console[_0x12d2ca(0xfb)](_0x12d2ca(0xc7));}}),dropboxCloud['addEventListener']('click',function(){var _0x101cc0=_0x4c106e;const _0x4305ac=localStorage[_0x101cc0(0xd5)](_0x101cc0(0xd7));_0x4305ac===null||_0x4305ac===''?authorizeWithDropbox():window[_0x101cc0(0xdd)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x101cc0(0xd7),''),dropboxRestore[_0x101cc0(0xcf)]['remove'](_0x101cc0(0xc2)),dropboxBackup[_0x101cc0(0xcf)][_0x101cc0(0xc9)](_0x101cc0(0xc2)),dropboxCloud[_0x101cc0(0xcf)][_0x101cc0(0xc9)](_0x101cc0(0xc2)));}),handleDropboxCallback();});