var a0_0x2909f6=a0_0x34dd;(function(_0x18a165,_0x25fc1a){var _0x5283dd=a0_0x34dd,_0x258a46=_0x18a165();while(!![]){try{var _0x5e518b=parseInt(_0x5283dd(0x20b))/0x1*(-parseInt(_0x5283dd(0x1f2))/0x2)+parseInt(_0x5283dd(0x233))/0x3*(parseInt(_0x5283dd(0x20d))/0x4)+-parseInt(_0x5283dd(0x23d))/0x5*(parseInt(_0x5283dd(0x236))/0x6)+-parseInt(_0x5283dd(0x1f9))/0x7+parseInt(_0x5283dd(0x1fd))/0x8*(parseInt(_0x5283dd(0x1f7))/0x9)+-parseInt(_0x5283dd(0x214))/0xa*(parseInt(_0x5283dd(0x21a))/0xb)+parseInt(_0x5283dd(0x1ee))/0xc;if(_0x5e518b===_0x25fc1a)break;else _0x258a46['push'](_0x258a46['shift']());}catch(_0x3d1284){_0x258a46['push'](_0x258a46['shift']());}}}(a0_0x330f,0xb2dbf));import*as a0_0x52fe9a from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2909f6(0x21b),clientSecret=a0_0x2909f6(0x211);function authorizeWithDropbox(){var _0x9c2477=a0_0x2909f6,_0x560ffc=window['location']['href']['split']('?')[0x0],_0x2ae1e9='code',_0x1759fc='offline',_0x285533='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x9c2477(0x230)+_0x2ae1e9+_0x9c2477(0x21d)+_0x1759fc+_0x9c2477(0x1fe)+encodeURIComponent(_0x560ffc);window['location'][_0x9c2477(0x22a)]=_0x285533;}function handleDropboxCallback(){var _0x34a9be=a0_0x2909f6,_0x111611=getUrlParameter(_0x34a9be(0x1e0));_0x111611?(getAccessToken(_0x111611),console['log'](_0x34a9be(0x21c),_0x111611)):console[_0x34a9be(0x1fb)](_0x34a9be(0x222));}function getUrlParameter(_0x214474){var _0x5aacd4=a0_0x2909f6;_0x214474=_0x214474['replace'](/[\[]/,'\x5c[')[_0x5aacd4(0x229)](/[\]]/,'\x5c]');var _0x257eff=new RegExp(_0x5aacd4(0x205)+_0x214474+_0x5aacd4(0x1e7)),_0x4abba8=_0x257eff[_0x5aacd4(0x23b)](location[_0x5aacd4(0x226)]);return _0x4abba8===null?'':decodeURIComponent(_0x4abba8[0x1][_0x5aacd4(0x229)](/\+/g,'\x20'));}function getAccessToken(_0xd33bba){var _0x48d8ff=a0_0x2909f6,_0x2ee0a6='authorization_code',_0x8485bd=window[_0x48d8ff(0x1f3)]['href'][_0x48d8ff(0x1f0)]('?')[0x0],_0x25908c=new XMLHttpRequest();_0x25908c[_0x48d8ff(0x208)]('POST',_0x48d8ff(0x217)),_0x25908c[_0x48d8ff(0x201)](_0x48d8ff(0x203),_0x48d8ff(0x238)),_0x25908c[_0x48d8ff(0x202)]=function(){var _0x20a314=_0x48d8ff;if(_0x25908c['status']===0xc8){var _0x4d99a7=JSON['parse'](_0x25908c[_0x20a314(0x1e8)]),_0x14742f=_0x4d99a7[_0x20a314(0x241)],_0x174de1=_0x4d99a7['refresh_token'],_0x458185=_0x4d99a7[_0x20a314(0x210)];localStorage[_0x20a314(0x23e)]('accessToken',_0x14742f),localStorage[_0x20a314(0x23e)](_0x20a314(0x23f),_0x174de1),localStorage[_0x20a314(0x23e)](_0x20a314(0x209),_0x458185);}else console[_0x20a314(0x1fb)](_0x20a314(0x1e5));},_0x25908c['send'](_0x48d8ff(0x212)+_0xd33bba+_0x48d8ff(0x20e)+_0x2ee0a6+_0x48d8ff(0x1ec)+clientId+_0x48d8ff(0x23a)+clientSecret+_0x48d8ff(0x1fe)+encodeURIComponent(_0x8485bd));}export async function dpCreateFolder(_0x23d907){var _0x23c3b6=a0_0x2909f6;const _0xf03020=localStorage['getItem'](_0x23c3b6(0x209));let _0x133227=localStorage['getItem']('accessToken');const _0x156f80='/'+_0xf03020+'/'+_0x23d907,_0x5a9495=JSON[_0x23c3b6(0x1df)]({'path':_0x156f80,'autorename':![]});for(let _0x39a93b=0x0;_0x39a93b<0x2;_0x39a93b++){try{const _0x494885=await fetch(_0x23c3b6(0x1f6),{'method':_0x23c3b6(0x234),'headers':{'Authorization':'Bearer\x20'+_0x133227,'Content-Type':'application/json'},'body':_0x5a9495});if(_0x494885[_0x23c3b6(0x20a)]===0x191){const _0x3b7460=await dpRefreshToken();if(!_0x3b7460)throw new Error(_0x23c3b6(0x22c));_0x133227=localStorage[_0x23c3b6(0x1eb)]('accessToken');continue;}if(_0x494885[_0x23c3b6(0x20a)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x23d907};if(!_0x494885['ok'])throw new Error(_0x23c3b6(0x1db)+_0x23d907);const _0x3d46c3=await _0x494885[_0x23c3b6(0x1ea)]();return await lockNoti(_0x23c3b6(0x1e9),'',0xbb8),_0x3d46c3;}catch(_0xa5ea19){if(_0x39a93b===0x1)throw _0xa5ea19;}}return![];}export async function dpRefreshToken(){var _0x282c8f=a0_0x2909f6;if(!localStorage[_0x282c8f(0x1eb)](_0x282c8f(0x23f)))throw _0x282c8f(0x228);try{const _0x4ea5bf=await fetch(_0x282c8f(0x239),{'method':_0x282c8f(0x234),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x282c8f(0x220)+localStorage[_0x282c8f(0x1eb)]('refreshToken')+_0x282c8f(0x1e2)}),_0x27ec4a=await _0x4ea5bf[_0x282c8f(0x1ea)]();if(!_0x27ec4a[_0x282c8f(0x1f5)])return localStorage[_0x282c8f(0x23e)]('accessToken',_0x27ec4a[_0x282c8f(0x241)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x27ec4a[_0x282c8f(0x1e4)]||_0x282c8f(0x237));}catch(_0x12e9bb){console['error'](_0x282c8f(0x1f8),_0x12e9bb);}return![];}export async function dpUploadFile(_0xef541a,_0x544094,_0x5d0174){var _0xdcbeb3=a0_0x2909f6;const _0x2da75b=localStorage[_0xdcbeb3(0x1eb)]('uId');var _0x559108=JSON[_0xdcbeb3(0x1df)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x2da75b+'/'+_0x5d0174+'/'+_0xef541a}),_0xb081ba=new Blob([_0x544094],{'type':'application/octet-stream'});for(var _0x27e01a=0x0;_0x27e01a<0x2;_0x27e01a++){var _0x5c285a=await fetch(_0xdcbeb3(0x1ed),{'method':_0xdcbeb3(0x234),'headers':{'Authorization':_0xdcbeb3(0x1e6)+localStorage[_0xdcbeb3(0x1eb)](_0xdcbeb3(0x225)),'Dropbox-API-Arg':_0x559108,'Content-Type':_0xdcbeb3(0x218)},'body':_0xb081ba});if(_0x5c285a[_0xdcbeb3(0x20a)]!=0xc8){if(_0x5c285a[_0xdcbeb3(0x20a)]==0x191){var _0xf58402=await dpRefreshToken();if(!_0xf58402)throw _0xdcbeb3(0x22c);continue;}else throw _0xdcbeb3(0x200)+_0x5c285a[_0xdcbeb3(0x20a)];}else{var _0x3ee6d7=await _0x5c285a[_0xdcbeb3(0x1ea)]();return console[_0xdcbeb3(0x1fb)](_0xdcbeb3(0x1dd),_0xef541a),_0x3ee6d7;}}return![];}function a0_0x330f(){var _0x16ab37=['Authorization\x20Code:','&token_access_type=','save','toUpperCase','refresh_token=','active','Do\x20not\x20receive\x20authorization','https://api.dropboxapi.com/2/files/list_folder','push','accessToken','search','DOMContentLoaded','No\x20refresh\x20token','replace','href','\x20files\x20in\x20Kabu?','Unable\x20to\x20refresh\x20token','Cloud\x20login\x20required!','length','Backing\x20up...','&response_type=','Restoring...','slice','15xTEYps','POST','state','6891834qfCIgZ','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/x-www-form-urlencoded','https://api.dropboxapi.com/oauth2/token','&client_secret=','exec','list','5MzeYmr','setItem','refreshToken','/data/','access_token','classList','filter','\x20files\x20from\x20Cloud?','Error\x20creating\x20folder\x20','uploadFileInCloud','Kabu\x20storage\x20↦\x20Cloud\x20◆','click','stringify','code','addEventListener','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Failed\x20to\x20upload\x20file\x20','error_description','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Bearer\x20','=([^&#]*)','responseText','Folder\x20created','json','getItem','&client_id=','https://content.dropboxapi.com/2/files/upload','24787728jrOhpw','name','split','file','10JXLDDU','location','blob','error','https://api.dropboxapi.com/2/files/create_folder_v2','2934mBQuwl','Error\x20while\x20refreshing\x20token:','2426067fbCHgA','https://content.dropboxapi.com/2/files/download','log','map','32280NQhZYx','&redirect_uri=','Restore\x20canceled\x20by\x20user.','Upload\x20failed,\x20unknown\x20http\x20status:\x20','setRequestHeader','onload','Content-Type','folder','[\x5c?&#]','confirm','remove','open','uId','status','191911nVYbFG','screenshot','700244sazeGW','&grant_type=','entries','uid','nwb3dnfh09rhs31','code=','Do\x20you\x20want\x20to\x20logout?','130pXquQu','charAt','Download\x20failed\x20for\x20','https://api.dropbox.com/oauth2/token','application/octet-stream','Wait\x20a\x20little\x20bit...','904519MLvHVH','knh3uz2mx2hp2eu'];a0_0x330f=function(){return _0x16ab37;};return a0_0x330f();}function a0_0x34dd(_0x32e7b0,_0x7a44ff){var _0x330f68=a0_0x330f();return a0_0x34dd=function(_0x34ddab,_0xfea60e){_0x34ddab=_0x34ddab-0x1d9;var _0x8a0e5d=_0x330f68[_0x34ddab];return _0x8a0e5d;},a0_0x34dd(_0x32e7b0,_0x7a44ff);}export async function dpDownloadFile(_0x41f8d0,_0x2f7c72){var _0x45803b=a0_0x2909f6;const _0x450695=localStorage[_0x45803b(0x1eb)]('uId');var _0x45b0fe=JSON[_0x45803b(0x1df)]({'path':'/'+_0x450695+'/'+_0x2f7c72+'/'+_0x41f8d0});for(var _0xeb3992=0x0;_0xeb3992<0x2;_0xeb3992++){var _0x55358e=await fetch(_0x45803b(0x1fa),{'method':'POST','headers':{'Authorization':_0x45803b(0x1e6)+localStorage[_0x45803b(0x1eb)]('accessToken'),'Dropbox-API-Arg':_0x45b0fe}});if(_0x55358e['status']!=0xc8){if(_0x55358e[_0x45803b(0x20a)]==0x191){var _0x7910d2=await dpRefreshToken();if(!_0x7910d2)throw _0x45803b(0x22c);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x55358e['status'];}const _0x4438fc=new File([await _0x55358e[_0x45803b(0x1f4)]()],_0x41f8d0);return console[_0x45803b(0x1fb)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x4438fc[_0x45803b(0x1ef)]),a0_0x52fe9a[_0x45803b(0x1dc)](_0x4438fc,()=>{}),_0x4438fc;}return![];}document[a0_0x2909f6(0x1e1)](a0_0x2909f6(0x227),function(){var _0x47a8ab=a0_0x2909f6;dropboxRestore[_0x47a8ab(0x1e1)](_0x47a8ab(0x1de),async function(){var _0x1f7fea=_0x47a8ab;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x153a08=localStorage[_0x1f7fea(0x1eb)](_0x1f7fea(0x209)),_0x61c36=[_0x1f7fea(0x235),_0x1f7fea(0x21e),_0x1f7fea(0x20c)];if(!_0x153a08){window['alert'](_0x1f7fea(0x22d));return;}let _0x13f654=[];for(const _0x2afd93 of _0x61c36){let _0x2c9dfd={'path':'/'+_0x153a08+'/'+_0x2afd93};for(let _0x20201d=0x0;_0x20201d<0x2;_0x20201d++){let _0x2f5587=await fetch(_0x1f7fea(0x223),{'method':_0x1f7fea(0x234),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x1f7fea(0x225)),'Content-Type':'application/json'},'body':JSON[_0x1f7fea(0x1df)](_0x2c9dfd)});if(_0x2f5587['status']===0xc8){let _0x433e9d=await _0x2f5587[_0x1f7fea(0x1ea)](),_0x56c8e1=_0x433e9d[_0x1f7fea(0x20f)][_0x1f7fea(0x1d9)](_0x55e479=>_0x55e479['.tag']===_0x1f7fea(0x1f1));_0x56c8e1['length']>0x0&&_0x13f654[_0x1f7fea(0x224)](..._0x56c8e1[_0x1f7fea(0x1fc)](_0x5c582a=>({'name':_0x5c582a['name'],'folder':_0x2afd93})));break;}else{if(_0x2f5587['status']===0x191){let _0x58468c=await dpRefreshToken();if(!_0x58468c)throw _0x1f7fea(0x22c);}else{console[_0x1f7fea(0x1f5)](_0x1f7fea(0x216)+_0x2afd93+',\x20status:\x20'+_0x2f5587[_0x1f7fea(0x20a)]);break;}}}}if(_0x13f654[_0x1f7fea(0x22e)]>0x0){const _0x1cad18='Do\x20you\x20want\x20to\x20restore\x20'+_0x13f654[_0x1f7fea(0x22e)]+_0x1f7fea(0x1da);if(window[_0x1f7fea(0x206)](_0x1cad18))for(const _0x53058c of _0x13f654){await lockNoti(_0x1f7fea(0x231),_0x53058c[_0x1f7fea(0x1ef)],0xbb8),await dpDownloadFile(_0x53058c[_0x1f7fea(0x1ef)],_0x53058c[_0x1f7fea(0x204)]);}else console[_0x1f7fea(0x1fb)](_0x1f7fea(0x1ff));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x47a8ab(0x1e1)](_0x47a8ab(0x1de),async function(){var _0x3a9ed7=_0x47a8ab;await lockNoti(_0x3a9ed7(0x219),'',0x1388);const _0x49704e=localStorage[_0x3a9ed7(0x1eb)](_0x3a9ed7(0x209));if(_0x49704e===null||_0x49704e==='')window['alert']('Cloud\x20login\x20required!');else{const _0xbaa97c=['state',_0x3a9ed7(0x21e),_0x3a9ed7(0x20c)];for(const _0x4e5b6d of _0xbaa97c){await dpCreateFolder(_0x4e5b6d);}let _0x5303f5=0x0;for(const _0x14dbba of _0xbaa97c){const _0x1f2dff=a0_0x52fe9a[_0x3a9ed7(0x23c)+(_0x14dbba['charAt'](0x0)['toUpperCase']()+_0x14dbba[_0x3a9ed7(0x232)](0x1))]();_0x5303f5+=_0x1f2dff[_0x3a9ed7(0x22e)];}if(window[_0x3a9ed7(0x206)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x5303f5+_0x3a9ed7(0x22b)))for(const _0xe68abe of _0xbaa97c){const _0x4fb4d2=a0_0x52fe9a['list'+(_0xe68abe[_0x3a9ed7(0x215)](0x0)[_0x3a9ed7(0x21f)]()+_0xe68abe['slice'](0x1))]();for(const _0x56cc55 of _0x4fb4d2){const _0xdcf9ae=await a0_0x52fe9a['downloadFileInCloud'](_0x3a9ed7(0x240)+_0xe68abe+'s/'+_0x56cc55);try{await lockNoti(_0x3a9ed7(0x22f),_0x56cc55,0xbb8),await dpUploadFile(_0x56cc55,_0xdcf9ae,_0xe68abe);}catch(_0x1ab668){console['error'](_0x3a9ed7(0x1e3)+_0x56cc55+':',_0x1ab668);}}}else console[_0x3a9ed7(0x1fb)](_0x3a9ed7(0x1ff));}}),dropboxCloud[_0x47a8ab(0x1e1)](_0x47a8ab(0x1de),function(){var _0x5a5c66=_0x47a8ab;const _0x2bbde3=localStorage['getItem'](_0x5a5c66(0x209));_0x2bbde3===null||_0x2bbde3===''?authorizeWithDropbox():window[_0x5a5c66(0x206)](_0x5a5c66(0x213))&&(localStorage[_0x5a5c66(0x23e)](_0x5a5c66(0x209),''),dropboxRestore['classList'][_0x5a5c66(0x207)](_0x5a5c66(0x221)),dropboxBackup[_0x5a5c66(0x242)]['remove'](_0x5a5c66(0x221)),dropboxCloud[_0x5a5c66(0x242)][_0x5a5c66(0x207)](_0x5a5c66(0x221)));}),handleDropboxCallback();});