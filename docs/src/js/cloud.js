var a0_0x12a160=a0_0x3cc2;(function(_0x3a119d,_0x1f2415){var _0x9a1f44=a0_0x3cc2,_0x431277=_0x3a119d();while(!![]){try{var _0x52e0ca=-parseInt(_0x9a1f44(0x1eb))/0x1+-parseInt(_0x9a1f44(0x1fc))/0x2+-parseInt(_0x9a1f44(0x1e3))/0x3+-parseInt(_0x9a1f44(0x220))/0x4+-parseInt(_0x9a1f44(0x203))/0x5+-parseInt(_0x9a1f44(0x20f))/0x6+parseInt(_0x9a1f44(0x209))/0x7*(parseInt(_0x9a1f44(0x226))/0x8);if(_0x52e0ca===_0x1f2415)break;else _0x431277['push'](_0x431277['shift']());}catch(_0x33bf66){_0x431277['push'](_0x431277['shift']());}}}(a0_0x4de0,0xbd541));import*as a0_0x23080f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x12a160(0x23b),clientSecret=a0_0x12a160(0x21a);function authorizeWithDropbox(){var _0x108d43=a0_0x12a160,_0xe4c8d5=window[_0x108d43(0x212)][_0x108d43(0x211)][_0x108d43(0x1e6)]('?')[0x0],_0x1e78c1=_0x108d43(0x23c),_0x3ee560=_0x108d43(0x233),_0x1b8766=_0x108d43(0x213)+clientId+_0x108d43(0x1e4)+_0x1e78c1+_0x108d43(0x21f)+_0x3ee560+_0x108d43(0x22c)+encodeURIComponent(_0xe4c8d5);window[_0x108d43(0x212)][_0x108d43(0x211)]=_0x1b8766;}function handleDropboxCallback(){var _0x184757=a0_0x12a160,_0x484941=getUrlParameter(_0x184757(0x23c));_0x484941?(getAccessToken(_0x484941),console['log'](_0x184757(0x207),_0x484941)):console[_0x184757(0x202)](_0x184757(0x1ec));}function getUrlParameter(_0x282ddf){var _0x7feeb9=a0_0x12a160;_0x282ddf=_0x282ddf['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x3f824a=new RegExp(_0x7feeb9(0x234)+_0x282ddf+_0x7feeb9(0x1e5)),_0x7353be=_0x3f824a['exec'](location[_0x7feeb9(0x235)]);return _0x7353be===null?'':decodeURIComponent(_0x7353be[0x1][_0x7feeb9(0x1e0)](/\+/g,'\x20'));}function a0_0x4de0(){var _0x42b1d8=['application/octet-stream','file','click','confirm','https://api.dropboxapi.com/oauth2/token','Wait\x20a\x20little\x20bit...','1075246LWuFLX','entries','refresh_token=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','send','Restoring...','log','1462365dMwTfg','Unable\x20to\x20refresh\x20token','push','status','Authorization\x20Code:','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','320481drbrWc','refreshToken','Backing\x20up...','accessToken','\x20files\x20from\x20Cloud?','downloadFileInCloud','5280828WAbqkv','https://api.dropboxapi.com/2/files/create_folder_v2','href','location','https://www.dropbox.com/oauth2/authorize?client_id=','Restore\x20canceled\x20by\x20user.','Bearer\x20','https://api.dropbox.com/oauth2/token','Refreshing\x20token...','https://api.dropboxapi.com/2/files/list_folder','save','nwb3dnfh09rhs31','json','code=','uploadFileInCloud','folder','&token_access_type=','4188700VijEnA','remove','Failed\x20to\x20upload\x20file\x20','\x20files\x20in\x20Kabu?','uId','setItem','984sqFZOE','authorization_code','screenshot','Folder\x20already\x20exists','Kabu\x20storage\x20↦\x20Cloud\x20◆','/data/','&redirect_uri=','uid','&client_secret=','Cloud\x20login\x20required!','setRequestHeader','onload','Content-Type','offline','[\x5c?&#]','search','active','alert','https://content.dropboxapi.com/2/files/upload','getItem','length','knh3uz2mx2hp2eu','code','Do\x20you\x20want\x20to\x20backup\x20','application/json','stringify','Folder\x20created',',\x20status:\x20','https://content.dropboxapi.com/2/files/download','overwrite','name','DOMContentLoaded','replace','application/x-www-form-urlencoded','POST','4611000lNElae','&response_type=','=([^&#]*)','split','error','No\x20files\x20found\x20to\x20restore.','Do\x20you\x20want\x20to\x20logout?','Cloud\x20↦\x20Kabu\x20storage\x20◆','561411nZlCAi','Do\x20not\x20receive\x20authorization','addEventListener','Do\x20you\x20want\x20to\x20restore\x20','.tag','map','classList','Failed\x20to\x20refresh\x20Dropbox\x20token.','listFiles','state','access_token'];a0_0x4de0=function(){return _0x42b1d8;};return a0_0x4de0();}function getAccessToken(_0x43d4b1){var _0x36c832=a0_0x12a160,_0x12fc56=_0x36c832(0x227),_0x100955=window['location']['href'][_0x36c832(0x1e6)]('?')[0x0],_0x84d535=new XMLHttpRequest();_0x84d535['open'](_0x36c832(0x1e2),_0x36c832(0x216)),_0x84d535[_0x36c832(0x230)](_0x36c832(0x232),_0x36c832(0x1e1)),_0x84d535[_0x36c832(0x231)]=function(){var _0x271613=_0x36c832;if(_0x84d535[_0x271613(0x206)]===0xc8){var _0x4022a4=JSON['parse'](_0x84d535['responseText']),_0x456ed0=_0x4022a4[_0x271613(0x1f5)],_0x192c8c=_0x4022a4['refresh_token'],_0x1c818b=_0x4022a4[_0x271613(0x22d)];localStorage[_0x271613(0x225)]('accessToken',_0x456ed0),localStorage[_0x271613(0x225)](_0x271613(0x20a),_0x192c8c),localStorage[_0x271613(0x225)]('uId',_0x1c818b);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x84d535[_0x36c832(0x200)](_0x36c832(0x21c)+_0x43d4b1+'&grant_type='+_0x12fc56+'&client_id='+clientId+_0x36c832(0x22e)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x100955));}function a0_0x3cc2(_0x43cbe6,_0x1633fc){var _0x4de06f=a0_0x4de0();return a0_0x3cc2=function(_0x3cc215,_0x51c88a){_0x3cc215=_0x3cc215-0x1d8;var _0x1f1ed4=_0x4de06f[_0x3cc215];return _0x1f1ed4;},a0_0x3cc2(_0x43cbe6,_0x1633fc);}export async function dpCreateFolder(_0x407f55){var _0x1127d5=a0_0x12a160;const _0x26f3df=localStorage['getItem'](_0x1127d5(0x224));let _0x4f3f8b=localStorage['getItem'](_0x1127d5(0x20c));const _0x50348c='/'+_0x26f3df+'/'+_0x407f55,_0xc9acdf=JSON[_0x1127d5(0x1d9)]({'path':_0x50348c,'autorename':![]});for(let _0xdbd7d7=0x0;_0xdbd7d7<0x2;_0xdbd7d7++){try{const _0x49c9d0=await fetch(_0x1127d5(0x210),{'method':_0x1127d5(0x1e2),'headers':{'Authorization':_0x1127d5(0x215)+_0x4f3f8b,'Content-Type':'application/json'},'body':_0xc9acdf});if(_0x49c9d0['status']===0x191){const _0x4be656=await dpRefreshToken();if(!_0x4be656)throw new Error(_0x1127d5(0x204));_0x4f3f8b=localStorage['getItem'](_0x1127d5(0x20c));continue;}if(_0x49c9d0[_0x1127d5(0x206)]===0x199)return{'message':_0x1127d5(0x229),'path':_0x407f55};if(!_0x49c9d0['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x407f55);const _0x36398d=await _0x49c9d0[_0x1127d5(0x21b)]();return await lockNoti(_0x1127d5(0x1da),'',0xbb8),_0x36398d;}catch(_0x21a775){if(_0xdbd7d7===0x1)throw _0x21a775;}}return![];}export async function dpRefreshToken(){var _0x341ca4=a0_0x12a160;if(!localStorage[_0x341ca4(0x239)](_0x341ca4(0x20a)))throw'No\x20refresh\x20token';try{const _0x32d0fd=await fetch(_0x341ca4(0x1fa),{'method':_0x341ca4(0x1e2),'headers':{'Content-Type':_0x341ca4(0x1e1)},'body':_0x341ca4(0x1fe)+localStorage['getItem'](_0x341ca4(0x20a))+_0x341ca4(0x208)}),_0x25ef45=await _0x32d0fd[_0x341ca4(0x21b)]();if(!_0x25ef45[_0x341ca4(0x1e7)])return localStorage[_0x341ca4(0x225)](_0x341ca4(0x20c),_0x25ef45[_0x341ca4(0x1f5)]),await lockNoti(_0x341ca4(0x217),'',0xbb8),await delay(0x3e8),!![];else alert(_0x25ef45['error_description']||_0x341ca4(0x1f2));}catch(_0x381ad1){console['error']('Error\x20while\x20refreshing\x20token:',_0x381ad1);}return![];}export async function dpUploadFile(_0x222bf9,_0x2842f0,_0x1e31fe){var _0x27efe8=a0_0x12a160;const _0x1a376=localStorage[_0x27efe8(0x239)](_0x27efe8(0x224));var _0x1a2f1f=JSON[_0x27efe8(0x1d9)]({'autorename':!![],'mode':_0x27efe8(0x1dd),'mute':!![],'strict_conflict':![],'path':'/'+_0x1a376+'/'+_0x1e31fe+'/'+_0x222bf9}),_0x267470=new Blob([_0x2842f0],{'type':'application/octet-stream'});for(var _0x3c3883=0x0;_0x3c3883<0x2;_0x3c3883++){var _0x5e18c=await fetch(_0x27efe8(0x238),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x27efe8(0x20c)),'Dropbox-API-Arg':_0x1a2f1f,'Content-Type':_0x27efe8(0x1f6)},'body':_0x267470});if(_0x5e18c['status']!=0xc8){if(_0x5e18c[_0x27efe8(0x206)]==0x191){var _0x41771b=await dpRefreshToken();if(!_0x41771b)throw _0x27efe8(0x204);continue;}else throw _0x27efe8(0x1ff)+_0x5e18c['status'];}else{var _0x2be139=await _0x5e18c[_0x27efe8(0x21b)]();return console[_0x27efe8(0x202)](_0x27efe8(0x22a),_0x222bf9),_0x2be139;}}return![];}export async function dpDownloadFile(_0x402ed1,_0x1632fc){var _0x482198=a0_0x12a160;const _0x5bd4eb=localStorage['getItem'](_0x482198(0x224));var _0x8e8323=JSON['stringify']({'path':'/'+_0x5bd4eb+'/'+_0x1632fc+'/'+_0x402ed1});for(var _0x274a31=0x0;_0x274a31<0x2;_0x274a31++){var _0x2392b9=await fetch(_0x482198(0x1dc),{'method':_0x482198(0x1e2),'headers':{'Authorization':_0x482198(0x215)+localStorage[_0x482198(0x239)](_0x482198(0x20c)),'Dropbox-API-Arg':_0x8e8323}});if(_0x2392b9[_0x482198(0x206)]!=0xc8){if(_0x2392b9[_0x482198(0x206)]==0x191){var _0x42cea0=await dpRefreshToken();if(!_0x42cea0)throw _0x482198(0x204);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x2392b9['status'];}const _0x10793d=new File([await _0x2392b9['blob']()],_0x402ed1);return console[_0x482198(0x202)](_0x482198(0x1ea),_0x10793d[_0x482198(0x1de)]),a0_0x23080f[_0x482198(0x21d)](_0x10793d,()=>{}),_0x10793d;}return![];}document[a0_0x12a160(0x1ed)](a0_0x12a160(0x1df),function(){var _0x541e8c=a0_0x12a160;dropboxRestore[_0x541e8c(0x1ed)](_0x541e8c(0x1f8),async function(){var _0x5128c3=_0x541e8c;await lockNoti(_0x5128c3(0x1fb),'',0x1388);const _0x24d9a8=localStorage[_0x5128c3(0x239)](_0x5128c3(0x224)),_0x19d1cd=[_0x5128c3(0x1f4),_0x5128c3(0x219),_0x5128c3(0x228)];if(!_0x24d9a8){window[_0x5128c3(0x237)](_0x5128c3(0x22f));return;}let _0x2e3672=[];for(const _0x25cb4d of _0x19d1cd){let _0x2d9961={'path':'/'+_0x24d9a8+'/'+_0x25cb4d};for(let _0x20ed51=0x0;_0x20ed51<0x2;_0x20ed51++){let _0x5733cf=await fetch(_0x5128c3(0x218),{'method':'POST','headers':{'Authorization':_0x5128c3(0x215)+localStorage[_0x5128c3(0x239)](_0x5128c3(0x20c)),'Content-Type':_0x5128c3(0x1d8)},'body':JSON['stringify'](_0x2d9961)});if(_0x5733cf[_0x5128c3(0x206)]===0xc8){let _0x493366=await _0x5733cf['json'](),_0x206a66=_0x493366[_0x5128c3(0x1fd)]['filter'](_0x49ad95=>_0x49ad95[_0x5128c3(0x1ef)]===_0x5128c3(0x1f7));_0x206a66[_0x5128c3(0x23a)]>0x0&&_0x2e3672[_0x5128c3(0x205)](..._0x206a66[_0x5128c3(0x1f0)](_0x30c73b=>({'name':_0x30c73b['name'],'folder':_0x25cb4d})));break;}else{if(_0x5733cf['status']===0x191){let _0x49c600=await dpRefreshToken();if(!_0x49c600)throw _0x5128c3(0x204);}else{console[_0x5128c3(0x1e7)]('Download\x20failed\x20for\x20'+_0x25cb4d+_0x5128c3(0x1db)+_0x5733cf[_0x5128c3(0x206)]);break;}}}}if(_0x2e3672['length']>0x0){const _0x3a6895=_0x5128c3(0x1ee)+_0x2e3672[_0x5128c3(0x23a)]+_0x5128c3(0x20d);if(window['confirm'](_0x3a6895))for(const _0x5b177d of _0x2e3672){await lockNoti(_0x5128c3(0x201),_0x5b177d['name'],0xbb8),await dpDownloadFile(_0x5b177d[_0x5128c3(0x1de)],_0x5b177d[_0x5128c3(0x21e)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x5128c3(0x202)](_0x5128c3(0x1e8));}),dropboxBackup[_0x541e8c(0x1ed)](_0x541e8c(0x1f8),async function(){var _0x2bdb02=_0x541e8c;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1650d5=localStorage[_0x2bdb02(0x239)](_0x2bdb02(0x224));if(_0x1650d5===null||_0x1650d5==='')window['alert'](_0x2bdb02(0x22f));else{const _0x5804e4=[_0x2bdb02(0x1f4),'save','screenshot'];for(const _0x52433e of _0x5804e4){await dpCreateFolder(_0x52433e);}let _0x473e38=0x0;for(const _0x1edc52 of _0x5804e4){const _0x51f5d6=a0_0x23080f[_0x2bdb02(0x1f3)](_0x1edc52+'s');_0x473e38+=_0x51f5d6[_0x2bdb02(0x23a)];}if(window[_0x2bdb02(0x1f9)](_0x2bdb02(0x23d)+_0x473e38+_0x2bdb02(0x223)))for(const _0x3f35fc of _0x5804e4){const _0x520074=a0_0x23080f[_0x2bdb02(0x1f3)](_0x3f35fc+'s');for(const _0x1c26b0 of _0x520074){const _0xef9af9=await a0_0x23080f[_0x2bdb02(0x20e)](_0x2bdb02(0x22b)+_0x3f35fc+'s/'+_0x1c26b0);try{await lockNoti(_0x2bdb02(0x20b),_0x1c26b0,0xbb8),await dpUploadFile(_0x1c26b0,_0xef9af9,_0x3f35fc);}catch(_0x18f587){console[_0x2bdb02(0x1e7)](_0x2bdb02(0x222)+_0x1c26b0+':',_0x18f587);}}}else console['log'](_0x2bdb02(0x214));}}),dropboxCloud[_0x541e8c(0x1ed)](_0x541e8c(0x1f8),function(){var _0xa407ff=_0x541e8c;const _0x158aac=localStorage[_0xa407ff(0x239)](_0xa407ff(0x224));_0x158aac===null||_0x158aac===''?authorizeWithDropbox():window['confirm'](_0xa407ff(0x1e9))&&(localStorage[_0xa407ff(0x225)](_0xa407ff(0x224),''),dropboxRestore[_0xa407ff(0x1f1)]['remove']('active'),dropboxBackup[_0xa407ff(0x1f1)][_0xa407ff(0x221)](_0xa407ff(0x236)),dropboxCloud[_0xa407ff(0x1f1)][_0xa407ff(0x221)](_0xa407ff(0x236)));}),handleDropboxCallback();});