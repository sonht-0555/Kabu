var a0_0x143f25=a0_0x2dc3;(function(_0x4e217a,_0x4ecf08){var _0x160fec=a0_0x2dc3,_0x65368f=_0x4e217a();while(!![]){try{var _0x949a86=-parseInt(_0x160fec(0x165))/0x1+-parseInt(_0x160fec(0x135))/0x2+parseInt(_0x160fec(0x16a))/0x3+-parseInt(_0x160fec(0x176))/0x4*(parseInt(_0x160fec(0x15f))/0x5)+-parseInt(_0x160fec(0x14c))/0x6*(-parseInt(_0x160fec(0x13f))/0x7)+-parseInt(_0x160fec(0x140))/0x8+parseInt(_0x160fec(0x177))/0x9;if(_0x949a86===_0x4ecf08)break;else _0x65368f['push'](_0x65368f['shift']());}catch(_0xd1ddb5){_0x65368f['push'](_0x65368f['shift']());}}}(a0_0x21ad,0xcf3c7));import*as a0_0x493962 from'./main.js';function a0_0x21ad(){var _0x34ec12=['screenshot','exec','application/x-www-form-urlencoded','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','classList','push','search','setItem','split','&redirect_uri=','name','uId','https://api.dropboxapi.com/oauth2/token','overwrite','accessToken','filter','blob','Cloud\x20login\x20required!','Error\x20creating\x20folder\x20','stringify','error','status','2609232AySREt','Kabu\x20storage\x20↦\x20Cloud\x20◆','DOMContentLoaded','Bearer\x20',',\x20status:\x20','Unable\x20to\x20refresh\x20token','downloadFileInCloud','Download\x20failed\x20for\x20','Restore\x20canceled\x20by\x20user.','&client_id=','400876EscnHL','12996704GvVdLI','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://api.dropbox.com/oauth2/token','Folder\x20already\x20exists','nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20logout?','Content-Type','json','log','Refreshing\x20token...','alert','/data/','150MrKKiN','code','Wait\x20a\x20little\x20bit...','confirm','Authorization\x20Code:','refreshToken','remove','location','parse','.tag','onload','Do\x20you\x20want\x20to\x20backup\x20','replace','refresh_token','href','active','state','responseText','access_token','7283580QbpZeg','https://api.dropboxapi.com/2/files/create_folder_v2','\x20files\x20from\x20Cloud?','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','No\x20files\x20found\x20to\x20restore.','getItem','1529071zlKvlx','entries','[\x5c?&#]','save','map','4084935BcHSCb','Cloud\x20↦\x20Kabu\x20storage\x20◆','click','Failed\x20to\x20upload\x20file\x20','length','authorization_code','https://api.dropboxapi.com/2/files/list_folder','No\x20refresh\x20token','Error\x20while\x20refreshing\x20token:','\x20files\x20in\x20Kabu?','folder','addEventListener','4OBenpJ','35734365CnHCxd','&token_access_type=','POST','code=','https://www.dropbox.com/oauth2/authorize?client_id=','Backing\x20up...'];a0_0x21ad=function(){return _0x34ec12;};return a0_0x21ad();}import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x143f25(0x144);function authorizeWithDropbox(){var _0x13273c=a0_0x143f25,_0x18a51d=window['location']['href'][_0x13273c(0x185)]('?')[0x0],_0x254b3d=_0x13273c(0x14d),_0x4d6db4='offline',_0x458a13=_0x13273c(0x17b)+clientId+'&response_type='+_0x254b3d+_0x13273c(0x178)+_0x4d6db4+_0x13273c(0x186)+encodeURIComponent(_0x18a51d);window[_0x13273c(0x153)][_0x13273c(0x15a)]=_0x458a13;}function handleDropboxCallback(){var _0x396b30=a0_0x143f25,_0x5d37a6=getUrlParameter(_0x396b30(0x14d));_0x5d37a6?(getAccessToken(_0x5d37a6),console['log'](_0x396b30(0x150),_0x5d37a6)):console[_0x396b30(0x148)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x448c1c){var _0x488ffe=a0_0x143f25;_0x448c1c=_0x448c1c[_0x488ffe(0x158)](/[\[]/,'\x5c[')[_0x488ffe(0x158)](/[\]]/,'\x5c]');var _0x18b254=new RegExp(_0x488ffe(0x167)+_0x448c1c+'=([^&#]*)'),_0x11790a=_0x18b254[_0x488ffe(0x17e)](location[_0x488ffe(0x183)]);return _0x11790a===null?'':decodeURIComponent(_0x11790a[0x1][_0x488ffe(0x158)](/\+/g,'\x20'));}function getAccessToken(_0x105448){var _0x160516=a0_0x143f25,_0x54e543=_0x160516(0x16f),_0x4c44ac=window[_0x160516(0x153)][_0x160516(0x15a)]['split']('?')[0x0],_0x441d3c=new XMLHttpRequest();_0x441d3c['open']('POST',_0x160516(0x142)),_0x441d3c['setRequestHeader'](_0x160516(0x146),_0x160516(0x17f)),_0x441d3c[_0x160516(0x156)]=function(){var _0x2df399=_0x160516;if(_0x441d3c[_0x2df399(0x192)]===0xc8){var _0x2e7738=JSON[_0x2df399(0x154)](_0x441d3c[_0x2df399(0x15d)]),_0x2f20df=_0x2e7738[_0x2df399(0x15e)],_0xd34fe0=_0x2e7738[_0x2df399(0x159)],_0x547290=_0x2e7738['uid'];localStorage['setItem'](_0x2df399(0x18b),_0x2f20df),localStorage[_0x2df399(0x184)]('refreshToken',_0xd34fe0),localStorage['setItem']('uId',_0x547290);}else console[_0x2df399(0x148)](_0x2df399(0x162));},_0x441d3c['send'](_0x160516(0x17a)+_0x105448+'&grant_type='+_0x54e543+_0x160516(0x13e)+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4c44ac));}export async function dpCreateFolder(_0x17181d){var _0x4f43c4=a0_0x143f25;const _0x343aa7=localStorage['getItem'](_0x4f43c4(0x188));let _0x2a6518=localStorage['getItem'](_0x4f43c4(0x18b));const _0x5e14bf='/'+_0x343aa7+'/'+_0x17181d,_0xb31b53=JSON[_0x4f43c4(0x190)]({'path':_0x5e14bf,'autorename':![]});for(let _0x104d32=0x0;_0x104d32<0x2;_0x104d32++){try{const _0x348868=await fetch(_0x4f43c4(0x160),{'method':'POST','headers':{'Authorization':_0x4f43c4(0x138)+_0x2a6518,'Content-Type':'application/json'},'body':_0xb31b53});if(_0x348868[_0x4f43c4(0x192)]===0x191){const _0xdda302=await dpRefreshToken();if(!_0xdda302)throw new Error(_0x4f43c4(0x13a));_0x2a6518=localStorage[_0x4f43c4(0x164)](_0x4f43c4(0x18b));continue;}if(_0x348868[_0x4f43c4(0x192)]===0x199)return{'message':_0x4f43c4(0x143),'path':_0x17181d};if(!_0x348868['ok'])throw new Error(_0x4f43c4(0x18f)+_0x17181d);const _0x9549fc=await _0x348868[_0x4f43c4(0x147)]();return await lockNoti('Folder\x20created','',0xbb8),_0x9549fc;}catch(_0x534ec4){if(_0x104d32===0x1)throw _0x534ec4;}}return![];}export async function dpRefreshToken(){var _0xff5d40=a0_0x143f25;if(!localStorage[_0xff5d40(0x164)](_0xff5d40(0x151)))throw _0xff5d40(0x171);try{const _0x4e68b8=await fetch(_0xff5d40(0x189),{'method':_0xff5d40(0x179),'headers':{'Content-Type':_0xff5d40(0x17f)},'body':'refresh_token='+localStorage['getItem'](_0xff5d40(0x151))+_0xff5d40(0x180)}),_0x514599=await _0x4e68b8[_0xff5d40(0x147)]();if(!_0x514599[_0xff5d40(0x191)])return localStorage[_0xff5d40(0x184)](_0xff5d40(0x18b),_0x514599[_0xff5d40(0x15e)]),await lockNoti(_0xff5d40(0x149),'',0xbb8),await delay(0x3e8),!![];else alert(_0x514599['error_description']||_0xff5d40(0x141));}catch(_0x5e1f50){console[_0xff5d40(0x191)](_0xff5d40(0x172),_0x5e1f50);}return![];}function a0_0x2dc3(_0x284dcc,_0x390e91){var _0x21ad09=a0_0x21ad();return a0_0x2dc3=function(_0x2dc394,_0x3f9edb){_0x2dc394=_0x2dc394-0x135;var _0x314354=_0x21ad09[_0x2dc394];return _0x314354;},a0_0x2dc3(_0x284dcc,_0x390e91);}export async function dpUploadFile(_0x4428b2,_0x412a70,_0x404d52){var _0x33742b=a0_0x143f25;const _0x5737d3=localStorage[_0x33742b(0x164)](_0x33742b(0x188));var _0x5678cf=JSON[_0x33742b(0x190)]({'autorename':!![],'mode':_0x33742b(0x18a),'mute':!![],'strict_conflict':![],'path':'/'+_0x5737d3+'/'+_0x404d52+'/'+_0x4428b2}),_0x5a359f=new Blob([_0x412a70],{'type':'application/octet-stream'});for(var _0x24c7f9=0x0;_0x24c7f9<0x2;_0x24c7f9++){var _0x56fd6b=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x33742b(0x138)+localStorage[_0x33742b(0x164)]('accessToken'),'Dropbox-API-Arg':_0x5678cf,'Content-Type':'application/octet-stream'},'body':_0x5a359f});if(_0x56fd6b[_0x33742b(0x192)]!=0xc8){if(_0x56fd6b['status']==0x191){var _0x3c7548=await dpRefreshToken();if(!_0x3c7548)throw _0x33742b(0x13a);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x56fd6b[_0x33742b(0x192)];}else{var _0x3dcc07=await _0x56fd6b[_0x33742b(0x147)]();return console['log'](_0x33742b(0x136),_0x4428b2),_0x3dcc07;}}return![];}export async function dpDownloadFile(_0x3511bf,_0x242eb1){var _0x3b0d06=a0_0x143f25;const _0x44111f=localStorage[_0x3b0d06(0x164)](_0x3b0d06(0x188));var _0x15f50a=JSON[_0x3b0d06(0x190)]({'path':'/'+_0x44111f+'/'+_0x242eb1+'/'+_0x3511bf});for(var _0x33d7ef=0x0;_0x33d7ef<0x2;_0x33d7ef++){var _0x1673d4=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x3b0d06(0x179),'headers':{'Authorization':_0x3b0d06(0x138)+localStorage['getItem'](_0x3b0d06(0x18b)),'Dropbox-API-Arg':_0x15f50a}});if(_0x1673d4['status']!=0xc8){if(_0x1673d4[_0x3b0d06(0x192)]==0x191){var _0x24d1a2=await dpRefreshToken();if(!_0x24d1a2)throw _0x3b0d06(0x13a);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x1673d4[_0x3b0d06(0x192)];}const _0x14777c=new File([await _0x1673d4[_0x3b0d06(0x18d)]()],_0x3511bf);return console[_0x3b0d06(0x148)](_0x3b0d06(0x16b),_0x14777c[_0x3b0d06(0x187)]),a0_0x493962['uploadFileInCloud'](_0x14777c,()=>{}),_0x14777c;}return![];}document[a0_0x143f25(0x175)](a0_0x143f25(0x137),function(){var _0x2fa636=a0_0x143f25;dropboxRestore[_0x2fa636(0x175)](_0x2fa636(0x16c),async function(){var _0x59b1e5=_0x2fa636;await lockNoti(_0x59b1e5(0x14e),'',0x1388);const _0x1d6668=localStorage[_0x59b1e5(0x164)]('uId'),_0x26f99a=[_0x59b1e5(0x15c),_0x59b1e5(0x168),_0x59b1e5(0x17d)];if(!_0x1d6668){window['alert'](_0x59b1e5(0x18e));return;}let _0x58091e=[];for(const _0x127676 of _0x26f99a){let _0x5b9460={'path':'/'+_0x1d6668+'/'+_0x127676};for(let _0x1b92db=0x0;_0x1b92db<0x2;_0x1b92db++){let _0x37335e=await fetch(_0x59b1e5(0x170),{'method':_0x59b1e5(0x179),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x59b1e5(0x18b)),'Content-Type':'application/json'},'body':JSON[_0x59b1e5(0x190)](_0x5b9460)});if(_0x37335e[_0x59b1e5(0x192)]===0xc8){let _0x3de987=await _0x37335e[_0x59b1e5(0x147)](),_0x1741e0=_0x3de987[_0x59b1e5(0x166)][_0x59b1e5(0x18c)](_0x377514=>_0x377514[_0x59b1e5(0x155)]==='file');_0x1741e0[_0x59b1e5(0x16e)]>0x0&&_0x58091e[_0x59b1e5(0x182)](..._0x1741e0[_0x59b1e5(0x169)](_0x4aed71=>({'name':_0x4aed71[_0x59b1e5(0x187)],'folder':_0x127676})));break;}else{if(_0x37335e[_0x59b1e5(0x192)]===0x191){let _0x21554a=await dpRefreshToken();if(!_0x21554a)throw _0x59b1e5(0x13a);}else{console['error'](_0x59b1e5(0x13c)+_0x127676+_0x59b1e5(0x139)+_0x37335e[_0x59b1e5(0x192)]);break;}}}}if(_0x58091e['length']>0x0){const _0x9be7c1='Do\x20you\x20want\x20to\x20restore\x20'+_0x58091e[_0x59b1e5(0x16e)]+_0x59b1e5(0x161);if(window[_0x59b1e5(0x14f)](_0x9be7c1))for(const _0x372a4a of _0x58091e){await lockNoti('Restoring...',_0x372a4a[_0x59b1e5(0x187)],0xbb8),await dpDownloadFile(_0x372a4a[_0x59b1e5(0x187)],_0x372a4a[_0x59b1e5(0x174)]);}else console[_0x59b1e5(0x148)](_0x59b1e5(0x13d));}else console[_0x59b1e5(0x148)](_0x59b1e5(0x163));}),dropboxBackup[_0x2fa636(0x175)](_0x2fa636(0x16c),async function(){var _0x5158e1=_0x2fa636;await lockNoti(_0x5158e1(0x14e),'',0x1388);const _0x5603bd=localStorage[_0x5158e1(0x164)](_0x5158e1(0x188));if(_0x5603bd===null||_0x5603bd==='')window[_0x5158e1(0x14a)](_0x5158e1(0x18e));else{const _0x2f0a67=[_0x5158e1(0x15c),_0x5158e1(0x168),'screenshot'];for(const _0x4ba0ce of _0x2f0a67){await dpCreateFolder(_0x4ba0ce);}let _0x3af032=0x0;for(const _0xbfb499 of _0x2f0a67){const _0x2f60bd=a0_0x493962['listFiles'](_0xbfb499+'s');_0x3af032+=_0x2f60bd[_0x5158e1(0x16e)];}if(window[_0x5158e1(0x14f)](_0x5158e1(0x157)+_0x3af032+_0x5158e1(0x173)))for(const _0x35cfab of _0x2f0a67){const _0x37984c=a0_0x493962['listFiles'](_0x35cfab+'s');for(const _0x4db3e5 of _0x37984c){const _0x5f0a57=await a0_0x493962[_0x5158e1(0x13b)](_0x5158e1(0x14b)+_0x35cfab+'s/'+_0x4db3e5);try{await lockNoti(_0x5158e1(0x17c),_0x4db3e5,0xbb8),await dpUploadFile(_0x4db3e5,_0x5f0a57,_0x35cfab);}catch(_0x241682){console[_0x5158e1(0x191)](_0x5158e1(0x16d)+_0x4db3e5+':',_0x241682);}}}else console[_0x5158e1(0x148)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x2fa636(0x175)](_0x2fa636(0x16c),function(){var _0x2eeb86=_0x2fa636;const _0x59f81d=localStorage[_0x2eeb86(0x164)](_0x2eeb86(0x188));_0x59f81d===null||_0x59f81d===''?authorizeWithDropbox():window[_0x2eeb86(0x14f)](_0x2eeb86(0x145))&&(localStorage[_0x2eeb86(0x184)](_0x2eeb86(0x188),''),dropboxRestore[_0x2eeb86(0x181)]['remove'](_0x2eeb86(0x15b)),dropboxBackup[_0x2eeb86(0x181)][_0x2eeb86(0x152)]('active'),dropboxCloud[_0x2eeb86(0x181)]['remove'](_0x2eeb86(0x15b)));}),handleDropboxCallback();});