var a0_0x21cdfb=a0_0xb4bc;(function(_0x20f566,_0xd7c3d4){var _0x26d6e7=a0_0xb4bc,_0x29ace9=_0x20f566();while(!![]){try{var _0x3eccf8=-parseInt(_0x26d6e7(0x1eb))/0x1+parseInt(_0x26d6e7(0x1e9))/0x2*(-parseInt(_0x26d6e7(0x20f))/0x3)+-parseInt(_0x26d6e7(0x1d4))/0x4*(-parseInt(_0x26d6e7(0x1ef))/0x5)+-parseInt(_0x26d6e7(0x21d))/0x6*(parseInt(_0x26d6e7(0x1f3))/0x7)+-parseInt(_0x26d6e7(0x211))/0x8+-parseInt(_0x26d6e7(0x1d8))/0x9+parseInt(_0x26d6e7(0x1ce))/0xa;if(_0x3eccf8===_0xd7c3d4)break;else _0x29ace9['push'](_0x29ace9['shift']());}catch(_0xe591a8){_0x29ace9['push'](_0x29ace9['shift']());}}}(a0_0x5e36,0xada58));import*as a0_0x30a57f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x21cdfb(0x222),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x1d1ea5=a0_0x21cdfb,_0x486229=window[_0x1d1ea5(0x1cc)][_0x1d1ea5(0x1e4)][_0x1d1ea5(0x21e)]('?')[0x0],_0x3b0bfc=_0x1d1ea5(0x1cf),_0x5c0a65=_0x1d1ea5(0x1e1),_0x4a0ed0='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x1d1ea5(0x1ca)+_0x3b0bfc+'&token_access_type='+_0x5c0a65+'&redirect_uri='+encodeURIComponent(_0x486229);window[_0x1d1ea5(0x1cc)][_0x1d1ea5(0x1e4)]=_0x4a0ed0;}function handleDropboxCallback(){var _0x51399a=a0_0x21cdfb,_0x2a69bd=getUrlParameter(_0x51399a(0x1cf));_0x2a69bd?(getAccessToken(_0x2a69bd),console[_0x51399a(0x1ea)](_0x51399a(0x1f4),_0x2a69bd)):console[_0x51399a(0x1ea)](_0x51399a(0x228));}function getUrlParameter(_0x77ae74){var _0x12079=a0_0x21cdfb;_0x77ae74=_0x77ae74[_0x12079(0x20c)](/[\[]/,'\x5c[')[_0x12079(0x20c)](/[\]]/,'\x5c]');var _0x3ef38c=new RegExp(_0x12079(0x1e2)+_0x77ae74+_0x12079(0x1d7)),_0x27de79=_0x3ef38c[_0x12079(0x1e3)](location['search']);return _0x27de79===null?'':decodeURIComponent(_0x27de79[0x1][_0x12079(0x20c)](/\+/g,'\x20'));}function getAccessToken(_0x6ebeea){var _0x42629f=a0_0x21cdfb,_0x272ebb='authorization_code',_0x54ebc2=window[_0x42629f(0x1cc)][_0x42629f(0x1e4)][_0x42629f(0x21e)]('?')[0x0],_0x5aa7d9=new XMLHttpRequest();_0x5aa7d9[_0x42629f(0x1c9)](_0x42629f(0x20e),_0x42629f(0x229)),_0x5aa7d9[_0x42629f(0x1d3)](_0x42629f(0x205),'application/x-www-form-urlencoded'),_0x5aa7d9[_0x42629f(0x1d6)]=function(){var _0xeeef98=_0x42629f;if(_0x5aa7d9[_0xeeef98(0x1ec)]===0xc8){var _0x4aade4=JSON[_0xeeef98(0x207)](_0x5aa7d9[_0xeeef98(0x21a)]),_0x1763bb=_0x4aade4[_0xeeef98(0x1e0)],_0x571283=_0x4aade4['refresh_token'],_0x1802cf=_0x4aade4['uid'];localStorage['setItem'](_0xeeef98(0x22a),_0x1763bb),localStorage[_0xeeef98(0x233)](_0xeeef98(0x1fd),_0x571283),localStorage[_0xeeef98(0x233)](_0xeeef98(0x1e5),_0x1802cf);}else console[_0xeeef98(0x1ea)](_0xeeef98(0x1f9));},_0x5aa7d9[_0x42629f(0x1ff)](_0x42629f(0x1d0)+_0x6ebeea+_0x42629f(0x1f8)+_0x272ebb+_0x42629f(0x1e8)+clientId+_0x42629f(0x1f2)+clientSecret+_0x42629f(0x1cd)+encodeURIComponent(_0x54ebc2));}function a0_0xb4bc(_0x39fcd7,_0x348424){var _0x5e3647=a0_0x5e36();return a0_0xb4bc=function(_0xb4bc1e,_0x1bd6aa){_0xb4bc1e=_0xb4bc1e-0x1c9;var _0x47ab74=_0x5e3647[_0xb4bc1e];return _0x47ab74;},a0_0xb4bc(_0x39fcd7,_0x348424);}export async function dpCreateFolder(_0x153532){var _0x236589=a0_0x21cdfb;const _0x229e90=localStorage[_0x236589(0x1f0)](_0x236589(0x1e5));let _0x309baf=localStorage[_0x236589(0x1f0)](_0x236589(0x22a));const _0x50c55b='/'+_0x229e90+'/'+_0x153532,_0x135a7f=JSON[_0x236589(0x22e)]({'path':_0x50c55b,'autorename':![]});for(let _0x5bde75=0x0;_0x5bde75<0x2;_0x5bde75++){try{const _0x27c94b=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x236589(0x20e),'headers':{'Authorization':'Bearer\x20'+_0x309baf,'Content-Type':_0x236589(0x231)},'body':_0x135a7f});if(_0x27c94b[_0x236589(0x1ec)]===0x191){const _0x6b4709=await dpRefreshToken();if(!_0x6b4709)throw new Error('Unable\x20to\x20refresh\x20token');_0x309baf=localStorage[_0x236589(0x1f0)](_0x236589(0x22a));continue;}if(_0x27c94b[_0x236589(0x1ec)]===0x199)return{'message':_0x236589(0x1f7),'path':_0x153532};if(!_0x27c94b['ok'])throw new Error(_0x236589(0x22c)+_0x153532);const _0xdf3d0d=await _0x27c94b[_0x236589(0x1df)]();return await lockNoti(_0x236589(0x1f6),'',0xbb8),_0xdf3d0d;}catch(_0x3b1b86){if(_0x5bde75===0x1)throw _0x3b1b86;}}return![];}export async function dpRefreshToken(){var _0x4a8cbf=a0_0x21cdfb;if(!localStorage['getItem'](_0x4a8cbf(0x1fd)))throw _0x4a8cbf(0x22b);try{const _0x18f18d=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x4a8cbf(0x20e),'headers':{'Content-Type':_0x4a8cbf(0x1fa)},'body':_0x4a8cbf(0x1dd)+localStorage['getItem'](_0x4a8cbf(0x1fd))+_0x4a8cbf(0x227)}),_0x11aa24=await _0x18f18d[_0x4a8cbf(0x1df)]();if(!_0x11aa24[_0x4a8cbf(0x208)])return localStorage['setItem'](_0x4a8cbf(0x22a),_0x11aa24[_0x4a8cbf(0x1e0)]),await lockNoti(_0x4a8cbf(0x1e7),'',0xbb8),await delay(0x3e8),!![];else alert(_0x11aa24[_0x4a8cbf(0x1d5)]||_0x4a8cbf(0x201));}catch(_0x4c60b5){console[_0x4a8cbf(0x208)](_0x4a8cbf(0x22d),_0x4c60b5);}return![];}export async function dpUploadFile(_0x766c43,_0x47b354,_0x4b2596){var _0x2be0b4=a0_0x21cdfb;const _0x430943=localStorage[_0x2be0b4(0x1f0)]('uId');var _0x262920=JSON[_0x2be0b4(0x22e)]({'autorename':!![],'mode':_0x2be0b4(0x219),'mute':!![],'strict_conflict':![],'path':'/'+_0x430943+'/'+_0x4b2596+'/'+_0x766c43}),_0x712f34=new Blob([_0x47b354],{'type':_0x2be0b4(0x1dc)});for(var _0x32ab52=0x0;_0x32ab52<0x2;_0x32ab52++){var _0x59188b=await fetch(_0x2be0b4(0x20a),{'method':_0x2be0b4(0x20e),'headers':{'Authorization':_0x2be0b4(0x226)+localStorage[_0x2be0b4(0x1f0)](_0x2be0b4(0x22a)),'Dropbox-API-Arg':_0x262920,'Content-Type':_0x2be0b4(0x1dc)},'body':_0x712f34});if(_0x59188b[_0x2be0b4(0x1ec)]!=0xc8){if(_0x59188b['status']==0x191){var _0x1a56c9=await dpRefreshToken();if(!_0x1a56c9)throw _0x2be0b4(0x217);continue;}else throw _0x2be0b4(0x214)+_0x59188b['status'];}else{var _0x32df5d=await _0x59188b['json']();return console[_0x2be0b4(0x1ea)](_0x2be0b4(0x1ed),_0x766c43),_0x32df5d;}}return![];}export async function dpDownloadFile(_0x22f6e6,_0x52aab3){var _0x34de7c=a0_0x21cdfb;const _0x59ada4=localStorage[_0x34de7c(0x1f0)]('uId');var _0x47abbf=JSON[_0x34de7c(0x22e)]({'path':'/'+_0x59ada4+'/'+_0x52aab3+'/'+_0x22f6e6});for(var _0x349f90=0x0;_0x349f90<0x2;_0x349f90++){var _0x64828e=await fetch(_0x34de7c(0x21f),{'method':_0x34de7c(0x20e),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x34de7c(0x1f0)]('accessToken'),'Dropbox-API-Arg':_0x47abbf}});if(_0x64828e[_0x34de7c(0x1ec)]!=0xc8){if(_0x64828e[_0x34de7c(0x1ec)]==0x191){var _0x1643da=await dpRefreshToken();if(!_0x1643da)throw _0x34de7c(0x217);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x64828e[_0x34de7c(0x1ec)];}const _0xaae7da=new File([await _0x64828e[_0x34de7c(0x1fb)]()],_0x22f6e6);return console[_0x34de7c(0x1ea)](_0x34de7c(0x1d2),_0xaae7da[_0x34de7c(0x225)]),a0_0x30a57f[_0x34de7c(0x218)](_0xaae7da,()=>{var _0xe5a62=_0x34de7c;localStorageFile(),Module[_0xe5a62(0x200)]();}),_0xaae7da;}return![];}document[a0_0x21cdfb(0x1fe)](a0_0x21cdfb(0x21b),function(){var _0x15099e=a0_0x21cdfb;dropboxRestore['addEventListener'](_0x15099e(0x22f),async function(){var _0x1764fb=_0x15099e;await lockNoti(_0x1764fb(0x216),'',0x1388);const _0x574675=localStorage[_0x1764fb(0x1f0)](_0x1764fb(0x1e5)),_0x5384f0=[_0x1764fb(0x1f5),'save',_0x1764fb(0x1ee)];if(!_0x574675){window[_0x1764fb(0x224)](_0x1764fb(0x220));return;}let _0x5ba2ad=[];for(const _0x36d2a0 of _0x5384f0){let _0xca7cdd={'path':'/'+_0x574675+'/'+_0x36d2a0};for(let _0x13842c=0x0;_0x13842c<0x2;_0x13842c++){let _0x11a590=await fetch(_0x1764fb(0x204),{'method':_0x1764fb(0x20e),'headers':{'Authorization':_0x1764fb(0x226)+localStorage[_0x1764fb(0x1f0)](_0x1764fb(0x22a)),'Content-Type':_0x1764fb(0x231)},'body':JSON['stringify'](_0xca7cdd)});if(_0x11a590[_0x1764fb(0x1ec)]===0xc8){let _0x3890cc=await _0x11a590['json'](),_0x5a618e=_0x3890cc[_0x1764fb(0x1cb)][_0x1764fb(0x230)](_0x5efb5a=>_0x5efb5a['.tag']===_0x1764fb(0x1fc));_0x5a618e[_0x1764fb(0x1da)]>0x0&&_0x5ba2ad[_0x1764fb(0x212)](..._0x5a618e[_0x1764fb(0x1e6)](_0x9df604=>({'name':_0x9df604[_0x1764fb(0x225)],'folder':_0x36d2a0})));break;}else{if(_0x11a590[_0x1764fb(0x1ec)]===0x191){let _0x47542c=await dpRefreshToken();if(!_0x47542c)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x1764fb(0x208)](_0x1764fb(0x21c)+_0x36d2a0+',\x20status:\x20'+_0x11a590['status']);break;}}}}if(_0x5ba2ad['length']>0x0){const _0x593c19=_0x1764fb(0x232)+_0x5ba2ad[_0x1764fb(0x1da)]+_0x1764fb(0x202);if(window[_0x1764fb(0x215)](_0x593c19))for(const _0x23dea6 of _0x5ba2ad){await lockNoti('Restoring...',_0x23dea6['name'],0xbb8),await dpDownloadFile(_0x23dea6[_0x1764fb(0x225)],_0x23dea6['folder']);}else console[_0x1764fb(0x1ea)]('Restore\x20canceled\x20by\x20user.');}else console[_0x1764fb(0x1ea)](_0x1764fb(0x1f1));}),dropboxBackup[_0x15099e(0x1fe)](_0x15099e(0x22f),async function(){var _0x409df2=_0x15099e;await lockNoti(_0x409df2(0x216),'',0x1388);const _0x5373cb=localStorage['getItem'](_0x409df2(0x1e5));if(_0x5373cb===null||_0x5373cb==='')window['alert'](_0x409df2(0x220));else{const _0x7b7e89=[_0x409df2(0x1f5),_0x409df2(0x206),_0x409df2(0x1ee)];for(const _0x4886d2 of _0x7b7e89){await dpCreateFolder(_0x4886d2);}let _0x33987a=0x0;for(const _0x285335 of _0x7b7e89){const _0x30fb6d=a0_0x30a57f['list'+(_0x285335[_0x409df2(0x210)](0x0)[_0x409df2(0x1db)]()+_0x285335[_0x409df2(0x203)](0x1))]();_0x33987a+=_0x30fb6d['length'];}if(window[_0x409df2(0x215)](_0x409df2(0x1d9)+_0x33987a+_0x409df2(0x221)))for(const _0x1bfdf2 of _0x7b7e89){const _0x4db779=a0_0x30a57f['list'+(_0x1bfdf2['charAt'](0x0)[_0x409df2(0x1db)]()+_0x1bfdf2[_0x409df2(0x203)](0x1))]();for(const _0x5a091c of _0x4db779){const _0x62cd23=await a0_0x30a57f[_0x409df2(0x213)](_0x409df2(0x1d1)+_0x1bfdf2+'s/'+_0x5a091c);try{await lockNoti('Backing\x20up...',_0x5a091c,0xbb8),await dpUploadFile(_0x5a091c,_0x62cd23,_0x1bfdf2);}catch(_0x4968a7){console[_0x409df2(0x208)](_0x409df2(0x209)+_0x5a091c+':',_0x4968a7);}}}else console[_0x409df2(0x1ea)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x15099e(0x1fe)](_0x15099e(0x22f),function(){var _0x3fefe1=_0x15099e;const _0x39df0d=localStorage[_0x3fefe1(0x1f0)](_0x3fefe1(0x1e5));_0x39df0d===null||_0x39df0d===''?authorizeWithDropbox():window[_0x3fefe1(0x215)](_0x3fefe1(0x223))&&(localStorage[_0x3fefe1(0x233)](_0x3fefe1(0x1e5),''),dropboxRestore['classList']['remove'](_0x3fefe1(0x20d)),dropboxBackup[_0x3fefe1(0x1de)][_0x3fefe1(0x20b)]('active'),dropboxCloud['classList'][_0x3fefe1(0x20b)](_0x3fefe1(0x20d)));}),handleDropboxCallback();});function a0_0x5e36(){var _0x7256d8=['addEventListener','send','FSSync','Failed\x20to\x20refresh\x20Dropbox\x20token.','\x20files\x20from\x20Cloud?','slice','https://api.dropboxapi.com/2/files/list_folder','Content-Type','save','parse','error','Failed\x20to\x20upload\x20file\x20','https://content.dropboxapi.com/2/files/upload','remove','replace','active','POST','17781hnZwWl','charAt','8599456PuTEZm','push','downloadFileInCloud','Upload\x20failed,\x20unknown\x20http\x20status:\x20','confirm','Wait\x20a\x20little\x20bit...','Unable\x20to\x20refresh\x20token','uploadFileInCloud','overwrite','responseText','DOMContentLoaded','Download\x20failed\x20for\x20','857484RaMBLV','split','https://content.dropboxapi.com/2/files/download','Cloud\x20login\x20required!','\x20files\x20in\x20Kabu?','knh3uz2mx2hp2eu','Do\x20you\x20want\x20to\x20logout?','alert','name','Bearer\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20not\x20receive\x20authorization','https://api.dropbox.com/oauth2/token','accessToken','No\x20refresh\x20token','Error\x20creating\x20folder\x20','Error\x20while\x20refreshing\x20token:','stringify','click','filter','application/json','Do\x20you\x20want\x20to\x20restore\x20','setItem','open','&response_type=','entries','location','&redirect_uri=','37840210NwnwLf','code','code=','/data/','Cloud\x20↦\x20Kabu\x20storage\x20◆','setRequestHeader','8qQZlSJ','error_description','onload','=([^&#]*)','11426634JHqAQq','Do\x20you\x20want\x20to\x20backup\x20','length','toUpperCase','application/octet-stream','refresh_token=','classList','json','access_token','offline','[\x5c?&#]','exec','href','uId','map','Refreshing\x20token...','&client_id=','164kfTMnL','log','90393KwAnOi','status','Kabu\x20storage\x20↦\x20Cloud\x20◆','screenshot','2121495fjQyTT','getItem','No\x20files\x20found\x20to\x20restore.','&client_secret=','49qgCgma','Authorization\x20Code:','state','Folder\x20created','Folder\x20already\x20exists','&grant_type=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','application/x-www-form-urlencoded','blob','file','refreshToken'];a0_0x5e36=function(){return _0x7256d8;};return a0_0x5e36();}