var a0_0x439746=a0_0x154a;(function(_0x1fb71b,_0x21662a){var _0x4b7d4f=a0_0x154a,_0x8670f9=_0x1fb71b();while(!![]){try{var _0x5daec3=-parseInt(_0x4b7d4f(0x19c))/0x1+parseInt(_0x4b7d4f(0x1c0))/0x2*(parseInt(_0x4b7d4f(0x1c8))/0x3)+parseInt(_0x4b7d4f(0x194))/0x4*(-parseInt(_0x4b7d4f(0x18e))/0x5)+parseInt(_0x4b7d4f(0x1b9))/0x6*(-parseInt(_0x4b7d4f(0x188))/0x7)+-parseInt(_0x4b7d4f(0x1cc))/0x8+parseInt(_0x4b7d4f(0x186))/0x9*(-parseInt(_0x4b7d4f(0x1c6))/0xa)+parseInt(_0x4b7d4f(0x1af))/0xb*(parseInt(_0x4b7d4f(0x1bd))/0xc);if(_0x5daec3===_0x21662a)break;else _0x8670f9['push'](_0x8670f9['shift']());}catch(_0x2e6b61){_0x8670f9['push'](_0x8670f9['shift']());}}}(a0_0x24de,0x95921));import*as a0_0x3cdd16 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x439746(0x17d),clientSecret='nwb3dnfh09rhs31';function a0_0x154a(_0x3bef46,_0x1eb261){var _0x24de31=a0_0x24de();return a0_0x154a=function(_0x154ab6,_0x59f394){_0x154ab6=_0x154ab6-0x171;var _0x2296bc=_0x24de31[_0x154ab6];return _0x2296bc;},a0_0x154a(_0x3bef46,_0x1eb261);}function authorizeWithDropbox(){var _0x1b122e=a0_0x439746,_0x40f3f3=window[_0x1b122e(0x180)][_0x1b122e(0x178)][_0x1b122e(0x17e)]('?')[0x0],_0x5d0d1d=_0x1b122e(0x1ba),_0x82c5d2=_0x1b122e(0x1d0),_0x178f30=_0x1b122e(0x1c2)+clientId+_0x1b122e(0x175)+_0x5d0d1d+_0x1b122e(0x198)+_0x82c5d2+_0x1b122e(0x171)+encodeURIComponent(_0x40f3f3);window['location'][_0x1b122e(0x178)]=_0x178f30;}function handleDropboxCallback(){var _0x336c96=a0_0x439746,_0x4f2fa9=getUrlParameter(_0x336c96(0x1ba));_0x4f2fa9?(getAccessToken(_0x4f2fa9),console['log'](_0x336c96(0x1bc),_0x4f2fa9)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x4d3da1){var _0x12f4d4=a0_0x439746;_0x4d3da1=_0x4d3da1['replace'](/[\[]/,'\x5c[')[_0x12f4d4(0x1c9)](/[\]]/,'\x5c]');var _0x4eee95=new RegExp('[\x5c?&#]'+_0x4d3da1+'=([^&#]*)'),_0x4d6309=_0x4eee95[_0x12f4d4(0x190)](location[_0x12f4d4(0x196)]);return _0x4d6309===null?'':decodeURIComponent(_0x4d6309[0x1][_0x12f4d4(0x1c9)](/\+/g,'\x20'));}function getAccessToken(_0x2a75a9){var _0x15ad9e=a0_0x439746,_0x262059='authorization_code',_0x3c3e2e=window['location'][_0x15ad9e(0x178)][_0x15ad9e(0x17e)]('?')[0x0],_0x15922f=new XMLHttpRequest();_0x15922f['open']('POST',_0x15ad9e(0x177)),_0x15922f[_0x15ad9e(0x1ab)]('Content-Type',_0x15ad9e(0x17a)),_0x15922f['onload']=function(){var _0x393c07=_0x15ad9e;if(_0x15922f[_0x393c07(0x173)]===0xc8){var _0x3c16b7=JSON[_0x393c07(0x1c3)](_0x15922f[_0x393c07(0x1d5)]),_0x435f88=_0x3c16b7[_0x393c07(0x1a4)],_0x4c815b=_0x3c16b7[_0x393c07(0x18c)],_0x44ffdb=_0x3c16b7[_0x393c07(0x1a8)];localStorage[_0x393c07(0x1ac)](_0x393c07(0x1b1),_0x435f88),localStorage[_0x393c07(0x1ac)](_0x393c07(0x18b),_0x4c815b),localStorage[_0x393c07(0x1ac)](_0x393c07(0x181),_0x44ffdb);}else console[_0x393c07(0x1d3)](_0x393c07(0x1c5));},_0x15922f[_0x15ad9e(0x192)](_0x15ad9e(0x1c1)+_0x2a75a9+_0x15ad9e(0x17b)+_0x262059+_0x15ad9e(0x1da)+clientId+_0x15ad9e(0x176)+clientSecret+_0x15ad9e(0x171)+encodeURIComponent(_0x3c3e2e));}export async function dpCreateFolder(_0x1456e6){var _0xc2914=a0_0x439746;const _0x1439be=localStorage[_0xc2914(0x197)](_0xc2914(0x181));let _0x5e5852=localStorage[_0xc2914(0x197)](_0xc2914(0x1b1));const _0x3602a1='/'+_0x1439be+'/'+_0x1456e6,_0x17073e=JSON[_0xc2914(0x1b2)]({'path':_0x3602a1,'autorename':![]});for(let _0x53767e=0x0;_0x53767e<0x2;_0x53767e++){try{const _0x15e719=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0xc2914(0x1a7)+_0x5e5852,'Content-Type':_0xc2914(0x1b5)},'body':_0x17073e});if(_0x15e719[_0xc2914(0x173)]===0x191){const _0x42a33b=await dpRefreshToken();if(!_0x42a33b)throw new Error(_0xc2914(0x1a3));_0x5e5852=localStorage['getItem'](_0xc2914(0x1b1));continue;}if(_0x15e719[_0xc2914(0x173)]===0x199)return{'message':_0xc2914(0x1b4),'path':_0x1456e6};if(!_0x15e719['ok'])throw new Error(_0xc2914(0x1a1)+_0x1456e6);const _0x1c204e=await _0x15e719[_0xc2914(0x1aa)]();return await lockNoti('Folder\x20created','',0xbb8),_0x1c204e;}catch(_0x9d6ae5){if(_0x53767e===0x1)throw _0x9d6ae5;}}return![];}export async function dpRefreshToken(){var _0x1c083d=a0_0x439746;if(!localStorage[_0x1c083d(0x197)](_0x1c083d(0x18b)))throw _0x1c083d(0x174);try{const _0x1adb58=await fetch(_0x1c083d(0x1ad),{'method':_0x1c083d(0x19b),'headers':{'Content-Type':_0x1c083d(0x17a)},'body':_0x1c083d(0x1c7)+localStorage[_0x1c083d(0x197)](_0x1c083d(0x18b))+_0x1c083d(0x179)}),_0xe0f5c3=await _0x1adb58[_0x1c083d(0x1aa)]();if(!_0xe0f5c3[_0x1c083d(0x193)])return localStorage['setItem'](_0x1c083d(0x1b1),_0xe0f5c3[_0x1c083d(0x1a4)]),await lockNoti(_0x1c083d(0x18d),'',0xbb8),await delay(0x3e8),!![];else alert(_0xe0f5c3[_0x1c083d(0x1bf)]||_0x1c083d(0x1b6));}catch(_0x771d1f){console[_0x1c083d(0x193)](_0x1c083d(0x17c),_0x771d1f);}return![];}export async function dpUploadFile(_0xcd3343,_0x11267f,_0x56441a){var _0x515c2a=a0_0x439746;const _0x18c207=localStorage[_0x515c2a(0x197)](_0x515c2a(0x181));var _0x3c9687=JSON[_0x515c2a(0x1b2)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x18c207+'/'+_0x56441a+'/'+_0xcd3343}),_0x32ab69=new Blob([_0x11267f],{'type':_0x515c2a(0x1bb)});for(var _0x2ea4dc=0x0;_0x2ea4dc<0x2;_0x2ea4dc++){var _0x5a6291=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x515c2a(0x19b),'headers':{'Authorization':_0x515c2a(0x1a7)+localStorage[_0x515c2a(0x197)](_0x515c2a(0x1b1)),'Dropbox-API-Arg':_0x3c9687,'Content-Type':_0x515c2a(0x1bb)},'body':_0x32ab69});if(_0x5a6291['status']!=0xc8){if(_0x5a6291[_0x515c2a(0x173)]==0x191){var _0x5cf5aa=await dpRefreshToken();if(!_0x5cf5aa)throw _0x515c2a(0x1a3);continue;}else throw _0x515c2a(0x19d)+_0x5a6291[_0x515c2a(0x173)];}else{var _0xcaa920=await _0x5a6291[_0x515c2a(0x1aa)]();return console[_0x515c2a(0x1d3)](_0x515c2a(0x183),_0xcd3343),_0xcaa920;}}return![];}export async function dpDownloadFile(_0x451cdc,_0x8d96e5){var _0x1251fa=a0_0x439746;const _0x51a3af=localStorage['getItem']('uId');var _0x32d3d3=JSON[_0x1251fa(0x1b2)]({'path':'/'+_0x51a3af+'/'+_0x8d96e5+'/'+_0x451cdc});for(var _0x4713cd=0x0;_0x4713cd<0x2;_0x4713cd++){var _0x39dfaa=await fetch(_0x1251fa(0x19e),{'method':_0x1251fa(0x19b),'headers':{'Authorization':_0x1251fa(0x1a7)+localStorage['getItem'](_0x1251fa(0x1b1)),'Dropbox-API-Arg':_0x32d3d3}});if(_0x39dfaa['status']!=0xc8){if(_0x39dfaa[_0x1251fa(0x173)]==0x191){var _0x3d6b8d=await dpRefreshToken();if(!_0x3d6b8d)throw _0x1251fa(0x1a3);continue;}else throw _0x1251fa(0x187)+_0x39dfaa[_0x1251fa(0x173)];}const _0x833e5a=new File([await _0x39dfaa[_0x1251fa(0x184)]()],_0x451cdc);return console[_0x1251fa(0x1d3)](_0x1251fa(0x1ce),_0x833e5a[_0x1251fa(0x1d8)]),a0_0x3cdd16[_0x1251fa(0x1b7)](_0x833e5a,()=>{var _0x26d2c2=_0x1251fa;localStorageFile(),Module[_0x26d2c2(0x1d9)]();}),_0x833e5a;}return![];}function a0_0x24de(){var _0x527f82=['Bearer\x20','uid','https://api.dropboxapi.com/2/files/list_folder','json','setRequestHeader','setItem','https://api.dropboxapi.com/oauth2/token','Wait\x20a\x20little\x20bit...','7238MJSMUN','length','accessToken','stringify','\x20files\x20in\x20Kabu?','Folder\x20already\x20exists','application/json','Failed\x20to\x20refresh\x20Dropbox\x20token.','uploadFileInCloud','list','3294666CbhmKi','code','application/octet-stream','Authorization\x20Code:','39792BQjqHF','active','error_description','3998PYFoYP','code=','https://www.dropbox.com/oauth2/authorize?client_id=','parse','folder','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','356470IPlEnN','refresh_token=','1083siEzpu','replace','filter','state','3393048fYKWxB','push','Cloud\x20↦\x20Kabu\x20storage\x20◆','addEventListener','offline','Do\x20you\x20want\x20to\x20backup\x20','remove','log','/data/','responseText','slice','screenshot','name','FSSync','&client_id=','confirm','Restore\x20canceled\x20by\x20user.','&redirect_uri=','click','status','No\x20refresh\x20token','&response_type=','&client_secret=','https://api.dropbox.com/oauth2/token','href','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','application/x-www-form-urlencoded','&grant_type=','Error\x20while\x20refreshing\x20token:','knh3uz2mx2hp2eu','split','\x20files\x20from\x20Cloud?','location','uId','Do\x20you\x20want\x20to\x20logout?','Kabu\x20storage\x20↦\x20Cloud\x20◆','blob','Download\x20failed\x20for\x20','225IgbJKt','Download\x20failed,\x20unknown\x20http\x20status:','7EERDHz','alert','toUpperCase','refreshToken','refresh_token','Refreshing\x20token...','365feaBtz','No\x20files\x20found\x20to\x20restore.','exec','charAt','send','error','17724lrlbLZ','.tag','search','getItem','&token_access_type=','Backing\x20up...','Restoring...','POST','103046nhQUGv','Upload\x20failed,\x20unknown\x20http\x20status:\x20','https://content.dropboxapi.com/2/files/download','save','Cloud\x20login\x20required!','Error\x20creating\x20folder\x20','classList','Unable\x20to\x20refresh\x20token','access_token','downloadFileInCloud',',\x20status:\x20'];a0_0x24de=function(){return _0x527f82;};return a0_0x24de();}document['addEventListener']('DOMContentLoaded',function(){var _0xb11b63=a0_0x439746;dropboxRestore[_0xb11b63(0x1cf)](_0xb11b63(0x172),async function(){var _0x31bf4a=_0xb11b63;await lockNoti(_0x31bf4a(0x1ae),'',0x1388);const _0x15e6f8=localStorage[_0x31bf4a(0x197)](_0x31bf4a(0x181)),_0x2a7e3a=[_0x31bf4a(0x1cb),_0x31bf4a(0x19f),_0x31bf4a(0x1d7)];if(!_0x15e6f8){window[_0x31bf4a(0x189)](_0x31bf4a(0x1a0));return;}let _0x7734f0=[];for(const _0xe16230 of _0x2a7e3a){let _0x1b9c47={'path':'/'+_0x15e6f8+'/'+_0xe16230};for(let _0x1ca958=0x0;_0x1ca958<0x2;_0x1ca958++){let _0x280eee=await fetch(_0x31bf4a(0x1a9),{'method':_0x31bf4a(0x19b),'headers':{'Authorization':_0x31bf4a(0x1a7)+localStorage['getItem'](_0x31bf4a(0x1b1)),'Content-Type':_0x31bf4a(0x1b5)},'body':JSON[_0x31bf4a(0x1b2)](_0x1b9c47)});if(_0x280eee[_0x31bf4a(0x173)]===0xc8){let _0x4ed8bb=await _0x280eee['json'](),_0x36a8d9=_0x4ed8bb['entries'][_0x31bf4a(0x1ca)](_0x113e85=>_0x113e85[_0x31bf4a(0x195)]==='file');_0x36a8d9['length']>0x0&&_0x7734f0[_0x31bf4a(0x1cd)](..._0x36a8d9['map'](_0x5dc677=>({'name':_0x5dc677['name'],'folder':_0xe16230})));break;}else{if(_0x280eee[_0x31bf4a(0x173)]===0x191){let _0x221bbd=await dpRefreshToken();if(!_0x221bbd)throw _0x31bf4a(0x1a3);}else{console[_0x31bf4a(0x193)](_0x31bf4a(0x185)+_0xe16230+_0x31bf4a(0x1a6)+_0x280eee['status']);break;}}}}if(_0x7734f0[_0x31bf4a(0x1b0)]>0x0){const _0x43f320='Do\x20you\x20want\x20to\x20restore\x20'+_0x7734f0[_0x31bf4a(0x1b0)]+_0x31bf4a(0x17f);if(window[_0x31bf4a(0x1db)](_0x43f320))for(const _0x57d65f of _0x7734f0){await lockNoti(_0x31bf4a(0x19a),_0x57d65f[_0x31bf4a(0x1d8)],0xbb8),await dpDownloadFile(_0x57d65f[_0x31bf4a(0x1d8)],_0x57d65f[_0x31bf4a(0x1c4)]);}else console[_0x31bf4a(0x1d3)](_0x31bf4a(0x1dc));}else console[_0x31bf4a(0x1d3)](_0x31bf4a(0x18f));}),dropboxBackup[_0xb11b63(0x1cf)](_0xb11b63(0x172),async function(){var _0x294ab3=_0xb11b63;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x17185a=localStorage['getItem'](_0x294ab3(0x181));if(_0x17185a===null||_0x17185a==='')window['alert'](_0x294ab3(0x1a0));else{const _0x3bb65d=[_0x294ab3(0x1cb),'save',_0x294ab3(0x1d7)];for(const _0x100f88 of _0x3bb65d){await dpCreateFolder(_0x100f88);}let _0xdd72b9=0x0;for(const _0x540e40 of _0x3bb65d){const _0x5c6905=a0_0x3cdd16[_0x294ab3(0x1b8)+(_0x540e40[_0x294ab3(0x191)](0x0)['toUpperCase']()+_0x540e40[_0x294ab3(0x1d6)](0x1))]();_0xdd72b9+=_0x5c6905[_0x294ab3(0x1b0)];}if(window[_0x294ab3(0x1db)](_0x294ab3(0x1d1)+_0xdd72b9+_0x294ab3(0x1b3)))for(const _0x4cec9d of _0x3bb65d){const _0x586d16=a0_0x3cdd16['list'+(_0x4cec9d['charAt'](0x0)[_0x294ab3(0x18a)]()+_0x4cec9d[_0x294ab3(0x1d6)](0x1))]();for(const _0x58c31c of _0x586d16){const _0x4e54ae=await a0_0x3cdd16[_0x294ab3(0x1a5)](_0x294ab3(0x1d4)+_0x4cec9d+'s/'+_0x58c31c);try{await lockNoti(_0x294ab3(0x199),_0x58c31c,0xbb8),await dpUploadFile(_0x58c31c,_0x4e54ae,_0x4cec9d);}catch(_0x21576d){console[_0x294ab3(0x193)]('Failed\x20to\x20upload\x20file\x20'+_0x58c31c+':',_0x21576d);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0xb11b63(0x1cf)](_0xb11b63(0x172),function(){var _0x2a4c19=_0xb11b63;const _0x2343f3=localStorage[_0x2a4c19(0x197)](_0x2a4c19(0x181));_0x2343f3===null||_0x2343f3===''?authorizeWithDropbox():window['confirm'](_0x2a4c19(0x182))&&(localStorage[_0x2a4c19(0x1ac)](_0x2a4c19(0x181),''),dropboxRestore['classList'][_0x2a4c19(0x1d2)](_0x2a4c19(0x1be)),dropboxBackup['classList']['remove'](_0x2a4c19(0x1be)),dropboxCloud[_0x2a4c19(0x1a2)]['remove'](_0x2a4c19(0x1be)));}),handleDropboxCallback();});