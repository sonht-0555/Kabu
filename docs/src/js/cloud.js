var a0_0x4126fe=a0_0x2b5f;(function(_0x533acd,_0x399dc4){var _0x5b08a0=a0_0x2b5f,_0x379c6b=_0x533acd();while(!![]){try{var _0x5d9c39=-parseInt(_0x5b08a0(0x153))/0x1+parseInt(_0x5b08a0(0x126))/0x2+parseInt(_0x5b08a0(0x155))/0x3+-parseInt(_0x5b08a0(0x163))/0x4*(parseInt(_0x5b08a0(0x178))/0x5)+parseInt(_0x5b08a0(0x179))/0x6+parseInt(_0x5b08a0(0x11c))/0x7*(-parseInt(_0x5b08a0(0x138))/0x8)+parseInt(_0x5b08a0(0x145))/0x9;if(_0x5d9c39===_0x399dc4)break;else _0x379c6b['push'](_0x379c6b['shift']());}catch(_0x5937c9){_0x379c6b['push'](_0x379c6b['shift']());}}}(a0_0x38f2,0xacc49));import*as a0_0x30bf48 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x4126fe(0x135);function authorizeWithDropbox(){var _0x4a8169=a0_0x4126fe,_0x5d8b71=window[_0x4a8169(0x137)][_0x4a8169(0x169)][_0x4a8169(0x120)]('?')[0x0],_0x22169b=_0x4a8169(0x156),_0x8c978a=_0x4a8169(0x131),_0x5743f8='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x4a8169(0x116)+_0x22169b+'&token_access_type='+_0x8c978a+_0x4a8169(0x170)+encodeURIComponent(_0x5d8b71);window['location'][_0x4a8169(0x169)]=_0x5743f8;}function handleDropboxCallback(){var _0x1de5f5=a0_0x4126fe,_0x59a0d4=getUrlParameter(_0x1de5f5(0x156));_0x59a0d4?(getAccessToken(_0x59a0d4),console['log']('Authorization\x20Code:',_0x59a0d4)):console[_0x1de5f5(0x11d)](_0x1de5f5(0x15f));}function getUrlParameter(_0x4a3ea7){var _0x563a8b=a0_0x4126fe;_0x4a3ea7=_0x4a3ea7['replace'](/[\[]/,'\x5c[')[_0x563a8b(0x117)](/[\]]/,'\x5c]');var _0x35bd02=new RegExp(_0x563a8b(0x171)+_0x4a3ea7+'=([^&#]*)'),_0x313466=_0x35bd02[_0x563a8b(0x15b)](location['search']);return _0x313466===null?'':decodeURIComponent(_0x313466[0x1][_0x563a8b(0x117)](/\+/g,'\x20'));}function a0_0x38f2(){var _0x44c431=['Wait\x20a\x20little\x20bit...','https://api.dropboxapi.com/oauth2/token','save','exec','Restore\x20canceled\x20by\x20user.','state','&client_id=','Do\x20not\x20receive\x20authorization','Error\x20while\x20refreshing\x20token:','Cloud\x20↦\x20Kabu\x20storage\x20◆','refresh_token','52vnGWKM','setItem','Bearer\x20','Content-Type',',\x20status:\x20','Download\x20failed,\x20unknown\x20http\x20status:','href','Do\x20you\x20want\x20to\x20backup\x20','\x20files\x20from\x20Cloud?','https://api.dropbox.com/oauth2/token','downloadFileInCloud','Do\x20you\x20want\x20to\x20restore\x20','No\x20files\x20found\x20to\x20restore.','&redirect_uri=','[\x5c?&#]','application/x-www-form-urlencoded','uId','click','https://api.dropboxapi.com/2/files/create_folder_v2','code=','&client_secret=','148730exXNjw','7500042vYMUzh','/data/','stringify','entries','length','&response_type=','replace','Unable\x20to\x20refresh\x20token','file','setRequestHeader','Refreshing\x20token...','686KXWfVP','log','json','Backing\x20up...','split','overwrite','https://content.dropboxapi.com/2/files/download','Failed\x20to\x20upload\x20file\x20','POST','blob','1078310euDSCS','alert','responseText','push','Folder\x20created','parse','error_description','access_token','Cloud\x20login\x20required!','open','application/octet-stream','offline','screenshot','accessToken','name','nwb3dnfh09rhs31','.tag','location','91832iWqzve','filter','Folder\x20already\x20exists','uploadFileInCloud','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','addEventListener','listFiles','refreshToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','folder','https://content.dropboxapi.com/2/files/upload','status','https://api.dropboxapi.com/2/files/list_folder','1772145iXQEjA','getItem','uid','onload','confirm','send','Do\x20you\x20want\x20to\x20logout?','error','refresh_token=','active','\x20files\x20in\x20Kabu?','remove','authorization_code','classList','299881kQRsqU','DOMContentLoaded','1599333BkuqZU','code','Restoring...'];a0_0x38f2=function(){return _0x44c431;};return a0_0x38f2();}function getAccessToken(_0x1cf87f){var _0x46a3a3=a0_0x4126fe,_0x15879a=_0x46a3a3(0x151),_0x53ec64=window[_0x46a3a3(0x137)][_0x46a3a3(0x169)]['split']('?')[0x0],_0x2a4c10=new XMLHttpRequest();_0x2a4c10[_0x46a3a3(0x12f)]('POST',_0x46a3a3(0x16c)),_0x2a4c10[_0x46a3a3(0x11a)](_0x46a3a3(0x166),_0x46a3a3(0x172)),_0x2a4c10[_0x46a3a3(0x148)]=function(){var _0x53a641=_0x46a3a3;if(_0x2a4c10[_0x53a641(0x143)]===0xc8){var _0x425ec4=JSON[_0x53a641(0x12b)](_0x2a4c10[_0x53a641(0x128)]),_0x59da5b=_0x425ec4[_0x53a641(0x12d)],_0x4a68c7=_0x425ec4[_0x53a641(0x162)],_0x53d9cf=_0x425ec4[_0x53a641(0x147)];localStorage['setItem']('accessToken',_0x59da5b),localStorage[_0x53a641(0x164)](_0x53a641(0x13f),_0x4a68c7),localStorage[_0x53a641(0x164)](_0x53a641(0x173),_0x53d9cf);}else console[_0x53a641(0x11d)](_0x53a641(0x13c));},_0x2a4c10[_0x46a3a3(0x14a)](_0x46a3a3(0x176)+_0x1cf87f+'&grant_type='+_0x15879a+_0x46a3a3(0x15e)+clientId+_0x46a3a3(0x177)+clientSecret+_0x46a3a3(0x170)+encodeURIComponent(_0x53ec64));}export async function dpCreateFolder(_0x46f8e1){var _0x4d48b1=a0_0x4126fe;const _0x2f634d=localStorage[_0x4d48b1(0x146)](_0x4d48b1(0x173));let _0x4ec5de=localStorage['getItem'](_0x4d48b1(0x133));const _0x377ce4='/'+_0x2f634d+'/'+_0x46f8e1,_0x2d0d99=JSON[_0x4d48b1(0x113)]({'path':_0x377ce4,'autorename':![]});for(let _0x439339=0x0;_0x439339<0x2;_0x439339++){try{const _0x233879=await fetch(_0x4d48b1(0x175),{'method':_0x4d48b1(0x124),'headers':{'Authorization':_0x4d48b1(0x165)+_0x4ec5de,'Content-Type':'application/json'},'body':_0x2d0d99});if(_0x233879[_0x4d48b1(0x143)]===0x191){const _0x5820a4=await dpRefreshToken();if(!_0x5820a4)throw new Error('Unable\x20to\x20refresh\x20token');_0x4ec5de=localStorage[_0x4d48b1(0x146)](_0x4d48b1(0x133));continue;}if(_0x233879[_0x4d48b1(0x143)]===0x199)return{'message':_0x4d48b1(0x13a),'path':_0x46f8e1};if(!_0x233879['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x46f8e1);const _0x580cd8=await _0x233879[_0x4d48b1(0x11e)]();return await lockNoti(_0x4d48b1(0x12a),'',0xbb8),_0x580cd8;}catch(_0xfbb2d0){if(_0x439339===0x1)throw _0xfbb2d0;}}return![];}function a0_0x2b5f(_0x11a0c3,_0x49ad23){var _0x38f22c=a0_0x38f2();return a0_0x2b5f=function(_0x2b5f67,_0x5cebc3){_0x2b5f67=_0x2b5f67-0x112;var _0x156709=_0x38f22c[_0x2b5f67];return _0x156709;},a0_0x2b5f(_0x11a0c3,_0x49ad23);}export async function dpRefreshToken(){var _0x461310=a0_0x4126fe;if(!localStorage[_0x461310(0x146)](_0x461310(0x13f)))throw'No\x20refresh\x20token';try{const _0x5c8333=await fetch(_0x461310(0x159),{'method':_0x461310(0x124),'headers':{'Content-Type':_0x461310(0x172)},'body':_0x461310(0x14d)+localStorage['getItem'](_0x461310(0x13f))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x362887=await _0x5c8333[_0x461310(0x11e)]();if(!_0x362887[_0x461310(0x14c)])return localStorage[_0x461310(0x164)](_0x461310(0x133),_0x362887[_0x461310(0x12d)]),await lockNoti(_0x461310(0x11b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x362887[_0x461310(0x12c)]||_0x461310(0x140));}catch(_0x148587){console['error'](_0x461310(0x160),_0x148587);}return![];}export async function dpUploadFile(_0x37888b,_0xe2e4f6,_0x1023d0){var _0x133527=a0_0x4126fe;const _0x217798=localStorage[_0x133527(0x146)](_0x133527(0x173));var _0x57257c=JSON[_0x133527(0x113)]({'autorename':!![],'mode':_0x133527(0x121),'mute':!![],'strict_conflict':![],'path':'/'+_0x217798+'/'+_0x1023d0+'/'+_0x37888b}),_0x2d3a2f=new Blob([_0xe2e4f6],{'type':_0x133527(0x130)});for(var _0x10af7e=0x0;_0x10af7e<0x2;_0x10af7e++){var _0x369412=await fetch(_0x133527(0x142),{'method':_0x133527(0x124),'headers':{'Authorization':_0x133527(0x165)+localStorage[_0x133527(0x146)]('accessToken'),'Dropbox-API-Arg':_0x57257c,'Content-Type':_0x133527(0x130)},'body':_0x2d3a2f});if(_0x369412[_0x133527(0x143)]!=0xc8){if(_0x369412['status']==0x191){var _0x27fea5=await dpRefreshToken();if(!_0x27fea5)throw _0x133527(0x118);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x369412[_0x133527(0x143)];}else{var _0x1c4a8f=await _0x369412[_0x133527(0x11e)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x37888b),_0x1c4a8f;}}return![];}export async function dpDownloadFile(_0x5cbd42,_0x1dd1ed){var _0x6a1723=a0_0x4126fe;const _0x2204ba=localStorage[_0x6a1723(0x146)](_0x6a1723(0x173));var _0x195298=JSON['stringify']({'path':'/'+_0x2204ba+'/'+_0x1dd1ed+'/'+_0x5cbd42});for(var _0x4678b7=0x0;_0x4678b7<0x2;_0x4678b7++){var _0x5256c9=await fetch(_0x6a1723(0x122),{'method':'POST','headers':{'Authorization':_0x6a1723(0x165)+localStorage['getItem'](_0x6a1723(0x133)),'Dropbox-API-Arg':_0x195298}});if(_0x5256c9['status']!=0xc8){if(_0x5256c9['status']==0x191){var _0x3bdadc=await dpRefreshToken();if(!_0x3bdadc)throw _0x6a1723(0x118);continue;}else throw _0x6a1723(0x168)+_0x5256c9[_0x6a1723(0x143)];}const _0x3696f4=new File([await _0x5256c9[_0x6a1723(0x125)]()],_0x5cbd42);return console[_0x6a1723(0x11d)](_0x6a1723(0x161),_0x3696f4[_0x6a1723(0x134)]),a0_0x30bf48[_0x6a1723(0x13b)](_0x3696f4,()=>{}),_0x3696f4;}return![];}document['addEventListener'](a0_0x4126fe(0x154),function(){var _0x595278=a0_0x4126fe;dropboxRestore[_0x595278(0x13d)](_0x595278(0x174),async function(){var _0x27a79b=_0x595278;await lockNoti(_0x27a79b(0x158),'',0x1388);const _0x271ade=localStorage[_0x27a79b(0x146)](_0x27a79b(0x173)),_0x24f94a=[_0x27a79b(0x15d),_0x27a79b(0x15a),_0x27a79b(0x132)];if(!_0x271ade){window[_0x27a79b(0x127)](_0x27a79b(0x12e));return;}let _0x200737=[];for(const _0x2ea5e6 of _0x24f94a){let _0x13a63b={'path':'/'+_0x271ade+'/'+_0x2ea5e6};for(let _0x286dd5=0x0;_0x286dd5<0x2;_0x286dd5++){let _0x5788af=await fetch(_0x27a79b(0x144),{'method':'POST','headers':{'Authorization':_0x27a79b(0x165)+localStorage[_0x27a79b(0x146)](_0x27a79b(0x133)),'Content-Type':'application/json'},'body':JSON[_0x27a79b(0x113)](_0x13a63b)});if(_0x5788af[_0x27a79b(0x143)]===0xc8){let _0x27df33=await _0x5788af[_0x27a79b(0x11e)](),_0x2bf877=_0x27df33[_0x27a79b(0x114)][_0x27a79b(0x139)](_0x39cd3e=>_0x39cd3e[_0x27a79b(0x136)]===_0x27a79b(0x119));_0x2bf877['length']>0x0&&_0x200737[_0x27a79b(0x129)](..._0x2bf877['map'](_0xa9f256=>({'name':_0xa9f256['name'],'folder':_0x2ea5e6})));break;}else{if(_0x5788af[_0x27a79b(0x143)]===0x191){let _0x2eeffe=await dpRefreshToken();if(!_0x2eeffe)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x27a79b(0x14c)]('Download\x20failed\x20for\x20'+_0x2ea5e6+_0x27a79b(0x167)+_0x5788af[_0x27a79b(0x143)]);break;}}}}if(_0x200737['length']>0x0){const _0x307cfc=_0x27a79b(0x16e)+_0x200737[_0x27a79b(0x115)]+_0x27a79b(0x16b);if(window[_0x27a79b(0x149)](_0x307cfc))for(const _0xdf40a7 of _0x200737){await lockNoti(_0x27a79b(0x157),_0xdf40a7[_0x27a79b(0x134)],0xbb8),await dpDownloadFile(_0xdf40a7[_0x27a79b(0x134)],_0xdf40a7[_0x27a79b(0x141)]);}else console[_0x27a79b(0x11d)](_0x27a79b(0x15c));}else console['log'](_0x27a79b(0x16f));}),dropboxBackup[_0x595278(0x13d)](_0x595278(0x174),async function(){var _0x4052fc=_0x595278;await lockNoti(_0x4052fc(0x158),'',0x1388);const _0x1876d9=localStorage['getItem']('uId');if(_0x1876d9===null||_0x1876d9==='')window[_0x4052fc(0x127)]('Cloud\x20login\x20required!');else{const _0x2c0e3f=[_0x4052fc(0x15d),_0x4052fc(0x15a),_0x4052fc(0x132)];for(const _0x2a5e78 of _0x2c0e3f){await dpCreateFolder(_0x2a5e78);}let _0x59a1bb=0x0;for(const _0x17f7cb of _0x2c0e3f){const _0x554fe1=a0_0x30bf48[_0x4052fc(0x13e)](_0x17f7cb+'s');_0x59a1bb+=_0x554fe1[_0x4052fc(0x115)];}if(window[_0x4052fc(0x149)](_0x4052fc(0x16a)+_0x59a1bb+_0x4052fc(0x14f)))for(const _0x2652a9 of _0x2c0e3f){const _0x36b8d6=a0_0x30bf48[_0x4052fc(0x13e)](_0x2652a9+'s');for(const _0x32f066 of _0x36b8d6){const _0x3dfe37=await a0_0x30bf48[_0x4052fc(0x16d)](_0x4052fc(0x112)+_0x2652a9+'s/'+_0x32f066);try{await lockNoti(_0x4052fc(0x11f),_0x32f066,0xbb8),await dpUploadFile(_0x32f066,_0x3dfe37,_0x2652a9);}catch(_0x64c24b){console[_0x4052fc(0x14c)](_0x4052fc(0x123)+_0x32f066+':',_0x64c24b);}}}else console[_0x4052fc(0x11d)](_0x4052fc(0x15c));}}),dropboxCloud[_0x595278(0x13d)](_0x595278(0x174),function(){var _0x29f971=_0x595278;const _0x3eb3ab=localStorage[_0x29f971(0x146)]('uId');_0x3eb3ab===null||_0x3eb3ab===''?authorizeWithDropbox():window[_0x29f971(0x149)](_0x29f971(0x14b))&&(localStorage[_0x29f971(0x164)](_0x29f971(0x173),''),dropboxRestore[_0x29f971(0x152)][_0x29f971(0x150)](_0x29f971(0x14e)),dropboxBackup['classList'][_0x29f971(0x150)]('active'),dropboxCloud[_0x29f971(0x152)][_0x29f971(0x150)]('active'));}),handleDropboxCallback();});