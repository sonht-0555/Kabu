var a0_0x632d1c=a0_0x2f49;(function(_0x4c98ee,_0x155e9e){var _0x2a7057=a0_0x2f49,_0x190941=_0x4c98ee();while(!![]){try{var _0x112007=-parseInt(_0x2a7057(0x168))/0x1*(parseInt(_0x2a7057(0x178))/0x2)+-parseInt(_0x2a7057(0x174))/0x3*(-parseInt(_0x2a7057(0x14e))/0x4)+parseInt(_0x2a7057(0x1aa))/0x5*(-parseInt(_0x2a7057(0x15b))/0x6)+parseInt(_0x2a7057(0x182))/0x7*(-parseInt(_0x2a7057(0x18b))/0x8)+-parseInt(_0x2a7057(0x1a7))/0x9+-parseInt(_0x2a7057(0x19b))/0xa+-parseInt(_0x2a7057(0x1a0))/0xb*(-parseInt(_0x2a7057(0x199))/0xc);if(_0x112007===_0x155e9e)break;else _0x190941['push'](_0x190941['shift']());}catch(_0x28ec99){_0x190941['push'](_0x190941['shift']());}}}(a0_0x1288,0xde5f9));import*as a0_0x33264b from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x2f49(_0x3ffb3d,_0x5e0f7b){var _0x12882a=a0_0x1288();return a0_0x2f49=function(_0x2f4902,_0x141ce6){_0x2f4902=_0x2f4902-0x14c;var _0xc1048e=_0x12882a[_0x2f4902];return _0xc1048e;},a0_0x2f49(_0x3ffb3d,_0x5e0f7b);}var clientId=a0_0x632d1c(0x15d),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x48e752=a0_0x632d1c,_0x21b6f1=window[_0x48e752(0x162)][_0x48e752(0x1a1)]['split']('?')[0x0],_0x1a57b0=_0x48e752(0x155),_0x7673c7=_0x48e752(0x198),_0x28f2c6=_0x48e752(0x190)+clientId+_0x48e752(0x180)+_0x1a57b0+'&token_access_type='+_0x7673c7+_0x48e752(0x167)+encodeURIComponent(_0x21b6f1);window[_0x48e752(0x162)]['href']=_0x28f2c6;}function handleDropboxCallback(){var _0x2bd52d=a0_0x632d1c,_0x1e87a8=getUrlParameter(_0x2bd52d(0x155));_0x1e87a8?(getAccessToken(_0x1e87a8),console[_0x2bd52d(0x152)](_0x2bd52d(0x192),_0x1e87a8)):console[_0x2bd52d(0x152)](_0x2bd52d(0x1ac));}function getUrlParameter(_0x456b3a){var _0x36276f=a0_0x632d1c;_0x456b3a=_0x456b3a[_0x36276f(0x176)](/[\[]/,'\x5c[')[_0x36276f(0x176)](/[\]]/,'\x5c]');var _0x3754b1=new RegExp('[\x5c?&#]'+_0x456b3a+'=([^&#]*)'),_0x2bf51f=_0x3754b1['exec'](location[_0x36276f(0x16e)]);return _0x2bf51f===null?'':decodeURIComponent(_0x2bf51f[0x1][_0x36276f(0x176)](/\+/g,'\x20'));}function getAccessToken(_0x5d4404){var _0x3f1080=a0_0x632d1c,_0x356f83=_0x3f1080(0x17d),_0x2f9cbb=window[_0x3f1080(0x162)][_0x3f1080(0x1a1)][_0x3f1080(0x19f)]('?')[0x0],_0x48b22e=new XMLHttpRequest();_0x48b22e['open'](_0x3f1080(0x161),'https://api.dropbox.com/oauth2/token'),_0x48b22e[_0x3f1080(0x153)]('Content-Type',_0x3f1080(0x15f)),_0x48b22e[_0x3f1080(0x1a4)]=function(){var _0x58ed8c=_0x3f1080;if(_0x48b22e['status']===0xc8){var _0x52b897=JSON[_0x58ed8c(0x1a9)](_0x48b22e['responseText']),_0xef2ec0=_0x52b897['access_token'],_0x371f6c=_0x52b897[_0x58ed8c(0x197)],_0xae22df=_0x52b897['uid'];localStorage['setItem']('accessToken',_0xef2ec0),localStorage['setItem'](_0x58ed8c(0x1a8),_0x371f6c),localStorage[_0x58ed8c(0x184)](_0x58ed8c(0x160),_0xae22df);}else console['log'](_0x58ed8c(0x195));},_0x48b22e[_0x3f1080(0x189)](_0x3f1080(0x151)+_0x5d4404+_0x3f1080(0x1ad)+_0x356f83+_0x3f1080(0x16f)+clientId+'&client_secret='+clientSecret+_0x3f1080(0x167)+encodeURIComponent(_0x2f9cbb));}function a0_0x1288(){var _0x290821=['Download\x20failed\x20for\x20','Restore\x20canceled\x20by\x20user.','downloadFileInCloud','Unable\x20to\x20refresh\x20token','authorization_code','.tag','uploadFileInCloud','&response_type=','Wait\x20a\x20little\x20bit...','11411659TMUxYU','listFiles','setItem','Error\x20creating\x20folder\x20','Do\x20you\x20want\x20to\x20backup\x20','Download\x20failed,\x20unknown\x20http\x20status:','Do\x20you\x20want\x20to\x20restore\x20','send','Bearer\x20','8lhhEsx','accessToken','push','No\x20files\x20found\x20to\x20restore.','screenshot','https://www.dropbox.com/oauth2/authorize?client_id=','getItem','Authorization\x20Code:','application/json','overwrite','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','classList','refresh_token','offline','7641636BQHTYG','addEventListener','7401200QaYncY','https://api.dropboxapi.com/2/files/list_folder','remove','Kabu\x20storage\x20↦\x20Cloud\x20◆','split','99GBWCDy','href','length','\x20files\x20from\x20Cloud?','onload','https://content.dropboxapi.com/2/files/download','Upload\x20failed,\x20unknown\x20http\x20status:\x20','7592688AEkItH','refreshToken','parse','9090865PKVmmg','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20not\x20receive\x20authorization','&grant_type=','click','Cloud\x20login\x20required!','1648zwMfWC','state','Failed\x20to\x20refresh\x20Dropbox\x20token.','code=','log','setRequestHeader','\x20files\x20in\x20Kabu?','code','DOMContentLoaded','status','filter','https://api.dropboxapi.com/oauth2/token','error_description','6bHmyBb','entries','knh3uz2mx2hp2eu',',\x20status:\x20','application/x-www-form-urlencoded','uId','POST','location','json','Do\x20you\x20want\x20to\x20logout?','application/octet-stream','Folder\x20already\x20exists','&redirect_uri=','170978RqAbyF','alert','Refreshing\x20token...','active','file','https://api.dropboxapi.com/2/files/create_folder_v2','search','&client_id=','error','access_token','confirm','stringify','6522oAMqiQ','name','replace','save','8fUqlYB'];a0_0x1288=function(){return _0x290821;};return a0_0x1288();}export async function dpCreateFolder(_0x51a07b){var _0xc79ad0=a0_0x632d1c;const _0x4e7182=localStorage[_0xc79ad0(0x191)](_0xc79ad0(0x160));let _0x42d4ea=localStorage[_0xc79ad0(0x191)](_0xc79ad0(0x18c));const _0xa396da='/'+_0x4e7182+'/'+_0x51a07b,_0x5f04a4=JSON[_0xc79ad0(0x173)]({'path':_0xa396da,'autorename':![]});for(let _0x65f066=0x0;_0x65f066<0x2;_0x65f066++){try{const _0x1435e0=await fetch(_0xc79ad0(0x16d),{'method':_0xc79ad0(0x161),'headers':{'Authorization':_0xc79ad0(0x18a)+_0x42d4ea,'Content-Type':'application/json'},'body':_0x5f04a4});if(_0x1435e0[_0xc79ad0(0x157)]===0x191){const _0x34eb9c=await dpRefreshToken();if(!_0x34eb9c)throw new Error(_0xc79ad0(0x17c));_0x42d4ea=localStorage[_0xc79ad0(0x191)](_0xc79ad0(0x18c));continue;}if(_0x1435e0[_0xc79ad0(0x157)]===0x199)return{'message':_0xc79ad0(0x166),'path':_0x51a07b};if(!_0x1435e0['ok'])throw new Error(_0xc79ad0(0x185)+_0x51a07b);const _0x4c5e6d=await _0x1435e0[_0xc79ad0(0x163)]();return await lockNoti('Folder\x20created','',0xbb8),_0x4c5e6d;}catch(_0x1e176a){if(_0x65f066===0x1)throw _0x1e176a;}}return![];}export async function dpRefreshToken(){var _0x52f117=a0_0x632d1c;if(!localStorage['getItem']('refreshToken'))throw'No\x20refresh\x20token';try{const _0x312c3b=await fetch(_0x52f117(0x159),{'method':_0x52f117(0x161),'headers':{'Content-Type':_0x52f117(0x15f)},'body':'refresh_token='+localStorage['getItem'](_0x52f117(0x1a8))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0xa623aa=await _0x312c3b[_0x52f117(0x163)]();if(!_0xa623aa[_0x52f117(0x170)])return localStorage[_0x52f117(0x184)]('accessToken',_0xa623aa[_0x52f117(0x171)]),await lockNoti(_0x52f117(0x16a),'',0xbb8),await delay(0x3e8),!![];else alert(_0xa623aa[_0x52f117(0x15a)]||_0x52f117(0x150));}catch(_0x34fc87){console['error']('Error\x20while\x20refreshing\x20token:',_0x34fc87);}return![];}export async function dpUploadFile(_0x4d2df7,_0x217fa3,_0x34cb64){var _0x2bef64=a0_0x632d1c;const _0x67174e=localStorage[_0x2bef64(0x191)](_0x2bef64(0x160));var _0xcffda7=JSON[_0x2bef64(0x173)]({'autorename':!![],'mode':_0x2bef64(0x194),'mute':!![],'strict_conflict':![],'path':'/'+_0x67174e+'/'+_0x34cb64+'/'+_0x4d2df7}),_0x565265=new Blob([_0x217fa3],{'type':_0x2bef64(0x165)});for(var _0x46d810=0x0;_0x46d810<0x2;_0x46d810++){var _0x42d8d1=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x2bef64(0x18a)+localStorage['getItem'](_0x2bef64(0x18c)),'Dropbox-API-Arg':_0xcffda7,'Content-Type':_0x2bef64(0x165)},'body':_0x565265});if(_0x42d8d1[_0x2bef64(0x157)]!=0xc8){if(_0x42d8d1[_0x2bef64(0x157)]==0x191){var _0x3a2688=await dpRefreshToken();if(!_0x3a2688)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x2bef64(0x1a6)+_0x42d8d1[_0x2bef64(0x157)];}else{var _0x382020=await _0x42d8d1['json']();return console[_0x2bef64(0x152)](_0x2bef64(0x19e),_0x4d2df7),_0x382020;}}return![];}export async function dpDownloadFile(_0x903cdc,_0x1d6b93){var _0x355ecb=a0_0x632d1c;const _0x2abb01=localStorage[_0x355ecb(0x191)](_0x355ecb(0x160));var _0x2d02b2=JSON[_0x355ecb(0x173)]({'path':'/'+_0x2abb01+'/'+_0x1d6b93+'/'+_0x903cdc});for(var _0xdebcd5=0x0;_0xdebcd5<0x2;_0xdebcd5++){var _0x1110fc=await fetch(_0x355ecb(0x1a5),{'method':_0x355ecb(0x161),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x2d02b2}});if(_0x1110fc[_0x355ecb(0x157)]!=0xc8){if(_0x1110fc['status']==0x191){var _0x3cb8c8=await dpRefreshToken();if(!_0x3cb8c8)throw _0x355ecb(0x17c);continue;}else throw _0x355ecb(0x187)+_0x1110fc[_0x355ecb(0x157)];}const _0x4f8bd2=new File([await _0x1110fc['blob']()],_0x903cdc);return console[_0x355ecb(0x152)](_0x355ecb(0x1ab),_0x4f8bd2[_0x355ecb(0x175)]),a0_0x33264b[_0x355ecb(0x17f)](_0x4f8bd2,()=>{}),_0x4f8bd2;}return![];}document[a0_0x632d1c(0x19a)](a0_0x632d1c(0x156),function(){var _0x255ded=a0_0x632d1c;dropboxRestore[_0x255ded(0x19a)](_0x255ded(0x14c),async function(){var _0x24ddd0=_0x255ded;await lockNoti(_0x24ddd0(0x181),'',0x1388);const _0x3341a8=localStorage[_0x24ddd0(0x191)]('uId'),_0x16afa0=[_0x24ddd0(0x14f),_0x24ddd0(0x177),_0x24ddd0(0x18f)];if(!_0x3341a8){window[_0x24ddd0(0x169)]('Cloud\x20login\x20required!');return;}let _0xd8a56f=[];for(const _0x296e4b of _0x16afa0){let _0x5286ba={'path':'/'+_0x3341a8+'/'+_0x296e4b};for(let _0x1ef7d9=0x0;_0x1ef7d9<0x2;_0x1ef7d9++){let _0x3327f4=await fetch(_0x24ddd0(0x19c),{'method':_0x24ddd0(0x161),'headers':{'Authorization':_0x24ddd0(0x18a)+localStorage[_0x24ddd0(0x191)]('accessToken'),'Content-Type':_0x24ddd0(0x193)},'body':JSON[_0x24ddd0(0x173)](_0x5286ba)});if(_0x3327f4[_0x24ddd0(0x157)]===0xc8){let _0x3a90c5=await _0x3327f4[_0x24ddd0(0x163)](),_0xf46e68=_0x3a90c5[_0x24ddd0(0x15c)][_0x24ddd0(0x158)](_0x1903db=>_0x1903db[_0x24ddd0(0x17e)]===_0x24ddd0(0x16c));_0xf46e68[_0x24ddd0(0x1a2)]>0x0&&_0xd8a56f[_0x24ddd0(0x18d)](..._0xf46e68['map'](_0x4fcfac=>({'name':_0x4fcfac[_0x24ddd0(0x175)],'folder':_0x296e4b})));break;}else{if(_0x3327f4[_0x24ddd0(0x157)]===0x191){let _0x2db9cd=await dpRefreshToken();if(!_0x2db9cd)throw _0x24ddd0(0x17c);}else{console[_0x24ddd0(0x170)](_0x24ddd0(0x179)+_0x296e4b+_0x24ddd0(0x15e)+_0x3327f4[_0x24ddd0(0x157)]);break;}}}}if(_0xd8a56f[_0x24ddd0(0x1a2)]>0x0){const _0x4cd111=_0x24ddd0(0x188)+_0xd8a56f[_0x24ddd0(0x1a2)]+_0x24ddd0(0x1a3);if(window[_0x24ddd0(0x172)](_0x4cd111))for(const _0x5ecd39 of _0xd8a56f){await lockNoti('Restoring...',_0x5ecd39['name'],0xbb8),await dpDownloadFile(_0x5ecd39[_0x24ddd0(0x175)],_0x5ecd39['folder']);}else console[_0x24ddd0(0x152)](_0x24ddd0(0x17a));}else console[_0x24ddd0(0x152)](_0x24ddd0(0x18e));}),dropboxBackup[_0x255ded(0x19a)]('click',async function(){var _0x1f0a25=_0x255ded;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x353d04=localStorage[_0x1f0a25(0x191)](_0x1f0a25(0x160));if(_0x353d04===null||_0x353d04==='')window['alert'](_0x1f0a25(0x14d));else{const _0x38b9d0=[_0x1f0a25(0x14f),_0x1f0a25(0x177),'screenshot'];for(const _0x176002 of _0x38b9d0){await dpCreateFolder(_0x176002);}let _0x499bd2=0x0;for(const _0x35b0d2 of _0x38b9d0){const _0x1f2411=a0_0x33264b[_0x1f0a25(0x183)](_0x35b0d2+'s');_0x499bd2+=_0x1f2411[_0x1f0a25(0x1a2)];}if(window[_0x1f0a25(0x172)](_0x1f0a25(0x186)+_0x499bd2+_0x1f0a25(0x154)))for(const _0x395e93 of _0x38b9d0){const _0x3d3471=a0_0x33264b[_0x1f0a25(0x183)](_0x395e93+'s');for(const _0x5c582d of _0x3d3471){const _0xd6b868=await a0_0x33264b[_0x1f0a25(0x17b)]('/data/'+_0x395e93+'s/'+_0x5c582d);try{await lockNoti('Backing\x20up...',_0x5c582d,0xbb8),await dpUploadFile(_0x5c582d,_0xd6b868,_0x395e93);}catch(_0x4329c7){console[_0x1f0a25(0x170)]('Failed\x20to\x20upload\x20file\x20'+_0x5c582d+':',_0x4329c7);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x255ded(0x19a)](_0x255ded(0x14c),function(){var _0x342d8b=_0x255ded;const _0x55966b=localStorage[_0x342d8b(0x191)](_0x342d8b(0x160));_0x55966b===null||_0x55966b===''?authorizeWithDropbox():window[_0x342d8b(0x172)](_0x342d8b(0x164))&&(localStorage[_0x342d8b(0x184)]('uId',''),dropboxRestore[_0x342d8b(0x196)][_0x342d8b(0x19d)](_0x342d8b(0x16b)),dropboxBackup[_0x342d8b(0x196)][_0x342d8b(0x19d)]('active'),dropboxCloud[_0x342d8b(0x196)]['remove'](_0x342d8b(0x16b)));}),handleDropboxCallback();});