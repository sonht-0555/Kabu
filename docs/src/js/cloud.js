var a0_0x200712=a0_0x42c9;(function(_0x300d3a,_0x2b90f8){var _0x20a8ea=a0_0x42c9,_0x29a381=_0x300d3a();while(!![]){try{var _0x5c6635=-parseInt(_0x20a8ea(0x165))/0x1+-parseInt(_0x20a8ea(0x14c))/0x2*(parseInt(_0x20a8ea(0x117))/0x3)+-parseInt(_0x20a8ea(0x111))/0x4*(parseInt(_0x20a8ea(0x155))/0x5)+parseInt(_0x20a8ea(0x15d))/0x6*(parseInt(_0x20a8ea(0x13b))/0x7)+parseInt(_0x20a8ea(0x15f))/0x8*(parseInt(_0x20a8ea(0x14b))/0x9)+parseInt(_0x20a8ea(0x15e))/0xa*(parseInt(_0x20a8ea(0x14a))/0xb)+parseInt(_0x20a8ea(0x132))/0xc;if(_0x5c6635===_0x2b90f8)break;else _0x29a381['push'](_0x29a381['shift']());}catch(_0x531073){_0x29a381['push'](_0x29a381['shift']());}}}(a0_0x42c1,0x9467a));import*as a0_0x24f3c1 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x200712(0x116),clientSecret=a0_0x200712(0x14e);function a0_0x42c9(_0x30eec2,_0x4a0d9d){var _0x42c1bf=a0_0x42c1();return a0_0x42c9=function(_0x42c9ef,_0x45a8bc){_0x42c9ef=_0x42c9ef-0x10d;var _0x241b05=_0x42c1bf[_0x42c9ef];return _0x241b05;},a0_0x42c9(_0x30eec2,_0x4a0d9d);}function authorizeWithDropbox(){var _0x298479=a0_0x200712,_0x2b2f83=window['location'][_0x298479(0x142)][_0x298479(0x14f)]('?')[0x0],_0x3c9707=_0x298479(0x176),_0x23b51b=_0x298479(0x12b),_0x35dc54='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x3c9707+'&token_access_type='+_0x23b51b+_0x298479(0x11d)+encodeURIComponent(_0x2b2f83);window[_0x298479(0x179)][_0x298479(0x142)]=_0x35dc54;}function handleDropboxCallback(){var _0x29fe73=a0_0x200712,_0x279024=getUrlParameter(_0x29fe73(0x176));_0x279024?(getAccessToken(_0x279024),console[_0x29fe73(0x147)](_0x29fe73(0x13d),_0x279024)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0xa19f60){var _0x50da3b=a0_0x200712;_0xa19f60=_0xa19f60[_0x50da3b(0x112)](/[\[]/,'\x5c[')[_0x50da3b(0x112)](/[\]]/,'\x5c]');var _0x566985=new RegExp(_0x50da3b(0x170)+_0xa19f60+_0x50da3b(0x146)),_0x2261fd=_0x566985[_0x50da3b(0x172)](location[_0x50da3b(0x162)]);return _0x2261fd===null?'':decodeURIComponent(_0x2261fd[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x1e5891){var _0x4fef65=a0_0x200712,_0x52590b=_0x4fef65(0x131),_0x474afe=window[_0x4fef65(0x179)][_0x4fef65(0x142)]['split']('?')[0x0],_0x1d0931=new XMLHttpRequest();_0x1d0931[_0x4fef65(0x11e)](_0x4fef65(0x16f),_0x4fef65(0x141)),_0x1d0931[_0x4fef65(0x16e)](_0x4fef65(0x123),_0x4fef65(0x153)),_0x1d0931['onload']=function(){var _0x34e197=_0x4fef65;if(_0x1d0931['status']===0xc8){var _0x3387a6=JSON[_0x34e197(0x11f)](_0x1d0931[_0x34e197(0x114)]),_0xce8d1a=_0x3387a6[_0x34e197(0x129)],_0x2adcc9=_0x3387a6['refresh_token'],_0x5e2057=_0x3387a6[_0x34e197(0x10e)];localStorage['setItem'](_0x34e197(0x12f),_0xce8d1a),localStorage['setItem'](_0x34e197(0x11b),_0x2adcc9),localStorage[_0x34e197(0x11c)](_0x34e197(0x13e),_0x5e2057);}else console[_0x34e197(0x147)](_0x34e197(0x135));},_0x1d0931[_0x4fef65(0x159)](_0x4fef65(0x14d)+_0x1e5891+'&grant_type='+_0x52590b+_0x4fef65(0x150)+clientId+_0x4fef65(0x12c)+clientSecret+_0x4fef65(0x11d)+encodeURIComponent(_0x474afe));}export async function dpCreateFolder(_0x3e1928){var _0x2382e3=a0_0x200712;const _0x1f11db=localStorage['getItem'](_0x2382e3(0x13e));let _0x4e90aa=localStorage[_0x2382e3(0x122)]('accessToken');const _0x4872cc='/'+_0x1f11db+'/'+_0x3e1928,_0xf1272=JSON[_0x2382e3(0x115)]({'path':_0x4872cc,'autorename':![]});for(let _0x50e568=0x0;_0x50e568<0x2;_0x50e568++){try{const _0x115a52=await fetch(_0x2382e3(0x174),{'method':_0x2382e3(0x16f),'headers':{'Authorization':_0x2382e3(0x154)+_0x4e90aa,'Content-Type':'application/json'},'body':_0xf1272});if(_0x115a52[_0x2382e3(0x16c)]===0x191){const _0x51513e=await dpRefreshToken();if(!_0x51513e)throw new Error(_0x2382e3(0x136));_0x4e90aa=localStorage[_0x2382e3(0x122)](_0x2382e3(0x12f));continue;}if(_0x115a52['status']===0x199)return{'message':'Folder\x20already\x20exists','path':_0x3e1928};if(!_0x115a52['ok'])throw new Error(_0x2382e3(0x12e)+_0x3e1928);const _0x26e55b=await _0x115a52['json']();return await lockNoti(_0x2382e3(0x133),'',0xbb8),_0x26e55b;}catch(_0x14e1a8){if(_0x50e568===0x1)throw _0x14e1a8;}}return![];}function a0_0x42c1(){var _0x56fae8=['Upload\x20failed,\x20unknown\x20http\x20status:\x20','click','state','access_token','filter','offline','&client_secret=','error_description','Error\x20creating\x20folder\x20','accessToken','https://content.dropboxapi.com/2/files/upload','authorization_code','24428508GSYWLB','Folder\x20created','name','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Unable\x20to\x20refresh\x20token','push','error','Do\x20you\x20want\x20to\x20logout?','Error\x20while\x20refreshing\x20token:','25921bmtFDa','active','Authorization\x20Code:','uId','file','No\x20files\x20found\x20to\x20restore.','https://api.dropbox.com/oauth2/token','href','refresh_token=','.tag','https://api.dropboxapi.com/oauth2/token','=([^&#]*)','log','Restoring...','length','899107vjjeoO','9ZzfLOS','1297234LYeDsf','code=','nwb3dnfh09rhs31','split','&client_id=','No\x20refresh\x20token','entries','application/x-www-form-urlencoded','Bearer\x20','5LkLxFF','list','blob','application/octet-stream','send','save','slice','Failed\x20to\x20upload\x20file\x20','36rrzdvP','90oPlSjj','1130456zsXBoS','Cloud\x20login\x20required!','Cloud\x20↦\x20Kabu\x20storage\x20◆','search','toUpperCase','addEventListener','532650BuELDf','alert','remove','application/json','classList','Restore\x20canceled\x20by\x20user.','uploadFileInCloud','status','Backing\x20up...','setRequestHeader','POST','[\x5c?&#]','confirm','exec','Do\x20you\x20want\x20to\x20restore\x20','https://api.dropboxapi.com/2/files/create_folder_v2','Download\x20failed\x20for\x20','code','Do\x20you\x20want\x20to\x20backup\x20','screenshot','location','overwrite','uid','https://content.dropboxapi.com/2/files/download','charAt','4582936sUzyVq','replace','folder','responseText','stringify','knh3uz2mx2hp2eu','3XtIYvC','Download\x20failed,\x20unknown\x20http\x20status:','map','json','refreshToken','setItem','&redirect_uri=','open','parse','Kabu\x20storage\x20↦\x20Cloud\x20◆','DOMContentLoaded','getItem','Content-Type','https://api.dropboxapi.com/2/files/list_folder','\x20files\x20in\x20Kabu?'];a0_0x42c1=function(){return _0x56fae8;};return a0_0x42c1();}export async function dpRefreshToken(){var _0x10d494=a0_0x200712;if(!localStorage['getItem'](_0x10d494(0x11b)))throw _0x10d494(0x151);try{const _0x5d5f18=await fetch(_0x10d494(0x145),{'method':'POST','headers':{'Content-Type':_0x10d494(0x153)},'body':_0x10d494(0x143)+localStorage['getItem'](_0x10d494(0x11b))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x84b2ef=await _0x5d5f18[_0x10d494(0x11a)]();if(!_0x84b2ef['error'])return localStorage[_0x10d494(0x11c)]('accessToken',_0x84b2ef['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x84b2ef[_0x10d494(0x12d)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x4056d0){console[_0x10d494(0x138)](_0x10d494(0x13a),_0x4056d0);}return![];}export async function dpUploadFile(_0x29e072,_0x283521,_0x4aad37){var _0x8e0c04=a0_0x200712;const _0x42610e=localStorage[_0x8e0c04(0x122)](_0x8e0c04(0x13e));var _0x78e00e=JSON[_0x8e0c04(0x115)]({'autorename':!![],'mode':_0x8e0c04(0x10d),'mute':!![],'strict_conflict':![],'path':'/'+_0x42610e+'/'+_0x4aad37+'/'+_0x29e072}),_0x2f7767=new Blob([_0x283521],{'type':'application/octet-stream'});for(var _0x91bf7=0x0;_0x91bf7<0x2;_0x91bf7++){var _0x10e022=await fetch(_0x8e0c04(0x130),{'method':_0x8e0c04(0x16f),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x78e00e,'Content-Type':_0x8e0c04(0x158)},'body':_0x2f7767});if(_0x10e022[_0x8e0c04(0x16c)]!=0xc8){if(_0x10e022[_0x8e0c04(0x16c)]==0x191){var _0x5c1f27=await dpRefreshToken();if(!_0x5c1f27)throw _0x8e0c04(0x136);continue;}else throw _0x8e0c04(0x126)+_0x10e022[_0x8e0c04(0x16c)];}else{var _0x32c37a=await _0x10e022[_0x8e0c04(0x11a)]();return console[_0x8e0c04(0x147)](_0x8e0c04(0x120),_0x29e072),_0x32c37a;}}return![];}export async function dpDownloadFile(_0x5966b3,_0x5db407){var _0x22b872=a0_0x200712;const _0x66592a=localStorage[_0x22b872(0x122)](_0x22b872(0x13e));var _0x2c3b72=JSON[_0x22b872(0x115)]({'path':'/'+_0x66592a+'/'+_0x5db407+'/'+_0x5966b3});for(var _0x3c2590=0x0;_0x3c2590<0x2;_0x3c2590++){var _0x25c74d=await fetch(_0x22b872(0x10f),{'method':_0x22b872(0x16f),'headers':{'Authorization':_0x22b872(0x154)+localStorage[_0x22b872(0x122)]('accessToken'),'Dropbox-API-Arg':_0x2c3b72}});if(_0x25c74d[_0x22b872(0x16c)]!=0xc8){if(_0x25c74d[_0x22b872(0x16c)]==0x191){var _0xc4a329=await dpRefreshToken();if(!_0xc4a329)throw _0x22b872(0x136);continue;}else throw _0x22b872(0x118)+_0x25c74d[_0x22b872(0x16c)];}const _0xd0159b=new File([await _0x25c74d[_0x22b872(0x157)]()],_0x5966b3);return console[_0x22b872(0x147)](_0x22b872(0x161),_0xd0159b[_0x22b872(0x134)]),a0_0x24f3c1[_0x22b872(0x16b)](_0xd0159b,()=>{}),_0xd0159b;}return![];}document['addEventListener'](a0_0x200712(0x121),function(){var _0x1d5c34=a0_0x200712;dropboxRestore[_0x1d5c34(0x164)](_0x1d5c34(0x127),async function(){var _0x2a4014=_0x1d5c34;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x586bbe=localStorage['getItem']('uId'),_0x3a88ba=[_0x2a4014(0x128),_0x2a4014(0x15a),'screenshot'];if(!_0x586bbe){window[_0x2a4014(0x166)](_0x2a4014(0x160));return;}let _0x176b8d=[];for(const _0x3bb581 of _0x3a88ba){let _0x375672={'path':'/'+_0x586bbe+'/'+_0x3bb581};for(let _0xd7ec82=0x0;_0xd7ec82<0x2;_0xd7ec82++){let _0xae0db=await fetch(_0x2a4014(0x124),{'method':_0x2a4014(0x16f),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x2a4014(0x122)](_0x2a4014(0x12f)),'Content-Type':_0x2a4014(0x168)},'body':JSON[_0x2a4014(0x115)](_0x375672)});if(_0xae0db[_0x2a4014(0x16c)]===0xc8){let _0x3ea0ec=await _0xae0db[_0x2a4014(0x11a)](),_0x4423d7=_0x3ea0ec[_0x2a4014(0x152)][_0x2a4014(0x12a)](_0x1f5032=>_0x1f5032[_0x2a4014(0x144)]===_0x2a4014(0x13f));_0x4423d7[_0x2a4014(0x149)]>0x0&&_0x176b8d[_0x2a4014(0x137)](..._0x4423d7[_0x2a4014(0x119)](_0x2a4924=>({'name':_0x2a4924[_0x2a4014(0x134)],'folder':_0x3bb581})));break;}else{if(_0xae0db[_0x2a4014(0x16c)]===0x191){let _0x56a53b=await dpRefreshToken();if(!_0x56a53b)throw _0x2a4014(0x136);}else{console[_0x2a4014(0x138)](_0x2a4014(0x175)+_0x3bb581+',\x20status:\x20'+_0xae0db[_0x2a4014(0x16c)]);break;}}}}if(_0x176b8d[_0x2a4014(0x149)]>0x0){const _0x3005aa=_0x2a4014(0x173)+_0x176b8d[_0x2a4014(0x149)]+'\x20files\x20from\x20Cloud?';if(window[_0x2a4014(0x171)](_0x3005aa))for(const _0x30ec21 of _0x176b8d){await lockNoti(_0x2a4014(0x148),_0x30ec21[_0x2a4014(0x134)],0xbb8),await dpDownloadFile(_0x30ec21[_0x2a4014(0x134)],_0x30ec21[_0x2a4014(0x113)]);}else console[_0x2a4014(0x147)](_0x2a4014(0x16a));}else console[_0x2a4014(0x147)](_0x2a4014(0x140));}),dropboxBackup[_0x1d5c34(0x164)](_0x1d5c34(0x127),async function(){var _0x5630c5=_0x1d5c34;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4584f3=localStorage['getItem']('uId');if(_0x4584f3===null||_0x4584f3==='')window['alert']('Cloud\x20login\x20required!');else{const _0x47afb3=[_0x5630c5(0x128),_0x5630c5(0x15a),_0x5630c5(0x178)];for(const _0x4bc16b of _0x47afb3){await dpCreateFolder(_0x4bc16b);}let _0xe927c4=0x0;for(const _0x38c334 of _0x47afb3){const _0x245909=a0_0x24f3c1[_0x5630c5(0x156)+(_0x38c334[_0x5630c5(0x110)](0x0)[_0x5630c5(0x163)]()+_0x38c334[_0x5630c5(0x15b)](0x1))]();_0xe927c4+=_0x245909[_0x5630c5(0x149)];}if(window[_0x5630c5(0x171)](_0x5630c5(0x177)+_0xe927c4+_0x5630c5(0x125)))for(const _0x1a24ba of _0x47afb3){const _0x7f7218=a0_0x24f3c1[_0x5630c5(0x156)+(_0x1a24ba[_0x5630c5(0x110)](0x0)[_0x5630c5(0x163)]()+_0x1a24ba[_0x5630c5(0x15b)](0x1))]();for(const _0x48270b of _0x7f7218){const _0x1106d0=await a0_0x24f3c1['downloadFileInCloud']('/data/'+_0x1a24ba+'s/'+_0x48270b);try{await lockNoti(_0x5630c5(0x16d),_0x48270b,0xbb8),await dpUploadFile(_0x48270b,_0x1106d0,_0x1a24ba);}catch(_0x26023e){console['error'](_0x5630c5(0x15c)+_0x48270b+':',_0x26023e);}}}else console['log'](_0x5630c5(0x16a));}}),dropboxCloud['addEventListener']('click',function(){var _0x552b78=_0x1d5c34;const _0xafd945=localStorage[_0x552b78(0x122)](_0x552b78(0x13e));_0xafd945===null||_0xafd945===''?authorizeWithDropbox():window[_0x552b78(0x171)](_0x552b78(0x139))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x552b78(0x169)][_0x552b78(0x167)](_0x552b78(0x13c)),dropboxBackup['classList'][_0x552b78(0x167)](_0x552b78(0x13c)),dropboxCloud[_0x552b78(0x169)][_0x552b78(0x167)]('active'));}),handleDropboxCallback();});