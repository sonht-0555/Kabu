function a0_0x536b(){var _0x22255c=['Wait\x20a\x20little\x20bit...','json','Do\x20you\x20want\x20to\x20restore\x20','uid','error_description','setItem','confirm','entries','code','Refreshing\x20token...','addEventListener','Cloud\x20↦\x20Kabu\x20storage\x20◆','classList','refreshToken','\x20files\x20from\x20Cloud?','Do\x20you\x20want\x20to\x20backup\x20','setRequestHeader','3wAzHyZ','application/x-www-form-urlencoded','status','alert','[\x5c?&#]','=([^&#]*)','name','blob','1199070XeFOqU','&token_access_type=','30yusgGy','uId','Backing\x20up...','Authorization\x20Code:','47509SkgWtY','https://api.dropbox.com/oauth2/token','getItem','FSSync','exec','https://api.dropboxapi.com/2/files/list_folder','Folder\x20already\x20exists','downloadFileInCloud','stringify','folder','screenshot','&grant_type=','986547kUieAk','authorization_code','POST','15758235WbxTjW','Restore\x20canceled\x20by\x20user.','Content-Type','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Upload\x20failed,\x20unknown\x20http\x20status:\x20','No\x20files\x20found\x20to\x20restore.','responseText','save','Unable\x20to\x20refresh\x20token','Do\x20you\x20want\x20to\x20logout?','Download\x20failed\x20for\x20','overwrite','refresh_token=','replace','4277905BObRBh','application/octet-stream','href','application/json','knh3uz2mx2hp2eu','location','offline','remove','filter','map','Failed\x20to\x20refresh\x20Dropbox\x20token.','Failed\x20to\x20upload\x20file\x20','accessToken','11ATSFzS','search','9793670GkgyLq','list','Do\x20not\x20receive\x20authorization','Bearer\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','10073520kOLWRE','Cloud\x20login\x20required!','split','/data/','error','&response_type=','access_token','active','&redirect_uri=','uploadFileInCloud','Folder\x20created','.tag','log','length','send','toUpperCase','4TJjMLQ','&client_id=','parse','&client_secret='];a0_0x536b=function(){return _0x22255c;};return a0_0x536b();}var a0_0x1f105c=a0_0x2df7;(function(_0x1e204b,_0x4eedef){var _0x3f5ff2=a0_0x2df7,_0x141a1a=_0x1e204b();while(!![]){try{var _0x3dac42=-parseInt(_0x3f5ff2(0x143))/0x1+-parseInt(_0x3f5ff2(0x131))/0x2*(-parseInt(_0x3f5ff2(0x18d))/0x3)+-parseInt(_0x3f5ff2(0x178))/0x4*(-parseInt(_0x3f5ff2(0x154))/0x5)+parseInt(_0x3f5ff2(0x133))/0x6*(-parseInt(_0x3f5ff2(0x137))/0x7)+parseInt(_0x3f5ff2(0x168))/0x8+-parseInt(_0x3f5ff2(0x146))/0x9+parseInt(_0x3f5ff2(0x163))/0xa*(parseInt(_0x3f5ff2(0x161))/0xb);if(_0x3dac42===_0x4eedef)break;else _0x141a1a['push'](_0x141a1a['shift']());}catch(_0x1f64eb){_0x141a1a['push'](_0x141a1a['shift']());}}}(a0_0x536b,0xe12a4));import*as a0_0x4ed8fe from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x2df7(_0x290749,_0x2b9e8a){var _0x536b23=a0_0x536b();return a0_0x2df7=function(_0x2df792,_0x2733b2){_0x2df792=_0x2df792-0x12f;var _0x598cc9=_0x536b23[_0x2df792];return _0x598cc9;},a0_0x2df7(_0x290749,_0x2b9e8a);}var clientId=a0_0x1f105c(0x158),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x2f96=a0_0x1f105c,_0x29b8a3=window[_0x2f96(0x159)]['href'][_0x2f96(0x16a)]('?')[0x0],_0x10b893=_0x2f96(0x184),_0x19aa26=_0x2f96(0x15a),_0x59f8f3='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2f96(0x16d)+_0x10b893+_0x2f96(0x132)+_0x19aa26+_0x2f96(0x170)+encodeURIComponent(_0x29b8a3);window[_0x2f96(0x159)][_0x2f96(0x156)]=_0x59f8f3;}function handleDropboxCallback(){var _0x3d7291=a0_0x1f105c,_0x54d64d=getUrlParameter('code');_0x54d64d?(getAccessToken(_0x54d64d),console[_0x3d7291(0x174)](_0x3d7291(0x136),_0x54d64d)):console[_0x3d7291(0x174)](_0x3d7291(0x165));}function getUrlParameter(_0x503e06){var _0x2f9578=a0_0x1f105c;_0x503e06=_0x503e06[_0x2f9578(0x153)](/[\[]/,'\x5c[')[_0x2f9578(0x153)](/[\]]/,'\x5c]');var _0x2d4ac3=new RegExp(_0x2f9578(0x191)+_0x503e06+_0x2f9578(0x192)),_0x29ab8b=_0x2d4ac3[_0x2f9578(0x13b)](location[_0x2f9578(0x162)]);return _0x29ab8b===null?'':decodeURIComponent(_0x29ab8b[0x1][_0x2f9578(0x153)](/\+/g,'\x20'));}function getAccessToken(_0x1bed83){var _0x19ebd8=a0_0x1f105c,_0x46d155=_0x19ebd8(0x144),_0x3450f4=window[_0x19ebd8(0x159)]['href'][_0x19ebd8(0x16a)]('?')[0x0],_0x9b0e67=new XMLHttpRequest();_0x9b0e67['open'](_0x19ebd8(0x145),_0x19ebd8(0x138)),_0x9b0e67[_0x19ebd8(0x18c)](_0x19ebd8(0x148),_0x19ebd8(0x18e)),_0x9b0e67['onload']=function(){var _0x5a6364=_0x19ebd8;if(_0x9b0e67['status']===0xc8){var _0x5493cf=JSON[_0x5a6364(0x17a)](_0x9b0e67[_0x5a6364(0x14c)]),_0x403800=_0x5493cf[_0x5a6364(0x16e)],_0x4285db=_0x5493cf['refresh_token'],_0x3e1793=_0x5493cf[_0x5a6364(0x17f)];localStorage[_0x5a6364(0x181)](_0x5a6364(0x160),_0x403800),localStorage[_0x5a6364(0x181)]('refreshToken',_0x4285db),localStorage['setItem']('uId',_0x3e1793);}else console[_0x5a6364(0x174)](_0x5a6364(0x149));},_0x9b0e67[_0x19ebd8(0x176)]('code='+_0x1bed83+_0x19ebd8(0x142)+_0x46d155+_0x19ebd8(0x179)+clientId+_0x19ebd8(0x17b)+clientSecret+_0x19ebd8(0x170)+encodeURIComponent(_0x3450f4));}export async function dpCreateFolder(_0x39134f){var _0x408daf=a0_0x1f105c;const _0x515720=localStorage[_0x408daf(0x139)](_0x408daf(0x134));let _0x285d63=localStorage[_0x408daf(0x139)](_0x408daf(0x160));const _0x3a9f2d='/'+_0x515720+'/'+_0x39134f,_0x377779=JSON[_0x408daf(0x13f)]({'path':_0x3a9f2d,'autorename':![]});for(let _0x34dd06=0x0;_0x34dd06<0x2;_0x34dd06++){try{const _0xa90346=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x408daf(0x145),'headers':{'Authorization':_0x408daf(0x166)+_0x285d63,'Content-Type':_0x408daf(0x157)},'body':_0x377779});if(_0xa90346[_0x408daf(0x18f)]===0x191){const _0xed2f74=await dpRefreshToken();if(!_0xed2f74)throw new Error(_0x408daf(0x14e));_0x285d63=localStorage['getItem'](_0x408daf(0x160));continue;}if(_0xa90346[_0x408daf(0x18f)]===0x199)return{'message':_0x408daf(0x13d),'path':_0x39134f};if(!_0xa90346['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x39134f);const _0x3a2f4b=await _0xa90346[_0x408daf(0x17d)]();return await lockNoti(_0x408daf(0x172),'',0xbb8),_0x3a2f4b;}catch(_0x1741ae){if(_0x34dd06===0x1)throw _0x1741ae;}}return![];}export async function dpRefreshToken(){var _0x5523d8=a0_0x1f105c;if(!localStorage[_0x5523d8(0x139)](_0x5523d8(0x189)))throw'No\x20refresh\x20token';try{const _0x463246=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x5523d8(0x145),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x5523d8(0x152)+localStorage['getItem'](_0x5523d8(0x189))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x19a81f=await _0x463246[_0x5523d8(0x17d)]();if(!_0x19a81f[_0x5523d8(0x16c)])return localStorage[_0x5523d8(0x181)](_0x5523d8(0x160),_0x19a81f[_0x5523d8(0x16e)]),await lockNoti(_0x5523d8(0x185),'',0xbb8),await delay(0x3e8),!![];else alert(_0x19a81f[_0x5523d8(0x180)]||_0x5523d8(0x15e));}catch(_0x325803){console[_0x5523d8(0x16c)]('Error\x20while\x20refreshing\x20token:',_0x325803);}return![];}export async function dpUploadFile(_0x35d167,_0x5576cb,_0x5057f7){var _0x57bbaf=a0_0x1f105c;const _0x46c8ba=localStorage[_0x57bbaf(0x139)](_0x57bbaf(0x134));var _0x11052f=JSON[_0x57bbaf(0x13f)]({'autorename':!![],'mode':_0x57bbaf(0x151),'mute':!![],'strict_conflict':![],'path':'/'+_0x46c8ba+'/'+_0x5057f7+'/'+_0x35d167}),_0x43ce10=new Blob([_0x5576cb],{'type':_0x57bbaf(0x155)});for(var _0xc73a9d=0x0;_0xc73a9d<0x2;_0xc73a9d++){var _0xfe2bdb=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x57bbaf(0x139)](_0x57bbaf(0x160)),'Dropbox-API-Arg':_0x11052f,'Content-Type':'application/octet-stream'},'body':_0x43ce10});if(_0xfe2bdb['status']!=0xc8){if(_0xfe2bdb['status']==0x191){var _0x1eebe4=await dpRefreshToken();if(!_0x1eebe4)throw _0x57bbaf(0x14e);continue;}else throw _0x57bbaf(0x14a)+_0xfe2bdb[_0x57bbaf(0x18f)];}else{var _0x3127e7=await _0xfe2bdb[_0x57bbaf(0x17d)]();return console[_0x57bbaf(0x174)](_0x57bbaf(0x167),_0x35d167),_0x3127e7;}}return![];}export async function dpDownloadFile(_0x44c90b,_0x1e6a19){var _0x5b2236=a0_0x1f105c;const _0xdb6ae9=localStorage[_0x5b2236(0x139)](_0x5b2236(0x134));var _0x1145b3=JSON['stringify']({'path':'/'+_0xdb6ae9+'/'+_0x1e6a19+'/'+_0x44c90b});for(var _0x482bc2=0x0;_0x482bc2<0x2;_0x482bc2++){var _0x43d372=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x5b2236(0x145),'headers':{'Authorization':_0x5b2236(0x166)+localStorage[_0x5b2236(0x139)](_0x5b2236(0x160)),'Dropbox-API-Arg':_0x1145b3}});if(_0x43d372['status']!=0xc8){if(_0x43d372[_0x5b2236(0x18f)]==0x191){var _0x96da51=await dpRefreshToken();if(!_0x96da51)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x43d372[_0x5b2236(0x18f)];}const _0x1830a2=new File([await _0x43d372[_0x5b2236(0x130)]()],_0x44c90b);return console['log'](_0x5b2236(0x187),_0x1830a2['name']),a0_0x4ed8fe[_0x5b2236(0x171)](_0x1830a2,()=>{var _0x3f2a7d=_0x5b2236;localStorageFile(),Module[_0x3f2a7d(0x13a)]();}),_0x1830a2;}return![];}document[a0_0x1f105c(0x186)]('DOMContentLoaded',function(){var _0x1a0a88=a0_0x1f105c;dropboxRestore[_0x1a0a88(0x186)]('click',async function(){var _0x11c79e=_0x1a0a88;await lockNoti(_0x11c79e(0x17c),'',0x1388);const _0x3c6ef8=localStorage[_0x11c79e(0x139)](_0x11c79e(0x134)),_0x951460=['state',_0x11c79e(0x14d),_0x11c79e(0x141)];if(!_0x3c6ef8){window[_0x11c79e(0x190)](_0x11c79e(0x169));return;}let _0x5887f4=[];for(const _0x4b65f8 of _0x951460){let _0x4a8b69={'path':'/'+_0x3c6ef8+'/'+_0x4b65f8};for(let _0x2ea5be=0x0;_0x2ea5be<0x2;_0x2ea5be++){let _0x39646d=await fetch(_0x11c79e(0x13c),{'method':_0x11c79e(0x145),'headers':{'Authorization':_0x11c79e(0x166)+localStorage['getItem'](_0x11c79e(0x160)),'Content-Type':'application/json'},'body':JSON['stringify'](_0x4a8b69)});if(_0x39646d['status']===0xc8){let _0x2c2af7=await _0x39646d[_0x11c79e(0x17d)](),_0x49cee2=_0x2c2af7[_0x11c79e(0x183)][_0x11c79e(0x15c)](_0x1b102f=>_0x1b102f[_0x11c79e(0x173)]==='file');_0x49cee2['length']>0x0&&_0x5887f4['push'](..._0x49cee2[_0x11c79e(0x15d)](_0x378aed=>({'name':_0x378aed[_0x11c79e(0x12f)],'folder':_0x4b65f8})));break;}else{if(_0x39646d[_0x11c79e(0x18f)]===0x191){let _0x568415=await dpRefreshToken();if(!_0x568415)throw _0x11c79e(0x14e);}else{console[_0x11c79e(0x16c)](_0x11c79e(0x150)+_0x4b65f8+',\x20status:\x20'+_0x39646d['status']);break;}}}}if(_0x5887f4['length']>0x0){const _0x52e58c=_0x11c79e(0x17e)+_0x5887f4[_0x11c79e(0x175)]+_0x11c79e(0x18a);if(window[_0x11c79e(0x182)](_0x52e58c))for(const _0x2bffd6 of _0x5887f4){await lockNoti('Restoring...',_0x2bffd6[_0x11c79e(0x12f)],0xbb8),await dpDownloadFile(_0x2bffd6[_0x11c79e(0x12f)],_0x2bffd6[_0x11c79e(0x140)]);}else console[_0x11c79e(0x174)](_0x11c79e(0x147));}else console[_0x11c79e(0x174)](_0x11c79e(0x14b));}),dropboxBackup[_0x1a0a88(0x186)]('click',async function(){var _0x5c355e=_0x1a0a88;await lockNoti(_0x5c355e(0x17c),'',0x1388);const _0x345db6=localStorage[_0x5c355e(0x139)](_0x5c355e(0x134));if(_0x345db6===null||_0x345db6==='')window[_0x5c355e(0x190)]('Cloud\x20login\x20required!');else{const _0x3d86e8=['state','save',_0x5c355e(0x141)];for(const _0x2a89d3 of _0x3d86e8){await dpCreateFolder(_0x2a89d3);}let _0x95455d=0x0;for(const _0x10a626 of _0x3d86e8){const _0x4a3cb3=a0_0x4ed8fe[_0x5c355e(0x164)+(_0x10a626['charAt'](0x0)[_0x5c355e(0x177)]()+_0x10a626['slice'](0x1))]();_0x95455d+=_0x4a3cb3['length'];}if(window[_0x5c355e(0x182)](_0x5c355e(0x18b)+_0x95455d+'\x20files\x20in\x20Kabu?'))for(const _0x596d50 of _0x3d86e8){const _0x3d8030=a0_0x4ed8fe[_0x5c355e(0x164)+(_0x596d50['charAt'](0x0)[_0x5c355e(0x177)]()+_0x596d50['slice'](0x1))]();for(const _0x39cd59 of _0x3d8030){const _0x443626=await a0_0x4ed8fe[_0x5c355e(0x13e)](_0x5c355e(0x16b)+_0x596d50+'s/'+_0x39cd59);try{await lockNoti(_0x5c355e(0x135),_0x39cd59,0xbb8),await dpUploadFile(_0x39cd59,_0x443626,_0x596d50);}catch(_0x46e3af){console['error'](_0x5c355e(0x15f)+_0x39cd59+':',_0x46e3af);}}}else console[_0x5c355e(0x174)](_0x5c355e(0x147));}}),dropboxCloud['addEventListener']('click',function(){var _0x11be7f=_0x1a0a88;const _0x2ef71d=localStorage[_0x11be7f(0x139)](_0x11be7f(0x134));_0x2ef71d===null||_0x2ef71d===''?authorizeWithDropbox():window[_0x11be7f(0x182)](_0x11be7f(0x14f))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x11be7f(0x188)][_0x11be7f(0x15b)]('active'),dropboxBackup[_0x11be7f(0x188)][_0x11be7f(0x15b)]('active'),dropboxCloud[_0x11be7f(0x188)][_0x11be7f(0x15b)](_0x11be7f(0x16f)));}),handleDropboxCallback();});