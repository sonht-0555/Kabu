var a0_0x5db975=a0_0x501d;(function(_0x38365f,_0x3905fd){var _0x49a991=a0_0x501d,_0x55ec68=_0x38365f();while(!![]){try{var _0xfdece=parseInt(_0x49a991(0x16d))/0x1+parseInt(_0x49a991(0x19c))/0x2*(parseInt(_0x49a991(0x141))/0x3)+-parseInt(_0x49a991(0x16e))/0x4+parseInt(_0x49a991(0x13e))/0x5*(-parseInt(_0x49a991(0x1a3))/0x6)+parseInt(_0x49a991(0x14f))/0x7*(-parseInt(_0x49a991(0x15b))/0x8)+-parseInt(_0x49a991(0x149))/0x9*(-parseInt(_0x49a991(0x177))/0xa)+parseInt(_0x49a991(0x13d))/0xb*(parseInt(_0x49a991(0x193))/0xc);if(_0xfdece===_0x3905fd)break;else _0x55ec68['push'](_0x55ec68['shift']());}catch(_0x33a13e){_0x55ec68['push'](_0x55ec68['shift']());}}}(a0_0x44d0,0x28d35));function a0_0x501d(_0x570d1e,_0x26bfc5){var _0x44d0a3=a0_0x44d0();return a0_0x501d=function(_0x501d3c,_0x4c8f0e){_0x501d3c=_0x501d3c-0x13d;var _0x2db792=_0x44d0a3[_0x501d3c];return _0x2db792;},a0_0x501d(_0x570d1e,_0x26bfc5);}import*as a0_0x303434 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5db975(0x17b),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x1e0b7e=a0_0x5db975,_0x2b2be9=window[_0x1e0b7e(0x185)]['href'][_0x1e0b7e(0x161)]('?')[0x0],_0xe0cafb=_0x1e0b7e(0x187),_0x27fc39='offline',_0x31a349=_0x1e0b7e(0x1ae)+clientId+_0x1e0b7e(0x16b)+_0xe0cafb+_0x1e0b7e(0x150)+_0x27fc39+'&redirect_uri='+encodeURIComponent(_0x2b2be9);window[_0x1e0b7e(0x185)][_0x1e0b7e(0x13f)]=_0x31a349;}function a0_0x44d0(){var _0x114325=['refresh_token','error','.ss3','status:\x20','name','Refreshing\x20token...','\x20files\x20in\x20Kabu?','parse','location','substring','code','error_description','slice','length','.tag','charAt','blob','\x20files\x20in\x20Cloud?','https://content.dropboxapi.com/2/files/upload','open','stringify','toUpperCase','2148VJykDg','remove','Restoring...','Bearer\x20','.txt','uploadSaveOrSaveState','https://api.dropboxapi.com/2/files/list_folder','.ss6','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','27796cWnROP','gba','application/json','overwrite','Do\x20you\x20want\x20to\x20backup\x20','.ss7','lastIndexOf','708036QVEQCi','classList','&redirect_uri=','Error\x20while\x20refreshing\x20token:','&client_id=','application/x-www-form-urlencoded','setItem','refreshToken','Kabu\x20storage\x20↦\x20Cloud\x20◆','getItem','click','https://www.dropbox.com/oauth2/authorize?client_id=','26477AsvjiI','10XBlXVG','href','accessToken','3FrNSke','Failed\x20to\x20upload\x20file\x20','active','Do\x20not\x20receive\x20authorization','FSSync','.ss1','entries','endsWith','36esdsKv','.ss0','POST','state','Restore\x20canceled\x20by\x20user.','text','425509nsguqP','&token_access_type=','_dateState','/data/','Backing\x20up...','replace','_imageState','.gba_dateState','Unable\x20to\x20refresh\x20token','status','log','&grant_type=','8XZwsaV','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Authorization\x20Code:','list','Do\x20you\x20want\x20to\x20restore\x20','[\x5c?&#]','split','json','https://api.dropbox.com/oauth2/token','search','exec','uid','alert','https://content.dropboxapi.com/2/files/download','addEventListener','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&response_type=','confirm','12567ecNKFr','1162936jeyhFF','uId','code=','save','application/octet-stream','setRequestHeader','access_token','DOMContentLoaded','text/plain','743590xIFkQe','No\x20refresh\x20token','=([^&#]*)','onload','knh3uz2mx2hp2eu','Cloud\x20login\x20required!'];a0_0x44d0=function(){return _0x114325;};return a0_0x44d0();}function handleDropboxCallback(){var _0x2b913c=a0_0x5db975,_0xe28386=getUrlParameter('code');_0xe28386?(getAccessToken(_0xe28386),console[_0x2b913c(0x159)](_0x2b913c(0x15d),_0xe28386)):console['log'](_0x2b913c(0x144));}function getUrlParameter(_0x57c76e){var _0x4c5d3a=a0_0x5db975;_0x57c76e=_0x57c76e[_0x4c5d3a(0x154)](/[\[]/,'\x5c[')[_0x4c5d3a(0x154)](/[\]]/,'\x5c]');var _0x459a84=new RegExp(_0x4c5d3a(0x160)+_0x57c76e+_0x4c5d3a(0x179)),_0x1c4017=_0x459a84[_0x4c5d3a(0x165)](location[_0x4c5d3a(0x164)]);return _0x1c4017===null?'':decodeURIComponent(_0x1c4017[0x1][_0x4c5d3a(0x154)](/\+/g,'\x20'));}function getAccessToken(_0x232f27){var _0x4ee994=a0_0x5db975,_0x20f07d='authorization_code',_0x39a2d5=window[_0x4ee994(0x185)][_0x4ee994(0x13f)][_0x4ee994(0x161)]('?')[0x0],_0x5ec089=new XMLHttpRequest();_0x5ec089[_0x4ee994(0x190)](_0x4ee994(0x14b),_0x4ee994(0x163)),_0x5ec089[_0x4ee994(0x173)]('Content-Type','application/x-www-form-urlencoded'),_0x5ec089[_0x4ee994(0x17a)]=function(){var _0x40e305=_0x4ee994;if(_0x5ec089['status']===0xc8){var _0x390164=JSON[_0x40e305(0x184)](_0x5ec089['responseText']),_0x2da52d=_0x390164['access_token'],_0xf037ba=_0x390164[_0x40e305(0x17d)],_0x40cdb9=_0x390164[_0x40e305(0x166)];localStorage[_0x40e305(0x1a9)](_0x40e305(0x140),_0x2da52d),localStorage[_0x40e305(0x1a9)](_0x40e305(0x1aa),_0xf037ba),localStorage['setItem']('uId',_0x40cdb9);}else console[_0x40e305(0x159)](_0x40e305(0x16a));},_0x5ec089['send'](_0x4ee994(0x170)+_0x232f27+_0x4ee994(0x15a)+_0x20f07d+_0x4ee994(0x1a7)+clientId+'&client_secret='+clientSecret+_0x4ee994(0x1a5)+encodeURIComponent(_0x39a2d5));}export async function dpRefreshToken(){var _0xf8f723=a0_0x5db975;if(!localStorage['getItem'](_0xf8f723(0x1aa)))throw _0xf8f723(0x178);try{const _0x53b20e=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0xf8f723(0x1a8)},'body':'refresh_token='+localStorage[_0xf8f723(0x1ac)](_0xf8f723(0x1aa))+_0xf8f723(0x19b)}),_0x5221da=await _0x53b20e[_0xf8f723(0x162)]();if(!_0x5221da[_0xf8f723(0x17e)])return localStorage[_0xf8f723(0x1a9)](_0xf8f723(0x140),_0x5221da[_0xf8f723(0x174)]),await lockNoti('',_0xf8f723(0x182),0xbb8),await delay(0x3e8),!![];else alert(_0x5221da[_0xf8f723(0x188)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x118ee5){console[_0xf8f723(0x17e)](_0xf8f723(0x1a6),_0x118ee5);}return![];}export async function dpUploadFile(_0x45d1f6,_0x2b5e7e){var _0x5d7e31=a0_0x5db975;const _0x3ce3ea=localStorage['getItem']('uId');var _0x57dfef=JSON['stringify']({'autorename':!![],'mode':_0x5d7e31(0x19f),'mute':!![],'strict_conflict':![],'path':'/'+_0x3ce3ea+'/'+_0x45d1f6}),_0x4f4fd2=new Blob([_0x2b5e7e],{'type':_0x5d7e31(0x172)});for(var _0x129696=0x0;_0x129696<0x2;_0x129696++){var _0x30cbdd=await fetch(_0x5d7e31(0x18f),{'method':_0x5d7e31(0x14b),'headers':{'Authorization':_0x5d7e31(0x196)+localStorage[_0x5d7e31(0x1ac)](_0x5d7e31(0x140)),'Dropbox-API-Arg':_0x57dfef,'Content-Type':'application/octet-stream'},'body':_0x4f4fd2});if(_0x30cbdd['status']!=0xc8){if(_0x30cbdd[_0x5d7e31(0x158)]==0x191){var _0x4e7dde=await dpRefreshToken();if(!_0x4e7dde)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5d7e31(0x15c)+_0x30cbdd[_0x5d7e31(0x158)];}else{var _0xefebaf=await _0x30cbdd[_0x5d7e31(0x162)]();return console[_0x5d7e31(0x159)](_0x5d7e31(0x1ab),_0x45d1f6),_0xefebaf;}}return![];}async function dpDownloadFile(_0xe70fec){var _0x305050=a0_0x5db975;const _0x537492=localStorage[_0x305050(0x1ac)](_0x305050(0x16f));var _0x30378e=JSON['stringify']({'path':'/'+_0x537492+'/'+_0xe70fec});for(var _0x201df6=0x0;_0x201df6<0x2;_0x201df6++){var _0x3d0b0c=await fetch(_0x305050(0x168),{'method':'POST','headers':{'Authorization':_0x305050(0x196)+localStorage[_0x305050(0x1ac)]('accessToken'),'Dropbox-API-Arg':_0x30378e}});if(_0x3d0b0c['status']!=0xc8){if(_0x3d0b0c[_0x305050(0x158)]==0x191){var _0x1dd2a4=await dpRefreshToken();if(!_0x1dd2a4)throw _0x305050(0x157);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3d0b0c['status'];}const _0x32fe4a=new File([await _0x3d0b0c[_0x305050(0x18d)]()],_0xe70fec);console[_0x305050(0x159)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x32fe4a[_0x305050(0x181)]);if(_0xe70fec[_0x305050(0x148)]('.txt')){const _0x2b8a2e=await _0x32fe4a[_0x305050(0x14e)](),[_0x4fc444,_0x5cff32]=_0x2b8a2e[_0x305050(0x161)]('\x0a\x0a'),_0x52f969=_0xe70fec[_0x305050(0x186)](0x0,_0xe70fec[_0x305050(0x1a2)](_0x305050(0x19d))+0x3),_0x14fd5d=_0xe70fec[_0x305050(0x18c)](_0xe70fec[_0x305050(0x18a)]-0x5);localStorage[_0x305050(0x1a9)](_0x52f969+_0x305050(0x151)+_0x14fd5d,_0x5cff32),localStorage[_0x305050(0x1a9)](_0x52f969+_0x305050(0x155)+_0x14fd5d,_0x4fc444);}else a0_0x303434[_0x305050(0x198)](_0x32fe4a,()=>{var _0x41bc35=_0x305050;localStorageFile(),Module[_0x41bc35(0x145)]();});return _0x32fe4a;}return![];}document[a0_0x5db975(0x169)](a0_0x5db975(0x175),function(){var _0x2a1cdd=a0_0x5db975;dropboxRestore[_0x2a1cdd(0x169)]('click',async function(){var _0x39130=_0x2a1cdd;const _0x1678d0=localStorage[_0x39130(0x1ac)](_0x39130(0x16f));if(_0x1678d0===null||_0x1678d0==='')window[_0x39130(0x167)](_0x39130(0x17c));else{var _0x50fd7b={'path':'/'+_0x1678d0};for(var _0x5ad7ab=0x0;_0x5ad7ab<0x2;_0x5ad7ab++){var _0xb9b766=await fetch(_0x39130(0x199),{'method':_0x39130(0x14b),'headers':{'Authorization':_0x39130(0x196)+localStorage[_0x39130(0x1ac)]('accessToken'),'Content-Type':_0x39130(0x19e)},'body':JSON[_0x39130(0x191)](_0x50fd7b)});console[_0x39130(0x159)](_0x39130(0x180),_0xb9b766[_0x39130(0x158)]);if(_0xb9b766[_0x39130(0x158)]!=0xc8){if(_0xb9b766[_0x39130(0x158)]==0x191){var _0x53f9a3=await dpRefreshToken();if(!_0x53f9a3)throw _0x39130(0x157);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0xb9b766[_0x39130(0x158)];}else{const _0x647299=await _0xb9b766[_0x39130(0x162)](),_0x5032c3=_0x647299[_0x39130(0x147)]['filter'](_0x5e825c=>_0x5e825c[_0x39130(0x18b)]==='file')[_0x39130(0x18a)],_0x2ccf8b=_0x39130(0x15f)+_0x5032c3+_0x39130(0x18e);if(window[_0x39130(0x16c)](_0x2ccf8b))for(const _0x1f7e25 of _0x647299[_0x39130(0x147)]){_0x1f7e25[_0x39130(0x18b)]==='file'&&(await lockNoti(_0x39130(0x195),_0x1f7e25[_0x39130(0x181)],0xbb8),await dpDownloadFile(_0x1f7e25[_0x39130(0x181)]));}else console[_0x39130(0x159)](_0x39130(0x14d));return!![];}}return![];}}),dropboxBackup[_0x2a1cdd(0x169)](_0x2a1cdd(0x1ad),async function(){var _0x1917df=_0x2a1cdd;const _0x2856e6=localStorage[_0x1917df(0x1ac)](_0x1917df(0x16f));if(_0x2856e6===null||_0x2856e6==='')window['alert'](_0x1917df(0x17c));else{const _0x4fa67c=[_0x1917df(0x14c),_0x1917df(0x171)];let _0x3c60a4=0x0;for(const _0x13d2d4 of _0x4fa67c){const _0x555c90=a0_0x303434[_0x1917df(0x15e)+(_0x13d2d4[_0x1917df(0x18c)](0x0)['toUpperCase']()+_0x13d2d4[_0x1917df(0x189)](0x1))]();_0x3c60a4+=_0x555c90[_0x1917df(0x18a)];}if(window[_0x1917df(0x16c)](_0x1917df(0x1a0)+_0x3c60a4+_0x1917df(0x183)))for(const _0x3fc84a of _0x4fa67c){const _0x56207d=a0_0x303434[_0x1917df(0x15e)+(_0x3fc84a[_0x1917df(0x18c)](0x0)[_0x1917df(0x192)]()+_0x3fc84a[_0x1917df(0x189)](0x1))]();for(const _0x1885bf of _0x56207d){const _0x289a5f=await a0_0x303434['downloadFileInCloud'](_0x1917df(0x152)+_0x3fc84a+'s/'+_0x1885bf);try{await lockNoti(_0x1917df(0x153),_0x1885bf,0xbb8),await dpUploadFile(_0x1885bf,_0x289a5f);if(_0x1885bf[_0x1917df(0x148)](_0x1917df(0x14a))||_0x1885bf[_0x1917df(0x148)](_0x1917df(0x146))||_0x1885bf[_0x1917df(0x148)]('.ss2')||_0x1885bf[_0x1917df(0x148)](_0x1917df(0x17f))||_0x1885bf[_0x1917df(0x148)]('.ss4')||_0x1885bf[_0x1917df(0x148)]('.ss5')||_0x1885bf['endsWith'](_0x1917df(0x19a))||_0x1885bf['endsWith'](_0x1917df(0x1a1))){const _0x1587eb=_0x1885bf[_0x1917df(0x186)](0x0,_0x1885bf[_0x1917df(0x1a2)]('.')),_0x2f32d4=_0x1885bf[_0x1917df(0x18c)](_0x1885bf[_0x1917df(0x18a)]-0x1),_0x2dfffa=localStorage[_0x1917df(0x1ac)](_0x1587eb+'.gba_imageState'+_0x2f32d4),_0x25b0d6=localStorage[_0x1917df(0x1ac)](_0x1587eb+_0x1917df(0x156)+_0x2f32d4);if(_0x2dfffa!==null){const _0x5eac4d=_0x2dfffa+'\x0a\x0a'+_0x25b0d6,_0x269c85=new Blob([_0x5eac4d],{'type':_0x1917df(0x176)});await lockNoti('Backing\x20up...',_0x1587eb+'.gba_slot'+_0x2f32d4+_0x1917df(0x197),0xbb8),await dpUploadFile(_0x1587eb+'.gba_slot'+_0x2f32d4+'.txt',_0x269c85);}}}catch(_0x75d553){console[_0x1917df(0x17e)](_0x1917df(0x142)+_0x1885bf+':',_0x75d553);}}}else console[_0x1917df(0x159)](_0x1917df(0x14d));}}),dropboxCloud[_0x2a1cdd(0x169)](_0x2a1cdd(0x1ad),function(){var _0x28acef=_0x2a1cdd;const _0x1c9025=localStorage[_0x28acef(0x1ac)]('uId');_0x1c9025===null||_0x1c9025===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x28acef(0x1a9)](_0x28acef(0x16f),''),dropboxRestore[_0x28acef(0x1a4)][_0x28acef(0x194)]('active'),dropboxBackup['classList'][_0x28acef(0x194)](_0x28acef(0x143)),dropboxCloud['classList'][_0x28acef(0x194)]('active'));}),handleDropboxCallback();});