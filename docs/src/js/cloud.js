var a0_0xae57ed=a0_0x3ce9;(function(_0xfe0ff4,_0x2886af){var _0x37aea6=a0_0x3ce9,_0x39b46c=_0xfe0ff4();while(!![]){try{var _0x596f22=-parseInt(_0x37aea6(0xab))/0x1+parseInt(_0x37aea6(0x7b))/0x2+parseInt(_0x37aea6(0xb7))/0x3*(-parseInt(_0x37aea6(0xcb))/0x4)+-parseInt(_0x37aea6(0x74))/0x5*(parseInt(_0x37aea6(0xaa))/0x6)+-parseInt(_0x37aea6(0x9e))/0x7+-parseInt(_0x37aea6(0x8e))/0x8*(parseInt(_0x37aea6(0x84))/0x9)+parseInt(_0x37aea6(0x96))/0xa;if(_0x596f22===_0x2886af)break;else _0x39b46c['push'](_0x39b46c['shift']());}catch(_0x2d810e){_0x39b46c['push'](_0x39b46c['shift']());}}}(a0_0x2d89,0x9384b));import*as a0_0xbf9239 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0xae57ed(0x6f),clientSecret=a0_0xae57ed(0xc5);function authorizeWithDropbox(){var _0x1a0962=a0_0xae57ed,_0x8471b2=window[_0x1a0962(0x79)][_0x1a0962(0x71)][_0x1a0962(0x88)]('?')[0x0],_0x4613f1=_0x1a0962(0xa3),_0x10d40d=_0x1a0962(0x7c),_0xaeef7d=_0x1a0962(0xd1)+clientId+_0x1a0962(0x83)+_0x4613f1+'&token_access_type='+_0x10d40d+_0x1a0962(0x94)+encodeURIComponent(_0x8471b2);window['location'][_0x1a0962(0x71)]=_0xaeef7d;}function handleDropboxCallback(){var _0x1aad18=a0_0xae57ed,_0x104eee=getUrlParameter(_0x1aad18(0xa3));_0x104eee?(getAccessToken(_0x104eee),console['log'](_0x1aad18(0xc9),_0x104eee)):console['log'](_0x1aad18(0x9d));}function a0_0x2d89(){var _0x588cef=['Unable\x20to\x20refresh\x20token','&redirect_uri=','application/x-www-form-urlencoded','32370940jSJxfm','refresh_token','Restoring...','&client_id=','https://api.dropboxapi.com/oauth2/token','access_token','alert','Do\x20not\x20receive\x20authorization','5279351qLnYwi','Folder\x20already\x20exists','Restore\x20canceled\x20by\x20user.','send','Wait\x20a\x20little\x20bit...','code','.tag','onload','blob','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','/data/','96ypQRXT','368133klZHsR','addEventListener','&grant_type=','screenshot','POST','&client_secret=','error','replace','classList','Cloud\x20login\x20required!','log','refreshToken','213WLWUbl','application/json','Backing\x20up...','DOMContentLoaded','slice','https://api.dropbox.com/oauth2/token','Failed\x20to\x20upload\x20file\x20','downloadFileInCloud','uploadFileInCloud','click','charAt','application/octet-stream','setItem','Folder\x20created','nwb3dnfh09rhs31','push','length','https://content.dropboxapi.com/2/files/download','Authorization\x20Code:','[\x5c?&#]','55540uRjwuy','status','file','Refreshing\x20token...','getItem','error_description','https://www.dropbox.com/oauth2/authorize?client_id=','open','Error\x20while\x20refreshing\x20token:','=([^&#]*)','toUpperCase','code=','Bearer\x20','confirm','knh3uz2mx2hp2eu','save','href','Error\x20creating\x20folder\x20','\x20files\x20in\x20Kabu?','234655dquSpE','overwrite','Kabu\x20storage\x20↦\x20Cloud\x20◆','\x20files\x20from\x20Cloud?','refresh_token=','location','authorization_code','1980894ipiDEq','offline','map','json','folder','responseText','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','setRequestHeader','&response_type=','6878241QVskpZ','remove','FSSync','No\x20files\x20found\x20to\x20restore.','split','list','name','accessToken','filter','active','8tYoMJd','Do\x20you\x20want\x20to\x20backup\x20','Do\x20you\x20want\x20to\x20restore\x20','uId','stringify'];a0_0x2d89=function(){return _0x588cef;};return a0_0x2d89();}function getUrlParameter(_0x4380be){var _0x57b03b=a0_0xae57ed;_0x4380be=_0x4380be['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x3631a8=new RegExp(_0x57b03b(0xca)+_0x4380be+_0x57b03b(0xd4)),_0x3a9672=_0x3631a8['exec'](location['search']);return _0x3a9672===null?'':decodeURIComponent(_0x3a9672[0x1][_0x57b03b(0xb2)](/\+/g,'\x20'));}function getAccessToken(_0x4b1883){var _0xd61d76=a0_0xae57ed,_0x34069c=_0xd61d76(0x7a),_0x351dbc=window[_0xd61d76(0x79)][_0xd61d76(0x71)][_0xd61d76(0x88)]('?')[0x0],_0x250bf9=new XMLHttpRequest();_0x250bf9[_0xd61d76(0xd2)](_0xd61d76(0xaf),_0xd61d76(0xbc)),_0x250bf9[_0xd61d76(0x82)]('Content-Type',_0xd61d76(0x95)),_0x250bf9[_0xd61d76(0xa5)]=function(){var _0x349f0b=_0xd61d76;if(_0x250bf9['status']===0xc8){var _0x2ce865=JSON['parse'](_0x250bf9[_0x349f0b(0x80)]),_0x4fd768=_0x2ce865[_0x349f0b(0x9b)],_0x2813ad=_0x2ce865[_0x349f0b(0x97)],_0x24658e=_0x2ce865['uid'];localStorage['setItem'](_0x349f0b(0x8b),_0x4fd768),localStorage['setItem'](_0x349f0b(0xb6),_0x2813ad),localStorage[_0x349f0b(0xc3)]('uId',_0x24658e);}else console[_0x349f0b(0xb5)](_0x349f0b(0x81));},_0x250bf9[_0xd61d76(0xa1)](_0xd61d76(0x6c)+_0x4b1883+_0xd61d76(0xad)+_0x34069c+_0xd61d76(0x99)+clientId+_0xd61d76(0xb0)+clientSecret+_0xd61d76(0x94)+encodeURIComponent(_0x351dbc));}export async function dpCreateFolder(_0xe234c0){var _0x7bbd91=a0_0xae57ed;const _0x2b3c76=localStorage[_0x7bbd91(0xcf)](_0x7bbd91(0x91));let _0x1d5d0a=localStorage['getItem'](_0x7bbd91(0x8b));const _0x2c25db='/'+_0x2b3c76+'/'+_0xe234c0,_0x4586e8=JSON[_0x7bbd91(0x92)]({'path':_0x2c25db,'autorename':![]});for(let _0x2e0f15=0x0;_0x2e0f15<0x2;_0x2e0f15++){try{const _0x229ae5=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x7bbd91(0xaf),'headers':{'Authorization':'Bearer\x20'+_0x1d5d0a,'Content-Type':'application/json'},'body':_0x4586e8});if(_0x229ae5['status']===0x191){const _0x2956fc=await dpRefreshToken();if(!_0x2956fc)throw new Error(_0x7bbd91(0x93));_0x1d5d0a=localStorage[_0x7bbd91(0xcf)](_0x7bbd91(0x8b));continue;}if(_0x229ae5[_0x7bbd91(0xcc)]===0x199)return{'message':_0x7bbd91(0x9f),'path':_0xe234c0};if(!_0x229ae5['ok'])throw new Error(_0x7bbd91(0x72)+_0xe234c0);const _0xd85aa5=await _0x229ae5[_0x7bbd91(0x7e)]();return await lockNoti(_0x7bbd91(0xc4),'',0xbb8),_0xd85aa5;}catch(_0x550d9c){if(_0x2e0f15===0x1)throw _0x550d9c;}}return![];}export async function dpRefreshToken(){var _0x3ce111=a0_0xae57ed;if(!localStorage[_0x3ce111(0xcf)](_0x3ce111(0xb6)))throw'No\x20refresh\x20token';try{const _0x4161ba=await fetch(_0x3ce111(0x9a),{'method':'POST','headers':{'Content-Type':_0x3ce111(0x95)},'body':_0x3ce111(0x78)+localStorage[_0x3ce111(0xcf)](_0x3ce111(0xb6))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x3bc65a=await _0x4161ba[_0x3ce111(0x7e)]();if(!_0x3bc65a[_0x3ce111(0xb1)])return localStorage['setItem']('accessToken',_0x3bc65a[_0x3ce111(0x9b)]),await lockNoti(_0x3ce111(0xce),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3bc65a[_0x3ce111(0xd0)]||_0x3ce111(0xa8));}catch(_0x466fe2){console[_0x3ce111(0xb1)](_0x3ce111(0xd3),_0x466fe2);}return![];}function a0_0x3ce9(_0xa25384,_0xf7424a){var _0x2d89c5=a0_0x2d89();return a0_0x3ce9=function(_0x3ce919,_0x37d2e3){_0x3ce919=_0x3ce919-0x6b;var _0x1942f1=_0x2d89c5[_0x3ce919];return _0x1942f1;},a0_0x3ce9(_0xa25384,_0xf7424a);}export async function dpUploadFile(_0x9ce2da,_0x2518b8,_0x54b03e){var _0x43e7f4=a0_0xae57ed;const _0x11d7ab=localStorage[_0x43e7f4(0xcf)]('uId');var _0x34e4c2=JSON[_0x43e7f4(0x92)]({'autorename':!![],'mode':_0x43e7f4(0x75),'mute':!![],'strict_conflict':![],'path':'/'+_0x11d7ab+'/'+_0x54b03e+'/'+_0x9ce2da}),_0x1ebe0b=new Blob([_0x2518b8],{'type':_0x43e7f4(0xc2)});for(var _0x1b886d=0x0;_0x1b886d<0x2;_0x1b886d++){var _0x18a9aa=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x43e7f4(0x8b)),'Dropbox-API-Arg':_0x34e4c2,'Content-Type':_0x43e7f4(0xc2)},'body':_0x1ebe0b});if(_0x18a9aa[_0x43e7f4(0xcc)]!=0xc8){if(_0x18a9aa[_0x43e7f4(0xcc)]==0x191){var _0xd1b13b=await dpRefreshToken();if(!_0xd1b13b)throw _0x43e7f4(0x93);continue;}else throw _0x43e7f4(0xa7)+_0x18a9aa[_0x43e7f4(0xcc)];}else{var _0x28f99e=await _0x18a9aa[_0x43e7f4(0x7e)]();return console[_0x43e7f4(0xb5)](_0x43e7f4(0x76),_0x9ce2da),_0x28f99e;}}return![];}export async function dpDownloadFile(_0x8a23c8,_0x238626){var _0x250a78=a0_0xae57ed;const _0x46b9c6=localStorage['getItem'](_0x250a78(0x91));var _0x4acd46=JSON[_0x250a78(0x92)]({'path':'/'+_0x46b9c6+'/'+_0x238626+'/'+_0x8a23c8});for(var _0x12b8af=0x0;_0x12b8af<0x2;_0x12b8af++){var _0x118e63=await fetch(_0x250a78(0xc8),{'method':_0x250a78(0xaf),'headers':{'Authorization':_0x250a78(0x6d)+localStorage[_0x250a78(0xcf)](_0x250a78(0x8b)),'Dropbox-API-Arg':_0x4acd46}});if(_0x118e63[_0x250a78(0xcc)]!=0xc8){if(_0x118e63['status']==0x191){var _0x42a0e5=await dpRefreshToken();if(!_0x42a0e5)throw _0x250a78(0x93);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x118e63[_0x250a78(0xcc)];}const _0x13f6ca=new File([await _0x118e63[_0x250a78(0xa6)]()],_0x8a23c8);return console[_0x250a78(0xb5)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x13f6ca[_0x250a78(0x8a)]),a0_0xbf9239[_0x250a78(0xbf)](_0x13f6ca,()=>{var _0x584705=_0x250a78;localStorageFile(),Module[_0x584705(0x86)]();}),_0x13f6ca;}return![];}document[a0_0xae57ed(0xac)](a0_0xae57ed(0xba),function(){var _0xb07331=a0_0xae57ed;dropboxRestore[_0xb07331(0xac)]('click',async function(){var _0x532361=_0xb07331;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x21f77d=localStorage[_0x532361(0xcf)]('uId'),_0x29c657=['state',_0x532361(0x70),'screenshot'];if(!_0x21f77d){window[_0x532361(0x9c)](_0x532361(0xb4));return;}let _0x1c6d88=[];for(const _0x2e3096 of _0x29c657){let _0x1eb982={'path':'/'+_0x21f77d+'/'+_0x2e3096};for(let _0x1d9d5c=0x0;_0x1d9d5c<0x2;_0x1d9d5c++){let _0x2b8acf=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x532361(0xaf),'headers':{'Authorization':_0x532361(0x6d)+localStorage[_0x532361(0xcf)]('accessToken'),'Content-Type':_0x532361(0xb8)},'body':JSON[_0x532361(0x92)](_0x1eb982)});if(_0x2b8acf['status']===0xc8){let _0x3444f2=await _0x2b8acf[_0x532361(0x7e)](),_0x27f7f3=_0x3444f2['entries'][_0x532361(0x8c)](_0x5b6236=>_0x5b6236[_0x532361(0xa4)]===_0x532361(0xcd));_0x27f7f3['length']>0x0&&_0x1c6d88[_0x532361(0xc6)](..._0x27f7f3[_0x532361(0x7d)](_0x214c82=>({'name':_0x214c82[_0x532361(0x8a)],'folder':_0x2e3096})));break;}else{if(_0x2b8acf[_0x532361(0xcc)]===0x191){let _0x15ed1d=await dpRefreshToken();if(!_0x15ed1d)throw'Unable\x20to\x20refresh\x20token';}else{console['error']('Download\x20failed\x20for\x20'+_0x2e3096+',\x20status:\x20'+_0x2b8acf[_0x532361(0xcc)]);break;}}}}if(_0x1c6d88[_0x532361(0xc7)]>0x0){const _0x3c1f14=_0x532361(0x90)+_0x1c6d88['length']+_0x532361(0x77);if(window[_0x532361(0x6e)](_0x3c1f14))for(const _0x799ef7 of _0x1c6d88){await lockNoti(_0x532361(0x98),_0x799ef7[_0x532361(0x8a)],0xbb8),await dpDownloadFile(_0x799ef7[_0x532361(0x8a)],_0x799ef7[_0x532361(0x7f)]);}else console['log'](_0x532361(0xa0));}else console['log'](_0x532361(0x87));}),dropboxBackup[_0xb07331(0xac)](_0xb07331(0xc0),async function(){var _0x18bff5=_0xb07331;await lockNoti(_0x18bff5(0xa2),'',0x1388);const _0x40526c=localStorage[_0x18bff5(0xcf)]('uId');if(_0x40526c===null||_0x40526c==='')window[_0x18bff5(0x9c)](_0x18bff5(0xb4));else{const _0x15b0a2=['state',_0x18bff5(0x70),_0x18bff5(0xae)];for(const _0x2b270e of _0x15b0a2){await dpCreateFolder(_0x2b270e);}let _0xd95cbd=0x0;for(const _0x163511 of _0x15b0a2){const _0x3b416e=a0_0xbf9239[_0x18bff5(0x89)+(_0x163511[_0x18bff5(0xc1)](0x0)[_0x18bff5(0x6b)]()+_0x163511[_0x18bff5(0xbb)](0x1))]();_0xd95cbd+=_0x3b416e[_0x18bff5(0xc7)];}if(window['confirm'](_0x18bff5(0x8f)+_0xd95cbd+_0x18bff5(0x73)))for(const _0x33131f of _0x15b0a2){const _0x2703d5=a0_0xbf9239[_0x18bff5(0x89)+(_0x33131f[_0x18bff5(0xc1)](0x0)['toUpperCase']()+_0x33131f[_0x18bff5(0xbb)](0x1))]();for(const _0x68c25a of _0x2703d5){const _0x4ddc43=await a0_0xbf9239[_0x18bff5(0xbe)](_0x18bff5(0xa9)+_0x33131f+'s/'+_0x68c25a);try{await lockNoti(_0x18bff5(0xb9),_0x68c25a,0xbb8),await dpUploadFile(_0x68c25a,_0x4ddc43,_0x33131f);}catch(_0x2cfa75){console[_0x18bff5(0xb1)](_0x18bff5(0xbd)+_0x68c25a+':',_0x2cfa75);}}}else console[_0x18bff5(0xb5)](_0x18bff5(0xa0));}}),dropboxCloud[_0xb07331(0xac)](_0xb07331(0xc0),function(){var _0x4212ff=_0xb07331;const _0x4e330d=localStorage['getItem']('uId');_0x4e330d===null||_0x4e330d===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x4212ff(0xc3)](_0x4212ff(0x91),''),dropboxRestore[_0x4212ff(0xb3)]['remove'](_0x4212ff(0x8d)),dropboxBackup[_0x4212ff(0xb3)]['remove'](_0x4212ff(0x8d)),dropboxCloud[_0x4212ff(0xb3)][_0x4212ff(0x85)](_0x4212ff(0x8d)));}),handleDropboxCallback();});