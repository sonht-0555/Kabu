var a0_0x2f739a=a0_0x5aaa;(function(_0x40d660,_0x31b85e){var _0x56063c=a0_0x5aaa,_0x19434c=_0x40d660();while(!![]){try{var _0x3eb050=-parseInt(_0x56063c(0xb5))/0x1*(parseInt(_0x56063c(0x6c))/0x2)+parseInt(_0x56063c(0x65))/0x3*(-parseInt(_0x56063c(0x8a))/0x4)+parseInt(_0x56063c(0x87))/0x5*(-parseInt(_0x56063c(0xca))/0x6)+parseInt(_0x56063c(0xc3))/0x7*(-parseInt(_0x56063c(0xa8))/0x8)+parseInt(_0x56063c(0xbe))/0x9+-parseInt(_0x56063c(0x86))/0xa+parseInt(_0x56063c(0x97))/0xb*(parseInt(_0x56063c(0x77))/0xc);if(_0x3eb050===_0x31b85e)break;else _0x19434c['push'](_0x19434c['shift']());}catch(_0x2630ed){_0x19434c['push'](_0x19434c['shift']());}}}(a0_0x5171,0x60749));import*as a0_0x3cf4a9 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2f739a(0xb0),clientSecret=a0_0x2f739a(0xbf);function a0_0x5aaa(_0x48e9be,_0x2c826d){var _0x5171c0=a0_0x5171();return a0_0x5aaa=function(_0x5aaa1b,_0x199cea){_0x5aaa1b=_0x5aaa1b-0x65;var _0x1f7524=_0x5171c0[_0x5aaa1b];return _0x1f7524;},a0_0x5aaa(_0x48e9be,_0x2c826d);}function authorizeWithDropbox(){var _0x3734e5=a0_0x2f739a,_0x201b7b=window['location'][_0x3734e5(0x76)][_0x3734e5(0xc7)]('?')[0x0],_0x4e2576=_0x3734e5(0x9d),_0x4a27c5='offline',_0x39614c=_0x3734e5(0x6e)+clientId+'&response_type='+_0x4e2576+_0x3734e5(0xb8)+_0x4a27c5+_0x3734e5(0x7c)+encodeURIComponent(_0x201b7b);window[_0x3734e5(0x6a)][_0x3734e5(0x76)]=_0x39614c;}function handleDropboxCallback(){var _0x3ba4ea=a0_0x2f739a,_0x596e28=getUrlParameter('code');_0x596e28?(getAccessToken(_0x596e28),console[_0x3ba4ea(0x82)](_0x3ba4ea(0xa3),_0x596e28)):console[_0x3ba4ea(0x82)](_0x3ba4ea(0x95));}function getUrlParameter(_0x1e2617){var _0x1792e7=a0_0x2f739a;_0x1e2617=_0x1e2617[_0x1792e7(0x81)](/[\[]/,'\x5c[')[_0x1792e7(0x81)](/[\]]/,'\x5c]');var _0x2a7ad0=new RegExp(_0x1792e7(0x99)+_0x1e2617+_0x1792e7(0xc0)),_0x1997a4=_0x2a7ad0[_0x1792e7(0xc8)](location[_0x1792e7(0x90)]);return _0x1997a4===null?'':decodeURIComponent(_0x1997a4[0x1][_0x1792e7(0x81)](/\+/g,'\x20'));}function getAccessToken(_0x276bd3){var _0x48a5ec=a0_0x2f739a,_0x5265c6=_0x48a5ec(0xb9),_0xccb8ae=window['location'][_0x48a5ec(0x76)][_0x48a5ec(0xc7)]('?')[0x0],_0x37700b=new XMLHttpRequest();_0x37700b[_0x48a5ec(0x7b)](_0x48a5ec(0xaa),'https://api.dropbox.com/oauth2/token'),_0x37700b['setRequestHeader'](_0x48a5ec(0xaf),_0x48a5ec(0xa9)),_0x37700b['onload']=function(){var _0x37d08c=_0x48a5ec;if(_0x37700b[_0x37d08c(0xa2)]===0xc8){var _0x286d86=JSON['parse'](_0x37700b['responseText']),_0x18d7be=_0x286d86[_0x37d08c(0x78)],_0xc5a254=_0x286d86['refresh_token'],_0x1cf778=_0x286d86[_0x37d08c(0xbd)];localStorage[_0x37d08c(0x9e)](_0x37d08c(0xc1),_0x18d7be),localStorage[_0x37d08c(0x9e)](_0x37d08c(0x66),_0xc5a254),localStorage[_0x37d08c(0x9e)](_0x37d08c(0xc4),_0x1cf778);}else console[_0x37d08c(0x82)](_0x37d08c(0xb3));},_0x37700b[_0x48a5ec(0xbb)](_0x48a5ec(0x88)+_0x276bd3+_0x48a5ec(0x70)+_0x5265c6+_0x48a5ec(0x92)+clientId+_0x48a5ec(0xb4)+clientSecret+_0x48a5ec(0x7c)+encodeURIComponent(_0xccb8ae));}export async function dpCreateFolder(_0x1f4337){var _0x550739=a0_0x2f739a;const _0x1d9266=localStorage[_0x550739(0xb7)]('uId');let _0x4574a1=localStorage[_0x550739(0xb7)](_0x550739(0xc1));const _0x3d5362='/'+_0x1d9266+'/'+_0x1f4337,_0x1ee2dd=JSON['stringify']({'path':_0x3d5362,'autorename':![]});for(let _0x38734c=0x0;_0x38734c<0x2;_0x38734c++){try{const _0x2f8690=await fetch(_0x550739(0x67),{'method':'POST','headers':{'Authorization':_0x550739(0x7a)+_0x4574a1,'Content-Type':'application/json'},'body':_0x1ee2dd});if(_0x2f8690['status']===0x191){const _0x9fce7a=await dpRefreshToken();if(!_0x9fce7a)throw new Error(_0x550739(0x9b));_0x4574a1=localStorage[_0x550739(0xb7)](_0x550739(0xc1));continue;}if(_0x2f8690[_0x550739(0xa2)]===0x199)return{'message':_0x550739(0x94),'path':_0x1f4337};if(!_0x2f8690['ok'])throw new Error(_0x550739(0x98)+_0x1f4337);const _0xce89bc=await _0x2f8690['json']();return await lockNoti(_0x550739(0x6b),'',0xbb8),_0xce89bc;}catch(_0x6361bb){if(_0x38734c===0x1)throw _0x6361bb;}}return![];}export async function dpRefreshToken(){var _0x3e08ea=a0_0x2f739a;if(!localStorage[_0x3e08ea(0xb7)](_0x3e08ea(0x66)))throw _0x3e08ea(0xcb);try{const _0x382c25=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x3e08ea(0xaa),'headers':{'Content-Type':_0x3e08ea(0xa9)},'body':_0x3e08ea(0x8c)+localStorage[_0x3e08ea(0xb7)]('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2fd391=await _0x382c25['json']();if(!_0x2fd391[_0x3e08ea(0x91)])return localStorage[_0x3e08ea(0x9e)]('accessToken',_0x2fd391[_0x3e08ea(0x78)]),await lockNoti(_0x3e08ea(0x69),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2fd391[_0x3e08ea(0x73)]||_0x3e08ea(0x8b));}catch(_0x1e10d2){console[_0x3e08ea(0x91)](_0x3e08ea(0xc6),_0x1e10d2);}return![];}export async function dpUploadFile(_0x4d6dec,_0x4c9cfc,_0x4decaa){var _0x3665b3=a0_0x2f739a;const _0x410ad4=localStorage['getItem']('uId');var _0x3c0e70=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x410ad4+'/'+_0x4decaa+'/'+_0x4d6dec}),_0x8ec8bb=new Blob([_0x4c9cfc],{'type':_0x3665b3(0xba)});for(var _0x5b2545=0x0;_0x5b2545<0x2;_0x5b2545++){var _0x2940a4=await fetch(_0x3665b3(0xa1),{'method':_0x3665b3(0xaa),'headers':{'Authorization':_0x3665b3(0x7a)+localStorage[_0x3665b3(0xb7)]('accessToken'),'Dropbox-API-Arg':_0x3c0e70,'Content-Type':_0x3665b3(0xba)},'body':_0x8ec8bb});if(_0x2940a4[_0x3665b3(0xa2)]!=0xc8){if(_0x2940a4[_0x3665b3(0xa2)]==0x191){var _0x317778=await dpRefreshToken();if(!_0x317778)throw _0x3665b3(0x9b);continue;}else throw _0x3665b3(0xcc)+_0x2940a4['status'];}else{var _0x1ad615=await _0x2940a4['json']();return console[_0x3665b3(0x82)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x4d6dec),_0x1ad615;}}return![];}export async function dpDownloadFile(_0x2c75c6,_0x4da306){var _0x144d75=a0_0x2f739a;const _0x586fd1=localStorage[_0x144d75(0xb7)](_0x144d75(0xc4));var _0xe3c25d=JSON[_0x144d75(0x68)]({'path':'/'+_0x586fd1+'/'+_0x4da306+'/'+_0x2c75c6});for(var _0xbb980f=0x0;_0xbb980f<0x2;_0xbb980f++){var _0x29f416=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x144d75(0xaa),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x144d75(0xb7)](_0x144d75(0xc1)),'Dropbox-API-Arg':_0xe3c25d}});if(_0x29f416[_0x144d75(0xa2)]!=0xc8){if(_0x29f416[_0x144d75(0xa2)]==0x191){var _0xe2a606=await dpRefreshToken();if(!_0xe2a606)throw _0x144d75(0x9b);continue;}else throw _0x144d75(0xc9)+_0x29f416[_0x144d75(0xa2)];}const _0x30e1ce=new File([await _0x29f416['blob']()],_0x2c75c6);return console['log'](_0x144d75(0xab),_0x30e1ce['name']),a0_0x3cf4a9[_0x144d75(0x7e)](_0x30e1ce,()=>{var _0x55b4ac=_0x144d75;localStorageFile(),Module[_0x55b4ac(0xc2)]();}),_0x30e1ce;}return![];}function a0_0x5171(){var _0x5587b9=['filter','Bearer\x20','open','&redirect_uri=','addEventListener','uploadFileInCloud','remove','Cloud\x20login\x20required!','replace','log','list','application/json','Restore\x20canceled\x20by\x20user.','5305610URuXSL','3338815gciuDQ','code=','click','2086172lCwtdU','Failed\x20to\x20refresh\x20Dropbox\x20token.','refresh_token=','active','save','.tag','search','error','&client_id=','https://api.dropboxapi.com/2/files/list_folder','Folder\x20already\x20exists','Do\x20not\x20receive\x20authorization','entries','27430293lyDpED','Error\x20creating\x20folder\x20','[\x5c?&#]','Download\x20failed\x20for\x20','Unable\x20to\x20refresh\x20token','/data/','code','setItem','charAt','push','https://content.dropboxapi.com/2/files/upload','status','Authorization\x20Code:','Restoring...','map','folder','Do\x20you\x20want\x20to\x20backup\x20','8pzINJG','application/x-www-form-urlencoded','POST','Cloud\x20↦\x20Kabu\x20storage\x20◆','classList','name','\x20files\x20in\x20Kabu?','Content-Type','knh3uz2mx2hp2eu','No\x20files\x20found\x20to\x20restore.','length','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&client_secret=','29MWzpGo','alert','getItem','&token_access_type=','authorization_code','application/octet-stream','send','confirm','uid','2447235KUxczT','nwb3dnfh09rhs31','=([^&#]*)','accessToken','FSSync','1729zOQdcF','uId','Do\x20you\x20want\x20to\x20logout?','Error\x20while\x20refreshing\x20token:','split','exec','Download\x20failed,\x20unknown\x20http\x20status:','6byKfgj','No\x20refresh\x20token','Upload\x20failed,\x20unknown\x20http\x20status:\x20',',\x20status:\x20','3BSAIGK','refreshToken','https://api.dropboxapi.com/2/files/create_folder_v2','stringify','Refreshing\x20token...','location','Folder\x20created','44854dzgoov','DOMContentLoaded','https://www.dropbox.com/oauth2/authorize?client_id=','slice','&grant_type=','Wait\x20a\x20little\x20bit...','downloadFileInCloud','error_description','state','toUpperCase','href','12qPoKAm','access_token'];a0_0x5171=function(){return _0x5587b9;};return a0_0x5171();}document[a0_0x2f739a(0x7d)](a0_0x2f739a(0x6d),function(){var _0x3f9e8d=a0_0x2f739a;dropboxRestore['addEventListener'](_0x3f9e8d(0x89),async function(){var _0xb0541c=_0x3f9e8d;await lockNoti(_0xb0541c(0x71),'',0x1388);const _0x36a636=localStorage['getItem'](_0xb0541c(0xc4)),_0x34fbdc=[_0xb0541c(0x74),_0xb0541c(0x8e),'screenshot'];if(!_0x36a636){window[_0xb0541c(0xb6)](_0xb0541c(0x80));return;}let _0x5a031e=[];for(const _0x52939f of _0x34fbdc){let _0x3a253c={'path':'/'+_0x36a636+'/'+_0x52939f};for(let _0x3472ca=0x0;_0x3472ca<0x2;_0x3472ca++){let _0x3c260c=await fetch(_0xb0541c(0x93),{'method':'POST','headers':{'Authorization':_0xb0541c(0x7a)+localStorage[_0xb0541c(0xb7)](_0xb0541c(0xc1)),'Content-Type':_0xb0541c(0x84)},'body':JSON['stringify'](_0x3a253c)});if(_0x3c260c[_0xb0541c(0xa2)]===0xc8){let _0xb048bf=await _0x3c260c['json'](),_0x116f18=_0xb048bf[_0xb0541c(0x96)][_0xb0541c(0x79)](_0x6aa070=>_0x6aa070[_0xb0541c(0x8f)]==='file');_0x116f18[_0xb0541c(0xb2)]>0x0&&_0x5a031e[_0xb0541c(0xa0)](..._0x116f18[_0xb0541c(0xa5)](_0x1bfad6=>({'name':_0x1bfad6[_0xb0541c(0xad)],'folder':_0x52939f})));break;}else{if(_0x3c260c['status']===0x191){let _0x32b605=await dpRefreshToken();if(!_0x32b605)throw _0xb0541c(0x9b);}else{console['error'](_0xb0541c(0x9a)+_0x52939f+_0xb0541c(0xcd)+_0x3c260c['status']);break;}}}}if(_0x5a031e[_0xb0541c(0xb2)]>0x0){const _0x2e4c49='Do\x20you\x20want\x20to\x20restore\x20'+_0x5a031e[_0xb0541c(0xb2)]+'\x20files\x20from\x20Cloud?';if(window[_0xb0541c(0xbc)](_0x2e4c49))for(const _0x47372e of _0x5a031e){await lockNoti(_0xb0541c(0xa4),_0x47372e[_0xb0541c(0xad)],0xbb8),await dpDownloadFile(_0x47372e['name'],_0x47372e[_0xb0541c(0xa6)]);}else console[_0xb0541c(0x82)]('Restore\x20canceled\x20by\x20user.');}else console[_0xb0541c(0x82)](_0xb0541c(0xb1));}),dropboxBackup[_0x3f9e8d(0x7d)](_0x3f9e8d(0x89),async function(){var _0x3bee0a=_0x3f9e8d;await lockNoti(_0x3bee0a(0x71),'',0x1388);const _0x7afe5b=localStorage['getItem'](_0x3bee0a(0xc4));if(_0x7afe5b===null||_0x7afe5b==='')window[_0x3bee0a(0xb6)](_0x3bee0a(0x80));else{const _0x18ca8b=[_0x3bee0a(0x74),_0x3bee0a(0x8e),'screenshot'];for(const _0x3add24 of _0x18ca8b){await dpCreateFolder(_0x3add24);}let _0x386cb2=0x0;for(const _0x2dc229 of _0x18ca8b){const _0x493439=a0_0x3cf4a9[_0x3bee0a(0x83)+(_0x2dc229['charAt'](0x0)[_0x3bee0a(0x75)]()+_0x2dc229[_0x3bee0a(0x6f)](0x1))]();_0x386cb2+=_0x493439[_0x3bee0a(0xb2)];}if(window[_0x3bee0a(0xbc)](_0x3bee0a(0xa7)+_0x386cb2+_0x3bee0a(0xae)))for(const _0x317c54 of _0x18ca8b){const _0x42df12=a0_0x3cf4a9['list'+(_0x317c54[_0x3bee0a(0x9f)](0x0)['toUpperCase']()+_0x317c54[_0x3bee0a(0x6f)](0x1))]();for(const _0x329b01 of _0x42df12){const _0x2938ab=await a0_0x3cf4a9[_0x3bee0a(0x72)](_0x3bee0a(0x9c)+_0x317c54+'s/'+_0x329b01);try{await lockNoti('Backing\x20up...',_0x329b01,0xbb8),await dpUploadFile(_0x329b01,_0x2938ab,_0x317c54);}catch(_0x350b00){console[_0x3bee0a(0x91)]('Failed\x20to\x20upload\x20file\x20'+_0x329b01+':',_0x350b00);}}}else console[_0x3bee0a(0x82)](_0x3bee0a(0x85));}}),dropboxCloud['addEventListener'](_0x3f9e8d(0x89),function(){var _0x3a3d11=_0x3f9e8d;const _0x1b4fa5=localStorage[_0x3a3d11(0xb7)](_0x3a3d11(0xc4));_0x1b4fa5===null||_0x1b4fa5===''?authorizeWithDropbox():window[_0x3a3d11(0xbc)](_0x3a3d11(0xc5))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x3a3d11(0xac)]['remove'](_0x3a3d11(0x8d)),dropboxBackup[_0x3a3d11(0xac)][_0x3a3d11(0x7f)](_0x3a3d11(0x8d)),dropboxCloud[_0x3a3d11(0xac)]['remove']('active'));}),handleDropboxCallback();});