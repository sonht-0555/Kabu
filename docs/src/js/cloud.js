var a0_0x23f496=a0_0x34fc;(function(_0x4b6014,_0x52fb10){var _0x5e8e20=a0_0x34fc,_0x477cfb=_0x4b6014();while(!![]){try{var _0x369d84=parseInt(_0x5e8e20(0x163))/0x1*(parseInt(_0x5e8e20(0x150))/0x2)+-parseInt(_0x5e8e20(0x17f))/0x3+parseInt(_0x5e8e20(0x171))/0x4*(parseInt(_0x5e8e20(0x143))/0x5)+parseInt(_0x5e8e20(0x183))/0x6*(-parseInt(_0x5e8e20(0x189))/0x7)+-parseInt(_0x5e8e20(0x181))/0x8*(parseInt(_0x5e8e20(0x134))/0x9)+parseInt(_0x5e8e20(0x193))/0xa+parseInt(_0x5e8e20(0x17a))/0xb;if(_0x369d84===_0x52fb10)break;else _0x477cfb['push'](_0x477cfb['shift']());}catch(_0x261697){_0x477cfb['push'](_0x477cfb['shift']());}}}(a0_0x578b,0xe858b));import*as a0_0x39a5ca from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x23f496(0x131),clientSecret=a0_0x23f496(0x136);function a0_0x578b(){var _0x215a2d=['&client_secret=','Do\x20you\x20want\x20to\x20restore\x20','refresh_token=','log','responseText','No\x20refresh\x20token','Backing\x20up...','DOMContentLoaded','23083962PuOVCI','Failed\x20to\x20upload\x20file\x20','remove','\x20files\x20in\x20Kabu?','Do\x20not\x20receive\x20authorization','2404665YDJYxR','authorization_code','7290824HNvzMT','getItem','6XuXNQy','\x20files\x20from\x20Cloud?','folder','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://content.dropboxapi.com/2/files/download','confirm','5356596UIEvIa','error','split','Kabu\x20storage\x20↦\x20Cloud\x20◆','Error\x20creating\x20folder\x20','Do\x20you\x20want\x20to\x20logout?','/data/','application/x-www-form-urlencoded','code','application/octet-stream','2979140SSrGCn','screenshot','Restore\x20canceled\x20by\x20user.','application/json','knh3uz2mx2hp2eu','entries','location','18zPXsjx','Failed\x20to\x20refresh\x20Dropbox\x20token.','nwb3dnfh09rhs31','uId','POST','list','addEventListener','setItem','toUpperCase','=([^&#]*)','Upload\x20failed,\x20unknown\x20http\x20status:\x20','stringify','charAt','status','https://api.dropboxapi.com/2/files/list_folder','5dGjELS','Refreshing\x20token...','Error\x20while\x20refreshing\x20token:','Restoring...','&redirect_uri=','refresh_token','code=','length','send','active','Bearer\x20','Download\x20failed,\x20unknown\x20http\x20status:','uploadFileInCloud','2JuYRzU','name','https://api.dropboxapi.com/2/files/create_folder_v2','setRequestHeader','alert','&client_id=','downloadFileInCloud','Unable\x20to\x20refresh\x20token','slice','classList','refreshToken','Download\x20failed\x20for\x20','open','https://www.dropbox.com/oauth2/authorize?client_id=','save','access_token','Folder\x20created','search','No\x20files\x20found\x20to\x20restore.','1824167bewhIi','replace','&token_access_type=','click','&response_type=','Wait\x20a\x20little\x20bit...','state','&grant_type=','accessToken','overwrite','json','exec','filter','https://api.dropbox.com/oauth2/token','482228KZvBtj'];a0_0x578b=function(){return _0x215a2d;};return a0_0x578b();}function authorizeWithDropbox(){var _0x5cebb7=a0_0x23f496,_0x30ed02=window[_0x5cebb7(0x133)]['href'][_0x5cebb7(0x18b)]('?')[0x0],_0x25726f=_0x5cebb7(0x191),_0x14a355='offline',_0xa63505=_0x5cebb7(0x15d)+clientId+_0x5cebb7(0x167)+_0x25726f+_0x5cebb7(0x165)+_0x14a355+'&redirect_uri='+encodeURIComponent(_0x30ed02);window['location']['href']=_0xa63505;}function handleDropboxCallback(){var _0x1adb43=a0_0x23f496,_0x261326=getUrlParameter(_0x1adb43(0x191));_0x261326?(getAccessToken(_0x261326),console[_0x1adb43(0x175)]('Authorization\x20Code:',_0x261326)):console['log'](_0x1adb43(0x17e));}function getUrlParameter(_0x150ba4){var _0x4783da=a0_0x23f496;_0x150ba4=_0x150ba4[_0x4783da(0x164)](/[\[]/,'\x5c[')[_0x4783da(0x164)](/[\]]/,'\x5c]');var _0x380e73=new RegExp('[\x5c?&#]'+_0x150ba4+_0x4783da(0x13d)),_0x3ddb44=_0x380e73[_0x4783da(0x16e)](location[_0x4783da(0x161)]);return _0x3ddb44===null?'':decodeURIComponent(_0x3ddb44[0x1]['replace'](/\+/g,'\x20'));}function a0_0x34fc(_0xaf4b67,_0xc75fc7){var _0x578bc5=a0_0x578b();return a0_0x34fc=function(_0x34fc0b,_0x168b76){_0x34fc0b=_0x34fc0b-0x130;var _0x4c6d4c=_0x578bc5[_0x34fc0b];return _0x4c6d4c;},a0_0x34fc(_0xaf4b67,_0xc75fc7);}function getAccessToken(_0x4ec11b){var _0x268f65=a0_0x23f496,_0x3a4870=_0x268f65(0x180),_0x22ff68=window[_0x268f65(0x133)]['href'][_0x268f65(0x18b)]('?')[0x0],_0x3fbe98=new XMLHttpRequest();_0x3fbe98[_0x268f65(0x15c)](_0x268f65(0x138),_0x268f65(0x170)),_0x3fbe98[_0x268f65(0x153)]('Content-Type',_0x268f65(0x190)),_0x3fbe98['onload']=function(){var _0x742a8d=_0x268f65;if(_0x3fbe98[_0x742a8d(0x141)]===0xc8){var _0x55947d=JSON['parse'](_0x3fbe98[_0x742a8d(0x176)]),_0x40493c=_0x55947d[_0x742a8d(0x15f)],_0x5b2541=_0x55947d[_0x742a8d(0x148)],_0x35085e=_0x55947d['uid'];localStorage[_0x742a8d(0x13b)](_0x742a8d(0x16b),_0x40493c),localStorage['setItem'](_0x742a8d(0x15a),_0x5b2541),localStorage[_0x742a8d(0x13b)](_0x742a8d(0x137),_0x35085e);}else console[_0x742a8d(0x175)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x3fbe98[_0x268f65(0x14b)](_0x268f65(0x149)+_0x4ec11b+_0x268f65(0x16a)+_0x3a4870+_0x268f65(0x155)+clientId+_0x268f65(0x172)+clientSecret+_0x268f65(0x147)+encodeURIComponent(_0x22ff68));}export async function dpCreateFolder(_0x173459){var _0x605616=a0_0x23f496;const _0x1dec77=localStorage['getItem'](_0x605616(0x137));let _0x3954d3=localStorage[_0x605616(0x182)](_0x605616(0x16b));const _0x19d1ee='/'+_0x1dec77+'/'+_0x173459,_0x4edd93=JSON[_0x605616(0x13f)]({'path':_0x19d1ee,'autorename':![]});for(let _0x40e4d7=0x0;_0x40e4d7<0x2;_0x40e4d7++){try{const _0x213136=await fetch(_0x605616(0x152),{'method':_0x605616(0x138),'headers':{'Authorization':'Bearer\x20'+_0x3954d3,'Content-Type':_0x605616(0x130)},'body':_0x4edd93});if(_0x213136[_0x605616(0x141)]===0x191){const _0x2a5293=await dpRefreshToken();if(!_0x2a5293)throw new Error(_0x605616(0x157));_0x3954d3=localStorage[_0x605616(0x182)](_0x605616(0x16b));continue;}if(_0x213136[_0x605616(0x141)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x173459};if(!_0x213136['ok'])throw new Error(_0x605616(0x18d)+_0x173459);const _0x4a3ed2=await _0x213136[_0x605616(0x16d)]();return await lockNoti(_0x605616(0x160),'',0xbb8),_0x4a3ed2;}catch(_0x14c586){if(_0x40e4d7===0x1)throw _0x14c586;}}return![];}export async function dpRefreshToken(){var _0x8f5447=a0_0x23f496;if(!localStorage['getItem']('refreshToken'))throw _0x8f5447(0x177);try{const _0x491837=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x8f5447(0x190)},'body':_0x8f5447(0x174)+localStorage['getItem'](_0x8f5447(0x15a))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2a1bd5=await _0x491837[_0x8f5447(0x16d)]();if(!_0x2a1bd5[_0x8f5447(0x18a)])return localStorage[_0x8f5447(0x13b)](_0x8f5447(0x16b),_0x2a1bd5[_0x8f5447(0x15f)]),await lockNoti(_0x8f5447(0x144),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2a1bd5['error_description']||_0x8f5447(0x135));}catch(_0x56440e){console['error'](_0x8f5447(0x145),_0x56440e);}return![];}export async function dpUploadFile(_0x3eab5e,_0x1365d4,_0x49b235){var _0x10dd4b=a0_0x23f496;const _0x3fcf71=localStorage['getItem'](_0x10dd4b(0x137));var _0x2c6868=JSON['stringify']({'autorename':!![],'mode':_0x10dd4b(0x16c),'mute':!![],'strict_conflict':![],'path':'/'+_0x3fcf71+'/'+_0x49b235+'/'+_0x3eab5e}),_0x555f11=new Blob([_0x1365d4],{'type':_0x10dd4b(0x192)});for(var _0x535da2=0x0;_0x535da2<0x2;_0x535da2++){var _0x205099=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x10dd4b(0x14d)+localStorage['getItem'](_0x10dd4b(0x16b)),'Dropbox-API-Arg':_0x2c6868,'Content-Type':_0x10dd4b(0x192)},'body':_0x555f11});if(_0x205099['status']!=0xc8){if(_0x205099[_0x10dd4b(0x141)]==0x191){var _0x558819=await dpRefreshToken();if(!_0x558819)throw _0x10dd4b(0x157);continue;}else throw _0x10dd4b(0x13e)+_0x205099[_0x10dd4b(0x141)];}else{var _0x17c783=await _0x205099[_0x10dd4b(0x16d)]();return console['log'](_0x10dd4b(0x18c),_0x3eab5e),_0x17c783;}}return![];}export async function dpDownloadFile(_0x40fa16,_0x14824b){var _0x44e4ef=a0_0x23f496;const _0x1584c6=localStorage[_0x44e4ef(0x182)](_0x44e4ef(0x137));var _0x501f33=JSON['stringify']({'path':'/'+_0x1584c6+'/'+_0x14824b+'/'+_0x40fa16});for(var _0x27dead=0x0;_0x27dead<0x2;_0x27dead++){var _0x5ba395=await fetch(_0x44e4ef(0x187),{'method':_0x44e4ef(0x138),'headers':{'Authorization':_0x44e4ef(0x14d)+localStorage[_0x44e4ef(0x182)](_0x44e4ef(0x16b)),'Dropbox-API-Arg':_0x501f33}});if(_0x5ba395[_0x44e4ef(0x141)]!=0xc8){if(_0x5ba395['status']==0x191){var _0x2af09a=await dpRefreshToken();if(!_0x2af09a)throw _0x44e4ef(0x157);continue;}else throw _0x44e4ef(0x14e)+_0x5ba395[_0x44e4ef(0x141)];}const _0x550576=new File([await _0x5ba395['blob']()],_0x40fa16);return console['log'](_0x44e4ef(0x186),_0x550576[_0x44e4ef(0x151)]),a0_0x39a5ca[_0x44e4ef(0x14f)](_0x550576,()=>{}),_0x550576;}return![];}document[a0_0x23f496(0x13a)](a0_0x23f496(0x179),function(){var _0x53322a=a0_0x23f496;dropboxRestore[_0x53322a(0x13a)](_0x53322a(0x166),async function(){var _0x221a6e=_0x53322a;await lockNoti(_0x221a6e(0x168),'',0x1388);const _0x8e4753=localStorage[_0x221a6e(0x182)](_0x221a6e(0x137)),_0x1e53b9=[_0x221a6e(0x169),'save',_0x221a6e(0x194)];if(!_0x8e4753){window[_0x221a6e(0x154)]('Cloud\x20login\x20required!');return;}let _0x2122f4=[];for(const _0x4b8cb1 of _0x1e53b9){let _0x52f8db={'path':'/'+_0x8e4753+'/'+_0x4b8cb1};for(let _0xee83ad=0x0;_0xee83ad<0x2;_0xee83ad++){let _0x27f75e=await fetch(_0x221a6e(0x142),{'method':'POST','headers':{'Authorization':_0x221a6e(0x14d)+localStorage[_0x221a6e(0x182)](_0x221a6e(0x16b)),'Content-Type':_0x221a6e(0x130)},'body':JSON['stringify'](_0x52f8db)});if(_0x27f75e['status']===0xc8){let _0x474fc9=await _0x27f75e[_0x221a6e(0x16d)](),_0x5dd955=_0x474fc9[_0x221a6e(0x132)][_0x221a6e(0x16f)](_0x88b7eb=>_0x88b7eb['.tag']==='file');_0x5dd955[_0x221a6e(0x14a)]>0x0&&_0x2122f4['push'](..._0x5dd955['map'](_0x51bbda=>({'name':_0x51bbda['name'],'folder':_0x4b8cb1})));break;}else{if(_0x27f75e[_0x221a6e(0x141)]===0x191){let _0x4c0666=await dpRefreshToken();if(!_0x4c0666)throw _0x221a6e(0x157);}else{console[_0x221a6e(0x18a)](_0x221a6e(0x15b)+_0x4b8cb1+',\x20status:\x20'+_0x27f75e[_0x221a6e(0x141)]);break;}}}}if(_0x2122f4[_0x221a6e(0x14a)]>0x0){const _0x934c8a=_0x221a6e(0x173)+_0x2122f4['length']+_0x221a6e(0x184);if(window[_0x221a6e(0x188)](_0x934c8a))for(const _0xbf65ca of _0x2122f4){await lockNoti(_0x221a6e(0x146),_0xbf65ca['name'],0xbb8),await dpDownloadFile(_0xbf65ca[_0x221a6e(0x151)],_0xbf65ca[_0x221a6e(0x185)]);}else console[_0x221a6e(0x175)](_0x221a6e(0x195));}else console[_0x221a6e(0x175)](_0x221a6e(0x162));}),dropboxBackup['addEventListener'](_0x53322a(0x166),async function(){var _0x2c0d3d=_0x53322a;await lockNoti(_0x2c0d3d(0x168),'',0x1388);const _0x396f19=localStorage[_0x2c0d3d(0x182)](_0x2c0d3d(0x137));if(_0x396f19===null||_0x396f19==='')window[_0x2c0d3d(0x154)]('Cloud\x20login\x20required!');else{const _0x161cee=[_0x2c0d3d(0x169),_0x2c0d3d(0x15e),_0x2c0d3d(0x194)];for(const _0x11b80b of _0x161cee){await dpCreateFolder(_0x11b80b);}let _0x46671d=0x0;for(const _0x44a71e of _0x161cee){const _0xfb514e=a0_0x39a5ca['list'+(_0x44a71e[_0x2c0d3d(0x140)](0x0)[_0x2c0d3d(0x13c)]()+_0x44a71e[_0x2c0d3d(0x158)](0x1))]();_0x46671d+=_0xfb514e[_0x2c0d3d(0x14a)];}if(window[_0x2c0d3d(0x188)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x46671d+_0x2c0d3d(0x17d)))for(const _0x44d44a of _0x161cee){const _0x3f4637=a0_0x39a5ca[_0x2c0d3d(0x139)+(_0x44d44a[_0x2c0d3d(0x140)](0x0)[_0x2c0d3d(0x13c)]()+_0x44d44a[_0x2c0d3d(0x158)](0x1))]();for(const _0x39a314 of _0x3f4637){const _0x3623e6=await a0_0x39a5ca[_0x2c0d3d(0x156)](_0x2c0d3d(0x18f)+_0x44d44a+'s/'+_0x39a314);try{await lockNoti(_0x2c0d3d(0x178),_0x39a314,0xbb8),await dpUploadFile(_0x39a314,_0x3623e6,_0x44d44a);}catch(_0x18ba44){console[_0x2c0d3d(0x18a)](_0x2c0d3d(0x17b)+_0x39a314+':',_0x18ba44);}}}else console[_0x2c0d3d(0x175)](_0x2c0d3d(0x195));}}),dropboxCloud['addEventListener']('click',function(){var _0x5c8eea=_0x53322a;const _0x41e384=localStorage[_0x5c8eea(0x182)](_0x5c8eea(0x137));_0x41e384===null||_0x41e384===''?authorizeWithDropbox():window[_0x5c8eea(0x188)](_0x5c8eea(0x18e))&&(localStorage[_0x5c8eea(0x13b)](_0x5c8eea(0x137),''),dropboxRestore[_0x5c8eea(0x159)]['remove'](_0x5c8eea(0x14c)),dropboxBackup[_0x5c8eea(0x159)][_0x5c8eea(0x17c)]('active'),dropboxCloud[_0x5c8eea(0x159)][_0x5c8eea(0x17c)](_0x5c8eea(0x14c)));}),handleDropboxCallback();});