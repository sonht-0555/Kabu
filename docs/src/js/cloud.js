var a0_0x4e6428=a0_0x3ea9;(function(_0x4898de,_0x17668f){var _0xda9f6b=a0_0x3ea9,_0x242e57=_0x4898de();while(!![]){try{var _0xdbcfe2=parseInt(_0xda9f6b(0x1cc))/0x1+-parseInt(_0xda9f6b(0x20b))/0x2*(parseInt(_0xda9f6b(0x1e1))/0x3)+parseInt(_0xda9f6b(0x1a9))/0x4+-parseInt(_0xda9f6b(0x1d4))/0x5+parseInt(_0xda9f6b(0x1d3))/0x6+parseInt(_0xda9f6b(0x1c0))/0x7*(parseInt(_0xda9f6b(0x1b7))/0x8)+-parseInt(_0xda9f6b(0x1ea))/0x9;if(_0xdbcfe2===_0x17668f)break;else _0x242e57['push'](_0x242e57['shift']());}catch(_0x4855f3){_0x242e57['push'](_0x242e57['shift']());}}}(a0_0x4ebd,0x82617));import*as a0_0x26080c from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4e6428(0x1fb),clientSecret=a0_0x4e6428(0x1c3);function authorizeWithDropbox(){var _0x46516b=a0_0x4e6428,_0x3e3916=window[_0x46516b(0x1b9)][_0x46516b(0x1e0)]['split']('?')[0x0],_0x334776=_0x46516b(0x203),_0x54bd3e=_0x46516b(0x1d1),_0x42b882=_0x46516b(0x204)+clientId+_0x46516b(0x1cf)+_0x334776+_0x46516b(0x1be)+_0x54bd3e+_0x46516b(0x1ae)+encodeURIComponent(_0x3e3916);window[_0x46516b(0x1b9)][_0x46516b(0x1e0)]=_0x42b882;}function handleDropboxCallback(){var _0x2a7391=a0_0x4e6428,_0x449a23=getUrlParameter(_0x2a7391(0x203));_0x449a23?(getAccessToken(_0x449a23),console[_0x2a7391(0x1fe)](_0x2a7391(0x1e3),_0x449a23)):console['log'](_0x2a7391(0x1dd));}function a0_0x3ea9(_0x2242f4,_0xd364fd){var _0x4ebd8c=a0_0x4ebd();return a0_0x3ea9=function(_0x3ea9a2,_0x2ecc4c){_0x3ea9a2=_0x3ea9a2-0x1a4;var _0x274caf=_0x4ebd8c[_0x3ea9a2];return _0x274caf;},a0_0x3ea9(_0x2242f4,_0xd364fd);}function getUrlParameter(_0x1b429a){var _0x4ef4ef=a0_0x4e6428;_0x1b429a=_0x1b429a['replace'](/[\[]/,'\x5c[')[_0x4ef4ef(0x1b5)](/[\]]/,'\x5c]');var _0x4170d9=new RegExp('[\x5c?&#]'+_0x1b429a+_0x4ef4ef(0x1e6)),_0x44b7f7=_0x4170d9['exec'](location[_0x4ef4ef(0x1ac)]);return _0x44b7f7===null?'':decodeURIComponent(_0x44b7f7[0x1][_0x4ef4ef(0x1b5)](/\+/g,'\x20'));}function a0_0x4ebd(){var _0x4a9872=['uploadFileInCloud','14cTtaKW','https://content.dropboxapi.com/2/files/download','status','\x20files\x20from\x20Cloud?','Wait\x20a\x20little\x20bit...','&client_id=','2588980HHsQWQ','Bearer\x20','save','search','split','&redirect_uri=','screenshot','https://content.dropboxapi.com/2/files/upload','overwrite','No\x20refresh\x20token','stringify','active','replace','Do\x20you\x20want\x20to\x20backup\x20','112hVJcPg','length','location','error','Failed\x20to\x20upload\x20file\x20','refresh_token=','&client_secret=','&token_access_type=','/data/','325108XiXEqZ','https://api.dropboxapi.com/2/files/list_folder','Cloud\x20login\x20required!','nwb3dnfh09rhs31','Download\x20failed\x20for\x20','click','Folder\x20already\x20exists','access_token','setItem','Do\x20you\x20want\x20to\x20restore\x20','code=','.tag','739172foKqoJ','Cloud\x20↦\x20Kabu\x20storage\x20◆','responseText','&response_type=','https://api.dropboxapi.com/2/files/create_folder_v2','offline','name','4253970LXWQkr','2986690mfSpPd','Error\x20while\x20refreshing\x20token:','DOMContentLoaded','blob','\x20files\x20in\x20Kabu?','alert','Content-Type','error_description','map','Do\x20not\x20receive\x20authorization','confirm','send','href','281889YEYwbR','Restore\x20canceled\x20by\x20user.','Authorization\x20Code:','application/x-www-form-urlencoded',',\x20status:\x20','=([^&#]*)','listFiles','setRequestHeader','Do\x20you\x20want\x20to\x20logout?','8608590AGxwvC','Unable\x20to\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','&grant_type=','application/json','json','Failed\x20to\x20refresh\x20Dropbox\x20token.','accessToken','application/octet-stream','getItem','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Backing\x20up...','remove','POST','classList','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://api.dropboxapi.com/oauth2/token','knh3uz2mx2hp2eu','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','refreshToken','log','authorization_code','https://api.dropbox.com/oauth2/token','addEventListener','state','code','https://www.dropbox.com/oauth2/authorize?client_id=','uId','folder','downloadFileInCloud','onload','Refreshing\x20token...'];a0_0x4ebd=function(){return _0x4a9872;};return a0_0x4ebd();}function getAccessToken(_0x3eb26c){var _0x4a9c1a=a0_0x4e6428,_0xd3230c=_0x4a9c1a(0x1ff),_0x10c079=window[_0x4a9c1a(0x1b9)][_0x4a9c1a(0x1e0)][_0x4a9c1a(0x1ad)]('?')[0x0],_0x5b3a99=new XMLHttpRequest();_0x5b3a99['open'](_0x4a9c1a(0x1f7),_0x4a9c1a(0x200)),_0x5b3a99[_0x4a9c1a(0x1e8)](_0x4a9c1a(0x1da),_0x4a9c1a(0x1e4)),_0x5b3a99[_0x4a9c1a(0x208)]=function(){var _0x17606a=_0x4a9c1a;if(_0x5b3a99['status']===0xc8){var _0x6e476a=JSON['parse'](_0x5b3a99[_0x17606a(0x1ce)]),_0x248be9=_0x6e476a[_0x17606a(0x1c7)],_0x593503=_0x6e476a['refresh_token'],_0x322fba=_0x6e476a['uid'];localStorage[_0x17606a(0x1c8)](_0x17606a(0x1f1),_0x248be9),localStorage[_0x17606a(0x1c8)]('refreshToken',_0x593503),localStorage[_0x17606a(0x1c8)](_0x17606a(0x205),_0x322fba);}else console[_0x17606a(0x1fe)](_0x17606a(0x1fc));},_0x5b3a99[_0x4a9c1a(0x1df)](_0x4a9c1a(0x1ca)+_0x3eb26c+_0x4a9c1a(0x1ed)+_0xd3230c+_0x4a9c1a(0x1a8)+clientId+_0x4a9c1a(0x1bd)+clientSecret+_0x4a9c1a(0x1ae)+encodeURIComponent(_0x10c079));}export async function dpCreateFolder(_0x3aa652){var _0x22e1b6=a0_0x4e6428;const _0x38f88b=localStorage[_0x22e1b6(0x1f3)](_0x22e1b6(0x205));let _0x592f8d=localStorage['getItem'](_0x22e1b6(0x1f1));const _0x4290ce='/'+_0x38f88b+'/'+_0x3aa652,_0x4ab2c3=JSON[_0x22e1b6(0x1b3)]({'path':_0x4290ce,'autorename':![]});for(let _0x4ba612=0x0;_0x4ba612<0x2;_0x4ba612++){try{const _0x180a0c=await fetch(_0x22e1b6(0x1d0),{'method':_0x22e1b6(0x1f7),'headers':{'Authorization':_0x22e1b6(0x1aa)+_0x592f8d,'Content-Type':_0x22e1b6(0x1ee)},'body':_0x4ab2c3});if(_0x180a0c[_0x22e1b6(0x1a5)]===0x191){const _0x1ba512=await dpRefreshToken();if(!_0x1ba512)throw new Error(_0x22e1b6(0x1eb));_0x592f8d=localStorage[_0x22e1b6(0x1f3)](_0x22e1b6(0x1f1));continue;}if(_0x180a0c[_0x22e1b6(0x1a5)]===0x199)return{'message':_0x22e1b6(0x1c6),'path':_0x3aa652};if(!_0x180a0c['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x3aa652);const _0x132c80=await _0x180a0c[_0x22e1b6(0x1ef)]();return await lockNoti('Folder\x20created','',0xbb8),_0x132c80;}catch(_0xd5355a){if(_0x4ba612===0x1)throw _0xd5355a;}}return![];}export async function dpRefreshToken(){var _0x5897bf=a0_0x4e6428;if(!localStorage[_0x5897bf(0x1f3)](_0x5897bf(0x1fd)))throw _0x5897bf(0x1b2);try{const _0x25b27f=await fetch(_0x5897bf(0x1fa),{'method':_0x5897bf(0x1f7),'headers':{'Content-Type':_0x5897bf(0x1e4)},'body':_0x5897bf(0x1bc)+localStorage['getItem'](_0x5897bf(0x1fd))+_0x5897bf(0x1ec)}),_0x41f024=await _0x25b27f[_0x5897bf(0x1ef)]();if(!_0x41f024[_0x5897bf(0x1ba)])return localStorage[_0x5897bf(0x1c8)](_0x5897bf(0x1f1),_0x41f024['access_token']),await lockNoti(_0x5897bf(0x209),'',0xbb8),await delay(0x3e8),!![];else alert(_0x41f024[_0x5897bf(0x1db)]||_0x5897bf(0x1f0));}catch(_0x1e7b40){console['error'](_0x5897bf(0x1d5),_0x1e7b40);}return![];}export async function dpUploadFile(_0x24e677,_0x4a3dd4,_0x16fe81){var _0x5df50d=a0_0x4e6428;const _0x44b892=localStorage['getItem'](_0x5df50d(0x205));var _0x14dafc=JSON[_0x5df50d(0x1b3)]({'autorename':!![],'mode':_0x5df50d(0x1b1),'mute':!![],'strict_conflict':![],'path':'/'+_0x44b892+'/'+_0x16fe81+'/'+_0x24e677}),_0x53187b=new Blob([_0x4a3dd4],{'type':_0x5df50d(0x1f2)});for(var _0x467e18=0x0;_0x467e18<0x2;_0x467e18++){var _0x1a3379=await fetch(_0x5df50d(0x1b0),{'method':_0x5df50d(0x1f7),'headers':{'Authorization':_0x5df50d(0x1aa)+localStorage[_0x5df50d(0x1f3)](_0x5df50d(0x1f1)),'Dropbox-API-Arg':_0x14dafc,'Content-Type':_0x5df50d(0x1f2)},'body':_0x53187b});if(_0x1a3379[_0x5df50d(0x1a5)]!=0xc8){if(_0x1a3379[_0x5df50d(0x1a5)]==0x191){var _0x40f4f8=await dpRefreshToken();if(!_0x40f4f8)throw _0x5df50d(0x1eb);continue;}else throw _0x5df50d(0x1f4)+_0x1a3379['status'];}else{var _0x2d6c27=await _0x1a3379[_0x5df50d(0x1ef)]();return console[_0x5df50d(0x1fe)](_0x5df50d(0x1f9),_0x24e677),_0x2d6c27;}}return![];}export async function dpDownloadFile(_0x339002,_0x327728){var _0x46a813=a0_0x4e6428;const _0x488f3d=localStorage['getItem'](_0x46a813(0x205));var _0x5cd3ee=JSON[_0x46a813(0x1b3)]({'path':'/'+_0x488f3d+'/'+_0x327728+'/'+_0x339002});for(var _0x543d4f=0x0;_0x543d4f<0x2;_0x543d4f++){var _0x910d4=await fetch(_0x46a813(0x1a4),{'method':_0x46a813(0x1f7),'headers':{'Authorization':_0x46a813(0x1aa)+localStorage[_0x46a813(0x1f3)](_0x46a813(0x1f1)),'Dropbox-API-Arg':_0x5cd3ee}});if(_0x910d4[_0x46a813(0x1a5)]!=0xc8){if(_0x910d4['status']==0x191){var _0x57e158=await dpRefreshToken();if(!_0x57e158)throw _0x46a813(0x1eb);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x910d4[_0x46a813(0x1a5)];}const _0x243390=new File([await _0x910d4[_0x46a813(0x1d7)]()],_0x339002);return console[_0x46a813(0x1fe)](_0x46a813(0x1cd),_0x243390[_0x46a813(0x1d2)]),a0_0x26080c[_0x46a813(0x20a)](_0x243390,()=>{}),_0x243390;}return![];}document['addEventListener'](a0_0x4e6428(0x1d6),function(){var _0x1c6452=a0_0x4e6428;dropboxRestore[_0x1c6452(0x201)](_0x1c6452(0x1c5),async function(){var _0xeed76=_0x1c6452;await lockNoti(_0xeed76(0x1a7),'',0x1388);const _0x4fb9b=localStorage['getItem'](_0xeed76(0x205)),_0x28006a=[_0xeed76(0x202),_0xeed76(0x1ab),_0xeed76(0x1af)];if(!_0x4fb9b){window[_0xeed76(0x1d9)]('Cloud\x20login\x20required!');return;}let _0xbce64a=[];for(const _0x383f61 of _0x28006a){let _0x4b9214={'path':'/'+_0x4fb9b+'/'+_0x383f61};for(let _0x396015=0x0;_0x396015<0x2;_0x396015++){let _0x4acf8e=await fetch(_0xeed76(0x1c1),{'method':_0xeed76(0x1f7),'headers':{'Authorization':_0xeed76(0x1aa)+localStorage[_0xeed76(0x1f3)](_0xeed76(0x1f1)),'Content-Type':_0xeed76(0x1ee)},'body':JSON[_0xeed76(0x1b3)](_0x4b9214)});if(_0x4acf8e[_0xeed76(0x1a5)]===0xc8){let _0x30f52f=await _0x4acf8e[_0xeed76(0x1ef)](),_0x101b6f=_0x30f52f['entries']['filter'](_0x24794c=>_0x24794c[_0xeed76(0x1cb)]==='file');_0x101b6f[_0xeed76(0x1b8)]>0x0&&_0xbce64a['push'](..._0x101b6f[_0xeed76(0x1dc)](_0x21522e=>({'name':_0x21522e['name'],'folder':_0x383f61})));break;}else{if(_0x4acf8e[_0xeed76(0x1a5)]===0x191){let _0x5e91de=await dpRefreshToken();if(!_0x5e91de)throw _0xeed76(0x1eb);}else{console[_0xeed76(0x1ba)](_0xeed76(0x1c4)+_0x383f61+_0xeed76(0x1e5)+_0x4acf8e[_0xeed76(0x1a5)]);break;}}}}if(_0xbce64a[_0xeed76(0x1b8)]>0x0){const _0x193368=_0xeed76(0x1c9)+_0xbce64a[_0xeed76(0x1b8)]+_0xeed76(0x1a6);if(window['confirm'](_0x193368))for(const _0x238c71 of _0xbce64a){await lockNoti('Restoring...',_0x238c71[_0xeed76(0x1d2)],0xbb8),await dpDownloadFile(_0x238c71['name'],_0x238c71[_0xeed76(0x206)]);}else console[_0xeed76(0x1fe)](_0xeed76(0x1e2));}else console[_0xeed76(0x1fe)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x1c6452(0x201)](_0x1c6452(0x1c5),async function(){var _0x4e2110=_0x1c6452;await lockNoti(_0x4e2110(0x1a7),'',0x1388);const _0x20aedb=localStorage['getItem'](_0x4e2110(0x205));if(_0x20aedb===null||_0x20aedb==='')window[_0x4e2110(0x1d9)](_0x4e2110(0x1c2));else{const _0x2e9cbd=[_0x4e2110(0x202),_0x4e2110(0x1ab),_0x4e2110(0x1af)];for(const _0x570350 of _0x2e9cbd){await dpCreateFolder(_0x570350);}let _0x249f84=0x0;for(const _0x367813 of _0x2e9cbd){const _0x1d2753=a0_0x26080c[_0x4e2110(0x1e7)](_0x367813+'s');_0x249f84+=_0x1d2753[_0x4e2110(0x1b8)];}if(window['confirm'](_0x4e2110(0x1b6)+_0x249f84+_0x4e2110(0x1d8)))for(const _0x503114 of _0x2e9cbd){const _0x6e0d69=a0_0x26080c['listFiles'](_0x503114+'s');for(const _0x29cfae of _0x6e0d69){const _0x443663=await a0_0x26080c[_0x4e2110(0x207)](_0x4e2110(0x1bf)+_0x503114+'s/'+_0x29cfae);try{await lockNoti(_0x4e2110(0x1f5),_0x29cfae,0xbb8),await dpUploadFile(_0x29cfae,_0x443663,_0x503114);}catch(_0x5b8c43){console[_0x4e2110(0x1ba)](_0x4e2110(0x1bb)+_0x29cfae+':',_0x5b8c43);}}}else console[_0x4e2110(0x1fe)](_0x4e2110(0x1e2));}}),dropboxCloud[_0x1c6452(0x201)](_0x1c6452(0x1c5),function(){var _0x23ad00=_0x1c6452;const _0x1f8b95=localStorage[_0x23ad00(0x1f3)](_0x23ad00(0x205));_0x1f8b95===null||_0x1f8b95===''?authorizeWithDropbox():window[_0x23ad00(0x1de)](_0x23ad00(0x1e9))&&(localStorage[_0x23ad00(0x1c8)](_0x23ad00(0x205),''),dropboxRestore['classList'][_0x23ad00(0x1f6)](_0x23ad00(0x1b4)),dropboxBackup[_0x23ad00(0x1f8)][_0x23ad00(0x1f6)](_0x23ad00(0x1b4)),dropboxCloud[_0x23ad00(0x1f8)][_0x23ad00(0x1f6)](_0x23ad00(0x1b4)));}),handleDropboxCallback();});