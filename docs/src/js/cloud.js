var a0_0x4b96c0=a0_0x49cd;(function(_0xcb9ba2,_0x321c2c){var _0x3e26d1=a0_0x49cd,_0x8e7f99=_0xcb9ba2();while(!![]){try{var _0x52d1f7=parseInt(_0x3e26d1(0x192))/0x1+-parseInt(_0x3e26d1(0x17d))/0x2+parseInt(_0x3e26d1(0x1c1))/0x3*(parseInt(_0x3e26d1(0x1d1))/0x4)+parseInt(_0x3e26d1(0x1b3))/0x5+parseInt(_0x3e26d1(0x1b2))/0x6*(parseInt(_0x3e26d1(0x1ae))/0x7)+-parseInt(_0x3e26d1(0x188))/0x8+parseInt(_0x3e26d1(0x186))/0x9;if(_0x52d1f7===_0x321c2c)break;else _0x8e7f99['push'](_0x8e7f99['shift']());}catch(_0x3a3a46){_0x8e7f99['push'](_0x8e7f99['shift']());}}}(a0_0xb2ff,0xdce83));import*as a0_0x23abc2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4b96c0(0x1c0),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4b8909=a0_0x4b96c0,_0x2106d6=window[_0x4b8909(0x1ce)][_0x4b8909(0x1a9)][_0x4b8909(0x199)]('?')[0x0],_0x5672ec=_0x4b8909(0x19e),_0x45bdce=_0x4b8909(0x1a0),_0xa4f6c1='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x4b8909(0x181)+_0x5672ec+_0x4b8909(0x1b1)+_0x45bdce+_0x4b8909(0x183)+encodeURIComponent(_0x2106d6);window[_0x4b8909(0x1ce)][_0x4b8909(0x1a9)]=_0xa4f6c1;}function handleDropboxCallback(){var _0x4f4cdd=a0_0x4b96c0,_0x2197fb=getUrlParameter(_0x4f4cdd(0x19e));_0x2197fb?(getAccessToken(_0x2197fb),console[_0x4f4cdd(0x1ca)](_0x4f4cdd(0x176),_0x2197fb)):console[_0x4f4cdd(0x1ca)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x4835bf){var _0x4d8e22=a0_0x4b96c0;_0x4835bf=_0x4835bf[_0x4d8e22(0x177)](/[\[]/,'\x5c[')[_0x4d8e22(0x177)](/[\]]/,'\x5c]');var _0x19a3f4=new RegExp(_0x4d8e22(0x18b)+_0x4835bf+_0x4d8e22(0x1cc)),_0x146325=_0x19a3f4[_0x4d8e22(0x16d)](location[_0x4d8e22(0x170)]);return _0x146325===null?'':decodeURIComponent(_0x146325[0x1][_0x4d8e22(0x177)](/\+/g,'\x20'));}function a0_0xb2ff(){var _0x27e927=['Error\x20while\x20refreshing\x20token:','addEventListener','uId','Cloud\x20↦\x20Kabu\x20storage\x20◆','href','https://api.dropboxapi.com/2/files/list_folder','stringify','Download\x20failed,\x20unknown\x20http\x20status:','length','8386apNgoD','error','Download\x20failed\x20for\x20','&token_access_type=','2766oSfAqt','2001910uFwwZZ','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','setRequestHeader','state','classList','Failed\x20to\x20refresh\x20Dropbox\x20token.','entries','save',',\x20status:\x20','Refreshing\x20token...','remove','Bearer\x20','Failed\x20to\x20upload\x20file\x20','knh3uz2mx2hp2eu','1059537PXZVjW','No\x20files\x20found\x20to\x20restore.','POST','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20restore\x20','refreshToken','application/octet-stream','&client_secret=','log','authorization_code','=([^&#]*)','uploadFileInCloud','location','status','getItem','4vUCCUZ','Error\x20creating\x20folder\x20','listFiles','exec','uid','.tag','search','https://content.dropboxapi.com/2/files/download','Cloud\x20login\x20required!','alert','active','Restore\x20canceled\x20by\x20user.','Authorization\x20Code:','replace','Backing\x20up...','Upload\x20failed,\x20unknown\x20http\x20status:\x20','downloadFileInCloud','overwrite','open','3517376EPhhmo','accessToken','filter','https://api.dropbox.com/oauth2/token','&response_type=','responseText','&redirect_uri=','Unable\x20to\x20refresh\x20token','Restoring...','13663764jjvpxI','\x20files\x20in\x20Kabu?','14320984pdAtLC','/data/','https://api.dropboxapi.com/2/files/create_folder_v2','[\x5c?&#]','code=','&grant_type=','application/json','Do\x20you\x20want\x20to\x20backup\x20','send','DOMContentLoaded','1629611sGPErU','access_token','confirm','folder','https://api.dropboxapi.com/oauth2/token','setItem','file','split','click','blob','name','https://content.dropboxapi.com/2/files/upload','code','error_description','offline','screenshot','Wait\x20a\x20little\x20bit...','onload','json'];a0_0xb2ff=function(){return _0x27e927;};return a0_0xb2ff();}function getAccessToken(_0x276e83){var _0x2eee2f=a0_0x4b96c0,_0x2a7364=_0x2eee2f(0x1cb),_0x332233=window[_0x2eee2f(0x1ce)]['href'][_0x2eee2f(0x199)]('?')[0x0],_0x154048=new XMLHttpRequest();_0x154048[_0x2eee2f(0x17c)]('POST',_0x2eee2f(0x180)),_0x154048[_0x2eee2f(0x1b5)]('Content-Type',_0x2eee2f(0x1c5)),_0x154048[_0x2eee2f(0x1a3)]=function(){var _0x4bca34=_0x2eee2f;if(_0x154048['status']===0xc8){var _0x3db9f8=JSON['parse'](_0x154048[_0x4bca34(0x182)]),_0x4b950=_0x3db9f8['access_token'],_0x140dad=_0x3db9f8['refresh_token'],_0x1e2395=_0x3db9f8[_0x4bca34(0x16e)];localStorage[_0x4bca34(0x197)]('accessToken',_0x4b950),localStorage[_0x4bca34(0x197)](_0x4bca34(0x1c7),_0x140dad),localStorage[_0x4bca34(0x197)](_0x4bca34(0x1a7),_0x1e2395);}else console[_0x4bca34(0x1ca)](_0x4bca34(0x1b4));},_0x154048[_0x2eee2f(0x190)](_0x2eee2f(0x18c)+_0x276e83+_0x2eee2f(0x18d)+_0x2a7364+'&client_id='+clientId+_0x2eee2f(0x1c9)+clientSecret+_0x2eee2f(0x183)+encodeURIComponent(_0x332233));}export async function dpCreateFolder(_0x677fb7){var _0x20b72d=a0_0x4b96c0;const _0x19056c=localStorage[_0x20b72d(0x1d0)](_0x20b72d(0x1a7));let _0x35fc0e=localStorage[_0x20b72d(0x1d0)](_0x20b72d(0x17e));const _0x1d9e89='/'+_0x19056c+'/'+_0x677fb7,_0x210559=JSON['stringify']({'path':_0x1d9e89,'autorename':![]});for(let _0x153086=0x0;_0x153086<0x2;_0x153086++){try{const _0x439c1e=await fetch(_0x20b72d(0x18a),{'method':_0x20b72d(0x1c3),'headers':{'Authorization':'Bearer\x20'+_0x35fc0e,'Content-Type':'application/json'},'body':_0x210559});if(_0x439c1e[_0x20b72d(0x1cf)]===0x191){const _0x4e3f72=await dpRefreshToken();if(!_0x4e3f72)throw new Error(_0x20b72d(0x184));_0x35fc0e=localStorage[_0x20b72d(0x1d0)](_0x20b72d(0x17e));continue;}if(_0x439c1e['status']===0x199)return{'message':'Folder\x20already\x20exists','path':_0x677fb7};if(!_0x439c1e['ok'])throw new Error(_0x20b72d(0x1d2)+_0x677fb7);const _0x23c734=await _0x439c1e[_0x20b72d(0x1a4)]();return await lockNoti('Folder\x20created','',0xbb8),_0x23c734;}catch(_0x783ca1){if(_0x153086===0x1)throw _0x783ca1;}}return![];}function a0_0x49cd(_0x94ad97,_0x5afa6a){var _0xb2ff43=a0_0xb2ff();return a0_0x49cd=function(_0x49cd1c,_0x348c40){_0x49cd1c=_0x49cd1c-0x16d;var _0x319b25=_0xb2ff43[_0x49cd1c];return _0x319b25;},a0_0x49cd(_0x94ad97,_0x5afa6a);}export async function dpRefreshToken(){var _0x43fd8d=a0_0x4b96c0;if(!localStorage[_0x43fd8d(0x1d0)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x561eb7=await fetch(_0x43fd8d(0x196),{'method':_0x43fd8d(0x1c3),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0x43fd8d(0x1d0)](_0x43fd8d(0x1c7))+_0x43fd8d(0x1c4)}),_0x73e7ad=await _0x561eb7[_0x43fd8d(0x1a4)]();if(!_0x73e7ad[_0x43fd8d(0x1af)])return localStorage['setItem'](_0x43fd8d(0x17e),_0x73e7ad[_0x43fd8d(0x193)]),await lockNoti(_0x43fd8d(0x1bc),'',0xbb8),await delay(0x3e8),!![];else alert(_0x73e7ad[_0x43fd8d(0x19f)]||_0x43fd8d(0x1b8));}catch(_0x44d1b2){console[_0x43fd8d(0x1af)](_0x43fd8d(0x1a5),_0x44d1b2);}return![];}export async function dpUploadFile(_0x141ba7,_0x328b03,_0x4796b7){var _0x30ff7d=a0_0x4b96c0;const _0x52d0c8=localStorage[_0x30ff7d(0x1d0)]('uId');var _0x2ed99c=JSON['stringify']({'autorename':!![],'mode':_0x30ff7d(0x17b),'mute':!![],'strict_conflict':![],'path':'/'+_0x52d0c8+'/'+_0x4796b7+'/'+_0x141ba7}),_0x51ae1b=new Blob([_0x328b03],{'type':_0x30ff7d(0x1c8)});for(var _0x427332=0x0;_0x427332<0x2;_0x427332++){var _0x4fe654=await fetch(_0x30ff7d(0x19d),{'method':_0x30ff7d(0x1c3),'headers':{'Authorization':_0x30ff7d(0x1be)+localStorage['getItem'](_0x30ff7d(0x17e)),'Dropbox-API-Arg':_0x2ed99c,'Content-Type':_0x30ff7d(0x1c8)},'body':_0x51ae1b});if(_0x4fe654['status']!=0xc8){if(_0x4fe654[_0x30ff7d(0x1cf)]==0x191){var _0x412dc7=await dpRefreshToken();if(!_0x412dc7)throw _0x30ff7d(0x184);continue;}else throw _0x30ff7d(0x179)+_0x4fe654[_0x30ff7d(0x1cf)];}else{var _0x8cfa5a=await _0x4fe654[_0x30ff7d(0x1a4)]();return console[_0x30ff7d(0x1ca)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x141ba7),_0x8cfa5a;}}return![];}export async function dpDownloadFile(_0x1e0ca9,_0x2b871e){var _0x5b0a74=a0_0x4b96c0;const _0x442cb1=localStorage[_0x5b0a74(0x1d0)]('uId');var _0x5771a0=JSON[_0x5b0a74(0x1ab)]({'path':'/'+_0x442cb1+'/'+_0x2b871e+'/'+_0x1e0ca9});for(var _0x5a43e0=0x0;_0x5a43e0<0x2;_0x5a43e0++){var _0x6bb418=await fetch(_0x5b0a74(0x171),{'method':_0x5b0a74(0x1c3),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5b0a74(0x1d0)]('accessToken'),'Dropbox-API-Arg':_0x5771a0}});if(_0x6bb418[_0x5b0a74(0x1cf)]!=0xc8){if(_0x6bb418[_0x5b0a74(0x1cf)]==0x191){var _0x13fa38=await dpRefreshToken();if(!_0x13fa38)throw _0x5b0a74(0x184);continue;}else throw _0x5b0a74(0x1ac)+_0x6bb418[_0x5b0a74(0x1cf)];}const _0x40016c=new File([await _0x6bb418[_0x5b0a74(0x19b)]()],_0x1e0ca9);return console[_0x5b0a74(0x1ca)](_0x5b0a74(0x1a8),_0x40016c[_0x5b0a74(0x19c)]),a0_0x23abc2[_0x5b0a74(0x1cd)](_0x40016c,()=>{}),_0x40016c;}return![];}document[a0_0x4b96c0(0x1a6)](a0_0x4b96c0(0x191),function(){var _0x5d52bb=a0_0x4b96c0;dropboxRestore['addEventListener'](_0x5d52bb(0x19a),async function(){var _0x27f3d7=_0x5d52bb;await lockNoti(_0x27f3d7(0x1a2),'',0x1388);const _0x51062d=localStorage[_0x27f3d7(0x1d0)](_0x27f3d7(0x1a7)),_0x1b5438=[_0x27f3d7(0x1b6),_0x27f3d7(0x1ba),_0x27f3d7(0x1a1)];if(!_0x51062d){window[_0x27f3d7(0x173)](_0x27f3d7(0x172));return;}let _0x203224=[];for(const _0x349687 of _0x1b5438){let _0x4352fd={'path':'/'+_0x51062d+'/'+_0x349687};for(let _0x362a8f=0x0;_0x362a8f<0x2;_0x362a8f++){let _0x34e630=await fetch(_0x27f3d7(0x1aa),{'method':_0x27f3d7(0x1c3),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x27f3d7(0x1d0)](_0x27f3d7(0x17e)),'Content-Type':_0x27f3d7(0x18e)},'body':JSON['stringify'](_0x4352fd)});if(_0x34e630[_0x27f3d7(0x1cf)]===0xc8){let _0xb439c5=await _0x34e630[_0x27f3d7(0x1a4)](),_0x2fd460=_0xb439c5[_0x27f3d7(0x1b9)][_0x27f3d7(0x17f)](_0x3010f1=>_0x3010f1[_0x27f3d7(0x16f)]===_0x27f3d7(0x198));_0x2fd460[_0x27f3d7(0x1ad)]>0x0&&_0x203224['push'](..._0x2fd460['map'](_0x2dcfb2=>({'name':_0x2dcfb2[_0x27f3d7(0x19c)],'folder':_0x349687})));break;}else{if(_0x34e630[_0x27f3d7(0x1cf)]===0x191){let _0x3d92c1=await dpRefreshToken();if(!_0x3d92c1)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x27f3d7(0x1b0)+_0x349687+_0x27f3d7(0x1bb)+_0x34e630['status']);break;}}}}if(_0x203224['length']>0x0){const _0x2161f9=_0x27f3d7(0x1c6)+_0x203224['length']+'\x20files\x20from\x20Cloud?';if(window[_0x27f3d7(0x194)](_0x2161f9))for(const _0x485d37 of _0x203224){await lockNoti(_0x27f3d7(0x185),_0x485d37[_0x27f3d7(0x19c)],0xbb8),await dpDownloadFile(_0x485d37[_0x27f3d7(0x19c)],_0x485d37[_0x27f3d7(0x195)]);}else console['log'](_0x27f3d7(0x175));}else console[_0x27f3d7(0x1ca)](_0x27f3d7(0x1c2));}),dropboxBackup[_0x5d52bb(0x1a6)](_0x5d52bb(0x19a),async function(){var _0x56135c=_0x5d52bb;await lockNoti(_0x56135c(0x1a2),'',0x1388);const _0x3e8a28=localStorage[_0x56135c(0x1d0)](_0x56135c(0x1a7));if(_0x3e8a28===null||_0x3e8a28==='')window[_0x56135c(0x173)](_0x56135c(0x172));else{const _0x241ce3=[_0x56135c(0x1b6),'save',_0x56135c(0x1a1)];for(const _0x141e65 of _0x241ce3){await dpCreateFolder(_0x141e65);}let _0x2902bf=0x0;for(const _0x57727c of _0x241ce3){const _0xbf4693=a0_0x23abc2[_0x56135c(0x1d3)](_0x57727c+'s');_0x2902bf+=_0xbf4693['length'];}if(window[_0x56135c(0x194)](_0x56135c(0x18f)+_0x2902bf+_0x56135c(0x187)))for(const _0x23a1a2 of _0x241ce3){const _0x13aff9=a0_0x23abc2[_0x56135c(0x1d3)](_0x23a1a2+'s');for(const _0x563a0d of _0x13aff9){const _0x4a5414=await a0_0x23abc2[_0x56135c(0x17a)](_0x56135c(0x189)+_0x23a1a2+'s/'+_0x563a0d);try{await lockNoti(_0x56135c(0x178),_0x563a0d,0xbb8),await dpUploadFile(_0x563a0d,_0x4a5414,_0x23a1a2);}catch(_0x200575){console[_0x56135c(0x1af)](_0x56135c(0x1bf)+_0x563a0d+':',_0x200575);}}}else console[_0x56135c(0x1ca)](_0x56135c(0x175));}}),dropboxCloud['addEventListener'](_0x5d52bb(0x19a),function(){var _0x3b4cb1=_0x5d52bb;const _0x48381e=localStorage[_0x3b4cb1(0x1d0)](_0x3b4cb1(0x1a7));_0x48381e===null||_0x48381e===''?authorizeWithDropbox():window[_0x3b4cb1(0x194)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x3b4cb1(0x197)](_0x3b4cb1(0x1a7),''),dropboxRestore[_0x3b4cb1(0x1b7)][_0x3b4cb1(0x1bd)](_0x3b4cb1(0x174)),dropboxBackup[_0x3b4cb1(0x1b7)][_0x3b4cb1(0x1bd)](_0x3b4cb1(0x174)),dropboxCloud['classList'][_0x3b4cb1(0x1bd)](_0x3b4cb1(0x174)));}),handleDropboxCallback();});