var a0_0x552b9e=a0_0x47e0;function a0_0x47e0(_0x4ee8c4,_0x2ee3f1){var _0x40ace4=a0_0x40ac();return a0_0x47e0=function(_0x47e09f,_0x45a4f4){_0x47e09f=_0x47e09f-0x189;var _0x459a6a=_0x40ace4[_0x47e09f];return _0x459a6a;},a0_0x47e0(_0x4ee8c4,_0x2ee3f1);}(function(_0x298aec,_0x560b21){var _0x31f510=a0_0x47e0,_0x10abe5=_0x298aec();while(!![]){try{var _0x24e4e4=-parseInt(_0x31f510(0x1cf))/0x1+-parseInt(_0x31f510(0x1b2))/0x2+-parseInt(_0x31f510(0x1bf))/0x3+-parseInt(_0x31f510(0x18e))/0x4*(parseInt(_0x31f510(0x1e4))/0x5)+-parseInt(_0x31f510(0x189))/0x6+parseInt(_0x31f510(0x1b5))/0x7*(parseInt(_0x31f510(0x1c1))/0x8)+-parseInt(_0x31f510(0x1d8))/0x9*(-parseInt(_0x31f510(0x1e0))/0xa);if(_0x24e4e4===_0x560b21)break;else _0x10abe5['push'](_0x10abe5['shift']());}catch(_0x390b47){_0x10abe5['push'](_0x10abe5['shift']());}}}(a0_0x40ac,0xeca16));import*as a0_0x15e7f9 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x552b9e(0x1a6);function authorizeWithDropbox(){var _0xb8efb9=a0_0x552b9e,_0x5e6c1e=window[_0xb8efb9(0x1cc)][_0xb8efb9(0x1cb)]['split']('?')[0x0],_0x3636cb=_0xb8efb9(0x194),_0x33bb18='offline',_0x11fd6b=_0xb8efb9(0x1d4)+clientId+_0xb8efb9(0x1a1)+_0x3636cb+'&token_access_type='+_0x33bb18+'&redirect_uri='+encodeURIComponent(_0x5e6c1e);window[_0xb8efb9(0x1cc)]['href']=_0x11fd6b;}function a0_0x40ac(){var _0x138beb=['authorization_code','56588htPReV','error','Backing\x20up...','application/octet-stream','refresh_token=','https://www.dropbox.com/oauth2/authorize?client_id=','name','application/json','open','662634dcBjlq','length','map','refresh_token','Error\x20creating\x20folder\x20','=([^&#]*)','confirm','downloadFileInCloud','430qRNTrA','https://api.dropboxapi.com/oauth2/token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropboxapi.com/2/files/list_folder','628890SMNSAh','Error\x20while\x20refreshing\x20token:','classList','accessToken','state','exec','file','blob',',\x20status:\x20','log','https://api.dropbox.com/oauth2/token','overwrite','8852886YcgZYx','No\x20refresh\x20token','stringify','application/x-www-form-urlencoded','Upload\x20failed,\x20unknown\x20http\x20status:\x20','12bKbrck','Do\x20not\x20receive\x20authorization','uId','Restore\x20canceled\x20by\x20user.','&grant_type=','Failed\x20to\x20upload\x20file\x20','code','Kabu\x20storage\x20↦\x20Cloud\x20◆','\x20files\x20from\x20Cloud?','status','active','/data/','click','Do\x20you\x20want\x20to\x20restore\x20','search','&client_secret=','https://content.dropboxapi.com/2/files/upload','listFiles','.tag','&response_type=','Authorization\x20Code:','Download\x20failed,\x20unknown\x20http\x20status:','send','screenshot','nwb3dnfh09rhs31','setRequestHeader','replace','save','[\x5c?&#]','folder','Bearer\x20','error_description','https://api.dropboxapi.com/2/files/create_folder_v2','code=','Unable\x20to\x20refresh\x20token','setItem','2621468oAzRRG','POST','json','7mzNcQk','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Folder\x20already\x20exists','Wait\x20a\x20little\x20bit...','refreshToken','getItem','DOMContentLoaded','split','\x20files\x20in\x20Kabu?','Cloud\x20↦\x20Kabu\x20storage\x20◆','2175798KeMQmD','uid','13989784HcYAra','Cloud\x20login\x20required!','addEventListener','responseText','entries','uploadFileInCloud','Restoring...','remove','Content-Type','push','href','location','Do\x20you\x20want\x20to\x20backup\x20'];a0_0x40ac=function(){return _0x138beb;};return a0_0x40ac();}function handleDropboxCallback(){var _0x1a6eb0=a0_0x552b9e,_0x3b0e4a=getUrlParameter(_0x1a6eb0(0x194));_0x3b0e4a?(getAccessToken(_0x3b0e4a),console[_0x1a6eb0(0x1ed)](_0x1a6eb0(0x1a2),_0x3b0e4a)):console[_0x1a6eb0(0x1ed)](_0x1a6eb0(0x18f));}function getUrlParameter(_0x409670){var _0xc35efb=a0_0x552b9e;_0x409670=_0x409670['replace'](/[\[]/,'\x5c[')[_0xc35efb(0x1a8)](/[\]]/,'\x5c]');var _0x25cdfe=new RegExp(_0xc35efb(0x1aa)+_0x409670+_0xc35efb(0x1dd)),_0x852e92=_0x25cdfe[_0xc35efb(0x1e9)](location[_0xc35efb(0x19c)]);return _0x852e92===null?'':decodeURIComponent(_0x852e92[0x1][_0xc35efb(0x1a8)](/\+/g,'\x20'));}function getAccessToken(_0x16ea4a){var _0x5b0f6a=a0_0x552b9e,_0x358cf9=_0x5b0f6a(0x1ce),_0x2b5474=window[_0x5b0f6a(0x1cc)][_0x5b0f6a(0x1cb)][_0x5b0f6a(0x1bc)]('?')[0x0],_0x130d02=new XMLHttpRequest();_0x130d02[_0x5b0f6a(0x1d7)]('POST',_0x5b0f6a(0x1ee)),_0x130d02[_0x5b0f6a(0x1a7)](_0x5b0f6a(0x1c9),_0x5b0f6a(0x18c)),_0x130d02['onload']=function(){var _0x4c5d1b=_0x5b0f6a;if(_0x130d02[_0x4c5d1b(0x197)]===0xc8){var _0x35e4ee=JSON['parse'](_0x130d02[_0x4c5d1b(0x1c4)]),_0x4e63bb=_0x35e4ee['access_token'],_0xc7ead3=_0x35e4ee[_0x4c5d1b(0x1db)],_0x2fad27=_0x35e4ee[_0x4c5d1b(0x1c0)];localStorage[_0x4c5d1b(0x1b1)](_0x4c5d1b(0x1e7),_0x4e63bb),localStorage['setItem'](_0x4c5d1b(0x1b9),_0xc7ead3),localStorage[_0x4c5d1b(0x1b1)]('uId',_0x2fad27);}else console['log'](_0x4c5d1b(0x1e2));},_0x130d02[_0x5b0f6a(0x1a4)](_0x5b0f6a(0x1af)+_0x16ea4a+_0x5b0f6a(0x192)+_0x358cf9+'&client_id='+clientId+_0x5b0f6a(0x19d)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x2b5474));}export async function dpCreateFolder(_0x812d3c){var _0x4ea32c=a0_0x552b9e;const _0x306cfb=localStorage[_0x4ea32c(0x1ba)]('uId');let _0x301ee3=localStorage[_0x4ea32c(0x1ba)](_0x4ea32c(0x1e7));const _0x2e4bec='/'+_0x306cfb+'/'+_0x812d3c,_0x2ee298=JSON[_0x4ea32c(0x18b)]({'path':_0x2e4bec,'autorename':![]});for(let _0x36b026=0x0;_0x36b026<0x2;_0x36b026++){try{const _0x5cd170=await fetch(_0x4ea32c(0x1ae),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x301ee3,'Content-Type':_0x4ea32c(0x1d6)},'body':_0x2ee298});if(_0x5cd170[_0x4ea32c(0x197)]===0x191){const _0x49753c=await dpRefreshToken();if(!_0x49753c)throw new Error('Unable\x20to\x20refresh\x20token');_0x301ee3=localStorage[_0x4ea32c(0x1ba)](_0x4ea32c(0x1e7));continue;}if(_0x5cd170[_0x4ea32c(0x197)]===0x199)return{'message':_0x4ea32c(0x1b7),'path':_0x812d3c};if(!_0x5cd170['ok'])throw new Error(_0x4ea32c(0x1dc)+_0x812d3c);const _0x4548dd=await _0x5cd170[_0x4ea32c(0x1b4)]();return await lockNoti('Folder\x20created','',0xbb8),_0x4548dd;}catch(_0x2c80c0){if(_0x36b026===0x1)throw _0x2c80c0;}}return![];}export async function dpRefreshToken(){var _0x477b75=a0_0x552b9e;if(!localStorage[_0x477b75(0x1ba)](_0x477b75(0x1b9)))throw _0x477b75(0x18a);try{const _0x3fbd94=await fetch(_0x477b75(0x1e1),{'method':_0x477b75(0x1b3),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x477b75(0x1d3)+localStorage[_0x477b75(0x1ba)](_0x477b75(0x1b9))+_0x477b75(0x1b6)}),_0x450dcb=await _0x3fbd94[_0x477b75(0x1b4)]();if(!_0x450dcb[_0x477b75(0x1d0)])return localStorage['setItem']('accessToken',_0x450dcb['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x450dcb[_0x477b75(0x1ad)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x13d7cc){console[_0x477b75(0x1d0)](_0x477b75(0x1e5),_0x13d7cc);}return![];}export async function dpUploadFile(_0x152f0b,_0x1ecc21,_0x432707){var _0x29abd9=a0_0x552b9e;const _0x3da0d5=localStorage[_0x29abd9(0x1ba)]('uId');var _0x1308b4=JSON[_0x29abd9(0x18b)]({'autorename':!![],'mode':_0x29abd9(0x1ef),'mute':!![],'strict_conflict':![],'path':'/'+_0x3da0d5+'/'+_0x432707+'/'+_0x152f0b}),_0x2060e9=new Blob([_0x1ecc21],{'type':_0x29abd9(0x1d2)});for(var _0x4f5d0f=0x0;_0x4f5d0f<0x2;_0x4f5d0f++){var _0x3f4acb=await fetch(_0x29abd9(0x19e),{'method':_0x29abd9(0x1b3),'headers':{'Authorization':_0x29abd9(0x1ac)+localStorage[_0x29abd9(0x1ba)](_0x29abd9(0x1e7)),'Dropbox-API-Arg':_0x1308b4,'Content-Type':'application/octet-stream'},'body':_0x2060e9});if(_0x3f4acb[_0x29abd9(0x197)]!=0xc8){if(_0x3f4acb[_0x29abd9(0x197)]==0x191){var _0x1bef44=await dpRefreshToken();if(!_0x1bef44)throw _0x29abd9(0x1b0);continue;}else throw _0x29abd9(0x18d)+_0x3f4acb[_0x29abd9(0x197)];}else{var _0x11131e=await _0x3f4acb[_0x29abd9(0x1b4)]();return console['log'](_0x29abd9(0x195),_0x152f0b),_0x11131e;}}return![];}export async function dpDownloadFile(_0x513c1c,_0x51f9ed){var _0x33784c=a0_0x552b9e;const _0x197268=localStorage[_0x33784c(0x1ba)](_0x33784c(0x190));var _0x22a82d=JSON[_0x33784c(0x18b)]({'path':'/'+_0x197268+'/'+_0x51f9ed+'/'+_0x513c1c});for(var _0x4753e5=0x0;_0x4753e5<0x2;_0x4753e5++){var _0x2130bb=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x33784c(0x1b3),'headers':{'Authorization':_0x33784c(0x1ac)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x22a82d}});if(_0x2130bb['status']!=0xc8){if(_0x2130bb[_0x33784c(0x197)]==0x191){var _0x1eb784=await dpRefreshToken();if(!_0x1eb784)throw _0x33784c(0x1b0);continue;}else throw _0x33784c(0x1a3)+_0x2130bb[_0x33784c(0x197)];}const _0x47ad1f=new File([await _0x2130bb[_0x33784c(0x1eb)]()],_0x513c1c);return console[_0x33784c(0x1ed)](_0x33784c(0x1be),_0x47ad1f[_0x33784c(0x1d5)]),a0_0x15e7f9[_0x33784c(0x1c6)](_0x47ad1f,()=>{}),_0x47ad1f;}return![];}document[a0_0x552b9e(0x1c3)](a0_0x552b9e(0x1bb),function(){var _0x29c20c=a0_0x552b9e;dropboxRestore[_0x29c20c(0x1c3)](_0x29c20c(0x19a),async function(){var _0x1e4995=_0x29c20c;await lockNoti(_0x1e4995(0x1b8),'',0x1388);const _0x5fb265=localStorage[_0x1e4995(0x1ba)](_0x1e4995(0x190)),_0x1bf14b=[_0x1e4995(0x1e8),_0x1e4995(0x1a9),_0x1e4995(0x1a5)];if(!_0x5fb265){window['alert'](_0x1e4995(0x1c2));return;}let _0x3bc80e=[];for(const _0x4f494b of _0x1bf14b){let _0x19008a={'path':'/'+_0x5fb265+'/'+_0x4f494b};for(let _0x578463=0x0;_0x578463<0x2;_0x578463++){let _0x472984=await fetch(_0x1e4995(0x1e3),{'method':_0x1e4995(0x1b3),'headers':{'Authorization':_0x1e4995(0x1ac)+localStorage[_0x1e4995(0x1ba)](_0x1e4995(0x1e7)),'Content-Type':_0x1e4995(0x1d6)},'body':JSON[_0x1e4995(0x18b)](_0x19008a)});if(_0x472984[_0x1e4995(0x197)]===0xc8){let _0x3c318e=await _0x472984[_0x1e4995(0x1b4)](),_0x2f3b90=_0x3c318e[_0x1e4995(0x1c5)]['filter'](_0x5cee2a=>_0x5cee2a[_0x1e4995(0x1a0)]===_0x1e4995(0x1ea));_0x2f3b90['length']>0x0&&_0x3bc80e[_0x1e4995(0x1ca)](..._0x2f3b90[_0x1e4995(0x1da)](_0x171b19=>({'name':_0x171b19[_0x1e4995(0x1d5)],'folder':_0x4f494b})));break;}else{if(_0x472984[_0x1e4995(0x197)]===0x191){let _0x2fdbef=await dpRefreshToken();if(!_0x2fdbef)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x1e4995(0x1d0)]('Download\x20failed\x20for\x20'+_0x4f494b+_0x1e4995(0x1ec)+_0x472984[_0x1e4995(0x197)]);break;}}}}if(_0x3bc80e[_0x1e4995(0x1d9)]>0x0){const _0x4a57fd=_0x1e4995(0x19b)+_0x3bc80e[_0x1e4995(0x1d9)]+_0x1e4995(0x196);if(window[_0x1e4995(0x1de)](_0x4a57fd))for(const _0x44f332 of _0x3bc80e){await lockNoti(_0x1e4995(0x1c7),_0x44f332[_0x1e4995(0x1d5)],0xbb8),await dpDownloadFile(_0x44f332[_0x1e4995(0x1d5)],_0x44f332[_0x1e4995(0x1ab)]);}else console['log'](_0x1e4995(0x191));}else console[_0x1e4995(0x1ed)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x29c20c(0x1c3)]('click',async function(){var _0x1cda60=_0x29c20c;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x3c8f69=localStorage['getItem'](_0x1cda60(0x190));if(_0x3c8f69===null||_0x3c8f69==='')window['alert'](_0x1cda60(0x1c2));else{const _0x55dcae=['state',_0x1cda60(0x1a9),'screenshot'];for(const _0x8e7fa7 of _0x55dcae){await dpCreateFolder(_0x8e7fa7);}let _0x3c80bf=0x0;for(const _0x82b60d of _0x55dcae){const _0x95dece=a0_0x15e7f9[_0x1cda60(0x19f)](_0x82b60d+'s');_0x3c80bf+=_0x95dece[_0x1cda60(0x1d9)];}if(window[_0x1cda60(0x1de)](_0x1cda60(0x1cd)+_0x3c80bf+_0x1cda60(0x1bd)))for(const _0xa99258 of _0x55dcae){const _0x40fbdb=a0_0x15e7f9[_0x1cda60(0x19f)](_0xa99258+'s');for(const _0x1ea66f of _0x40fbdb){const _0x4e60d7=await a0_0x15e7f9[_0x1cda60(0x1df)](_0x1cda60(0x199)+_0xa99258+'s/'+_0x1ea66f);try{await lockNoti(_0x1cda60(0x1d1),_0x1ea66f,0xbb8),await dpUploadFile(_0x1ea66f,_0x4e60d7,_0xa99258);}catch(_0xfbac43){console[_0x1cda60(0x1d0)](_0x1cda60(0x193)+_0x1ea66f+':',_0xfbac43);}}}else console[_0x1cda60(0x1ed)](_0x1cda60(0x191));}}),dropboxCloud[_0x29c20c(0x1c3)](_0x29c20c(0x19a),function(){var _0x5804c8=_0x29c20c;const _0x5f57fb=localStorage['getItem'](_0x5804c8(0x190));_0x5f57fb===null||_0x5f57fb===''?authorizeWithDropbox():window[_0x5804c8(0x1de)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x5804c8(0x1b1)]('uId',''),dropboxRestore['classList'][_0x5804c8(0x1c8)](_0x5804c8(0x198)),dropboxBackup[_0x5804c8(0x1e6)][_0x5804c8(0x1c8)]('active'),dropboxCloud[_0x5804c8(0x1e6)][_0x5804c8(0x1c8)](_0x5804c8(0x198)));}),handleDropboxCallback();});