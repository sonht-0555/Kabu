var a0_0x1e92af=a0_0x98c2;(function(_0x41a827,_0x53f12c){var _0x3dc354=a0_0x98c2,_0x54457c=_0x41a827();while(!![]){try{var _0x2102cd=parseInt(_0x3dc354(0x197))/0x1+parseInt(_0x3dc354(0x1a1))/0x2+-parseInt(_0x3dc354(0x19e))/0x3*(-parseInt(_0x3dc354(0x173))/0x4)+-parseInt(_0x3dc354(0x199))/0x5+-parseInt(_0x3dc354(0x193))/0x6+-parseInt(_0x3dc354(0x190))/0x7+-parseInt(_0x3dc354(0x1a8))/0x8*(-parseInt(_0x3dc354(0x189))/0x9);if(_0x2102cd===_0x53f12c)break;else _0x54457c['push'](_0x54457c['shift']());}catch(_0x3ff795){_0x54457c['push'](_0x54457c['shift']());}}}(a0_0x4bcf,0xa77f6));import*as a0_0x328a82 from'./main.js';function a0_0x98c2(_0x4d51dd,_0x3b1c64){var _0x4bcf1d=a0_0x4bcf();return a0_0x98c2=function(_0x98c29e,_0x52b679){_0x98c29e=_0x98c29e-0x14c;var _0x955a1e=_0x4bcf1d[_0x98c29e];return _0x955a1e;},a0_0x98c2(_0x4d51dd,_0x3b1c64);}import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x1e92af(0x192);function authorizeWithDropbox(){var _0x2f1f20=a0_0x1e92af,_0x590999=window[_0x2f1f20(0x166)]['href'][_0x2f1f20(0x15d)]('?')[0x0],_0x3f2b98=_0x2f1f20(0x181),_0x1cacf9=_0x2f1f20(0x16a),_0x5757a9=_0x2f1f20(0x176)+clientId+_0x2f1f20(0x195)+_0x3f2b98+_0x2f1f20(0x186)+_0x1cacf9+'&redirect_uri='+encodeURIComponent(_0x590999);window[_0x2f1f20(0x166)][_0x2f1f20(0x1ab)]=_0x5757a9;}function a0_0x4bcf(){var _0xf20fcc=['listFiles','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','responseText','classList','code','map','setRequestHeader','send','application/octet-stream','&token_access_type=','/data/','[\x5c?&#]','2229021xAgJeX','status','overwrite','access_token','Wait\x20a\x20little\x20bit...','active','setItem','5340006ltBAqH','Bearer\x20','nwb3dnfh09rhs31','4123722JtoqXM','https://api.dropboxapi.com/2/files/list_folder','&response_type=','\x20files\x20in\x20Kabu?','816475pyNUHZ','uId','3305180lpZrwi','application/x-www-form-urlencoded','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','getItem','2350311hIVjCq','Restoring...','Error\x20creating\x20folder\x20','1899340PQMwXI','stringify','No\x20refresh\x20token','Restore\x20canceled\x20by\x20user.','Do\x20not\x20receive\x20authorization','exec','addEventListener','8lDwYej','search','parse','href','error_description','POST','remove','error','open','json','DOMContentLoaded','application/json','name','uploadFileInCloud','Refreshing\x20token...','accessToken','Folder\x20already\x20exists','Failed\x20to\x20upload\x20file\x20','Do\x20you\x20want\x20to\x20backup\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','log','Cloud\x20login\x20required!','=([^&#]*)',',\x20status:\x20','Unable\x20to\x20refresh\x20token','split','entries','https://content.dropboxapi.com/2/files/upload','&grant_type=','Do\x20you\x20want\x20to\x20logout?','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://content.dropboxapi.com/2/files/download','confirm','save','location','&client_id=','screenshot','state','offline','replace','length','&redirect_uri=','click','Authorization\x20Code:','refresh_token=','blob','authorization_code','4cMBZVx','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','.tag','https://www.dropbox.com/oauth2/authorize?client_id=','folder','No\x20files\x20found\x20to\x20restore.','Backing\x20up...','Content-Type','file','filter'];a0_0x4bcf=function(){return _0xf20fcc;};return a0_0x4bcf();}function handleDropboxCallback(){var _0x424ad8=a0_0x1e92af,_0x5b91de=getUrlParameter(_0x424ad8(0x181));_0x5b91de?(getAccessToken(_0x5b91de),console['log'](_0x424ad8(0x16f),_0x5b91de)):console[_0x424ad8(0x158)](_0x424ad8(0x1a5));}function getUrlParameter(_0x1d079c){var _0x7a7a80=a0_0x1e92af;_0x1d079c=_0x1d079c['replace'](/[\[]/,'\x5c[')[_0x7a7a80(0x16b)](/[\]]/,'\x5c]');var _0x11b6e0=new RegExp(_0x7a7a80(0x188)+_0x1d079c+_0x7a7a80(0x15a)),_0x7fd80a=_0x11b6e0[_0x7a7a80(0x1a6)](location[_0x7a7a80(0x1a9)]);return _0x7fd80a===null?'':decodeURIComponent(_0x7fd80a[0x1][_0x7a7a80(0x16b)](/\+/g,'\x20'));}function getAccessToken(_0x429ce3){var _0x266c8d=a0_0x1e92af,_0x5487e2=_0x266c8d(0x172),_0x402727=window[_0x266c8d(0x166)][_0x266c8d(0x1ab)][_0x266c8d(0x15d)]('?')[0x0],_0x1defd0=new XMLHttpRequest();_0x1defd0[_0x266c8d(0x14c)](_0x266c8d(0x1ad),'https://api.dropbox.com/oauth2/token'),_0x1defd0[_0x266c8d(0x183)](_0x266c8d(0x17a),_0x266c8d(0x19a)),_0x1defd0['onload']=function(){var _0x603e3=_0x266c8d;if(_0x1defd0['status']===0xc8){var _0x2f868a=JSON[_0x603e3(0x1aa)](_0x1defd0[_0x603e3(0x17f)]),_0x3ef256=_0x2f868a[_0x603e3(0x18c)],_0x4fca03=_0x2f868a['refresh_token'],_0x5e82b4=_0x2f868a['uid'];localStorage['setItem'](_0x603e3(0x153),_0x3ef256),localStorage[_0x603e3(0x18f)](_0x603e3(0x19c),_0x4fca03),localStorage[_0x603e3(0x18f)](_0x603e3(0x198),_0x5e82b4);}else console[_0x603e3(0x158)](_0x603e3(0x17e));},_0x1defd0[_0x266c8d(0x184)]('code='+_0x429ce3+_0x266c8d(0x160)+_0x5487e2+_0x266c8d(0x167)+clientId+'&client_secret='+clientSecret+_0x266c8d(0x16d)+encodeURIComponent(_0x402727));}export async function dpCreateFolder(_0xb067e1){var _0x21c5a5=a0_0x1e92af;const _0x58c49a=localStorage[_0x21c5a5(0x19d)](_0x21c5a5(0x198));let _0x5020b6=localStorage['getItem'](_0x21c5a5(0x153));const _0xef287f='/'+_0x58c49a+'/'+_0xb067e1,_0x58e8e7=JSON[_0x21c5a5(0x1a2)]({'path':_0xef287f,'autorename':![]});for(let _0x35b29d=0x0;_0x35b29d<0x2;_0x35b29d++){try{const _0x1de329=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x21c5a5(0x1ad),'headers':{'Authorization':'Bearer\x20'+_0x5020b6,'Content-Type':_0x21c5a5(0x14f)},'body':_0x58e8e7});if(_0x1de329[_0x21c5a5(0x18a)]===0x191){const _0x5d17e3=await dpRefreshToken();if(!_0x5d17e3)throw new Error(_0x21c5a5(0x15c));_0x5020b6=localStorage[_0x21c5a5(0x19d)](_0x21c5a5(0x153));continue;}if(_0x1de329[_0x21c5a5(0x18a)]===0x199)return{'message':_0x21c5a5(0x154),'path':_0xb067e1};if(!_0x1de329['ok'])throw new Error(_0x21c5a5(0x1a0)+_0xb067e1);const _0x246ae2=await _0x1de329[_0x21c5a5(0x14d)]();return await lockNoti('Folder\x20created','',0xbb8),_0x246ae2;}catch(_0x1e05ca){if(_0x35b29d===0x1)throw _0x1e05ca;}}return![];}export async function dpRefreshToken(){var _0x50f9ae=a0_0x1e92af;if(!localStorage['getItem'](_0x50f9ae(0x19c)))throw _0x50f9ae(0x1a3);try{const _0x13a0c2=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x50f9ae(0x1ad),'headers':{'Content-Type':_0x50f9ae(0x19a)},'body':_0x50f9ae(0x170)+localStorage[_0x50f9ae(0x19d)](_0x50f9ae(0x19c))+_0x50f9ae(0x174)}),_0x43c0ac=await _0x13a0c2[_0x50f9ae(0x14d)]();if(!_0x43c0ac['error'])return localStorage[_0x50f9ae(0x18f)](_0x50f9ae(0x153),_0x43c0ac[_0x50f9ae(0x18c)]),await lockNoti(_0x50f9ae(0x152),'',0xbb8),await delay(0x3e8),!![];else alert(_0x43c0ac[_0x50f9ae(0x1ac)]||_0x50f9ae(0x157));}catch(_0x4ebbe5){console[_0x50f9ae(0x1af)]('Error\x20while\x20refreshing\x20token:',_0x4ebbe5);}return![];}export async function dpUploadFile(_0x9fbb88,_0x298f97,_0x12fd30){var _0x491953=a0_0x1e92af;const _0x24ba93=localStorage[_0x491953(0x19d)]('uId');var _0x4b3fb8=JSON[_0x491953(0x1a2)]({'autorename':!![],'mode':_0x491953(0x18b),'mute':!![],'strict_conflict':![],'path':'/'+_0x24ba93+'/'+_0x12fd30+'/'+_0x9fbb88}),_0x58227e=new Blob([_0x298f97],{'type':_0x491953(0x185)});for(var _0x1fb04a=0x0;_0x1fb04a<0x2;_0x1fb04a++){var _0x221066=await fetch(_0x491953(0x15f),{'method':_0x491953(0x1ad),'headers':{'Authorization':_0x491953(0x191)+localStorage[_0x491953(0x19d)](_0x491953(0x153)),'Dropbox-API-Arg':_0x4b3fb8,'Content-Type':_0x491953(0x185)},'body':_0x58227e});if(_0x221066[_0x491953(0x18a)]!=0xc8){if(_0x221066['status']==0x191){var _0x2ad20c=await dpRefreshToken();if(!_0x2ad20c)throw _0x491953(0x15c);continue;}else throw _0x491953(0x19b)+_0x221066[_0x491953(0x18a)];}else{var _0x8af365=await _0x221066[_0x491953(0x14d)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x9fbb88),_0x8af365;}}return![];}export async function dpDownloadFile(_0x4f0570,_0x1e9d9e){var _0x100d8a=a0_0x1e92af;const _0x5daebd=localStorage[_0x100d8a(0x19d)](_0x100d8a(0x198));var _0x5d740d=JSON[_0x100d8a(0x1a2)]({'path':'/'+_0x5daebd+'/'+_0x1e9d9e+'/'+_0x4f0570});for(var _0x1580ef=0x0;_0x1580ef<0x2;_0x1580ef++){var _0x51db56=await fetch(_0x100d8a(0x163),{'method':_0x100d8a(0x1ad),'headers':{'Authorization':_0x100d8a(0x191)+localStorage[_0x100d8a(0x19d)](_0x100d8a(0x153)),'Dropbox-API-Arg':_0x5d740d}});if(_0x51db56[_0x100d8a(0x18a)]!=0xc8){if(_0x51db56[_0x100d8a(0x18a)]==0x191){var _0x96f45c=await dpRefreshToken();if(!_0x96f45c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x51db56[_0x100d8a(0x18a)];}const _0x378125=new File([await _0x51db56[_0x100d8a(0x171)]()],_0x4f0570);return console[_0x100d8a(0x158)](_0x100d8a(0x162),_0x378125[_0x100d8a(0x150)]),a0_0x328a82[_0x100d8a(0x151)](_0x378125,()=>{}),_0x378125;}return![];}document['addEventListener'](a0_0x1e92af(0x14e),function(){var _0xc79d06=a0_0x1e92af;dropboxRestore[_0xc79d06(0x1a7)]('click',async function(){var _0x301028=_0xc79d06;await lockNoti(_0x301028(0x18d),'',0x1388);const _0x814304=localStorage['getItem']('uId'),_0x1d67cd=[_0x301028(0x169),_0x301028(0x165),'screenshot'];if(!_0x814304){window['alert'](_0x301028(0x159));return;}let _0x2d555e=[];for(const _0x149de0 of _0x1d67cd){let _0x9ba2ff={'path':'/'+_0x814304+'/'+_0x149de0};for(let _0x39d59a=0x0;_0x39d59a<0x2;_0x39d59a++){let _0x1b3eb1=await fetch(_0x301028(0x194),{'method':_0x301028(0x1ad),'headers':{'Authorization':_0x301028(0x191)+localStorage[_0x301028(0x19d)](_0x301028(0x153)),'Content-Type':_0x301028(0x14f)},'body':JSON[_0x301028(0x1a2)](_0x9ba2ff)});if(_0x1b3eb1[_0x301028(0x18a)]===0xc8){let _0x2fbd17=await _0x1b3eb1[_0x301028(0x14d)](),_0x2963e7=_0x2fbd17[_0x301028(0x15e)][_0x301028(0x17c)](_0x89d178=>_0x89d178[_0x301028(0x175)]===_0x301028(0x17b));_0x2963e7['length']>0x0&&_0x2d555e['push'](..._0x2963e7[_0x301028(0x182)](_0x5bae84=>({'name':_0x5bae84[_0x301028(0x150)],'folder':_0x149de0})));break;}else{if(_0x1b3eb1['status']===0x191){let _0x21b015=await dpRefreshToken();if(!_0x21b015)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x301028(0x1af)]('Download\x20failed\x20for\x20'+_0x149de0+_0x301028(0x15b)+_0x1b3eb1[_0x301028(0x18a)]);break;}}}}if(_0x2d555e[_0x301028(0x16c)]>0x0){const _0xc66f8d='Do\x20you\x20want\x20to\x20restore\x20'+_0x2d555e[_0x301028(0x16c)]+'\x20files\x20from\x20Cloud?';if(window[_0x301028(0x164)](_0xc66f8d))for(const _0xf88335 of _0x2d555e){await lockNoti(_0x301028(0x19f),_0xf88335['name'],0xbb8),await dpDownloadFile(_0xf88335['name'],_0xf88335[_0x301028(0x177)]);}else console[_0x301028(0x158)](_0x301028(0x1a4));}else console['log'](_0x301028(0x178));}),dropboxBackup[_0xc79d06(0x1a7)]('click',async function(){var _0x26c17b=_0xc79d06;await lockNoti(_0x26c17b(0x18d),'',0x1388);const _0x4a56b0=localStorage['getItem'](_0x26c17b(0x198));if(_0x4a56b0===null||_0x4a56b0==='')window['alert'](_0x26c17b(0x159));else{const _0x2963f9=[_0x26c17b(0x169),_0x26c17b(0x165),_0x26c17b(0x168)];for(const _0x178797 of _0x2963f9){await dpCreateFolder(_0x178797);}let _0x1a4dfc=0x0;for(const _0x21d1e3 of _0x2963f9){const _0x12a9f8=a0_0x328a82[_0x26c17b(0x17d)](_0x21d1e3+'s');_0x1a4dfc+=_0x12a9f8[_0x26c17b(0x16c)];}if(window[_0x26c17b(0x164)](_0x26c17b(0x156)+_0x1a4dfc+_0x26c17b(0x196)))for(const _0x330d70 of _0x2963f9){const _0x7523d8=a0_0x328a82[_0x26c17b(0x17d)](_0x330d70+'s');for(const _0x2bb6c7 of _0x7523d8){const _0x111dfa=await a0_0x328a82['downloadFileInCloud'](_0x26c17b(0x187)+_0x330d70+'s/'+_0x2bb6c7);try{await lockNoti(_0x26c17b(0x179),_0x2bb6c7,0xbb8),await dpUploadFile(_0x2bb6c7,_0x111dfa,_0x330d70);}catch(_0x4481b7){console[_0x26c17b(0x1af)](_0x26c17b(0x155)+_0x2bb6c7+':',_0x4481b7);}}}else console[_0x26c17b(0x158)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0xc79d06(0x1a7)](_0xc79d06(0x16e),function(){var _0x4bab2b=_0xc79d06;const _0x3f054c=localStorage['getItem'](_0x4bab2b(0x198));_0x3f054c===null||_0x3f054c===''?authorizeWithDropbox():window[_0x4bab2b(0x164)](_0x4bab2b(0x161))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x4bab2b(0x180)]['remove']('active'),dropboxBackup[_0x4bab2b(0x180)][_0x4bab2b(0x1ae)](_0x4bab2b(0x18e)),dropboxCloud[_0x4bab2b(0x180)][_0x4bab2b(0x1ae)](_0x4bab2b(0x18e)));}),handleDropboxCallback();});