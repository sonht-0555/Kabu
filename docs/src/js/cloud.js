var a0_0x1d2f28=a0_0x3ed8;(function(_0x5047f7,_0x26e81e){var _0x28e839=a0_0x3ed8,_0x4eacbf=_0x5047f7();while(!![]){try{var _0x1f7ae2=parseInt(_0x28e839(0xe9))/0x1+-parseInt(_0x28e839(0xce))/0x2+-parseInt(_0x28e839(0x111))/0x3+parseInt(_0x28e839(0xe5))/0x4*(parseInt(_0x28e839(0xb2))/0x5)+-parseInt(_0x28e839(0xcb))/0x6+parseInt(_0x28e839(0xda))/0x7*(-parseInt(_0x28e839(0xd6))/0x8)+parseInt(_0x28e839(0x106))/0x9;if(_0x1f7ae2===_0x26e81e)break;else _0x4eacbf['push'](_0x4eacbf['shift']());}catch(_0x581b5c){_0x4eacbf['push'](_0x4eacbf['shift']());}}}(a0_0x396f,0xa7623));import*as a0_0x49e82d from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x3ed8(_0x18b5c8,_0x4b5c48){var _0x396f7e=a0_0x396f();return a0_0x3ed8=function(_0x3ed8b9,_0x4be9b7){_0x3ed8b9=_0x3ed8b9-0xa5;var _0x1bd01a=_0x396f7e[_0x3ed8b9];return _0x1bd01a;},a0_0x3ed8(_0x18b5c8,_0x4b5c48);}var clientId=a0_0x1d2f28(0xd8),clientSecret=a0_0x1d2f28(0xaf);function authorizeWithDropbox(){var _0x443420=a0_0x1d2f28,_0x58a679=window[_0x443420(0x105)]['href'][_0x443420(0xa7)]('?')[0x0],_0x11f4b4='code',_0x3dad03=_0x443420(0xb9),_0x5ae258=_0x443420(0xf5)+clientId+_0x443420(0xf9)+_0x11f4b4+_0x443420(0xe4)+_0x3dad03+_0x443420(0xec)+encodeURIComponent(_0x58a679);window[_0x443420(0x105)][_0x443420(0xc4)]=_0x5ae258;}function a0_0x396f(){var _0x59b0dd=['Download\x20failed,\x20unknown\x20http\x20status:\x20','name','&redirect_uri=','blob','uId','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','stringify','.ss4','alert','\x20files\x20in\x20Kabu?','slice','https://www.dropbox.com/oauth2/authorize?client_id=','Bearer\x20','.gba_dateState','Cloud\x20↦\x20Kabu\x20storage\x20◆','&response_type=','code','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','gba','Kabu\x20storage\x20↦\x20Cloud\x20◆','/data/','POST','uid','text/plain','Backing\x20up...','.ss1','.gba_imageState','location','25564716TJbBNi','entries','error','status','uploadSaveOrSaveState','.ss0','.ss3','active','file','json','accessToken','3166065EpSYzi','charAt','Do\x20not\x20receive\x20authorization','Failed\x20to\x20upload\x20file\x20','responseText','Do\x20you\x20want\x20to\x20logout?','error_description','Content-Type','exec','split','endsWith','downloadFileInCloud','confirm','_dateState','.gba_slot','addEventListener','classList','nwb3dnfh09rhs31','click','substring','1925095cWMJJe','log','.tag','=([^&#]*)','\x20files\x20in\x20Cloud?','No\x20refresh\x20token','text','offline','remove','application/octet-stream','parse','Cloud\x20login\x20required!','access_token','Do\x20you\x20want\x20to\x20backup\x20','.txt','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/2/files/list_folder','Refreshing\x20token...','href','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/x-www-form-urlencoded','&grant_type=','list','lastIndexOf','refresh_token=','3793152cASTIV','setRequestHeader','setItem','977056QBGoBD','replace','onload','overwrite','refreshToken','Restore\x20canceled\x20by\x20user.','open','code=','293704gtuZLm','https://content.dropboxapi.com/2/files/download','knh3uz2mx2hp2eu','send','77nztqOA','https://api.dropboxapi.com/oauth2/token','FSSync','state','Unable\x20to\x20refresh\x20token','save','getItem','Upload\x20failed,\x20unknown\x20http\x20status:\x20','.ss5','length','&token_access_type=','4FcNsHd','refresh_token','Restoring...','toUpperCase','39978zNZhFc'];a0_0x396f=function(){return _0x59b0dd;};return a0_0x396f();}function handleDropboxCallback(){var _0x294f6f=a0_0x1d2f28,_0x5e3e34=getUrlParameter(_0x294f6f(0xfa));_0x5e3e34?(getAccessToken(_0x5e3e34),console[_0x294f6f(0xb3)]('Authorization\x20Code:',_0x5e3e34)):console[_0x294f6f(0xb3)](_0x294f6f(0x113));}function getUrlParameter(_0x42973f){var _0x9a81f6=a0_0x1d2f28;_0x42973f=_0x42973f[_0x9a81f6(0xcf)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2e3b72=new RegExp('[\x5c?&#]'+_0x42973f+_0x9a81f6(0xb5)),_0x35a4ff=_0x2e3b72[_0x9a81f6(0xa6)](location['search']);return _0x35a4ff===null?'':decodeURIComponent(_0x35a4ff[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x2d56b1){var _0x2bcaf8=a0_0x1d2f28,_0x3d2459='authorization_code',_0x4240c8=window[_0x2bcaf8(0x105)]['href'][_0x2bcaf8(0xa7)]('?')[0x0],_0x2a277d=new XMLHttpRequest();_0x2a277d[_0x2bcaf8(0xd4)]('POST','https://api.dropbox.com/oauth2/token'),_0x2a277d[_0x2bcaf8(0xcc)](_0x2bcaf8(0xa5),_0x2bcaf8(0xc6)),_0x2a277d[_0x2bcaf8(0xd0)]=function(){var _0x184f7f=_0x2bcaf8;if(_0x2a277d[_0x184f7f(0x109)]===0xc8){var _0xf9cc50=JSON[_0x184f7f(0xbc)](_0x2a277d[_0x184f7f(0x115)]),_0x5b010f=_0xf9cc50[_0x184f7f(0xbe)],_0x8c6481=_0xf9cc50[_0x184f7f(0xe6)],_0x2d5c39=_0xf9cc50[_0x184f7f(0x100)];localStorage['setItem'](_0x184f7f(0x110),_0x5b010f),localStorage[_0x184f7f(0xcd)](_0x184f7f(0xd2),_0x8c6481),localStorage['setItem'](_0x184f7f(0xee),_0x2d5c39);}else console['log'](_0x184f7f(0xef));},_0x2a277d[_0x2bcaf8(0xd9)](_0x2bcaf8(0xd5)+_0x2d56b1+_0x2bcaf8(0xc7)+_0x3d2459+'&client_id='+clientId+'&client_secret='+clientSecret+_0x2bcaf8(0xec)+encodeURIComponent(_0x4240c8));}export async function dpRefreshToken(){var _0x567141=a0_0x1d2f28;if(!localStorage[_0x567141(0xe0)](_0x567141(0xd2)))throw _0x567141(0xb7);try{const _0x39abf7=await fetch(_0x567141(0xdb),{'method':'POST','headers':{'Content-Type':_0x567141(0xc6)},'body':_0x567141(0xca)+localStorage['getItem'](_0x567141(0xd2))+_0x567141(0xfb)}),_0x502c5f=await _0x39abf7[_0x567141(0x10f)]();if(!_0x502c5f[_0x567141(0x108)])return localStorage['setItem']('accessToken',_0x502c5f[_0x567141(0xbe)]),await lockNoti('',_0x567141(0xc3),0xbb8),await delay(0x3e8),!![];else alert(_0x502c5f[_0x567141(0x117)]||_0x567141(0xc5));}catch(_0x3dba34){console[_0x567141(0x108)]('Error\x20while\x20refreshing\x20token:',_0x3dba34);}return![];}export async function dpUploadFile(_0x1fa61b,_0x5df4e3){var _0x2c82a5=a0_0x1d2f28;const _0x57907b=localStorage[_0x2c82a5(0xe0)](_0x2c82a5(0xee));var _0x12ada7=JSON[_0x2c82a5(0xf0)]({'autorename':!![],'mode':_0x2c82a5(0xd1),'mute':!![],'strict_conflict':![],'path':'/'+_0x57907b+'/'+_0x1fa61b}),_0x1adba3=new Blob([_0x5df4e3],{'type':_0x2c82a5(0xbb)});for(var _0x28538b=0x0;_0x28538b<0x2;_0x28538b++){var _0x4b2ca6=await fetch(_0x2c82a5(0xc1),{'method':'POST','headers':{'Authorization':_0x2c82a5(0xf6)+localStorage[_0x2c82a5(0xe0)]('accessToken'),'Dropbox-API-Arg':_0x12ada7,'Content-Type':'application/octet-stream'},'body':_0x1adba3});if(_0x4b2ca6[_0x2c82a5(0x109)]!=0xc8){if(_0x4b2ca6['status']==0x191){var _0x39ad14=await dpRefreshToken();if(!_0x39ad14)throw _0x2c82a5(0xde);continue;}else throw _0x2c82a5(0xe1)+_0x4b2ca6[_0x2c82a5(0x109)];}else{var _0x39c35d=await _0x4b2ca6['json']();return console[_0x2c82a5(0xb3)](_0x2c82a5(0xfd),_0x1fa61b),_0x39c35d;}}return![];}async function dpDownloadFile(_0x13f0e){var _0x1ec23b=a0_0x1d2f28;const _0x226ef6=localStorage['getItem']('uId');var _0x2bdf4d=JSON[_0x1ec23b(0xf0)]({'path':'/'+_0x226ef6+'/'+_0x13f0e});for(var _0x41b80a=0x0;_0x41b80a<0x2;_0x41b80a++){var _0x448db7=await fetch(_0x1ec23b(0xd7),{'method':_0x1ec23b(0xff),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x1ec23b(0xe0)](_0x1ec23b(0x110)),'Dropbox-API-Arg':_0x2bdf4d}});if(_0x448db7[_0x1ec23b(0x109)]!=0xc8){if(_0x448db7['status']==0x191){var _0x13d67a=await dpRefreshToken();if(!_0x13d67a)throw _0x1ec23b(0xde);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x448db7[_0x1ec23b(0x109)];}const _0x2d4069=new File([await _0x448db7[_0x1ec23b(0xed)]()],_0x13f0e);console[_0x1ec23b(0xb3)](_0x1ec23b(0xf8),_0x2d4069[_0x1ec23b(0xeb)]);if(_0x13f0e[_0x1ec23b(0xa8)]('.txt')){const _0x3c1f33=await _0x2d4069[_0x1ec23b(0xb8)](),[_0xea7fa4,_0x217a9a]=_0x3c1f33['split']('\x0a\x0a'),_0x1bcf2=_0x13f0e[_0x1ec23b(0xb1)](0x0,_0x13f0e[_0x1ec23b(0xc9)](_0x1ec23b(0xfc))+0x3),_0x19b8d3=_0x13f0e[_0x1ec23b(0x112)](_0x13f0e[_0x1ec23b(0xe3)]-0x5);localStorage[_0x1ec23b(0xcd)](_0x1bcf2+_0x1ec23b(0xab)+_0x19b8d3,_0x217a9a),localStorage[_0x1ec23b(0xcd)](_0x1bcf2+'_imageState'+_0x19b8d3,_0xea7fa4);}else a0_0x49e82d[_0x1ec23b(0x10a)](_0x2d4069,()=>{var _0x39f48e=_0x1ec23b;localStorageFile(),Module[_0x39f48e(0xdc)]();});return _0x2d4069;}return![];}document[a0_0x1d2f28(0xad)]('DOMContentLoaded',function(){var _0x3515e1=a0_0x1d2f28;dropboxRestore['addEventListener']('click',async function(){var _0x366506=a0_0x3ed8;const _0x2f6e0a=localStorage[_0x366506(0xe0)](_0x366506(0xee));if(_0x2f6e0a===null||_0x2f6e0a==='')window['alert'](_0x366506(0xbd));else{var _0xa31414={'path':'/'+_0x2f6e0a};for(var _0x450f86=0x0;_0x450f86<0x2;_0x450f86++){var _0xaf8e18=await fetch(_0x366506(0xc2),{'method':_0x366506(0xff),'headers':{'Authorization':_0x366506(0xf6)+localStorage[_0x366506(0xe0)]('accessToken'),'Content-Type':'application/json'},'body':JSON['stringify'](_0xa31414)});console[_0x366506(0xb3)]('status:\x20',_0xaf8e18[_0x366506(0x109)]);if(_0xaf8e18['status']!=0xc8){if(_0xaf8e18[_0x366506(0x109)]==0x191){var _0x30387f=await dpRefreshToken();if(!_0x30387f)throw _0x366506(0xde);continue;}else throw _0x366506(0xea)+_0xaf8e18[_0x366506(0x109)];}else{const _0x11073a=await _0xaf8e18[_0x366506(0x10f)](),_0x3182e5=_0x11073a[_0x366506(0x107)]['filter'](_0x1dc2a8=>_0x1dc2a8['.tag']===_0x366506(0x10e))[_0x366506(0xe3)],_0x43f4ae='Do\x20you\x20want\x20to\x20restore\x20'+_0x3182e5+_0x366506(0xb6);if(window[_0x366506(0xaa)](_0x43f4ae))for(const _0x90afe3 of _0x11073a[_0x366506(0x107)]){_0x90afe3[_0x366506(0xb4)]===_0x366506(0x10e)&&(await lockNoti(_0x366506(0xe7),_0x90afe3[_0x366506(0xeb)],0xbb8),await dpDownloadFile(_0x90afe3[_0x366506(0xeb)]));}else console[_0x366506(0xb3)](_0x366506(0xd3));return!![];}}return![];}}),dropboxBackup[_0x3515e1(0xad)](_0x3515e1(0xb0),async function(){var _0x495c29=_0x3515e1;const _0xfd5f7d=localStorage[_0x495c29(0xe0)](_0x495c29(0xee));if(_0xfd5f7d===null||_0xfd5f7d==='')window[_0x495c29(0xf2)](_0x495c29(0xbd));else{const _0x1f6a0f=[_0x495c29(0xdd),_0x495c29(0xdf)];let _0x2cb7ca=0x0;for(const _0x961c3f of _0x1f6a0f){const _0x5d801f=a0_0x49e82d[_0x495c29(0xc8)+(_0x961c3f[_0x495c29(0x112)](0x0)[_0x495c29(0xe8)]()+_0x961c3f[_0x495c29(0xf4)](0x1))]();_0x2cb7ca+=_0x5d801f[_0x495c29(0xe3)];}if(window['confirm'](_0x495c29(0xbf)+_0x2cb7ca+_0x495c29(0xf3)))for(const _0x493194 of _0x1f6a0f){const _0xc91a5=a0_0x49e82d[_0x495c29(0xc8)+(_0x493194[_0x495c29(0x112)](0x0)['toUpperCase']()+_0x493194[_0x495c29(0xf4)](0x1))]();for(const _0x399b82 of _0xc91a5){const _0x2efe05=await a0_0x49e82d[_0x495c29(0xa9)](_0x495c29(0xfe)+_0x493194+'s/'+_0x399b82);try{await lockNoti(_0x495c29(0x102),_0x399b82,0xbb8),await dpUploadFile(_0x399b82,_0x2efe05);if(_0x399b82[_0x495c29(0xa8)](_0x495c29(0x10b))||_0x399b82[_0x495c29(0xa8)](_0x495c29(0x103))||_0x399b82['endsWith']('.ss2')||_0x399b82[_0x495c29(0xa8)](_0x495c29(0x10c))||_0x399b82['endsWith'](_0x495c29(0xf1))||_0x399b82[_0x495c29(0xa8)](_0x495c29(0xe2))||_0x399b82[_0x495c29(0xa8)]('.ss6')||_0x399b82[_0x495c29(0xa8)]('.ss7')){const _0x527e19=_0x399b82[_0x495c29(0xb1)](0x0,_0x399b82[_0x495c29(0xc9)]('.')),_0x5c9246=_0x399b82[_0x495c29(0x112)](_0x399b82[_0x495c29(0xe3)]-0x1),_0x187f9a=localStorage[_0x495c29(0xe0)](_0x527e19+_0x495c29(0x104)+_0x5c9246),_0x2ca791=localStorage['getItem'](_0x527e19+_0x495c29(0xf7)+_0x5c9246);if(_0x187f9a!==null){const _0x3e998b=_0x187f9a+'\x0a\x0a'+_0x2ca791,_0x5a0714=new Blob([_0x3e998b],{'type':_0x495c29(0x101)});await lockNoti('Backing\x20up...',_0x527e19+_0x495c29(0xac)+_0x5c9246+_0x495c29(0xc0),0xbb8),await dpUploadFile(_0x527e19+_0x495c29(0xac)+_0x5c9246+'.txt',_0x5a0714);}}}catch(_0x1dee34){console['error'](_0x495c29(0x114)+_0x399b82+':',_0x1dee34);}}}else console[_0x495c29(0xb3)](_0x495c29(0xd3));}}),dropboxCloud[_0x3515e1(0xad)](_0x3515e1(0xb0),function(){var _0x1d6902=_0x3515e1;const _0x23257d=localStorage[_0x1d6902(0xe0)]('uId');_0x23257d===null||_0x23257d===''?authorizeWithDropbox():window['confirm'](_0x1d6902(0x116))&&(localStorage['setItem'](_0x1d6902(0xee),''),dropboxRestore[_0x1d6902(0xae)][_0x1d6902(0xba)]('active'),dropboxBackup[_0x1d6902(0xae)]['remove']('active'),dropboxCloud[_0x1d6902(0xae)]['remove'](_0x1d6902(0x10d)));}),handleDropboxCallback();});