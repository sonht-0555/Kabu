var a0_0xcb664=a0_0x52a3;(function(_0x3472f8,_0x415123){var _0x3d2a54=a0_0x52a3,_0x516abe=_0x3472f8();while(!![]){try{var _0x5a5c52=parseInt(_0x3d2a54(0x202))/0x1+parseInt(_0x3d2a54(0x1d9))/0x2*(-parseInt(_0x3d2a54(0x216))/0x3)+-parseInt(_0x3d2a54(0x213))/0x4*(-parseInt(_0x3d2a54(0x20c))/0x5)+-parseInt(_0x3d2a54(0x1f1))/0x6+parseInt(_0x3d2a54(0x209))/0x7+-parseInt(_0x3d2a54(0x1e6))/0x8*(-parseInt(_0x3d2a54(0x20e))/0x9)+parseInt(_0x3d2a54(0x217))/0xa;if(_0x5a5c52===_0x415123)break;else _0x516abe['push'](_0x516abe['shift']());}catch(_0x5c6dea){_0x516abe['push'](_0x516abe['shift']());}}}(a0_0x2f3b,0xbcb35));function a0_0x2f3b(){var _0x4e3196=['uploadFileInCloud','remove','code=','https://api.dropboxapi.com/2/files/list_folder','json','offline','accessToken','authorization_code','/data/','Authorization\x20Code:','Download\x20failed\x20for\x20','Bearer\x20','POST','filter','click','Folder\x20already\x20exists','14aSGsve','&client_id=','confirm','Upload\x20failed,\x20unknown\x20http\x20status:\x20','entries','knh3uz2mx2hp2eu','application/json','Do\x20not\x20receive\x20authorization','blob','push','search','.tag','responseText','28200RtBnbh','uid','screenshot','open','stringify','Do\x20you\x20want\x20to\x20logout?','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','[\x5c?&#]','https://www.dropbox.com/oauth2/authorize?client_id=','replace','Wait\x20a\x20little\x20bit...','5082378IxMVqF','alert','location','https://api.dropboxapi.com/2/files/create_folder_v2','\x20files\x20in\x20Kabu?','Failed\x20to\x20refresh\x20Dropbox\x20token.','nwb3dnfh09rhs31','listFiles','application/octet-stream','refresh_token','href','folder','setItem','Do\x20you\x20want\x20to\x20restore\x20','downloadFileInCloud','refreshToken','error','711944etVtAL','map','https://api.dropboxapi.com/oauth2/token','uId','save','access_token','DOMContentLoaded','1129653NkAzZo','application/x-www-form-urlencoded','Restore\x20canceled\x20by\x20user.','2797270JcoEpW','=([^&#]*)','2367iCcDJt','Error\x20creating\x20folder\x20','&redirect_uri=','error_description','name','4KYREsP','send','length','374511SeHqDb','1339870fKFUaN','getItem','log','Failed\x20to\x20upload\x20file\x20','addEventListener','No\x20refresh\x20token','exec','https://api.dropbox.com/oauth2/token','&token_access_type=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','classList','file','refresh_token=','active','state','Unable\x20to\x20refresh\x20token','code','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20you\x20want\x20to\x20backup\x20','status','split','Cloud\x20login\x20required!','\x20files\x20from\x20Cloud?','Error\x20while\x20refreshing\x20token:','&grant_type='];a0_0x2f3b=function(){return _0x4e3196;};return a0_0x2f3b();}import*as a0_0x1dd661 from'./main.js';function a0_0x52a3(_0x276930,_0x413c2b){var _0x2f3b84=a0_0x2f3b();return a0_0x52a3=function(_0x52a36f,_0x56a111){_0x52a36f=_0x52a36f-0x1b6;var _0xff15bb=_0x2f3b84[_0x52a36f];return _0xff15bb;},a0_0x52a3(_0x276930,_0x413c2b);}import{localStorageFile}from'./storage.js';var clientId=a0_0xcb664(0x1de),clientSecret=a0_0xcb664(0x1f7);function authorizeWithDropbox(){var _0x2f0957=a0_0xcb664,_0x3ca161=window[_0x2f0957(0x1f3)][_0x2f0957(0x1fb)][_0x2f0957(0x1c4)]('?')[0x0],_0x184f5f=_0x2f0957(0x1c0),_0x4bb83a=_0x2f0957(0x1ce),_0x2141cf=_0x2f0957(0x1ee)+clientId+'&response_type='+_0x184f5f+_0x2f0957(0x1b8)+_0x4bb83a+_0x2f0957(0x210)+encodeURIComponent(_0x3ca161);window['location'][_0x2f0957(0x1fb)]=_0x2141cf;}function handleDropboxCallback(){var _0x4bd3da=a0_0xcb664,_0x49af4e=getUrlParameter('code');_0x49af4e?(getAccessToken(_0x49af4e),console[_0x4bd3da(0x219)](_0x4bd3da(0x1d2),_0x49af4e)):console[_0x4bd3da(0x219)](_0x4bd3da(0x1e0));}function getUrlParameter(_0x572337){var _0x9a0223=a0_0xcb664;_0x572337=_0x572337[_0x9a0223(0x1ef)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x20197e=new RegExp(_0x9a0223(0x1ed)+_0x572337+_0x9a0223(0x20d)),_0x53aea8=_0x20197e[_0x9a0223(0x1b6)](location[_0x9a0223(0x1e3)]);return _0x53aea8===null?'':decodeURIComponent(_0x53aea8[0x1][_0x9a0223(0x1ef)](/\+/g,'\x20'));}function getAccessToken(_0x50a998){var _0x2a9ba1=a0_0xcb664,_0x379889=_0x2a9ba1(0x1d0),_0x293da2=window[_0x2a9ba1(0x1f3)][_0x2a9ba1(0x1fb)][_0x2a9ba1(0x1c4)]('?')[0x0],_0x460b21=new XMLHttpRequest();_0x460b21[_0x2a9ba1(0x1e9)](_0x2a9ba1(0x1d5),_0x2a9ba1(0x1b7)),_0x460b21['setRequestHeader']('Content-Type',_0x2a9ba1(0x20a)),_0x460b21['onload']=function(){var _0x3886f0=_0x2a9ba1;if(_0x460b21[_0x3886f0(0x1c3)]===0xc8){var _0x3f307b=JSON['parse'](_0x460b21[_0x3886f0(0x1e5)]),_0x1d7e09=_0x3f307b[_0x3886f0(0x207)],_0x3943fd=_0x3f307b[_0x3886f0(0x1fa)],_0x545b46=_0x3f307b[_0x3886f0(0x1e7)];localStorage[_0x3886f0(0x1fd)](_0x3886f0(0x1cf),_0x1d7e09),localStorage[_0x3886f0(0x1fd)](_0x3886f0(0x200),_0x3943fd),localStorage[_0x3886f0(0x1fd)](_0x3886f0(0x205),_0x545b46);}else console[_0x3886f0(0x219)](_0x3886f0(0x1ec));},_0x460b21[_0x2a9ba1(0x214)](_0x2a9ba1(0x1cb)+_0x50a998+_0x2a9ba1(0x1c8)+_0x379889+_0x2a9ba1(0x1da)+clientId+'&client_secret='+clientSecret+_0x2a9ba1(0x210)+encodeURIComponent(_0x293da2));}export async function dpCreateFolder(_0x37308c){var _0x492e47=a0_0xcb664;const _0x2e7ed1=localStorage[_0x492e47(0x218)](_0x492e47(0x205));let _0x5521e6=localStorage[_0x492e47(0x218)]('accessToken');const _0x40f43a='/'+_0x2e7ed1+'/'+_0x37308c,_0x516130=JSON['stringify']({'path':_0x40f43a,'autorename':![]});for(let _0x5566a9=0x0;_0x5566a9<0x2;_0x5566a9++){try{const _0xbc1839=await fetch(_0x492e47(0x1f4),{'method':_0x492e47(0x1d5),'headers':{'Authorization':'Bearer\x20'+_0x5521e6,'Content-Type':'application/json'},'body':_0x516130});if(_0xbc1839[_0x492e47(0x1c3)]===0x191){const _0x3ec76e=await dpRefreshToken();if(!_0x3ec76e)throw new Error(_0x492e47(0x1bf));_0x5521e6=localStorage[_0x492e47(0x218)](_0x492e47(0x1cf));continue;}if(_0xbc1839[_0x492e47(0x1c3)]===0x199)return{'message':_0x492e47(0x1d8),'path':_0x37308c};if(!_0xbc1839['ok'])throw new Error(_0x492e47(0x20f)+_0x37308c);const _0x105a27=await _0xbc1839['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x105a27;}catch(_0x45a4c6){if(_0x5566a9===0x1)throw _0x45a4c6;}}return![];}export async function dpRefreshToken(){var _0x2c50f8=a0_0xcb664;if(!localStorage[_0x2c50f8(0x218)](_0x2c50f8(0x200)))throw _0x2c50f8(0x21c);try{const _0x50b66c=await fetch(_0x2c50f8(0x204),{'method':_0x2c50f8(0x1d5),'headers':{'Content-Type':_0x2c50f8(0x20a)},'body':_0x2c50f8(0x1bc)+localStorage['getItem'](_0x2c50f8(0x200))+_0x2c50f8(0x1b9)}),_0x324972=await _0x50b66c['json']();if(!_0x324972[_0x2c50f8(0x201)])return localStorage[_0x2c50f8(0x1fd)]('accessToken',_0x324972['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x324972[_0x2c50f8(0x211)]||_0x2c50f8(0x1f6));}catch(_0x397898){console[_0x2c50f8(0x201)](_0x2c50f8(0x1c7),_0x397898);}return![];}export async function dpUploadFile(_0x3ab1e6,_0x24aa7a,_0x17acbd){var _0x3744bf=a0_0xcb664;const _0x492352=localStorage[_0x3744bf(0x218)](_0x3744bf(0x205));var _0x9cb0af=JSON[_0x3744bf(0x1ea)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x492352+'/'+_0x17acbd+'/'+_0x3ab1e6}),_0x2822c3=new Blob([_0x24aa7a],{'type':_0x3744bf(0x1f9)});for(var _0x4c1fa1=0x0;_0x4c1fa1<0x2;_0x4c1fa1++){var _0x333caf=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x3744bf(0x1d5),'headers':{'Authorization':_0x3744bf(0x1d4)+localStorage[_0x3744bf(0x218)]('accessToken'),'Dropbox-API-Arg':_0x9cb0af,'Content-Type':'application/octet-stream'},'body':_0x2822c3});if(_0x333caf[_0x3744bf(0x1c3)]!=0xc8){if(_0x333caf[_0x3744bf(0x1c3)]==0x191){var _0x2407d3=await dpRefreshToken();if(!_0x2407d3)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x3744bf(0x1dc)+_0x333caf['status'];}else{var _0x253f61=await _0x333caf[_0x3744bf(0x1cd)]();return console[_0x3744bf(0x219)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x3ab1e6),_0x253f61;}}return![];}export async function dpDownloadFile(_0x2fa78b,_0xcffd73){var _0x454572=a0_0xcb664;const _0x45c2d0=localStorage['getItem'](_0x454572(0x205));var _0x4e3f87=JSON[_0x454572(0x1ea)]({'path':'/'+_0x45c2d0+'/'+_0xcffd73+'/'+_0x2fa78b});for(var _0x4d2e68=0x0;_0x4d2e68<0x2;_0x4d2e68++){var _0x4978cc=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x454572(0x1d5),'headers':{'Authorization':_0x454572(0x1d4)+localStorage[_0x454572(0x218)](_0x454572(0x1cf)),'Dropbox-API-Arg':_0x4e3f87}});if(_0x4978cc[_0x454572(0x1c3)]!=0xc8){if(_0x4978cc[_0x454572(0x1c3)]==0x191){var _0x3e2964=await dpRefreshToken();if(!_0x3e2964)throw _0x454572(0x1bf);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x4978cc[_0x454572(0x1c3)];}const _0x5938e4=new File([await _0x4978cc[_0x454572(0x1e1)]()],_0x2fa78b);return console[_0x454572(0x219)](_0x454572(0x1c1),_0x5938e4[_0x454572(0x212)]),a0_0x1dd661[_0x454572(0x1c9)](_0x5938e4,()=>{}),_0x5938e4;}return![];}document['addEventListener'](a0_0xcb664(0x208),function(){var _0x139791=a0_0xcb664;dropboxRestore[_0x139791(0x21b)]('click',async function(){var _0x245113=_0x139791;await lockNoti(_0x245113(0x1f0),'',0x1388);const _0xee03df=localStorage[_0x245113(0x218)](_0x245113(0x205)),_0x308bda=[_0x245113(0x1be),_0x245113(0x206),'screenshot'];if(!_0xee03df){window[_0x245113(0x1f2)]('Cloud\x20login\x20required!');return;}let _0x19c752=[];for(const _0x19e70a of _0x308bda){let _0x4be562={'path':'/'+_0xee03df+'/'+_0x19e70a};for(let _0x340739=0x0;_0x340739<0x2;_0x340739++){let _0x150fd1=await fetch(_0x245113(0x1cc),{'method':_0x245113(0x1d5),'headers':{'Authorization':_0x245113(0x1d4)+localStorage[_0x245113(0x218)](_0x245113(0x1cf)),'Content-Type':_0x245113(0x1df)},'body':JSON[_0x245113(0x1ea)](_0x4be562)});if(_0x150fd1[_0x245113(0x1c3)]===0xc8){let _0x252e5e=await _0x150fd1[_0x245113(0x1cd)](),_0x315589=_0x252e5e[_0x245113(0x1dd)][_0x245113(0x1d6)](_0x10266f=>_0x10266f[_0x245113(0x1e4)]===_0x245113(0x1bb));_0x315589[_0x245113(0x215)]>0x0&&_0x19c752[_0x245113(0x1e2)](..._0x315589[_0x245113(0x203)](_0x48537b=>({'name':_0x48537b['name'],'folder':_0x19e70a})));break;}else{if(_0x150fd1[_0x245113(0x1c3)]===0x191){let _0x465061=await dpRefreshToken();if(!_0x465061)throw _0x245113(0x1bf);}else{console[_0x245113(0x201)](_0x245113(0x1d3)+_0x19e70a+',\x20status:\x20'+_0x150fd1[_0x245113(0x1c3)]);break;}}}}if(_0x19c752[_0x245113(0x215)]>0x0){const _0x5490b=_0x245113(0x1fe)+_0x19c752[_0x245113(0x215)]+_0x245113(0x1c6);if(window[_0x245113(0x1db)](_0x5490b))for(const _0x4639eb of _0x19c752){await lockNoti('Restoring...',_0x4639eb[_0x245113(0x212)],0xbb8),await dpDownloadFile(_0x4639eb[_0x245113(0x212)],_0x4639eb[_0x245113(0x1fc)]);}else console[_0x245113(0x219)](_0x245113(0x20b));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x139791(0x1d7),async function(){var _0x39abd8=_0x139791;await lockNoti(_0x39abd8(0x1f0),'',0x1388);const _0x24fa75=localStorage['getItem'](_0x39abd8(0x205));if(_0x24fa75===null||_0x24fa75==='')window[_0x39abd8(0x1f2)](_0x39abd8(0x1c5));else{const _0x2f55cb=[_0x39abd8(0x1be),_0x39abd8(0x206),_0x39abd8(0x1e8)];for(const _0x2208b6 of _0x2f55cb){await dpCreateFolder(_0x2208b6);}let _0xf5de13=0x0;for(const _0x163821 of _0x2f55cb){const _0x5a7b7c=a0_0x1dd661[_0x39abd8(0x1f8)](_0x163821+'s');_0xf5de13+=_0x5a7b7c[_0x39abd8(0x215)];}if(window[_0x39abd8(0x1db)](_0x39abd8(0x1c2)+_0xf5de13+_0x39abd8(0x1f5)))for(const _0x3ba60e of _0x2f55cb){const _0x248868=a0_0x1dd661[_0x39abd8(0x1f8)](_0x3ba60e+'s');for(const _0x20e39c of _0x248868){const _0x188437=await a0_0x1dd661[_0x39abd8(0x1ff)](_0x39abd8(0x1d1)+_0x3ba60e+'s/'+_0x20e39c);try{await lockNoti('Backing\x20up...',_0x20e39c,0xbb8),await dpUploadFile(_0x20e39c,_0x188437,_0x3ba60e);}catch(_0x54bddd){console['error'](_0x39abd8(0x21a)+_0x20e39c+':',_0x54bddd);}}}else console[_0x39abd8(0x219)](_0x39abd8(0x20b));}}),dropboxCloud[_0x139791(0x21b)](_0x139791(0x1d7),function(){var _0x1de8c1=_0x139791;const _0x3380aa=localStorage[_0x1de8c1(0x218)]('uId');_0x3380aa===null||_0x3380aa===''?authorizeWithDropbox():window[_0x1de8c1(0x1db)](_0x1de8c1(0x1eb))&&(localStorage[_0x1de8c1(0x1fd)](_0x1de8c1(0x205),''),dropboxRestore[_0x1de8c1(0x1ba)][_0x1de8c1(0x1ca)](_0x1de8c1(0x1bd)),dropboxBackup['classList'][_0x1de8c1(0x1ca)]('active'),dropboxCloud[_0x1de8c1(0x1ba)][_0x1de8c1(0x1ca)](_0x1de8c1(0x1bd)));}),handleDropboxCallback();});