var a0_0xe82c10=a0_0x1d6b;(function(_0x3580e9,_0x233b66){var _0xe591ed=a0_0x1d6b,_0x321068=_0x3580e9();while(!![]){try{var _0x3813c4=parseInt(_0xe591ed(0x1f2))/0x1*(parseInt(_0xe591ed(0x22f))/0x2)+-parseInt(_0xe591ed(0x23e))/0x3+parseInt(_0xe591ed(0x227))/0x4*(-parseInt(_0xe591ed(0x200))/0x5)+-parseInt(_0xe591ed(0x203))/0x6+-parseInt(_0xe591ed(0x221))/0x7*(parseInt(_0xe591ed(0x21d))/0x8)+-parseInt(_0xe591ed(0x23c))/0x9*(-parseInt(_0xe591ed(0x21c))/0xa)+-parseInt(_0xe591ed(0x23b))/0xb*(-parseInt(_0xe591ed(0x246))/0xc);if(_0x3813c4===_0x233b66)break;else _0x321068['push'](_0x321068['shift']());}catch(_0x121b7c){_0x321068['push'](_0x321068['shift']());}}}(a0_0x5e74,0xab8ee));import*as a0_0x504f04 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1d6b(_0x40cf9c,_0x5730d8){var _0x5e7430=a0_0x5e74();return a0_0x1d6b=function(_0x1d6b61,_0x12f7be){_0x1d6b61=_0x1d6b61-0x1ed;var _0x108cb3=_0x5e7430[_0x1d6b61];return _0x108cb3;},a0_0x1d6b(_0x40cf9c,_0x5730d8);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0xe82c10(0x1fe);function authorizeWithDropbox(){var _0x1d4aec=a0_0xe82c10,_0x1a43db=window[_0x1d4aec(0x21b)][_0x1d4aec(0x20d)][_0x1d4aec(0x22e)]('?')[0x0],_0x4aba79=_0x1d4aec(0x24c),_0x56bb2e=_0x1d4aec(0x233),_0xf36dfc=_0x1d4aec(0x239)+clientId+_0x1d4aec(0x209)+_0x4aba79+_0x1d4aec(0x1f1)+_0x56bb2e+'&redirect_uri='+encodeURIComponent(_0x1a43db);window[_0x1d4aec(0x21b)]['href']=_0xf36dfc;}function handleDropboxCallback(){var _0x273590=a0_0xe82c10,_0x2dc28e=getUrlParameter(_0x273590(0x24c));_0x2dc28e?(getAccessToken(_0x2dc28e),console[_0x273590(0x223)](_0x273590(0x219),_0x2dc28e)):console[_0x273590(0x223)](_0x273590(0x230));}function getUrlParameter(_0x160d01){var _0x1040f8=a0_0xe82c10;_0x160d01=_0x160d01[_0x1040f8(0x22c)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x586c70=new RegExp(_0x1040f8(0x222)+_0x160d01+_0x1040f8(0x226)),_0x3b653b=_0x586c70[_0x1040f8(0x224)](location[_0x1040f8(0x220)]);return _0x3b653b===null?'':decodeURIComponent(_0x3b653b[0x1]['replace'](/\+/g,'\x20'));}function a0_0x5e74(){var _0x2b7474=['uId','stringify','map','save','Bearer\x20','access_token','send','nwb3dnfh09rhs31','state','1043470LxFqJy','uid','application/json','5852010teUXFY','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20backup\x20','Do\x20you\x20want\x20to\x20logout?','Download\x20failed,\x20unknown\x20http\x20status:','listFiles','&response_type=','https://api.dropbox.com/oauth2/token','status','Error\x20while\x20refreshing\x20token:','href','POST','Failed\x20to\x20refresh\x20Dropbox\x20token.','Unable\x20to\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','blob','Folder\x20created','error','https://api.dropboxapi.com/2/files/create_folder_v2','Content-Type','No\x20files\x20found\x20to\x20restore.','Cloud\x20↦\x20Kabu\x20storage\x20◆','Authorization\x20Code:','Restore\x20canceled\x20by\x20user.','location','10AkNUNH','408FjruTv','https://content.dropboxapi.com/2/files/upload','.tag','search','90083OVSUgx','[\x5c?&#]','log','exec','setItem','=([^&#]*)','4tzONfM','name','classList','filter','refresh_token=','replace','accessToken','split','5656DjzhKU','Do\x20not\x20receive\x20authorization','Refreshing\x20token...','length','offline','&client_secret=','application/octet-stream','overwrite','active','file','https://www.dropbox.com/oauth2/authorize?client_id=','setRequestHeader','99RCmndb','5160069vdhpkR','&redirect_uri=','4167336juOBCt','\x20files\x20in\x20Kabu?','&grant_type=','refreshToken','addEventListener','json','Failed\x20to\x20upload\x20file\x20','uploadFileInCloud','4320060voBsEF','https://content.dropboxapi.com/2/files/download','authorization_code','\x20files\x20from\x20Cloud?','remove','No\x20refresh\x20token','code',',\x20status:\x20','Wait\x20a\x20little\x20bit...','confirm','click','Kabu\x20storage\x20↦\x20Cloud\x20◆','alert','Download\x20failed\x20for\x20','parse','&token_access_type=','42OZemcL','entries','getItem','Do\x20you\x20want\x20to\x20restore\x20','Restoring...'];a0_0x5e74=function(){return _0x2b7474;};return a0_0x5e74();}function getAccessToken(_0x53210b){var _0xf74670=a0_0xe82c10,_0xf556d0=_0xf74670(0x248),_0x128c9b=window[_0xf74670(0x21b)][_0xf74670(0x20d)][_0xf74670(0x22e)]('?')[0x0],_0x1af69a=new XMLHttpRequest();_0x1af69a['open'](_0xf74670(0x20e),_0xf74670(0x20a)),_0x1af69a[_0xf74670(0x23a)](_0xf74670(0x216),_0xf74670(0x204)),_0x1af69a['onload']=function(){var _0xfdfd8a=_0xf74670;if(_0x1af69a[_0xfdfd8a(0x20b)]===0xc8){var _0x38602b=JSON[_0xfdfd8a(0x1f0)](_0x1af69a['responseText']),_0x14daaa=_0x38602b[_0xfdfd8a(0x1fc)],_0x593c74=_0x38602b['refresh_token'],_0x20964f=_0x38602b[_0xfdfd8a(0x201)];localStorage[_0xfdfd8a(0x225)](_0xfdfd8a(0x22d),_0x14daaa),localStorage['setItem'](_0xfdfd8a(0x241),_0x593c74),localStorage[_0xfdfd8a(0x225)](_0xfdfd8a(0x1f7),_0x20964f);}else console[_0xfdfd8a(0x223)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x1af69a[_0xf74670(0x1fd)]('code='+_0x53210b+_0xf74670(0x240)+_0xf556d0+'&client_id='+clientId+_0xf74670(0x234)+clientSecret+_0xf74670(0x23d)+encodeURIComponent(_0x128c9b));}export async function dpCreateFolder(_0xef6024){var _0x3c95af=a0_0xe82c10;const _0x2139ec=localStorage[_0x3c95af(0x1f4)](_0x3c95af(0x1f7));let _0x1d0a03=localStorage[_0x3c95af(0x1f4)](_0x3c95af(0x22d));const _0x51fb1b='/'+_0x2139ec+'/'+_0xef6024,_0x4f1ee9=JSON[_0x3c95af(0x1f8)]({'path':_0x51fb1b,'autorename':![]});for(let _0x22e1be=0x0;_0x22e1be<0x2;_0x22e1be++){try{const _0x46ee18=await fetch(_0x3c95af(0x215),{'method':_0x3c95af(0x20e),'headers':{'Authorization':_0x3c95af(0x1fb)+_0x1d0a03,'Content-Type':_0x3c95af(0x202)},'body':_0x4f1ee9});if(_0x46ee18[_0x3c95af(0x20b)]===0x191){const _0x3699e8=await dpRefreshToken();if(!_0x3699e8)throw new Error('Unable\x20to\x20refresh\x20token');_0x1d0a03=localStorage['getItem'](_0x3c95af(0x22d));continue;}if(_0x46ee18[_0x3c95af(0x20b)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0xef6024};if(!_0x46ee18['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0xef6024);const _0x5fcf72=await _0x46ee18[_0x3c95af(0x243)]();return await lockNoti(_0x3c95af(0x213),'',0xbb8),_0x5fcf72;}catch(_0xb5e253){if(_0x22e1be===0x1)throw _0xb5e253;}}return![];}export async function dpRefreshToken(){var _0x2a2e01=a0_0xe82c10;if(!localStorage[_0x2a2e01(0x1f4)](_0x2a2e01(0x241)))throw _0x2a2e01(0x24b);try{const _0x18066f=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x2a2e01(0x204)},'body':_0x2a2e01(0x22b)+localStorage[_0x2a2e01(0x1f4)](_0x2a2e01(0x241))+_0x2a2e01(0x211)}),_0x29e229=await _0x18066f[_0x2a2e01(0x243)]();if(!_0x29e229[_0x2a2e01(0x214)])return localStorage[_0x2a2e01(0x225)](_0x2a2e01(0x22d),_0x29e229[_0x2a2e01(0x1fc)]),await lockNoti(_0x2a2e01(0x231),'',0xbb8),await delay(0x3e8),!![];else alert(_0x29e229['error_description']||_0x2a2e01(0x20f));}catch(_0x3b264b){console[_0x2a2e01(0x214)](_0x2a2e01(0x20c),_0x3b264b);}return![];}export async function dpUploadFile(_0x3e7c5c,_0x2c8fa8,_0x1f930a){var _0x40c68a=a0_0xe82c10;const _0x526f57=localStorage[_0x40c68a(0x1f4)](_0x40c68a(0x1f7));var _0x388832=JSON[_0x40c68a(0x1f8)]({'autorename':!![],'mode':_0x40c68a(0x236),'mute':!![],'strict_conflict':![],'path':'/'+_0x526f57+'/'+_0x1f930a+'/'+_0x3e7c5c}),_0x276dfb=new Blob([_0x2c8fa8],{'type':_0x40c68a(0x235)});for(var _0x53251f=0x0;_0x53251f<0x2;_0x53251f++){var _0x35626c=await fetch(_0x40c68a(0x21e),{'method':_0x40c68a(0x20e),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x40c68a(0x1f4)](_0x40c68a(0x22d)),'Dropbox-API-Arg':_0x388832,'Content-Type':_0x40c68a(0x235)},'body':_0x276dfb});if(_0x35626c[_0x40c68a(0x20b)]!=0xc8){if(_0x35626c[_0x40c68a(0x20b)]==0x191){var _0xd534a3=await dpRefreshToken();if(!_0xd534a3)throw _0x40c68a(0x210);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x35626c[_0x40c68a(0x20b)];}else{var _0x347ede=await _0x35626c[_0x40c68a(0x243)]();return console[_0x40c68a(0x223)](_0x40c68a(0x1ed),_0x3e7c5c),_0x347ede;}}return![];}export async function dpDownloadFile(_0x1c9604,_0x5c3fdd){var _0x18d054=a0_0xe82c10;const _0x50745d=localStorage['getItem'](_0x18d054(0x1f7));var _0x2cf542=JSON[_0x18d054(0x1f8)]({'path':'/'+_0x50745d+'/'+_0x5c3fdd+'/'+_0x1c9604});for(var _0x55da0c=0x0;_0x55da0c<0x2;_0x55da0c++){var _0x579fbf=await fetch(_0x18d054(0x247),{'method':_0x18d054(0x20e),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x18d054(0x22d)),'Dropbox-API-Arg':_0x2cf542}});if(_0x579fbf[_0x18d054(0x20b)]!=0xc8){if(_0x579fbf[_0x18d054(0x20b)]==0x191){var _0x374e22=await dpRefreshToken();if(!_0x374e22)throw _0x18d054(0x210);continue;}else throw _0x18d054(0x207)+_0x579fbf[_0x18d054(0x20b)];}const _0xbf406d=new File([await _0x579fbf[_0x18d054(0x212)]()],_0x1c9604);return console['log'](_0x18d054(0x218),_0xbf406d[_0x18d054(0x228)]),a0_0x504f04[_0x18d054(0x245)](_0xbf406d,()=>{}),_0xbf406d;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x362740=a0_0xe82c10;dropboxRestore[_0x362740(0x242)](_0x362740(0x250),async function(){var _0x2e3932=_0x362740;await lockNoti(_0x2e3932(0x24e),'',0x1388);const _0x4261e3=localStorage[_0x2e3932(0x1f4)]('uId'),_0x59f23a=[_0x2e3932(0x1ff),_0x2e3932(0x1fa),'screenshot'];if(!_0x4261e3){window[_0x2e3932(0x1ee)]('Cloud\x20login\x20required!');return;}let _0x246329=[];for(const _0x2252a6 of _0x59f23a){let _0x628e16={'path':'/'+_0x4261e3+'/'+_0x2252a6};for(let _0x982657=0x0;_0x982657<0x2;_0x982657++){let _0x5818f1=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x2e3932(0x20e),'headers':{'Authorization':_0x2e3932(0x1fb)+localStorage[_0x2e3932(0x1f4)](_0x2e3932(0x22d)),'Content-Type':_0x2e3932(0x202)},'body':JSON[_0x2e3932(0x1f8)](_0x628e16)});if(_0x5818f1[_0x2e3932(0x20b)]===0xc8){let _0x5af53d=await _0x5818f1[_0x2e3932(0x243)](),_0x584278=_0x5af53d[_0x2e3932(0x1f3)][_0x2e3932(0x22a)](_0x5bee6f=>_0x5bee6f[_0x2e3932(0x21f)]===_0x2e3932(0x238));_0x584278[_0x2e3932(0x232)]>0x0&&_0x246329['push'](..._0x584278[_0x2e3932(0x1f9)](_0x4dd0df=>({'name':_0x4dd0df[_0x2e3932(0x228)],'folder':_0x2252a6})));break;}else{if(_0x5818f1[_0x2e3932(0x20b)]===0x191){let _0x2d0650=await dpRefreshToken();if(!_0x2d0650)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x2e3932(0x214)](_0x2e3932(0x1ef)+_0x2252a6+_0x2e3932(0x24d)+_0x5818f1['status']);break;}}}}if(_0x246329[_0x2e3932(0x232)]>0x0){const _0x1e723a=_0x2e3932(0x1f5)+_0x246329[_0x2e3932(0x232)]+_0x2e3932(0x249);if(window[_0x2e3932(0x24f)](_0x1e723a))for(const _0x35a72f of _0x246329){await lockNoti(_0x2e3932(0x1f6),_0x35a72f['name'],0xbb8),await dpDownloadFile(_0x35a72f['name'],_0x35a72f['folder']);}else console[_0x2e3932(0x223)]('Restore\x20canceled\x20by\x20user.');}else console[_0x2e3932(0x223)](_0x2e3932(0x217));}),dropboxBackup[_0x362740(0x242)](_0x362740(0x250),async function(){var _0x59ef26=_0x362740;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0xc79b83=localStorage['getItem'](_0x59ef26(0x1f7));if(_0xc79b83===null||_0xc79b83==='')window[_0x59ef26(0x1ee)]('Cloud\x20login\x20required!');else{const _0x21f19e=[_0x59ef26(0x1ff),_0x59ef26(0x1fa),'screenshot'];for(const _0x127d84 of _0x21f19e){await dpCreateFolder(_0x127d84);}let _0x32d891=0x0;for(const _0x52ff69 of _0x21f19e){const _0xe2ced0=a0_0x504f04['listFiles'](_0x52ff69+'s');_0x32d891+=_0xe2ced0[_0x59ef26(0x232)];}if(window[_0x59ef26(0x24f)](_0x59ef26(0x205)+_0x32d891+_0x59ef26(0x23f)))for(const _0x38c03d of _0x21f19e){const _0x4abf91=a0_0x504f04[_0x59ef26(0x208)](_0x38c03d+'s');for(const _0x365778 of _0x4abf91){const _0x26893d=await a0_0x504f04['downloadFileInCloud']('/data/'+_0x38c03d+'s/'+_0x365778);try{await lockNoti('Backing\x20up...',_0x365778,0xbb8),await dpUploadFile(_0x365778,_0x26893d,_0x38c03d);}catch(_0x43aa5e){console[_0x59ef26(0x214)](_0x59ef26(0x244)+_0x365778+':',_0x43aa5e);}}}else console[_0x59ef26(0x223)](_0x59ef26(0x21a));}}),dropboxCloud[_0x362740(0x242)](_0x362740(0x250),function(){var _0x3a371c=_0x362740;const _0x10e914=localStorage[_0x3a371c(0x1f4)](_0x3a371c(0x1f7));_0x10e914===null||_0x10e914===''?authorizeWithDropbox():window[_0x3a371c(0x24f)](_0x3a371c(0x206))&&(localStorage['setItem'](_0x3a371c(0x1f7),''),dropboxRestore['classList'][_0x3a371c(0x24a)](_0x3a371c(0x237)),dropboxBackup[_0x3a371c(0x229)][_0x3a371c(0x24a)](_0x3a371c(0x237)),dropboxCloud[_0x3a371c(0x229)]['remove'](_0x3a371c(0x237)));}),handleDropboxCallback();});