var a0_0x22aeb2=a0_0x9650;(function(_0x56e75a,_0x4e9a58){var _0x69c1ab=a0_0x9650,_0x37a6a4=_0x56e75a();while(!![]){try{var _0x4ec9a0=-parseInt(_0x69c1ab(0x246))/0x1+parseInt(_0x69c1ab(0x225))/0x2+parseInt(_0x69c1ab(0x24f))/0x3+-parseInt(_0x69c1ab(0x203))/0x4+parseInt(_0x69c1ab(0x1fa))/0x5+parseInt(_0x69c1ab(0x206))/0x6*(-parseInt(_0x69c1ab(0x1f1))/0x7)+parseInt(_0x69c1ab(0x208))/0x8*(parseInt(_0x69c1ab(0x211))/0x9);if(_0x4ec9a0===_0x4e9a58)break;else _0x37a6a4['push'](_0x37a6a4['shift']());}catch(_0x54ae14){_0x37a6a4['push'](_0x37a6a4['shift']());}}}(a0_0x44c2,0x9293f));import*as a0_0x881201 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x22aeb2(0x1f4),clientSecret=a0_0x22aeb2(0x228);function authorizeWithDropbox(){var _0x3b13f3=a0_0x22aeb2,_0x53c188=window['location'][_0x3b13f3(0x1f2)][_0x3b13f3(0x1ea)]('?')[0x0],_0x3cc5e8=_0x3b13f3(0x223),_0x2cbd3f=_0x3b13f3(0x1ef),_0x5d93c5=_0x3b13f3(0x200)+clientId+_0x3b13f3(0x242)+_0x3cc5e8+_0x3b13f3(0x202)+_0x2cbd3f+_0x3b13f3(0x234)+encodeURIComponent(_0x53c188);window[_0x3b13f3(0x1ec)][_0x3b13f3(0x1f2)]=_0x5d93c5;}function handleDropboxCallback(){var _0x47f182=a0_0x22aeb2,_0x3c7cf1=getUrlParameter(_0x47f182(0x223));_0x3c7cf1?(getAccessToken(_0x3c7cf1),console[_0x47f182(0x24a)](_0x47f182(0x201),_0x3c7cf1)):console['log'](_0x47f182(0x249));}function getUrlParameter(_0x480d72){var _0x407229=a0_0x22aeb2;_0x480d72=_0x480d72[_0x407229(0x24e)](/[\[]/,'\x5c[')[_0x407229(0x24e)](/[\]]/,'\x5c]');var _0x490d47=new RegExp(_0x407229(0x21e)+_0x480d72+_0x407229(0x251)),_0x22c751=_0x490d47[_0x407229(0x233)](location[_0x407229(0x253)]);return _0x22c751===null?'':decodeURIComponent(_0x22c751[0x1][_0x407229(0x24e)](/\+/g,'\x20'));}function getAccessToken(_0x16d9e9){var _0xb4ebfa=a0_0x22aeb2,_0x47f342='authorization_code',_0x2c6748=window[_0xb4ebfa(0x1ec)][_0xb4ebfa(0x1f2)][_0xb4ebfa(0x1ea)]('?')[0x0],_0x33ddc0=new XMLHttpRequest();_0x33ddc0[_0xb4ebfa(0x23b)](_0xb4ebfa(0x226),_0xb4ebfa(0x1fd)),_0x33ddc0['setRequestHeader'](_0xb4ebfa(0x243),_0xb4ebfa(0x23f)),_0x33ddc0[_0xb4ebfa(0x23c)]=function(){var _0x1ad937=_0xb4ebfa;if(_0x33ddc0[_0x1ad937(0x22f)]===0xc8){var _0xeb6573=JSON[_0x1ad937(0x1f6)](_0x33ddc0[_0x1ad937(0x21d)]),_0x140082=_0xeb6573['access_token'],_0x416fb8=_0xeb6573[_0x1ad937(0x22b)],_0x3d1557=_0xeb6573[_0x1ad937(0x217)];localStorage[_0x1ad937(0x230)](_0x1ad937(0x1eb),_0x140082),localStorage[_0x1ad937(0x230)](_0x1ad937(0x239),_0x416fb8),localStorage['setItem'](_0x1ad937(0x227),_0x3d1557);}else console['log'](_0x1ad937(0x250));},_0x33ddc0['send'](_0xb4ebfa(0x1f3)+_0x16d9e9+_0xb4ebfa(0x1e9)+_0x47f342+_0xb4ebfa(0x236)+clientId+_0xb4ebfa(0x24b)+clientSecret+_0xb4ebfa(0x234)+encodeURIComponent(_0x2c6748));}export async function dpCreateFolder(_0x8ad235){var _0x2ad1c5=a0_0x22aeb2;const _0x51be76=localStorage['getItem'](_0x2ad1c5(0x227));let _0x5bfe6a=localStorage[_0x2ad1c5(0x220)](_0x2ad1c5(0x1eb));const _0x41c1b5='/'+_0x51be76+'/'+_0x8ad235,_0x4706d4=JSON[_0x2ad1c5(0x1ed)]({'path':_0x41c1b5,'autorename':![]});for(let _0x18c1f3=0x0;_0x18c1f3<0x2;_0x18c1f3++){try{const _0x1ad996=await fetch(_0x2ad1c5(0x241),{'method':_0x2ad1c5(0x226),'headers':{'Authorization':_0x2ad1c5(0x20e)+_0x5bfe6a,'Content-Type':_0x2ad1c5(0x22e)},'body':_0x4706d4});if(_0x1ad996[_0x2ad1c5(0x22f)]===0x191){const _0x3f6d6d=await dpRefreshToken();if(!_0x3f6d6d)throw new Error('Unable\x20to\x20refresh\x20token');_0x5bfe6a=localStorage[_0x2ad1c5(0x220)]('accessToken');continue;}if(_0x1ad996[_0x2ad1c5(0x22f)]===0x199)return{'message':_0x2ad1c5(0x213),'path':_0x8ad235};if(!_0x1ad996['ok'])throw new Error(_0x2ad1c5(0x1f0)+_0x8ad235);const _0x5d92ea=await _0x1ad996['json']();return await lockNoti(_0x2ad1c5(0x1ff),'',0xbb8),_0x5d92ea;}catch(_0x439f0e){if(_0x18c1f3===0x1)throw _0x439f0e;}}return![];}function a0_0x44c2(){var _0x1abf57=['alert','Refreshing\x20token...','https://api.dropbox.com/oauth2/token',',\x20status:\x20','Folder\x20created','https://www.dropbox.com/oauth2/authorize?client_id=','Authorization\x20Code:','&token_access_type=','2749024GtgRfc','entries','screenshot','18GzOmVx','access_token','8pHJsGZ','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','FSSync','json','file','folder','Bearer\x20','map','overwrite','7169211VUZBeL','Kabu\x20storage\x20↦\x20Cloud\x20◆','Folder\x20already\x20exists','error','confirm','active','uid','save','Upload\x20failed,\x20unknown\x20http\x20status:\x20','remove','Restoring...','\x20files\x20from\x20Cloud?','responseText','[\x5c?&#]','state','getItem','Download\x20failed,\x20unknown\x20http\x20status:','Restore\x20canceled\x20by\x20user.','code','application/octet-stream','502628wKKYwK','POST','uId','nwb3dnfh09rhs31','DOMContentLoaded','No\x20files\x20found\x20to\x20restore.','refresh_token','Cloud\x20↦\x20Kabu\x20storage\x20◆','list','application/json','status','setItem','charAt','Cloud\x20login\x20required!','exec','&redirect_uri=','name','&client_id=','/data/','toUpperCase','refreshToken','No\x20refresh\x20token','open','onload','Do\x20you\x20want\x20to\x20restore\x20','error_description','application/x-www-form-urlencoded','push','https://api.dropboxapi.com/2/files/create_folder_v2','&response_type=','Content-Type','.tag','Unable\x20to\x20refresh\x20token','799003cGcIzi','refresh_token=','length','Do\x20not\x20receive\x20authorization','log','&client_secret=','click','https://api.dropboxapi.com/2/files/list_folder','replace','2542206CvrFCr','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','=([^&#]*)','Failed\x20to\x20upload\x20file\x20','search','addEventListener','classList','&grant_type=','split','accessToken','location','stringify','Do\x20you\x20want\x20to\x20backup\x20','offline','Error\x20creating\x20folder\x20','2047843DOpqNL','href','code=','knh3uz2mx2hp2eu','filter','parse','\x20files\x20in\x20Kabu?','https://content.dropboxapi.com/2/files/download','slice','5344970ADBDJj'];a0_0x44c2=function(){return _0x1abf57;};return a0_0x44c2();}function a0_0x9650(_0x19e15b,_0x4ae21b){var _0x44c274=a0_0x44c2();return a0_0x9650=function(_0x9650fe,_0x3ce183){_0x9650fe=_0x9650fe-0x1e9;var _0x46702c=_0x44c274[_0x9650fe];return _0x46702c;},a0_0x9650(_0x19e15b,_0x4ae21b);}export async function dpRefreshToken(){var _0x5316f1=a0_0x22aeb2;if(!localStorage['getItem'](_0x5316f1(0x239)))throw _0x5316f1(0x23a);try{const _0x25d05e=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x5316f1(0x23f)},'body':_0x5316f1(0x247)+localStorage[_0x5316f1(0x220)]('refreshToken')+_0x5316f1(0x209)}),_0x5bb92b=await _0x25d05e[_0x5316f1(0x20b)]();if(!_0x5bb92b[_0x5316f1(0x214)])return localStorage[_0x5316f1(0x230)]('accessToken',_0x5bb92b[_0x5316f1(0x207)]),await lockNoti(_0x5316f1(0x1fc),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5bb92b[_0x5316f1(0x23e)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x4429f8){console[_0x5316f1(0x214)]('Error\x20while\x20refreshing\x20token:',_0x4429f8);}return![];}export async function dpUploadFile(_0x1a837c,_0xd78076,_0x3e18ae){var _0x594c3b=a0_0x22aeb2;const _0x5dd6f5=localStorage[_0x594c3b(0x220)](_0x594c3b(0x227));var _0xd3e246=JSON['stringify']({'autorename':!![],'mode':_0x594c3b(0x210),'mute':!![],'strict_conflict':![],'path':'/'+_0x5dd6f5+'/'+_0x3e18ae+'/'+_0x1a837c}),_0x1b7b99=new Blob([_0xd78076],{'type':_0x594c3b(0x224)});for(var _0x2e1c96=0x0;_0x2e1c96<0x2;_0x2e1c96++){var _0x320378=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x594c3b(0x226),'headers':{'Authorization':_0x594c3b(0x20e)+localStorage[_0x594c3b(0x220)](_0x594c3b(0x1eb)),'Dropbox-API-Arg':_0xd3e246,'Content-Type':_0x594c3b(0x224)},'body':_0x1b7b99});if(_0x320378['status']!=0xc8){if(_0x320378[_0x594c3b(0x22f)]==0x191){var _0x29ae24=await dpRefreshToken();if(!_0x29ae24)throw _0x594c3b(0x245);continue;}else throw _0x594c3b(0x219)+_0x320378[_0x594c3b(0x22f)];}else{var _0x1281fa=await _0x320378[_0x594c3b(0x20b)]();return console[_0x594c3b(0x24a)](_0x594c3b(0x212),_0x1a837c),_0x1281fa;}}return![];}export async function dpDownloadFile(_0x488011,_0x5b7641){var _0xc4fb4b=a0_0x22aeb2;const _0x511d94=localStorage[_0xc4fb4b(0x220)](_0xc4fb4b(0x227));var _0x4829cf=JSON[_0xc4fb4b(0x1ed)]({'path':'/'+_0x511d94+'/'+_0x5b7641+'/'+_0x488011});for(var _0x2971b1=0x0;_0x2971b1<0x2;_0x2971b1++){var _0x2d5b42=await fetch(_0xc4fb4b(0x1f8),{'method':_0xc4fb4b(0x226),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x4829cf}});if(_0x2d5b42[_0xc4fb4b(0x22f)]!=0xc8){if(_0x2d5b42['status']==0x191){var _0xc03e59=await dpRefreshToken();if(!_0xc03e59)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xc4fb4b(0x221)+_0x2d5b42[_0xc4fb4b(0x22f)];}const _0x34856c=new File([await _0x2d5b42['blob']()],_0x488011);return console[_0xc4fb4b(0x24a)](_0xc4fb4b(0x22c),_0x34856c['name']),a0_0x881201['uploadFileInCloud'](_0x34856c,()=>{var _0x162a5d=_0xc4fb4b;localStorageFile(),Module[_0x162a5d(0x20a)]();}),_0x34856c;}return![];}document['addEventListener'](a0_0x22aeb2(0x229),function(){var _0x4081e4=a0_0x22aeb2;dropboxRestore[_0x4081e4(0x254)](_0x4081e4(0x24c),async function(){var _0x228186=_0x4081e4;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x22c571=localStorage['getItem']('uId'),_0x2241ca=[_0x228186(0x21f),_0x228186(0x218),_0x228186(0x205)];if(!_0x22c571){window[_0x228186(0x1fb)](_0x228186(0x232));return;}let _0x3850f6=[];for(const _0x482964 of _0x2241ca){let _0x4f5a0f={'path':'/'+_0x22c571+'/'+_0x482964};for(let _0x2198ff=0x0;_0x2198ff<0x2;_0x2198ff++){let _0x5305cc=await fetch(_0x228186(0x24d),{'method':_0x228186(0x226),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x228186(0x1eb)),'Content-Type':_0x228186(0x22e)},'body':JSON['stringify'](_0x4f5a0f)});if(_0x5305cc['status']===0xc8){let _0x4cc88a=await _0x5305cc[_0x228186(0x20b)](),_0x405748=_0x4cc88a[_0x228186(0x204)][_0x228186(0x1f5)](_0x23e7d6=>_0x23e7d6[_0x228186(0x244)]===_0x228186(0x20c));_0x405748[_0x228186(0x248)]>0x0&&_0x3850f6[_0x228186(0x240)](..._0x405748[_0x228186(0x20f)](_0x3e3f70=>({'name':_0x3e3f70['name'],'folder':_0x482964})));break;}else{if(_0x5305cc['status']===0x191){let _0x59f28e=await dpRefreshToken();if(!_0x59f28e)throw _0x228186(0x245);}else{console['error']('Download\x20failed\x20for\x20'+_0x482964+_0x228186(0x1fe)+_0x5305cc['status']);break;}}}}if(_0x3850f6[_0x228186(0x248)]>0x0){const _0xb24447=_0x228186(0x23d)+_0x3850f6['length']+_0x228186(0x21c);if(window['confirm'](_0xb24447))for(const _0x3a30c1 of _0x3850f6){await lockNoti(_0x228186(0x21b),_0x3a30c1[_0x228186(0x235)],0xbb8),await dpDownloadFile(_0x3a30c1[_0x228186(0x235)],_0x3a30c1[_0x228186(0x20d)]);}else console[_0x228186(0x24a)](_0x228186(0x222));}else console['log'](_0x228186(0x22a));}),dropboxBackup[_0x4081e4(0x254)](_0x4081e4(0x24c),async function(){var _0x48397a=_0x4081e4;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x45bcaa=localStorage[_0x48397a(0x220)](_0x48397a(0x227));if(_0x45bcaa===null||_0x45bcaa==='')window[_0x48397a(0x1fb)](_0x48397a(0x232));else{const _0x22eaac=[_0x48397a(0x21f),'save','screenshot'];for(const _0x544104 of _0x22eaac){await dpCreateFolder(_0x544104);}let _0x2000b1=0x0;for(const _0x58ec76 of _0x22eaac){const _0x42a168=a0_0x881201[_0x48397a(0x22d)+(_0x58ec76['charAt'](0x0)[_0x48397a(0x238)]()+_0x58ec76['slice'](0x1))]();_0x2000b1+=_0x42a168[_0x48397a(0x248)];}if(window[_0x48397a(0x215)](_0x48397a(0x1ee)+_0x2000b1+_0x48397a(0x1f7)))for(const _0x472201 of _0x22eaac){const _0x20d9bc=a0_0x881201['list'+(_0x472201[_0x48397a(0x231)](0x0)[_0x48397a(0x238)]()+_0x472201[_0x48397a(0x1f9)](0x1))]();for(const _0x2b8c3e of _0x20d9bc){const _0xca81cb=await a0_0x881201['downloadFileInCloud'](_0x48397a(0x237)+_0x472201+'s/'+_0x2b8c3e);try{await lockNoti('Backing\x20up...',_0x2b8c3e,0xbb8),await dpUploadFile(_0x2b8c3e,_0xca81cb,_0x472201);}catch(_0x3c4a89){console[_0x48397a(0x214)](_0x48397a(0x252)+_0x2b8c3e+':',_0x3c4a89);}}}else console[_0x48397a(0x24a)](_0x48397a(0x222));}}),dropboxCloud['addEventListener'](_0x4081e4(0x24c),function(){var _0x2c853d=_0x4081e4;const _0x107a6d=localStorage[_0x2c853d(0x220)](_0x2c853d(0x227));_0x107a6d===null||_0x107a6d===''?authorizeWithDropbox():window[_0x2c853d(0x215)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x2c853d(0x230)]('uId',''),dropboxRestore[_0x2c853d(0x255)][_0x2c853d(0x21a)](_0x2c853d(0x216)),dropboxBackup[_0x2c853d(0x255)][_0x2c853d(0x21a)](_0x2c853d(0x216)),dropboxCloud[_0x2c853d(0x255)]['remove'](_0x2c853d(0x216)));}),handleDropboxCallback();});