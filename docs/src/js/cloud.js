var a0_0x2455dc=a0_0x4967;(function(_0x174ef3,_0xc8374d){var _0x417d71=a0_0x4967,_0xa9335a=_0x174ef3();while(!![]){try{var _0x24bd48=parseInt(_0x417d71(0x110))/0x1+parseInt(_0x417d71(0x10d))/0x2+-parseInt(_0x417d71(0x119))/0x3+parseInt(_0x417d71(0x11b))/0x4*(-parseInt(_0x417d71(0x115))/0x5)+-parseInt(_0x417d71(0x113))/0x6+-parseInt(_0x417d71(0xe4))/0x7+parseInt(_0x417d71(0x13c))/0x8;if(_0x24bd48===_0xc8374d)break;else _0xa9335a['push'](_0xa9335a['shift']());}catch(_0x9578a){_0xa9335a['push'](_0xa9335a['shift']());}}}(a0_0x1237,0xe3401));import*as a0_0x383484 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2455dc(0x123),clientSecret=a0_0x2455dc(0x12d);function authorizeWithDropbox(){var _0x5a410b=a0_0x2455dc,_0x503a45=window[_0x5a410b(0xe7)][_0x5a410b(0x138)]['split']('?')[0x0],_0x53db95=_0x5a410b(0x124),_0x28adfb=_0x5a410b(0xf3),_0x10e461='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x5a410b(0xfa)+_0x53db95+_0x5a410b(0xfe)+_0x28adfb+_0x5a410b(0x13d)+encodeURIComponent(_0x503a45);window[_0x5a410b(0xe7)][_0x5a410b(0x138)]=_0x10e461;}function handleDropboxCallback(){var _0x287583=a0_0x2455dc,_0x485d26=getUrlParameter(_0x287583(0x124));_0x485d26?(getAccessToken(_0x485d26),console[_0x287583(0x10f)](_0x287583(0xed),_0x485d26)):console['log'](_0x287583(0xe9));}function getUrlParameter(_0x51cc57){var _0x134f16=a0_0x2455dc;_0x51cc57=_0x51cc57['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0xe274ac=new RegExp(_0x134f16(0x12f)+_0x51cc57+'=([^&#]*)'),_0x171f3b=_0xe274ac[_0x134f16(0x114)](location[_0x134f16(0x104)]);return _0x171f3b===null?'':decodeURIComponent(_0x171f3b[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0xbbaf89){var _0x4ff743=a0_0x2455dc,_0x24e2b0='authorization_code',_0x37f379=window[_0x4ff743(0xe7)][_0x4ff743(0x138)]['split']('?')[0x0],_0x58e5b5=new XMLHttpRequest();_0x58e5b5[_0x4ff743(0x111)]('POST',_0x4ff743(0x13b)),_0x58e5b5[_0x4ff743(0xe8)](_0x4ff743(0xec),_0x4ff743(0x130)),_0x58e5b5[_0x4ff743(0x103)]=function(){var _0x45de42=_0x4ff743;if(_0x58e5b5['status']===0xc8){var _0x2df0a0=JSON[_0x45de42(0xfb)](_0x58e5b5[_0x45de42(0x13e)]),_0x2c966b=_0x2df0a0[_0x45de42(0x116)],_0x4458c1=_0x2df0a0[_0x45de42(0x13a)],_0x1eede0=_0x2df0a0[_0x45de42(0xff)];localStorage['setItem'](_0x45de42(0xfd),_0x2c966b),localStorage['setItem'](_0x45de42(0xe6),_0x4458c1),localStorage['setItem'](_0x45de42(0xde),_0x1eede0);}else console[_0x45de42(0x10f)](_0x45de42(0x129));},_0x58e5b5['send'](_0x4ff743(0xe1)+_0xbbaf89+_0x4ff743(0xf8)+_0x24e2b0+_0x4ff743(0x125)+clientId+_0x4ff743(0x11d)+clientSecret+_0x4ff743(0x13d)+encodeURIComponent(_0x37f379));}export async function dpCreateFolder(_0x194e12){var _0xbeb23a=a0_0x2455dc;const _0x23fb0c=localStorage[_0xbeb23a(0xdd)](_0xbeb23a(0xde));let _0x30261d=localStorage[_0xbeb23a(0xdd)](_0xbeb23a(0xfd));const _0x46f4b0='/'+_0x23fb0c+'/'+_0x194e12,_0x358ee6=JSON['stringify']({'path':_0x46f4b0,'autorename':![]});for(let _0x1ec99c=0x0;_0x1ec99c<0x2;_0x1ec99c++){try{const _0x759f30=await fetch(_0xbeb23a(0x101),{'method':_0xbeb23a(0x108),'headers':{'Authorization':'Bearer\x20'+_0x30261d,'Content-Type':'application/json'},'body':_0x358ee6});if(_0x759f30[_0xbeb23a(0x117)]===0x191){const _0x18dcc3=await dpRefreshToken();if(!_0x18dcc3)throw new Error('Unable\x20to\x20refresh\x20token');_0x30261d=localStorage[_0xbeb23a(0xdd)](_0xbeb23a(0xfd));continue;}if(_0x759f30[_0xbeb23a(0x117)]===0x199)return{'message':_0xbeb23a(0xf1),'path':_0x194e12};if(!_0x759f30['ok'])throw new Error(_0xbeb23a(0xf0)+_0x194e12);const _0xaa7eac=await _0x759f30[_0xbeb23a(0xee)]();return await lockNoti(_0xbeb23a(0x122),'',0xbb8),_0xaa7eac;}catch(_0x4c2df8){if(_0x1ec99c===0x1)throw _0x4c2df8;}}return![];}function a0_0x1237(){var _0x23a48b=['addEventListener','Backing\x20up...','/data/','state','&grant_type=','length','&response_type=','parse','https://content.dropboxapi.com/2/files/upload','accessToken','&token_access_type=','uid','error_description','https://api.dropboxapi.com/2/files/create_folder_v2','alert','onload','search','DOMContentLoaded','Restore\x20canceled\x20by\x20user.','Cloud\x20↦\x20Kabu\x20storage\x20◆','POST','Error\x20while\x20refreshing\x20token:','Failed\x20to\x20refresh\x20Dropbox\x20token.','Refreshing\x20token...','Unable\x20to\x20refresh\x20token','1890268sRfNaa','overwrite','log','688225LytdjI','open','click','829746YMPqvl','exec','40CrXHdV','access_token','status','application/octet-stream','5284683iowBWN','entries','857000GecfEG','save','&client_secret=','application/json','Upload\x20failed,\x20unknown\x20http\x20status:\x20','screenshot','\x20files\x20from\x20Cloud?','Folder\x20created','knh3uz2mx2hp2eu','code','&client_id=','setItem','\x20files\x20in\x20Kabu?','classList','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','name','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','confirm','nwb3dnfh09rhs31','https://content.dropboxapi.com/2/files/download','[\x5c?&#]','application/x-www-form-urlencoded','Cloud\x20login\x20required!','refresh_token=','map','uploadFileInCloud','Do\x20you\x20want\x20to\x20restore\x20','Restoring...','Wait\x20a\x20little\x20bit...','href','.tag','refresh_token','https://api.dropbox.com/oauth2/token','24426992DvIzDd','&redirect_uri=','responseText','getItem','uId','error','Bearer\x20','code=','https://api.dropboxapi.com/2/files/list_folder',',\x20status:\x20','994448ZTSgzm','downloadFileInCloud','refreshToken','location','setRequestHeader','Do\x20not\x20receive\x20authorization','Kabu\x20storage\x20↦\x20Cloud\x20◆','remove','Content-Type','Authorization\x20Code:','json','listFiles','Error\x20creating\x20folder\x20','Folder\x20already\x20exists','stringify','offline'];a0_0x1237=function(){return _0x23a48b;};return a0_0x1237();}function a0_0x4967(_0x2066f2,_0x2d036d){var _0x123776=a0_0x1237();return a0_0x4967=function(_0x49677c,_0x28c126){_0x49677c=_0x49677c-0xdd;var _0x644fa=_0x123776[_0x49677c];return _0x644fa;},a0_0x4967(_0x2066f2,_0x2d036d);}export async function dpRefreshToken(){var _0x3c971a=a0_0x2455dc;if(!localStorage[_0x3c971a(0xdd)](_0x3c971a(0xe6)))throw'No\x20refresh\x20token';try{const _0xc56fb5=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x3c971a(0x108),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x3c971a(0x132)+localStorage[_0x3c971a(0xdd)](_0x3c971a(0xe6))+_0x3c971a(0x12b)}),_0x49024a=await _0xc56fb5[_0x3c971a(0xee)]();if(!_0x49024a[_0x3c971a(0xdf)])return localStorage['setItem']('accessToken',_0x49024a['access_token']),await lockNoti(_0x3c971a(0x10b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x49024a[_0x3c971a(0x100)]||_0x3c971a(0x10a));}catch(_0x3aa1cf){console[_0x3c971a(0xdf)](_0x3c971a(0x109),_0x3aa1cf);}return![];}export async function dpUploadFile(_0x1de98d,_0x29efbb,_0x5d1d67){var _0x33e3dd=a0_0x2455dc;const _0x3fa872=localStorage[_0x33e3dd(0xdd)](_0x33e3dd(0xde));var _0x10d9be=JSON[_0x33e3dd(0xf2)]({'autorename':!![],'mode':_0x33e3dd(0x10e),'mute':!![],'strict_conflict':![],'path':'/'+_0x3fa872+'/'+_0x5d1d67+'/'+_0x1de98d}),_0x10eb09=new Blob([_0x29efbb],{'type':'application/octet-stream'});for(var _0x4b02ba=0x0;_0x4b02ba<0x2;_0x4b02ba++){var _0x524144=await fetch(_0x33e3dd(0xfc),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x33e3dd(0xdd)](_0x33e3dd(0xfd)),'Dropbox-API-Arg':_0x10d9be,'Content-Type':_0x33e3dd(0x118)},'body':_0x10eb09});if(_0x524144['status']!=0xc8){if(_0x524144[_0x33e3dd(0x117)]==0x191){var _0x164d0e=await dpRefreshToken();if(!_0x164d0e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x33e3dd(0x11f)+_0x524144[_0x33e3dd(0x117)];}else{var _0x1ac601=await _0x524144['json']();return console[_0x33e3dd(0x10f)](_0x33e3dd(0xea),_0x1de98d),_0x1ac601;}}return![];}export async function dpDownloadFile(_0x3ee932,_0x5227fe){var _0x48ac32=a0_0x2455dc;const _0x158626=localStorage[_0x48ac32(0xdd)]('uId');var _0x2cbabd=JSON['stringify']({'path':'/'+_0x158626+'/'+_0x5227fe+'/'+_0x3ee932});for(var _0x475d2a=0x0;_0x475d2a<0x2;_0x475d2a++){var _0x302bbd=await fetch(_0x48ac32(0x12e),{'method':_0x48ac32(0x108),'headers':{'Authorization':_0x48ac32(0xe0)+localStorage['getItem'](_0x48ac32(0xfd)),'Dropbox-API-Arg':_0x2cbabd}});if(_0x302bbd[_0x48ac32(0x117)]!=0xc8){if(_0x302bbd[_0x48ac32(0x117)]==0x191){var _0x6a548=await dpRefreshToken();if(!_0x6a548)throw _0x48ac32(0x10c);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x302bbd[_0x48ac32(0x117)];}const _0x1301c0=new File([await _0x302bbd['blob']()],_0x3ee932);return console[_0x48ac32(0x10f)](_0x48ac32(0x107),_0x1301c0[_0x48ac32(0x12a)]),a0_0x383484[_0x48ac32(0x134)](_0x1301c0,()=>{}),_0x1301c0;}return![];}document[a0_0x2455dc(0xf4)](a0_0x2455dc(0x105),function(){var _0x5a7882=a0_0x2455dc;dropboxRestore['addEventListener'](_0x5a7882(0x112),async function(){var _0x1e862a=_0x5a7882;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x560b99=localStorage['getItem'](_0x1e862a(0xde)),_0x149805=[_0x1e862a(0xf7),_0x1e862a(0x11c),_0x1e862a(0x120)];if(!_0x560b99){window[_0x1e862a(0x102)](_0x1e862a(0x131));return;}let _0x49d0b7=[];for(const _0x13eef2 of _0x149805){let _0x40a87a={'path':'/'+_0x560b99+'/'+_0x13eef2};for(let _0x22ae2f=0x0;_0x22ae2f<0x2;_0x22ae2f++){let _0x1c7a18=await fetch(_0x1e862a(0xe2),{'method':_0x1e862a(0x108),'headers':{'Authorization':_0x1e862a(0xe0)+localStorage['getItem'](_0x1e862a(0xfd)),'Content-Type':_0x1e862a(0x11e)},'body':JSON['stringify'](_0x40a87a)});if(_0x1c7a18[_0x1e862a(0x117)]===0xc8){let _0x79313a=await _0x1c7a18[_0x1e862a(0xee)](),_0x4987c5=_0x79313a[_0x1e862a(0x11a)]['filter'](_0x580ab5=>_0x580ab5[_0x1e862a(0x139)]==='file');_0x4987c5['length']>0x0&&_0x49d0b7['push'](..._0x4987c5[_0x1e862a(0x133)](_0x34b404=>({'name':_0x34b404['name'],'folder':_0x13eef2})));break;}else{if(_0x1c7a18['status']===0x191){let _0x1f10d4=await dpRefreshToken();if(!_0x1f10d4)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x1e862a(0xdf)]('Download\x20failed\x20for\x20'+_0x13eef2+_0x1e862a(0xe3)+_0x1c7a18['status']);break;}}}}if(_0x49d0b7[_0x1e862a(0xf9)]>0x0){const _0x348527=_0x1e862a(0x135)+_0x49d0b7[_0x1e862a(0xf9)]+_0x1e862a(0x121);if(window[_0x1e862a(0x12c)](_0x348527))for(const _0x2a5cd5 of _0x49d0b7){await lockNoti(_0x1e862a(0x136),_0x2a5cd5[_0x1e862a(0x12a)],0xbb8),await dpDownloadFile(_0x2a5cd5[_0x1e862a(0x12a)],_0x2a5cd5['folder']);}else console[_0x1e862a(0x10f)](_0x1e862a(0x106));}else console[_0x1e862a(0x10f)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x5a7882(0xf4)](_0x5a7882(0x112),async function(){var _0x4d77ac=_0x5a7882;await lockNoti(_0x4d77ac(0x137),'',0x1388);const _0xde378=localStorage[_0x4d77ac(0xdd)](_0x4d77ac(0xde));if(_0xde378===null||_0xde378==='')window[_0x4d77ac(0x102)](_0x4d77ac(0x131));else{const _0x512e02=[_0x4d77ac(0xf7),_0x4d77ac(0x11c),'screenshot'];for(const _0x287b6d of _0x512e02){await dpCreateFolder(_0x287b6d);}let _0xd67757=0x0;for(const _0x2b6b66 of _0x512e02){const _0x1c0c80=a0_0x383484[_0x4d77ac(0xef)](_0x2b6b66+'s');_0xd67757+=_0x1c0c80[_0x4d77ac(0xf9)];}if(window[_0x4d77ac(0x12c)]('Do\x20you\x20want\x20to\x20backup\x20'+_0xd67757+_0x4d77ac(0x127)))for(const _0x3e522d of _0x512e02){const _0x5b9fe3=a0_0x383484[_0x4d77ac(0xef)](_0x3e522d+'s');for(const _0x36a4e3 of _0x5b9fe3){const _0x50c8e6=await a0_0x383484[_0x4d77ac(0xe5)](_0x4d77ac(0xf6)+_0x3e522d+'s/'+_0x36a4e3);try{await lockNoti(_0x4d77ac(0xf5),_0x36a4e3,0xbb8),await dpUploadFile(_0x36a4e3,_0x50c8e6,_0x3e522d);}catch(_0x2e48a8){console[_0x4d77ac(0xdf)]('Failed\x20to\x20upload\x20file\x20'+_0x36a4e3+':',_0x2e48a8);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener'](_0x5a7882(0x112),function(){var _0x5d7929=_0x5a7882;const _0x5b4c95=localStorage[_0x5d7929(0xdd)]('uId');_0x5b4c95===null||_0x5b4c95===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x5d7929(0x126)](_0x5d7929(0xde),''),dropboxRestore['classList'][_0x5d7929(0xeb)]('active'),dropboxBackup[_0x5d7929(0x128)]['remove']('active'),dropboxCloud['classList'][_0x5d7929(0xeb)]('active'));}),handleDropboxCallback();});