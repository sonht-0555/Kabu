var a0_0x2ce061=a0_0x3fc8;(function(_0x1fa03d,_0x27fd72){var _0x81d266=a0_0x3fc8,_0xa0d178=_0x1fa03d();while(!![]){try{var _0x53ebb8=-parseInt(_0x81d266(0x98))/0x1*(-parseInt(_0x81d266(0xad))/0x2)+-parseInt(_0x81d266(0xde))/0x3+-parseInt(_0x81d266(0x8b))/0x4+parseInt(_0x81d266(0xe2))/0x5+-parseInt(_0x81d266(0xd3))/0x6+-parseInt(_0x81d266(0xe4))/0x7*(-parseInt(_0x81d266(0xe3))/0x8)+parseInt(_0x81d266(0xc7))/0x9;if(_0x53ebb8===_0x27fd72)break;else _0xa0d178['push'](_0xa0d178['shift']());}catch(_0x433bdd){_0xa0d178['push'](_0xa0d178['shift']());}}}(a0_0x33d8,0xd828e));import*as a0_0x82054b from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2ce061(0x93),clientSecret=a0_0x2ce061(0x83);function authorizeWithDropbox(){var _0x3020ac=a0_0x2ce061,_0x24e674=window[_0x3020ac(0xa7)]['href']['split']('?')[0x0],_0x5c7cdd='code',_0x1d8eab=_0x3020ac(0xba),_0x6812d3=_0x3020ac(0x9b)+clientId+_0x3020ac(0xd7)+_0x5c7cdd+_0x3020ac(0xb8)+_0x1d8eab+'&redirect_uri='+encodeURIComponent(_0x24e674);window[_0x3020ac(0xa7)][_0x3020ac(0x99)]=_0x6812d3;}function handleDropboxCallback(){var _0x4a4a8e=a0_0x2ce061,_0x334e28=getUrlParameter(_0x4a4a8e(0x9c));_0x334e28?(getAccessToken(_0x334e28),console[_0x4a4a8e(0x7f)](_0x4a4a8e(0xc9),_0x334e28)):console[_0x4a4a8e(0x7f)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0xfd7c19){var _0x589b1f=a0_0x2ce061;_0xfd7c19=_0xfd7c19['replace'](/[\[]/,'\x5c[')[_0x589b1f(0xa4)](/[\]]/,'\x5c]');var _0xe5dc38=new RegExp(_0x589b1f(0x82)+_0xfd7c19+_0x589b1f(0x88)),_0x39f3d5=_0xe5dc38[_0x589b1f(0xcb)](location[_0x589b1f(0xaa)]);return _0x39f3d5===null?'':decodeURIComponent(_0x39f3d5[0x1][_0x589b1f(0xa4)](/\+/g,'\x20'));}function a0_0x33d8(){var _0x3fb377=['setRequestHeader','application/octet-stream','charAt','Do\x20you\x20want\x20to\x20backup\x20','accessToken','Content-Type','3010686ppUqvt','Download\x20failed\x20for\x20','Folder\x20created','onload','&response_type=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Restoring...','https://api.dropbox.com/oauth2/token','/data/','confirm','Error\x20while\x20refreshing\x20token:','1104930lNJBnC','Do\x20you\x20want\x20to\x20restore\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Restore\x20canceled\x20by\x20user.','2517960nVJiUj','4758376VCHXQO','7kIiCCu','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','refresh_token','log','&grant_type=','list','[\x5c?&#]','nwb3dnfh09rhs31','https://api.dropboxapi.com/oauth2/token','slice','classList','access_token','=([^&#]*)','application/json','folder','4369272crzMrP','refreshToken','uId','screenshot','error','Bearer\x20','click','addEventListener','knh3uz2mx2hp2eu','send','downloadFileInCloud','map','setItem','85207FCkALE','href','Unable\x20to\x20refresh\x20token','https://www.dropbox.com/oauth2/authorize?client_id=','code','Wait\x20a\x20little\x20bit...','&redirect_uri=','push','https://api.dropboxapi.com/2/files/create_folder_v2','save','Failed\x20to\x20upload\x20file\x20','application/x-www-form-urlencoded','replace','Refreshing\x20token...','json','location','code=','length','search','stringify','No\x20files\x20found\x20to\x20restore.','40ISyHTM','state','DOMContentLoaded','active','refresh_token=','\x20files\x20in\x20Kabu?','https://content.dropboxapi.com/2/files/upload','.tag','POST',',\x20status:\x20','file','&token_access_type=','alert','offline','getItem','parse','https://api.dropboxapi.com/2/files/list_folder','name','Backing\x20up...','error_description','status','remove','\x20files\x20from\x20Cloud?','authorization_code','open','responseText','407430LGNHwM','&client_secret=','Authorization\x20Code:','blob','exec','Failed\x20to\x20refresh\x20Dropbox\x20token.'];a0_0x33d8=function(){return _0x3fb377;};return a0_0x33d8();}function getAccessToken(_0x3a0b24){var _0x562130=a0_0x2ce061,_0x13e5e7=_0x562130(0xc4),_0x451758=window[_0x562130(0xa7)][_0x562130(0x99)]['split']('?')[0x0],_0x3a6f73=new XMLHttpRequest();_0x3a6f73[_0x562130(0xc5)](_0x562130(0xb5),_0x562130(0xda)),_0x3a6f73[_0x562130(0xcd)](_0x562130(0xd2),'application/x-www-form-urlencoded'),_0x3a6f73[_0x562130(0xd6)]=function(){var _0x14cc80=_0x562130;if(_0x3a6f73[_0x14cc80(0xc1)]===0xc8){var _0x55eedc=JSON[_0x14cc80(0xbc)](_0x3a6f73[_0x14cc80(0xc6)]),_0x1daf92=_0x55eedc[_0x14cc80(0x87)],_0x5447a7=_0x55eedc[_0x14cc80(0x7e)],_0x51e000=_0x55eedc['uid'];localStorage[_0x14cc80(0x97)](_0x14cc80(0xd1),_0x1daf92),localStorage['setItem'](_0x14cc80(0x8c),_0x5447a7),localStorage['setItem'](_0x14cc80(0x8d),_0x51e000);}else console[_0x14cc80(0x7f)](_0x14cc80(0xd8));},_0x3a6f73[_0x562130(0x94)](_0x562130(0xa8)+_0x3a0b24+_0x562130(0x80)+_0x13e5e7+'&client_id='+clientId+_0x562130(0xc8)+clientSecret+_0x562130(0x9e)+encodeURIComponent(_0x451758));}export async function dpCreateFolder(_0x43011a){var _0xf2c8e7=a0_0x2ce061;const _0x2c605e=localStorage[_0xf2c8e7(0xbb)](_0xf2c8e7(0x8d));let _0x29273d=localStorage[_0xf2c8e7(0xbb)](_0xf2c8e7(0xd1));const _0x1532dd='/'+_0x2c605e+'/'+_0x43011a,_0x11b657=JSON[_0xf2c8e7(0xab)]({'path':_0x1532dd,'autorename':![]});for(let _0x324c3e=0x0;_0x324c3e<0x2;_0x324c3e++){try{const _0x110887=await fetch(_0xf2c8e7(0xa0),{'method':_0xf2c8e7(0xb5),'headers':{'Authorization':_0xf2c8e7(0x90)+_0x29273d,'Content-Type':_0xf2c8e7(0x89)},'body':_0x11b657});if(_0x110887[_0xf2c8e7(0xc1)]===0x191){const _0x22934a=await dpRefreshToken();if(!_0x22934a)throw new Error(_0xf2c8e7(0x9a));_0x29273d=localStorage[_0xf2c8e7(0xbb)]('accessToken');continue;}if(_0x110887[_0xf2c8e7(0xc1)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x43011a};if(!_0x110887['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x43011a);const _0x3e3d05=await _0x110887[_0xf2c8e7(0xa6)]();return await lockNoti(_0xf2c8e7(0xd5),'',0xbb8),_0x3e3d05;}catch(_0x3924ca){if(_0x324c3e===0x1)throw _0x3924ca;}}return![];}export async function dpRefreshToken(){var _0x6fa3e6=a0_0x2ce061;if(!localStorage[_0x6fa3e6(0xbb)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x244f60=await fetch(_0x6fa3e6(0x84),{'method':_0x6fa3e6(0xb5),'headers':{'Content-Type':_0x6fa3e6(0xa3)},'body':_0x6fa3e6(0xb1)+localStorage['getItem']('refreshToken')+_0x6fa3e6(0x7d)}),_0x4eefad=await _0x244f60['json']();if(!_0x4eefad[_0x6fa3e6(0x8f)])return localStorage[_0x6fa3e6(0x97)]('accessToken',_0x4eefad[_0x6fa3e6(0x87)]),await lockNoti(_0x6fa3e6(0xa5),'',0xbb8),await delay(0x3e8),!![];else alert(_0x4eefad[_0x6fa3e6(0xc0)]||_0x6fa3e6(0xcc));}catch(_0xe09b9b){console['error'](_0x6fa3e6(0xdd),_0xe09b9b);}return![];}function a0_0x3fc8(_0x1ae6eb,_0x32e366){var _0x33d85d=a0_0x33d8();return a0_0x3fc8=function(_0x3fc879,_0x425463){_0x3fc879=_0x3fc879-0x7d;var _0x1d3d74=_0x33d85d[_0x3fc879];return _0x1d3d74;},a0_0x3fc8(_0x1ae6eb,_0x32e366);}export async function dpUploadFile(_0x422f82,_0x2ecde9,_0x4add5d){var _0x47c4e4=a0_0x2ce061;const _0x6b179a=localStorage[_0x47c4e4(0xbb)](_0x47c4e4(0x8d));var _0x5f9f7e=JSON[_0x47c4e4(0xab)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x6b179a+'/'+_0x4add5d+'/'+_0x422f82}),_0x4bdb1e=new Blob([_0x2ecde9],{'type':'application/octet-stream'});for(var _0x19b4c5=0x0;_0x19b4c5<0x2;_0x19b4c5++){var _0x2e906a=await fetch(_0x47c4e4(0xb3),{'method':_0x47c4e4(0xb5),'headers':{'Authorization':_0x47c4e4(0x90)+localStorage[_0x47c4e4(0xbb)](_0x47c4e4(0xd1)),'Dropbox-API-Arg':_0x5f9f7e,'Content-Type':_0x47c4e4(0xce)},'body':_0x4bdb1e});if(_0x2e906a[_0x47c4e4(0xc1)]!=0xc8){if(_0x2e906a[_0x47c4e4(0xc1)]==0x191){var _0x25432e=await dpRefreshToken();if(!_0x25432e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x47c4e4(0xe0)+_0x2e906a[_0x47c4e4(0xc1)];}else{var _0x521c22=await _0x2e906a[_0x47c4e4(0xa6)]();return console[_0x47c4e4(0x7f)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x422f82),_0x521c22;}}return![];}export async function dpDownloadFile(_0x2cffe,_0x4b0b16){var _0x4df7e1=a0_0x2ce061;const _0x5ceadb=localStorage['getItem']('uId');var _0x46bcb5=JSON[_0x4df7e1(0xab)]({'path':'/'+_0x5ceadb+'/'+_0x4b0b16+'/'+_0x2cffe});for(var _0x1745f7=0x0;_0x1745f7<0x2;_0x1745f7++){var _0x1a2031=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x4df7e1(0xb5),'headers':{'Authorization':_0x4df7e1(0x90)+localStorage[_0x4df7e1(0xbb)](_0x4df7e1(0xd1)),'Dropbox-API-Arg':_0x46bcb5}});if(_0x1a2031[_0x4df7e1(0xc1)]!=0xc8){if(_0x1a2031[_0x4df7e1(0xc1)]==0x191){var _0x5082fd=await dpRefreshToken();if(!_0x5082fd)throw _0x4df7e1(0x9a);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x1a2031[_0x4df7e1(0xc1)];}const _0x2bd6b2=new File([await _0x1a2031[_0x4df7e1(0xca)]()],_0x2cffe);return console[_0x4df7e1(0x7f)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2bd6b2['name']),a0_0x82054b['uploadFileInCloud'](_0x2bd6b2,()=>{}),_0x2bd6b2;}return![];}document[a0_0x2ce061(0x92)](a0_0x2ce061(0xaf),function(){var _0x228a45=a0_0x2ce061;dropboxRestore[_0x228a45(0x92)](_0x228a45(0x91),async function(){var _0x30d686=_0x228a45;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4cc0fd=localStorage[_0x30d686(0xbb)](_0x30d686(0x8d)),_0x1d9db2=[_0x30d686(0xae),_0x30d686(0xa1),_0x30d686(0x8e)];if(!_0x4cc0fd){window[_0x30d686(0xb9)]('Cloud\x20login\x20required!');return;}let _0x17d359=[];for(const _0x335a64 of _0x1d9db2){let _0x5e7d94={'path':'/'+_0x4cc0fd+'/'+_0x335a64};for(let _0x57d2ff=0x0;_0x57d2ff<0x2;_0x57d2ff++){let _0x372ded=await fetch(_0x30d686(0xbd),{'method':_0x30d686(0xb5),'headers':{'Authorization':_0x30d686(0x90)+localStorage['getItem'](_0x30d686(0xd1)),'Content-Type':_0x30d686(0x89)},'body':JSON[_0x30d686(0xab)](_0x5e7d94)});if(_0x372ded[_0x30d686(0xc1)]===0xc8){let _0x273c32=await _0x372ded['json'](),_0x43448f=_0x273c32['entries']['filter'](_0x17fca8=>_0x17fca8[_0x30d686(0xb4)]===_0x30d686(0xb7));_0x43448f[_0x30d686(0xa9)]>0x0&&_0x17d359[_0x30d686(0x9f)](..._0x43448f[_0x30d686(0x96)](_0x4cf5ab=>({'name':_0x4cf5ab[_0x30d686(0xbe)],'folder':_0x335a64})));break;}else{if(_0x372ded[_0x30d686(0xc1)]===0x191){let _0x213206=await dpRefreshToken();if(!_0x213206)throw _0x30d686(0x9a);}else{console[_0x30d686(0x8f)](_0x30d686(0xd4)+_0x335a64+_0x30d686(0xb6)+_0x372ded[_0x30d686(0xc1)]);break;}}}}if(_0x17d359[_0x30d686(0xa9)]>0x0){const _0x5a82b8=_0x30d686(0xdf)+_0x17d359[_0x30d686(0xa9)]+_0x30d686(0xc3);if(window[_0x30d686(0xdc)](_0x5a82b8))for(const _0x4825da of _0x17d359){await lockNoti(_0x30d686(0xd9),_0x4825da[_0x30d686(0xbe)],0xbb8),await dpDownloadFile(_0x4825da['name'],_0x4825da[_0x30d686(0x8a)]);}else console[_0x30d686(0x7f)](_0x30d686(0xe1));}else console[_0x30d686(0x7f)](_0x30d686(0xac));}),dropboxBackup[_0x228a45(0x92)](_0x228a45(0x91),async function(){var _0x141a59=_0x228a45;await lockNoti(_0x141a59(0x9d),'',0x1388);const _0x1be5b4=localStorage[_0x141a59(0xbb)](_0x141a59(0x8d));if(_0x1be5b4===null||_0x1be5b4==='')window[_0x141a59(0xb9)]('Cloud\x20login\x20required!');else{const _0x44a96f=[_0x141a59(0xae),'save',_0x141a59(0x8e)];for(const _0x38c50f of _0x44a96f){await dpCreateFolder(_0x38c50f);}let _0x5e5817=0x0;for(const _0x4e063b of _0x44a96f){const _0x3e1149=a0_0x82054b['list'+(_0x4e063b[_0x141a59(0xcf)](0x0)['toUpperCase']()+_0x4e063b['slice'](0x1))]();_0x5e5817+=_0x3e1149[_0x141a59(0xa9)];}if(window[_0x141a59(0xdc)](_0x141a59(0xd0)+_0x5e5817+_0x141a59(0xb2)))for(const _0x50763e of _0x44a96f){const _0x27bfd4=a0_0x82054b[_0x141a59(0x81)+(_0x50763e[_0x141a59(0xcf)](0x0)['toUpperCase']()+_0x50763e[_0x141a59(0x85)](0x1))]();for(const _0x10ca37 of _0x27bfd4){const _0x1576cb=await a0_0x82054b[_0x141a59(0x95)](_0x141a59(0xdb)+_0x50763e+'s/'+_0x10ca37);try{await lockNoti(_0x141a59(0xbf),_0x10ca37,0xbb8),await dpUploadFile(_0x10ca37,_0x1576cb,_0x50763e);}catch(_0x280de2){console[_0x141a59(0x8f)](_0x141a59(0xa2)+_0x10ca37+':',_0x280de2);}}}else console[_0x141a59(0x7f)](_0x141a59(0xe1));}}),dropboxCloud[_0x228a45(0x92)](_0x228a45(0x91),function(){var _0x152e3b=_0x228a45;const _0x1db6ca=localStorage[_0x152e3b(0xbb)](_0x152e3b(0x8d));_0x1db6ca===null||_0x1db6ca===''?authorizeWithDropbox():window[_0x152e3b(0xdc)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x152e3b(0x97)](_0x152e3b(0x8d),''),dropboxRestore[_0x152e3b(0x86)][_0x152e3b(0xc2)]('active'),dropboxBackup[_0x152e3b(0x86)][_0x152e3b(0xc2)](_0x152e3b(0xb0)),dropboxCloud[_0x152e3b(0x86)]['remove'](_0x152e3b(0xb0)));}),handleDropboxCallback();});