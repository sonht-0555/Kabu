var a0_0x2a8c0d=a0_0x2257;(function(_0x163b22,_0xf1750f){var _0x4e72c2=a0_0x2257,_0x3c1c8a=_0x163b22();while(!![]){try{var _0x6f6aa9=-parseInt(_0x4e72c2(0x191))/0x1+parseInt(_0x4e72c2(0x1ee))/0x2*(parseInt(_0x4e72c2(0x190))/0x3)+-parseInt(_0x4e72c2(0x1ec))/0x4*(-parseInt(_0x4e72c2(0x1cd))/0x5)+parseInt(_0x4e72c2(0x1c8))/0x6*(parseInt(_0x4e72c2(0x1cf))/0x7)+-parseInt(_0x4e72c2(0x199))/0x8+parseInt(_0x4e72c2(0x1df))/0x9+-parseInt(_0x4e72c2(0x18f))/0xa*(-parseInt(_0x4e72c2(0x1de))/0xb);if(_0x6f6aa9===_0xf1750f)break;else _0x3c1c8a['push'](_0x3c1c8a['shift']());}catch(_0x307873){_0x3c1c8a['push'](_0x3c1c8a['shift']());}}}(a0_0x3b05,0xe225c));import*as a0_0x10b294 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x2257(_0x44b2d9,_0x5c5c6e){var _0x3b0542=a0_0x3b05();return a0_0x2257=function(_0x22572b,_0x3bc14d){_0x22572b=_0x22572b-0x188;var _0x583f82=_0x3b0542[_0x22572b];return _0x583f82;},a0_0x2257(_0x44b2d9,_0x5c5c6e);}var clientId=a0_0x2a8c0d(0x1a6),clientSecret=a0_0x2a8c0d(0x1a0);function authorizeWithDropbox(){var _0x588e7b=a0_0x2a8c0d,_0x25d988=window['location'][_0x588e7b(0x1a3)][_0x588e7b(0x19b)]('?')[0x0],_0x2322d4=_0x588e7b(0x193),_0x2ceac9=_0x588e7b(0x1c0),_0x10dd95='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x588e7b(0x189)+_0x2322d4+_0x588e7b(0x1d2)+_0x2ceac9+'&redirect_uri='+encodeURIComponent(_0x25d988);window['location'][_0x588e7b(0x1a3)]=_0x10dd95;}function handleDropboxCallback(){var _0x213cbd=a0_0x2a8c0d,_0x152ee6=getUrlParameter(_0x213cbd(0x193));_0x152ee6?(getAccessToken(_0x152ee6),console[_0x213cbd(0x19d)](_0x213cbd(0x1b6),_0x152ee6)):console[_0x213cbd(0x19d)](_0x213cbd(0x1ca));}function getUrlParameter(_0x3212af){var _0x80887a=a0_0x2a8c0d;_0x3212af=_0x3212af[_0x80887a(0x1e0)](/[\[]/,'\x5c[')[_0x80887a(0x1e0)](/[\]]/,'\x5c]');var _0xeeb90a=new RegExp(_0x80887a(0x18e)+_0x3212af+_0x80887a(0x19f)),_0x27053a=_0xeeb90a[_0x80887a(0x1e2)](location[_0x80887a(0x1ab)]);return _0x27053a===null?'':decodeURIComponent(_0x27053a[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x36cf13){var _0x3c1a64=a0_0x2a8c0d,_0x13db05=_0x3c1a64(0x1ba),_0x120831=window[_0x3c1a64(0x1bf)][_0x3c1a64(0x1a3)][_0x3c1a64(0x19b)]('?')[0x0],_0xe37e7c=new XMLHttpRequest();_0xe37e7c['open'](_0x3c1a64(0x1b0),_0x3c1a64(0x1f4)),_0xe37e7c['setRequestHeader'](_0x3c1a64(0x1ce),_0x3c1a64(0x1ac)),_0xe37e7c[_0x3c1a64(0x1d9)]=function(){var _0x37f42c=_0x3c1a64;if(_0xe37e7c['status']===0xc8){var _0x452ca6=JSON[_0x37f42c(0x1a1)](_0xe37e7c[_0x37f42c(0x1d5)]),_0x200766=_0x452ca6[_0x37f42c(0x1f0)],_0x4c2aeb=_0x452ca6[_0x37f42c(0x1bd)],_0x5038fe=_0x452ca6[_0x37f42c(0x19a)];localStorage[_0x37f42c(0x1f3)](_0x37f42c(0x196),_0x200766),localStorage[_0x37f42c(0x1f3)](_0x37f42c(0x188),_0x4c2aeb),localStorage[_0x37f42c(0x1f3)](_0x37f42c(0x1e3),_0x5038fe);}else console[_0x37f42c(0x19d)](_0x37f42c(0x1a4));},_0xe37e7c['send'](_0x3c1a64(0x1d1)+_0x36cf13+_0x3c1a64(0x1f1)+_0x13db05+_0x3c1a64(0x1e7)+clientId+'&client_secret='+clientSecret+_0x3c1a64(0x1c6)+encodeURIComponent(_0x120831));}export async function dpCreateFolder(_0x100c7c){var _0x1e4df4=a0_0x2a8c0d;const _0x18efe9=localStorage[_0x1e4df4(0x194)](_0x1e4df4(0x1e3));let _0x1341cf=localStorage[_0x1e4df4(0x194)](_0x1e4df4(0x196));const _0x223e54='/'+_0x18efe9+'/'+_0x100c7c,_0x5958d3=JSON[_0x1e4df4(0x1d7)]({'path':_0x223e54,'autorename':![]});for(let _0x132cdb=0x0;_0x132cdb<0x2;_0x132cdb++){try{const _0x36ddd3=await fetch(_0x1e4df4(0x1e1),{'method':_0x1e4df4(0x1b0),'headers':{'Authorization':_0x1e4df4(0x197)+_0x1341cf,'Content-Type':_0x1e4df4(0x1cb)},'body':_0x5958d3});if(_0x36ddd3[_0x1e4df4(0x18d)]===0x191){const _0xdcd669=await dpRefreshToken();if(!_0xdcd669)throw new Error(_0x1e4df4(0x1d3));_0x1341cf=localStorage['getItem'](_0x1e4df4(0x196));continue;}if(_0x36ddd3[_0x1e4df4(0x18d)]===0x199)return{'message':_0x1e4df4(0x1b1),'path':_0x100c7c};if(!_0x36ddd3['ok'])throw new Error(_0x1e4df4(0x1d4)+_0x100c7c);const _0x1882c4=await _0x36ddd3[_0x1e4df4(0x1e4)]();return await lockNoti(_0x1e4df4(0x1e6),'',0xbb8),_0x1882c4;}catch(_0xc1a28b){if(_0x132cdb===0x1)throw _0xc1a28b;}}return![];}function a0_0x3b05(){var _0x2ce43f=['31488oqcoBb','blob','Do\x20not\x20receive\x20authorization','application/json','screenshot','5mStshl','Content-Type','2254abRNIt','Backing\x20up...','code=','&token_access_type=','Unable\x20to\x20refresh\x20token','Error\x20creating\x20folder\x20','responseText','state','stringify','confirm','onload','Download\x20failed\x20for\x20','push','/data/','name','5203raAyWk','679446koDcCL','replace','https://api.dropboxapi.com/2/files/create_folder_v2','exec','uId','json','Failed\x20to\x20refresh\x20Dropbox\x20token.','Folder\x20created','&client_id=','Restoring...','https://api.dropboxapi.com/2/files/list_folder','Cloud\x20↦\x20Kabu\x20storage\x20◆','entries','1241636kQiHpf','filter','36322qWmnKE','Restore\x20canceled\x20by\x20user.','access_token','&grant_type=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','setItem','https://api.dropbox.com/oauth2/token','refreshToken','&response_type=','\x20files\x20from\x20Cloud?','charAt','addEventListener','status','[\x5c?&#]','25270tdXvGw','12HcLviv','1716850HTdfmk','application/octet-stream','code','getItem','list','accessToken','Bearer\x20','https://api.dropboxapi.com/oauth2/token','5604192DgsbIO','uid','split','.tag','log','Error\x20while\x20refreshing\x20token:','=([^&#]*)','nwb3dnfh09rhs31','parse','click','href','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Failed\x20to\x20upload\x20file\x20','knh3uz2mx2hp2eu',',\x20status:\x20','file','folder','overwrite','search','application/x-www-form-urlencoded','\x20files\x20in\x20Kabu?','Do\x20you\x20want\x20to\x20backup\x20','remove','POST','Folder\x20already\x20exists','active','Wait\x20a\x20little\x20bit...','error','error_description','Authorization\x20Code:','refresh_token=','Do\x20you\x20want\x20to\x20logout?','Do\x20you\x20want\x20to\x20restore\x20','authorization_code','classList','slice','refresh_token','alert','location','offline','Download\x20failed,\x20unknown\x20http\x20status:','map','toUpperCase','Kabu\x20storage\x20↦\x20Cloud\x20◆','Cloud\x20login\x20required!','&redirect_uri=','length'];a0_0x3b05=function(){return _0x2ce43f;};return a0_0x3b05();}export async function dpRefreshToken(){var _0x3e235=a0_0x2a8c0d;if(!localStorage[_0x3e235(0x194)](_0x3e235(0x188)))throw'No\x20refresh\x20token';try{const _0x2c37d9=await fetch(_0x3e235(0x198),{'method':_0x3e235(0x1b0),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x3e235(0x1b7)+localStorage[_0x3e235(0x194)](_0x3e235(0x188))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0xb2c3bb=await _0x2c37d9['json']();if(!_0xb2c3bb[_0x3e235(0x1b4)])return localStorage[_0x3e235(0x1f3)](_0x3e235(0x196),_0xb2c3bb[_0x3e235(0x1f0)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0xb2c3bb[_0x3e235(0x1b5)]||_0x3e235(0x1e5));}catch(_0x6ba4b4){console[_0x3e235(0x1b4)](_0x3e235(0x19e),_0x6ba4b4);}return![];}export async function dpUploadFile(_0xf365f5,_0x33e367,_0x3a29c2){var _0x44a3d4=a0_0x2a8c0d;const _0x3d06bc=localStorage[_0x44a3d4(0x194)](_0x44a3d4(0x1e3));var _0x2f21fd=JSON[_0x44a3d4(0x1d7)]({'autorename':!![],'mode':_0x44a3d4(0x1aa),'mute':!![],'strict_conflict':![],'path':'/'+_0x3d06bc+'/'+_0x3a29c2+'/'+_0xf365f5}),_0x10abcd=new Blob([_0x33e367],{'type':_0x44a3d4(0x192)});for(var _0x27c7e0=0x0;_0x27c7e0<0x2;_0x27c7e0++){var _0x5e1e7b=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x44a3d4(0x1b0),'headers':{'Authorization':_0x44a3d4(0x197)+localStorage[_0x44a3d4(0x194)]('accessToken'),'Dropbox-API-Arg':_0x2f21fd,'Content-Type':_0x44a3d4(0x192)},'body':_0x10abcd});if(_0x5e1e7b[_0x44a3d4(0x18d)]!=0xc8){if(_0x5e1e7b['status']==0x191){var _0x40fa2d=await dpRefreshToken();if(!_0x40fa2d)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x44a3d4(0x1f2)+_0x5e1e7b[_0x44a3d4(0x18d)];}else{var _0x31eaae=await _0x5e1e7b[_0x44a3d4(0x1e4)]();return console[_0x44a3d4(0x19d)](_0x44a3d4(0x1c4),_0xf365f5),_0x31eaae;}}return![];}export async function dpDownloadFile(_0x33f9d2,_0x25a7a6){var _0xe3ca58=a0_0x2a8c0d;const _0x31dbdc=localStorage[_0xe3ca58(0x194)](_0xe3ca58(0x1e3));var _0x4d6d46=JSON[_0xe3ca58(0x1d7)]({'path':'/'+_0x31dbdc+'/'+_0x25a7a6+'/'+_0x33f9d2});for(var _0xa860a3=0x0;_0xa860a3<0x2;_0xa860a3++){var _0x5d3684=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0xe3ca58(0x1b0),'headers':{'Authorization':_0xe3ca58(0x197)+localStorage[_0xe3ca58(0x194)](_0xe3ca58(0x196)),'Dropbox-API-Arg':_0x4d6d46}});if(_0x5d3684[_0xe3ca58(0x18d)]!=0xc8){if(_0x5d3684[_0xe3ca58(0x18d)]==0x191){var _0xb01784=await dpRefreshToken();if(!_0xb01784)throw _0xe3ca58(0x1d3);continue;}else throw _0xe3ca58(0x1c1)+_0x5d3684[_0xe3ca58(0x18d)];}const _0x4159af=new File([await _0x5d3684[_0xe3ca58(0x1c9)]()],_0x33f9d2);return console['log'](_0xe3ca58(0x1ea),_0x4159af[_0xe3ca58(0x1dd)]),a0_0x10b294['uploadFileInCloud'](_0x4159af,()=>{}),_0x4159af;}return![];}document[a0_0x2a8c0d(0x18c)]('DOMContentLoaded',function(){var _0x28ff4b=a0_0x2a8c0d;dropboxRestore[_0x28ff4b(0x18c)](_0x28ff4b(0x1a2),async function(){var _0x3318e7=_0x28ff4b;await lockNoti(_0x3318e7(0x1b3),'',0x1388);const _0x2562b9=localStorage['getItem'](_0x3318e7(0x1e3)),_0x8005fc=[_0x3318e7(0x1d6),'save',_0x3318e7(0x1cc)];if(!_0x2562b9){window[_0x3318e7(0x1be)](_0x3318e7(0x1c5));return;}let _0x87fb05=[];for(const _0xf28d37 of _0x8005fc){let _0x584847={'path':'/'+_0x2562b9+'/'+_0xf28d37};for(let _0x19312a=0x0;_0x19312a<0x2;_0x19312a++){let _0x3d0c35=await fetch(_0x3318e7(0x1e9),{'method':_0x3318e7(0x1b0),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3318e7(0x194)](_0x3318e7(0x196)),'Content-Type':'application/json'},'body':JSON[_0x3318e7(0x1d7)](_0x584847)});if(_0x3d0c35[_0x3318e7(0x18d)]===0xc8){let _0x47212e=await _0x3d0c35['json'](),_0x31e110=_0x47212e[_0x3318e7(0x1eb)][_0x3318e7(0x1ed)](_0x2372be=>_0x2372be[_0x3318e7(0x19c)]===_0x3318e7(0x1a8));_0x31e110[_0x3318e7(0x1c7)]>0x0&&_0x87fb05[_0x3318e7(0x1db)](..._0x31e110[_0x3318e7(0x1c2)](_0x226e05=>({'name':_0x226e05[_0x3318e7(0x1dd)],'folder':_0xf28d37})));break;}else{if(_0x3d0c35['status']===0x191){let _0x8fc0e1=await dpRefreshToken();if(!_0x8fc0e1)throw _0x3318e7(0x1d3);}else{console['error'](_0x3318e7(0x1da)+_0xf28d37+_0x3318e7(0x1a7)+_0x3d0c35[_0x3318e7(0x18d)]);break;}}}}if(_0x87fb05[_0x3318e7(0x1c7)]>0x0){const _0x20c08f=_0x3318e7(0x1b9)+_0x87fb05['length']+_0x3318e7(0x18a);if(window[_0x3318e7(0x1d8)](_0x20c08f))for(const _0x327094 of _0x87fb05){await lockNoti(_0x3318e7(0x1e8),_0x327094[_0x3318e7(0x1dd)],0xbb8),await dpDownloadFile(_0x327094[_0x3318e7(0x1dd)],_0x327094[_0x3318e7(0x1a9)]);}else console[_0x3318e7(0x19d)](_0x3318e7(0x1ef));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x28ff4b(0x18c)](_0x28ff4b(0x1a2),async function(){var _0x39860b=_0x28ff4b;await lockNoti(_0x39860b(0x1b3),'',0x1388);const _0x31cf76=localStorage['getItem'](_0x39860b(0x1e3));if(_0x31cf76===null||_0x31cf76==='')window[_0x39860b(0x1be)](_0x39860b(0x1c5));else{const _0x2eba5e=[_0x39860b(0x1d6),'save',_0x39860b(0x1cc)];for(const _0x4c883c of _0x2eba5e){await dpCreateFolder(_0x4c883c);}let _0x4dba4e=0x0;for(const _0x1f29f2 of _0x2eba5e){const _0x492f4b=a0_0x10b294[_0x39860b(0x195)+(_0x1f29f2[_0x39860b(0x18b)](0x0)['toUpperCase']()+_0x1f29f2['slice'](0x1))]();_0x4dba4e+=_0x492f4b['length'];}if(window[_0x39860b(0x1d8)](_0x39860b(0x1ae)+_0x4dba4e+_0x39860b(0x1ad)))for(const _0x5b9b8f of _0x2eba5e){const _0x385e36=a0_0x10b294['list'+(_0x5b9b8f[_0x39860b(0x18b)](0x0)[_0x39860b(0x1c3)]()+_0x5b9b8f[_0x39860b(0x1bc)](0x1))]();for(const _0x30d523 of _0x385e36){const _0xec3a26=await a0_0x10b294['downloadFileInCloud'](_0x39860b(0x1dc)+_0x5b9b8f+'s/'+_0x30d523);try{await lockNoti(_0x39860b(0x1d0),_0x30d523,0xbb8),await dpUploadFile(_0x30d523,_0xec3a26,_0x5b9b8f);}catch(_0x5e512b){console['error'](_0x39860b(0x1a5)+_0x30d523+':',_0x5e512b);}}}else console[_0x39860b(0x19d)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x28ff4b(0x18c)]('click',function(){var _0x4a7942=_0x28ff4b;const _0x683aec=localStorage[_0x4a7942(0x194)]('uId');_0x683aec===null||_0x683aec===''?authorizeWithDropbox():window[_0x4a7942(0x1d8)](_0x4a7942(0x1b8))&&(localStorage['setItem'](_0x4a7942(0x1e3),''),dropboxRestore[_0x4a7942(0x1bb)]['remove']('active'),dropboxBackup[_0x4a7942(0x1bb)][_0x4a7942(0x1af)](_0x4a7942(0x1b2)),dropboxCloud['classList'][_0x4a7942(0x1af)]('active'));}),handleDropboxCallback();});