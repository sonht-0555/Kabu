function a0_0x130c(_0xb5ca5d,_0x4f7875){var _0x2f59ea=a0_0x2f59();return a0_0x130c=function(_0x130cec,_0x5463a8){_0x130cec=_0x130cec-0xb6;var _0x457708=_0x2f59ea[_0x130cec];return _0x457708;},a0_0x130c(_0xb5ca5d,_0x4f7875);}var a0_0x1e6254=a0_0x130c;(function(_0x3bb25d,_0x44dbe7){var _0x3427cd=a0_0x130c,_0x4f9cd8=_0x3bb25d();while(!![]){try{var _0x340e38=parseInt(_0x3427cd(0x105))/0x1*(parseInt(_0x3427cd(0xb6))/0x2)+-parseInt(_0x3427cd(0xf7))/0x3*(parseInt(_0x3427cd(0xde))/0x4)+parseInt(_0x3427cd(0xf5))/0x5+parseInt(_0x3427cd(0x108))/0x6+-parseInt(_0x3427cd(0x104))/0x7+-parseInt(_0x3427cd(0xfb))/0x8+parseInt(_0x3427cd(0x10a))/0x9;if(_0x340e38===_0x44dbe7)break;else _0x4f9cd8['push'](_0x4f9cd8['shift']());}catch(_0x392ac4){_0x4f9cd8['push'](_0x4f9cd8['shift']());}}}(a0_0x2f59,0x92f1b));import*as a0_0x4d4e31 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1e6254(0xdf),clientSecret=a0_0x1e6254(0xbc);function authorizeWithDropbox(){var _0x265539=a0_0x1e6254,_0x4e2254=window[_0x265539(0xd9)]['href']['split']('?')[0x0],_0x97c401=_0x265539(0xf9),_0x31ac4d=_0x265539(0xea),_0x3a61ad='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x97c401+_0x265539(0x10e)+_0x31ac4d+_0x265539(0xf3)+encodeURIComponent(_0x4e2254);window[_0x265539(0xd9)]['href']=_0x3a61ad;}function a0_0x2f59(){var _0x23c100=['replace','2433424Fcxdml','328903iLFnCi','split','https://api.dropboxapi.com/2/files/create_folder_v2','2656374gnLSLJ','accessToken','3966462rejEHA','error_description','authorization_code','Authorization\x20Code:','&token_access_type=','remove','length','list','json','state','application/json','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20backup\x20','https://api.dropboxapi.com/oauth2/token','getItem','blob','Download\x20failed\x20for\x20','6mwJeYP','setItem','Cloud\x20login\x20required!','click','=([^&#]*)','refresh_token','nwb3dnfh09rhs31','filter','entries','downloadFileInCloud','refreshToken','Failed\x20to\x20upload\x20file\x20','application/octet-stream','file','search','responseText','save','stringify','.tag','slice','status','Download\x20failed,\x20unknown\x20http\x20status:','No\x20files\x20found\x20to\x20restore.','code=','Bearer\x20','map','exec','Wait\x20a\x20little\x20bit...','Unable\x20to\x20refresh\x20token','setRequestHeader','\x20files\x20from\x20Cloud?','&grant_type=','refresh_token=','Restoring...','access_token','location','open','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Error\x20while\x20refreshing\x20token:','Error\x20creating\x20folder\x20','916184ycEDAU','knh3uz2mx2hp2eu','https://content.dropboxapi.com/2/files/download','No\x20refresh\x20token','Folder\x20already\x20exists','log','DOMContentLoaded','name','Folder\x20created','addEventListener','onload','overwrite','offline','Do\x20you\x20want\x20to\x20restore\x20','active','uid','screenshot','confirm','alert','uploadFileInCloud','Kabu\x20storage\x20↦\x20Cloud\x20◆','&redirect_uri=','FSSync','1352655FYIbcf','uId','6wxwcbO','classList','code','POST','5864640aNZWZZ','toUpperCase','folder','error','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Refreshing\x20token...','Backing\x20up...','charAt'];a0_0x2f59=function(){return _0x23c100;};return a0_0x2f59();}function handleDropboxCallback(){var _0x49810d=a0_0x1e6254,_0x345582=getUrlParameter('code');_0x345582?(getAccessToken(_0x345582),console[_0x49810d(0xe3)](_0x49810d(0x10d),_0x345582)):console[_0x49810d(0xe3)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x3cdb67){var _0x5db155=a0_0x1e6254;_0x3cdb67=_0x3cdb67[_0x5db155(0x103)](/[\[]/,'\x5c[')[_0x5db155(0x103)](/[\]]/,'\x5c]');var _0xadee80=new RegExp('[\x5c?&#]'+_0x3cdb67+_0x5db155(0xba)),_0x4276ae=_0xadee80[_0x5db155(0xd0)](location[_0x5db155(0xc4)]);return _0x4276ae===null?'':decodeURIComponent(_0x4276ae[0x1][_0x5db155(0x103)](/\+/g,'\x20'));}function getAccessToken(_0x461f23){var _0x59a63d=a0_0x1e6254,_0x1ddc6a=_0x59a63d(0x10c),_0x4ad1c3=window['location']['href'][_0x59a63d(0x106)]('?')[0x0],_0x59b8ae=new XMLHttpRequest();_0x59b8ae[_0x59a63d(0xda)]('POST','https://api.dropbox.com/oauth2/token'),_0x59b8ae[_0x59a63d(0xd3)]('Content-Type',_0x59a63d(0x115)),_0x59b8ae[_0x59a63d(0xe8)]=function(){var _0x47b41a=_0x59a63d;if(_0x59b8ae['status']===0xc8){var _0x26e9bd=JSON['parse'](_0x59b8ae[_0x47b41a(0xc5)]),_0x187e8c=_0x26e9bd[_0x47b41a(0xd8)],_0x4b6fa1=_0x26e9bd[_0x47b41a(0xbb)],_0x303999=_0x26e9bd[_0x47b41a(0xed)];localStorage['setItem'](_0x47b41a(0x109),_0x187e8c),localStorage[_0x47b41a(0xb7)](_0x47b41a(0xc0),_0x4b6fa1),localStorage[_0x47b41a(0xb7)](_0x47b41a(0xf6),_0x303999);}else console[_0x47b41a(0xe3)](_0x47b41a(0xff));},_0x59b8ae['send'](_0x59a63d(0xcd)+_0x461f23+_0x59a63d(0xd5)+_0x1ddc6a+'&client_id='+clientId+'&client_secret='+clientSecret+_0x59a63d(0xf3)+encodeURIComponent(_0x4ad1c3));}export async function dpCreateFolder(_0x5e170b){var _0x5eb88c=a0_0x1e6254;const _0x106997=localStorage[_0x5eb88c(0x118)](_0x5eb88c(0xf6));let _0x336db7=localStorage[_0x5eb88c(0x118)](_0x5eb88c(0x109));const _0x10a6e4='/'+_0x106997+'/'+_0x5e170b,_0x1a5bc2=JSON[_0x5eb88c(0xc7)]({'path':_0x10a6e4,'autorename':![]});for(let _0x436276=0x0;_0x436276<0x2;_0x436276++){try{const _0x2e430c=await fetch(_0x5eb88c(0x107),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x336db7,'Content-Type':_0x5eb88c(0x114)},'body':_0x1a5bc2});if(_0x2e430c[_0x5eb88c(0xca)]===0x191){const _0x2c23e6=await dpRefreshToken();if(!_0x2c23e6)throw new Error(_0x5eb88c(0xd2));_0x336db7=localStorage['getItem'](_0x5eb88c(0x109));continue;}if(_0x2e430c[_0x5eb88c(0xca)]===0x199)return{'message':_0x5eb88c(0xe2),'path':_0x5e170b};if(!_0x2e430c['ok'])throw new Error(_0x5eb88c(0xdd)+_0x5e170b);const _0x13b228=await _0x2e430c['json']();return await lockNoti(_0x5eb88c(0xe6),'',0xbb8),_0x13b228;}catch(_0x3b3aa){if(_0x436276===0x1)throw _0x3b3aa;}}return![];}export async function dpRefreshToken(){var _0x3327e8=a0_0x1e6254;if(!localStorage[_0x3327e8(0x118)]('refreshToken'))throw _0x3327e8(0xe1);try{const _0x1fd023=await fetch(_0x3327e8(0x117),{'method':_0x3327e8(0xfa),'headers':{'Content-Type':_0x3327e8(0x115)},'body':_0x3327e8(0xd6)+localStorage[_0x3327e8(0x118)](_0x3327e8(0xc0))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x1fa7c7=await _0x1fd023[_0x3327e8(0x112)]();if(!_0x1fa7c7[_0x3327e8(0xfe)])return localStorage['setItem'](_0x3327e8(0x109),_0x1fa7c7[_0x3327e8(0xd8)]),await lockNoti(_0x3327e8(0x100),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1fa7c7[_0x3327e8(0x10b)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x356c00){console[_0x3327e8(0xfe)](_0x3327e8(0xdc),_0x356c00);}return![];}export async function dpUploadFile(_0x564d9c,_0x4ada4,_0x45939f){var _0x5dce08=a0_0x1e6254;const _0x16e2b9=localStorage[_0x5dce08(0x118)](_0x5dce08(0xf6));var _0x1e2789=JSON[_0x5dce08(0xc7)]({'autorename':!![],'mode':_0x5dce08(0xe9),'mute':!![],'strict_conflict':![],'path':'/'+_0x16e2b9+'/'+_0x45939f+'/'+_0x564d9c}),_0xa1cb5e=new Blob([_0x4ada4],{'type':_0x5dce08(0xc2)});for(var _0x11b370=0x0;_0x11b370<0x2;_0x11b370++){var _0x2a56be=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x5dce08(0xfa),'headers':{'Authorization':_0x5dce08(0xce)+localStorage[_0x5dce08(0x118)](_0x5dce08(0x109)),'Dropbox-API-Arg':_0x1e2789,'Content-Type':_0x5dce08(0xc2)},'body':_0xa1cb5e});if(_0x2a56be['status']!=0xc8){if(_0x2a56be['status']==0x191){var _0x387d69=await dpRefreshToken();if(!_0x387d69)throw _0x5dce08(0xd2);continue;}else throw _0x5dce08(0xdb)+_0x2a56be[_0x5dce08(0xca)];}else{var _0x5b96ab=await _0x2a56be['json']();return console['log'](_0x5dce08(0xf2),_0x564d9c),_0x5b96ab;}}return![];}export async function dpDownloadFile(_0x17933b,_0x59bf4a){var _0x218b69=a0_0x1e6254;const _0x4bdb9b=localStorage['getItem'](_0x218b69(0xf6));var _0x4c410b=JSON[_0x218b69(0xc7)]({'path':'/'+_0x4bdb9b+'/'+_0x59bf4a+'/'+_0x17933b});for(var _0x4694dd=0x0;_0x4694dd<0x2;_0x4694dd++){var _0xb9c9f4=await fetch(_0x218b69(0xe0),{'method':_0x218b69(0xfa),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x218b69(0x109)),'Dropbox-API-Arg':_0x4c410b}});if(_0xb9c9f4[_0x218b69(0xca)]!=0xc8){if(_0xb9c9f4['status']==0x191){var _0x22efe5=await dpRefreshToken();if(!_0x22efe5)throw _0x218b69(0xd2);continue;}else throw _0x218b69(0xcb)+_0xb9c9f4[_0x218b69(0xca)];}const _0x31ba1b=new File([await _0xb9c9f4[_0x218b69(0x119)]()],_0x17933b);return console[_0x218b69(0xe3)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x31ba1b[_0x218b69(0xe5)]),a0_0x4d4e31[_0x218b69(0xf1)](_0x31ba1b,()=>{var _0x2e2668=_0x218b69;localStorageFile(),Module[_0x2e2668(0xf4)]();}),_0x31ba1b;}return![];}document[a0_0x1e6254(0xe7)](a0_0x1e6254(0xe4),function(){var _0x49f6e4=a0_0x1e6254;dropboxRestore[_0x49f6e4(0xe7)](_0x49f6e4(0xb9),async function(){var _0x438387=_0x49f6e4;await lockNoti(_0x438387(0xd1),'',0x1388);const _0x55b3fe=localStorage[_0x438387(0x118)](_0x438387(0xf6)),_0x1f245f=[_0x438387(0x113),_0x438387(0xc6),_0x438387(0xee)];if(!_0x55b3fe){window[_0x438387(0xf0)](_0x438387(0xb8));return;}let _0xc59751=[];for(const _0x5967c6 of _0x1f245f){let _0x1ae725={'path':'/'+_0x55b3fe+'/'+_0x5967c6};for(let _0x3cabf1=0x0;_0x3cabf1<0x2;_0x3cabf1++){let _0x5f4a97=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x438387(0xfa),'headers':{'Authorization':_0x438387(0xce)+localStorage[_0x438387(0x118)]('accessToken'),'Content-Type':_0x438387(0x114)},'body':JSON[_0x438387(0xc7)](_0x1ae725)});if(_0x5f4a97[_0x438387(0xca)]===0xc8){let _0x2a9aa0=await _0x5f4a97[_0x438387(0x112)](),_0x360ac8=_0x2a9aa0[_0x438387(0xbe)][_0x438387(0xbd)](_0x14b270=>_0x14b270[_0x438387(0xc8)]===_0x438387(0xc3));_0x360ac8['length']>0x0&&_0xc59751['push'](..._0x360ac8[_0x438387(0xcf)](_0x3ab7f2=>({'name':_0x3ab7f2[_0x438387(0xe5)],'folder':_0x5967c6})));break;}else{if(_0x5f4a97[_0x438387(0xca)]===0x191){let _0x4dd158=await dpRefreshToken();if(!_0x4dd158)throw _0x438387(0xd2);}else{console[_0x438387(0xfe)](_0x438387(0x11a)+_0x5967c6+',\x20status:\x20'+_0x5f4a97[_0x438387(0xca)]);break;}}}}if(_0xc59751['length']>0x0){const _0x527098=_0x438387(0xeb)+_0xc59751[_0x438387(0x110)]+_0x438387(0xd4);if(window[_0x438387(0xef)](_0x527098))for(const _0x1d8645 of _0xc59751){await lockNoti(_0x438387(0xd7),_0x1d8645[_0x438387(0xe5)],0xbb8),await dpDownloadFile(_0x1d8645['name'],_0x1d8645[_0x438387(0xfd)]);}else console[_0x438387(0xe3)]('Restore\x20canceled\x20by\x20user.');}else console[_0x438387(0xe3)](_0x438387(0xcc));}),dropboxBackup[_0x49f6e4(0xe7)](_0x49f6e4(0xb9),async function(){var _0x16b233=_0x49f6e4;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0xf08149=localStorage[_0x16b233(0x118)]('uId');if(_0xf08149===null||_0xf08149==='')window[_0x16b233(0xf0)]('Cloud\x20login\x20required!');else{const _0x7fe6ca=[_0x16b233(0x113),_0x16b233(0xc6),'screenshot'];for(const _0x41877c of _0x7fe6ca){await dpCreateFolder(_0x41877c);}let _0x1c5be6=0x0;for(const _0x47024d of _0x7fe6ca){const _0x14e48a=a0_0x4d4e31[_0x16b233(0x111)+(_0x47024d[_0x16b233(0x102)](0x0)[_0x16b233(0xfc)]()+_0x47024d[_0x16b233(0xc9)](0x1))]();_0x1c5be6+=_0x14e48a[_0x16b233(0x110)];}if(window[_0x16b233(0xef)](_0x16b233(0x116)+_0x1c5be6+'\x20files\x20in\x20Kabu?'))for(const _0x360466 of _0x7fe6ca){const _0x24deba=a0_0x4d4e31['list'+(_0x360466[_0x16b233(0x102)](0x0)[_0x16b233(0xfc)]()+_0x360466[_0x16b233(0xc9)](0x1))]();for(const _0x10d240 of _0x24deba){const _0x330568=await a0_0x4d4e31[_0x16b233(0xbf)]('/data/'+_0x360466+'s/'+_0x10d240);try{await lockNoti(_0x16b233(0x101),_0x10d240,0xbb8),await dpUploadFile(_0x10d240,_0x330568,_0x360466);}catch(_0x401cb8){console['error'](_0x16b233(0xc1)+_0x10d240+':',_0x401cb8);}}}else console[_0x16b233(0xe3)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x49f6e4(0xe7)](_0x49f6e4(0xb9),function(){var _0x35da5c=_0x49f6e4;const _0x18631d=localStorage['getItem'](_0x35da5c(0xf6));_0x18631d===null||_0x18631d===''?authorizeWithDropbox():window[_0x35da5c(0xef)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x35da5c(0xf6),''),dropboxRestore[_0x35da5c(0xf8)]['remove'](_0x35da5c(0xec)),dropboxBackup[_0x35da5c(0xf8)]['remove'](_0x35da5c(0xec)),dropboxCloud[_0x35da5c(0xf8)][_0x35da5c(0x10f)](_0x35da5c(0xec)));}),handleDropboxCallback();});