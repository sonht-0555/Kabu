var a0_0x36edbd=a0_0x46c7;function a0_0x46c7(_0x106904,_0x33869f){var _0x320b0d=a0_0x320b();return a0_0x46c7=function(_0x46c71b,_0x4ac963){_0x46c71b=_0x46c71b-0x1a9;var _0x351319=_0x320b0d[_0x46c71b];return _0x351319;},a0_0x46c7(_0x106904,_0x33869f);}(function(_0x3cf451,_0xe920e0){var _0x19b3c4=a0_0x46c7,_0x4e645a=_0x3cf451();while(!![]){try{var _0x38c6bf=parseInt(_0x19b3c4(0x1ee))/0x1+-parseInt(_0x19b3c4(0x1e0))/0x2*(parseInt(_0x19b3c4(0x1c4))/0x3)+parseInt(_0x19b3c4(0x1d0))/0x4*(parseInt(_0x19b3c4(0x20b))/0x5)+parseInt(_0x19b3c4(0x1d1))/0x6+parseInt(_0x19b3c4(0x1e7))/0x7+parseInt(_0x19b3c4(0x1fe))/0x8*(-parseInt(_0x19b3c4(0x1da))/0x9)+-parseInt(_0x19b3c4(0x1b1))/0xa;if(_0x38c6bf===_0xe920e0)break;else _0x4e645a['push'](_0x4e645a['shift']());}catch(_0x3daf72){_0x4e645a['push'](_0x4e645a['shift']());}}}(a0_0x320b,0x32e6d));import*as a0_0x8854f0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x36edbd(0x20a),clientSecret=a0_0x36edbd(0x1de);function authorizeWithDropbox(){var _0x23121c=a0_0x36edbd,_0xa38a46=window[_0x23121c(0x1ad)][_0x23121c(0x1d9)][_0x23121c(0x1ce)]('?')[0x0],_0x528000=_0x23121c(0x1bc),_0x468ac5='offline',_0x466d60=_0x23121c(0x1d6)+clientId+_0x23121c(0x20e)+_0x528000+'&token_access_type='+_0x468ac5+_0x23121c(0x1c0)+encodeURIComponent(_0xa38a46);window[_0x23121c(0x1ad)][_0x23121c(0x1d9)]=_0x466d60;}function handleDropboxCallback(){var _0x2d5334=a0_0x36edbd,_0x419843=getUrlParameter(_0x2d5334(0x1bc));_0x419843?(getAccessToken(_0x419843),console[_0x2d5334(0x200)](_0x2d5334(0x1f4),_0x419843)):console[_0x2d5334(0x200)](_0x2d5334(0x212));}function getUrlParameter(_0x15071d){var _0x4fe39a=a0_0x36edbd;_0x15071d=_0x15071d[_0x4fe39a(0x1af)](/[\[]/,'\x5c[')[_0x4fe39a(0x1af)](/[\]]/,'\x5c]');var _0x123950=new RegExp('[\x5c?&#]'+_0x15071d+_0x4fe39a(0x1e9)),_0x14f708=_0x123950['exec'](location[_0x4fe39a(0x208)]);return _0x14f708===null?'':decodeURIComponent(_0x14f708[0x1][_0x4fe39a(0x1af)](/\+/g,'\x20'));}function getAccessToken(_0x1f3d7b){var _0x210b29=a0_0x36edbd,_0x2cca26=_0x210b29(0x1b7),_0x2d221d=window[_0x210b29(0x1ad)][_0x210b29(0x1d9)][_0x210b29(0x1ce)]('?')[0x0],_0x46c48e=new XMLHttpRequest();_0x46c48e[_0x210b29(0x1ff)](_0x210b29(0x1e5),_0x210b29(0x1b6)),_0x46c48e[_0x210b29(0x1c3)](_0x210b29(0x1e4),_0x210b29(0x1ec)),_0x46c48e[_0x210b29(0x1fb)]=function(){var _0x22f59d=_0x210b29;if(_0x46c48e['status']===0xc8){var _0x201777=JSON[_0x22f59d(0x1dc)](_0x46c48e[_0x22f59d(0x1ac)]),_0x427dc7=_0x201777[_0x22f59d(0x1bd)],_0x1f11fe=_0x201777[_0x22f59d(0x1c1)],_0x3b2f69=_0x201777[_0x22f59d(0x1df)];localStorage[_0x22f59d(0x1e6)]('accessToken',_0x427dc7),localStorage['setItem']('refreshToken',_0x1f11fe),localStorage['setItem'](_0x22f59d(0x205),_0x3b2f69);}else console[_0x22f59d(0x200)](_0x22f59d(0x1ab));},_0x46c48e[_0x210b29(0x1e1)](_0x210b29(0x1b5)+_0x1f3d7b+_0x210b29(0x1b9)+_0x2cca26+_0x210b29(0x1c6)+clientId+_0x210b29(0x1fa)+clientSecret+_0x210b29(0x1c0)+encodeURIComponent(_0x2d221d));}export async function dpCreateFolder(_0x477ba7){var _0x192243=a0_0x36edbd;const _0x53d6a5=localStorage['getItem'](_0x192243(0x205));let _0x43ee16=localStorage[_0x192243(0x1e3)](_0x192243(0x204));const _0x2ee95b='/'+_0x53d6a5+'/'+_0x477ba7,_0xe1f31b=JSON[_0x192243(0x1d8)]({'path':_0x2ee95b,'autorename':![]});for(let _0x4dac83=0x0;_0x4dac83<0x2;_0x4dac83++){try{const _0x35fe9d=await fetch(_0x192243(0x1eb),{'method':_0x192243(0x1e5),'headers':{'Authorization':'Bearer\x20'+_0x43ee16,'Content-Type':_0x192243(0x1c7)},'body':_0xe1f31b});if(_0x35fe9d[_0x192243(0x1f2)]===0x191){const _0x366539=await dpRefreshToken();if(!_0x366539)throw new Error(_0x192243(0x1ba));_0x43ee16=localStorage[_0x192243(0x1e3)]('accessToken');continue;}if(_0x35fe9d[_0x192243(0x1f2)]===0x199)return{'message':_0x192243(0x1f3),'path':_0x477ba7};if(!_0x35fe9d['ok'])throw new Error(_0x192243(0x1d3)+_0x477ba7);const _0xed4471=await _0x35fe9d[_0x192243(0x209)]();return await lockNoti(_0x192243(0x1fc),'',0xbb8),_0xed4471;}catch(_0x50d918){if(_0x4dac83===0x1)throw _0x50d918;}}return![];}export async function dpRefreshToken(){var _0x1a2176=a0_0x36edbd;if(!localStorage[_0x1a2176(0x1e3)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x11abfa=await fetch(_0x1a2176(0x1ef),{'method':_0x1a2176(0x1e5),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x1a2176(0x1f7)+localStorage[_0x1a2176(0x1e3)]('refreshToken')+_0x1a2176(0x20d)}),_0x5a7501=await _0x11abfa['json']();if(!_0x5a7501[_0x1a2176(0x1c9)])return localStorage[_0x1a2176(0x1e6)]('accessToken',_0x5a7501[_0x1a2176(0x1bd)]),await lockNoti(_0x1a2176(0x1cb),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5a7501['error_description']||_0x1a2176(0x1c5));}catch(_0x57aa61){console['error']('Error\x20while\x20refreshing\x20token:',_0x57aa61);}return![];}export async function dpUploadFile(_0x49d067,_0x351bc1,_0x42dd00){var _0x3a2282=a0_0x36edbd;const _0xc6f650=localStorage[_0x3a2282(0x1e3)](_0x3a2282(0x205));var _0x58ca47=JSON[_0x3a2282(0x1d8)]({'autorename':!![],'mode':_0x3a2282(0x206),'mute':!![],'strict_conflict':![],'path':'/'+_0xc6f650+'/'+_0x42dd00+'/'+_0x49d067}),_0x36ca95=new Blob([_0x351bc1],{'type':_0x3a2282(0x1b3)});for(var _0x1e9aaf=0x0;_0x1e9aaf<0x2;_0x1e9aaf++){var _0x1e047e=await fetch(_0x3a2282(0x203),{'method':_0x3a2282(0x1e5),'headers':{'Authorization':_0x3a2282(0x1d5)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x58ca47,'Content-Type':_0x3a2282(0x1b3)},'body':_0x36ca95});if(_0x1e047e[_0x3a2282(0x1f2)]!=0xc8){if(_0x1e047e[_0x3a2282(0x1f2)]==0x191){var _0x290212=await dpRefreshToken();if(!_0x290212)throw _0x3a2282(0x1ba);continue;}else throw _0x3a2282(0x1f1)+_0x1e047e[_0x3a2282(0x1f2)];}else{var _0x41b1a8=await _0x1e047e[_0x3a2282(0x209)]();return console[_0x3a2282(0x200)](_0x3a2282(0x1be),_0x49d067),_0x41b1a8;}}return![];}export async function dpDownloadFile(_0x3dfcf7,_0x21fd7c){var _0x40a0a1=a0_0x36edbd;const _0xfcf703=localStorage[_0x40a0a1(0x1e3)](_0x40a0a1(0x205));var _0x32a50b=JSON[_0x40a0a1(0x1d8)]({'path':'/'+_0xfcf703+'/'+_0x21fd7c+'/'+_0x3dfcf7});for(var _0x312e2b=0x0;_0x312e2b<0x2;_0x312e2b++){var _0x39c796=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x40a0a1(0x1e5),'headers':{'Authorization':_0x40a0a1(0x1d5)+localStorage['getItem'](_0x40a0a1(0x204)),'Dropbox-API-Arg':_0x32a50b}});if(_0x39c796[_0x40a0a1(0x1f2)]!=0xc8){if(_0x39c796[_0x40a0a1(0x1f2)]==0x191){var _0x4c9b2f=await dpRefreshToken();if(!_0x4c9b2f)throw _0x40a0a1(0x1ba);continue;}else throw _0x40a0a1(0x1dd)+_0x39c796[_0x40a0a1(0x1f2)];}const _0x19ed85=new File([await _0x39c796[_0x40a0a1(0x1d2)]()],_0x3dfcf7);return console['log']('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x19ed85[_0x40a0a1(0x20f)]),a0_0x8854f0[_0x40a0a1(0x1e8)](_0x19ed85,()=>{}),_0x19ed85;}return![];}function a0_0x320b(){var _0x6d133d=['Refreshing\x20token...','length','save','split','Restoring...','144832HypoRZ','2035158HSEOEz','blob','Error\x20creating\x20folder\x20','classList','Bearer\x20','https://www.dropbox.com/oauth2/authorize?client_id=','.tag','stringify','href','585fxBAlb','No\x20files\x20found\x20to\x20restore.','parse','Download\x20failed,\x20unknown\x20http\x20status:','nwb3dnfh09rhs31','uid','100SjKWgb','send','Cloud\x20login\x20required!','getItem','Content-Type','POST','setItem','1577611wsMWYW','uploadFileInCloud','=([^&#]*)','entries','https://api.dropboxapi.com/2/files/create_folder_v2','application/x-www-form-urlencoded','/data/','50311sHCuXk','https://api.dropboxapi.com/oauth2/token','Do\x20you\x20want\x20to\x20logout?','Upload\x20failed,\x20unknown\x20http\x20status:\x20','status','Folder\x20already\x20exists','Authorization\x20Code:','file','listFiles','refresh_token=','filter','click','&client_secret=','onload','Folder\x20created','Wait\x20a\x20little\x20bit...','12464YLkCpW','open','log','Do\x20you\x20want\x20to\x20restore\x20','https://api.dropboxapi.com/2/files/list_folder','https://content.dropboxapi.com/2/files/upload','accessToken','uId','overwrite','alert','search','json','knh3uz2mx2hp2eu','40GntyCp','\x20files\x20from\x20Cloud?','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','&response_type=','name','downloadFileInCloud','folder','Do\x20not\x20receive\x20authorization','screenshot','state','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','responseText','location','confirm','replace','addEventListener','4014280uPcPZO','Backing\x20up...','application/octet-stream','\x20files\x20in\x20Kabu?','code=','https://api.dropbox.com/oauth2/token','authorization_code','DOMContentLoaded','&grant_type=','Unable\x20to\x20refresh\x20token','Restore\x20canceled\x20by\x20user.','code','access_token','Kabu\x20storage\x20↦\x20Cloud\x20◆','push','&redirect_uri=','refresh_token','active','setRequestHeader','11601lzLlgi','Failed\x20to\x20refresh\x20Dropbox\x20token.','&client_id=','application/json','remove','error','Failed\x20to\x20upload\x20file\x20'];a0_0x320b=function(){return _0x6d133d;};return a0_0x320b();}document[a0_0x36edbd(0x1b0)](a0_0x36edbd(0x1b8),function(){var _0x570f7b=a0_0x36edbd;dropboxRestore[_0x570f7b(0x1b0)](_0x570f7b(0x1f9),async function(){var _0x3067a9=_0x570f7b;await lockNoti(_0x3067a9(0x1fd),'',0x1388);const _0x457aa4=localStorage[_0x3067a9(0x1e3)](_0x3067a9(0x205)),_0x241c4e=[_0x3067a9(0x1aa),_0x3067a9(0x1cd),_0x3067a9(0x1a9)];if(!_0x457aa4){window['alert'](_0x3067a9(0x1e2));return;}let _0x5451b9=[];for(const _0x35bf37 of _0x241c4e){let _0xe04db={'path':'/'+_0x457aa4+'/'+_0x35bf37};for(let _0x31490d=0x0;_0x31490d<0x2;_0x31490d++){let _0x246836=await fetch(_0x3067a9(0x202),{'method':'POST','headers':{'Authorization':_0x3067a9(0x1d5)+localStorage[_0x3067a9(0x1e3)](_0x3067a9(0x204)),'Content-Type':_0x3067a9(0x1c7)},'body':JSON['stringify'](_0xe04db)});if(_0x246836[_0x3067a9(0x1f2)]===0xc8){let _0x3541d3=await _0x246836[_0x3067a9(0x209)](),_0x365f5c=_0x3541d3[_0x3067a9(0x1ea)][_0x3067a9(0x1f8)](_0x5ea2c7=>_0x5ea2c7[_0x3067a9(0x1d7)]===_0x3067a9(0x1f5));_0x365f5c[_0x3067a9(0x1cc)]>0x0&&_0x5451b9[_0x3067a9(0x1bf)](..._0x365f5c['map'](_0x2999a2=>({'name':_0x2999a2[_0x3067a9(0x20f)],'folder':_0x35bf37})));break;}else{if(_0x246836[_0x3067a9(0x1f2)]===0x191){let _0x31fbde=await dpRefreshToken();if(!_0x31fbde)throw _0x3067a9(0x1ba);}else{console[_0x3067a9(0x1c9)]('Download\x20failed\x20for\x20'+_0x35bf37+',\x20status:\x20'+_0x246836[_0x3067a9(0x1f2)]);break;}}}}if(_0x5451b9['length']>0x0){const _0x18c37c=_0x3067a9(0x201)+_0x5451b9[_0x3067a9(0x1cc)]+_0x3067a9(0x20c);if(window[_0x3067a9(0x1ae)](_0x18c37c))for(const _0x5ae24e of _0x5451b9){await lockNoti(_0x3067a9(0x1cf),_0x5ae24e['name'],0xbb8),await dpDownloadFile(_0x5ae24e['name'],_0x5ae24e[_0x3067a9(0x211)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x3067a9(0x200)](_0x3067a9(0x1db));}),dropboxBackup['addEventListener'](_0x570f7b(0x1f9),async function(){var _0x1d091b=_0x570f7b;await lockNoti(_0x1d091b(0x1fd),'',0x1388);const _0x48d597=localStorage['getItem'](_0x1d091b(0x205));if(_0x48d597===null||_0x48d597==='')window[_0x1d091b(0x207)](_0x1d091b(0x1e2));else{const _0x1a54c8=['state',_0x1d091b(0x1cd),_0x1d091b(0x1a9)];for(const _0x430dd5 of _0x1a54c8){await dpCreateFolder(_0x430dd5);}let _0x3714de=0x0;for(const _0x3d390f of _0x1a54c8){const _0x570339=a0_0x8854f0[_0x1d091b(0x1f6)](_0x3d390f+'s');_0x3714de+=_0x570339[_0x1d091b(0x1cc)];}if(window[_0x1d091b(0x1ae)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x3714de+_0x1d091b(0x1b4)))for(const _0x5205b0 of _0x1a54c8){const _0x3c90cb=a0_0x8854f0[_0x1d091b(0x1f6)](_0x5205b0+'s');for(const _0x38bd22 of _0x3c90cb){const _0x93768c=await a0_0x8854f0[_0x1d091b(0x210)](_0x1d091b(0x1ed)+_0x5205b0+'s/'+_0x38bd22);try{await lockNoti(_0x1d091b(0x1b2),_0x38bd22,0xbb8),await dpUploadFile(_0x38bd22,_0x93768c,_0x5205b0);}catch(_0x3a0369){console[_0x1d091b(0x1c9)](_0x1d091b(0x1ca)+_0x38bd22+':',_0x3a0369);}}}else console['log'](_0x1d091b(0x1bb));}}),dropboxCloud[_0x570f7b(0x1b0)](_0x570f7b(0x1f9),function(){var _0x172912=_0x570f7b;const _0x35d8de=localStorage[_0x172912(0x1e3)](_0x172912(0x205));_0x35d8de===null||_0x35d8de===''?authorizeWithDropbox():window[_0x172912(0x1ae)](_0x172912(0x1f0))&&(localStorage[_0x172912(0x1e6)](_0x172912(0x205),''),dropboxRestore['classList'][_0x172912(0x1c8)](_0x172912(0x1c2)),dropboxBackup[_0x172912(0x1d4)][_0x172912(0x1c8)](_0x172912(0x1c2)),dropboxCloud[_0x172912(0x1d4)][_0x172912(0x1c8)](_0x172912(0x1c2)));}),handleDropboxCallback();});