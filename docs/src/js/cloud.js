function a0_0x5a44(){var _0x2fdb29=['refresh_token','replace','exec','Unable\x20to\x20refresh\x20token','active','177640kEdxLN','Cloud\x20login\x20required!','4631EpKeKY','.ss5','error','Do\x20not\x20receive\x20authorization','.gba_slot','application/octet-stream','10PNZSvI','status','2373040eiVEBo','getItem','overwrite','responseText','addEventListener','553464SsqJaI','location','2208UPErFh','parse','.ss4','.txt','[\x5c?&#]','Do\x20you\x20want\x20to\x20backup\x20','state','.ss3','Failed\x20to\x20refresh\x20Dropbox\x20token.','filter','.gba_dateState','code','Restore\x20canceled\x20by\x20user.','nwb3dnfh09rhs31','895bHmvoo','href','knh3uz2mx2hp2eu','Error\x20while\x20refreshing\x20token:','Bearer\x20','alert','refreshToken','application/json','Content-Type','stringify','entries','substring','downloadFileInCloud','text','POST','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','882119eFEvKr','uId','/data/','&client_secret=','Backing\x20up...','_imageState','onload','confirm','endsWith','&grant_type=','Authorization\x20Code:','.ss7','click','&client_id=','save','accessToken','toUpperCase','.tag','remove','&response_type=','uploadSaveOrSaveState','=([^&#]*)','Upload\x20failed,\x20unknown\x20http\x20status:\x20','18bQSpQp','access_token','Restoring...','gba','Do\x20you\x20want\x20to\x20logout?','lastIndexOf','list','split','authorization_code','No\x20refresh\x20token','&token_access_type=','charAt','log','text/plain','386RudkvK','Kabu\x20storage\x20↦\x20Cloud\x20◆','\x20files\x20in\x20Cloud?','3yIgeUm','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropboxapi.com/2/files/list_folder','classList','Failed\x20to\x20upload\x20file\x20','application/x-www-form-urlencoded','.ss6','setItem','offline','json','length','name','423438soUJUX','slice','https://www.dropbox.com/oauth2/authorize?client_id=','file'];a0_0x5a44=function(){return _0x2fdb29;};return a0_0x5a44();}var a0_0x34283c=a0_0x43f1;(function(_0x17b373,_0x25bde1){var _0x59a438=a0_0x43f1,_0xdfc4c4=_0x17b373();while(!![]){try{var _0x33e690=parseInt(_0x59a438(0x218))/0x1*(-parseInt(_0x59a438(0x1e1))/0x2)+parseInt(_0x59a438(0x1e4))/0x3*(parseInt(_0x59a438(0x208))/0x4)+-parseInt(_0x59a438(0x201))/0x5*(-parseInt(_0x59a438(0x1f0))/0x6)+-parseInt(_0x59a438(0x1bc))/0x7+parseInt(_0x59a438(0x203))/0x8+-parseInt(_0x59a438(0x1d3))/0x9*(parseInt(_0x59a438(0x1f9))/0xa)+-parseInt(_0x59a438(0x1fb))/0xb*(parseInt(_0x59a438(0x20a))/0xc);if(_0x33e690===_0x25bde1)break;else _0xdfc4c4['push'](_0xdfc4c4['shift']());}catch(_0x2550d3){_0xdfc4c4['push'](_0xdfc4c4['shift']());}}}(a0_0x5a44,0x2822e));import*as a0_0x97f356 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x34283c(0x21a),clientSecret=a0_0x34283c(0x217);function authorizeWithDropbox(){var _0xf91d60=a0_0x34283c,_0xafd93=window[_0xf91d60(0x209)][_0xf91d60(0x219)][_0xf91d60(0x1da)]('?')[0x0],_0x491f9e=_0xf91d60(0x215),_0x55f798=_0xf91d60(0x1ec),_0x142633=_0xf91d60(0x1f2)+clientId+_0xf91d60(0x1cf)+_0x491f9e+_0xf91d60(0x1dd)+_0x55f798+'&redirect_uri='+encodeURIComponent(_0xafd93);window[_0xf91d60(0x209)][_0xf91d60(0x219)]=_0x142633;}function handleDropboxCallback(){var _0x5980bd=a0_0x34283c,_0x487376=getUrlParameter('code');_0x487376?(getAccessToken(_0x487376),console[_0x5980bd(0x1df)](_0x5980bd(0x1c6),_0x487376)):console['log'](_0x5980bd(0x1fe));}function getUrlParameter(_0x363b7d){var _0x571d54=a0_0x34283c;_0x363b7d=_0x363b7d[_0x571d54(0x1f5)](/[\[]/,'\x5c[')[_0x571d54(0x1f5)](/[\]]/,'\x5c]');var _0x4f5cae=new RegExp(_0x571d54(0x20e)+_0x363b7d+_0x571d54(0x1d1)),_0x464ca1=_0x4f5cae[_0x571d54(0x1f6)](location['search']);return _0x464ca1===null?'':decodeURIComponent(_0x464ca1[0x1][_0x571d54(0x1f5)](/\+/g,'\x20'));}function getAccessToken(_0x264d1a){var _0x4ed6ac=a0_0x34283c,_0xb3e765=_0x4ed6ac(0x1db),_0x16b20a=window[_0x4ed6ac(0x209)][_0x4ed6ac(0x219)][_0x4ed6ac(0x1da)]('?')[0x0],_0x1d8df2=new XMLHttpRequest();_0x1d8df2['open'](_0x4ed6ac(0x226),'https://api.dropbox.com/oauth2/token'),_0x1d8df2['setRequestHeader'](_0x4ed6ac(0x220),_0x4ed6ac(0x1e9)),_0x1d8df2[_0x4ed6ac(0x1c2)]=function(){var _0x13ec7d=_0x4ed6ac;if(_0x1d8df2[_0x13ec7d(0x202)]===0xc8){var _0x5eb7ec=JSON[_0x13ec7d(0x20b)](_0x1d8df2[_0x13ec7d(0x206)]),_0x48f285=_0x5eb7ec['access_token'],_0x429aee=_0x5eb7ec[_0x13ec7d(0x1f4)],_0x1dc11f=_0x5eb7ec['uid'];localStorage[_0x13ec7d(0x1eb)](_0x13ec7d(0x1cb),_0x48f285),localStorage[_0x13ec7d(0x1eb)](_0x13ec7d(0x21e),_0x429aee),localStorage['setItem'](_0x13ec7d(0x1bd),_0x1dc11f);}else console[_0x13ec7d(0x1df)](_0x13ec7d(0x1e5));},_0x1d8df2['send']('code='+_0x264d1a+_0x4ed6ac(0x1c5)+_0xb3e765+_0x4ed6ac(0x1c9)+clientId+_0x4ed6ac(0x1bf)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x16b20a));}export async function dpRefreshToken(){var _0x3f4848=a0_0x34283c;if(!localStorage['getItem'](_0x3f4848(0x21e)))throw _0x3f4848(0x1dc);try{const _0x210de9=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x3f4848(0x1e9)},'body':'refresh_token='+localStorage[_0x3f4848(0x204)](_0x3f4848(0x21e))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x20ccb8=await _0x210de9[_0x3f4848(0x1ed)]();if(!_0x20ccb8[_0x3f4848(0x1fd)])return localStorage[_0x3f4848(0x1eb)](_0x3f4848(0x1cb),_0x20ccb8[_0x3f4848(0x1d4)]),await lockNoti('',_0x3f4848(0x227),0xbb8),await delay(0x3e8),!![];else alert(_0x20ccb8['error_description']||_0x3f4848(0x212));}catch(_0xcd46fb){console[_0x3f4848(0x1fd)](_0x3f4848(0x21b),_0xcd46fb);}return![];}export async function dpUploadFile(_0xe550f9,_0x29cd56){var _0x4343ec=a0_0x34283c;const _0x42d35a=localStorage[_0x4343ec(0x204)](_0x4343ec(0x1bd));var _0x444123=JSON['stringify']({'autorename':!![],'mode':_0x4343ec(0x205),'mute':!![],'strict_conflict':![],'path':'/'+_0x42d35a+'/'+_0xe550f9}),_0x13d32c=new Blob([_0x29cd56],{'type':_0x4343ec(0x200)});for(var _0x54969d=0x0;_0x54969d<0x2;_0x54969d++){var _0x100cb4=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x4343ec(0x226),'headers':{'Authorization':_0x4343ec(0x21c)+localStorage[_0x4343ec(0x204)]('accessToken'),'Dropbox-API-Arg':_0x444123,'Content-Type':_0x4343ec(0x200)},'body':_0x13d32c});if(_0x100cb4[_0x4343ec(0x202)]!=0xc8){if(_0x100cb4[_0x4343ec(0x202)]==0x191){var _0x318796=await dpRefreshToken();if(!_0x318796)throw _0x4343ec(0x1f7);continue;}else throw _0x4343ec(0x1d2)+_0x100cb4[_0x4343ec(0x202)];}else{var _0x3d3534=await _0x100cb4[_0x4343ec(0x1ed)]();return console[_0x4343ec(0x1df)](_0x4343ec(0x1e2),_0xe550f9),_0x3d3534;}}return![];}async function dpDownloadFile(_0x11aaa2){var _0x130316=a0_0x34283c;const _0xeeca58=localStorage['getItem'](_0x130316(0x1bd));var _0x4ba8f0=JSON[_0x130316(0x221)]({'path':'/'+_0xeeca58+'/'+_0x11aaa2});for(var _0x23f47c=0x0;_0x23f47c<0x2;_0x23f47c++){var _0x34831d=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x130316(0x21c)+localStorage['getItem'](_0x130316(0x1cb)),'Dropbox-API-Arg':_0x4ba8f0}});if(_0x34831d[_0x130316(0x202)]!=0xc8){if(_0x34831d[_0x130316(0x202)]==0x191){var _0x396266=await dpRefreshToken();if(!_0x396266)throw _0x130316(0x1f7);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x34831d[_0x130316(0x202)];}const _0x57fa33=new File([await _0x34831d['blob']()],_0x11aaa2);console[_0x130316(0x1df)](_0x130316(0x228),_0x57fa33['name']);if(_0x11aaa2[_0x130316(0x1c4)](_0x130316(0x20d))){const _0x15f2b3=await _0x57fa33[_0x130316(0x225)](),[_0x122dc3,_0x1a4923]=_0x15f2b3[_0x130316(0x1da)]('\x0a\x0a'),_0x2a692e=_0x11aaa2[_0x130316(0x223)](0x0,_0x11aaa2['lastIndexOf'](_0x130316(0x1d6))+0x3),_0x2318bf=_0x11aaa2[_0x130316(0x1de)](_0x11aaa2['length']-0x5);localStorage[_0x130316(0x1eb)](_0x2a692e+'_dateState'+_0x2318bf,_0x1a4923),localStorage['setItem'](_0x2a692e+_0x130316(0x1c1)+_0x2318bf,_0x122dc3);}else a0_0x97f356[_0x130316(0x1d0)](_0x57fa33,()=>{localStorageFile(),Module['FSSync']();});return _0x57fa33;}return![];}function a0_0x43f1(_0x4fe821,_0x21c33f){var _0x5a442d=a0_0x5a44();return a0_0x43f1=function(_0x43f187,_0xfe408c){_0x43f187=_0x43f187-0x1bc;var _0x3e444b=_0x5a442d[_0x43f187];return _0x3e444b;},a0_0x43f1(_0x4fe821,_0x21c33f);}document['addEventListener']('DOMContentLoaded',function(){var _0x4ecc79=a0_0x34283c;dropboxRestore[_0x4ecc79(0x207)](_0x4ecc79(0x1c8),async function(){var _0x458f04=_0x4ecc79;const _0x14b32a=localStorage[_0x458f04(0x204)](_0x458f04(0x1bd));if(_0x14b32a===null||_0x14b32a==='')window['alert']('Cloud\x20login\x20required!');else{var _0x47349f={'path':'/'+_0x14b32a};for(var _0x205ec8=0x0;_0x205ec8<0x2;_0x205ec8++){var _0x1924e5=await fetch(_0x458f04(0x1e6),{'method':_0x458f04(0x226),'headers':{'Authorization':_0x458f04(0x21c)+localStorage[_0x458f04(0x204)](_0x458f04(0x1cb)),'Content-Type':_0x458f04(0x21f)},'body':JSON[_0x458f04(0x221)](_0x47349f)});console['log']('status:\x20',_0x1924e5[_0x458f04(0x202)]);if(_0x1924e5[_0x458f04(0x202)]!=0xc8){if(_0x1924e5[_0x458f04(0x202)]==0x191){var _0x6ba8e5=await dpRefreshToken();if(!_0x6ba8e5)throw _0x458f04(0x1f7);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1924e5[_0x458f04(0x202)];}else{const _0x37324e=await _0x1924e5[_0x458f04(0x1ed)](),_0x140fff=_0x37324e[_0x458f04(0x222)][_0x458f04(0x213)](_0x21ff76=>_0x21ff76[_0x458f04(0x1cd)]===_0x458f04(0x1f3))[_0x458f04(0x1ee)],_0x51ba4c='Do\x20you\x20want\x20to\x20restore\x20'+_0x140fff+_0x458f04(0x1e3);if(window[_0x458f04(0x1c3)](_0x51ba4c))for(const _0x4e5a96 of _0x37324e[_0x458f04(0x222)]){_0x4e5a96['.tag']==='file'&&(await lockNoti(_0x458f04(0x1d5),_0x4e5a96['name'],0xbb8),await dpDownloadFile(_0x4e5a96[_0x458f04(0x1ef)]));}else console[_0x458f04(0x1df)](_0x458f04(0x216));return!![];}}return![];}}),dropboxBackup['addEventListener'](_0x4ecc79(0x1c8),async function(){var _0x30b477=_0x4ecc79;const _0x1c23da=localStorage[_0x30b477(0x204)]('uId');if(_0x1c23da===null||_0x1c23da==='')window[_0x30b477(0x21d)](_0x30b477(0x1fa));else{const _0x1e5c9c=[_0x30b477(0x210),_0x30b477(0x1ca)];let _0x43f49b=0x0;for(const _0x29e0a1 of _0x1e5c9c){const _0x2411b6=a0_0x97f356[_0x30b477(0x1d9)+(_0x29e0a1['charAt'](0x0)['toUpperCase']()+_0x29e0a1['slice'](0x1))]();_0x43f49b+=_0x2411b6[_0x30b477(0x1ee)];}if(window[_0x30b477(0x1c3)](_0x30b477(0x20f)+_0x43f49b+'\x20files\x20in\x20Kabu?'))for(const _0x3cce84 of _0x1e5c9c){const _0x2f7215=a0_0x97f356[_0x30b477(0x1d9)+(_0x3cce84['charAt'](0x0)[_0x30b477(0x1cc)]()+_0x3cce84[_0x30b477(0x1f1)](0x1))]();for(const _0x27d531 of _0x2f7215){const _0x240347=await a0_0x97f356[_0x30b477(0x224)](_0x30b477(0x1be)+_0x3cce84+'s/'+_0x27d531);try{await lockNoti(_0x30b477(0x1c0),_0x27d531,0xbb8),await dpUploadFile(_0x27d531,_0x240347);if(_0x27d531[_0x30b477(0x1c4)]('.ss0')||_0x27d531['endsWith']('.ss1')||_0x27d531[_0x30b477(0x1c4)]('.ss2')||_0x27d531['endsWith'](_0x30b477(0x211))||_0x27d531[_0x30b477(0x1c4)](_0x30b477(0x20c))||_0x27d531[_0x30b477(0x1c4)](_0x30b477(0x1fc))||_0x27d531[_0x30b477(0x1c4)](_0x30b477(0x1ea))||_0x27d531[_0x30b477(0x1c4)](_0x30b477(0x1c7))){const _0x2b821b=_0x27d531[_0x30b477(0x223)](0x0,_0x27d531[_0x30b477(0x1d8)]('.')),_0x4a2f74=_0x27d531[_0x30b477(0x1de)](_0x27d531['length']-0x1),_0x5cc050=localStorage[_0x30b477(0x204)](_0x2b821b+'.gba_imageState'+_0x4a2f74),_0x459ac6=localStorage[_0x30b477(0x204)](_0x2b821b+_0x30b477(0x214)+_0x4a2f74);if(_0x5cc050!==null){const _0x1befbe=_0x5cc050+'\x0a\x0a'+_0x459ac6,_0x188458=new Blob([_0x1befbe],{'type':_0x30b477(0x1e0)});await lockNoti('Backing\x20up...',_0x2b821b+_0x30b477(0x1ff)+_0x4a2f74+_0x30b477(0x20d),0xbb8),await dpUploadFile(_0x2b821b+_0x30b477(0x1ff)+_0x4a2f74+'.txt',_0x188458);}}}catch(_0x18edfe){console['error'](_0x30b477(0x1e8)+_0x27d531+':',_0x18edfe);}}}else console['log'](_0x30b477(0x216));}}),dropboxCloud[_0x4ecc79(0x207)](_0x4ecc79(0x1c8),function(){var _0x14ebbe=_0x4ecc79;const _0xd506a9=localStorage['getItem'](_0x14ebbe(0x1bd));_0xd506a9===null||_0xd506a9===''?authorizeWithDropbox():window[_0x14ebbe(0x1c3)](_0x14ebbe(0x1d7))&&(localStorage[_0x14ebbe(0x1eb)]('uId',''),dropboxRestore['classList'][_0x14ebbe(0x1ce)]('active'),dropboxBackup[_0x14ebbe(0x1e7)][_0x14ebbe(0x1ce)](_0x14ebbe(0x1f8)),dropboxCloud['classList'][_0x14ebbe(0x1ce)](_0x14ebbe(0x1f8)));}),handleDropboxCallback();});