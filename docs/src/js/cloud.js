var a0_0x16598d=a0_0x3eb9;(function(_0x324a44,_0x9bca3){var _0xa69b13=a0_0x3eb9,_0x2743e2=_0x324a44();while(!![]){try{var _0x7e4b64=parseInt(_0xa69b13(0x23b))/0x1+-parseInt(_0xa69b13(0x238))/0x2*(parseInt(_0xa69b13(0x20a))/0x3)+-parseInt(_0xa69b13(0x1ce))/0x4*(-parseInt(_0xa69b13(0x23c))/0x5)+parseInt(_0xa69b13(0x22a))/0x6+-parseInt(_0xa69b13(0x233))/0x7*(parseInt(_0xa69b13(0x20c))/0x8)+parseInt(_0xa69b13(0x21a))/0x9+-parseInt(_0xa69b13(0x1f6))/0xa*(parseInt(_0xa69b13(0x1f2))/0xb);if(_0x7e4b64===_0x9bca3)break;else _0x2743e2['push'](_0x2743e2['shift']());}catch(_0x102aaa){_0x2743e2['push'](_0x2743e2['shift']());}}}(a0_0x18f8,0xaff68));function a0_0x3eb9(_0x11e4b7,_0x416324){var _0x18f824=a0_0x18f8();return a0_0x3eb9=function(_0x3eb974,_0x5b1142){_0x3eb974=_0x3eb974-0x1ce;var _0x2bc0f4=_0x18f824[_0x3eb974];return _0x2bc0f4;},a0_0x3eb9(_0x11e4b7,_0x416324);}import*as a0_0x2f31a0 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x18f8(){var _0x5a53fd=['location','overwrite','access_token','refresh_token','&response_type=','getItem','split','search','name','.ss7','682891WMvara','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20not\x20receive\x20authorization','json','10sOPHbk','code','Cloud\x20↦\x20Kabu\x20storage\x20◆','Download\x20failed,\x20unknown\x20http\x20status:','https://www.dropbox.com/oauth2/authorize?client_id=','onload','open','https://api.dropboxapi.com/2/files/list_folder','.gba_dateState','exec','remove','application/octet-stream','Do\x20you\x20want\x20to\x20logout?','endsWith','=([^&#]*)','accessToken','.txt','href','error','Cloud\x20login\x20required!','93WkaOat','&token_access_type=','152lRLBeI','\x20files\x20in\x20Kabu?','Refreshing\x20token...','alert','refreshToken','uploadSaveOrSaveState','setItem','substring','.ss5','downloadFileInCloud','No\x20refresh\x20token','replace','Error\x20while\x20refreshing\x20token:','authorization_code','11403117hejLFc','.gba_slot','Bearer\x20','confirm','\x20files\x20in\x20Cloud?','uId','status','toUpperCase','Authorization\x20Code:','Failed\x20to\x20upload\x20file\x20','lastIndexOf','Kabu\x20storage\x20↦\x20Cloud\x20◆','state','code=','send','status:\x20','1149666JRPaLn','.ss0','list','log','POST','active','Restore\x20canceled\x20by\x20user.','entries','https://api.dropbox.com/oauth2/token','433265QroWqV','gba','uid','file','Content-Type','33962CpTWMT','DOMContentLoaded','https://content.dropboxapi.com/2/files/upload','819210GdkytM','2395RyLFab','text/plain','1732bklsFF','.ss4','[\x5c?&#]','responseText','_dateState','charAt','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&grant_type=','.gba_imageState','error_description','Unable\x20to\x20refresh\x20token','text','application/x-www-form-urlencoded','knh3uz2mx2hp2eu','stringify','length','offline','.ss3','&redirect_uri=','setRequestHeader','Backing\x20up...','addEventListener','Failed\x20to\x20refresh\x20Dropbox\x20token.','click','classList','slice'];a0_0x18f8=function(){return _0x5a53fd;};return a0_0x18f8();}var clientId=a0_0x16598d(0x1db),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0xa0d77d=a0_0x16598d,_0x3aeec1=window[_0xa0d77d(0x1e8)]['href'][_0xa0d77d(0x1ee)]('?')[0x0],_0x168e1f=_0xa0d77d(0x1f7),_0x1a13e7=_0xa0d77d(0x1de),_0x5d75bb=_0xa0d77d(0x1fa)+clientId+_0xa0d77d(0x1ec)+_0x168e1f+_0xa0d77d(0x20b)+_0x1a13e7+_0xa0d77d(0x1e0)+encodeURIComponent(_0x3aeec1);window[_0xa0d77d(0x1e8)]['href']=_0x5d75bb;}function handleDropboxCallback(){var _0x5cdfa3=a0_0x16598d,_0x1c4388=getUrlParameter(_0x5cdfa3(0x1f7));_0x1c4388?(getAccessToken(_0x1c4388),console[_0x5cdfa3(0x22d)](_0x5cdfa3(0x222),_0x1c4388)):console[_0x5cdfa3(0x22d)](_0x5cdfa3(0x1f4));}function getUrlParameter(_0x5cea63){var _0x47fea0=a0_0x16598d;_0x5cea63=_0x5cea63[_0x47fea0(0x217)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0xa7f9c3=new RegExp(_0x47fea0(0x1d0)+_0x5cea63+_0x47fea0(0x204)),_0x307faf=_0xa7f9c3[_0x47fea0(0x1ff)](location[_0x47fea0(0x1ef)]);return _0x307faf===null?'':decodeURIComponent(_0x307faf[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x4663f2){var _0x4ac8e0=a0_0x16598d,_0x2865bc=_0x4ac8e0(0x219),_0x513502=window[_0x4ac8e0(0x1e8)][_0x4ac8e0(0x207)][_0x4ac8e0(0x1ee)]('?')[0x0],_0x1f5707=new XMLHttpRequest();_0x1f5707[_0x4ac8e0(0x1fc)](_0x4ac8e0(0x22e),_0x4ac8e0(0x232)),_0x1f5707[_0x4ac8e0(0x1e1)](_0x4ac8e0(0x237),_0x4ac8e0(0x1da)),_0x1f5707[_0x4ac8e0(0x1fb)]=function(){var _0x3a679a=_0x4ac8e0;if(_0x1f5707['status']===0xc8){var _0x4a6fff=JSON['parse'](_0x1f5707[_0x3a679a(0x1d1)]),_0x3da27f=_0x4a6fff['access_token'],_0x2864ac=_0x4a6fff[_0x3a679a(0x1eb)],_0x3fea01=_0x4a6fff[_0x3a679a(0x235)];localStorage[_0x3a679a(0x212)](_0x3a679a(0x205),_0x3da27f),localStorage[_0x3a679a(0x212)](_0x3a679a(0x210),_0x2864ac),localStorage[_0x3a679a(0x212)](_0x3a679a(0x21f),_0x3fea01);}else console[_0x3a679a(0x22d)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x1f5707[_0x4ac8e0(0x228)](_0x4ac8e0(0x227)+_0x4663f2+_0x4ac8e0(0x1d5)+_0x2865bc+'&client_id='+clientId+'&client_secret='+clientSecret+_0x4ac8e0(0x1e0)+encodeURIComponent(_0x513502));}export async function dpRefreshToken(){var _0x3bf5b2=a0_0x16598d;if(!localStorage[_0x3bf5b2(0x1ed)](_0x3bf5b2(0x210)))throw _0x3bf5b2(0x216);try{const _0x1c860a=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x3bf5b2(0x1da)},'body':'refresh_token='+localStorage[_0x3bf5b2(0x1ed)](_0x3bf5b2(0x210))+_0x3bf5b2(0x1f3)}),_0x2f6870=await _0x1c860a[_0x3bf5b2(0x1f5)]();if(!_0x2f6870[_0x3bf5b2(0x208)])return localStorage[_0x3bf5b2(0x212)](_0x3bf5b2(0x205),_0x2f6870[_0x3bf5b2(0x1ea)]),await lockNoti('',_0x3bf5b2(0x20e),0xbb8),await delay(0x3e8),!![];else alert(_0x2f6870[_0x3bf5b2(0x1d7)]||_0x3bf5b2(0x1e4));}catch(_0xd65af2){console[_0x3bf5b2(0x208)](_0x3bf5b2(0x218),_0xd65af2);}return![];}export async function dpUploadFile(_0x1c5f9d,_0x303a84){var _0x21d0e6=a0_0x16598d;const _0x4ca983=localStorage[_0x21d0e6(0x1ed)]('uId');var _0x3340ad=JSON[_0x21d0e6(0x1dc)]({'autorename':!![],'mode':_0x21d0e6(0x1e9),'mute':!![],'strict_conflict':![],'path':'/'+_0x4ca983+'/'+_0x1c5f9d}),_0x42dddb=new Blob([_0x303a84],{'type':_0x21d0e6(0x201)});for(var _0x185ca0=0x0;_0x185ca0<0x2;_0x185ca0++){var _0x55af73=await fetch(_0x21d0e6(0x23a),{'method':'POST','headers':{'Authorization':_0x21d0e6(0x21c)+localStorage[_0x21d0e6(0x1ed)]('accessToken'),'Dropbox-API-Arg':_0x3340ad,'Content-Type':_0x21d0e6(0x201)},'body':_0x42dddb});if(_0x55af73[_0x21d0e6(0x220)]!=0xc8){if(_0x55af73['status']==0x191){var _0x4207d6=await dpRefreshToken();if(!_0x4207d6)throw _0x21d0e6(0x1d8);continue;}else throw _0x21d0e6(0x1d4)+_0x55af73['status'];}else{var _0x3aeeca=await _0x55af73['json']();return console[_0x21d0e6(0x22d)](_0x21d0e6(0x225),_0x1c5f9d),_0x3aeeca;}}return![];}async function dpDownloadFile(_0x2716c3){var _0x1a2716=a0_0x16598d;const _0x3871fd=localStorage['getItem'](_0x1a2716(0x21f));var _0x5d2e9c=JSON['stringify']({'path':'/'+_0x3871fd+'/'+_0x2716c3});for(var _0xb5b014=0x0;_0xb5b014<0x2;_0xb5b014++){var _0x5a427e=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1a2716(0x22e),'headers':{'Authorization':_0x1a2716(0x21c)+localStorage[_0x1a2716(0x1ed)](_0x1a2716(0x205)),'Dropbox-API-Arg':_0x5d2e9c}});if(_0x5a427e[_0x1a2716(0x220)]!=0xc8){if(_0x5a427e[_0x1a2716(0x220)]==0x191){var _0x228dca=await dpRefreshToken();if(!_0x228dca)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x1a2716(0x1f9)+_0x5a427e[_0x1a2716(0x220)];}const _0x3183bd=new File([await _0x5a427e['blob']()],_0x2716c3);console['log'](_0x1a2716(0x1f8),_0x3183bd['name']);if(_0x2716c3[_0x1a2716(0x203)](_0x1a2716(0x206))){const _0x2b11ff=await _0x3183bd[_0x1a2716(0x1d9)](),[_0x11f281,_0x3949d5]=_0x2b11ff[_0x1a2716(0x1ee)]('\x0a\x0a'),_0x46a061=_0x2716c3[_0x1a2716(0x213)](0x0,_0x2716c3[_0x1a2716(0x224)](_0x1a2716(0x234))+0x3),_0x429420=_0x2716c3[_0x1a2716(0x1d3)](_0x2716c3[_0x1a2716(0x1dd)]-0x5);localStorage[_0x1a2716(0x212)](_0x46a061+_0x1a2716(0x1d2)+_0x429420,_0x3949d5),localStorage[_0x1a2716(0x212)](_0x46a061+'_imageState'+_0x429420,_0x11f281);}else a0_0x2f31a0[_0x1a2716(0x211)](_0x3183bd,()=>{localStorageFile(),Module['FSSync']();});return _0x3183bd;}return![];}document[a0_0x16598d(0x1e3)](a0_0x16598d(0x239),function(){var _0x12c75f=a0_0x16598d;dropboxRestore['addEventListener']('click',async function(){var _0x4f5dd9=a0_0x3eb9;const _0x26fd99=localStorage[_0x4f5dd9(0x1ed)](_0x4f5dd9(0x21f));if(_0x26fd99===null||_0x26fd99==='')window[_0x4f5dd9(0x20f)]('Cloud\x20login\x20required!');else{var _0x307b18={'path':'/'+_0x26fd99};for(var _0x83d8b6=0x0;_0x83d8b6<0x2;_0x83d8b6++){var _0x2a7d=await fetch(_0x4f5dd9(0x1fd),{'method':_0x4f5dd9(0x22e),'headers':{'Authorization':_0x4f5dd9(0x21c)+localStorage['getItem'](_0x4f5dd9(0x205)),'Content-Type':'application/json'},'body':JSON[_0x4f5dd9(0x1dc)](_0x307b18)});console['log'](_0x4f5dd9(0x229),_0x2a7d[_0x4f5dd9(0x220)]);if(_0x2a7d[_0x4f5dd9(0x220)]!=0xc8){if(_0x2a7d['status']==0x191){var _0x20e560=await dpRefreshToken();if(!_0x20e560)throw _0x4f5dd9(0x1d8);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0x2a7d[_0x4f5dd9(0x220)];}else{const _0x503eaa=await _0x2a7d[_0x4f5dd9(0x1f5)](),_0x399a3d=_0x503eaa[_0x4f5dd9(0x231)]['filter'](_0x463d22=>_0x463d22['.tag']===_0x4f5dd9(0x236))[_0x4f5dd9(0x1dd)],_0x1a9822='Do\x20you\x20want\x20to\x20restore\x20'+_0x399a3d+_0x4f5dd9(0x21e);if(window['confirm'](_0x1a9822))for(const _0x113dd1 of _0x503eaa[_0x4f5dd9(0x231)]){_0x113dd1['.tag']===_0x4f5dd9(0x236)&&(await lockNoti('Restoring...',_0x113dd1[_0x4f5dd9(0x1f0)],0xbb8),await dpDownloadFile(_0x113dd1['name']));}else console['log']('Restore\x20canceled\x20by\x20user.');return!![];}}return![];}}),dropboxBackup[_0x12c75f(0x1e3)](_0x12c75f(0x1e5),async function(){var _0x1326c8=_0x12c75f;const _0x405fe2=localStorage[_0x1326c8(0x1ed)](_0x1326c8(0x21f));if(_0x405fe2===null||_0x405fe2==='')window[_0x1326c8(0x20f)](_0x1326c8(0x209));else{const _0x555c1f=[_0x1326c8(0x226),'save'];let _0x4f3cfd=0x0;for(const _0x2156c5 of _0x555c1f){const _0x42fe8c=a0_0x2f31a0[_0x1326c8(0x22c)+(_0x2156c5[_0x1326c8(0x1d3)](0x0)['toUpperCase']()+_0x2156c5['slice'](0x1))]();_0x4f3cfd+=_0x42fe8c[_0x1326c8(0x1dd)];}if(window[_0x1326c8(0x21d)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4f3cfd+_0x1326c8(0x20d)))for(const _0x452ca5 of _0x555c1f){const _0x3ffb88=a0_0x2f31a0[_0x1326c8(0x22c)+(_0x452ca5['charAt'](0x0)[_0x1326c8(0x221)]()+_0x452ca5[_0x1326c8(0x1e7)](0x1))]();for(const _0x24263e of _0x3ffb88){const _0x7efcc7=await a0_0x2f31a0[_0x1326c8(0x215)]('/data/'+_0x452ca5+'s/'+_0x24263e);try{await lockNoti(_0x1326c8(0x1e2),_0x24263e,0xbb8),await dpUploadFile(_0x24263e,_0x7efcc7);if(_0x24263e['endsWith'](_0x1326c8(0x22b))||_0x24263e[_0x1326c8(0x203)]('.ss1')||_0x24263e[_0x1326c8(0x203)]('.ss2')||_0x24263e['endsWith'](_0x1326c8(0x1df))||_0x24263e['endsWith'](_0x1326c8(0x1cf))||_0x24263e[_0x1326c8(0x203)](_0x1326c8(0x214))||_0x24263e['endsWith']('.ss6')||_0x24263e[_0x1326c8(0x203)](_0x1326c8(0x1f1))){const _0x1e19bb=_0x24263e[_0x1326c8(0x213)](0x0,_0x24263e[_0x1326c8(0x224)]('.')),_0x3b4b7d=_0x24263e[_0x1326c8(0x1d3)](_0x24263e[_0x1326c8(0x1dd)]-0x1),_0x1f5ae0=localStorage[_0x1326c8(0x1ed)](_0x1e19bb+_0x1326c8(0x1d6)+_0x3b4b7d),_0x18d4de=localStorage[_0x1326c8(0x1ed)](_0x1e19bb+_0x1326c8(0x1fe)+_0x3b4b7d);if(_0x1f5ae0!==null){const _0x16fa4b=_0x1f5ae0+'\x0a\x0a'+_0x18d4de,_0x32198f=new Blob([_0x16fa4b],{'type':_0x1326c8(0x23d)});await lockNoti('Backing\x20up...',_0x1e19bb+'.gba_slot'+_0x3b4b7d+_0x1326c8(0x206),0xbb8),await dpUploadFile(_0x1e19bb+_0x1326c8(0x21b)+_0x3b4b7d+_0x1326c8(0x206),_0x32198f);}}}catch(_0x1222c2){console[_0x1326c8(0x208)](_0x1326c8(0x223)+_0x24263e+':',_0x1222c2);}}}else console[_0x1326c8(0x22d)](_0x1326c8(0x230));}}),dropboxCloud[_0x12c75f(0x1e3)](_0x12c75f(0x1e5),function(){var _0x7521bd=_0x12c75f;const _0x5bfa45=localStorage[_0x7521bd(0x1ed)](_0x7521bd(0x21f));_0x5bfa45===null||_0x5bfa45===''?authorizeWithDropbox():window['confirm'](_0x7521bd(0x202))&&(localStorage[_0x7521bd(0x212)](_0x7521bd(0x21f),''),dropboxRestore['classList'][_0x7521bd(0x200)](_0x7521bd(0x22f)),dropboxBackup['classList'][_0x7521bd(0x200)]('active'),dropboxCloud[_0x7521bd(0x1e6)][_0x7521bd(0x200)](_0x7521bd(0x22f)));}),handleDropboxCallback();});