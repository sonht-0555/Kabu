var a0_0xf7ea22=a0_0x2aeb;(function(_0x553e8a,_0xded69){var _0x27a9f7=a0_0x2aeb,_0x3d62f5=_0x553e8a();while(!![]){try{var _0x4263e2=-parseInt(_0x27a9f7(0x15b))/0x1+-parseInt(_0x27a9f7(0x155))/0x2+parseInt(_0x27a9f7(0x11a))/0x3+-parseInt(_0x27a9f7(0x145))/0x4*(-parseInt(_0x27a9f7(0x112))/0x5)+-parseInt(_0x27a9f7(0x149))/0x6+-parseInt(_0x27a9f7(0x11f))/0x7*(-parseInt(_0x27a9f7(0x162))/0x8)+-parseInt(_0x27a9f7(0x100))/0x9*(-parseInt(_0x27a9f7(0x12f))/0xa);if(_0x4263e2===_0xded69)break;else _0x3d62f5['push'](_0x3d62f5['shift']());}catch(_0x5ca3e9){_0x3d62f5['push'](_0x3d62f5['shift']());}}}(a0_0x2598,0x3f1df));import*as a0_0x5b4bbe from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x2aeb(_0x278317,_0x40b6c8){var _0x259848=a0_0x2598();return a0_0x2aeb=function(_0x2aebf9,_0x85e957){_0x2aebf9=_0x2aebf9-0xfa;var _0x3acccb=_0x259848[_0x2aebf9];return _0x3acccb;},a0_0x2aeb(_0x278317,_0x40b6c8);}var clientId=a0_0xf7ea22(0x13b),clientSecret=a0_0xf7ea22(0x104);function authorizeWithDropbox(){var _0xe05be6=a0_0xf7ea22,_0x49fc0e=window[_0xe05be6(0x10a)]['href'][_0xe05be6(0x11d)]('?')[0x0],_0x3c1311=_0xe05be6(0xfe),_0x3e057e='offline',_0x56f516=_0xe05be6(0x159)+clientId+'&response_type='+_0x3c1311+_0xe05be6(0x122)+_0x3e057e+_0xe05be6(0x139)+encodeURIComponent(_0x49fc0e);window[_0xe05be6(0x10a)][_0xe05be6(0x124)]=_0x56f516;}function a0_0x2598(){var _0x46a0ac=['refresh_token','Restore\x20canceled\x20by\x20user.','&redirect_uri=','parse','knh3uz2mx2hp2eu','overwrite','refresh_token=','name','open','log','confirm','application/x-www-form-urlencoded','Error\x20while\x20refreshing\x20token:','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','11608BnPlHP','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20you\x20want\x20to\x20restore\x20','setRequestHeader','2225928cPQlXq','uploadFileInCloud','downloadFileInCloud','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Refreshing\x20token...','/data/','length','Failed\x20to\x20refresh\x20Dropbox\x20token.','Bearer\x20','&client_id=','Do\x20you\x20want\x20to\x20logout?','https://api.dropboxapi.com/oauth2/token','720542kSINjF','push','Do\x20you\x20want\x20to\x20backup\x20','screenshot','https://www.dropbox.com/oauth2/authorize?client_id=','Kabu\x20storage\x20↦\x20Cloud\x20◆','342055LqjQmP','map','&grant_type=','=([^&#]*)','status','stringify','replace','16BNEwmC','https://content.dropboxapi.com/2/files/download','&client_secret=','save','Folder\x20created','active','onload','code','json','234099WaZHTe','refreshToken','Wait\x20a\x20little\x20bit...','exec','nwb3dnfh09rhs31','state','uId','Download\x20failed\x20for\x20','application/json','Download\x20failed,\x20unknown\x20http\x20status:','location','Authorization\x20Code:','alert','setItem','Failed\x20to\x20upload\x20file\x20','click','listFiles','Cloud\x20login\x20required!','190RPzkdy','application/octet-stream','Restoring...','https://api.dropbox.com/oauth2/token','Backing\x20up...','search','addEventListener','accessToken','870753fTclKb','[\x5c?&#]','error','split','No\x20refresh\x20token','892598fuAkYi','\x20files\x20in\x20Kabu?','authorization_code','&token_access_type=','send','href','https://content.dropboxapi.com/2/files/upload','\x20files\x20from\x20Cloud?','POST','entries','blob','classList','access_token','remove','Error\x20creating\x20folder\x20',',\x20status:\x20','260whrZxm','No\x20files\x20found\x20to\x20restore.','getItem','folder','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Do\x20not\x20receive\x20authorization','file','error_description'];a0_0x2598=function(){return _0x46a0ac;};return a0_0x2598();}function handleDropboxCallback(){var _0x57d0bd=a0_0xf7ea22,_0xf48ae3=getUrlParameter(_0x57d0bd(0xfe));_0xf48ae3?(getAccessToken(_0xf48ae3),console['log'](_0x57d0bd(0x10b),_0xf48ae3)):console['log'](_0x57d0bd(0x134));}function getUrlParameter(_0x2913d9){var _0x1e26f1=a0_0xf7ea22;_0x2913d9=_0x2913d9['replace'](/[\[]/,'\x5c[')[_0x1e26f1(0x161)](/[\]]/,'\x5c]');var _0xcc6421=new RegExp(_0x1e26f1(0x11b)+_0x2913d9+_0x1e26f1(0x15e)),_0x199c6c=_0xcc6421[_0x1e26f1(0x103)](location[_0x1e26f1(0x117)]);return _0x199c6c===null?'':decodeURIComponent(_0x199c6c[0x1][_0x1e26f1(0x161)](/\+/g,'\x20'));}function getAccessToken(_0x229e22){var _0x36a887=a0_0xf7ea22,_0xec8d20=_0x36a887(0x121),_0x53a0b8=window['location']['href'][_0x36a887(0x11d)]('?')[0x0],_0x5c0a58=new XMLHttpRequest();_0x5c0a58[_0x36a887(0x13f)]('POST',_0x36a887(0x115)),_0x5c0a58[_0x36a887(0x148)]('Content-Type',_0x36a887(0x142)),_0x5c0a58[_0x36a887(0xfd)]=function(){var _0x123cc8=_0x36a887;if(_0x5c0a58[_0x123cc8(0x15f)]===0xc8){var _0x10b7eb=JSON[_0x123cc8(0x13a)](_0x5c0a58['responseText']),_0x14c707=_0x10b7eb[_0x123cc8(0x12b)],_0x23680e=_0x10b7eb[_0x123cc8(0x137)],_0x3834c5=_0x10b7eb['uid'];localStorage[_0x123cc8(0x10d)](_0x123cc8(0x119),_0x14c707),localStorage[_0x123cc8(0x10d)](_0x123cc8(0x101),_0x23680e),localStorage[_0x123cc8(0x10d)]('uId',_0x3834c5);}else console[_0x123cc8(0x140)](_0x123cc8(0x144));},_0x5c0a58[_0x36a887(0x123)]('code='+_0x229e22+_0x36a887(0x15d)+_0xec8d20+_0x36a887(0x152)+clientId+_0x36a887(0x164)+clientSecret+_0x36a887(0x139)+encodeURIComponent(_0x53a0b8));}export async function dpCreateFolder(_0x16e5bc){var _0x21c221=a0_0xf7ea22;const _0x114c64=localStorage[_0x21c221(0x131)](_0x21c221(0x106));let _0x148843=localStorage[_0x21c221(0x131)](_0x21c221(0x119));const _0x235798='/'+_0x114c64+'/'+_0x16e5bc,_0x3ddb3b=JSON[_0x21c221(0x160)]({'path':_0x235798,'autorename':![]});for(let _0xabe05d=0x0;_0xabe05d<0x2;_0xabe05d++){try{const _0x527881=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x21c221(0x127),'headers':{'Authorization':'Bearer\x20'+_0x148843,'Content-Type':_0x21c221(0x108)},'body':_0x3ddb3b});if(_0x527881[_0x21c221(0x15f)]===0x191){const _0x2e5b3f=await dpRefreshToken();if(!_0x2e5b3f)throw new Error('Unable\x20to\x20refresh\x20token');_0x148843=localStorage['getItem'](_0x21c221(0x119));continue;}if(_0x527881[_0x21c221(0x15f)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x16e5bc};if(!_0x527881['ok'])throw new Error(_0x21c221(0x12d)+_0x16e5bc);const _0x2c88ee=await _0x527881[_0x21c221(0xff)]();return await lockNoti(_0x21c221(0xfb),'',0xbb8),_0x2c88ee;}catch(_0x23d8e6){if(_0xabe05d===0x1)throw _0x23d8e6;}}return![];}export async function dpRefreshToken(){var _0x53c417=a0_0xf7ea22;if(!localStorage['getItem']('refreshToken'))throw _0x53c417(0x11e);try{const _0x28ecfe=await fetch(_0x53c417(0x154),{'method':_0x53c417(0x127),'headers':{'Content-Type':_0x53c417(0x142)},'body':_0x53c417(0x13d)+localStorage[_0x53c417(0x131)]('refreshToken')+_0x53c417(0x14c)}),_0xc67a24=await _0x28ecfe[_0x53c417(0xff)]();if(!_0xc67a24[_0x53c417(0x11c)])return localStorage[_0x53c417(0x10d)](_0x53c417(0x119),_0xc67a24[_0x53c417(0x12b)]),await lockNoti(_0x53c417(0x14d),'',0xbb8),await delay(0x3e8),!![];else alert(_0xc67a24[_0x53c417(0x136)]||_0x53c417(0x150));}catch(_0x48dcd1){console[_0x53c417(0x11c)](_0x53c417(0x143),_0x48dcd1);}return![];}export async function dpUploadFile(_0x291af3,_0x21b850,_0xbe6df3){var _0x208bec=a0_0xf7ea22;const _0x4dac11=localStorage[_0x208bec(0x131)]('uId');var _0x3dce12=JSON[_0x208bec(0x160)]({'autorename':!![],'mode':_0x208bec(0x13c),'mute':!![],'strict_conflict':![],'path':'/'+_0x4dac11+'/'+_0xbe6df3+'/'+_0x291af3}),_0x10c3d7=new Blob([_0x21b850],{'type':_0x208bec(0x113)});for(var _0x4e6c81=0x0;_0x4e6c81<0x2;_0x4e6c81++){var _0x491c9b=await fetch(_0x208bec(0x125),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x208bec(0x131)](_0x208bec(0x119)),'Dropbox-API-Arg':_0x3dce12,'Content-Type':_0x208bec(0x113)},'body':_0x10c3d7});if(_0x491c9b[_0x208bec(0x15f)]!=0xc8){if(_0x491c9b[_0x208bec(0x15f)]==0x191){var _0x24ce5b=await dpRefreshToken();if(!_0x24ce5b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x208bec(0x133)+_0x491c9b[_0x208bec(0x15f)];}else{var _0x3f842c=await _0x491c9b['json']();return console[_0x208bec(0x140)](_0x208bec(0x15a),_0x291af3),_0x3f842c;}}return![];}export async function dpDownloadFile(_0x589be3,_0x4f9edb){var _0x4248b9=a0_0xf7ea22;const _0x273f74=localStorage[_0x4248b9(0x131)]('uId');var _0x23fa9a=JSON[_0x4248b9(0x160)]({'path':'/'+_0x273f74+'/'+_0x4f9edb+'/'+_0x589be3});for(var _0x2e4254=0x0;_0x2e4254<0x2;_0x2e4254++){var _0x1a7df3=await fetch(_0x4248b9(0x163),{'method':_0x4248b9(0x127),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x4248b9(0x119)),'Dropbox-API-Arg':_0x23fa9a}});if(_0x1a7df3[_0x4248b9(0x15f)]!=0xc8){if(_0x1a7df3[_0x4248b9(0x15f)]==0x191){var _0x38f68b=await dpRefreshToken();if(!_0x38f68b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4248b9(0x109)+_0x1a7df3[_0x4248b9(0x15f)];}const _0x391825=new File([await _0x1a7df3[_0x4248b9(0x129)]()],_0x589be3);return console[_0x4248b9(0x140)](_0x4248b9(0x146),_0x391825[_0x4248b9(0x13e)]),a0_0x5b4bbe[_0x4248b9(0x14a)](_0x391825,()=>{}),_0x391825;}return![];}document[a0_0xf7ea22(0x118)]('DOMContentLoaded',function(){var _0x56cdf9=a0_0xf7ea22;dropboxRestore[_0x56cdf9(0x118)]('click',async function(){var _0x190583=_0x56cdf9;await lockNoti(_0x190583(0x102),'',0x1388);const _0x2f5aad=localStorage[_0x190583(0x131)](_0x190583(0x106)),_0x4bcd76=['state',_0x190583(0xfa),'screenshot'];if(!_0x2f5aad){window[_0x190583(0x10c)](_0x190583(0x111));return;}let _0x2a2436=[];for(const _0x28e03e of _0x4bcd76){let _0x5980ce={'path':'/'+_0x2f5aad+'/'+_0x28e03e};for(let _0x349517=0x0;_0x349517<0x2;_0x349517++){let _0x406de8=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x190583(0x151)+localStorage[_0x190583(0x131)](_0x190583(0x119)),'Content-Type':_0x190583(0x108)},'body':JSON[_0x190583(0x160)](_0x5980ce)});if(_0x406de8['status']===0xc8){let _0xdf3768=await _0x406de8[_0x190583(0xff)](),_0x4ba473=_0xdf3768[_0x190583(0x128)]['filter'](_0x2f9279=>_0x2f9279['.tag']===_0x190583(0x135));_0x4ba473[_0x190583(0x14f)]>0x0&&_0x2a2436[_0x190583(0x156)](..._0x4ba473[_0x190583(0x15c)](_0x59e8bd=>({'name':_0x59e8bd[_0x190583(0x13e)],'folder':_0x28e03e})));break;}else{if(_0x406de8[_0x190583(0x15f)]===0x191){let _0x472978=await dpRefreshToken();if(!_0x472978)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x190583(0x11c)](_0x190583(0x107)+_0x28e03e+_0x190583(0x12e)+_0x406de8['status']);break;}}}}if(_0x2a2436[_0x190583(0x14f)]>0x0){const _0x3f780b=_0x190583(0x147)+_0x2a2436['length']+_0x190583(0x126);if(window[_0x190583(0x141)](_0x3f780b))for(const _0x5bbfcf of _0x2a2436){await lockNoti(_0x190583(0x114),_0x5bbfcf[_0x190583(0x13e)],0xbb8),await dpDownloadFile(_0x5bbfcf[_0x190583(0x13e)],_0x5bbfcf[_0x190583(0x132)]);}else console[_0x190583(0x140)](_0x190583(0x138));}else console[_0x190583(0x140)](_0x190583(0x130));}),dropboxBackup[_0x56cdf9(0x118)](_0x56cdf9(0x10f),async function(){var _0x48b1af=_0x56cdf9;await lockNoti(_0x48b1af(0x102),'',0x1388);const _0x472c2b=localStorage['getItem'](_0x48b1af(0x106));if(_0x472c2b===null||_0x472c2b==='')window[_0x48b1af(0x10c)](_0x48b1af(0x111));else{const _0x124ca0=[_0x48b1af(0x105),_0x48b1af(0xfa),_0x48b1af(0x158)];for(const _0x2a384c of _0x124ca0){await dpCreateFolder(_0x2a384c);}let _0x5c5ab3=0x0;for(const _0x325afb of _0x124ca0){const _0xc83ece=a0_0x5b4bbe[_0x48b1af(0x110)](_0x325afb+'s');_0x5c5ab3+=_0xc83ece[_0x48b1af(0x14f)];}if(window['confirm'](_0x48b1af(0x157)+_0x5c5ab3+_0x48b1af(0x120)))for(const _0x38fbe8 of _0x124ca0){const _0x12b80b=a0_0x5b4bbe[_0x48b1af(0x110)](_0x38fbe8+'s');for(const _0x56fe96 of _0x12b80b){const _0x88fefe=await a0_0x5b4bbe[_0x48b1af(0x14b)](_0x48b1af(0x14e)+_0x38fbe8+'s/'+_0x56fe96);try{await lockNoti(_0x48b1af(0x116),_0x56fe96,0xbb8),await dpUploadFile(_0x56fe96,_0x88fefe,_0x38fbe8);}catch(_0x424be5){console[_0x48b1af(0x11c)](_0x48b1af(0x10e)+_0x56fe96+':',_0x424be5);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x56cdf9(0x118)]('click',function(){var _0xfa006=_0x56cdf9;const _0x171b8d=localStorage[_0xfa006(0x131)](_0xfa006(0x106));_0x171b8d===null||_0x171b8d===''?authorizeWithDropbox():window[_0xfa006(0x141)](_0xfa006(0x153))&&(localStorage[_0xfa006(0x10d)](_0xfa006(0x106),''),dropboxRestore[_0xfa006(0x12a)][_0xfa006(0x12c)](_0xfa006(0xfc)),dropboxBackup[_0xfa006(0x12a)][_0xfa006(0x12c)]('active'),dropboxCloud[_0xfa006(0x12a)][_0xfa006(0x12c)](_0xfa006(0xfc)));}),handleDropboxCallback();});