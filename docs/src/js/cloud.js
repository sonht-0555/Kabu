var a0_0x36922e=a0_0x1201;(function(_0xf97f9d,_0x31daca){var _0x4398f5=a0_0x1201,_0x550378=_0xf97f9d();while(!![]){try{var _0x4f78b0=parseInt(_0x4398f5(0xf1))/0x1+parseInt(_0x4398f5(0x126))/0x2+-parseInt(_0x4398f5(0xfe))/0x3*(parseInt(_0x4398f5(0x119))/0x4)+-parseInt(_0x4398f5(0x12b))/0x5+parseInt(_0x4398f5(0x138))/0x6*(-parseInt(_0x4398f5(0xda))/0x7)+-parseInt(_0x4398f5(0x104))/0x8*(-parseInt(_0x4398f5(0x113))/0x9)+-parseInt(_0x4398f5(0x120))/0xa*(-parseInt(_0x4398f5(0x129))/0xb);if(_0x4f78b0===_0x31daca)break;else _0x550378['push'](_0x550378['shift']());}catch(_0x49b41e){_0x550378['push'](_0x550378['shift']());}}}(a0_0x3b46,0xaf90d));import*as a0_0x7d58c9 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x3b46(){var _0x68efbd=['Upload\x20failed,\x20unknown\x20http\x20status:\x20','code=','https://api.dropboxapi.com/2/files/create_folder_v2','Bearer\x20','Wait\x20a\x20little\x20bit...','Refreshing\x20token...','POST','classList','https://content.dropboxapi.com/2/files/download','Authorization\x20Code:','Folder\x20already\x20exists','setRequestHeader','code','status','uId','href','&response_type=','location','Cloud\x20login\x20required!','alert','application/json','1362115bNrzHj','Download\x20failed,\x20unknown\x20http\x20status:','offline','downloadFileInCloud','setItem','json','replace','Content-Type','.tag','listFiles','=([^&#]*)','refresh_token=','send','482835ucKcNp','getItem','responseText','application/x-www-form-urlencoded','Download\x20failed\x20for\x20','Unable\x20to\x20refresh\x20token','16ONgsRJ','&redirect_uri=','knh3uz2mx2hp2eu','split','log','[\x5c?&#]','name','Do\x20not\x20receive\x20authorization','https://api.dropboxapi.com/oauth2/token','parse','&grant_type=','nwb3dnfh09rhs31','length','https://content.dropboxapi.com/2/files/upload','Kabu\x20storage\x20↦\x20Cloud\x20◆','1306350pGSgIf','accessToken','Do\x20you\x20want\x20to\x20logout?',',\x20status:\x20','click','addEventListener','12PNHSFj','active','Cloud\x20↦\x20Kabu\x20storage\x20◆','push','Do\x20you\x20want\x20to\x20backup\x20','remove','overwrite','10580iBjVux','Restoring...','folder','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','save','entries','262094Ijjazw','Failed\x20to\x20refresh\x20Dropbox\x20token.','Do\x20you\x20want\x20to\x20restore\x20','14267rhlDpX','access_token','3575610ILbICF','application/octet-stream','refresh_token','Restore\x20canceled\x20by\x20user.','\x20files\x20in\x20Kabu?','Folder\x20created','Error\x20while\x20refreshing\x20token:','authorization_code','refreshToken','error','open','No\x20files\x20found\x20to\x20restore.','Backing\x20up...','78EIlhfs','error_description','666946sgrhJT','confirm'];a0_0x3b46=function(){return _0x68efbd;};return a0_0x3b46();}var clientId=a0_0x36922e(0x106),clientSecret=a0_0x36922e(0x10f);function authorizeWithDropbox(){var _0xa33bac=a0_0x36922e,_0x5049e1=window['location'][_0xa33bac(0xeb)][_0xa33bac(0x107)]('?')[0x0],_0x1b9547=_0xa33bac(0xe8),_0x5fcabb=_0xa33bac(0xf3),_0x518b76='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0xa33bac(0xec)+_0x1b9547+'&token_access_type='+_0x5fcabb+_0xa33bac(0x105)+encodeURIComponent(_0x5049e1);window[_0xa33bac(0xed)][_0xa33bac(0xeb)]=_0x518b76;}function a0_0x1201(_0x18c847,_0x5921d7){var _0x3b4654=a0_0x3b46();return a0_0x1201=function(_0x1201dc,_0x1bddc1){_0x1201dc=_0x1201dc-0xda;var _0x539cc7=_0x3b4654[_0x1201dc];return _0x539cc7;},a0_0x1201(_0x18c847,_0x5921d7);}function handleDropboxCallback(){var _0x4b20c5=a0_0x36922e,_0x3ea946=getUrlParameter(_0x4b20c5(0xe8));_0x3ea946?(getAccessToken(_0x3ea946),console[_0x4b20c5(0x108)](_0x4b20c5(0xe5),_0x3ea946)):console[_0x4b20c5(0x108)](_0x4b20c5(0x10b));}function getUrlParameter(_0x39177a){var _0x47692b=a0_0x36922e;_0x39177a=_0x39177a[_0x47692b(0xf7)](/[\[]/,'\x5c[')[_0x47692b(0xf7)](/[\]]/,'\x5c]');var _0x5d1d8e=new RegExp(_0x47692b(0x109)+_0x39177a+_0x47692b(0xfb)),_0x50b977=_0x5d1d8e['exec'](location['search']);return _0x50b977===null?'':decodeURIComponent(_0x50b977[0x1][_0x47692b(0xf7)](/\+/g,'\x20'));}function getAccessToken(_0x27d394){var _0x17b9b3=a0_0x36922e,_0x26af3c=_0x17b9b3(0x132),_0x2f7eaa=window[_0x17b9b3(0xed)]['href'][_0x17b9b3(0x107)]('?')[0x0],_0x56305b=new XMLHttpRequest();_0x56305b[_0x17b9b3(0x135)](_0x17b9b3(0xe2),'https://api.dropbox.com/oauth2/token'),_0x56305b[_0x17b9b3(0xe7)](_0x17b9b3(0xf8),_0x17b9b3(0x101)),_0x56305b['onload']=function(){var _0x1bd105=_0x17b9b3;if(_0x56305b[_0x1bd105(0xe9)]===0xc8){var _0x34e48a=JSON[_0x1bd105(0x10d)](_0x56305b[_0x1bd105(0x100)]),_0x5ee6b6=_0x34e48a[_0x1bd105(0x12a)],_0x3e12e1=_0x34e48a[_0x1bd105(0x12d)],_0x3c9dea=_0x34e48a['uid'];localStorage[_0x1bd105(0xf5)](_0x1bd105(0x114),_0x5ee6b6),localStorage[_0x1bd105(0xf5)](_0x1bd105(0x133),_0x3e12e1),localStorage[_0x1bd105(0xf5)](_0x1bd105(0xea),_0x3c9dea);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x56305b[_0x17b9b3(0xfd)](_0x17b9b3(0xdd)+_0x27d394+_0x17b9b3(0x10e)+_0x26af3c+'&client_id='+clientId+'&client_secret='+clientSecret+_0x17b9b3(0x105)+encodeURIComponent(_0x2f7eaa));}export async function dpCreateFolder(_0x2a5a8d){var _0x53293b=a0_0x36922e;const _0x3c4872=localStorage[_0x53293b(0xff)](_0x53293b(0xea));let _0xf4fc7c=localStorage['getItem'](_0x53293b(0x114));const _0x6a836='/'+_0x3c4872+'/'+_0x2a5a8d,_0x1b2643=JSON['stringify']({'path':_0x6a836,'autorename':![]});for(let _0x49ef12=0x0;_0x49ef12<0x2;_0x49ef12++){try{const _0x5f034c=await fetch(_0x53293b(0xde),{'method':_0x53293b(0xe2),'headers':{'Authorization':_0x53293b(0xdf)+_0xf4fc7c,'Content-Type':_0x53293b(0xf0)},'body':_0x1b2643});if(_0x5f034c[_0x53293b(0xe9)]===0x191){const _0x47a81f=await dpRefreshToken();if(!_0x47a81f)throw new Error(_0x53293b(0x103));_0xf4fc7c=localStorage[_0x53293b(0xff)](_0x53293b(0x114));continue;}if(_0x5f034c[_0x53293b(0xe9)]===0x199)return{'message':_0x53293b(0xe6),'path':_0x2a5a8d};if(!_0x5f034c['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x2a5a8d);const _0x2a9c28=await _0x5f034c[_0x53293b(0xf6)]();return await lockNoti(_0x53293b(0x130),'',0xbb8),_0x2a9c28;}catch(_0x323003){if(_0x49ef12===0x1)throw _0x323003;}}return![];}export async function dpRefreshToken(){var _0x33ee50=a0_0x36922e;if(!localStorage[_0x33ee50(0xff)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x136c30=await fetch(_0x33ee50(0x10c),{'method':_0x33ee50(0xe2),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x33ee50(0xfc)+localStorage['getItem'](_0x33ee50(0x133))+_0x33ee50(0x123)}),_0x3329e2=await _0x136c30[_0x33ee50(0xf6)]();if(!_0x3329e2['error'])return localStorage[_0x33ee50(0xf5)](_0x33ee50(0x114),_0x3329e2[_0x33ee50(0x12a)]),await lockNoti(_0x33ee50(0xe1),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3329e2[_0x33ee50(0x139)]||_0x33ee50(0x127));}catch(_0x11818a){console['error'](_0x33ee50(0x131),_0x11818a);}return![];}export async function dpUploadFile(_0x35b5e2,_0x2d2a52,_0xa50501){var _0x4a353e=a0_0x36922e;const _0x316d8a=localStorage[_0x4a353e(0xff)]('uId');var _0x5eb37f=JSON['stringify']({'autorename':!![],'mode':_0x4a353e(0x11f),'mute':!![],'strict_conflict':![],'path':'/'+_0x316d8a+'/'+_0xa50501+'/'+_0x35b5e2}),_0x256553=new Blob([_0x2d2a52],{'type':_0x4a353e(0x12c)});for(var _0x5c5c7d=0x0;_0x5c5c7d<0x2;_0x5c5c7d++){var _0x2bf492=await fetch(_0x4a353e(0x111),{'method':_0x4a353e(0xe2),'headers':{'Authorization':_0x4a353e(0xdf)+localStorage['getItem'](_0x4a353e(0x114)),'Dropbox-API-Arg':_0x5eb37f,'Content-Type':_0x4a353e(0x12c)},'body':_0x256553});if(_0x2bf492[_0x4a353e(0xe9)]!=0xc8){if(_0x2bf492[_0x4a353e(0xe9)]==0x191){var _0x283881=await dpRefreshToken();if(!_0x283881)throw _0x4a353e(0x103);continue;}else throw _0x4a353e(0xdc)+_0x2bf492['status'];}else{var _0x3d721c=await _0x2bf492[_0x4a353e(0xf6)]();return console[_0x4a353e(0x108)](_0x4a353e(0x112),_0x35b5e2),_0x3d721c;}}return![];}export async function dpDownloadFile(_0x186fed,_0x3e4557){var _0x5e4be7=a0_0x36922e;const _0x4b101e=localStorage[_0x5e4be7(0xff)]('uId');var _0x46c404=JSON['stringify']({'path':'/'+_0x4b101e+'/'+_0x3e4557+'/'+_0x186fed});for(var _0x4dabe6=0x0;_0x4dabe6<0x2;_0x4dabe6++){var _0x594fbc=await fetch(_0x5e4be7(0xe4),{'method':_0x5e4be7(0xe2),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x5e4be7(0x114)),'Dropbox-API-Arg':_0x46c404}});if(_0x594fbc['status']!=0xc8){if(_0x594fbc[_0x5e4be7(0xe9)]==0x191){var _0x53561b=await dpRefreshToken();if(!_0x53561b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5e4be7(0xf2)+_0x594fbc[_0x5e4be7(0xe9)];}const _0x47dd5f=new File([await _0x594fbc['blob']()],_0x186fed);return console['log'](_0x5e4be7(0x11b),_0x47dd5f[_0x5e4be7(0x10a)]),a0_0x7d58c9['uploadFileInCloud'](_0x47dd5f,()=>{}),_0x47dd5f;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x1e791e=a0_0x36922e;dropboxRestore[_0x1e791e(0x118)]('click',async function(){var _0x37292b=_0x1e791e;await lockNoti(_0x37292b(0xe0),'',0x1388);const _0x3635e3=localStorage[_0x37292b(0xff)]('uId'),_0x2c4c45=['state','save','screenshot'];if(!_0x3635e3){window['alert'](_0x37292b(0xee));return;}let _0x549b9b=[];for(const _0x419e00 of _0x2c4c45){let _0x4fbbd9={'path':'/'+_0x3635e3+'/'+_0x419e00};for(let _0x592806=0x0;_0x592806<0x2;_0x592806++){let _0x1b3352=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x37292b(0xe2),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x37292b(0x114)),'Content-Type':'application/json'},'body':JSON['stringify'](_0x4fbbd9)});if(_0x1b3352[_0x37292b(0xe9)]===0xc8){let _0x52452c=await _0x1b3352[_0x37292b(0xf6)](),_0x1070ae=_0x52452c[_0x37292b(0x125)]['filter'](_0x311459=>_0x311459[_0x37292b(0xf9)]==='file');_0x1070ae[_0x37292b(0x110)]>0x0&&_0x549b9b[_0x37292b(0x11c)](..._0x1070ae['map'](_0x5ce5ac=>({'name':_0x5ce5ac[_0x37292b(0x10a)],'folder':_0x419e00})));break;}else{if(_0x1b3352[_0x37292b(0xe9)]===0x191){let _0x31040a=await dpRefreshToken();if(!_0x31040a)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x37292b(0x134)](_0x37292b(0x102)+_0x419e00+_0x37292b(0x116)+_0x1b3352[_0x37292b(0xe9)]);break;}}}}if(_0x549b9b[_0x37292b(0x110)]>0x0){const _0x322128=_0x37292b(0x128)+_0x549b9b[_0x37292b(0x110)]+'\x20files\x20from\x20Cloud?';if(window[_0x37292b(0xdb)](_0x322128))for(const _0x42380b of _0x549b9b){await lockNoti(_0x37292b(0x121),_0x42380b[_0x37292b(0x10a)],0xbb8),await dpDownloadFile(_0x42380b[_0x37292b(0x10a)],_0x42380b[_0x37292b(0x122)]);}else console['log'](_0x37292b(0x12e));}else console[_0x37292b(0x108)](_0x37292b(0x136));}),dropboxBackup[_0x1e791e(0x118)](_0x1e791e(0x117),async function(){var _0x3dd254=_0x1e791e;await lockNoti(_0x3dd254(0xe0),'',0x1388);const _0x3c3d40=localStorage[_0x3dd254(0xff)](_0x3dd254(0xea));if(_0x3c3d40===null||_0x3c3d40==='')window[_0x3dd254(0xef)](_0x3dd254(0xee));else{const _0x378c7=['state',_0x3dd254(0x124),'screenshot'];for(const _0x4b3bdc of _0x378c7){await dpCreateFolder(_0x4b3bdc);}let _0x1966ac=0x0;for(const _0x2bff0c of _0x378c7){const _0x34669c=a0_0x7d58c9[_0x3dd254(0xfa)](_0x2bff0c+'s');_0x1966ac+=_0x34669c[_0x3dd254(0x110)];}if(window[_0x3dd254(0xdb)](_0x3dd254(0x11d)+_0x1966ac+_0x3dd254(0x12f)))for(const _0xd22de0 of _0x378c7){const _0x50b11f=a0_0x7d58c9[_0x3dd254(0xfa)](_0xd22de0+'s');for(const _0x57f3a4 of _0x50b11f){const _0x5e8339=await a0_0x7d58c9[_0x3dd254(0xf4)]('/data/'+_0xd22de0+'s/'+_0x57f3a4);try{await lockNoti(_0x3dd254(0x137),_0x57f3a4,0xbb8),await dpUploadFile(_0x57f3a4,_0x5e8339,_0xd22de0);}catch(_0x3e85b0){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x57f3a4+':',_0x3e85b0);}}}else console[_0x3dd254(0x108)](_0x3dd254(0x12e));}}),dropboxCloud[_0x1e791e(0x118)](_0x1e791e(0x117),function(){var _0x2de670=_0x1e791e;const _0x402118=localStorage[_0x2de670(0xff)](_0x2de670(0xea));_0x402118===null||_0x402118===''?authorizeWithDropbox():window['confirm'](_0x2de670(0x115))&&(localStorage[_0x2de670(0xf5)](_0x2de670(0xea),''),dropboxRestore[_0x2de670(0xe3)]['remove'](_0x2de670(0x11a)),dropboxBackup['classList'][_0x2de670(0x11e)]('active'),dropboxCloud[_0x2de670(0xe3)][_0x2de670(0x11e)](_0x2de670(0x11a)));}),handleDropboxCallback();});