var a0_0x5931ee=a0_0xb862;(function(_0x26c162,_0x17a7f8){var _0x418ce3=a0_0xb862,_0x30f51c=_0x26c162();while(!![]){try{var _0x54d6cc=-parseInt(_0x418ce3(0x163))/0x1*(parseInt(_0x418ce3(0x15c))/0x2)+-parseInt(_0x418ce3(0x166))/0x3+parseInt(_0x418ce3(0x164))/0x4*(parseInt(_0x418ce3(0x1a1))/0x5)+parseInt(_0x418ce3(0x1ad))/0x6+-parseInt(_0x418ce3(0x17f))/0x7+-parseInt(_0x418ce3(0x17b))/0x8+parseInt(_0x418ce3(0x17c))/0x9;if(_0x54d6cc===_0x17a7f8)break;else _0x30f51c['push'](_0x30f51c['shift']());}catch(_0x21ea7a){_0x30f51c['push'](_0x30f51c['shift']());}}}(a0_0x2c21,0x947e8));import*as a0_0x11ffe6 from'./main.js';function a0_0xb862(_0x830721,_0x23ff4e){var _0x2c21ca=a0_0x2c21();return a0_0xb862=function(_0xb86222,_0x1b7a38){_0xb86222=_0xb86222-0x150;var _0x3f44af=_0x2c21ca[_0xb86222];return _0x3f44af;},a0_0xb862(_0x830721,_0x23ff4e);}import{localStorageFile}from'./storage.js';var clientId=a0_0x5931ee(0x178),clientSecret=a0_0x5931ee(0x1a7);function authorizeWithDropbox(){var _0x5cfd78=a0_0x5931ee,_0xf2a028=window[_0x5cfd78(0x16a)][_0x5cfd78(0x1ac)]['split']('?')[0x0],_0xd789d2=_0x5cfd78(0x180),_0x3e4a59='offline',_0x23fb94=_0x5cfd78(0x183)+clientId+_0x5cfd78(0x1b2)+_0xd789d2+_0x5cfd78(0x168)+_0x3e4a59+_0x5cfd78(0x172)+encodeURIComponent(_0xf2a028);window['location'][_0x5cfd78(0x1ac)]=_0x23fb94;}function handleDropboxCallback(){var _0x14b216=a0_0x5931ee,_0x144f12=getUrlParameter(_0x14b216(0x180));_0x144f12?(getAccessToken(_0x144f12),console[_0x14b216(0x150)](_0x14b216(0x190),_0x144f12)):console[_0x14b216(0x150)](_0x14b216(0x1a2));}function getUrlParameter(_0x16eaab){var _0x39d604=a0_0x5931ee;_0x16eaab=_0x16eaab['replace'](/[\[]/,'\x5c[')[_0x39d604(0x189)](/[\]]/,'\x5c]');var _0x4ba799=new RegExp(_0x39d604(0x161)+_0x16eaab+_0x39d604(0x199)),_0x5d57fa=_0x4ba799['exec'](location['search']);return _0x5d57fa===null?'':decodeURIComponent(_0x5d57fa[0x1][_0x39d604(0x189)](/\+/g,'\x20'));}function getAccessToken(_0x1889f1){var _0x36e7b0=a0_0x5931ee,_0x24747e=_0x36e7b0(0x17e),_0x12d74e=window['location'][_0x36e7b0(0x1ac)][_0x36e7b0(0x1af)]('?')[0x0],_0x8f19a=new XMLHttpRequest();_0x8f19a[_0x36e7b0(0x198)]('POST','https://api.dropbox.com/oauth2/token'),_0x8f19a[_0x36e7b0(0x157)]('Content-Type',_0x36e7b0(0x188)),_0x8f19a[_0x36e7b0(0x1a8)]=function(){var _0x3da938=_0x36e7b0;if(_0x8f19a[_0x3da938(0x19c)]===0xc8){var _0x12adfe=JSON[_0x3da938(0x171)](_0x8f19a['responseText']),_0x146bc6=_0x12adfe[_0x3da938(0x158)],_0x32dfbd=_0x12adfe['refresh_token'],_0xbc604f=_0x12adfe[_0x3da938(0x17a)];localStorage['setItem'](_0x3da938(0x196),_0x146bc6),localStorage[_0x3da938(0x19f)]('refreshToken',_0x32dfbd),localStorage[_0x3da938(0x19f)](_0x3da938(0x184),_0xbc604f);}else console[_0x3da938(0x150)](_0x3da938(0x1b3));},_0x8f19a[_0x36e7b0(0x156)](_0x36e7b0(0x170)+_0x1889f1+'&grant_type='+_0x24747e+_0x36e7b0(0x155)+clientId+'&client_secret='+clientSecret+_0x36e7b0(0x172)+encodeURIComponent(_0x12d74e));}export async function dpCreateFolder(_0x214213){var _0x182b10=a0_0x5931ee;const _0x12dbb5=localStorage['getItem'](_0x182b10(0x184));let _0x135b65=localStorage[_0x182b10(0x18e)](_0x182b10(0x196));const _0x113aef='/'+_0x12dbb5+'/'+_0x214213,_0x35173c=JSON[_0x182b10(0x154)]({'path':_0x113aef,'autorename':![]});for(let _0x1b0267=0x0;_0x1b0267<0x2;_0x1b0267++){try{const _0x2aa42f=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x182b10(0x187),'headers':{'Authorization':_0x182b10(0x1ae)+_0x135b65,'Content-Type':_0x182b10(0x167)},'body':_0x35173c});if(_0x2aa42f['status']===0x191){const _0x1953e2=await dpRefreshToken();if(!_0x1953e2)throw new Error('Unable\x20to\x20refresh\x20token');_0x135b65=localStorage[_0x182b10(0x18e)]('accessToken');continue;}if(_0x2aa42f[_0x182b10(0x19c)]===0x199)return{'message':_0x182b10(0x15d),'path':_0x214213};if(!_0x2aa42f['ok'])throw new Error(_0x182b10(0x195)+_0x214213);const _0x3e2691=await _0x2aa42f[_0x182b10(0x1a6)]();return await lockNoti(_0x182b10(0x1b0),'',0xbb8),_0x3e2691;}catch(_0x2c53c2){if(_0x1b0267===0x1)throw _0x2c53c2;}}return![];}export async function dpRefreshToken(){var _0x2176cf=a0_0x5931ee;if(!localStorage[_0x2176cf(0x18e)](_0x2176cf(0x15e)))throw _0x2176cf(0x15a);try{const _0x22272d=await fetch(_0x2176cf(0x182),{'method':_0x2176cf(0x187),'headers':{'Content-Type':_0x2176cf(0x188)},'body':_0x2176cf(0x17d)+localStorage[_0x2176cf(0x18e)](_0x2176cf(0x15e))+_0x2176cf(0x16b)}),_0x30aa6e=await _0x22272d[_0x2176cf(0x1a6)]();if(!_0x30aa6e[_0x2176cf(0x159)])return localStorage[_0x2176cf(0x19f)](_0x2176cf(0x196),_0x30aa6e[_0x2176cf(0x158)]),await lockNoti(_0x2176cf(0x1b6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x30aa6e[_0x2176cf(0x15f)]||_0x2176cf(0x162));}catch(_0x3e361c){console['error'](_0x2176cf(0x1ab),_0x3e361c);}return![];}export async function dpUploadFile(_0x294720,_0x3524a1,_0x2307e6){var _0x2363b1=a0_0x5931ee;const _0x1dea9c=localStorage['getItem'](_0x2363b1(0x184));var _0x44a2cb=JSON[_0x2363b1(0x154)]({'autorename':!![],'mode':_0x2363b1(0x18b),'mute':!![],'strict_conflict':![],'path':'/'+_0x1dea9c+'/'+_0x2307e6+'/'+_0x294720}),_0x5c058b=new Blob([_0x3524a1],{'type':_0x2363b1(0x16e)});for(var _0x262107=0x0;_0x262107<0x2;_0x262107++){var _0x2a718c=await fetch(_0x2363b1(0x181),{'method':_0x2363b1(0x187),'headers':{'Authorization':_0x2363b1(0x1ae)+localStorage[_0x2363b1(0x18e)](_0x2363b1(0x196)),'Dropbox-API-Arg':_0x44a2cb,'Content-Type':_0x2363b1(0x16e)},'body':_0x5c058b});if(_0x2a718c[_0x2363b1(0x19c)]!=0xc8){if(_0x2a718c[_0x2363b1(0x19c)]==0x191){var _0x5f56e3=await dpRefreshToken();if(!_0x5f56e3)throw _0x2363b1(0x176);continue;}else throw _0x2363b1(0x165)+_0x2a718c[_0x2363b1(0x19c)];}else{var _0x5c92ae=await _0x2a718c[_0x2363b1(0x1a6)]();return console[_0x2363b1(0x150)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x294720),_0x5c92ae;}}return![];}function a0_0x2c21(){var _0x154dc9=['&redirect_uri=','.tag','click','No\x20files\x20found\x20to\x20restore.','Unable\x20to\x20refresh\x20token','addEventListener','knh3uz2mx2hp2eu','alert','uid','3641496ToYqjs','28361484TGZkzT','refresh_token=','authorization_code','5486642cRaMuC','code','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/oauth2/token','https://www.dropbox.com/oauth2/authorize?client_id=','uId','\x20files\x20from\x20Cloud?','blob','POST','application/x-www-form-urlencoded','replace','confirm','overwrite','screenshot','Restore\x20canceled\x20by\x20user.','getItem','downloadFileInCloud','Authorization\x20Code:','name','\x20files\x20in\x20Kabu?','classList','Failed\x20to\x20upload\x20file\x20','Error\x20creating\x20folder\x20','accessToken','Restoring...','open','=([^&#]*)','Cloud\x20login\x20required!','https://api.dropboxapi.com/2/files/list_folder','status','folder','save','setItem','Do\x20you\x20want\x20to\x20logout?','5rVWNdP','Do\x20not\x20receive\x20authorization','uploadFileInCloud','length','https://content.dropboxapi.com/2/files/download','json','nwb3dnfh09rhs31','onload','state','filter','Error\x20while\x20refreshing\x20token:','href','2232948gcxDmd','Bearer\x20','split','Folder\x20created','/data/','&response_type=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','remove','Wait\x20a\x20little\x20bit...','Refreshing\x20token...','file','log','push','listFiles','Cloud\x20↦\x20Kabu\x20storage\x20◆','stringify','&client_id=','send','setRequestHeader','access_token','error','No\x20refresh\x20token','Download\x20failed\x20for\x20','4goMXyq','Folder\x20already\x20exists','refreshToken','error_description','DOMContentLoaded','[\x5c?&#]','Failed\x20to\x20refresh\x20Dropbox\x20token.','425533LlhiEH','1557844UCdvzl','Upload\x20failed,\x20unknown\x20http\x20status:\x20','3643812JwwQUZ','application/json','&token_access_type=','Backing\x20up...','location','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20backup\x20','Do\x20you\x20want\x20to\x20restore\x20','application/octet-stream','active','code=','parse'];a0_0x2c21=function(){return _0x154dc9;};return a0_0x2c21();}export async function dpDownloadFile(_0x146482,_0x12a15a){var _0x5298e6=a0_0x5931ee;const _0x111545=localStorage[_0x5298e6(0x18e)](_0x5298e6(0x184));var _0x557e95=JSON[_0x5298e6(0x154)]({'path':'/'+_0x111545+'/'+_0x12a15a+'/'+_0x146482});for(var _0x392be1=0x0;_0x392be1<0x2;_0x392be1++){var _0x15000e=await fetch(_0x5298e6(0x1a5),{'method':_0x5298e6(0x187),'headers':{'Authorization':_0x5298e6(0x1ae)+localStorage[_0x5298e6(0x18e)]('accessToken'),'Dropbox-API-Arg':_0x557e95}});if(_0x15000e[_0x5298e6(0x19c)]!=0xc8){if(_0x15000e[_0x5298e6(0x19c)]==0x191){var _0x984d7=await dpRefreshToken();if(!_0x984d7)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x15000e['status'];}const _0x355f07=new File([await _0x15000e[_0x5298e6(0x186)]()],_0x146482);return console[_0x5298e6(0x150)](_0x5298e6(0x153),_0x355f07[_0x5298e6(0x191)]),a0_0x11ffe6[_0x5298e6(0x1a3)](_0x355f07,()=>{}),_0x355f07;}return![];}document[a0_0x5931ee(0x177)](a0_0x5931ee(0x160),function(){var _0x39366f=a0_0x5931ee;dropboxRestore[_0x39366f(0x177)](_0x39366f(0x174),async function(){var _0x1ba8f1=_0x39366f;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1e732f=localStorage[_0x1ba8f1(0x18e)](_0x1ba8f1(0x184)),_0x69600b=[_0x1ba8f1(0x1a9),_0x1ba8f1(0x19e),_0x1ba8f1(0x18c)];if(!_0x1e732f){window[_0x1ba8f1(0x179)](_0x1ba8f1(0x19a));return;}let _0x27d6e7=[];for(const _0x12a8a3 of _0x69600b){let _0x3a534b={'path':'/'+_0x1e732f+'/'+_0x12a8a3};for(let _0x275328=0x0;_0x275328<0x2;_0x275328++){let _0x3b8b09=await fetch(_0x1ba8f1(0x19b),{'method':_0x1ba8f1(0x187),'headers':{'Authorization':_0x1ba8f1(0x1ae)+localStorage[_0x1ba8f1(0x18e)](_0x1ba8f1(0x196)),'Content-Type':_0x1ba8f1(0x167)},'body':JSON[_0x1ba8f1(0x154)](_0x3a534b)});if(_0x3b8b09['status']===0xc8){let _0x250caf=await _0x3b8b09[_0x1ba8f1(0x1a6)](),_0x3dc569=_0x250caf['entries'][_0x1ba8f1(0x1aa)](_0x2eb962=>_0x2eb962[_0x1ba8f1(0x173)]===_0x1ba8f1(0x1b7));_0x3dc569[_0x1ba8f1(0x1a4)]>0x0&&_0x27d6e7[_0x1ba8f1(0x151)](..._0x3dc569['map'](_0x152689=>({'name':_0x152689[_0x1ba8f1(0x191)],'folder':_0x12a8a3})));break;}else{if(_0x3b8b09[_0x1ba8f1(0x19c)]===0x191){let _0x413e93=await dpRefreshToken();if(!_0x413e93)throw _0x1ba8f1(0x176);}else{console[_0x1ba8f1(0x159)](_0x1ba8f1(0x15b)+_0x12a8a3+',\x20status:\x20'+_0x3b8b09[_0x1ba8f1(0x19c)]);break;}}}}if(_0x27d6e7['length']>0x0){const _0x20b38b=_0x1ba8f1(0x16d)+_0x27d6e7['length']+_0x1ba8f1(0x185);if(window[_0x1ba8f1(0x18a)](_0x20b38b))for(const _0x3e5a83 of _0x27d6e7){await lockNoti(_0x1ba8f1(0x197),_0x3e5a83[_0x1ba8f1(0x191)],0xbb8),await dpDownloadFile(_0x3e5a83['name'],_0x3e5a83[_0x1ba8f1(0x19d)]);}else console[_0x1ba8f1(0x150)](_0x1ba8f1(0x18d));}else console[_0x1ba8f1(0x150)](_0x1ba8f1(0x175));}),dropboxBackup[_0x39366f(0x177)]('click',async function(){var _0x4e0e83=_0x39366f;await lockNoti(_0x4e0e83(0x1b5),'',0x1388);const _0x356848=localStorage[_0x4e0e83(0x18e)](_0x4e0e83(0x184));if(_0x356848===null||_0x356848==='')window[_0x4e0e83(0x179)]('Cloud\x20login\x20required!');else{const _0x474ea4=[_0x4e0e83(0x1a9),_0x4e0e83(0x19e),_0x4e0e83(0x18c)];for(const _0x302265 of _0x474ea4){await dpCreateFolder(_0x302265);}let _0x2f0c0e=0x0;for(const _0x175a53 of _0x474ea4){const _0x2c6d34=a0_0x11ffe6[_0x4e0e83(0x152)](_0x175a53+'s');_0x2f0c0e+=_0x2c6d34[_0x4e0e83(0x1a4)];}if(window[_0x4e0e83(0x18a)](_0x4e0e83(0x16c)+_0x2f0c0e+_0x4e0e83(0x192)))for(const _0xf19440 of _0x474ea4){const _0x364adc=a0_0x11ffe6[_0x4e0e83(0x152)](_0xf19440+'s');for(const _0x5930a9 of _0x364adc){const _0x3e52b0=await a0_0x11ffe6[_0x4e0e83(0x18f)](_0x4e0e83(0x1b1)+_0xf19440+'s/'+_0x5930a9);try{await lockNoti(_0x4e0e83(0x169),_0x5930a9,0xbb8),await dpUploadFile(_0x5930a9,_0x3e52b0,_0xf19440);}catch(_0x4fad87){console['error'](_0x4e0e83(0x194)+_0x5930a9+':',_0x4fad87);}}}else console['log'](_0x4e0e83(0x18d));}}),dropboxCloud[_0x39366f(0x177)](_0x39366f(0x174),function(){var _0x4880d5=_0x39366f;const _0x366c11=localStorage[_0x4880d5(0x18e)](_0x4880d5(0x184));_0x366c11===null||_0x366c11===''?authorizeWithDropbox():window[_0x4880d5(0x18a)](_0x4880d5(0x1a0))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x4880d5(0x193)]['remove'](_0x4880d5(0x16f)),dropboxBackup[_0x4880d5(0x193)][_0x4880d5(0x1b4)](_0x4880d5(0x16f)),dropboxCloud[_0x4880d5(0x193)][_0x4880d5(0x1b4)](_0x4880d5(0x16f)));}),handleDropboxCallback();});