function a0_0xa5c7(_0x11f114,_0x1aaca5){var _0x2ff11d=a0_0x2ff1();return a0_0xa5c7=function(_0xa5c7f7,_0x5aab04){_0xa5c7f7=_0xa5c7f7-0x109;var _0xd28a65=_0x2ff11d[_0xa5c7f7];return _0xd28a65;},a0_0xa5c7(_0x11f114,_0x1aaca5);}var a0_0x5a96c2=a0_0xa5c7;(function(_0x47f0a9,_0x51e9e1){var _0x1c3c86=a0_0xa5c7,_0xe9463f=_0x47f0a9();while(!![]){try{var _0x3afc87=-parseInt(_0x1c3c86(0x11a))/0x1+-parseInt(_0x1c3c86(0x152))/0x2*(parseInt(_0x1c3c86(0x16c))/0x3)+-parseInt(_0x1c3c86(0x12e))/0x4+parseInt(_0x1c3c86(0x14a))/0x5+-parseInt(_0x1c3c86(0x149))/0x6+parseInt(_0x1c3c86(0x124))/0x7*(parseInt(_0x1c3c86(0x128))/0x8)+parseInt(_0x1c3c86(0x167))/0x9;if(_0x3afc87===_0x51e9e1)break;else _0xe9463f['push'](_0xe9463f['shift']());}catch(_0x440664){_0xe9463f['push'](_0xe9463f['shift']());}}}(a0_0x2ff1,0x8bffb));import*as a0_0x25f279 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5a96c2(0x166),clientSecret=a0_0x5a96c2(0x154);function authorizeWithDropbox(){var _0x270ec3=a0_0x5a96c2,_0x1ccb20=window[_0x270ec3(0x11c)]['href'][_0x270ec3(0x168)]('?')[0x0],_0x1723da=_0x270ec3(0x15b),_0x1b98cf=_0x270ec3(0x13e),_0x32a6f1=_0x270ec3(0x14b)+clientId+_0x270ec3(0x161)+_0x1723da+_0x270ec3(0x163)+_0x1b98cf+_0x270ec3(0x13c)+encodeURIComponent(_0x1ccb20);window[_0x270ec3(0x11c)][_0x270ec3(0x12d)]=_0x32a6f1;}function handleDropboxCallback(){var _0x4c5e29=a0_0x5a96c2,_0x3d3342=getUrlParameter(_0x4c5e29(0x15b));_0x3d3342?(getAccessToken(_0x3d3342),console[_0x4c5e29(0x157)](_0x4c5e29(0x15f),_0x3d3342)):console[_0x4c5e29(0x157)](_0x4c5e29(0x10c));}function getUrlParameter(_0x44f9e2){var _0x5226e0=a0_0x5a96c2;_0x44f9e2=_0x44f9e2[_0x5226e0(0x150)](/[\[]/,'\x5c[')[_0x5226e0(0x150)](/[\]]/,'\x5c]');var _0x519d69=new RegExp('[\x5c?&#]'+_0x44f9e2+_0x5226e0(0x10f)),_0x4af6ca=_0x519d69[_0x5226e0(0x112)](location['search']);return _0x4af6ca===null?'':decodeURIComponent(_0x4af6ca[0x1][_0x5226e0(0x150)](/\+/g,'\x20'));}function a0_0x2ff1(){var _0x3c0445=['Cloud\x20login\x20required!','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&client_id=','downloadFileInCloud','7PLDjtp','https://api.dropbox.com/oauth2/token','Folder\x20already\x20exists','name','861064IJZbeP','stringify','Cloud\x20↦\x20Kabu\x20storage\x20◆','active','file','href','3521000TjoYTZ','parse','authorization_code','access_token','No\x20files\x20found\x20to\x20restore.','.tag','\x20files\x20in\x20Kabu?','Failed\x20to\x20refresh\x20Dropbox\x20token.','Download\x20failed,\x20unknown\x20http\x20status:','classList','uid','error','https://api.dropboxapi.com/2/files/list_folder','Bearer\x20','&redirect_uri=','uId','offline','status','error_description','length','Wait\x20a\x20little\x20bit...','Backing\x20up...','application/json','application/x-www-form-urlencoded','json','Restoring...','application/octet-stream','1746012ASTLEn','1184075gAmaof','https://www.dropbox.com/oauth2/authorize?client_id=','https://api.dropboxapi.com/oauth2/token','&client_secret=','push','folder','replace','setItem','6pYXJoA','Unable\x20to\x20refresh\x20token','nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20logout?','accessToken','log','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','getItem','Do\x20you\x20want\x20to\x20restore\x20','code','POST','click','filter','Authorization\x20Code:','/data/','&response_type=','refresh_token','&token_access_type=','Refreshing\x20token...','DOMContentLoaded','knh3uz2mx2hp2eu','17325558lRqzAs','split','&grant_type=','listFiles','Download\x20failed\x20for\x20','389106KSuRFz',',\x20status:\x20','confirm','Failed\x20to\x20upload\x20file\x20','Do\x20not\x20receive\x20authorization','addEventListener','alert','=([^&#]*)','send','refreshToken','exec','responseText','entries','Do\x20you\x20want\x20to\x20backup\x20','overwrite','screenshot','Restore\x20canceled\x20by\x20user.','Content-Type','135717LRVFKb','remove','location','state','Kabu\x20storage\x20↦\x20Cloud\x20◆','save'];a0_0x2ff1=function(){return _0x3c0445;};return a0_0x2ff1();}function getAccessToken(_0x205221){var _0x2350b6=a0_0x5a96c2,_0x3346f0=_0x2350b6(0x130),_0x1bda49=window[_0x2350b6(0x11c)][_0x2350b6(0x12d)]['split']('?')[0x0],_0x815577=new XMLHttpRequest();_0x815577['open'](_0x2350b6(0x15c),_0x2350b6(0x125)),_0x815577['setRequestHeader'](_0x2350b6(0x119),_0x2350b6(0x145)),_0x815577['onload']=function(){var _0x170c08=_0x2350b6;if(_0x815577[_0x170c08(0x13f)]===0xc8){var _0x3dea88=JSON[_0x170c08(0x12f)](_0x815577[_0x170c08(0x113)]),_0x1ff0ca=_0x3dea88[_0x170c08(0x131)],_0x4acbd8=_0x3dea88[_0x170c08(0x162)],_0x348633=_0x3dea88[_0x170c08(0x138)];localStorage[_0x170c08(0x151)]('accessToken',_0x1ff0ca),localStorage[_0x170c08(0x151)](_0x170c08(0x111),_0x4acbd8),localStorage[_0x170c08(0x151)](_0x170c08(0x13d),_0x348633);}else console[_0x170c08(0x157)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x815577[_0x2350b6(0x110)]('code='+_0x205221+_0x2350b6(0x169)+_0x3346f0+_0x2350b6(0x122)+clientId+_0x2350b6(0x14d)+clientSecret+_0x2350b6(0x13c)+encodeURIComponent(_0x1bda49));}export async function dpCreateFolder(_0x21c11d){var _0x51915a=a0_0x5a96c2;const _0x3b7285=localStorage[_0x51915a(0x159)](_0x51915a(0x13d));let _0x114098=localStorage[_0x51915a(0x159)](_0x51915a(0x156));const _0x3bc7fa='/'+_0x3b7285+'/'+_0x21c11d,_0x46a1d4=JSON['stringify']({'path':_0x3bc7fa,'autorename':![]});for(let _0x12754f=0x0;_0x12754f<0x2;_0x12754f++){try{const _0x6b893d=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x51915a(0x15c),'headers':{'Authorization':_0x51915a(0x13b)+_0x114098,'Content-Type':_0x51915a(0x144)},'body':_0x46a1d4});if(_0x6b893d[_0x51915a(0x13f)]===0x191){const _0x328af8=await dpRefreshToken();if(!_0x328af8)throw new Error(_0x51915a(0x153));_0x114098=localStorage[_0x51915a(0x159)]('accessToken');continue;}if(_0x6b893d[_0x51915a(0x13f)]===0x199)return{'message':_0x51915a(0x126),'path':_0x21c11d};if(!_0x6b893d['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x21c11d);const _0x12fdd1=await _0x6b893d[_0x51915a(0x146)]();return await lockNoti('Folder\x20created','',0xbb8),_0x12fdd1;}catch(_0x2ceb51){if(_0x12754f===0x1)throw _0x2ceb51;}}return![];}export async function dpRefreshToken(){var _0x5c35d8=a0_0x5a96c2;if(!localStorage[_0x5c35d8(0x159)](_0x5c35d8(0x111)))throw'No\x20refresh\x20token';try{const _0x3c613e=await fetch(_0x5c35d8(0x14c),{'method':_0x5c35d8(0x15c),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage['getItem']('refreshToken')+_0x5c35d8(0x158)}),_0x3912d9=await _0x3c613e[_0x5c35d8(0x146)]();if(!_0x3912d9[_0x5c35d8(0x139)])return localStorage[_0x5c35d8(0x151)](_0x5c35d8(0x156),_0x3912d9[_0x5c35d8(0x131)]),await lockNoti(_0x5c35d8(0x164),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3912d9[_0x5c35d8(0x140)]||_0x5c35d8(0x135));}catch(_0x44f00b){console[_0x5c35d8(0x139)]('Error\x20while\x20refreshing\x20token:',_0x44f00b);}return![];}export async function dpUploadFile(_0x3ac8e8,_0x4a1f17,_0x1f8171){var _0x560460=a0_0x5a96c2;const _0x41886f=localStorage[_0x560460(0x159)]('uId');var _0x394337=JSON['stringify']({'autorename':!![],'mode':_0x560460(0x116),'mute':!![],'strict_conflict':![],'path':'/'+_0x41886f+'/'+_0x1f8171+'/'+_0x3ac8e8}),_0x5d30f3=new Blob([_0x4a1f17],{'type':_0x560460(0x148)});for(var _0x10e7d5=0x0;_0x10e7d5<0x2;_0x10e7d5++){var _0x14da58=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x560460(0x15c),'headers':{'Authorization':_0x560460(0x13b)+localStorage[_0x560460(0x159)](_0x560460(0x156)),'Dropbox-API-Arg':_0x394337,'Content-Type':_0x560460(0x148)},'body':_0x5d30f3});if(_0x14da58[_0x560460(0x13f)]!=0xc8){if(_0x14da58[_0x560460(0x13f)]==0x191){var _0x1b7280=await dpRefreshToken();if(!_0x1b7280)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x560460(0x121)+_0x14da58['status'];}else{var _0x48b704=await _0x14da58['json']();return console['log'](_0x560460(0x11e),_0x3ac8e8),_0x48b704;}}return![];}export async function dpDownloadFile(_0x5d9877,_0x27ad91){var _0x1052da=a0_0x5a96c2;const _0x343c29=localStorage[_0x1052da(0x159)](_0x1052da(0x13d));var _0x2bf79c=JSON[_0x1052da(0x129)]({'path':'/'+_0x343c29+'/'+_0x27ad91+'/'+_0x5d9877});for(var _0x4d59a7=0x0;_0x4d59a7<0x2;_0x4d59a7++){var _0x346495=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1052da(0x15c),'headers':{'Authorization':_0x1052da(0x13b)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x2bf79c}});if(_0x346495[_0x1052da(0x13f)]!=0xc8){if(_0x346495[_0x1052da(0x13f)]==0x191){var _0x414333=await dpRefreshToken();if(!_0x414333)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x1052da(0x136)+_0x346495[_0x1052da(0x13f)];}const _0x5d7ad3=new File([await _0x346495['blob']()],_0x5d9877);return console[_0x1052da(0x157)](_0x1052da(0x12a),_0x5d7ad3['name']),a0_0x25f279['uploadFileInCloud'](_0x5d7ad3,()=>{}),_0x5d7ad3;}return![];}document[a0_0x5a96c2(0x10d)](a0_0x5a96c2(0x165),function(){var _0x4af0d6=a0_0x5a96c2;dropboxRestore[_0x4af0d6(0x10d)]('click',async function(){var _0x27074a=_0x4af0d6;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x512386=localStorage[_0x27074a(0x159)](_0x27074a(0x13d)),_0x581b51=[_0x27074a(0x11d),_0x27074a(0x11f),_0x27074a(0x117)];if(!_0x512386){window['alert']('Cloud\x20login\x20required!');return;}let _0x1c6363=[];for(const _0x5f2d6b of _0x581b51){let _0x5d7d63={'path':'/'+_0x512386+'/'+_0x5f2d6b};for(let _0x1c0a10=0x0;_0x1c0a10<0x2;_0x1c0a10++){let _0x575675=await fetch(_0x27074a(0x13a),{'method':_0x27074a(0x15c),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x27074a(0x159)](_0x27074a(0x156)),'Content-Type':'application/json'},'body':JSON[_0x27074a(0x129)](_0x5d7d63)});if(_0x575675[_0x27074a(0x13f)]===0xc8){let _0x586b7f=await _0x575675[_0x27074a(0x146)](),_0xe32ae3=_0x586b7f[_0x27074a(0x114)][_0x27074a(0x15e)](_0x2ebcc2=>_0x2ebcc2[_0x27074a(0x133)]===_0x27074a(0x12c));_0xe32ae3[_0x27074a(0x141)]>0x0&&_0x1c6363[_0x27074a(0x14e)](..._0xe32ae3['map'](_0x4d6702=>({'name':_0x4d6702['name'],'folder':_0x5f2d6b})));break;}else{if(_0x575675[_0x27074a(0x13f)]===0x191){let _0x1f2bfa=await dpRefreshToken();if(!_0x1f2bfa)throw _0x27074a(0x153);}else{console[_0x27074a(0x139)](_0x27074a(0x16b)+_0x5f2d6b+_0x27074a(0x109)+_0x575675[_0x27074a(0x13f)]);break;}}}}if(_0x1c6363[_0x27074a(0x141)]>0x0){const _0x344f52=_0x27074a(0x15a)+_0x1c6363['length']+'\x20files\x20from\x20Cloud?';if(window[_0x27074a(0x10a)](_0x344f52))for(const _0x45d653 of _0x1c6363){await lockNoti(_0x27074a(0x147),_0x45d653[_0x27074a(0x127)],0xbb8),await dpDownloadFile(_0x45d653[_0x27074a(0x127)],_0x45d653[_0x27074a(0x14f)]);}else console[_0x27074a(0x157)](_0x27074a(0x118));}else console[_0x27074a(0x157)](_0x27074a(0x132));}),dropboxBackup[_0x4af0d6(0x10d)](_0x4af0d6(0x15d),async function(){var _0x5df44d=_0x4af0d6;await lockNoti(_0x5df44d(0x142),'',0x1388);const _0x4a4386=localStorage['getItem'](_0x5df44d(0x13d));if(_0x4a4386===null||_0x4a4386==='')window[_0x5df44d(0x10e)](_0x5df44d(0x120));else{const _0x3eea1d=[_0x5df44d(0x11d),'save',_0x5df44d(0x117)];for(const _0x420373 of _0x3eea1d){await dpCreateFolder(_0x420373);}let _0x44ef5d=0x0;for(const _0x3d8739 of _0x3eea1d){const _0x4f6148=a0_0x25f279[_0x5df44d(0x16a)](_0x3d8739+'s');_0x44ef5d+=_0x4f6148['length'];}if(window[_0x5df44d(0x10a)](_0x5df44d(0x115)+_0x44ef5d+_0x5df44d(0x134)))for(const _0x226b0f of _0x3eea1d){const _0x11a4a3=a0_0x25f279['listFiles'](_0x226b0f+'s');for(const _0x13c707 of _0x11a4a3){const _0x187f2b=await a0_0x25f279[_0x5df44d(0x123)](_0x5df44d(0x160)+_0x226b0f+'s/'+_0x13c707);try{await lockNoti(_0x5df44d(0x143),_0x13c707,0xbb8),await dpUploadFile(_0x13c707,_0x187f2b,_0x226b0f);}catch(_0x59c2cc){console[_0x5df44d(0x139)](_0x5df44d(0x10b)+_0x13c707+':',_0x59c2cc);}}}else console[_0x5df44d(0x157)](_0x5df44d(0x118));}}),dropboxCloud['addEventListener'](_0x4af0d6(0x15d),function(){var _0x23c841=_0x4af0d6;const _0x4c7a40=localStorage['getItem'](_0x23c841(0x13d));_0x4c7a40===null||_0x4c7a40===''?authorizeWithDropbox():window['confirm'](_0x23c841(0x155))&&(localStorage['setItem'](_0x23c841(0x13d),''),dropboxRestore['classList'][_0x23c841(0x11b)](_0x23c841(0x12b)),dropboxBackup[_0x23c841(0x137)][_0x23c841(0x11b)]('active'),dropboxCloud['classList'][_0x23c841(0x11b)]('active'));}),handleDropboxCallback();});