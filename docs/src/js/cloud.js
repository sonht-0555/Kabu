var a0_0x4cde0d=a0_0x2e70;(function(_0x2433bf,_0x1b4846){var _0x449d21=a0_0x2e70,_0x24c599=_0x2433bf();while(!![]){try{var _0x136401=-parseInt(_0x449d21(0x1bd))/0x1*(-parseInt(_0x449d21(0x1e9))/0x2)+-parseInt(_0x449d21(0x1db))/0x3*(-parseInt(_0x449d21(0x1cd))/0x4)+parseInt(_0x449d21(0x20d))/0x5*(parseInt(_0x449d21(0x1df))/0x6)+-parseInt(_0x449d21(0x1f4))/0x7*(-parseInt(_0x449d21(0x1c0))/0x8)+-parseInt(_0x449d21(0x1b2))/0x9*(-parseInt(_0x449d21(0x1b9))/0xa)+-parseInt(_0x449d21(0x20e))/0xb*(parseInt(_0x449d21(0x1da))/0xc)+-parseInt(_0x449d21(0x1ca))/0xd;if(_0x136401===_0x1b4846)break;else _0x24c599['push'](_0x24c599['shift']());}catch(_0x330424){_0x24c599['push'](_0x24c599['shift']());}}}(a0_0x417e,0x30e02));function a0_0x2e70(_0x1f0c7a,_0x3f8d78){var _0x417e06=a0_0x417e();return a0_0x2e70=function(_0x2e7066,_0x3565ab){_0x2e7066=_0x2e7066-0x1a8;var _0xb8f3fb=_0x417e06[_0x2e7066];return _0xb8f3fb;},a0_0x2e70(_0x1f0c7a,_0x3f8d78);}import*as a0_0x3a8f4d from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x417e(){var _0x2bc7b6=['Authorization\x20Code:','No\x20refresh\x20token','&client_id=','&token_access_type=','https://content.dropboxapi.com/2/files/download','POST','href','downloadFileInCloud','listFiles','Backing\x20up...','refresh_token=','state','Wait\x20a\x20little\x20bit...','search','[\x5c?&#]','refresh_token','open','&grant_type=','25vRtAZH','10571SuufvX','location','access_token','Do\x20you\x20want\x20to\x20backup\x20','Restoring...','Failed\x20to\x20upload\x20file\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','getItem','Error\x20while\x20refreshing\x20token:','/data/','remove','setItem','replace','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','47484qQysIu','addEventListener','split','Error\x20creating\x20folder\x20','Unable\x20to\x20refresh\x20token','application/json','application/x-www-form-urlencoded','560InIGTk','No\x20files\x20found\x20to\x20restore.','code','Upload\x20failed,\x20unknown\x20http\x20status:\x20','1VMONHM','https://www.dropbox.com/oauth2/authorize?client_id=','length','64YVaMou','onload','\x20files\x20from\x20Cloud?','&redirect_uri=','save','stringify','responseText','offline','push','Do\x20not\x20receive\x20authorization','15391090GYehsx','Download\x20failed,\x20unknown\x20http\x20status:','log','5968LglbxB','click','Cloud\x20login\x20required!','screenshot','uId','file','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Bearer\x20','&client_secret=','Folder\x20already\x20exists','active','setRequestHeader','entries','240RJZPon','618PSHCcn','error','Do\x20you\x20want\x20to\x20logout?','application/octet-stream','370686fXgDgu','exec','confirm','accessToken','https://api.dropboxapi.com/2/files/create_folder_v2','Content-Type','send','refreshToken','overwrite','Cloud\x20↦\x20Kabu\x20storage\x20◆','381422cUnIzF','&response_type=','filter','name','Failed\x20to\x20refresh\x20Dropbox\x20token.','Folder\x20created','nwb3dnfh09rhs31','parse','DOMContentLoaded','Restore\x20canceled\x20by\x20user.','https://api.dropboxapi.com/oauth2/token','263305KNBCQR','classList','https://api.dropboxapi.com/2/files/list_folder','uploadFileInCloud','status','Do\x20you\x20want\x20to\x20restore\x20','json'];a0_0x417e=function(){return _0x2bc7b6;};return a0_0x417e();}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x4cde0d(0x1ef);function authorizeWithDropbox(){var _0x4471b1=a0_0x4cde0d,_0x39e42e=window[_0x4471b1(0x20f)][_0x4471b1(0x201)][_0x4471b1(0x1b4)]('?')[0x0],_0x3629ca=_0x4471b1(0x1bb),_0x31f5f3=_0x4471b1(0x1c7),_0xf36e34=_0x4471b1(0x1be)+clientId+_0x4471b1(0x1ea)+_0x3629ca+_0x4471b1(0x1fe)+_0x31f5f3+'&redirect_uri='+encodeURIComponent(_0x39e42e);window[_0x4471b1(0x20f)][_0x4471b1(0x201)]=_0xf36e34;}function handleDropboxCallback(){var _0x45c776=a0_0x4cde0d,_0x25dba2=getUrlParameter(_0x45c776(0x1bb));_0x25dba2?(getAccessToken(_0x25dba2),console[_0x45c776(0x1cc)](_0x45c776(0x1fb),_0x25dba2)):console[_0x45c776(0x1cc)](_0x45c776(0x1c9));}function getUrlParameter(_0x3ed0fa){var _0x2445b4=a0_0x4cde0d;_0x3ed0fa=_0x3ed0fa['replace'](/[\[]/,'\x5c[')[_0x2445b4(0x1b0)](/[\]]/,'\x5c]');var _0x38c2d4=new RegExp(_0x2445b4(0x209)+_0x3ed0fa+'=([^&#]*)'),_0x16eb5a=_0x38c2d4[_0x2445b4(0x1e0)](location[_0x2445b4(0x208)]);return _0x16eb5a===null?'':decodeURIComponent(_0x16eb5a[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x3761c1){var _0x3d8c73=a0_0x4cde0d,_0x2529f5='authorization_code',_0x1b58db=window[_0x3d8c73(0x20f)][_0x3d8c73(0x201)]['split']('?')[0x0],_0x235ebc=new XMLHttpRequest();_0x235ebc[_0x3d8c73(0x20b)](_0x3d8c73(0x200),'https://api.dropbox.com/oauth2/token'),_0x235ebc[_0x3d8c73(0x1d8)](_0x3d8c73(0x1e4),_0x3d8c73(0x1b8)),_0x235ebc[_0x3d8c73(0x1c1)]=function(){var _0x47dba8=_0x3d8c73;if(_0x235ebc['status']===0xc8){var _0x26b915=JSON[_0x47dba8(0x1f0)](_0x235ebc[_0x47dba8(0x1c6)]),_0x4228ab=_0x26b915[_0x47dba8(0x210)],_0xb0228c=_0x26b915[_0x47dba8(0x20a)],_0x4403d5=_0x26b915['uid'];localStorage[_0x47dba8(0x1af)](_0x47dba8(0x1e2),_0x4228ab),localStorage[_0x47dba8(0x1af)](_0x47dba8(0x1e6),_0xb0228c),localStorage[_0x47dba8(0x1af)](_0x47dba8(0x1d1),_0x4403d5);}else console['log'](_0x47dba8(0x1b1));},_0x235ebc[_0x3d8c73(0x1e5)]('code='+_0x3761c1+_0x3d8c73(0x20c)+_0x2529f5+_0x3d8c73(0x1fd)+clientId+_0x3d8c73(0x1d5)+clientSecret+_0x3d8c73(0x1c3)+encodeURIComponent(_0x1b58db));}export async function dpCreateFolder(_0x134352){var _0xfd7911=a0_0x4cde0d;const _0x30e731=localStorage[_0xfd7911(0x1ab)](_0xfd7911(0x1d1));let _0x46df04=localStorage[_0xfd7911(0x1ab)](_0xfd7911(0x1e2));const _0xc46bcd='/'+_0x30e731+'/'+_0x134352,_0x3fdb7d=JSON[_0xfd7911(0x1c5)]({'path':_0xc46bcd,'autorename':![]});for(let _0x417130=0x0;_0x417130<0x2;_0x417130++){try{const _0x43bbe3=await fetch(_0xfd7911(0x1e3),{'method':_0xfd7911(0x200),'headers':{'Authorization':'Bearer\x20'+_0x46df04,'Content-Type':_0xfd7911(0x1b7)},'body':_0x3fdb7d});if(_0x43bbe3['status']===0x191){const _0x44e2ea=await dpRefreshToken();if(!_0x44e2ea)throw new Error(_0xfd7911(0x1b6));_0x46df04=localStorage['getItem'](_0xfd7911(0x1e2));continue;}if(_0x43bbe3['status']===0x199)return{'message':_0xfd7911(0x1d6),'path':_0x134352};if(!_0x43bbe3['ok'])throw new Error(_0xfd7911(0x1b5)+_0x134352);const _0x4de9ad=await _0x43bbe3[_0xfd7911(0x1fa)]();return await lockNoti(_0xfd7911(0x1ee),'',0xbb8),_0x4de9ad;}catch(_0x4fc126){if(_0x417130===0x1)throw _0x4fc126;}}return![];}export async function dpRefreshToken(){var _0x88a40c=a0_0x4cde0d;if(!localStorage[_0x88a40c(0x1ab)]('refreshToken'))throw _0x88a40c(0x1fc);try{const _0x388ad3=await fetch(_0x88a40c(0x1f3),{'method':_0x88a40c(0x200),'headers':{'Content-Type':_0x88a40c(0x1b8)},'body':_0x88a40c(0x205)+localStorage[_0x88a40c(0x1ab)](_0x88a40c(0x1e6))+_0x88a40c(0x1d3)}),_0x367f70=await _0x388ad3['json']();if(!_0x367f70[_0x88a40c(0x1dc)])return localStorage[_0x88a40c(0x1af)](_0x88a40c(0x1e2),_0x367f70[_0x88a40c(0x210)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x367f70['error_description']||_0x88a40c(0x1ed));}catch(_0x42aa10){console['error'](_0x88a40c(0x1ac),_0x42aa10);}return![];}export async function dpUploadFile(_0x404c83,_0x30545f,_0xb2a1d0){var _0x4e7a72=a0_0x4cde0d;const _0x3607a8=localStorage[_0x4e7a72(0x1ab)]('uId');var _0x3a6fd6=JSON[_0x4e7a72(0x1c5)]({'autorename':!![],'mode':_0x4e7a72(0x1e7),'mute':!![],'strict_conflict':![],'path':'/'+_0x3607a8+'/'+_0xb2a1d0+'/'+_0x404c83}),_0x16ec39=new Blob([_0x30545f],{'type':_0x4e7a72(0x1de)});for(var _0x4f1262=0x0;_0x4f1262<0x2;_0x4f1262++){var _0x3d71de=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x4e7a72(0x200),'headers':{'Authorization':_0x4e7a72(0x1d4)+localStorage[_0x4e7a72(0x1ab)](_0x4e7a72(0x1e2)),'Dropbox-API-Arg':_0x3a6fd6,'Content-Type':_0x4e7a72(0x1de)},'body':_0x16ec39});if(_0x3d71de[_0x4e7a72(0x1f8)]!=0xc8){if(_0x3d71de[_0x4e7a72(0x1f8)]==0x191){var _0x15211b=await dpRefreshToken();if(!_0x15211b)throw _0x4e7a72(0x1b6);continue;}else throw _0x4e7a72(0x1bc)+_0x3d71de[_0x4e7a72(0x1f8)];}else{var _0x3e2885=await _0x3d71de[_0x4e7a72(0x1fa)]();return console[_0x4e7a72(0x1cc)](_0x4e7a72(0x1aa),_0x404c83),_0x3e2885;}}return![];}export async function dpDownloadFile(_0x4edb1c,_0x58c348){var _0x42f9d3=a0_0x4cde0d;const _0xfc41d7=localStorage[_0x42f9d3(0x1ab)](_0x42f9d3(0x1d1));var _0x4b87af=JSON[_0x42f9d3(0x1c5)]({'path':'/'+_0xfc41d7+'/'+_0x58c348+'/'+_0x4edb1c});for(var _0x4da60d=0x0;_0x4da60d<0x2;_0x4da60d++){var _0x3a203=await fetch(_0x42f9d3(0x1ff),{'method':_0x42f9d3(0x200),'headers':{'Authorization':_0x42f9d3(0x1d4)+localStorage[_0x42f9d3(0x1ab)](_0x42f9d3(0x1e2)),'Dropbox-API-Arg':_0x4b87af}});if(_0x3a203['status']!=0xc8){if(_0x3a203[_0x42f9d3(0x1f8)]==0x191){var _0x4fd40e=await dpRefreshToken();if(!_0x4fd40e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x42f9d3(0x1cb)+_0x3a203[_0x42f9d3(0x1f8)];}const _0x3f47e4=new File([await _0x3a203['blob']()],_0x4edb1c);return console[_0x42f9d3(0x1cc)](_0x42f9d3(0x1e8),_0x3f47e4['name']),a0_0x3a8f4d[_0x42f9d3(0x1f7)](_0x3f47e4,()=>{}),_0x3f47e4;}return![];}document['addEventListener'](a0_0x4cde0d(0x1f1),function(){var _0x2e3379=a0_0x4cde0d;dropboxRestore['addEventListener']('click',async function(){var _0x1381c1=a0_0x2e70;await lockNoti(_0x1381c1(0x207),'',0x1388);const _0x1aaec7=localStorage['getItem'](_0x1381c1(0x1d1)),_0x385a7c=[_0x1381c1(0x206),_0x1381c1(0x1c4),_0x1381c1(0x1d0)];if(!_0x1aaec7){window['alert']('Cloud\x20login\x20required!');return;}let _0x3e4b5a=[];for(const _0x3b2fcd of _0x385a7c){let _0x49e2dc={'path':'/'+_0x1aaec7+'/'+_0x3b2fcd};for(let _0x1e3508=0x0;_0x1e3508<0x2;_0x1e3508++){let _0x5395c6=await fetch(_0x1381c1(0x1f6),{'method':_0x1381c1(0x200),'headers':{'Authorization':_0x1381c1(0x1d4)+localStorage[_0x1381c1(0x1ab)](_0x1381c1(0x1e2)),'Content-Type':_0x1381c1(0x1b7)},'body':JSON['stringify'](_0x49e2dc)});if(_0x5395c6[_0x1381c1(0x1f8)]===0xc8){let _0x485e92=await _0x5395c6[_0x1381c1(0x1fa)](),_0xa5e72a=_0x485e92[_0x1381c1(0x1d9)][_0x1381c1(0x1eb)](_0x558e8b=>_0x558e8b['.tag']===_0x1381c1(0x1d2));_0xa5e72a[_0x1381c1(0x1bf)]>0x0&&_0x3e4b5a[_0x1381c1(0x1c8)](..._0xa5e72a['map'](_0x3adb6f=>({'name':_0x3adb6f['name'],'folder':_0x3b2fcd})));break;}else{if(_0x5395c6[_0x1381c1(0x1f8)]===0x191){let _0x2c8423=await dpRefreshToken();if(!_0x2c8423)throw _0x1381c1(0x1b6);}else{console[_0x1381c1(0x1dc)]('Download\x20failed\x20for\x20'+_0x3b2fcd+',\x20status:\x20'+_0x5395c6[_0x1381c1(0x1f8)]);break;}}}}if(_0x3e4b5a['length']>0x0){const _0x57f81e=_0x1381c1(0x1f9)+_0x3e4b5a[_0x1381c1(0x1bf)]+_0x1381c1(0x1c2);if(window[_0x1381c1(0x1e1)](_0x57f81e))for(const _0x560ae8 of _0x3e4b5a){await lockNoti(_0x1381c1(0x1a8),_0x560ae8[_0x1381c1(0x1ec)],0xbb8),await dpDownloadFile(_0x560ae8['name'],_0x560ae8['folder']);}else console[_0x1381c1(0x1cc)](_0x1381c1(0x1f2));}else console[_0x1381c1(0x1cc)](_0x1381c1(0x1ba));}),dropboxBackup['addEventListener'](_0x2e3379(0x1ce),async function(){var _0x4a5808=_0x2e3379;await lockNoti(_0x4a5808(0x207),'',0x1388);const _0x255d09=localStorage['getItem'](_0x4a5808(0x1d1));if(_0x255d09===null||_0x255d09==='')window['alert'](_0x4a5808(0x1cf));else{const _0x2f73ef=[_0x4a5808(0x206),_0x4a5808(0x1c4),'screenshot'];for(const _0x4f8c01 of _0x2f73ef){await dpCreateFolder(_0x4f8c01);}let _0x130ec5=0x0;for(const _0x1586da of _0x2f73ef){const _0xb56a98=a0_0x3a8f4d[_0x4a5808(0x203)](_0x1586da+'s');_0x130ec5+=_0xb56a98['length'];}if(window['confirm'](_0x4a5808(0x211)+_0x130ec5+'\x20files\x20in\x20Kabu?'))for(const _0x33625c of _0x2f73ef){const _0x24b6f8=a0_0x3a8f4d[_0x4a5808(0x203)](_0x33625c+'s');for(const _0xc1270a of _0x24b6f8){const _0x28beb5=await a0_0x3a8f4d[_0x4a5808(0x202)](_0x4a5808(0x1ad)+_0x33625c+'s/'+_0xc1270a);try{await lockNoti(_0x4a5808(0x204),_0xc1270a,0xbb8),await dpUploadFile(_0xc1270a,_0x28beb5,_0x33625c);}catch(_0x5dfd4a){console[_0x4a5808(0x1dc)](_0x4a5808(0x1a9)+_0xc1270a+':',_0x5dfd4a);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x2e3379(0x1b3)]('click',function(){var _0x3b04d2=_0x2e3379;const _0x3957f5=localStorage[_0x3b04d2(0x1ab)](_0x3b04d2(0x1d1));_0x3957f5===null||_0x3957f5===''?authorizeWithDropbox():window['confirm'](_0x3b04d2(0x1dd))&&(localStorage[_0x3b04d2(0x1af)]('uId',''),dropboxRestore['classList'][_0x3b04d2(0x1ae)](_0x3b04d2(0x1d7)),dropboxBackup[_0x3b04d2(0x1f5)][_0x3b04d2(0x1ae)](_0x3b04d2(0x1d7)),dropboxCloud[_0x3b04d2(0x1f5)]['remove']('active'));}),handleDropboxCallback();});