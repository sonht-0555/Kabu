var a0_0x30207d=a0_0x3b05;(function(_0xeaf84f,_0x211601){var _0x1e610d=a0_0x3b05,_0x471952=_0xeaf84f();while(!![]){try{var _0x22d230=parseInt(_0x1e610d(0x1f2))/0x1+-parseInt(_0x1e610d(0x1fb))/0x2*(-parseInt(_0x1e610d(0x1d3))/0x3)+-parseInt(_0x1e610d(0x1c3))/0x4*(-parseInt(_0x1e610d(0x1cf))/0x5)+-parseInt(_0x1e610d(0x1b7))/0x6+parseInt(_0x1e610d(0x1dd))/0x7+parseInt(_0x1e610d(0x1b8))/0x8*(parseInt(_0x1e610d(0x1a1))/0x9)+parseInt(_0x1e610d(0x1da))/0xa*(-parseInt(_0x1e610d(0x1b6))/0xb);if(_0x22d230===_0x211601)break;else _0x471952['push'](_0x471952['shift']());}catch(_0x448a2d){_0x471952['push'](_0x471952['shift']());}}}(a0_0x1b65,0xdcd10));import*as a0_0x435a0b from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x30207d(0x1aa),clientSecret=a0_0x30207d(0x1e8);function authorizeWithDropbox(){var _0x196573=a0_0x30207d,_0xa0905b=window[_0x196573(0x1e4)][_0x196573(0x1eb)]['split']('?')[0x0],_0x1f1ab9=_0x196573(0x1f3),_0x140646=_0x196573(0x1b9),_0xf16b14=_0x196573(0x19e)+clientId+_0x196573(0x1c8)+_0x1f1ab9+_0x196573(0x1e0)+_0x140646+'&redirect_uri='+encodeURIComponent(_0xa0905b);window['location'][_0x196573(0x1eb)]=_0xf16b14;}function handleDropboxCallback(){var _0x9bbfe1=a0_0x30207d,_0x5d3ab4=getUrlParameter(_0x9bbfe1(0x1f3));_0x5d3ab4?(getAccessToken(_0x5d3ab4),console[_0x9bbfe1(0x1a4)](_0x9bbfe1(0x1c7),_0x5d3ab4)):console['log'](_0x9bbfe1(0x202));}function getUrlParameter(_0x48045d){var _0x1b72a2=a0_0x30207d;_0x48045d=_0x48045d[_0x1b72a2(0x1a5)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x3a07ca=new RegExp(_0x1b72a2(0x205)+_0x48045d+_0x1b72a2(0x1ad)),_0x32b944=_0x3a07ca[_0x1b72a2(0x19c)](location[_0x1b72a2(0x203)]);return _0x32b944===null?'':decodeURIComponent(_0x32b944[0x1][_0x1b72a2(0x1a5)](/\+/g,'\x20'));}function getAccessToken(_0x147085){var _0x48661b=a0_0x30207d,_0xfb4f5c=_0x48661b(0x1e7),_0x58c01b=window[_0x48661b(0x1e4)][_0x48661b(0x1eb)][_0x48661b(0x1b0)]('?')[0x0],_0xf91a58=new XMLHttpRequest();_0xf91a58[_0x48661b(0x1ba)](_0x48661b(0x1a3),_0x48661b(0x1e6)),_0xf91a58[_0x48661b(0x1df)](_0x48661b(0x1bf),_0x48661b(0x1e9)),_0xf91a58[_0x48661b(0x206)]=function(){var _0x15843f=_0x48661b;if(_0xf91a58[_0x15843f(0x1f6)]===0xc8){var _0x4f76ce=JSON[_0x15843f(0x1d2)](_0xf91a58[_0x15843f(0x1d5)]),_0x280e55=_0x4f76ce['access_token'],_0x2944cd=_0x4f76ce[_0x15843f(0x1ab)],_0x428cd8=_0x4f76ce[_0x15843f(0x1ac)];localStorage[_0x15843f(0x1f9)](_0x15843f(0x1fd),_0x280e55),localStorage[_0x15843f(0x1f9)](_0x15843f(0x19d),_0x2944cd),localStorage['setItem']('uId',_0x428cd8);}else console[_0x15843f(0x1a4)](_0x15843f(0x1de));},_0xf91a58['send']('code='+_0x147085+_0x48661b(0x1c1)+_0xfb4f5c+_0x48661b(0x1d7)+clientId+_0x48661b(0x1c0)+clientSecret+_0x48661b(0x1fc)+encodeURIComponent(_0x58c01b));}function a0_0x1b65(){var _0x5236b6=['alert','downloadFileInCloud','uploadFileInCloud','Restoring...','9764161ajmshg','5502666eNODxB','56gDMbec','offline','open','Wait\x20a\x20little\x20bit...','Restore\x20canceled\x20by\x20user.','application/json','save','Content-Type','&client_secret=','&grant_type=','Do\x20you\x20want\x20to\x20logout?','8sFVlYN','stringify','error_description','screenshot','Authorization\x20Code:','&response_type=','refresh_token=','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','click',',\x20status:\x20','addEventListener','546170LINLMS','https://api.dropboxapi.com/2/files/create_folder_v2','listFiles','parse','3381435DTlSri','https://api.dropboxapi.com/oauth2/token','responseText','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','&client_id=','file','Error\x20while\x20refreshing\x20token:','50zvylDl','Folder\x20already\x20exists','Backing\x20up...','10743474ScPLsh','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','setRequestHeader','&token_access_type=','json','push','length','location','remove','https://api.dropbox.com/oauth2/token','authorization_code','nwb3dnfh09rhs31','application/x-www-form-urlencoded','access_token','href','folder','Bearer\x20','blob','state','Failed\x20to\x20refresh\x20Dropbox\x20token.','\x20files\x20in\x20Kabu?','1769141ketxET','code','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Folder\x20created','status','https://content.dropboxapi.com/2/files/upload','Download\x20failed\x20for\x20','setItem','uId','2FRrRXL','&redirect_uri=','accessToken','https://content.dropboxapi.com/2/files/download','Error\x20creating\x20folder\x20','overwrite','\x20files\x20from\x20Cloud?','Do\x20not\x20receive\x20authorization','search','error','[\x5c?&#]','onload','getItem','Do\x20you\x20want\x20to\x20backup\x20','exec','refreshToken','https://www.dropbox.com/oauth2/authorize?client_id=','https://api.dropboxapi.com/2/files/list_folder','Unable\x20to\x20refresh\x20token','2070378iZcplA','name','POST','log','replace','entries','confirm','.tag','application/octet-stream','knh3uz2mx2hp2eu','refresh_token','uid','=([^&#]*)','active','filter','split','Cloud\x20login\x20required!'];a0_0x1b65=function(){return _0x5236b6;};return a0_0x1b65();}export async function dpCreateFolder(_0x39b697){var _0x5cc4b8=a0_0x30207d;const _0x40ada4=localStorage['getItem'](_0x5cc4b8(0x1fa));let _0x4405ed=localStorage['getItem'](_0x5cc4b8(0x1fd));const _0x1a4092='/'+_0x40ada4+'/'+_0x39b697,_0x1365f9=JSON[_0x5cc4b8(0x1c4)]({'path':_0x1a4092,'autorename':![]});for(let _0x43e2f6=0x0;_0x43e2f6<0x2;_0x43e2f6++){try{const _0x3aeed4=await fetch(_0x5cc4b8(0x1d0),{'method':'POST','headers':{'Authorization':_0x5cc4b8(0x1ed)+_0x4405ed,'Content-Type':_0x5cc4b8(0x1bd)},'body':_0x1365f9});if(_0x3aeed4[_0x5cc4b8(0x1f6)]===0x191){const _0xd7d90=await dpRefreshToken();if(!_0xd7d90)throw new Error('Unable\x20to\x20refresh\x20token');_0x4405ed=localStorage[_0x5cc4b8(0x19a)](_0x5cc4b8(0x1fd));continue;}if(_0x3aeed4[_0x5cc4b8(0x1f6)]===0x199)return{'message':_0x5cc4b8(0x1db),'path':_0x39b697};if(!_0x3aeed4['ok'])throw new Error(_0x5cc4b8(0x1ff)+_0x39b697);const _0xa8a9c=await _0x3aeed4['json']();return await lockNoti(_0x5cc4b8(0x1f5),'',0xbb8),_0xa8a9c;}catch(_0x425194){if(_0x43e2f6===0x1)throw _0x425194;}}return![];}export async function dpRefreshToken(){var _0x8d1551=a0_0x30207d;if(!localStorage[_0x8d1551(0x19a)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x43c52d=await fetch(_0x8d1551(0x1d4),{'method':_0x8d1551(0x1a3),'headers':{'Content-Type':_0x8d1551(0x1e9)},'body':_0x8d1551(0x1c9)+localStorage[_0x8d1551(0x19a)](_0x8d1551(0x19d))+_0x8d1551(0x1d6)}),_0x231307=await _0x43c52d[_0x8d1551(0x1e1)]();if(!_0x231307[_0x8d1551(0x204)])return localStorage[_0x8d1551(0x1f9)]('accessToken',_0x231307[_0x8d1551(0x1ea)]),await lockNoti(_0x8d1551(0x1ca),'',0xbb8),await delay(0x3e8),!![];else alert(_0x231307[_0x8d1551(0x1c5)]||_0x8d1551(0x1f0));}catch(_0x494e49){console['error'](_0x8d1551(0x1d9),_0x494e49);}return![];}export async function dpUploadFile(_0x1eb694,_0x2b1b9d,_0x992c92){var _0x120446=a0_0x30207d;const _0x58aec3=localStorage[_0x120446(0x19a)](_0x120446(0x1fa));var _0x472dbd=JSON['stringify']({'autorename':!![],'mode':_0x120446(0x200),'mute':!![],'strict_conflict':![],'path':'/'+_0x58aec3+'/'+_0x992c92+'/'+_0x1eb694}),_0x582ae5=new Blob([_0x2b1b9d],{'type':_0x120446(0x1a9)});for(var _0x4a8444=0x0;_0x4a8444<0x2;_0x4a8444++){var _0x4850ae=await fetch(_0x120446(0x1f7),{'method':_0x120446(0x1a3),'headers':{'Authorization':_0x120446(0x1ed)+localStorage[_0x120446(0x19a)](_0x120446(0x1fd)),'Dropbox-API-Arg':_0x472dbd,'Content-Type':'application/octet-stream'},'body':_0x582ae5});if(_0x4850ae[_0x120446(0x1f6)]!=0xc8){if(_0x4850ae[_0x120446(0x1f6)]==0x191){var _0x2a7eec=await dpRefreshToken();if(!_0x2a7eec)throw _0x120446(0x1a0);continue;}else throw _0x120446(0x1f4)+_0x4850ae['status'];}else{var _0x28fe97=await _0x4850ae[_0x120446(0x1e1)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x1eb694),_0x28fe97;}}return![];}function a0_0x3b05(_0x24bb16,_0x2f0107){var _0x1b65c9=a0_0x1b65();return a0_0x3b05=function(_0x3b05f2,_0x411f63){_0x3b05f2=_0x3b05f2-0x19a;var _0x11ed4a=_0x1b65c9[_0x3b05f2];return _0x11ed4a;},a0_0x3b05(_0x24bb16,_0x2f0107);}export async function dpDownloadFile(_0xc4750e,_0x1df339){var _0x1486bd=a0_0x30207d;const _0x2122ed=localStorage[_0x1486bd(0x19a)](_0x1486bd(0x1fa));var _0x4c4525=JSON['stringify']({'path':'/'+_0x2122ed+'/'+_0x1df339+'/'+_0xc4750e});for(var _0x2f959d=0x0;_0x2f959d<0x2;_0x2f959d++){var _0x43c234=await fetch(_0x1486bd(0x1fe),{'method':_0x1486bd(0x1a3),'headers':{'Authorization':_0x1486bd(0x1ed)+localStorage[_0x1486bd(0x19a)](_0x1486bd(0x1fd)),'Dropbox-API-Arg':_0x4c4525}});if(_0x43c234[_0x1486bd(0x1f6)]!=0xc8){if(_0x43c234[_0x1486bd(0x1f6)]==0x191){var _0x31a133=await dpRefreshToken();if(!_0x31a133)throw _0x1486bd(0x1a0);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x43c234['status'];}const _0xc4ecc8=new File([await _0x43c234[_0x1486bd(0x1ee)]()],_0xc4750e);return console[_0x1486bd(0x1a4)](_0x1486bd(0x1cb),_0xc4ecc8[_0x1486bd(0x1a2)]),a0_0x435a0b[_0x1486bd(0x1b4)](_0xc4ecc8,()=>{}),_0xc4ecc8;}return![];}document[a0_0x30207d(0x1ce)]('DOMContentLoaded',function(){var _0x40b3ef=a0_0x30207d;dropboxRestore[_0x40b3ef(0x1ce)]('click',async function(){var _0x4fdc2c=_0x40b3ef;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4cbe52=localStorage[_0x4fdc2c(0x19a)](_0x4fdc2c(0x1fa)),_0x2bb7dc=[_0x4fdc2c(0x1ef),_0x4fdc2c(0x1be),_0x4fdc2c(0x1c6)];if(!_0x4cbe52){window[_0x4fdc2c(0x1b2)](_0x4fdc2c(0x1b1));return;}let _0x5743cb=[];for(const _0x3cfeec of _0x2bb7dc){let _0xc66871={'path':'/'+_0x4cbe52+'/'+_0x3cfeec};for(let _0x3c9608=0x0;_0x3c9608<0x2;_0x3c9608++){let _0x54c5a6=await fetch(_0x4fdc2c(0x19f),{'method':_0x4fdc2c(0x1a3),'headers':{'Authorization':_0x4fdc2c(0x1ed)+localStorage[_0x4fdc2c(0x19a)](_0x4fdc2c(0x1fd)),'Content-Type':'application/json'},'body':JSON[_0x4fdc2c(0x1c4)](_0xc66871)});if(_0x54c5a6[_0x4fdc2c(0x1f6)]===0xc8){let _0x5a231e=await _0x54c5a6[_0x4fdc2c(0x1e1)](),_0x514826=_0x5a231e[_0x4fdc2c(0x1a6)][_0x4fdc2c(0x1af)](_0x47b945=>_0x47b945[_0x4fdc2c(0x1a8)]===_0x4fdc2c(0x1d8));_0x514826[_0x4fdc2c(0x1e3)]>0x0&&_0x5743cb[_0x4fdc2c(0x1e2)](..._0x514826['map'](_0x9b95a1=>({'name':_0x9b95a1[_0x4fdc2c(0x1a2)],'folder':_0x3cfeec})));break;}else{if(_0x54c5a6[_0x4fdc2c(0x1f6)]===0x191){let _0x3ebc9b=await dpRefreshToken();if(!_0x3ebc9b)throw _0x4fdc2c(0x1a0);}else{console[_0x4fdc2c(0x204)](_0x4fdc2c(0x1f8)+_0x3cfeec+_0x4fdc2c(0x1cd)+_0x54c5a6[_0x4fdc2c(0x1f6)]);break;}}}}if(_0x5743cb['length']>0x0){const _0x40f39e='Do\x20you\x20want\x20to\x20restore\x20'+_0x5743cb['length']+_0x4fdc2c(0x201);if(window[_0x4fdc2c(0x1a7)](_0x40f39e))for(const _0xc0d826 of _0x5743cb){await lockNoti(_0x4fdc2c(0x1b5),_0xc0d826[_0x4fdc2c(0x1a2)],0xbb8),await dpDownloadFile(_0xc0d826[_0x4fdc2c(0x1a2)],_0xc0d826[_0x4fdc2c(0x1ec)]);}else console['log'](_0x4fdc2c(0x1bc));}else console[_0x4fdc2c(0x1a4)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x40b3ef(0x1ce)](_0x40b3ef(0x1cc),async function(){var _0x74a9c2=_0x40b3ef;await lockNoti(_0x74a9c2(0x1bb),'',0x1388);const _0xf7aa32=localStorage[_0x74a9c2(0x19a)](_0x74a9c2(0x1fa));if(_0xf7aa32===null||_0xf7aa32==='')window['alert']('Cloud\x20login\x20required!');else{const _0x126abd=['state',_0x74a9c2(0x1be),_0x74a9c2(0x1c6)];for(const _0x53e78c of _0x126abd){await dpCreateFolder(_0x53e78c);}let _0x3433e6=0x0;for(const _0x2bbc5a of _0x126abd){const _0x1a66a9=a0_0x435a0b[_0x74a9c2(0x1d1)](_0x2bbc5a+'s');_0x3433e6+=_0x1a66a9[_0x74a9c2(0x1e3)];}if(window[_0x74a9c2(0x1a7)](_0x74a9c2(0x19b)+_0x3433e6+_0x74a9c2(0x1f1)))for(const _0x4c859f of _0x126abd){const _0x278807=a0_0x435a0b[_0x74a9c2(0x1d1)](_0x4c859f+'s');for(const _0x3ff171 of _0x278807){const _0x491fbd=await a0_0x435a0b[_0x74a9c2(0x1b3)]('/data/'+_0x4c859f+'s/'+_0x3ff171);try{await lockNoti(_0x74a9c2(0x1dc),_0x3ff171,0xbb8),await dpUploadFile(_0x3ff171,_0x491fbd,_0x4c859f);}catch(_0x5f53d2){console[_0x74a9c2(0x204)]('Failed\x20to\x20upload\x20file\x20'+_0x3ff171+':',_0x5f53d2);}}}else console[_0x74a9c2(0x1a4)](_0x74a9c2(0x1bc));}}),dropboxCloud[_0x40b3ef(0x1ce)](_0x40b3ef(0x1cc),function(){var _0x38b0e1=_0x40b3ef;const _0x3add1b=localStorage['getItem']('uId');_0x3add1b===null||_0x3add1b===''?authorizeWithDropbox():window[_0x38b0e1(0x1a7)](_0x38b0e1(0x1c2))&&(localStorage[_0x38b0e1(0x1f9)](_0x38b0e1(0x1fa),''),dropboxRestore['classList'][_0x38b0e1(0x1e5)](_0x38b0e1(0x1ae)),dropboxBackup['classList'][_0x38b0e1(0x1e5)](_0x38b0e1(0x1ae)),dropboxCloud['classList']['remove'](_0x38b0e1(0x1ae)));}),handleDropboxCallback();});