function a0_0x112a(_0x3099ac,_0x2c0b51){var _0x4624f6=a0_0x4624();return a0_0x112a=function(_0x112afb,_0x26bd70){_0x112afb=_0x112afb-0x141;var _0x1d1702=_0x4624f6[_0x112afb];return _0x1d1702;},a0_0x112a(_0x3099ac,_0x2c0b51);}var a0_0x516e6c=a0_0x112a;(function(_0x2cfe24,_0x5dce73){var _0x413345=a0_0x112a,_0x4ac906=_0x2cfe24();while(!![]){try{var _0x1730ee=-parseInt(_0x413345(0x15a))/0x1+-parseInt(_0x413345(0x176))/0x2+-parseInt(_0x413345(0x14b))/0x3*(-parseInt(_0x413345(0x145))/0x4)+parseInt(_0x413345(0x17b))/0x5+-parseInt(_0x413345(0x178))/0x6+parseInt(_0x413345(0x174))/0x7+parseInt(_0x413345(0x156))/0x8;if(_0x1730ee===_0x5dce73)break;else _0x4ac906['push'](_0x4ac906['shift']());}catch(_0x4c25cb){_0x4ac906['push'](_0x4ac906['shift']());}}}(a0_0x4624,0xbfeaa));import*as a0_0x10acc5 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x516e6c(0x186),clientSecret=a0_0x516e6c(0x1a0);function authorizeWithDropbox(){var _0x1a987f=a0_0x516e6c,_0x3477d4=window[_0x1a987f(0x18d)][_0x1a987f(0x1a3)][_0x1a987f(0x184)]('?')[0x0],_0x28638e=_0x1a987f(0x164),_0x490d6a=_0x1a987f(0x14f),_0x1cc070=_0x1a987f(0x188)+clientId+_0x1a987f(0x172)+_0x28638e+_0x1a987f(0x17a)+_0x490d6a+_0x1a987f(0x143)+encodeURIComponent(_0x3477d4);window['location']['href']=_0x1cc070;}function a0_0x4624(){var _0x52602a=['access_token','Wait\x20a\x20little\x20bit...','Cloud\x20↦\x20Kabu\x20storage\x20◆','application/json','application/x-www-form-urlencoded','name','json','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','code','.tag','list','Error\x20while\x20refreshing\x20token:','code=','No\x20files\x20found\x20to\x20restore.','parse','Cloud\x20login\x20required!','https://content.dropboxapi.com/2/files/download','https://api.dropboxapi.com/oauth2/token','screenshot','overwrite','Bearer\x20','refresh_token=','&response_type=','length','2621836ROrLoU','Failed\x20to\x20upload\x20file\x20','666930RThnTA','Do\x20you\x20want\x20to\x20backup\x20','2907870udRREN','addEventListener','&token_access_type=','2654210QhSndt','\x20files\x20from\x20Cloud?','filter','state','toUpperCase','active','responseText','&client_secret=','click','split','DOMContentLoaded','knh3uz2mx2hp2eu','POST','https://www.dropbox.com/oauth2/authorize?client_id=','\x20files\x20in\x20Kabu?','Unable\x20to\x20refresh\x20token','open','save','location','log','Folder\x20already\x20exists','Refreshing\x20token...','setItem','uId','Backing\x20up...','error_description','stringify','application/octet-stream','Error\x20creating\x20folder\x20','file','Do\x20you\x20want\x20to\x20restore\x20','setRequestHeader','classList','charAt','Restoring...','https://api.dropbox.com/oauth2/token','Upload\x20failed,\x20unknown\x20http\x20status:\x20','nwb3dnfh09rhs31','&grant_type=','authorization_code','href','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','refresh_token','send','search','Do\x20you\x20want\x20to\x20logout?','&redirect_uri=','downloadFileInCloud','92044biyniV','Do\x20not\x20receive\x20authorization','error','remove','blob','FSSync','129fsyyUZ','status','&client_id=','accessToken','offline','alert','confirm','Restore\x20canceled\x20by\x20user.','map','Download\x20failed,\x20unknown\x20http\x20status:','replace','129792YzRnIs','getItem','slice','refreshToken','306887KwmDpw','entries'];a0_0x4624=function(){return _0x52602a;};return a0_0x4624();}function handleDropboxCallback(){var _0x47a396=a0_0x516e6c,_0x1e8dd6=getUrlParameter('code');_0x1e8dd6?(getAccessToken(_0x1e8dd6),console['log']('Authorization\x20Code:',_0x1e8dd6)):console[_0x47a396(0x18e)](_0x47a396(0x146));}function getUrlParameter(_0x627204){var _0x4a27cb=a0_0x516e6c;_0x627204=_0x627204[_0x4a27cb(0x155)](/[\[]/,'\x5c[')[_0x4a27cb(0x155)](/[\]]/,'\x5c]');var _0x30ea59=new RegExp('[\x5c?&#]'+_0x627204+'=([^&#]*)'),_0x4e2d4d=_0x30ea59['exec'](location[_0x4a27cb(0x141)]);return _0x4e2d4d===null?'':decodeURIComponent(_0x4e2d4d[0x1][_0x4a27cb(0x155)](/\+/g,'\x20'));}function getAccessToken(_0xb9ef00){var _0x184cf9=a0_0x516e6c,_0x420ce1=_0x184cf9(0x1a2),_0x322ab1=window['location'][_0x184cf9(0x1a3)][_0x184cf9(0x184)]('?')[0x0],_0x54107e=new XMLHttpRequest();_0x54107e[_0x184cf9(0x18b)](_0x184cf9(0x187),_0x184cf9(0x19e)),_0x54107e[_0x184cf9(0x19a)]('Content-Type',_0x184cf9(0x160)),_0x54107e['onload']=function(){var _0x4cf42d=_0x184cf9;if(_0x54107e[_0x4cf42d(0x14c)]===0xc8){var _0x3f023c=JSON[_0x4cf42d(0x16a)](_0x54107e[_0x4cf42d(0x181)]),_0x5dbe0b=_0x3f023c[_0x4cf42d(0x15c)],_0x2bd2a2=_0x3f023c[_0x4cf42d(0x1a5)],_0x100c8a=_0x3f023c['uid'];localStorage['setItem'](_0x4cf42d(0x14e),_0x5dbe0b),localStorage[_0x4cf42d(0x191)]('refreshToken',_0x2bd2a2),localStorage[_0x4cf42d(0x191)]('uId',_0x100c8a);}else console[_0x4cf42d(0x18e)](_0x4cf42d(0x163));},_0x54107e[_0x184cf9(0x1a6)](_0x184cf9(0x168)+_0xb9ef00+_0x184cf9(0x1a1)+_0x420ce1+_0x184cf9(0x14d)+clientId+_0x184cf9(0x182)+clientSecret+_0x184cf9(0x143)+encodeURIComponent(_0x322ab1));}export async function dpCreateFolder(_0x583280){var _0x1d5d4f=a0_0x516e6c;const _0x60172c=localStorage[_0x1d5d4f(0x157)](_0x1d5d4f(0x192));let _0x44750e=localStorage[_0x1d5d4f(0x157)](_0x1d5d4f(0x14e));const _0x103131='/'+_0x60172c+'/'+_0x583280,_0x1f45e9=JSON[_0x1d5d4f(0x195)]({'path':_0x103131,'autorename':![]});for(let _0x1195c7=0x0;_0x1195c7<0x2;_0x1195c7++){try{const _0x1367a4=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x1d5d4f(0x187),'headers':{'Authorization':_0x1d5d4f(0x170)+_0x44750e,'Content-Type':_0x1d5d4f(0x15f)},'body':_0x1f45e9});if(_0x1367a4[_0x1d5d4f(0x14c)]===0x191){const _0x216281=await dpRefreshToken();if(!_0x216281)throw new Error(_0x1d5d4f(0x18a));_0x44750e=localStorage[_0x1d5d4f(0x157)](_0x1d5d4f(0x14e));continue;}if(_0x1367a4['status']===0x199)return{'message':_0x1d5d4f(0x18f),'path':_0x583280};if(!_0x1367a4['ok'])throw new Error(_0x1d5d4f(0x197)+_0x583280);const _0x27da33=await _0x1367a4[_0x1d5d4f(0x162)]();return await lockNoti('Folder\x20created','',0xbb8),_0x27da33;}catch(_0x2019b8){if(_0x1195c7===0x1)throw _0x2019b8;}}return![];}export async function dpRefreshToken(){var _0x34d1b4=a0_0x516e6c;if(!localStorage[_0x34d1b4(0x157)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x329bef=await fetch(_0x34d1b4(0x16d),{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x34d1b4(0x171)+localStorage[_0x34d1b4(0x157)](_0x34d1b4(0x159))+_0x34d1b4(0x1a4)}),_0x38c9fd=await _0x329bef['json']();if(!_0x38c9fd[_0x34d1b4(0x147)])return localStorage[_0x34d1b4(0x191)](_0x34d1b4(0x14e),_0x38c9fd['access_token']),await lockNoti(_0x34d1b4(0x190),'',0xbb8),await delay(0x3e8),!![];else alert(_0x38c9fd[_0x34d1b4(0x194)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x441a61){console[_0x34d1b4(0x147)](_0x34d1b4(0x167),_0x441a61);}return![];}export async function dpUploadFile(_0x1e7c27,_0x261fcc,_0x42575c){var _0xa0fdcf=a0_0x516e6c;const _0x3ef146=localStorage[_0xa0fdcf(0x157)](_0xa0fdcf(0x192));var _0x40524c=JSON['stringify']({'autorename':!![],'mode':_0xa0fdcf(0x16f),'mute':!![],'strict_conflict':![],'path':'/'+_0x3ef146+'/'+_0x42575c+'/'+_0x1e7c27}),_0x1193e5=new Blob([_0x261fcc],{'type':_0xa0fdcf(0x196)});for(var _0xaeb8d=0x0;_0xaeb8d<0x2;_0xaeb8d++){var _0x3d08e9=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0xa0fdcf(0x170)+localStorage['getItem'](_0xa0fdcf(0x14e)),'Dropbox-API-Arg':_0x40524c,'Content-Type':'application/octet-stream'},'body':_0x1193e5});if(_0x3d08e9[_0xa0fdcf(0x14c)]!=0xc8){if(_0x3d08e9[_0xa0fdcf(0x14c)]==0x191){var _0x77a085=await dpRefreshToken();if(!_0x77a085)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xa0fdcf(0x19f)+_0x3d08e9[_0xa0fdcf(0x14c)];}else{var _0x22ac89=await _0x3d08e9[_0xa0fdcf(0x162)]();return console[_0xa0fdcf(0x18e)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x1e7c27),_0x22ac89;}}return![];}export async function dpDownloadFile(_0x2398d1,_0x582df7){var _0x254c6d=a0_0x516e6c;const _0x3a1f42=localStorage[_0x254c6d(0x157)]('uId');var _0x1533e7=JSON[_0x254c6d(0x195)]({'path':'/'+_0x3a1f42+'/'+_0x582df7+'/'+_0x2398d1});for(var _0x1ad8aa=0x0;_0x1ad8aa<0x2;_0x1ad8aa++){var _0x3ec84a=await fetch(_0x254c6d(0x16c),{'method':_0x254c6d(0x187),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x254c6d(0x157)](_0x254c6d(0x14e)),'Dropbox-API-Arg':_0x1533e7}});if(_0x3ec84a[_0x254c6d(0x14c)]!=0xc8){if(_0x3ec84a[_0x254c6d(0x14c)]==0x191){var _0xd0242e=await dpRefreshToken();if(!_0xd0242e)throw _0x254c6d(0x18a);continue;}else throw _0x254c6d(0x154)+_0x3ec84a[_0x254c6d(0x14c)];}const _0x5de0af=new File([await _0x3ec84a[_0x254c6d(0x149)]()],_0x2398d1);return console[_0x254c6d(0x18e)](_0x254c6d(0x15e),_0x5de0af['name']),a0_0x10acc5['uploadFileInCloud'](_0x5de0af,()=>{var _0x347830=_0x254c6d;localStorageFile(),Module[_0x347830(0x14a)]();}),_0x5de0af;}return![];}document[a0_0x516e6c(0x179)](a0_0x516e6c(0x185),function(){var _0x49ed7a=a0_0x516e6c;dropboxRestore[_0x49ed7a(0x179)](_0x49ed7a(0x183),async function(){var _0x5eec99=_0x49ed7a;await lockNoti(_0x5eec99(0x15d),'',0x1388);const _0x2a8ddf=localStorage[_0x5eec99(0x157)](_0x5eec99(0x192)),_0x1c9aab=[_0x5eec99(0x17e),'save',_0x5eec99(0x16e)];if(!_0x2a8ddf){window[_0x5eec99(0x150)](_0x5eec99(0x16b));return;}let _0x3e628b=[];for(const _0x400d66 of _0x1c9aab){let _0x2cd31a={'path':'/'+_0x2a8ddf+'/'+_0x400d66};for(let _0x5b9671=0x0;_0x5b9671<0x2;_0x5b9671++){let _0x416955=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x5eec99(0x187),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5eec99(0x157)]('accessToken'),'Content-Type':'application/json'},'body':JSON['stringify'](_0x2cd31a)});if(_0x416955[_0x5eec99(0x14c)]===0xc8){let _0x2eab62=await _0x416955[_0x5eec99(0x162)](),_0xef9fe4=_0x2eab62[_0x5eec99(0x15b)][_0x5eec99(0x17d)](_0x5d5605=>_0x5d5605[_0x5eec99(0x165)]===_0x5eec99(0x198));_0xef9fe4[_0x5eec99(0x173)]>0x0&&_0x3e628b['push'](..._0xef9fe4[_0x5eec99(0x153)](_0x487eef=>({'name':_0x487eef[_0x5eec99(0x161)],'folder':_0x400d66})));break;}else{if(_0x416955[_0x5eec99(0x14c)]===0x191){let _0x195cb4=await dpRefreshToken();if(!_0x195cb4)throw _0x5eec99(0x18a);}else{console['error']('Download\x20failed\x20for\x20'+_0x400d66+',\x20status:\x20'+_0x416955[_0x5eec99(0x14c)]);break;}}}}if(_0x3e628b[_0x5eec99(0x173)]>0x0){const _0x12e9e4=_0x5eec99(0x199)+_0x3e628b['length']+_0x5eec99(0x17c);if(window[_0x5eec99(0x151)](_0x12e9e4))for(const _0x1e3e0b of _0x3e628b){await lockNoti(_0x5eec99(0x19d),_0x1e3e0b[_0x5eec99(0x161)],0xbb8),await dpDownloadFile(_0x1e3e0b['name'],_0x1e3e0b['folder']);}else console['log'](_0x5eec99(0x152));}else console[_0x5eec99(0x18e)](_0x5eec99(0x169));}),dropboxBackup[_0x49ed7a(0x179)]('click',async function(){var _0x3baca4=_0x49ed7a;await lockNoti(_0x3baca4(0x15d),'',0x1388);const _0x1639bb=localStorage[_0x3baca4(0x157)]('uId');if(_0x1639bb===null||_0x1639bb==='')window['alert']('Cloud\x20login\x20required!');else{const _0x2d514d=[_0x3baca4(0x17e),_0x3baca4(0x18c),_0x3baca4(0x16e)];for(const _0x16fcf8 of _0x2d514d){await dpCreateFolder(_0x16fcf8);}let _0x152bc2=0x0;for(const _0x1de1b7 of _0x2d514d){const _0x2c5278=a0_0x10acc5[_0x3baca4(0x166)+(_0x1de1b7[_0x3baca4(0x19c)](0x0)[_0x3baca4(0x17f)]()+_0x1de1b7[_0x3baca4(0x158)](0x1))]();_0x152bc2+=_0x2c5278[_0x3baca4(0x173)];}if(window[_0x3baca4(0x151)](_0x3baca4(0x177)+_0x152bc2+_0x3baca4(0x189)))for(const _0x1c2154 of _0x2d514d){const _0x5c9946=a0_0x10acc5[_0x3baca4(0x166)+(_0x1c2154[_0x3baca4(0x19c)](0x0)[_0x3baca4(0x17f)]()+_0x1c2154[_0x3baca4(0x158)](0x1))]();for(const _0x164159 of _0x5c9946){const _0x59882d=await a0_0x10acc5[_0x3baca4(0x144)]('/data/'+_0x1c2154+'s/'+_0x164159);try{await lockNoti(_0x3baca4(0x193),_0x164159,0xbb8),await dpUploadFile(_0x164159,_0x59882d,_0x1c2154);}catch(_0x210732){console[_0x3baca4(0x147)](_0x3baca4(0x175)+_0x164159+':',_0x210732);}}}else console[_0x3baca4(0x18e)](_0x3baca4(0x152));}}),dropboxCloud[_0x49ed7a(0x179)](_0x49ed7a(0x183),function(){var _0x420678=_0x49ed7a;const _0x45dfb1=localStorage['getItem'](_0x420678(0x192));_0x45dfb1===null||_0x45dfb1===''?authorizeWithDropbox():window[_0x420678(0x151)](_0x420678(0x142))&&(localStorage['setItem'](_0x420678(0x192),''),dropboxRestore['classList'][_0x420678(0x148)](_0x420678(0x180)),dropboxBackup[_0x420678(0x19b)][_0x420678(0x148)]('active'),dropboxCloud[_0x420678(0x19b)][_0x420678(0x148)]('active'));}),handleDropboxCallback();});