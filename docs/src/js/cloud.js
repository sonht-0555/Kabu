var a0_0x38e7e9=a0_0x5469;(function(_0x2d71f8,_0x3b12f2){var _0x17b7a9=a0_0x5469,_0x9c966f=_0x2d71f8();while(!![]){try{var _0x4ce50c=-parseInt(_0x17b7a9(0x223))/0x1+-parseInt(_0x17b7a9(0x200))/0x2*(parseInt(_0x17b7a9(0x21f))/0x3)+parseInt(_0x17b7a9(0x21a))/0x4+-parseInt(_0x17b7a9(0x234))/0x5+-parseInt(_0x17b7a9(0x24d))/0x6*(parseInt(_0x17b7a9(0x248))/0x7)+parseInt(_0x17b7a9(0x1f8))/0x8*(-parseInt(_0x17b7a9(0x258))/0x9)+parseInt(_0x17b7a9(0x241))/0xa;if(_0x4ce50c===_0x3b12f2)break;else _0x9c966f['push'](_0x9c966f['shift']());}catch(_0xe136fd){_0x9c966f['push'](_0x9c966f['shift']());}}}(a0_0x4945,0x7418d));import*as a0_0xd486bc from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x38e7e9(0x210),clientSecret=a0_0x38e7e9(0x1f5);function authorizeWithDropbox(){var _0x1f8949=a0_0x38e7e9,_0x3cf5d0=window[_0x1f8949(0x217)][_0x1f8949(0x232)][_0x1f8949(0x254)]('?')[0x0],_0x391e17='code',_0x1b0d7d=_0x1f8949(0x227),_0x477cbd=_0x1f8949(0x20a)+clientId+_0x1f8949(0x20b)+_0x391e17+_0x1f8949(0x24e)+_0x1b0d7d+_0x1f8949(0x24b)+encodeURIComponent(_0x3cf5d0);window[_0x1f8949(0x217)]['href']=_0x477cbd;}function a0_0x5469(_0x1d363a,_0x286fc0){var _0x494519=a0_0x4945();return a0_0x5469=function(_0x5469d2,_0x238cfe){_0x5469d2=_0x5469d2-0x1f3;var _0x4c94c7=_0x494519[_0x5469d2];return _0x4c94c7;},a0_0x5469(_0x1d363a,_0x286fc0);}function handleDropboxCallback(){var _0x5542e4=a0_0x38e7e9,_0x40286e=getUrlParameter(_0x5542e4(0x21e));_0x40286e?(getAccessToken(_0x40286e),console[_0x5542e4(0x208)](_0x5542e4(0x230),_0x40286e)):console['log'](_0x5542e4(0x219));}function a0_0x4945(){var _0x49f303=['[\x5c?&#]','/data/','nwb3dnfh09rhs31','https://api.dropboxapi.com/2/files/create_folder_v2','Wait\x20a\x20little\x20bit...','856qQutAP','name','Bearer\x20','refreshToken','parse','uploadFileInCloud','json','overwrite','8318sBBJGO','https://content.dropboxapi.com/2/files/upload','entries','alert','folder','error','POST','Do\x20you\x20want\x20to\x20logout?','log','refresh_token','https://www.dropbox.com/oauth2/authorize?client_id=','&response_type=','error_description','\x20files\x20in\x20Kabu?','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','exec','knh3uz2mx2hp2eu','Cloud\x20login\x20required!','classList','https://api.dropbox.com/oauth2/token','state','stringify','application/octet-stream','location','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20not\x20receive\x20authorization','1519112JWBnID','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/json','https://api.dropboxapi.com/2/files/list_folder','code','30FLIXck','\x20files\x20from\x20Cloud?','Unable\x20to\x20refresh\x20token','addEventListener','333130OIJcSq','confirm','downloadFileInCloud','file','offline','.tag','=([^&#]*)','length','uid','Do\x20you\x20want\x20to\x20backup\x20','application/x-www-form-urlencoded','replace','refresh_token=','Authorization\x20Code:','onload','href','screenshot','2038445ryNBwj','remove','click',',\x20status:\x20','responseText','https://api.dropboxapi.com/oauth2/token','Restore\x20canceled\x20by\x20user.','Error\x20creating\x20folder\x20','getItem','status','Content-Type','active','map','22122030hIKGGQ','Failed\x20to\x20upload\x20file\x20','accessToken','DOMContentLoaded','uId','https://content.dropboxapi.com/2/files/download','Folder\x20created','4665262yvktRx','push','Download\x20failed\x20for\x20','&redirect_uri=','&client_secret=','6bdIMnl','&token_access_type=','open','Backing\x20up...','No\x20files\x20found\x20to\x20restore.','search','&client_id=','split','Error\x20while\x20refreshing\x20token:','listFiles','&grant_type=','56151IXcSSg','Refreshing\x20token...','access_token','setItem','Folder\x20already\x20exists'];a0_0x4945=function(){return _0x49f303;};return a0_0x4945();}function getUrlParameter(_0x41b6bb){var _0x37a3c4=a0_0x38e7e9;_0x41b6bb=_0x41b6bb['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x549676=new RegExp(_0x37a3c4(0x1f3)+_0x41b6bb+_0x37a3c4(0x229)),_0x2df8bf=_0x549676[_0x37a3c4(0x20f)](location[_0x37a3c4(0x252)]);return _0x2df8bf===null?'':decodeURIComponent(_0x2df8bf[0x1][_0x37a3c4(0x22e)](/\+/g,'\x20'));}function getAccessToken(_0x281036){var _0x3f4430=a0_0x38e7e9,_0x1fac25='authorization_code',_0x1fbfd3=window[_0x3f4430(0x217)][_0x3f4430(0x232)][_0x3f4430(0x254)]('?')[0x0],_0x3d9376=new XMLHttpRequest();_0x3d9376[_0x3f4430(0x24f)](_0x3f4430(0x206),_0x3f4430(0x213)),_0x3d9376['setRequestHeader'](_0x3f4430(0x23e),_0x3f4430(0x22d)),_0x3d9376[_0x3f4430(0x231)]=function(){var _0x51fe15=_0x3f4430;if(_0x3d9376[_0x51fe15(0x23d)]===0xc8){var _0x110c4d=JSON[_0x51fe15(0x1fc)](_0x3d9376[_0x51fe15(0x238)]),_0x24049d=_0x110c4d[_0x51fe15(0x25a)],_0x368a7c=_0x110c4d[_0x51fe15(0x209)],_0x3451ce=_0x110c4d[_0x51fe15(0x22b)];localStorage[_0x51fe15(0x25b)](_0x51fe15(0x243),_0x24049d),localStorage[_0x51fe15(0x25b)](_0x51fe15(0x1fb),_0x368a7c),localStorage[_0x51fe15(0x25b)](_0x51fe15(0x245),_0x3451ce);}else console['log'](_0x51fe15(0x20e));},_0x3d9376['send']('code='+_0x281036+_0x3f4430(0x257)+_0x1fac25+_0x3f4430(0x253)+clientId+_0x3f4430(0x24c)+clientSecret+_0x3f4430(0x24b)+encodeURIComponent(_0x1fbfd3));}export async function dpCreateFolder(_0x2c2ed9){var _0x17bf2a=a0_0x38e7e9;const _0x5741dd=localStorage[_0x17bf2a(0x23c)](_0x17bf2a(0x245));let _0x112193=localStorage[_0x17bf2a(0x23c)](_0x17bf2a(0x243));const _0x4d271e='/'+_0x5741dd+'/'+_0x2c2ed9,_0x107f9f=JSON[_0x17bf2a(0x215)]({'path':_0x4d271e,'autorename':![]});for(let _0x2fd0d1=0x0;_0x2fd0d1<0x2;_0x2fd0d1++){try{const _0x775452=await fetch(_0x17bf2a(0x1f6),{'method':_0x17bf2a(0x206),'headers':{'Authorization':_0x17bf2a(0x1fa)+_0x112193,'Content-Type':_0x17bf2a(0x21c)},'body':_0x107f9f});if(_0x775452[_0x17bf2a(0x23d)]===0x191){const _0x4884a0=await dpRefreshToken();if(!_0x4884a0)throw new Error(_0x17bf2a(0x221));_0x112193=localStorage[_0x17bf2a(0x23c)](_0x17bf2a(0x243));continue;}if(_0x775452[_0x17bf2a(0x23d)]===0x199)return{'message':_0x17bf2a(0x25c),'path':_0x2c2ed9};if(!_0x775452['ok'])throw new Error(_0x17bf2a(0x23b)+_0x2c2ed9);const _0x5d0663=await _0x775452[_0x17bf2a(0x1fe)]();return await lockNoti(_0x17bf2a(0x247),'',0xbb8),_0x5d0663;}catch(_0x4bb233){if(_0x2fd0d1===0x1)throw _0x4bb233;}}return![];}export async function dpRefreshToken(){var _0x38565c=a0_0x38e7e9;if(!localStorage[_0x38565c(0x23c)](_0x38565c(0x1fb)))throw'No\x20refresh\x20token';try{const _0x5eae4e=await fetch(_0x38565c(0x239),{'method':_0x38565c(0x206),'headers':{'Content-Type':_0x38565c(0x22d)},'body':_0x38565c(0x22f)+localStorage[_0x38565c(0x23c)](_0x38565c(0x1fb))+_0x38565c(0x218)}),_0x45ba1f=await _0x5eae4e[_0x38565c(0x1fe)]();if(!_0x45ba1f['error'])return localStorage[_0x38565c(0x25b)]('accessToken',_0x45ba1f[_0x38565c(0x25a)]),await lockNoti(_0x38565c(0x259),'',0xbb8),await delay(0x3e8),!![];else alert(_0x45ba1f[_0x38565c(0x20c)]||_0x38565c(0x21b));}catch(_0x6beb3d){console[_0x38565c(0x205)](_0x38565c(0x255),_0x6beb3d);}return![];}export async function dpUploadFile(_0x4c6aaa,_0x19a6c5,_0x1a5210){var _0x344830=a0_0x38e7e9;const _0x1c1d94=localStorage['getItem'](_0x344830(0x245));var _0x3e296f=JSON[_0x344830(0x215)]({'autorename':!![],'mode':_0x344830(0x1ff),'mute':!![],'strict_conflict':![],'path':'/'+_0x1c1d94+'/'+_0x1a5210+'/'+_0x4c6aaa}),_0xe343b0=new Blob([_0x19a6c5],{'type':_0x344830(0x216)});for(var _0x52d101=0x0;_0x52d101<0x2;_0x52d101++){var _0x44d476=await fetch(_0x344830(0x201),{'method':_0x344830(0x206),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x344830(0x23c)](_0x344830(0x243)),'Dropbox-API-Arg':_0x3e296f,'Content-Type':_0x344830(0x216)},'body':_0xe343b0});if(_0x44d476[_0x344830(0x23d)]!=0xc8){if(_0x44d476[_0x344830(0x23d)]==0x191){var _0x297d49=await dpRefreshToken();if(!_0x297d49)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x44d476['status'];}else{var _0x38be4=await _0x44d476[_0x344830(0x1fe)]();return console[_0x344830(0x208)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x4c6aaa),_0x38be4;}}return![];}export async function dpDownloadFile(_0x27487c,_0x552f56){var _0x363d6a=a0_0x38e7e9;const _0x34da0d=localStorage[_0x363d6a(0x23c)](_0x363d6a(0x245));var _0x12c757=JSON[_0x363d6a(0x215)]({'path':'/'+_0x34da0d+'/'+_0x552f56+'/'+_0x27487c});for(var _0x3aecdb=0x0;_0x3aecdb<0x2;_0x3aecdb++){var _0x348c66=await fetch(_0x363d6a(0x246),{'method':_0x363d6a(0x206),'headers':{'Authorization':_0x363d6a(0x1fa)+localStorage[_0x363d6a(0x23c)](_0x363d6a(0x243)),'Dropbox-API-Arg':_0x12c757}});if(_0x348c66[_0x363d6a(0x23d)]!=0xc8){if(_0x348c66[_0x363d6a(0x23d)]==0x191){var _0x588ac7=await dpRefreshToken();if(!_0x588ac7)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x348c66['status'];}const _0x435285=new File([await _0x348c66['blob']()],_0x27487c);return console[_0x363d6a(0x208)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x435285['name']),a0_0xd486bc[_0x363d6a(0x1fd)](_0x435285,()=>{}),_0x435285;}return![];}document[a0_0x38e7e9(0x222)](a0_0x38e7e9(0x244),function(){var _0x1c212e=a0_0x38e7e9;dropboxRestore[_0x1c212e(0x222)](_0x1c212e(0x236),async function(){var _0x32650d=_0x1c212e;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1a54d7=localStorage[_0x32650d(0x23c)]('uId'),_0x47f0b1=[_0x32650d(0x214),'save',_0x32650d(0x233)];if(!_0x1a54d7){window[_0x32650d(0x203)](_0x32650d(0x211));return;}let _0x1bedb3=[];for(const _0x4d7ff4 of _0x47f0b1){let _0x1eda27={'path':'/'+_0x1a54d7+'/'+_0x4d7ff4};for(let _0x56fb21=0x0;_0x56fb21<0x2;_0x56fb21++){let _0x10c193=await fetch(_0x32650d(0x21d),{'method':_0x32650d(0x206),'headers':{'Authorization':_0x32650d(0x1fa)+localStorage[_0x32650d(0x23c)](_0x32650d(0x243)),'Content-Type':_0x32650d(0x21c)},'body':JSON[_0x32650d(0x215)](_0x1eda27)});if(_0x10c193[_0x32650d(0x23d)]===0xc8){let _0x479c98=await _0x10c193[_0x32650d(0x1fe)](),_0x5f33b0=_0x479c98[_0x32650d(0x202)]['filter'](_0x4ae4a9=>_0x4ae4a9[_0x32650d(0x228)]===_0x32650d(0x226));_0x5f33b0[_0x32650d(0x22a)]>0x0&&_0x1bedb3[_0x32650d(0x249)](..._0x5f33b0[_0x32650d(0x240)](_0x25a4ac=>({'name':_0x25a4ac[_0x32650d(0x1f9)],'folder':_0x4d7ff4})));break;}else{if(_0x10c193[_0x32650d(0x23d)]===0x191){let _0x7cbbae=await dpRefreshToken();if(!_0x7cbbae)throw _0x32650d(0x221);}else{console[_0x32650d(0x205)](_0x32650d(0x24a)+_0x4d7ff4+_0x32650d(0x237)+_0x10c193[_0x32650d(0x23d)]);break;}}}}if(_0x1bedb3[_0x32650d(0x22a)]>0x0){const _0x48a9cd='Do\x20you\x20want\x20to\x20restore\x20'+_0x1bedb3[_0x32650d(0x22a)]+_0x32650d(0x220);if(window['confirm'](_0x48a9cd))for(const _0x1a100f of _0x1bedb3){await lockNoti('Restoring...',_0x1a100f[_0x32650d(0x1f9)],0xbb8),await dpDownloadFile(_0x1a100f[_0x32650d(0x1f9)],_0x1a100f[_0x32650d(0x204)]);}else console['log'](_0x32650d(0x23a));}else console['log'](_0x32650d(0x251));}),dropboxBackup[_0x1c212e(0x222)](_0x1c212e(0x236),async function(){var _0x5da92b=_0x1c212e;await lockNoti(_0x5da92b(0x1f7),'',0x1388);const _0x3baeba=localStorage[_0x5da92b(0x23c)](_0x5da92b(0x245));if(_0x3baeba===null||_0x3baeba==='')window[_0x5da92b(0x203)](_0x5da92b(0x211));else{const _0xb35db=[_0x5da92b(0x214),'save','screenshot'];for(const _0x5df9bf of _0xb35db){await dpCreateFolder(_0x5df9bf);}let _0x42cfdf=0x0;for(const _0x2d249f of _0xb35db){const _0x23c0e1=a0_0xd486bc['listFiles'](_0x2d249f+'s');_0x42cfdf+=_0x23c0e1['length'];}if(window[_0x5da92b(0x224)](_0x5da92b(0x22c)+_0x42cfdf+_0x5da92b(0x20d)))for(const _0x459b90 of _0xb35db){const _0x438cd0=a0_0xd486bc[_0x5da92b(0x256)](_0x459b90+'s');for(const _0x199216 of _0x438cd0){const _0x67a4d=await a0_0xd486bc[_0x5da92b(0x225)](_0x5da92b(0x1f4)+_0x459b90+'s/'+_0x199216);try{await lockNoti(_0x5da92b(0x250),_0x199216,0xbb8),await dpUploadFile(_0x199216,_0x67a4d,_0x459b90);}catch(_0x35d0a6){console[_0x5da92b(0x205)](_0x5da92b(0x242)+_0x199216+':',_0x35d0a6);}}}else console['log'](_0x5da92b(0x23a));}}),dropboxCloud[_0x1c212e(0x222)](_0x1c212e(0x236),function(){var _0x5d7c76=_0x1c212e;const _0x4efda0=localStorage[_0x5d7c76(0x23c)](_0x5d7c76(0x245));_0x4efda0===null||_0x4efda0===''?authorizeWithDropbox():window[_0x5d7c76(0x224)](_0x5d7c76(0x207))&&(localStorage[_0x5d7c76(0x25b)](_0x5d7c76(0x245),''),dropboxRestore[_0x5d7c76(0x212)]['remove']('active'),dropboxBackup[_0x5d7c76(0x212)][_0x5d7c76(0x235)](_0x5d7c76(0x23f)),dropboxCloud['classList'][_0x5d7c76(0x235)](_0x5d7c76(0x23f)));}),handleDropboxCallback();});