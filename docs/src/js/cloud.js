var a0_0x451b46=a0_0x16cb;(function(_0x103d5f,_0x3155f6){var _0x1098da=a0_0x16cb,_0x2c37a9=_0x103d5f();while(!![]){try{var _0x20a97a=-parseInt(_0x1098da(0x18e))/0x1+-parseInt(_0x1098da(0x16b))/0x2*(-parseInt(_0x1098da(0x154))/0x3)+parseInt(_0x1098da(0x190))/0x4+parseInt(_0x1098da(0x188))/0x5+parseInt(_0x1098da(0x15a))/0x6*(-parseInt(_0x1098da(0x147))/0x7)+-parseInt(_0x1098da(0x17c))/0x8+parseInt(_0x1098da(0x162))/0x9*(parseInt(_0x1098da(0x184))/0xa);if(_0x20a97a===_0x3155f6)break;else _0x2c37a9['push'](_0x2c37a9['shift']());}catch(_0x316d35){_0x2c37a9['push'](_0x2c37a9['shift']());}}}(a0_0x8d72,0x55df7));import*as a0_0x1524a5 from'./main.js';function a0_0x8d72(){var _0x403e66=['https://api.dropboxapi.com/2/files/list_folder','&token_access_type=','https://content.dropboxapi.com/2/files/download','overwrite','application/x-www-form-urlencoded','screenshot','https://www.dropbox.com/oauth2/authorize?client_id=','parse','stringify','classList','refresh_token=','open','2570880hmANnr','href','send','save','https://api.dropbox.com/oauth2/token','Download\x20failed\x20for\x20','uploadFileInCloud','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','2530490XJdXMO','https://content.dropboxapi.com/2/files/upload','split','alert','2192460otiXbH','exec','uid','state','access_token','active','580713AaXWDQ','.tag','2457956HKTOwx','confirm','Bearer\x20','knh3uz2mx2hp2eu','responseText','entries','name','&client_id=','/data/','search','Do\x20not\x20receive\x20authorization','Cloud\x20login\x20required!','DOMContentLoaded','file','Refreshing\x20token...','authorization_code','length','setItem',',\x20status:\x20','Do\x20you\x20want\x20to\x20logout?','Restore\x20canceled\x20by\x20user.','No\x20files\x20found\x20to\x20restore.','nwb3dnfh09rhs31','No\x20refresh\x20token','Folder\x20already\x20exists','remove','refresh_token','&redirect_uri=','click','1477DHxzZI','error','status','Content-Type','map','replace','Kabu\x20storage\x20↦\x20Cloud\x20◆','Cloud\x20↦\x20Kabu\x20storage\x20◆','json','code','POST','log','Unable\x20to\x20refresh\x20token','160347kBDXlJ','Backing\x20up...','Do\x20you\x20want\x20to\x20restore\x20','application/octet-stream','Folder\x20created','error_description','13644xQjpyN','getItem','=([^&#]*)','refreshToken','listFiles','https://api.dropboxapi.com/2/files/create_folder_v2','uId','\x20files\x20from\x20Cloud?','9pErCRl','&client_secret=','location','accessToken','application/json','Wait\x20a\x20little\x20bit...','&grant_type=','onload','Error\x20while\x20refreshing\x20token:','16ihSaRT','[\x5c?&#]','https://api.dropboxapi.com/oauth2/token','Failed\x20to\x20upload\x20file\x20','addEventListener'];a0_0x8d72=function(){return _0x403e66;};return a0_0x8d72();}import{localStorageFile}from'./storage.js';var clientId=a0_0x451b46(0x193),clientSecret=a0_0x451b46(0x140);function authorizeWithDropbox(){var _0x506215=a0_0x451b46,_0x5c1cdd=window[_0x506215(0x164)][_0x506215(0x17d)][_0x506215(0x186)]('?')[0x0],_0x151102=_0x506215(0x150),_0x4b27e4='offline',_0x5491eb=_0x506215(0x176)+clientId+'&response_type='+_0x151102+_0x506215(0x171)+_0x4b27e4+_0x506215(0x145)+encodeURIComponent(_0x5c1cdd);window[_0x506215(0x164)]['href']=_0x5491eb;}function handleDropboxCallback(){var _0x342c49=a0_0x451b46,_0x111547=getUrlParameter('code');_0x111547?(getAccessToken(_0x111547),console[_0x342c49(0x152)]('Authorization\x20Code:',_0x111547)):console[_0x342c49(0x152)](_0x342c49(0x19a));}function getUrlParameter(_0x175224){var _0x4d4c24=a0_0x451b46;_0x175224=_0x175224['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2a7b99=new RegExp(_0x4d4c24(0x16c)+_0x175224+_0x4d4c24(0x15c)),_0x148f72=_0x2a7b99[_0x4d4c24(0x189)](location[_0x4d4c24(0x199)]);return _0x148f72===null?'':decodeURIComponent(_0x148f72[0x1][_0x4d4c24(0x14c)](/\+/g,'\x20'));}function getAccessToken(_0x20b5ee){var _0x430d78=a0_0x451b46,_0x2a23d6=_0x430d78(0x139),_0x226e1f=window[_0x430d78(0x164)][_0x430d78(0x17d)][_0x430d78(0x186)]('?')[0x0],_0x233504=new XMLHttpRequest();_0x233504[_0x430d78(0x17b)](_0x430d78(0x151),_0x430d78(0x180)),_0x233504['setRequestHeader'](_0x430d78(0x14a),_0x430d78(0x174)),_0x233504[_0x430d78(0x169)]=function(){var _0x123694=_0x430d78;if(_0x233504[_0x123694(0x149)]===0xc8){var _0x5b5459=JSON[_0x123694(0x177)](_0x233504[_0x123694(0x194)]),_0x554147=_0x5b5459[_0x123694(0x18c)],_0x34077a=_0x5b5459[_0x123694(0x144)],_0x1bce11=_0x5b5459[_0x123694(0x18a)];localStorage[_0x123694(0x13b)](_0x123694(0x165),_0x554147),localStorage['setItem']('refreshToken',_0x34077a),localStorage[_0x123694(0x13b)]('uId',_0x1bce11);}else console[_0x123694(0x152)](_0x123694(0x183));},_0x233504[_0x430d78(0x17e)]('code='+_0x20b5ee+_0x430d78(0x168)+_0x2a23d6+_0x430d78(0x197)+clientId+_0x430d78(0x163)+clientSecret+_0x430d78(0x145)+encodeURIComponent(_0x226e1f));}export async function dpCreateFolder(_0x21553d){var _0x47c697=a0_0x451b46;const _0x51229a=localStorage['getItem'](_0x47c697(0x160));let _0x168598=localStorage[_0x47c697(0x15b)]('accessToken');const _0x34c440='/'+_0x51229a+'/'+_0x21553d,_0x1f28f1=JSON[_0x47c697(0x178)]({'path':_0x34c440,'autorename':![]});for(let _0x5097ff=0x0;_0x5097ff<0x2;_0x5097ff++){try{const _0x10f581=await fetch(_0x47c697(0x15f),{'method':_0x47c697(0x151),'headers':{'Authorization':_0x47c697(0x192)+_0x168598,'Content-Type':_0x47c697(0x166)},'body':_0x1f28f1});if(_0x10f581[_0x47c697(0x149)]===0x191){const _0xd22d14=await dpRefreshToken();if(!_0xd22d14)throw new Error(_0x47c697(0x153));_0x168598=localStorage['getItem'](_0x47c697(0x165));continue;}if(_0x10f581[_0x47c697(0x149)]===0x199)return{'message':_0x47c697(0x142),'path':_0x21553d};if(!_0x10f581['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x21553d);const _0x19093a=await _0x10f581[_0x47c697(0x14f)]();return await lockNoti(_0x47c697(0x158),'',0xbb8),_0x19093a;}catch(_0x16a2ff){if(_0x5097ff===0x1)throw _0x16a2ff;}}return![];}function a0_0x16cb(_0x11b8a2,_0x37c460){var _0x8d72fb=a0_0x8d72();return a0_0x16cb=function(_0x16cbd5,_0x313c0a){_0x16cbd5=_0x16cbd5-0x138;var _0x3bab61=_0x8d72fb[_0x16cbd5];return _0x3bab61;},a0_0x16cb(_0x11b8a2,_0x37c460);}export async function dpRefreshToken(){var _0x3a62f2=a0_0x451b46;if(!localStorage[_0x3a62f2(0x15b)](_0x3a62f2(0x15d)))throw _0x3a62f2(0x141);try{const _0x14da9e=await fetch(_0x3a62f2(0x16d),{'method':_0x3a62f2(0x151),'headers':{'Content-Type':_0x3a62f2(0x174)},'body':_0x3a62f2(0x17a)+localStorage[_0x3a62f2(0x15b)](_0x3a62f2(0x15d))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0xed10fb=await _0x14da9e[_0x3a62f2(0x14f)]();if(!_0xed10fb[_0x3a62f2(0x148)])return localStorage[_0x3a62f2(0x13b)]('accessToken',_0xed10fb[_0x3a62f2(0x18c)]),await lockNoti(_0x3a62f2(0x138),'',0xbb8),await delay(0x3e8),!![];else alert(_0xed10fb[_0x3a62f2(0x159)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x4ecfa4){console[_0x3a62f2(0x148)](_0x3a62f2(0x16a),_0x4ecfa4);}return![];}export async function dpUploadFile(_0x25d0a4,_0x419fee,_0xf30b20){var _0x5486f3=a0_0x451b46;const _0x2c035f=localStorage['getItem'](_0x5486f3(0x160));var _0x2645c0=JSON[_0x5486f3(0x178)]({'autorename':!![],'mode':_0x5486f3(0x173),'mute':!![],'strict_conflict':![],'path':'/'+_0x2c035f+'/'+_0xf30b20+'/'+_0x25d0a4}),_0x563664=new Blob([_0x419fee],{'type':_0x5486f3(0x157)});for(var _0x37375d=0x0;_0x37375d<0x2;_0x37375d++){var _0x3537a6=await fetch(_0x5486f3(0x185),{'method':_0x5486f3(0x151),'headers':{'Authorization':_0x5486f3(0x192)+localStorage[_0x5486f3(0x15b)](_0x5486f3(0x165)),'Dropbox-API-Arg':_0x2645c0,'Content-Type':'application/octet-stream'},'body':_0x563664});if(_0x3537a6['status']!=0xc8){if(_0x3537a6[_0x5486f3(0x149)]==0x191){var _0x367760=await dpRefreshToken();if(!_0x367760)throw _0x5486f3(0x153);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3537a6['status'];}else{var _0x424828=await _0x3537a6['json']();return console[_0x5486f3(0x152)](_0x5486f3(0x14d),_0x25d0a4),_0x424828;}}return![];}export async function dpDownloadFile(_0x5246c3,_0x1f774f){var _0x3a0b6c=a0_0x451b46;const _0x4728a3=localStorage[_0x3a0b6c(0x15b)](_0x3a0b6c(0x160));var _0x20a73c=JSON[_0x3a0b6c(0x178)]({'path':'/'+_0x4728a3+'/'+_0x1f774f+'/'+_0x5246c3});for(var _0x6e13b9=0x0;_0x6e13b9<0x2;_0x6e13b9++){var _0x22ff4a=await fetch(_0x3a0b6c(0x172),{'method':_0x3a0b6c(0x151),'headers':{'Authorization':_0x3a0b6c(0x192)+localStorage[_0x3a0b6c(0x15b)](_0x3a0b6c(0x165)),'Dropbox-API-Arg':_0x20a73c}});if(_0x22ff4a[_0x3a0b6c(0x149)]!=0xc8){if(_0x22ff4a[_0x3a0b6c(0x149)]==0x191){var _0x3db545=await dpRefreshToken();if(!_0x3db545)throw _0x3a0b6c(0x153);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x22ff4a[_0x3a0b6c(0x149)];}const _0x5e1408=new File([await _0x22ff4a['blob']()],_0x5246c3);return console[_0x3a0b6c(0x152)](_0x3a0b6c(0x14e),_0x5e1408[_0x3a0b6c(0x196)]),a0_0x1524a5[_0x3a0b6c(0x182)](_0x5e1408,()=>{}),_0x5e1408;}return![];}document[a0_0x451b46(0x16f)](a0_0x451b46(0x19c),function(){var _0x14e6b4=a0_0x451b46;dropboxRestore['addEventListener'](_0x14e6b4(0x146),async function(){var _0x18bc40=_0x14e6b4;await lockNoti(_0x18bc40(0x167),'',0x1388);const _0xded48=localStorage['getItem'](_0x18bc40(0x160)),_0x2b9298=['state',_0x18bc40(0x17f),_0x18bc40(0x175)];if(!_0xded48){window[_0x18bc40(0x187)](_0x18bc40(0x19b));return;}let _0x2bb3e0=[];for(const _0x5d8f53 of _0x2b9298){let _0x336f91={'path':'/'+_0xded48+'/'+_0x5d8f53};for(let _0x480485=0x0;_0x480485<0x2;_0x480485++){let _0x5d5312=await fetch(_0x18bc40(0x170),{'method':_0x18bc40(0x151),'headers':{'Authorization':_0x18bc40(0x192)+localStorage[_0x18bc40(0x15b)](_0x18bc40(0x165)),'Content-Type':_0x18bc40(0x166)},'body':JSON['stringify'](_0x336f91)});if(_0x5d5312[_0x18bc40(0x149)]===0xc8){let _0x39abb0=await _0x5d5312[_0x18bc40(0x14f)](),_0x20a0bf=_0x39abb0[_0x18bc40(0x195)]['filter'](_0x43da98=>_0x43da98[_0x18bc40(0x18f)]===_0x18bc40(0x19d));_0x20a0bf[_0x18bc40(0x13a)]>0x0&&_0x2bb3e0['push'](..._0x20a0bf[_0x18bc40(0x14b)](_0x599b9f=>({'name':_0x599b9f['name'],'folder':_0x5d8f53})));break;}else{if(_0x5d5312[_0x18bc40(0x149)]===0x191){let _0x480140=await dpRefreshToken();if(!_0x480140)throw _0x18bc40(0x153);}else{console[_0x18bc40(0x148)](_0x18bc40(0x181)+_0x5d8f53+_0x18bc40(0x13c)+_0x5d5312['status']);break;}}}}if(_0x2bb3e0[_0x18bc40(0x13a)]>0x0){const _0xe5211=_0x18bc40(0x156)+_0x2bb3e0[_0x18bc40(0x13a)]+_0x18bc40(0x161);if(window[_0x18bc40(0x191)](_0xe5211))for(const _0x4a0f9f of _0x2bb3e0){await lockNoti('Restoring...',_0x4a0f9f[_0x18bc40(0x196)],0xbb8),await dpDownloadFile(_0x4a0f9f['name'],_0x4a0f9f['folder']);}else console['log'](_0x18bc40(0x13e));}else console[_0x18bc40(0x152)](_0x18bc40(0x13f));}),dropboxBackup[_0x14e6b4(0x16f)](_0x14e6b4(0x146),async function(){var _0x42b520=_0x14e6b4;await lockNoti(_0x42b520(0x167),'',0x1388);const _0xa0ac7b=localStorage[_0x42b520(0x15b)](_0x42b520(0x160));if(_0xa0ac7b===null||_0xa0ac7b==='')window['alert'](_0x42b520(0x19b));else{const _0x48014c=[_0x42b520(0x18b),_0x42b520(0x17f),_0x42b520(0x175)];for(const _0x20823e of _0x48014c){await dpCreateFolder(_0x20823e);}let _0x4f20b9=0x0;for(const _0xc925ce of _0x48014c){const _0x1a6cbc=a0_0x1524a5[_0x42b520(0x15e)](_0xc925ce+'s');_0x4f20b9+=_0x1a6cbc[_0x42b520(0x13a)];}if(window[_0x42b520(0x191)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4f20b9+'\x20files\x20in\x20Kabu?'))for(const _0x26eba0 of _0x48014c){const _0x4d9477=a0_0x1524a5[_0x42b520(0x15e)](_0x26eba0+'s');for(const _0x2805da of _0x4d9477){const _0x312e59=await a0_0x1524a5['downloadFileInCloud'](_0x42b520(0x198)+_0x26eba0+'s/'+_0x2805da);try{await lockNoti(_0x42b520(0x155),_0x2805da,0xbb8),await dpUploadFile(_0x2805da,_0x312e59,_0x26eba0);}catch(_0x338cff){console[_0x42b520(0x148)](_0x42b520(0x16e)+_0x2805da+':',_0x338cff);}}}else console['log'](_0x42b520(0x13e));}}),dropboxCloud[_0x14e6b4(0x16f)](_0x14e6b4(0x146),function(){var _0x3bafc6=_0x14e6b4;const _0x22814c=localStorage[_0x3bafc6(0x15b)](_0x3bafc6(0x160));_0x22814c===null||_0x22814c===''?authorizeWithDropbox():window[_0x3bafc6(0x191)](_0x3bafc6(0x13d))&&(localStorage['setItem'](_0x3bafc6(0x160),''),dropboxRestore['classList'][_0x3bafc6(0x143)](_0x3bafc6(0x18d)),dropboxBackup[_0x3bafc6(0x179)][_0x3bafc6(0x143)]('active'),dropboxCloud[_0x3bafc6(0x179)][_0x3bafc6(0x143)](_0x3bafc6(0x18d)));}),handleDropboxCallback();});