var a0_0x4f0e3c=a0_0x5bb6;(function(_0x478d94,_0x578b9c){var _0x444a69=a0_0x5bb6,_0x10dc5c=_0x478d94();while(!![]){try{var _0x4d9ec4=-parseInt(_0x444a69(0xd9))/0x1*(-parseInt(_0x444a69(0xe7))/0x2)+parseInt(_0x444a69(0xe4))/0x3*(-parseInt(_0x444a69(0xf7))/0x4)+-parseInt(_0x444a69(0x105))/0x5+-parseInt(_0x444a69(0xf8))/0x6*(-parseInt(_0x444a69(0x123))/0x7)+parseInt(_0x444a69(0x118))/0x8+-parseInt(_0x444a69(0xda))/0x9+-parseInt(_0x444a69(0xff))/0xa;if(_0x4d9ec4===_0x578b9c)break;else _0x10dc5c['push'](_0x10dc5c['shift']());}catch(_0x532af7){_0x10dc5c['push'](_0x10dc5c['shift']());}}}(a0_0x220d,0x9fde1));function a0_0x220d(){var _0x2b6557=['setItem','/data/','Failed\x20to\x20upload\x20file\x20','knh3uz2mx2hp2eu','https://content.dropboxapi.com/2/files/download','nwb3dnfh09rhs31','error','access_token','&client_id=','remove','9133BeHAXd','4037085NqIftD','state','push','code','Authorization\x20Code:','https://api.dropboxapi.com/2/files/list_folder','active','folder','application/json','Do\x20you\x20want\x20to\x20restore\x20','278508gRxuil','replace','accessToken','146DRpRiP','classList','Error\x20creating\x20folder\x20','json','setRequestHeader','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','authorization_code','location','Bearer\x20','name','offline','&response_type=','href','parse','length','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','48vblubO','6033234qrKLvk','https://api.dropbox.com/oauth2/token','&grant_type=','application/octet-stream','Unable\x20to\x20refresh\x20token','refreshToken','send','2802940gTJXOO','&token_access_type=','Wait\x20a\x20little\x20bit...','Error\x20while\x20refreshing\x20token:','confirm','screenshot','2035215mnmOvx','uploadFileInCloud','https://content.dropboxapi.com/2/files/upload','No\x20refresh\x20token','Cloud\x20↦\x20Kabu\x20storage\x20◆','click','.tag','entries',',\x20status:\x20','save','uId','Refreshing\x20token...','error_description','onload','\x20files\x20in\x20Kabu?','Download\x20failed\x20for\x20','=([^&#]*)','Do\x20you\x20want\x20to\x20logout?','listFiles','9860024tjzguT','Folder\x20created','search','\x20files\x20from\x20Cloud?','&client_secret=','Restore\x20canceled\x20by\x20user.','DOMContentLoaded','responseText','[\x5c?&#]','status','split','7prOSGi','Do\x20you\x20want\x20to\x20backup\x20','file','https://www.dropbox.com/oauth2/authorize?client_id=','application/x-www-form-urlencoded','POST','stringify','log','alert','refresh_token','addEventListener','code=','getItem','Do\x20not\x20receive\x20authorization','Content-Type','Failed\x20to\x20refresh\x20Dropbox\x20token.','Cloud\x20login\x20required!','downloadFileInCloud'];a0_0x220d=function(){return _0x2b6557;};return a0_0x220d();}import*as a0_0x16e95e from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4f0e3c(0x138),clientSecret=a0_0x4f0e3c(0xd4);function authorizeWithDropbox(){var _0x4f66b3=a0_0x4f0e3c,_0xe1cea1=window[_0x4f66b3(0xee)][_0x4f66b3(0xf3)][_0x4f66b3(0x122)]('?')[0x0],_0xf20a79=_0x4f66b3(0xdd),_0x2b379f=_0x4f66b3(0xf1),_0xaf9c8f=_0x4f66b3(0x126)+clientId+_0x4f66b3(0xf2)+_0xf20a79+_0x4f66b3(0x100)+_0x2b379f+'&redirect_uri='+encodeURIComponent(_0xe1cea1);window[_0x4f66b3(0xee)]['href']=_0xaf9c8f;}function handleDropboxCallback(){var _0x4ee6b7=a0_0x4f0e3c,_0x5671c2=getUrlParameter(_0x4ee6b7(0xdd));_0x5671c2?(getAccessToken(_0x5671c2),console[_0x4ee6b7(0x12a)](_0x4ee6b7(0xde),_0x5671c2)):console[_0x4ee6b7(0x12a)](_0x4ee6b7(0x130));}function getUrlParameter(_0x308813){var _0x2b729b=a0_0x4f0e3c;_0x308813=_0x308813[_0x2b729b(0xe5)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2324d4=new RegExp(_0x2b729b(0x120)+_0x308813+_0x2b729b(0x115)),_0x7b711d=_0x2324d4['exec'](location[_0x2b729b(0x11a)]);return _0x7b711d===null?'':decodeURIComponent(_0x7b711d[0x1][_0x2b729b(0xe5)](/\+/g,'\x20'));}function getAccessToken(_0x48117b){var _0x194261=a0_0x4f0e3c,_0xa1f79f=_0x194261(0xed),_0x554fde=window['location']['href'][_0x194261(0x122)]('?')[0x0],_0x35fba5=new XMLHttpRequest();_0x35fba5['open'](_0x194261(0x128),_0x194261(0xf9)),_0x35fba5[_0x194261(0xeb)](_0x194261(0x131),_0x194261(0x127)),_0x35fba5[_0x194261(0x112)]=function(){var _0x32c722=_0x194261;if(_0x35fba5['status']===0xc8){var _0x17dfaa=JSON[_0x32c722(0xf4)](_0x35fba5[_0x32c722(0x11f)]),_0x5d2ba6=_0x17dfaa[_0x32c722(0xd6)],_0xcce00a=_0x17dfaa[_0x32c722(0x12c)],_0x38ad15=_0x17dfaa['uid'];localStorage[_0x32c722(0x135)](_0x32c722(0xe6),_0x5d2ba6),localStorage[_0x32c722(0x135)](_0x32c722(0xfd),_0xcce00a),localStorage[_0x32c722(0x135)](_0x32c722(0x10f),_0x38ad15);}else console['log'](_0x32c722(0xec));},_0x35fba5[_0x194261(0xfe)](_0x194261(0x12e)+_0x48117b+_0x194261(0xfa)+_0xa1f79f+_0x194261(0xd7)+clientId+_0x194261(0x11c)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x554fde));}export async function dpCreateFolder(_0x424c4c){var _0x58661d=a0_0x4f0e3c;const _0x35e216=localStorage['getItem'](_0x58661d(0x10f));let _0x295d28=localStorage['getItem'](_0x58661d(0xe6));const _0x369a2e='/'+_0x35e216+'/'+_0x424c4c,_0x170ef1=JSON[_0x58661d(0x129)]({'path':_0x369a2e,'autorename':![]});for(let _0x20f23c=0x0;_0x20f23c<0x2;_0x20f23c++){try{const _0x4224c0=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x58661d(0x128),'headers':{'Authorization':_0x58661d(0xef)+_0x295d28,'Content-Type':'application/json'},'body':_0x170ef1});if(_0x4224c0['status']===0x191){const _0x53aa43=await dpRefreshToken();if(!_0x53aa43)throw new Error(_0x58661d(0xfc));_0x295d28=localStorage['getItem'](_0x58661d(0xe6));continue;}if(_0x4224c0['status']===0x199)return{'message':'Folder\x20already\x20exists','path':_0x424c4c};if(!_0x4224c0['ok'])throw new Error(_0x58661d(0xe9)+_0x424c4c);const _0x1654ee=await _0x4224c0[_0x58661d(0xea)]();return await lockNoti(_0x58661d(0x119),'',0xbb8),_0x1654ee;}catch(_0x2ad21d){if(_0x20f23c===0x1)throw _0x2ad21d;}}return![];}export async function dpRefreshToken(){var _0x33bd67=a0_0x4f0e3c;if(!localStorage[_0x33bd67(0x12f)](_0x33bd67(0xfd)))throw _0x33bd67(0x108);try{const _0x16ee35=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x33bd67(0x128),'headers':{'Content-Type':_0x33bd67(0x127)},'body':'refresh_token='+localStorage['getItem']('refreshToken')+_0x33bd67(0xf6)}),_0x1a61b5=await _0x16ee35[_0x33bd67(0xea)]();if(!_0x1a61b5[_0x33bd67(0xd5)])return localStorage[_0x33bd67(0x135)](_0x33bd67(0xe6),_0x1a61b5['access_token']),await lockNoti(_0x33bd67(0x110),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1a61b5[_0x33bd67(0x111)]||_0x33bd67(0x132));}catch(_0x4b76e9){console['error'](_0x33bd67(0x102),_0x4b76e9);}return![];}export async function dpUploadFile(_0x40e5a5,_0x2b7782,_0x643583){var _0x264707=a0_0x4f0e3c;const _0x1dd9f3=localStorage[_0x264707(0x12f)](_0x264707(0x10f));var _0xfa1848=JSON[_0x264707(0x129)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x1dd9f3+'/'+_0x643583+'/'+_0x40e5a5}),_0x2158ea=new Blob([_0x2b7782],{'type':'application/octet-stream'});for(var _0xa7546d=0x0;_0xa7546d<0x2;_0xa7546d++){var _0x3ea75c=await fetch(_0x264707(0x107),{'method':'POST','headers':{'Authorization':_0x264707(0xef)+localStorage[_0x264707(0x12f)](_0x264707(0xe6)),'Dropbox-API-Arg':_0xfa1848,'Content-Type':_0x264707(0xfb)},'body':_0x2158ea});if(_0x3ea75c[_0x264707(0x121)]!=0xc8){if(_0x3ea75c['status']==0x191){var _0x416614=await dpRefreshToken();if(!_0x416614)throw _0x264707(0xfc);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3ea75c[_0x264707(0x121)];}else{var _0x54b711=await _0x3ea75c['json']();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x40e5a5),_0x54b711;}}return![];}function a0_0x5bb6(_0x3ec7ca,_0x5a639e){var _0x220d8b=a0_0x220d();return a0_0x5bb6=function(_0x5bb6e1,_0xabbbe1){_0x5bb6e1=_0x5bb6e1-0xd3;var _0x26bf95=_0x220d8b[_0x5bb6e1];return _0x26bf95;},a0_0x5bb6(_0x3ec7ca,_0x5a639e);}export async function dpDownloadFile(_0x37b334,_0x53075b){var _0x72dc8a=a0_0x4f0e3c;const _0x14d284=localStorage[_0x72dc8a(0x12f)]('uId');var _0x33d7e4=JSON[_0x72dc8a(0x129)]({'path':'/'+_0x14d284+'/'+_0x53075b+'/'+_0x37b334});for(var _0x9b7623=0x0;_0x9b7623<0x2;_0x9b7623++){var _0x436de5=await fetch(_0x72dc8a(0xd3),{'method':_0x72dc8a(0x128),'headers':{'Authorization':_0x72dc8a(0xef)+localStorage[_0x72dc8a(0x12f)]('accessToken'),'Dropbox-API-Arg':_0x33d7e4}});if(_0x436de5[_0x72dc8a(0x121)]!=0xc8){if(_0x436de5[_0x72dc8a(0x121)]==0x191){var _0x21e865=await dpRefreshToken();if(!_0x21e865)throw _0x72dc8a(0xfc);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x436de5['status'];}const _0x4976a8=new File([await _0x436de5['blob']()],_0x37b334);return console[_0x72dc8a(0x12a)](_0x72dc8a(0x109),_0x4976a8[_0x72dc8a(0xf0)]),a0_0x16e95e[_0x72dc8a(0x106)](_0x4976a8,()=>{}),_0x4976a8;}return![];}document[a0_0x4f0e3c(0x12d)](a0_0x4f0e3c(0x11e),function(){var _0x9f8124=a0_0x4f0e3c;dropboxRestore[_0x9f8124(0x12d)](_0x9f8124(0x10a),async function(){var _0x2f0f3c=_0x9f8124;await lockNoti(_0x2f0f3c(0x101),'',0x1388);const _0x2483af=localStorage[_0x2f0f3c(0x12f)]('uId'),_0xfd252b=[_0x2f0f3c(0xdb),_0x2f0f3c(0x10e),'screenshot'];if(!_0x2483af){window[_0x2f0f3c(0x12b)]('Cloud\x20login\x20required!');return;}let _0x534d7f=[];for(const _0x583f20 of _0xfd252b){let _0x327efe={'path':'/'+_0x2483af+'/'+_0x583f20};for(let _0x273747=0x0;_0x273747<0x2;_0x273747++){let _0x47745d=await fetch(_0x2f0f3c(0xdf),{'method':_0x2f0f3c(0x128),'headers':{'Authorization':_0x2f0f3c(0xef)+localStorage[_0x2f0f3c(0x12f)](_0x2f0f3c(0xe6)),'Content-Type':_0x2f0f3c(0xe2)},'body':JSON[_0x2f0f3c(0x129)](_0x327efe)});if(_0x47745d[_0x2f0f3c(0x121)]===0xc8){let _0x1799dd=await _0x47745d[_0x2f0f3c(0xea)](),_0x4ce1f9=_0x1799dd[_0x2f0f3c(0x10c)]['filter'](_0xc6caad=>_0xc6caad[_0x2f0f3c(0x10b)]===_0x2f0f3c(0x125));_0x4ce1f9['length']>0x0&&_0x534d7f[_0x2f0f3c(0xdc)](..._0x4ce1f9['map'](_0xd54857=>({'name':_0xd54857[_0x2f0f3c(0xf0)],'folder':_0x583f20})));break;}else{if(_0x47745d[_0x2f0f3c(0x121)]===0x191){let _0x4a7502=await dpRefreshToken();if(!_0x4a7502)throw _0x2f0f3c(0xfc);}else{console[_0x2f0f3c(0xd5)](_0x2f0f3c(0x114)+_0x583f20+_0x2f0f3c(0x10d)+_0x47745d[_0x2f0f3c(0x121)]);break;}}}}if(_0x534d7f[_0x2f0f3c(0xf5)]>0x0){const _0x29a1c2=_0x2f0f3c(0xe3)+_0x534d7f['length']+_0x2f0f3c(0x11b);if(window[_0x2f0f3c(0x103)](_0x29a1c2))for(const _0x31cda8 of _0x534d7f){await lockNoti('Restoring...',_0x31cda8[_0x2f0f3c(0xf0)],0xbb8),await dpDownloadFile(_0x31cda8[_0x2f0f3c(0xf0)],_0x31cda8[_0x2f0f3c(0xe1)]);}else console[_0x2f0f3c(0x12a)]('Restore\x20canceled\x20by\x20user.');}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x9f8124(0x12d)](_0x9f8124(0x10a),async function(){var _0x94c8ee=_0x9f8124;await lockNoti(_0x94c8ee(0x101),'',0x1388);const _0x4e17d7=localStorage[_0x94c8ee(0x12f)](_0x94c8ee(0x10f));if(_0x4e17d7===null||_0x4e17d7==='')window[_0x94c8ee(0x12b)](_0x94c8ee(0x133));else{const _0x35ca04=[_0x94c8ee(0xdb),_0x94c8ee(0x10e),_0x94c8ee(0x104)];for(const _0xdbf088 of _0x35ca04){await dpCreateFolder(_0xdbf088);}let _0x1427c7=0x0;for(const _0x3cd840 of _0x35ca04){const _0x170d47=a0_0x16e95e[_0x94c8ee(0x117)](_0x3cd840+'s');_0x1427c7+=_0x170d47[_0x94c8ee(0xf5)];}if(window[_0x94c8ee(0x103)](_0x94c8ee(0x124)+_0x1427c7+_0x94c8ee(0x113)))for(const _0x582898 of _0x35ca04){const _0x42a72b=a0_0x16e95e[_0x94c8ee(0x117)](_0x582898+'s');for(const _0x25d07e of _0x42a72b){const _0x2eb86b=await a0_0x16e95e[_0x94c8ee(0x134)](_0x94c8ee(0x136)+_0x582898+'s/'+_0x25d07e);try{await lockNoti('Backing\x20up...',_0x25d07e,0xbb8),await dpUploadFile(_0x25d07e,_0x2eb86b,_0x582898);}catch(_0x32e406){console[_0x94c8ee(0xd5)](_0x94c8ee(0x137)+_0x25d07e+':',_0x32e406);}}}else console[_0x94c8ee(0x12a)](_0x94c8ee(0x11d));}}),dropboxCloud['addEventListener'](_0x9f8124(0x10a),function(){var _0x515b0d=_0x9f8124;const _0x4e5ff2=localStorage[_0x515b0d(0x12f)](_0x515b0d(0x10f));_0x4e5ff2===null||_0x4e5ff2===''?authorizeWithDropbox():window['confirm'](_0x515b0d(0x116))&&(localStorage[_0x515b0d(0x135)](_0x515b0d(0x10f),''),dropboxRestore[_0x515b0d(0xe8)]['remove']('active'),dropboxBackup[_0x515b0d(0xe8)][_0x515b0d(0xd8)](_0x515b0d(0xe0)),dropboxCloud[_0x515b0d(0xe8)][_0x515b0d(0xd8)](_0x515b0d(0xe0)));}),handleDropboxCallback();});