var a0_0x91b7f0=a0_0x55fe;(function(_0x10ba49,_0x4cdb8d){var _0x5b28a4=a0_0x55fe,_0x50e552=_0x10ba49();while(!![]){try{var _0x31fb0d=-parseInt(_0x5b28a4(0x11b))/0x1*(-parseInt(_0x5b28a4(0x121))/0x2)+-parseInt(_0x5b28a4(0x157))/0x3*(parseInt(_0x5b28a4(0x145))/0x4)+parseInt(_0x5b28a4(0x133))/0x5*(parseInt(_0x5b28a4(0x146))/0x6)+-parseInt(_0x5b28a4(0x106))/0x7+-parseInt(_0x5b28a4(0x156))/0x8+parseInt(_0x5b28a4(0x114))/0x9*(parseInt(_0x5b28a4(0x143))/0xa)+parseInt(_0x5b28a4(0x15e))/0xb;if(_0x31fb0d===_0x4cdb8d)break;else _0x50e552['push'](_0x50e552['shift']());}catch(_0x39dbce){_0x50e552['push'](_0x50e552['shift']());}}}(a0_0xcfa5,0x469f6));function a0_0x55fe(_0x441655,_0x5a9419){var _0xcfa59c=a0_0xcfa5();return a0_0x55fe=function(_0x55fe8c,_0x42e55a){_0x55fe8c=_0x55fe8c-0x103;var _0x2ce994=_0xcfa59c[_0x55fe8c];return _0x2ce994;},a0_0x55fe(_0x441655,_0x5a9419);}import*as a0_0x287a95 from'./main.js';function a0_0xcfa5(){var _0x5a450b=['remove','save','=([^&#]*)','offline','addEventListener','downloadFileInCloud','[\x5c?&#]','overwrite','https://content.dropboxapi.com/2/files/download','POST','&token_access_type=','alert','exec','2662562NtQyHk','json','Error\x20while\x20refreshing\x20token:','accessToken','entries','send','application/x-www-form-urlencoded','replace','confirm','&grant_type=','error','map','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','active','1115469YBxXTk','Authorization\x20Code:','No\x20files\x20found\x20to\x20restore.','split','DOMContentLoaded','https://api.dropboxapi.com/oauth2/token','/data/','1AVZlBz','stringify','Cloud\x20login\x20required!','location','setRequestHeader','https://www.dropbox.com/oauth2/authorize?client_id=','555722wuQrcA','responseText','Error\x20creating\x20folder\x20','https://api.dropboxapi.com/2/files/create_folder_v2','&client_secret=','click','Unable\x20to\x20refresh\x20token','Wait\x20a\x20little\x20bit...','&client_id=','knh3uz2mx2hp2eu','screenshot','refreshToken','href','onload','name','Do\x20not\x20receive\x20authorization','code','&redirect_uri=','1024360TqQzlH','Folder\x20created','Content-Type','Do\x20you\x20want\x20to\x20backup\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Failed\x20to\x20upload\x20file\x20','getItem','\x20files\x20in\x20Kabu?','push','uploadFileInCloud','Kabu\x20storage\x20↦\x20Cloud\x20◆','log','uId','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://api.dropboxapi.com/2/files/list_folder','listFiles','20CensZL','status','642236EPUZQa','12nIMDeH','classList','Folder\x20already\x20exists','Restoring...','Refreshing\x20token...','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Do\x20you\x20want\x20to\x20logout?','state','Bearer\x20','folder','refresh_token=','parse','.tag','Restore\x20canceled\x20by\x20user.','access_token','filter','1765832xSDLgm','3vnmYKw','application/octet-stream','setItem','length','open','search','nwb3dnfh09rhs31','1269807odRulX','application/json','error_description'];a0_0xcfa5=function(){return _0x5a450b;};return a0_0xcfa5();}import{localStorageFile}from'./storage.js';var clientId=a0_0x91b7f0(0x12a),clientSecret=a0_0x91b7f0(0x15d);function authorizeWithDropbox(){var _0x4ae534=a0_0x91b7f0,_0x51d4ad=window['location'][_0x4ae534(0x12d)][_0x4ae534(0x117)]('?')[0x0],_0x935b1d=_0x4ae534(0x131),_0x5ec104=_0x4ae534(0x164),_0x4c4809=_0x4ae534(0x120)+clientId+'&response_type='+_0x935b1d+_0x4ae534(0x103)+_0x5ec104+'&redirect_uri='+encodeURIComponent(_0x51d4ad);window[_0x4ae534(0x11e)][_0x4ae534(0x12d)]=_0x4c4809;}function handleDropboxCallback(){var _0x32571a=a0_0x91b7f0,_0x2dad9d=getUrlParameter(_0x32571a(0x131));_0x2dad9d?(getAccessToken(_0x2dad9d),console['log'](_0x32571a(0x115),_0x2dad9d)):console[_0x32571a(0x13e)](_0x32571a(0x130));}function getUrlParameter(_0x576cba){var _0x18d2c1=a0_0x91b7f0;_0x576cba=_0x576cba[_0x18d2c1(0x10d)](/[\[]/,'\x5c[')[_0x18d2c1(0x10d)](/[\]]/,'\x5c]');var _0x9fa763=new RegExp(_0x18d2c1(0x167)+_0x576cba+_0x18d2c1(0x163)),_0x942c71=_0x9fa763[_0x18d2c1(0x105)](location[_0x18d2c1(0x15c)]);return _0x942c71===null?'':decodeURIComponent(_0x942c71[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x48f323){var _0x57b2fd=a0_0x91b7f0,_0x6fd417='authorization_code',_0x138af1=window[_0x57b2fd(0x11e)]['href'][_0x57b2fd(0x117)]('?')[0x0],_0x29efc6=new XMLHttpRequest();_0x29efc6[_0x57b2fd(0x15b)](_0x57b2fd(0x16a),'https://api.dropbox.com/oauth2/token'),_0x29efc6[_0x57b2fd(0x11f)](_0x57b2fd(0x135),_0x57b2fd(0x10c)),_0x29efc6[_0x57b2fd(0x12e)]=function(){var _0xcc9292=_0x57b2fd;if(_0x29efc6[_0xcc9292(0x144)]===0xc8){var _0x1c4f84=JSON[_0xcc9292(0x151)](_0x29efc6[_0xcc9292(0x122)]),_0x269c90=_0x1c4f84[_0xcc9292(0x154)],_0x1c26cb=_0x1c4f84['refresh_token'],_0x23a0b1=_0x1c4f84['uid'];localStorage[_0xcc9292(0x159)](_0xcc9292(0x109),_0x269c90),localStorage[_0xcc9292(0x159)](_0xcc9292(0x12c),_0x1c26cb),localStorage[_0xcc9292(0x159)]('uId',_0x23a0b1);}else console[_0xcc9292(0x13e)](_0xcc9292(0x112));},_0x29efc6[_0x57b2fd(0x10b)]('code='+_0x48f323+_0x57b2fd(0x10f)+_0x6fd417+_0x57b2fd(0x129)+clientId+_0x57b2fd(0x125)+clientSecret+_0x57b2fd(0x132)+encodeURIComponent(_0x138af1));}export async function dpCreateFolder(_0x14e426){var _0x593954=a0_0x91b7f0;const _0x47c867=localStorage[_0x593954(0x139)]('uId');let _0x519055=localStorage[_0x593954(0x139)]('accessToken');const _0x48d85d='/'+_0x47c867+'/'+_0x14e426,_0x3ce11b=JSON[_0x593954(0x11c)]({'path':_0x48d85d,'autorename':![]});for(let _0x40d79a=0x0;_0x40d79a<0x2;_0x40d79a++){try{const _0x5452d7=await fetch(_0x593954(0x124),{'method':_0x593954(0x16a),'headers':{'Authorization':_0x593954(0x14e)+_0x519055,'Content-Type':_0x593954(0x15f)},'body':_0x3ce11b});if(_0x5452d7[_0x593954(0x144)]===0x191){const _0x155187=await dpRefreshToken();if(!_0x155187)throw new Error('Unable\x20to\x20refresh\x20token');_0x519055=localStorage[_0x593954(0x139)]('accessToken');continue;}if(_0x5452d7[_0x593954(0x144)]===0x199)return{'message':_0x593954(0x148),'path':_0x14e426};if(!_0x5452d7['ok'])throw new Error(_0x593954(0x123)+_0x14e426);const _0x457d30=await _0x5452d7[_0x593954(0x107)]();return await lockNoti(_0x593954(0x134),'',0xbb8),_0x457d30;}catch(_0x46e020){if(_0x40d79a===0x1)throw _0x46e020;}}return![];}export async function dpRefreshToken(){var _0x44d630=a0_0x91b7f0;if(!localStorage[_0x44d630(0x139)](_0x44d630(0x12c)))throw'No\x20refresh\x20token';try{const _0x1f6335=await fetch(_0x44d630(0x119),{'method':'POST','headers':{'Content-Type':_0x44d630(0x10c)},'body':_0x44d630(0x150)+localStorage[_0x44d630(0x139)](_0x44d630(0x12c))+_0x44d630(0x137)}),_0x139352=await _0x1f6335['json']();if(!_0x139352['error'])return localStorage['setItem'](_0x44d630(0x109),_0x139352['access_token']),await lockNoti(_0x44d630(0x14a),'',0xbb8),await delay(0x3e8),!![];else alert(_0x139352[_0x44d630(0x160)]||_0x44d630(0x140));}catch(_0x1b8c75){console[_0x44d630(0x110)](_0x44d630(0x108),_0x1b8c75);}return![];}export async function dpUploadFile(_0x44241b,_0x34c4fe,_0x57a716){var _0x5af4b1=a0_0x91b7f0;const _0x992ae2=localStorage[_0x5af4b1(0x139)](_0x5af4b1(0x13f));var _0x2c3eae=JSON[_0x5af4b1(0x11c)]({'autorename':!![],'mode':_0x5af4b1(0x168),'mute':!![],'strict_conflict':![],'path':'/'+_0x992ae2+'/'+_0x57a716+'/'+_0x44241b}),_0x1188e4=new Blob([_0x34c4fe],{'type':_0x5af4b1(0x158)});for(var _0x1262d4=0x0;_0x1262d4<0x2;_0x1262d4++){var _0x45c3d5=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x5af4b1(0x16a),'headers':{'Authorization':_0x5af4b1(0x14e)+localStorage[_0x5af4b1(0x139)](_0x5af4b1(0x109)),'Dropbox-API-Arg':_0x2c3eae,'Content-Type':'application/octet-stream'},'body':_0x1188e4});if(_0x45c3d5[_0x5af4b1(0x144)]!=0xc8){if(_0x45c3d5[_0x5af4b1(0x144)]==0x191){var _0x4e3088=await dpRefreshToken();if(!_0x4e3088)throw _0x5af4b1(0x127);continue;}else throw _0x5af4b1(0x14b)+_0x45c3d5[_0x5af4b1(0x144)];}else{var _0x51b6fa=await _0x45c3d5['json']();return console[_0x5af4b1(0x13e)](_0x5af4b1(0x13d),_0x44241b),_0x51b6fa;}}return![];}export async function dpDownloadFile(_0x5c5edd,_0x10f3c2){var _0x4fa5a7=a0_0x91b7f0;const _0x2c95c4=localStorage[_0x4fa5a7(0x139)](_0x4fa5a7(0x13f));var _0x17a7ee=JSON[_0x4fa5a7(0x11c)]({'path':'/'+_0x2c95c4+'/'+_0x10f3c2+'/'+_0x5c5edd});for(var _0x5c8a41=0x0;_0x5c8a41<0x2;_0x5c8a41++){var _0x26fce6=await fetch(_0x4fa5a7(0x169),{'method':_0x4fa5a7(0x16a),'headers':{'Authorization':_0x4fa5a7(0x14e)+localStorage['getItem'](_0x4fa5a7(0x109)),'Dropbox-API-Arg':_0x17a7ee}});if(_0x26fce6[_0x4fa5a7(0x144)]!=0xc8){if(_0x26fce6['status']==0x191){var _0x5d2a70=await dpRefreshToken();if(!_0x5d2a70)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x26fce6[_0x4fa5a7(0x144)];}const _0x2c72e5=new File([await _0x26fce6['blob']()],_0x5c5edd);return console['log']('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2c72e5[_0x4fa5a7(0x12f)]),a0_0x287a95[_0x4fa5a7(0x13c)](_0x2c72e5,()=>{}),_0x2c72e5;}return![];}document['addEventListener'](a0_0x91b7f0(0x118),function(){var _0x2325eb=a0_0x91b7f0;dropboxRestore[_0x2325eb(0x165)](_0x2325eb(0x126),async function(){var _0x89f885=_0x2325eb;await lockNoti(_0x89f885(0x128),'',0x1388);const _0x33682d=localStorage[_0x89f885(0x139)](_0x89f885(0x13f)),_0x6dc143=[_0x89f885(0x14d),'save',_0x89f885(0x12b)];if(!_0x33682d){window[_0x89f885(0x104)](_0x89f885(0x11d));return;}let _0x5d41d9=[];for(const _0xf3a5ad of _0x6dc143){let _0x1105d2={'path':'/'+_0x33682d+'/'+_0xf3a5ad};for(let _0x1d308d=0x0;_0x1d308d<0x2;_0x1d308d++){let _0x5787ea=await fetch(_0x89f885(0x141),{'method':'POST','headers':{'Authorization':_0x89f885(0x14e)+localStorage['getItem'](_0x89f885(0x109)),'Content-Type':_0x89f885(0x15f)},'body':JSON[_0x89f885(0x11c)](_0x1105d2)});if(_0x5787ea['status']===0xc8){let _0x26825b=await _0x5787ea[_0x89f885(0x107)](),_0x5600f7=_0x26825b[_0x89f885(0x10a)][_0x89f885(0x155)](_0x3edfa0=>_0x3edfa0[_0x89f885(0x152)]==='file');_0x5600f7['length']>0x0&&_0x5d41d9[_0x89f885(0x13b)](..._0x5600f7[_0x89f885(0x111)](_0x1d0875=>({'name':_0x1d0875['name'],'folder':_0xf3a5ad})));break;}else{if(_0x5787ea['status']===0x191){let _0x3660db=await dpRefreshToken();if(!_0x3660db)throw _0x89f885(0x127);}else{console['error']('Download\x20failed\x20for\x20'+_0xf3a5ad+',\x20status:\x20'+_0x5787ea[_0x89f885(0x144)]);break;}}}}if(_0x5d41d9[_0x89f885(0x15a)]>0x0){const _0x2e3392='Do\x20you\x20want\x20to\x20restore\x20'+_0x5d41d9[_0x89f885(0x15a)]+'\x20files\x20from\x20Cloud?';if(window[_0x89f885(0x10e)](_0x2e3392))for(const _0x2db55f of _0x5d41d9){await lockNoti(_0x89f885(0x149),_0x2db55f['name'],0xbb8),await dpDownloadFile(_0x2db55f[_0x89f885(0x12f)],_0x2db55f[_0x89f885(0x14f)]);}else console[_0x89f885(0x13e)]('Restore\x20canceled\x20by\x20user.');}else console[_0x89f885(0x13e)](_0x89f885(0x116));}),dropboxBackup[_0x2325eb(0x165)](_0x2325eb(0x126),async function(){var _0x312fcc=_0x2325eb;await lockNoti(_0x312fcc(0x128),'',0x1388);const _0x538ef0=localStorage[_0x312fcc(0x139)](_0x312fcc(0x13f));if(_0x538ef0===null||_0x538ef0==='')window[_0x312fcc(0x104)](_0x312fcc(0x11d));else{const _0x1f5bf4=[_0x312fcc(0x14d),_0x312fcc(0x162),_0x312fcc(0x12b)];for(const _0x2f0de8 of _0x1f5bf4){await dpCreateFolder(_0x2f0de8);}let _0x5aa470=0x0;for(const _0x537576 of _0x1f5bf4){const _0x56faff=a0_0x287a95['listFiles'](_0x537576+'s');_0x5aa470+=_0x56faff[_0x312fcc(0x15a)];}if(window[_0x312fcc(0x10e)](_0x312fcc(0x136)+_0x5aa470+_0x312fcc(0x13a)))for(const _0x32c697 of _0x1f5bf4){const _0x2de5f2=a0_0x287a95[_0x312fcc(0x142)](_0x32c697+'s');for(const _0x5ea74f of _0x2de5f2){const _0xb9d441=await a0_0x287a95[_0x312fcc(0x166)](_0x312fcc(0x11a)+_0x32c697+'s/'+_0x5ea74f);try{await lockNoti('Backing\x20up...',_0x5ea74f,0xbb8),await dpUploadFile(_0x5ea74f,_0xb9d441,_0x32c697);}catch(_0x3485bf){console[_0x312fcc(0x110)](_0x312fcc(0x138)+_0x5ea74f+':',_0x3485bf);}}}else console[_0x312fcc(0x13e)](_0x312fcc(0x153));}}),dropboxCloud['addEventListener'](_0x2325eb(0x126),function(){var _0x5d87a3=_0x2325eb;const _0x3ef447=localStorage[_0x5d87a3(0x139)](_0x5d87a3(0x13f));_0x3ef447===null||_0x3ef447===''?authorizeWithDropbox():window['confirm'](_0x5d87a3(0x14c))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x5d87a3(0x147)][_0x5d87a3(0x161)](_0x5d87a3(0x113)),dropboxBackup[_0x5d87a3(0x147)][_0x5d87a3(0x161)]('active'),dropboxCloud['classList'][_0x5d87a3(0x161)](_0x5d87a3(0x113)));}),handleDropboxCallback();});