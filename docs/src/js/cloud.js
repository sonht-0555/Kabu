function a0_0xafd7(){var _0x5449a9=['=([^&#]*)','https://api.dropboxapi.com/oauth2/token','https://www.dropbox.com/oauth2/authorize?client_id=','No\x20refresh\x20token','Failed\x20to\x20refresh\x20Dropbox\x20token.','screenshot','https://api.dropboxapi.com/2/files/list_folder','Failed\x20to\x20upload\x20file\x20','739561xZoOtX','listFiles','Cloud\x20login\x20required!','application/x-www-form-urlencoded','refreshToken','getItem','Upload\x20failed,\x20unknown\x20http\x20status:\x20','confirm','filter','\x20files\x20from\x20Cloud?','state','Download\x20failed,\x20unknown\x20http\x20status:','click','&token_access_type=','blob','Content-Type','Do\x20you\x20want\x20to\x20restore\x20','folder','1720081qAoSoj','error','216872JsPsBx','code=','stringify','uploadFileInCloud','entries','file','length','&response_type=','Error\x20creating\x20folder\x20','No\x20files\x20found\x20to\x20restore.','search','12BmrsMJ','Bearer\x20','code','130299CEmWLE','https://content.dropboxapi.com/2/files/upload','name','href','Refreshing\x20token...','split','access_token','alert','push','Download\x20failed\x20for\x20','&client_id=','10JgwbYv','knh3uz2mx2hp2eu','Folder\x20already\x20exists','POST',',\x20status:\x20','5WDzjRc','log','setItem','49oRCAms','exec','addEventListener','\x20files\x20in\x20Kabu?','https://api.dropboxapi.com/2/files/create_folder_v2','Error\x20while\x20refreshing\x20token:','remove','&grant_type=','Do\x20you\x20want\x20to\x20backup\x20','Unable\x20to\x20refresh\x20token','uid','authorization_code','json','status','Authorization\x20Code:','application/octet-stream','replace','open','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','map','error_description','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','24MjpIWi','accessToken','refresh_token','4590188sFmXco','Restoring...','/data/','&client_secret=','uId','7291476aRCQPJ','Restore\x20canceled\x20by\x20user.','classList','Cloud\x20↦\x20Kabu\x20storage\x20◆','7202205NfdhLi','offline','Backing\x20up...','location','refresh_token=','Kabu\x20storage\x20↦\x20Cloud\x20◆','&redirect_uri=','active','nwb3dnfh09rhs31','.tag','downloadFileInCloud'];a0_0xafd7=function(){return _0x5449a9;};return a0_0xafd7();}var a0_0x369f54=a0_0x2cc4;(function(_0x5a7c56,_0x2d6a63){var _0x4bb3a9=a0_0x2cc4,_0x421ac3=_0x5a7c56();while(!![]){try{var _0x201a82=-parseInt(_0x4bb3a9(0x1cf))/0x1+-parseInt(_0x4bb3a9(0x1b0))/0x2*(-parseInt(_0x4bb3a9(0x187))/0x3)+-parseInt(_0x4bb3a9(0x1b3))/0x4+parseInt(_0x4bb3a9(0x197))/0x5*(parseInt(_0x4bb3a9(0x1b8))/0x6)+parseInt(_0x4bb3a9(0x19a))/0x7*(parseInt(_0x4bb3a9(0x179))/0x8)+parseInt(_0x4bb3a9(0x1bc))/0x9*(parseInt(_0x4bb3a9(0x192))/0xa)+-parseInt(_0x4bb3a9(0x177))/0xb*(parseInt(_0x4bb3a9(0x184))/0xc);if(_0x201a82===_0x2d6a63)break;else _0x421ac3['push'](_0x421ac3['shift']());}catch(_0x3441f9){_0x421ac3['push'](_0x421ac3['shift']());}}}(a0_0xafd7,0xa6bdb));import*as a0_0x5de072 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x369f54(0x193),clientSecret=a0_0x369f54(0x1c4);function authorizeWithDropbox(){var _0x28621e=a0_0x369f54,_0x530409=window[_0x28621e(0x1bf)][_0x28621e(0x18a)][_0x28621e(0x18c)]('?')[0x0],_0x33b66c=_0x28621e(0x186),_0x288656=_0x28621e(0x1bd),_0x484dc6=_0x28621e(0x1c9)+clientId+_0x28621e(0x180)+_0x33b66c+_0x28621e(0x172)+_0x288656+_0x28621e(0x1c2)+encodeURIComponent(_0x530409);window[_0x28621e(0x1bf)]['href']=_0x484dc6;}function handleDropboxCallback(){var _0x547178=a0_0x369f54,_0x1e06f0=getUrlParameter(_0x547178(0x186));_0x1e06f0?(getAccessToken(_0x1e06f0),console[_0x547178(0x198)](_0x547178(0x1a8),_0x1e06f0)):console[_0x547178(0x198)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x3155cb){var _0x48af75=a0_0x369f54;_0x3155cb=_0x3155cb['replace'](/[\[]/,'\x5c[')[_0x48af75(0x1aa)](/[\]]/,'\x5c]');var _0x4ff7a9=new RegExp('[\x5c?&#]'+_0x3155cb+_0x48af75(0x1c7)),_0x13b51e=_0x4ff7a9[_0x48af75(0x19b)](location[_0x48af75(0x183)]);return _0x13b51e===null?'':decodeURIComponent(_0x13b51e[0x1][_0x48af75(0x1aa)](/\+/g,'\x20'));}function getAccessToken(_0x2a39e9){var _0x1e9044=a0_0x369f54,_0x5032be=_0x1e9044(0x1a5),_0x507c9e=window[_0x1e9044(0x1bf)][_0x1e9044(0x18a)][_0x1e9044(0x18c)]('?')[0x0],_0x24d1c8=new XMLHttpRequest();_0x24d1c8[_0x1e9044(0x1ab)](_0x1e9044(0x195),'https://api.dropbox.com/oauth2/token'),_0x24d1c8['setRequestHeader'](_0x1e9044(0x174),_0x1e9044(0x168)),_0x24d1c8['onload']=function(){var _0x2c0f57=_0x1e9044;if(_0x24d1c8[_0x2c0f57(0x1a7)]===0xc8){var _0x459733=JSON['parse'](_0x24d1c8['responseText']),_0xc22bda=_0x459733[_0x2c0f57(0x18d)],_0x4f985c=_0x459733[_0x2c0f57(0x1b2)],_0x127973=_0x459733[_0x2c0f57(0x1a4)];localStorage[_0x2c0f57(0x199)](_0x2c0f57(0x1b1),_0xc22bda),localStorage[_0x2c0f57(0x199)](_0x2c0f57(0x169),_0x4f985c),localStorage['setItem'](_0x2c0f57(0x1b7),_0x127973);}else console['log'](_0x2c0f57(0x1ac));},_0x24d1c8['send'](_0x1e9044(0x17a)+_0x2a39e9+_0x1e9044(0x1a1)+_0x5032be+_0x1e9044(0x191)+clientId+_0x1e9044(0x1b6)+clientSecret+_0x1e9044(0x1c2)+encodeURIComponent(_0x507c9e));}export async function dpCreateFolder(_0x35f74b){var _0x4ea203=a0_0x369f54;const _0x14e70c=localStorage[_0x4ea203(0x16a)](_0x4ea203(0x1b7));let _0x1cb7ca=localStorage[_0x4ea203(0x16a)](_0x4ea203(0x1b1));const _0x5f5333='/'+_0x14e70c+'/'+_0x35f74b,_0x5c3ee9=JSON[_0x4ea203(0x17b)]({'path':_0x5f5333,'autorename':![]});for(let _0x222937=0x0;_0x222937<0x2;_0x222937++){try{const _0x5d43bc=await fetch(_0x4ea203(0x19e),{'method':_0x4ea203(0x195),'headers':{'Authorization':_0x4ea203(0x185)+_0x1cb7ca,'Content-Type':'application/json'},'body':_0x5c3ee9});if(_0x5d43bc[_0x4ea203(0x1a7)]===0x191){const _0x34e6e2=await dpRefreshToken();if(!_0x34e6e2)throw new Error('Unable\x20to\x20refresh\x20token');_0x1cb7ca=localStorage[_0x4ea203(0x16a)](_0x4ea203(0x1b1));continue;}if(_0x5d43bc[_0x4ea203(0x1a7)]===0x199)return{'message':_0x4ea203(0x194),'path':_0x35f74b};if(!_0x5d43bc['ok'])throw new Error(_0x4ea203(0x181)+_0x35f74b);const _0x5ba4ae=await _0x5d43bc[_0x4ea203(0x1a6)]();return await lockNoti('Folder\x20created','',0xbb8),_0x5ba4ae;}catch(_0x105f8b){if(_0x222937===0x1)throw _0x105f8b;}}return![];}function a0_0x2cc4(_0xe385ba,_0x445879){var _0xafd71c=a0_0xafd7();return a0_0x2cc4=function(_0x2cc4be,_0x5656f5){_0x2cc4be=_0x2cc4be-0x166;var _0x2b23b1=_0xafd71c[_0x2cc4be];return _0x2b23b1;},a0_0x2cc4(_0xe385ba,_0x445879);}export async function dpRefreshToken(){var _0x477bdb=a0_0x369f54;if(!localStorage[_0x477bdb(0x16a)](_0x477bdb(0x169)))throw _0x477bdb(0x1ca);try{const _0x17e50e=await fetch(_0x477bdb(0x1c8),{'method':_0x477bdb(0x195),'headers':{'Content-Type':_0x477bdb(0x168)},'body':_0x477bdb(0x1c0)+localStorage[_0x477bdb(0x16a)](_0x477bdb(0x169))+_0x477bdb(0x1af)}),_0x5d0e67=await _0x17e50e[_0x477bdb(0x1a6)]();if(!_0x5d0e67[_0x477bdb(0x178)])return localStorage[_0x477bdb(0x199)](_0x477bdb(0x1b1),_0x5d0e67[_0x477bdb(0x18d)]),await lockNoti(_0x477bdb(0x18b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5d0e67[_0x477bdb(0x1ae)]||_0x477bdb(0x1cb));}catch(_0xf3c8a1){console[_0x477bdb(0x178)](_0x477bdb(0x19f),_0xf3c8a1);}return![];}export async function dpUploadFile(_0x57102a,_0x2d6af8,_0x527075){var _0x2bfdb3=a0_0x369f54;const _0x4e3b1d=localStorage[_0x2bfdb3(0x16a)](_0x2bfdb3(0x1b7));var _0x57672e=JSON[_0x2bfdb3(0x17b)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x4e3b1d+'/'+_0x527075+'/'+_0x57102a}),_0x4c0798=new Blob([_0x2d6af8],{'type':_0x2bfdb3(0x1a9)});for(var _0x6808a4=0x0;_0x6808a4<0x2;_0x6808a4++){var _0x5a56b0=await fetch(_0x2bfdb3(0x188),{'method':_0x2bfdb3(0x195),'headers':{'Authorization':_0x2bfdb3(0x185)+localStorage[_0x2bfdb3(0x16a)](_0x2bfdb3(0x1b1)),'Dropbox-API-Arg':_0x57672e,'Content-Type':_0x2bfdb3(0x1a9)},'body':_0x4c0798});if(_0x5a56b0['status']!=0xc8){if(_0x5a56b0['status']==0x191){var _0x44837e=await dpRefreshToken();if(!_0x44837e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x2bfdb3(0x16b)+_0x5a56b0[_0x2bfdb3(0x1a7)];}else{var _0x14fca5=await _0x5a56b0[_0x2bfdb3(0x1a6)]();return console[_0x2bfdb3(0x198)](_0x2bfdb3(0x1c1),_0x57102a),_0x14fca5;}}return![];}export async function dpDownloadFile(_0x159f7c,_0x477da8){var _0x11a24c=a0_0x369f54;const _0x5d7ee6=localStorage['getItem']('uId');var _0x2fb6a6=JSON[_0x11a24c(0x17b)]({'path':'/'+_0x5d7ee6+'/'+_0x477da8+'/'+_0x159f7c});for(var _0x3ce142=0x0;_0x3ce142<0x2;_0x3ce142++){var _0x3b38ce=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x11a24c(0x195),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x11a24c(0x1b1)),'Dropbox-API-Arg':_0x2fb6a6}});if(_0x3b38ce[_0x11a24c(0x1a7)]!=0xc8){if(_0x3b38ce[_0x11a24c(0x1a7)]==0x191){var _0x3b0ad2=await dpRefreshToken();if(!_0x3b0ad2)throw _0x11a24c(0x1a3);continue;}else throw _0x11a24c(0x170)+_0x3b38ce[_0x11a24c(0x1a7)];}const _0x279083=new File([await _0x3b38ce[_0x11a24c(0x173)]()],_0x159f7c);return console[_0x11a24c(0x198)](_0x11a24c(0x1bb),_0x279083['name']),a0_0x5de072[_0x11a24c(0x17c)](_0x279083,()=>{}),_0x279083;}return![];}document[a0_0x369f54(0x19c)]('DOMContentLoaded',function(){var _0x40e8a0=a0_0x369f54;dropboxRestore[_0x40e8a0(0x19c)]('click',async function(){var _0x4df498=_0x40e8a0;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x485d19=localStorage[_0x4df498(0x16a)]('uId'),_0x9f236=[_0x4df498(0x16f),'save',_0x4df498(0x1cc)];if(!_0x485d19){window[_0x4df498(0x18e)]('Cloud\x20login\x20required!');return;}let _0x4515dc=[];for(const _0x39b2f2 of _0x9f236){let _0x5f4074={'path':'/'+_0x485d19+'/'+_0x39b2f2};for(let _0x41f92c=0x0;_0x41f92c<0x2;_0x41f92c++){let _0x50ae61=await fetch(_0x4df498(0x1cd),{'method':'POST','headers':{'Authorization':_0x4df498(0x185)+localStorage[_0x4df498(0x16a)](_0x4df498(0x1b1)),'Content-Type':'application/json'},'body':JSON[_0x4df498(0x17b)](_0x5f4074)});if(_0x50ae61[_0x4df498(0x1a7)]===0xc8){let _0x3e023a=await _0x50ae61[_0x4df498(0x1a6)](),_0x3fb1e5=_0x3e023a[_0x4df498(0x17d)][_0x4df498(0x16d)](_0x2fbdd5=>_0x2fbdd5[_0x4df498(0x1c5)]===_0x4df498(0x17e));_0x3fb1e5[_0x4df498(0x17f)]>0x0&&_0x4515dc[_0x4df498(0x18f)](..._0x3fb1e5[_0x4df498(0x1ad)](_0x599a2b=>({'name':_0x599a2b['name'],'folder':_0x39b2f2})));break;}else{if(_0x50ae61[_0x4df498(0x1a7)]===0x191){let _0x37654f=await dpRefreshToken();if(!_0x37654f)throw _0x4df498(0x1a3);}else{console['error'](_0x4df498(0x190)+_0x39b2f2+_0x4df498(0x196)+_0x50ae61[_0x4df498(0x1a7)]);break;}}}}if(_0x4515dc[_0x4df498(0x17f)]>0x0){const _0x1250c2=_0x4df498(0x175)+_0x4515dc[_0x4df498(0x17f)]+_0x4df498(0x16e);if(window[_0x4df498(0x16c)](_0x1250c2))for(const _0x1b0aef of _0x4515dc){await lockNoti(_0x4df498(0x1b4),_0x1b0aef['name'],0xbb8),await dpDownloadFile(_0x1b0aef[_0x4df498(0x189)],_0x1b0aef[_0x4df498(0x176)]);}else console[_0x4df498(0x198)]('Restore\x20canceled\x20by\x20user.');}else console[_0x4df498(0x198)](_0x4df498(0x182));}),dropboxBackup['addEventListener'](_0x40e8a0(0x171),async function(){var _0x4d5eb0=_0x40e8a0;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x7ce58a=localStorage[_0x4d5eb0(0x16a)](_0x4d5eb0(0x1b7));if(_0x7ce58a===null||_0x7ce58a==='')window[_0x4d5eb0(0x18e)](_0x4d5eb0(0x167));else{const _0x45468d=[_0x4d5eb0(0x16f),'save',_0x4d5eb0(0x1cc)];for(const _0x501f6e of _0x45468d){await dpCreateFolder(_0x501f6e);}let _0xb7d28e=0x0;for(const _0x3a0f21 of _0x45468d){const _0x530c8e=a0_0x5de072[_0x4d5eb0(0x166)](_0x3a0f21+'s');_0xb7d28e+=_0x530c8e[_0x4d5eb0(0x17f)];}if(window[_0x4d5eb0(0x16c)](_0x4d5eb0(0x1a2)+_0xb7d28e+_0x4d5eb0(0x19d)))for(const _0x51e688 of _0x45468d){const _0x1d974d=a0_0x5de072['listFiles'](_0x51e688+'s');for(const _0x331421 of _0x1d974d){const _0x1c4f98=await a0_0x5de072[_0x4d5eb0(0x1c6)](_0x4d5eb0(0x1b5)+_0x51e688+'s/'+_0x331421);try{await lockNoti(_0x4d5eb0(0x1be),_0x331421,0xbb8),await dpUploadFile(_0x331421,_0x1c4f98,_0x51e688);}catch(_0x3375bd){console['error'](_0x4d5eb0(0x1ce)+_0x331421+':',_0x3375bd);}}}else console[_0x4d5eb0(0x198)](_0x4d5eb0(0x1b9));}}),dropboxCloud[_0x40e8a0(0x19c)](_0x40e8a0(0x171),function(){var _0xec6ce7=_0x40e8a0;const _0x483305=localStorage[_0xec6ce7(0x16a)](_0xec6ce7(0x1b7));_0x483305===null||_0x483305===''?authorizeWithDropbox():window[_0xec6ce7(0x16c)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0xec6ce7(0x199)](_0xec6ce7(0x1b7),''),dropboxRestore[_0xec6ce7(0x1ba)][_0xec6ce7(0x1a0)]('active'),dropboxBackup[_0xec6ce7(0x1ba)][_0xec6ce7(0x1a0)](_0xec6ce7(0x1c3)),dropboxCloud['classList'][_0xec6ce7(0x1a0)](_0xec6ce7(0x1c3)));}),handleDropboxCallback();});