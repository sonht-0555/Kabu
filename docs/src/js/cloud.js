var a0_0x14102d=a0_0x59a5;(function(_0x2dd120,_0x109c5f){var _0xfb4a2f=a0_0x59a5,_0x489fce=_0x2dd120();while(!![]){try{var _0x4995c1=-parseInt(_0xfb4a2f(0x136))/0x1+parseInt(_0xfb4a2f(0x15a))/0x2+parseInt(_0xfb4a2f(0x150))/0x3*(-parseInt(_0xfb4a2f(0x147))/0x4)+parseInt(_0xfb4a2f(0x13f))/0x5+parseInt(_0xfb4a2f(0x133))/0x6+parseInt(_0xfb4a2f(0x132))/0x7*(-parseInt(_0xfb4a2f(0x17d))/0x8)+parseInt(_0xfb4a2f(0x16b))/0x9;if(_0x4995c1===_0x109c5f)break;else _0x489fce['push'](_0x489fce['shift']());}catch(_0x231282){_0x489fce['push'](_0x489fce['shift']());}}}(a0_0x4179,0xe1abb));function a0_0x59a5(_0x3f8165,_0x420d28){var _0x417977=a0_0x4179();return a0_0x59a5=function(_0x59a5dc,_0x35b574){_0x59a5dc=_0x59a5dc-0x12a;var _0x440569=_0x417977[_0x59a5dc];return _0x440569;},a0_0x59a5(_0x3f8165,_0x420d28);}import*as a0_0x3bb031 from'./main.js';function a0_0x4179(){var _0x3d442e=['alert','log','&redirect_uri=','Authorization\x20Code:','send','92VuCnSi','setItem','/data/','uploadFileInCloud','remove','onload','Kabu\x20storage\x20↦\x20Cloud\x20◆','file','https://content.dropboxapi.com/2/files/upload','41991UxtaIH','search','code=','&grant_type=','Content-Type','confirm','https://api.dropboxapi.com/oauth2/token','status','addEventListener','Do\x20you\x20want\x20to\x20logout?','382120KyBXbL','filter','error','offline','&token_access_type=','POST','Error\x20while\x20refreshing\x20token:','code',',\x20status:\x20','map','click','refreshToken','name','open','Do\x20you\x20want\x20to\x20restore\x20','getItem','https://api.dropbox.com/oauth2/token','20396295fNaVDg','Restore\x20canceled\x20by\x20user.','\x20files\x20in\x20Kabu?','Download\x20failed\x20for\x20','Restoring...','href','https://api.dropboxapi.com/2/files/list_folder','json','length','Wait\x20a\x20little\x20bit...','Do\x20not\x20receive\x20authorization','uId','No\x20refresh\x20token','Folder\x20created','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Unable\x20to\x20refresh\x20token','listFiles','blob','32ODPcqN','.tag','\x20files\x20from\x20Cloud?','&client_secret=','nwb3dnfh09rhs31','Refreshing\x20token...','Bearer\x20','https://content.dropboxapi.com/2/files/download','https://api.dropboxapi.com/2/files/create_folder_v2','authorization_code','exec','push','Cloud\x20↦\x20Kabu\x20storage\x20◆','Backing\x20up...','setRequestHeader','application/json','Cloud\x20login\x20required!','downloadFileInCloud','refresh_token','location','stringify','knh3uz2mx2hp2eu','Folder\x20already\x20exists','accessToken','overwrite','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','save','3126599AwaiOn','2507778kmsKVx','classList','error_description','56071JnQfhe','[\x5c?&#]','screenshot','DOMContentLoaded','=([^&#]*)','split','state','application/x-www-form-urlencoded','active','1068495yxywZS','replace','access_token'];a0_0x4179=function(){return _0x3d442e;};return a0_0x4179();}import{localStorageFile}from'./storage.js';var clientId=a0_0x14102d(0x12c),clientSecret=a0_0x14102d(0x181);function authorizeWithDropbox(){var _0x55036c=a0_0x14102d,_0x3f7d8a=window['location'][_0x55036c(0x170)][_0x55036c(0x13b)]('?')[0x0],_0x14508c=_0x55036c(0x161),_0x5e2e30=_0x55036c(0x15d),_0xb118de='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x14508c+_0x55036c(0x15e)+_0x5e2e30+_0x55036c(0x144)+encodeURIComponent(_0x3f7d8a);window['location'][_0x55036c(0x170)]=_0xb118de;}function handleDropboxCallback(){var _0x102b6f=a0_0x14102d,_0x4cf9b9=getUrlParameter(_0x102b6f(0x161));_0x4cf9b9?(getAccessToken(_0x4cf9b9),console[_0x102b6f(0x143)](_0x102b6f(0x145),_0x4cf9b9)):console[_0x102b6f(0x143)](_0x102b6f(0x175));}function getUrlParameter(_0x2216b7){var _0x5b679d=a0_0x14102d;_0x2216b7=_0x2216b7[_0x5b679d(0x140)](/[\[]/,'\x5c[')[_0x5b679d(0x140)](/[\]]/,'\x5c]');var _0x15f16d=new RegExp(_0x5b679d(0x137)+_0x2216b7+_0x5b679d(0x13a)),_0x5d7db4=_0x15f16d[_0x5b679d(0x187)](location[_0x5b679d(0x151)]);return _0x5d7db4===null?'':decodeURIComponent(_0x5d7db4[0x1][_0x5b679d(0x140)](/\+/g,'\x20'));}function getAccessToken(_0x2b7201){var _0x443952=a0_0x14102d,_0x57cde6=_0x443952(0x186),_0x287776=window[_0x443952(0x12a)][_0x443952(0x170)][_0x443952(0x13b)]('?')[0x0],_0x3d9a52=new XMLHttpRequest();_0x3d9a52[_0x443952(0x167)](_0x443952(0x15f),_0x443952(0x16a)),_0x3d9a52[_0x443952(0x18b)](_0x443952(0x154),'application/x-www-form-urlencoded'),_0x3d9a52[_0x443952(0x14c)]=function(){var _0x4c42d6=_0x443952;if(_0x3d9a52['status']===0xc8){var _0x321896=JSON['parse'](_0x3d9a52['responseText']),_0x2ffeea=_0x321896[_0x4c42d6(0x141)],_0xf9c928=_0x321896[_0x4c42d6(0x18f)],_0x2f0f0b=_0x321896['uid'];localStorage['setItem']('accessToken',_0x2ffeea),localStorage['setItem'](_0x4c42d6(0x165),_0xf9c928),localStorage[_0x4c42d6(0x148)]('uId',_0x2f0f0b);}else console['log'](_0x4c42d6(0x179));},_0x3d9a52[_0x443952(0x146)](_0x443952(0x152)+_0x2b7201+_0x443952(0x153)+_0x57cde6+'&client_id='+clientId+_0x443952(0x180)+clientSecret+_0x443952(0x144)+encodeURIComponent(_0x287776));}export async function dpCreateFolder(_0x296aa7){var _0x1bc71e=a0_0x14102d;const _0x19d69d=localStorage[_0x1bc71e(0x169)](_0x1bc71e(0x176));let _0x4ab810=localStorage['getItem']('accessToken');const _0x3f44c3='/'+_0x19d69d+'/'+_0x296aa7,_0x403d38=JSON[_0x1bc71e(0x12b)]({'path':_0x3f44c3,'autorename':![]});for(let _0x33d320=0x0;_0x33d320<0x2;_0x33d320++){try{const _0x357ea5=await fetch(_0x1bc71e(0x185),{'method':_0x1bc71e(0x15f),'headers':{'Authorization':'Bearer\x20'+_0x4ab810,'Content-Type':'application/json'},'body':_0x403d38});if(_0x357ea5[_0x1bc71e(0x157)]===0x191){const _0x10f958=await dpRefreshToken();if(!_0x10f958)throw new Error(_0x1bc71e(0x17a));_0x4ab810=localStorage[_0x1bc71e(0x169)](_0x1bc71e(0x12e));continue;}if(_0x357ea5[_0x1bc71e(0x157)]===0x199)return{'message':_0x1bc71e(0x12d),'path':_0x296aa7};if(!_0x357ea5['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x296aa7);const _0x502c1a=await _0x357ea5[_0x1bc71e(0x172)]();return await lockNoti(_0x1bc71e(0x178),'',0xbb8),_0x502c1a;}catch(_0x501e2e){if(_0x33d320===0x1)throw _0x501e2e;}}return![];}export async function dpRefreshToken(){var _0x492ddb=a0_0x14102d;if(!localStorage['getItem']('refreshToken'))throw _0x492ddb(0x177);try{const _0x46615e=await fetch(_0x492ddb(0x156),{'method':_0x492ddb(0x15f),'headers':{'Content-Type':_0x492ddb(0x13d)},'body':'refresh_token='+localStorage[_0x492ddb(0x169)](_0x492ddb(0x165))+_0x492ddb(0x130)}),_0x43f038=await _0x46615e[_0x492ddb(0x172)]();if(!_0x43f038[_0x492ddb(0x15c)])return localStorage[_0x492ddb(0x148)]('accessToken',_0x43f038[_0x492ddb(0x141)]),await lockNoti(_0x492ddb(0x182),'',0xbb8),await delay(0x3e8),!![];else alert(_0x43f038[_0x492ddb(0x135)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x379d56){console[_0x492ddb(0x15c)](_0x492ddb(0x160),_0x379d56);}return![];}export async function dpUploadFile(_0x1819bb,_0x1b6956,_0x21a910){var _0x12144e=a0_0x14102d;const _0x260610=localStorage['getItem'](_0x12144e(0x176));var _0x48f4ad=JSON['stringify']({'autorename':!![],'mode':_0x12144e(0x12f),'mute':!![],'strict_conflict':![],'path':'/'+_0x260610+'/'+_0x21a910+'/'+_0x1819bb}),_0x1e83c4=new Blob([_0x1b6956],{'type':'application/octet-stream'});for(var _0x18de28=0x0;_0x18de28<0x2;_0x18de28++){var _0x5e84ab=await fetch(_0x12144e(0x14f),{'method':_0x12144e(0x15f),'headers':{'Authorization':_0x12144e(0x183)+localStorage[_0x12144e(0x169)](_0x12144e(0x12e)),'Dropbox-API-Arg':_0x48f4ad,'Content-Type':'application/octet-stream'},'body':_0x1e83c4});if(_0x5e84ab[_0x12144e(0x157)]!=0xc8){if(_0x5e84ab[_0x12144e(0x157)]==0x191){var _0x2cd1ab=await dpRefreshToken();if(!_0x2cd1ab)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x5e84ab[_0x12144e(0x157)];}else{var _0x260c53=await _0x5e84ab[_0x12144e(0x172)]();return console[_0x12144e(0x143)](_0x12144e(0x14d),_0x1819bb),_0x260c53;}}return![];}export async function dpDownloadFile(_0x2d4d7a,_0x263270){var _0x3df284=a0_0x14102d;const _0x5c4de2=localStorage[_0x3df284(0x169)]('uId');var _0xc72e18=JSON[_0x3df284(0x12b)]({'path':'/'+_0x5c4de2+'/'+_0x263270+'/'+_0x2d4d7a});for(var _0x19cc6c=0x0;_0x19cc6c<0x2;_0x19cc6c++){var _0x45eafb=await fetch(_0x3df284(0x184),{'method':_0x3df284(0x15f),'headers':{'Authorization':_0x3df284(0x183)+localStorage[_0x3df284(0x169)](_0x3df284(0x12e)),'Dropbox-API-Arg':_0xc72e18}});if(_0x45eafb['status']!=0xc8){if(_0x45eafb['status']==0x191){var _0x190c5d=await dpRefreshToken();if(!_0x190c5d)throw _0x3df284(0x17a);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x45eafb[_0x3df284(0x157)];}const _0x458b8f=new File([await _0x45eafb[_0x3df284(0x17c)]()],_0x2d4d7a);return console[_0x3df284(0x143)](_0x3df284(0x189),_0x458b8f[_0x3df284(0x166)]),a0_0x3bb031[_0x3df284(0x14a)](_0x458b8f,()=>{}),_0x458b8f;}return![];}document[a0_0x14102d(0x158)](a0_0x14102d(0x139),function(){var _0x20d1e0=a0_0x14102d;dropboxRestore['addEventListener'](_0x20d1e0(0x164),async function(){var _0x4b0808=_0x20d1e0;await lockNoti(_0x4b0808(0x174),'',0x1388);const _0x1ed98c=localStorage[_0x4b0808(0x169)](_0x4b0808(0x176)),_0x43dbe2=[_0x4b0808(0x13c),_0x4b0808(0x131),_0x4b0808(0x138)];if(!_0x1ed98c){window[_0x4b0808(0x142)](_0x4b0808(0x18d));return;}let _0x48c646=[];for(const _0x2099d2 of _0x43dbe2){let _0x291af1={'path':'/'+_0x1ed98c+'/'+_0x2099d2};for(let _0x5d6063=0x0;_0x5d6063<0x2;_0x5d6063++){let _0x415825=await fetch(_0x4b0808(0x171),{'method':_0x4b0808(0x15f),'headers':{'Authorization':_0x4b0808(0x183)+localStorage[_0x4b0808(0x169)](_0x4b0808(0x12e)),'Content-Type':_0x4b0808(0x18c)},'body':JSON['stringify'](_0x291af1)});if(_0x415825[_0x4b0808(0x157)]===0xc8){let _0x3298c4=await _0x415825[_0x4b0808(0x172)](),_0x21a5aa=_0x3298c4['entries'][_0x4b0808(0x15b)](_0x153275=>_0x153275[_0x4b0808(0x17e)]===_0x4b0808(0x14e));_0x21a5aa['length']>0x0&&_0x48c646[_0x4b0808(0x188)](..._0x21a5aa[_0x4b0808(0x163)](_0x236df7=>({'name':_0x236df7['name'],'folder':_0x2099d2})));break;}else{if(_0x415825['status']===0x191){let _0x53fcd6=await dpRefreshToken();if(!_0x53fcd6)throw _0x4b0808(0x17a);}else{console[_0x4b0808(0x15c)](_0x4b0808(0x16e)+_0x2099d2+_0x4b0808(0x162)+_0x415825[_0x4b0808(0x157)]);break;}}}}if(_0x48c646['length']>0x0){const _0x33c439=_0x4b0808(0x168)+_0x48c646[_0x4b0808(0x173)]+_0x4b0808(0x17f);if(window['confirm'](_0x33c439))for(const _0x1461d6 of _0x48c646){await lockNoti(_0x4b0808(0x16f),_0x1461d6[_0x4b0808(0x166)],0xbb8),await dpDownloadFile(_0x1461d6['name'],_0x1461d6['folder']);}else console[_0x4b0808(0x143)]('Restore\x20canceled\x20by\x20user.');}else console[_0x4b0808(0x143)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x20d1e0(0x164),async function(){var _0x65964a=_0x20d1e0;await lockNoti(_0x65964a(0x174),'',0x1388);const _0x50e809=localStorage[_0x65964a(0x169)](_0x65964a(0x176));if(_0x50e809===null||_0x50e809==='')window[_0x65964a(0x142)](_0x65964a(0x18d));else{const _0x436373=['state',_0x65964a(0x131),_0x65964a(0x138)];for(const _0x14d80e of _0x436373){await dpCreateFolder(_0x14d80e);}let _0x48b39e=0x0;for(const _0x44703b of _0x436373){const _0x9778e9=a0_0x3bb031[_0x65964a(0x17b)](_0x44703b+'s');_0x48b39e+=_0x9778e9[_0x65964a(0x173)];}if(window[_0x65964a(0x155)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x48b39e+_0x65964a(0x16d)))for(const _0xdee35e of _0x436373){const _0x186a22=a0_0x3bb031['listFiles'](_0xdee35e+'s');for(const _0x279c1b of _0x186a22){const _0x58008d=await a0_0x3bb031[_0x65964a(0x18e)](_0x65964a(0x149)+_0xdee35e+'s/'+_0x279c1b);try{await lockNoti(_0x65964a(0x18a),_0x279c1b,0xbb8),await dpUploadFile(_0x279c1b,_0x58008d,_0xdee35e);}catch(_0x30480f){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x279c1b+':',_0x30480f);}}}else console[_0x65964a(0x143)](_0x65964a(0x16c));}}),dropboxCloud[_0x20d1e0(0x158)](_0x20d1e0(0x164),function(){var _0x5eb5b1=_0x20d1e0;const _0x3c782e=localStorage[_0x5eb5b1(0x169)](_0x5eb5b1(0x176));_0x3c782e===null||_0x3c782e===''?authorizeWithDropbox():window[_0x5eb5b1(0x155)](_0x5eb5b1(0x159))&&(localStorage[_0x5eb5b1(0x148)]('uId',''),dropboxRestore[_0x5eb5b1(0x134)]['remove'](_0x5eb5b1(0x13e)),dropboxBackup[_0x5eb5b1(0x134)][_0x5eb5b1(0x14b)]('active'),dropboxCloud[_0x5eb5b1(0x134)]['remove'](_0x5eb5b1(0x13e)));}),handleDropboxCallback();});