var a0_0x29429c=a0_0x552f;function a0_0x552f(_0x5245dc,_0x1702fd){var _0x57f58b=a0_0x57f5();return a0_0x552f=function(_0x552fa9,_0x28de4a){_0x552fa9=_0x552fa9-0x10f;var _0xdc992b=_0x57f58b[_0x552fa9];return _0xdc992b;},a0_0x552f(_0x5245dc,_0x1702fd);}(function(_0x140fd4,_0x313e84){var _0x3ed9e5=a0_0x552f,_0x509df9=_0x140fd4();while(!![]){try{var _0x40a909=parseInt(_0x3ed9e5(0x16e))/0x1*(parseInt(_0x3ed9e5(0x137))/0x2)+-parseInt(_0x3ed9e5(0x123))/0x3*(-parseInt(_0x3ed9e5(0x140))/0x4)+-parseInt(_0x3ed9e5(0x126))/0x5+-parseInt(_0x3ed9e5(0x174))/0x6*(-parseInt(_0x3ed9e5(0x14d))/0x7)+parseInt(_0x3ed9e5(0x158))/0x8*(parseInt(_0x3ed9e5(0x16f))/0x9)+parseInt(_0x3ed9e5(0x168))/0xa+parseInt(_0x3ed9e5(0x14e))/0xb*(-parseInt(_0x3ed9e5(0x146))/0xc);if(_0x40a909===_0x313e84)break;else _0x509df9['push'](_0x509df9['shift']());}catch(_0xc45c4d){_0x509df9['push'](_0x509df9['shift']());}}}(a0_0x57f5,0x47423));import*as a0_0x398bca from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x29429c(0x162);function authorizeWithDropbox(){var _0x2ddd9d=a0_0x29429c,_0x1045dc=window['location'][_0x2ddd9d(0x110)]['split']('?')[0x0],_0x440fda=_0x2ddd9d(0x12e),_0x4ebd50=_0x2ddd9d(0x131),_0x5a6254='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2ddd9d(0x130)+_0x440fda+'&token_access_type='+_0x4ebd50+'&redirect_uri='+encodeURIComponent(_0x1045dc);window['location'][_0x2ddd9d(0x110)]=_0x5a6254;}function handleDropboxCallback(){var _0x36d909=a0_0x29429c,_0xb97a8=getUrlParameter(_0x36d909(0x12e));_0xb97a8?(getAccessToken(_0xb97a8),console[_0x36d909(0x116)](_0x36d909(0x118),_0xb97a8)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x58bd46){var _0xe73831=a0_0x29429c;_0x58bd46=_0x58bd46[_0xe73831(0x15b)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x866677=new RegExp(_0xe73831(0x13b)+_0x58bd46+'=([^&#]*)'),_0x257516=_0x866677[_0xe73831(0x135)](location[_0xe73831(0x120)]);return _0x257516===null?'':decodeURIComponent(_0x257516[0x1][_0xe73831(0x15b)](/\+/g,'\x20'));}function getAccessToken(_0x3090a7){var _0x3d8356=a0_0x29429c,_0x4b66c5='authorization_code',_0x5e2c5f=window['location'][_0x3d8356(0x110)]['split']('?')[0x0],_0x3df6a9=new XMLHttpRequest();_0x3df6a9[_0x3d8356(0x145)](_0x3d8356(0x16c),_0x3d8356(0x114)),_0x3df6a9[_0x3d8356(0x12f)](_0x3d8356(0x13d),_0x3d8356(0x15f)),_0x3df6a9[_0x3d8356(0x170)]=function(){var _0x590300=_0x3d8356;if(_0x3df6a9[_0x590300(0x112)]===0xc8){var _0x48a092=JSON[_0x590300(0x12a)](_0x3df6a9[_0x590300(0x151)]),_0x3790f3=_0x48a092[_0x590300(0x125)],_0x44fd3d=_0x48a092['refresh_token'],_0x327344=_0x48a092[_0x590300(0x15d)];localStorage['setItem'](_0x590300(0x111),_0x3790f3),localStorage[_0x590300(0x165)](_0x590300(0x13e),_0x44fd3d),localStorage[_0x590300(0x165)](_0x590300(0x161),_0x327344);}else console[_0x590300(0x116)](_0x590300(0x14c));},_0x3df6a9[_0x3d8356(0x132)](_0x3d8356(0x127)+_0x3090a7+_0x3d8356(0x147)+_0x4b66c5+_0x3d8356(0x156)+clientId+_0x3d8356(0x15a)+clientSecret+_0x3d8356(0x14a)+encodeURIComponent(_0x5e2c5f));}export async function dpCreateFolder(_0x2db41c){var _0x57bb47=a0_0x29429c;const _0x259f42=localStorage[_0x57bb47(0x122)](_0x57bb47(0x161));let _0x496df1=localStorage[_0x57bb47(0x122)](_0x57bb47(0x111));const _0x297595='/'+_0x259f42+'/'+_0x2db41c,_0x124668=JSON[_0x57bb47(0x16a)]({'path':_0x297595,'autorename':![]});for(let _0x524ecc=0x0;_0x524ecc<0x2;_0x524ecc++){try{const _0x219e22=await fetch(_0x57bb47(0x160),{'method':_0x57bb47(0x16c),'headers':{'Authorization':_0x57bb47(0x15e)+_0x496df1,'Content-Type':_0x57bb47(0x11f)},'body':_0x124668});if(_0x219e22[_0x57bb47(0x112)]===0x191){const _0x106da3=await dpRefreshToken();if(!_0x106da3)throw new Error(_0x57bb47(0x129));_0x496df1=localStorage[_0x57bb47(0x122)]('accessToken');continue;}if(_0x219e22['status']===0x199)return{'message':_0x57bb47(0x11d),'path':_0x2db41c};if(!_0x219e22['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x2db41c);const _0x154377=await _0x219e22['json']();return await lockNoti(_0x57bb47(0x134),'',0xbb8),_0x154377;}catch(_0x4f7108){if(_0x524ecc===0x1)throw _0x4f7108;}}return![];}export async function dpRefreshToken(){var _0x3e1f0d=a0_0x29429c;if(!localStorage['getItem']('refreshToken'))throw _0x3e1f0d(0x15c);try{const _0x21b59e=await fetch(_0x3e1f0d(0x113),{'method':'POST','headers':{'Content-Type':_0x3e1f0d(0x15f)},'body':_0x3e1f0d(0x173)+localStorage[_0x3e1f0d(0x122)](_0x3e1f0d(0x13e))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x5efa88=await _0x21b59e[_0x3e1f0d(0x115)]();if(!_0x5efa88[_0x3e1f0d(0x121)])return localStorage[_0x3e1f0d(0x165)]('accessToken',_0x5efa88['access_token']),await lockNoti(_0x3e1f0d(0x13c),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5efa88['error_description']||_0x3e1f0d(0x149));}catch(_0x4f743a){console['error'](_0x3e1f0d(0x13a),_0x4f743a);}return![];}export async function dpUploadFile(_0x2d5e2e,_0x31be2a,_0x2c940e){var _0x36f722=a0_0x29429c;const _0x4ac37c=localStorage['getItem'](_0x36f722(0x161));var _0x396552=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x4ac37c+'/'+_0x2c940e+'/'+_0x2d5e2e}),_0x4a56f9=new Blob([_0x31be2a],{'type':_0x36f722(0x148)});for(var _0x3cbdec=0x0;_0x3cbdec<0x2;_0x3cbdec++){var _0x131de9=await fetch(_0x36f722(0x117),{'method':_0x36f722(0x16c),'headers':{'Authorization':_0x36f722(0x15e)+localStorage[_0x36f722(0x122)](_0x36f722(0x111)),'Dropbox-API-Arg':_0x396552,'Content-Type':'application/octet-stream'},'body':_0x4a56f9});if(_0x131de9['status']!=0xc8){if(_0x131de9['status']==0x191){var _0x46fc01=await dpRefreshToken();if(!_0x46fc01)throw _0x36f722(0x129);continue;}else throw _0x36f722(0x11e)+_0x131de9[_0x36f722(0x112)];}else{var _0x41f864=await _0x131de9[_0x36f722(0x115)]();return console[_0x36f722(0x116)](_0x36f722(0x124),_0x2d5e2e),_0x41f864;}}return![];}function a0_0x57f5(){var _0x2cc98c=['push','toUpperCase','Failed\x20to\x20upload\x20file\x20','open','806172EyAFcL','&grant_type=','application/octet-stream','Failed\x20to\x20refresh\x20Dropbox\x20token.','&redirect_uri=','charAt','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','7DiBxqN','121TMEswL','name','Do\x20you\x20want\x20to\x20backup\x20','responseText','folder','map','Cloud\x20login\x20required!','remove','&client_id=','\x20files\x20in\x20Kabu?','7024EzcjUH','https://api.dropboxapi.com/2/files/list_folder','&client_secret=','replace','No\x20refresh\x20token','uid','Bearer\x20','application/x-www-form-urlencoded','https://api.dropboxapi.com/2/files/create_folder_v2','uId','nwb3dnfh09rhs31','click','list','setItem','screenshot','alert','1897310sLZUME','Do\x20you\x20want\x20to\x20restore\x20','stringify','confirm','POST','Restore\x20canceled\x20by\x20user.','169641rztqHk','90fuacWv','onload','save','/data/','refresh_token=','1052292wITRcV','addEventListener','href','accessToken','status','https://api.dropboxapi.com/oauth2/token','https://api.dropbox.com/oauth2/token','json','log','https://content.dropboxapi.com/2/files/upload','Authorization\x20Code:',',\x20status:\x20','length','downloadFileInCloud','file','Folder\x20already\x20exists','Upload\x20failed,\x20unknown\x20http\x20status:\x20','application/json','search','error','getItem','1266882xhNuZf','Kabu\x20storage\x20↦\x20Cloud\x20◆','access_token','1371220qTYruU','code=','Backing\x20up...','Unable\x20to\x20refresh\x20token','parse','active','Download\x20failed,\x20unknown\x20http\x20status:','Download\x20failed\x20for\x20','code','setRequestHeader','&response_type=','offline','send','No\x20files\x20found\x20to\x20restore.','Folder\x20created','exec','entries','6rKOluE','Cloud\x20↦\x20Kabu\x20storage\x20◆','DOMContentLoaded','Error\x20while\x20refreshing\x20token:','[\x5c?&#]','Refreshing\x20token...','Content-Type','refreshToken','classList','4fjzfvk','slice'];a0_0x57f5=function(){return _0x2cc98c;};return a0_0x57f5();}export async function dpDownloadFile(_0x58b874,_0x55032b){var _0x1c982d=a0_0x29429c;const _0x2ba07a=localStorage[_0x1c982d(0x122)](_0x1c982d(0x161));var _0x1d67fc=JSON[_0x1c982d(0x16a)]({'path':'/'+_0x2ba07a+'/'+_0x55032b+'/'+_0x58b874});for(var _0x2e0abf=0x0;_0x2e0abf<0x2;_0x2e0abf++){var _0x362fef=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x1c982d(0x15e)+localStorage['getItem'](_0x1c982d(0x111)),'Dropbox-API-Arg':_0x1d67fc}});if(_0x362fef[_0x1c982d(0x112)]!=0xc8){if(_0x362fef['status']==0x191){var _0x17e2c4=await dpRefreshToken();if(!_0x17e2c4)throw _0x1c982d(0x129);continue;}else throw _0x1c982d(0x12c)+_0x362fef[_0x1c982d(0x112)];}const _0x24a585=new File([await _0x362fef['blob']()],_0x58b874);return console[_0x1c982d(0x116)](_0x1c982d(0x138),_0x24a585[_0x1c982d(0x14f)]),a0_0x398bca['uploadFileInCloud'](_0x24a585,()=>{localStorageFile(),Module['FSSync']();}),_0x24a585;}return![];}document['addEventListener'](a0_0x29429c(0x139),function(){var _0x402bfd=a0_0x29429c;dropboxRestore[_0x402bfd(0x10f)]('click',async function(){var _0x5e5426=_0x402bfd;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x5f33e5=localStorage[_0x5e5426(0x122)](_0x5e5426(0x161)),_0x575db3=['state',_0x5e5426(0x171),_0x5e5426(0x166)];if(!_0x5f33e5){window[_0x5e5426(0x167)](_0x5e5426(0x154));return;}let _0x1ec5e4=[];for(const _0x4c03cf of _0x575db3){let _0x4eb218={'path':'/'+_0x5f33e5+'/'+_0x4c03cf};for(let _0x20063e=0x0;_0x20063e<0x2;_0x20063e++){let _0x4fa1a1=await fetch(_0x5e5426(0x159),{'method':_0x5e5426(0x16c),'headers':{'Authorization':_0x5e5426(0x15e)+localStorage[_0x5e5426(0x122)](_0x5e5426(0x111)),'Content-Type':_0x5e5426(0x11f)},'body':JSON[_0x5e5426(0x16a)](_0x4eb218)});if(_0x4fa1a1['status']===0xc8){let _0x353d8c=await _0x4fa1a1['json'](),_0x12b91c=_0x353d8c[_0x5e5426(0x136)]['filter'](_0x242c18=>_0x242c18['.tag']===_0x5e5426(0x11c));_0x12b91c[_0x5e5426(0x11a)]>0x0&&_0x1ec5e4[_0x5e5426(0x142)](..._0x12b91c[_0x5e5426(0x153)](_0x52fadd=>({'name':_0x52fadd[_0x5e5426(0x14f)],'folder':_0x4c03cf})));break;}else{if(_0x4fa1a1[_0x5e5426(0x112)]===0x191){let _0x525ec3=await dpRefreshToken();if(!_0x525ec3)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x5e5426(0x12d)+_0x4c03cf+_0x5e5426(0x119)+_0x4fa1a1[_0x5e5426(0x112)]);break;}}}}if(_0x1ec5e4[_0x5e5426(0x11a)]>0x0){const _0x3de283=_0x5e5426(0x169)+_0x1ec5e4[_0x5e5426(0x11a)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x3de283))for(const _0x15f436 of _0x1ec5e4){await lockNoti('Restoring...',_0x15f436['name'],0xbb8),await dpDownloadFile(_0x15f436[_0x5e5426(0x14f)],_0x15f436[_0x5e5426(0x152)]);}else console[_0x5e5426(0x116)](_0x5e5426(0x16d));}else console['log'](_0x5e5426(0x133));}),dropboxBackup[_0x402bfd(0x10f)](_0x402bfd(0x163),async function(){var _0x2aa413=_0x402bfd;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x125c41=localStorage['getItem'](_0x2aa413(0x161));if(_0x125c41===null||_0x125c41==='')window['alert'](_0x2aa413(0x154));else{const _0x31ba3e=['state','save',_0x2aa413(0x166)];for(const _0xc98d16 of _0x31ba3e){await dpCreateFolder(_0xc98d16);}let _0x295d5e=0x0;for(const _0x2fe1b5 of _0x31ba3e){const _0x107be8=a0_0x398bca[_0x2aa413(0x164)+(_0x2fe1b5[_0x2aa413(0x14b)](0x0)[_0x2aa413(0x143)]()+_0x2fe1b5[_0x2aa413(0x141)](0x1))]();_0x295d5e+=_0x107be8[_0x2aa413(0x11a)];}if(window[_0x2aa413(0x16b)](_0x2aa413(0x150)+_0x295d5e+_0x2aa413(0x157)))for(const _0x5c386a of _0x31ba3e){const _0x113761=a0_0x398bca['list'+(_0x5c386a[_0x2aa413(0x14b)](0x0)[_0x2aa413(0x143)]()+_0x5c386a[_0x2aa413(0x141)](0x1))]();for(const _0x3c2185 of _0x113761){const _0x614c76=await a0_0x398bca[_0x2aa413(0x11b)](_0x2aa413(0x172)+_0x5c386a+'s/'+_0x3c2185);try{await lockNoti(_0x2aa413(0x128),_0x3c2185,0xbb8),await dpUploadFile(_0x3c2185,_0x614c76,_0x5c386a);}catch(_0x2b491c){console[_0x2aa413(0x121)](_0x2aa413(0x144)+_0x3c2185+':',_0x2b491c);}}}else console['log'](_0x2aa413(0x16d));}}),dropboxCloud[_0x402bfd(0x10f)](_0x402bfd(0x163),function(){var _0xf7f6cd=_0x402bfd;const _0xce45c1=localStorage[_0xf7f6cd(0x122)](_0xf7f6cd(0x161));_0xce45c1===null||_0xce45c1===''?authorizeWithDropbox():window[_0xf7f6cd(0x16b)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0xf7f6cd(0x165)]('uId',''),dropboxRestore[_0xf7f6cd(0x13f)][_0xf7f6cd(0x155)]('active'),dropboxBackup[_0xf7f6cd(0x13f)][_0xf7f6cd(0x155)]('active'),dropboxCloud[_0xf7f6cd(0x13f)][_0xf7f6cd(0x155)](_0xf7f6cd(0x12b)));}),handleDropboxCallback();});