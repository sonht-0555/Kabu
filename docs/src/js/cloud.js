var a0_0x670d23=a0_0x2d5e;(function(_0x1b5109,_0x5452fb){var _0x51504c=a0_0x2d5e,_0x38d359=_0x1b5109();while(!![]){try{var _0x5767b8=parseInt(_0x51504c(0x213))/0x1*(parseInt(_0x51504c(0x1c6))/0x2)+-parseInt(_0x51504c(0x20c))/0x3+-parseInt(_0x51504c(0x1d5))/0x4*(parseInt(_0x51504c(0x215))/0x5)+parseInt(_0x51504c(0x1df))/0x6+-parseInt(_0x51504c(0x1ce))/0x7*(parseInt(_0x51504c(0x1e3))/0x8)+parseInt(_0x51504c(0x1e2))/0x9*(parseInt(_0x51504c(0x1cf))/0xa)+parseInt(_0x51504c(0x1e0))/0xb;if(_0x5767b8===_0x5452fb)break;else _0x38d359['push'](_0x38d359['shift']());}catch(_0x57041a){_0x38d359['push'](_0x38d359['shift']());}}}(a0_0x3be9,0xda353));function a0_0x3be9(){var _0x51bf5b=['onload','push','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','accessToken','href','search','2zqNWJh','authorization_code','9815ErcRXu','length','confirm','https://api.dropboxapi.com/2/files/create_folder_v2','Download\x20failed\x20for\x20','code','parse','list','name','stringify','save','\x20files\x20from\x20Cloud?','Error\x20creating\x20folder\x20','Restore\x20canceled\x20by\x20user.','https://content.dropboxapi.com/2/files/download','log','https://www.dropbox.com/oauth2/authorize?client_id=','/data/','blob','https://api.dropboxapi.com/oauth2/token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20backup\x20','Do\x20you\x20want\x20to\x20logout?','status','json','.tag','application/json','Unable\x20to\x20refresh\x20token','error_description','location','addEventListener','498164bACXKj','&redirect_uri=','application/x-www-form-urlencoded','Wait\x20a\x20little\x20bit...','No\x20files\x20found\x20to\x20restore.','setRequestHeader','https://api.dropbox.com/oauth2/token','refresh_token=','56UhNBIH','30XhMiSV','Failed\x20to\x20upload\x20file\x20','remove','classList','offline','slice','2216xvvgma','&client_id=','Cloud\x20login\x20required!','Do\x20you\x20want\x20to\x20restore\x20','error','nwb3dnfh09rhs31','application/octet-stream','uId','https://api.dropboxapi.com/2/files/list_folder','Backing\x20up...','4081140KtQvPO','31402646NajQAi','Do\x20not\x20receive\x20authorization','3319569KqVOYM','1777512DnhZAo','Bearer\x20','refreshToken','&client_secret=','Failed\x20to\x20refresh\x20Dropbox\x20token.','uid','code=','screenshot','Kabu\x20storage\x20↦\x20Cloud\x20◆','toUpperCase','access_token','Restoring...','charAt','=([^&#]*)','&grant_type=','Folder\x20already\x20exists','map','knh3uz2mx2hp2eu','\x20files\x20in\x20Kabu?','split','&token_access_type=','replace','responseText','send','Cloud\x20↦\x20Kabu\x20storage\x20◆',',\x20status:\x20','click','active','https://content.dropboxapi.com/2/files/upload','refresh_token','getItem','POST','overwrite','Authorization\x20Code:','alert','Refreshing\x20token...','[\x5c?&#]','entries','Error\x20while\x20refreshing\x20token:','setItem','Download\x20failed,\x20unknown\x20http\x20status:','4142610XAoOiB'];a0_0x3be9=function(){return _0x51bf5b;};return a0_0x3be9();}import*as a0_0x1298e2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x670d23(0x1f4),clientSecret=a0_0x670d23(0x1da);function authorizeWithDropbox(){var _0x1ed37a=a0_0x670d23,_0xa60a89=window[_0x1ed37a(0x1c4)]['href'][_0x1ed37a(0x1f6)]('?')[0x0],_0x51236b=_0x1ed37a(0x21a),_0x21ec8b=_0x1ed37a(0x1d3),_0x4a443d=_0x1ed37a(0x225)+clientId+'&response_type='+_0x51236b+_0x1ed37a(0x1f7)+_0x21ec8b+'&redirect_uri='+encodeURIComponent(_0xa60a89);window['location'][_0x1ed37a(0x211)]=_0x4a443d;}function handleDropboxCallback(){var _0x5a2010=a0_0x670d23,_0x51498d=getUrlParameter(_0x5a2010(0x21a));_0x51498d?(getAccessToken(_0x51498d),console['log'](_0x5a2010(0x204),_0x51498d)):console['log'](_0x5a2010(0x1e1));}function getUrlParameter(_0x4765ef){var _0x506173=a0_0x670d23;_0x4765ef=_0x4765ef[_0x506173(0x1f8)](/[\[]/,'\x5c[')[_0x506173(0x1f8)](/[\]]/,'\x5c]');var _0x5de7a6=new RegExp(_0x506173(0x207)+_0x4765ef+_0x506173(0x1f0)),_0x37bd45=_0x5de7a6['exec'](location[_0x506173(0x212)]);return _0x37bd45===null?'':decodeURIComponent(_0x37bd45[0x1][_0x506173(0x1f8)](/\+/g,'\x20'));}function getAccessToken(_0x4856e1){var _0x5defd1=a0_0x670d23,_0x1c1c4d=_0x5defd1(0x214),_0x13cffd=window[_0x5defd1(0x1c4)][_0x5defd1(0x211)][_0x5defd1(0x1f6)]('?')[0x0],_0x206b9e=new XMLHttpRequest();_0x206b9e['open'](_0x5defd1(0x202),_0x5defd1(0x1cc)),_0x206b9e[_0x5defd1(0x1cb)]('Content-Type',_0x5defd1(0x1c8)),_0x206b9e[_0x5defd1(0x20d)]=function(){var _0x21f801=_0x5defd1;if(_0x206b9e[_0x21f801(0x22c)]===0xc8){var _0x2967d6=JSON[_0x21f801(0x21b)](_0x206b9e[_0x21f801(0x1f9)]),_0x217c8e=_0x2967d6[_0x21f801(0x1ed)],_0x55c462=_0x2967d6[_0x21f801(0x200)],_0x66155a=_0x2967d6[_0x21f801(0x1e8)];localStorage[_0x21f801(0x20a)]('accessToken',_0x217c8e),localStorage[_0x21f801(0x20a)](_0x21f801(0x1e5),_0x55c462),localStorage[_0x21f801(0x20a)](_0x21f801(0x1dc),_0x66155a);}else console['log'](_0x21f801(0x20f));},_0x206b9e[_0x5defd1(0x1fa)](_0x5defd1(0x1e9)+_0x4856e1+_0x5defd1(0x1f1)+_0x1c1c4d+_0x5defd1(0x1d6)+clientId+_0x5defd1(0x1e6)+clientSecret+_0x5defd1(0x1c7)+encodeURIComponent(_0x13cffd));}export async function dpCreateFolder(_0x1fa03b){var _0x466652=a0_0x670d23;const _0xa1313=localStorage[_0x466652(0x201)](_0x466652(0x1dc));let _0x3ec3cb=localStorage[_0x466652(0x201)](_0x466652(0x210));const _0x13c121='/'+_0xa1313+'/'+_0x1fa03b,_0x37d5fa=JSON[_0x466652(0x21e)]({'path':_0x13c121,'autorename':![]});for(let _0x58d888=0x0;_0x58d888<0x2;_0x58d888++){try{const _0x490bc3=await fetch(_0x466652(0x218),{'method':_0x466652(0x202),'headers':{'Authorization':_0x466652(0x1e4)+_0x3ec3cb,'Content-Type':_0x466652(0x1c1)},'body':_0x37d5fa});if(_0x490bc3[_0x466652(0x22c)]===0x191){const _0x434f2a=await dpRefreshToken();if(!_0x434f2a)throw new Error(_0x466652(0x1c2));_0x3ec3cb=localStorage[_0x466652(0x201)](_0x466652(0x210));continue;}if(_0x490bc3[_0x466652(0x22c)]===0x199)return{'message':_0x466652(0x1f2),'path':_0x1fa03b};if(!_0x490bc3['ok'])throw new Error(_0x466652(0x221)+_0x1fa03b);const _0x59f245=await _0x490bc3[_0x466652(0x1bf)]();return await lockNoti('Folder\x20created','',0xbb8),_0x59f245;}catch(_0x585250){if(_0x58d888===0x1)throw _0x585250;}}return![];}export async function dpRefreshToken(){var _0x53c918=a0_0x670d23;if(!localStorage['getItem']('refreshToken'))throw'No\x20refresh\x20token';try{const _0x1bbe30=await fetch(_0x53c918(0x228),{'method':'POST','headers':{'Content-Type':_0x53c918(0x1c8)},'body':_0x53c918(0x1cd)+localStorage['getItem']('refreshToken')+_0x53c918(0x229)}),_0x1aa511=await _0x1bbe30['json']();if(!_0x1aa511[_0x53c918(0x1d9)])return localStorage[_0x53c918(0x20a)](_0x53c918(0x210),_0x1aa511['access_token']),await lockNoti(_0x53c918(0x206),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1aa511[_0x53c918(0x1c3)]||_0x53c918(0x1e7));}catch(_0x3332b4){console['error'](_0x53c918(0x209),_0x3332b4);}return![];}export async function dpUploadFile(_0x86171a,_0x105882,_0x453c2c){var _0x545784=a0_0x670d23;const _0xb3cbdc=localStorage[_0x545784(0x201)](_0x545784(0x1dc));var _0x2b433f=JSON['stringify']({'autorename':!![],'mode':_0x545784(0x203),'mute':!![],'strict_conflict':![],'path':'/'+_0xb3cbdc+'/'+_0x453c2c+'/'+_0x86171a}),_0x3ee3a3=new Blob([_0x105882],{'type':'application/octet-stream'});for(var _0x2cbd08=0x0;_0x2cbd08<0x2;_0x2cbd08++){var _0x471cea=await fetch(_0x545784(0x1ff),{'method':_0x545784(0x202),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x545784(0x201)](_0x545784(0x210)),'Dropbox-API-Arg':_0x2b433f,'Content-Type':_0x545784(0x1db)},'body':_0x3ee3a3});if(_0x471cea['status']!=0xc8){if(_0x471cea[_0x545784(0x22c)]==0x191){var _0x33b765=await dpRefreshToken();if(!_0x33b765)throw _0x545784(0x1c2);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x471cea[_0x545784(0x22c)];}else{var _0x2a904d=await _0x471cea[_0x545784(0x1bf)]();return console[_0x545784(0x224)](_0x545784(0x1eb),_0x86171a),_0x2a904d;}}return![];}function a0_0x2d5e(_0x554aff,_0x1fe729){var _0x3be963=a0_0x3be9();return a0_0x2d5e=function(_0x2d5eb5,_0x7e7632){_0x2d5eb5=_0x2d5eb5-0x1bf;var _0x1ef849=_0x3be963[_0x2d5eb5];return _0x1ef849;},a0_0x2d5e(_0x554aff,_0x1fe729);}export async function dpDownloadFile(_0x146d79,_0x3ad381){var _0x1cfb89=a0_0x670d23;const _0x62ce17=localStorage[_0x1cfb89(0x201)](_0x1cfb89(0x1dc));var _0x4c09ad=JSON[_0x1cfb89(0x21e)]({'path':'/'+_0x62ce17+'/'+_0x3ad381+'/'+_0x146d79});for(var _0x163921=0x0;_0x163921<0x2;_0x163921++){var _0x1ae950=await fetch(_0x1cfb89(0x223),{'method':_0x1cfb89(0x202),'headers':{'Authorization':_0x1cfb89(0x1e4)+localStorage[_0x1cfb89(0x201)](_0x1cfb89(0x210)),'Dropbox-API-Arg':_0x4c09ad}});if(_0x1ae950[_0x1cfb89(0x22c)]!=0xc8){if(_0x1ae950[_0x1cfb89(0x22c)]==0x191){var _0x5ca14d=await dpRefreshToken();if(!_0x5ca14d)throw _0x1cfb89(0x1c2);continue;}else throw _0x1cfb89(0x20b)+_0x1ae950['status'];}const _0x2f10b3=new File([await _0x1ae950[_0x1cfb89(0x227)]()],_0x146d79);return console['log'](_0x1cfb89(0x1fb),_0x2f10b3[_0x1cfb89(0x21d)]),a0_0x1298e2['uploadFileInCloud'](_0x2f10b3,()=>{}),_0x2f10b3;}return![];}document[a0_0x670d23(0x1c5)]('DOMContentLoaded',function(){var _0x3ecfe6=a0_0x670d23;dropboxRestore[_0x3ecfe6(0x1c5)](_0x3ecfe6(0x1fd),async function(){var _0x58ba29=_0x3ecfe6;await lockNoti(_0x58ba29(0x1c9),'',0x1388);const _0x5a91c5=localStorage[_0x58ba29(0x201)](_0x58ba29(0x1dc)),_0x477dd3=['state',_0x58ba29(0x21f),_0x58ba29(0x1ea)];if(!_0x5a91c5){window[_0x58ba29(0x205)](_0x58ba29(0x1d7));return;}let _0x2bba1f=[];for(const _0x1d0e22 of _0x477dd3){let _0x4c388d={'path':'/'+_0x5a91c5+'/'+_0x1d0e22};for(let _0x18d34a=0x0;_0x18d34a<0x2;_0x18d34a++){let _0x5f3620=await fetch(_0x58ba29(0x1dd),{'method':_0x58ba29(0x202),'headers':{'Authorization':_0x58ba29(0x1e4)+localStorage[_0x58ba29(0x201)](_0x58ba29(0x210)),'Content-Type':'application/json'},'body':JSON[_0x58ba29(0x21e)](_0x4c388d)});if(_0x5f3620[_0x58ba29(0x22c)]===0xc8){let _0x22e9e6=await _0x5f3620[_0x58ba29(0x1bf)](),_0x1c9527=_0x22e9e6[_0x58ba29(0x208)]['filter'](_0x3b76ef=>_0x3b76ef[_0x58ba29(0x1c0)]==='file');_0x1c9527['length']>0x0&&_0x2bba1f[_0x58ba29(0x20e)](..._0x1c9527[_0x58ba29(0x1f3)](_0x5752ec=>({'name':_0x5752ec[_0x58ba29(0x21d)],'folder':_0x1d0e22})));break;}else{if(_0x5f3620[_0x58ba29(0x22c)]===0x191){let _0x36134d=await dpRefreshToken();if(!_0x36134d)throw _0x58ba29(0x1c2);}else{console['error'](_0x58ba29(0x219)+_0x1d0e22+_0x58ba29(0x1fc)+_0x5f3620[_0x58ba29(0x22c)]);break;}}}}if(_0x2bba1f['length']>0x0){const _0x421dd3=_0x58ba29(0x1d8)+_0x2bba1f['length']+_0x58ba29(0x220);if(window[_0x58ba29(0x217)](_0x421dd3))for(const _0x3f6029 of _0x2bba1f){await lockNoti(_0x58ba29(0x1ee),_0x3f6029[_0x58ba29(0x21d)],0xbb8),await dpDownloadFile(_0x3f6029['name'],_0x3f6029['folder']);}else console[_0x58ba29(0x224)]('Restore\x20canceled\x20by\x20user.');}else console['log'](_0x58ba29(0x1ca));}),dropboxBackup[_0x3ecfe6(0x1c5)](_0x3ecfe6(0x1fd),async function(){var _0x1562cd=_0x3ecfe6;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4df588=localStorage[_0x1562cd(0x201)](_0x1562cd(0x1dc));if(_0x4df588===null||_0x4df588==='')window[_0x1562cd(0x205)](_0x1562cd(0x1d7));else{const _0x1fe4e5=['state',_0x1562cd(0x21f),_0x1562cd(0x1ea)];for(const _0x5ba6db of _0x1fe4e5){await dpCreateFolder(_0x5ba6db);}let _0x323cf3=0x0;for(const _0x1b8310 of _0x1fe4e5){const _0x1428e2=a0_0x1298e2['list'+(_0x1b8310['charAt'](0x0)[_0x1562cd(0x1ec)]()+_0x1b8310[_0x1562cd(0x1d4)](0x1))]();_0x323cf3+=_0x1428e2[_0x1562cd(0x216)];}if(window[_0x1562cd(0x217)](_0x1562cd(0x22a)+_0x323cf3+_0x1562cd(0x1f5)))for(const _0x25b786 of _0x1fe4e5){const _0x19d2db=a0_0x1298e2[_0x1562cd(0x21c)+(_0x25b786[_0x1562cd(0x1ef)](0x0)[_0x1562cd(0x1ec)]()+_0x25b786[_0x1562cd(0x1d4)](0x1))]();for(const _0x15a99e of _0x19d2db){const _0x4ef40a=await a0_0x1298e2['downloadFileInCloud'](_0x1562cd(0x226)+_0x25b786+'s/'+_0x15a99e);try{await lockNoti(_0x1562cd(0x1de),_0x15a99e,0xbb8),await dpUploadFile(_0x15a99e,_0x4ef40a,_0x25b786);}catch(_0x58cd79){console[_0x1562cd(0x1d9)](_0x1562cd(0x1d0)+_0x15a99e+':',_0x58cd79);}}}else console['log'](_0x1562cd(0x222));}}),dropboxCloud[_0x3ecfe6(0x1c5)](_0x3ecfe6(0x1fd),function(){var _0x57023e=_0x3ecfe6;const _0x15b0d1=localStorage['getItem'](_0x57023e(0x1dc));_0x15b0d1===null||_0x15b0d1===''?authorizeWithDropbox():window['confirm'](_0x57023e(0x22b))&&(localStorage['setItem'](_0x57023e(0x1dc),''),dropboxRestore[_0x57023e(0x1d2)]['remove'](_0x57023e(0x1fe)),dropboxBackup[_0x57023e(0x1d2)][_0x57023e(0x1d1)](_0x57023e(0x1fe)),dropboxCloud[_0x57023e(0x1d2)][_0x57023e(0x1d1)]('active'));}),handleDropboxCallback();});