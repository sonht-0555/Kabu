var a0_0x1d5624=a0_0x3857;(function(_0x5591e1,_0x5b59b6){var _0x46f1f3=a0_0x3857,_0x439d1c=_0x5591e1();while(!![]){try{var _0x48b331=parseInt(_0x46f1f3(0x16d))/0x1+-parseInt(_0x46f1f3(0x194))/0x2+parseInt(_0x46f1f3(0x167))/0x3+parseInt(_0x46f1f3(0x190))/0x4*(parseInt(_0x46f1f3(0x18d))/0x5)+-parseInt(_0x46f1f3(0x185))/0x6+-parseInt(_0x46f1f3(0x145))/0x7+parseInt(_0x46f1f3(0x16e))/0x8*(parseInt(_0x46f1f3(0x196))/0x9);if(_0x48b331===_0x5b59b6)break;else _0x439d1c['push'](_0x439d1c['shift']());}catch(_0x81b2b4){_0x439d1c['push'](_0x439d1c['shift']());}}}(a0_0x1d23,0x477b4));function a0_0x3857(_0x12bac8,_0x343afe){var _0x1d2306=a0_0x1d23();return a0_0x3857=function(_0x38572d,_0x2448b6){_0x38572d=_0x38572d-0x13c;var _0x3b5c01=_0x1d2306[_0x38572d];return _0x3b5c01;},a0_0x3857(_0x12bac8,_0x343afe);}import*as a0_0x441aa0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1d5624(0x157),clientSecret=a0_0x1d5624(0x15a);function authorizeWithDropbox(){var _0x261cd9=a0_0x1d5624,_0x4ecea7=window['location'][_0x261cd9(0x13e)][_0x261cd9(0x182)]('?')[0x0],_0x3eac3d=_0x261cd9(0x18c),_0x58d784=_0x261cd9(0x188),_0x3eeb8d=_0x261cd9(0x153)+clientId+_0x261cd9(0x181)+_0x3eac3d+_0x261cd9(0x18b)+_0x58d784+_0x261cd9(0x169)+encodeURIComponent(_0x4ecea7);window['location'][_0x261cd9(0x13e)]=_0x3eeb8d;}function handleDropboxCallback(){var _0x29679f=a0_0x1d5624,_0x22c9b3=getUrlParameter('code');_0x22c9b3?(getAccessToken(_0x22c9b3),console[_0x29679f(0x166)](_0x29679f(0x19a),_0x22c9b3)):console[_0x29679f(0x166)](_0x29679f(0x15c));}function getUrlParameter(_0x235f6a){var _0x1984fc=a0_0x1d5624;_0x235f6a=_0x235f6a[_0x1984fc(0x140)](/[\[]/,'\x5c[')[_0x1984fc(0x140)](/[\]]/,'\x5c]');var _0x5f28d4=new RegExp('[\x5c?&#]'+_0x235f6a+_0x1984fc(0x160)),_0x19cedc=_0x5f28d4[_0x1984fc(0x174)](location[_0x1984fc(0x146)]);return _0x19cedc===null?'':decodeURIComponent(_0x19cedc[0x1][_0x1984fc(0x140)](/\+/g,'\x20'));}function getAccessToken(_0x5397ce){var _0x5f4644=a0_0x1d5624,_0x476761=_0x5f4644(0x192),_0x351150=window[_0x5f4644(0x17a)][_0x5f4644(0x13e)][_0x5f4644(0x182)]('?')[0x0],_0x266792=new XMLHttpRequest();_0x266792[_0x5f4644(0x143)](_0x5f4644(0x198),'https://api.dropbox.com/oauth2/token'),_0x266792[_0x5f4644(0x19f)](_0x5f4644(0x14c),_0x5f4644(0x144)),_0x266792[_0x5f4644(0x149)]=function(){var _0x2595de=_0x5f4644;if(_0x266792[_0x2595de(0x197)]===0xc8){var _0x38d58c=JSON[_0x2595de(0x16a)](_0x266792[_0x2595de(0x199)]),_0x5bbafc=_0x38d58c[_0x2595de(0x17b)],_0x5abca4=_0x38d58c[_0x2595de(0x180)],_0x31286e=_0x38d58c[_0x2595de(0x162)];localStorage[_0x2595de(0x19d)](_0x2595de(0x1a1),_0x5bbafc),localStorage[_0x2595de(0x19d)](_0x2595de(0x142),_0x5abca4),localStorage[_0x2595de(0x19d)](_0x2595de(0x159),_0x31286e);}else console[_0x2595de(0x166)](_0x2595de(0x177));},_0x266792['send'](_0x5f4644(0x16c)+_0x5397ce+'&grant_type='+_0x476761+_0x5f4644(0x183)+clientId+_0x5f4644(0x17d)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x351150));}export async function dpCreateFolder(_0x2a2d48){var _0x7beb48=a0_0x1d5624;const _0x36b63d=localStorage[_0x7beb48(0x15f)](_0x7beb48(0x159));let _0x9a3a30=localStorage['getItem'](_0x7beb48(0x1a1));const _0x2b10cd='/'+_0x36b63d+'/'+_0x2a2d48,_0x234f2f=JSON['stringify']({'path':_0x2b10cd,'autorename':![]});for(let _0x5cb6bc=0x0;_0x5cb6bc<0x2;_0x5cb6bc++){try{const _0x2e3e6a=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x7beb48(0x198),'headers':{'Authorization':_0x7beb48(0x17e)+_0x9a3a30,'Content-Type':_0x7beb48(0x191)},'body':_0x234f2f});if(_0x2e3e6a[_0x7beb48(0x197)]===0x191){const _0x2c7340=await dpRefreshToken();if(!_0x2c7340)throw new Error('Unable\x20to\x20refresh\x20token');_0x9a3a30=localStorage[_0x7beb48(0x15f)](_0x7beb48(0x1a1));continue;}if(_0x2e3e6a[_0x7beb48(0x197)]===0x199)return{'message':_0x7beb48(0x16f),'path':_0x2a2d48};if(!_0x2e3e6a['ok'])throw new Error(_0x7beb48(0x150)+_0x2a2d48);const _0x5dc9b5=await _0x2e3e6a['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x5dc9b5;}catch(_0x173d13){if(_0x5cb6bc===0x1)throw _0x173d13;}}return![];}function a0_0x1d23(){var _0x476ae6=['/data/','28kpgwtu','application/json','authorization_code','push','99712SDLtXD','state','9hGoIlQ','status','POST','responseText','Authorization\x20Code:',',\x20status:\x20','https://api.dropboxapi.com/2/files/list_folder','setItem','click','setRequestHeader','json','accessToken','Backing\x20up...','Wait\x20a\x20little\x20bit...','name','href','confirm','replace','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','refreshToken','open','application/x-www-form-urlencoded','3683848WcwIra','search','remove','map','onload','save','uploadFileInCloud','Content-Type','https://content.dropboxapi.com/2/files/download','Restoring...','Do\x20you\x20want\x20to\x20backup\x20','Error\x20creating\x20folder\x20','length','https://api.dropboxapi.com/oauth2/token','https://www.dropbox.com/oauth2/authorize?client_id=','listFiles','DOMContentLoaded','Failed\x20to\x20refresh\x20Dropbox\x20token.','knh3uz2mx2hp2eu','downloadFileInCloud','uId','nwb3dnfh09rhs31','filter','Do\x20not\x20receive\x20authorization','stringify','Restore\x20canceled\x20by\x20user.','getItem','=([^&#]*)','.tag','uid','addEventListener','\x20files\x20in\x20Kabu?','Download\x20failed,\x20unknown\x20http\x20status:','log','56256pzbppr','Do\x20you\x20want\x20to\x20logout?','&redirect_uri=','parse','Error\x20while\x20refreshing\x20token:','code=','408651JTxbRE','1128528RYKTbw','Folder\x20already\x20exists','Do\x20you\x20want\x20to\x20restore\x20','active','Kabu\x20storage\x20↦\x20Cloud\x20◆','screenshot','exec','classList','Unable\x20to\x20refresh\x20token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','error','Cloud\x20login\x20required!','location','access_token','Download\x20failed\x20for\x20','&client_secret=','Bearer\x20','alert','refresh_token','&response_type=','split','&client_id=','application/octet-stream','1153074vSbsJO','entries','Upload\x20failed,\x20unknown\x20http\x20status:\x20','offline','Failed\x20to\x20upload\x20file\x20','No\x20refresh\x20token','&token_access_type=','code','351870AfXAwV','error_description'];a0_0x1d23=function(){return _0x476ae6;};return a0_0x1d23();}export async function dpRefreshToken(){var _0x47a005=a0_0x1d5624;if(!localStorage[_0x47a005(0x15f)](_0x47a005(0x142)))throw _0x47a005(0x18a);try{const _0x433da1=await fetch(_0x47a005(0x152),{'method':'POST','headers':{'Content-Type':_0x47a005(0x144)},'body':'refresh_token='+localStorage['getItem'](_0x47a005(0x142))+_0x47a005(0x141)}),_0x1ad55d=await _0x433da1['json']();if(!_0x1ad55d[_0x47a005(0x178)])return localStorage[_0x47a005(0x19d)](_0x47a005(0x1a1),_0x1ad55d[_0x47a005(0x17b)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x1ad55d[_0x47a005(0x18e)]||_0x47a005(0x156));}catch(_0x31c898){console[_0x47a005(0x178)](_0x47a005(0x16b),_0x31c898);}return![];}export async function dpUploadFile(_0x3115a3,_0xf2c53e,_0x38e714){var _0x53fc6a=a0_0x1d5624;const _0x27a082=localStorage[_0x53fc6a(0x15f)](_0x53fc6a(0x159));var _0x1bc974=JSON[_0x53fc6a(0x15d)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x27a082+'/'+_0x38e714+'/'+_0x3115a3}),_0x487990=new Blob([_0xf2c53e],{'type':'application/octet-stream'});for(var _0x45d84f=0x0;_0x45d84f<0x2;_0x45d84f++){var _0x2522f8=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x53fc6a(0x198),'headers':{'Authorization':_0x53fc6a(0x17e)+localStorage[_0x53fc6a(0x15f)](_0x53fc6a(0x1a1)),'Dropbox-API-Arg':_0x1bc974,'Content-Type':_0x53fc6a(0x184)},'body':_0x487990});if(_0x2522f8[_0x53fc6a(0x197)]!=0xc8){if(_0x2522f8[_0x53fc6a(0x197)]==0x191){var _0x25819f=await dpRefreshToken();if(!_0x25819f)throw _0x53fc6a(0x176);continue;}else throw _0x53fc6a(0x187)+_0x2522f8[_0x53fc6a(0x197)];}else{var _0x4b1517=await _0x2522f8['json']();return console[_0x53fc6a(0x166)](_0x53fc6a(0x172),_0x3115a3),_0x4b1517;}}return![];}export async function dpDownloadFile(_0x5351d3,_0x350100){var _0x4a1119=a0_0x1d5624;const _0x3b2a55=localStorage[_0x4a1119(0x15f)]('uId');var _0x1133c2=JSON[_0x4a1119(0x15d)]({'path':'/'+_0x3b2a55+'/'+_0x350100+'/'+_0x5351d3});for(var _0x1452bf=0x0;_0x1452bf<0x2;_0x1452bf++){var _0x276862=await fetch(_0x4a1119(0x14d),{'method':'POST','headers':{'Authorization':_0x4a1119(0x17e)+localStorage[_0x4a1119(0x15f)](_0x4a1119(0x1a1)),'Dropbox-API-Arg':_0x1133c2}});if(_0x276862[_0x4a1119(0x197)]!=0xc8){if(_0x276862[_0x4a1119(0x197)]==0x191){var _0x49bdea=await dpRefreshToken();if(!_0x49bdea)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4a1119(0x165)+_0x276862[_0x4a1119(0x197)];}const _0x16ef09=new File([await _0x276862['blob']()],_0x5351d3);return console[_0x4a1119(0x166)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x16ef09[_0x4a1119(0x13d)]),a0_0x441aa0[_0x4a1119(0x14b)](_0x16ef09,()=>{}),_0x16ef09;}return![];}document['addEventListener'](a0_0x1d5624(0x155),function(){var _0x222d13=a0_0x1d5624;dropboxRestore[_0x222d13(0x163)](_0x222d13(0x19e),async function(){var _0x264853=_0x222d13;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x162c81=localStorage[_0x264853(0x15f)](_0x264853(0x159)),_0x15478a=['state','save',_0x264853(0x173)];if(!_0x162c81){window[_0x264853(0x17f)](_0x264853(0x179));return;}let _0x5d987b=[];for(const _0x3d9f5d of _0x15478a){let _0x1a8094={'path':'/'+_0x162c81+'/'+_0x3d9f5d};for(let _0x345a10=0x0;_0x345a10<0x2;_0x345a10++){let _0xe948c4=await fetch(_0x264853(0x19c),{'method':_0x264853(0x198),'headers':{'Authorization':_0x264853(0x17e)+localStorage[_0x264853(0x15f)](_0x264853(0x1a1)),'Content-Type':_0x264853(0x191)},'body':JSON[_0x264853(0x15d)](_0x1a8094)});if(_0xe948c4[_0x264853(0x197)]===0xc8){let _0x33fafd=await _0xe948c4[_0x264853(0x1a0)](),_0x1ad538=_0x33fafd[_0x264853(0x186)][_0x264853(0x15b)](_0x3cdd03=>_0x3cdd03[_0x264853(0x161)]==='file');_0x1ad538['length']>0x0&&_0x5d987b[_0x264853(0x193)](..._0x1ad538[_0x264853(0x148)](_0x3a4016=>({'name':_0x3a4016[_0x264853(0x13d)],'folder':_0x3d9f5d})));break;}else{if(_0xe948c4['status']===0x191){let _0xb8d75a=await dpRefreshToken();if(!_0xb8d75a)throw _0x264853(0x176);}else{console[_0x264853(0x178)](_0x264853(0x17c)+_0x3d9f5d+_0x264853(0x19b)+_0xe948c4['status']);break;}}}}if(_0x5d987b['length']>0x0){const _0x3aa0f7=_0x264853(0x170)+_0x5d987b[_0x264853(0x151)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x3aa0f7))for(const _0x5985b6 of _0x5d987b){await lockNoti(_0x264853(0x14e),_0x5985b6[_0x264853(0x13d)],0xbb8),await dpDownloadFile(_0x5985b6[_0x264853(0x13d)],_0x5985b6['folder']);}else console[_0x264853(0x166)]('Restore\x20canceled\x20by\x20user.');}else console[_0x264853(0x166)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x222d13(0x19e),async function(){var _0x53ec8c=_0x222d13;await lockNoti(_0x53ec8c(0x13c),'',0x1388);const _0x2e50b2=localStorage[_0x53ec8c(0x15f)]('uId');if(_0x2e50b2===null||_0x2e50b2==='')window[_0x53ec8c(0x17f)](_0x53ec8c(0x179));else{const _0x5b23ee=[_0x53ec8c(0x195),_0x53ec8c(0x14a),_0x53ec8c(0x173)];for(const _0x5b6c80 of _0x5b23ee){await dpCreateFolder(_0x5b6c80);}let _0x1e30af=0x0;for(const _0x17d9aa of _0x5b23ee){const _0x59fe6f=a0_0x441aa0[_0x53ec8c(0x154)](_0x17d9aa+'s');_0x1e30af+=_0x59fe6f[_0x53ec8c(0x151)];}if(window['confirm'](_0x53ec8c(0x14f)+_0x1e30af+_0x53ec8c(0x164)))for(const _0x23072e of _0x5b23ee){const _0x260396=a0_0x441aa0[_0x53ec8c(0x154)](_0x23072e+'s');for(const _0x3a6cc2 of _0x260396){const _0x183908=await a0_0x441aa0[_0x53ec8c(0x158)](_0x53ec8c(0x18f)+_0x23072e+'s/'+_0x3a6cc2);try{await lockNoti(_0x53ec8c(0x1a2),_0x3a6cc2,0xbb8),await dpUploadFile(_0x3a6cc2,_0x183908,_0x23072e);}catch(_0xfe1429){console['error'](_0x53ec8c(0x189)+_0x3a6cc2+':',_0xfe1429);}}}else console['log'](_0x53ec8c(0x15e));}}),dropboxCloud[_0x222d13(0x163)]('click',function(){var _0x2800db=_0x222d13;const _0x147f8a=localStorage[_0x2800db(0x15f)](_0x2800db(0x159));_0x147f8a===null||_0x147f8a===''?authorizeWithDropbox():window[_0x2800db(0x13f)](_0x2800db(0x168))&&(localStorage[_0x2800db(0x19d)](_0x2800db(0x159),''),dropboxRestore[_0x2800db(0x175)][_0x2800db(0x147)](_0x2800db(0x171)),dropboxBackup[_0x2800db(0x175)][_0x2800db(0x147)](_0x2800db(0x171)),dropboxCloud[_0x2800db(0x175)][_0x2800db(0x147)]('active'));}),handleDropboxCallback();});