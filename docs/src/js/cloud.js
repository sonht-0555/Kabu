var a0_0x5ddac3=a0_0x4ee0;(function(_0x1595ab,_0x16422c){var _0x47c272=a0_0x4ee0,_0x2fbebf=_0x1595ab();while(!![]){try{var _0x4e24cf=-parseInt(_0x47c272(0xe0))/0x1*(parseInt(_0x47c272(0xde))/0x2)+-parseInt(_0x47c272(0x108))/0x3*(parseInt(_0x47c272(0x11b))/0x4)+parseInt(_0x47c272(0xda))/0x5*(-parseInt(_0x47c272(0x110))/0x6)+-parseInt(_0x47c272(0xdd))/0x7*(parseInt(_0x47c272(0x104))/0x8)+parseInt(_0x47c272(0x119))/0x9+parseInt(_0x47c272(0xe7))/0xa*(parseInt(_0x47c272(0xc3))/0xb)+parseInt(_0x47c272(0xe9))/0xc;if(_0x4e24cf===_0x16422c)break;else _0x2fbebf['push'](_0x2fbebf['shift']());}catch(_0x4743fb){_0x2fbebf['push'](_0x2fbebf['shift']());}}}(a0_0x40d9,0xe43c0));function a0_0x4ee0(_0x420354,_0xf38fbf){var _0x40d999=a0_0x40d9();return a0_0x4ee0=function(_0x4ee093,_0x3728c2){_0x4ee093=_0x4ee093-0xb7;var _0x2b9f7a=_0x40d999[_0x4ee093];return _0x2b9f7a;},a0_0x4ee0(_0x420354,_0xf38fbf);}import*as a0_0x3276d9 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5ddac3(0x107),clientSecret=a0_0x5ddac3(0x10d);function authorizeWithDropbox(){var _0x58cbc1=a0_0x5ddac3,_0x1a2e76=window[_0x58cbc1(0xe1)][_0x58cbc1(0x100)][_0x58cbc1(0xbe)]('?')[0x0],_0xfd2d9e=_0x58cbc1(0x112),_0x40fc09='offline',_0x46cb91=_0x58cbc1(0xbd)+clientId+_0x58cbc1(0xeb)+_0xfd2d9e+_0x58cbc1(0xf6)+_0x40fc09+_0x58cbc1(0xf4)+encodeURIComponent(_0x1a2e76);window['location']['href']=_0x46cb91;}function handleDropboxCallback(){var _0x26e6d8=a0_0x5ddac3,_0x35a025=getUrlParameter(_0x26e6d8(0x112));_0x35a025?(getAccessToken(_0x35a025),console[_0x26e6d8(0x11c)](_0x26e6d8(0x102),_0x35a025)):console[_0x26e6d8(0x11c)](_0x26e6d8(0x10f));}function getUrlParameter(_0x31d014){var _0x327440=a0_0x5ddac3;_0x31d014=_0x31d014[_0x327440(0xef)](/[\[]/,'\x5c[')[_0x327440(0xef)](/[\]]/,'\x5c]');var _0x27f972=new RegExp(_0x327440(0xe2)+_0x31d014+_0x327440(0xd3)),_0x5668f6=_0x27f972[_0x327440(0xc6)](location[_0x327440(0x113)]);return _0x5668f6===null?'':decodeURIComponent(_0x5668f6[0x1][_0x327440(0xef)](/\+/g,'\x20'));}function getAccessToken(_0x55c51c){var _0x3d99ae=a0_0x5ddac3,_0x449ec2=_0x3d99ae(0xfb),_0x2429f4=window[_0x3d99ae(0xe1)][_0x3d99ae(0x100)][_0x3d99ae(0xbe)]('?')[0x0],_0x459d94=new XMLHttpRequest();_0x459d94['open'](_0x3d99ae(0xee),_0x3d99ae(0xc8)),_0x459d94[_0x3d99ae(0xcb)](_0x3d99ae(0xc7),_0x3d99ae(0xba)),_0x459d94[_0x3d99ae(0xff)]=function(){var _0x46f768=_0x3d99ae;if(_0x459d94['status']===0xc8){var _0x22fa3d=JSON[_0x46f768(0xf5)](_0x459d94[_0x46f768(0xd1)]),_0xc50643=_0x22fa3d['access_token'],_0x1f1c62=_0x22fa3d[_0x46f768(0xdf)],_0x3382f4=_0x22fa3d[_0x46f768(0x11d)];localStorage[_0x46f768(0xed)](_0x46f768(0xd0),_0xc50643),localStorage[_0x46f768(0xed)](_0x46f768(0xd5),_0x1f1c62),localStorage[_0x46f768(0xed)](_0x46f768(0xbc),_0x3382f4);}else console[_0x46f768(0x11c)](_0x46f768(0xea));},_0x459d94[_0x3d99ae(0xd4)](_0x3d99ae(0x11a)+_0x55c51c+'&grant_type='+_0x449ec2+_0x3d99ae(0x111)+clientId+_0x3d99ae(0xbf)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x2429f4));}export async function dpCreateFolder(_0x18f561){var _0x2eeb36=a0_0x5ddac3;const _0x2c5df7=localStorage[_0x2eeb36(0xdc)](_0x2eeb36(0xbc));let _0x1dfe45=localStorage[_0x2eeb36(0xdc)](_0x2eeb36(0xd0));const _0x2f060b='/'+_0x2c5df7+'/'+_0x18f561,_0x2a68b8=JSON[_0x2eeb36(0x11f)]({'path':_0x2f060b,'autorename':![]});for(let _0x382ef6=0x0;_0x382ef6<0x2;_0x382ef6++){try{const _0x38ea6a=await fetch(_0x2eeb36(0xc9),{'method':_0x2eeb36(0xee),'headers':{'Authorization':_0x2eeb36(0xe4)+_0x1dfe45,'Content-Type':_0x2eeb36(0xc5)},'body':_0x2a68b8});if(_0x38ea6a[_0x2eeb36(0x10e)]===0x191){const _0x3f127b=await dpRefreshToken();if(!_0x3f127b)throw new Error(_0x2eeb36(0x109));_0x1dfe45=localStorage['getItem'](_0x2eeb36(0xd0));continue;}if(_0x38ea6a[_0x2eeb36(0x10e)]===0x199)return{'message':_0x2eeb36(0x11e),'path':_0x18f561};if(!_0x38ea6a['ok'])throw new Error(_0x2eeb36(0x118)+_0x18f561);const _0x15dd8c=await _0x38ea6a[_0x2eeb36(0x106)]();return await lockNoti(_0x2eeb36(0xd2),'',0xbb8),_0x15dd8c;}catch(_0x2d93d0){if(_0x382ef6===0x1)throw _0x2d93d0;}}return![];}function a0_0x40d9(){var _0x40150f=['alert','https://content.dropboxapi.com/2/files/download','classList','/data/','No\x20refresh\x20token','application/x-www-form-urlencoded','Cloud\x20login\x20required!','uId','https://www.dropbox.com/oauth2/authorize?client_id=','split','&client_secret=','\x20files\x20from\x20Cloud?','name','length','54923hAiGmt','overwrite','application/json','exec','Content-Type','https://api.dropbox.com/oauth2/token','https://api.dropboxapi.com/2/files/create_folder_v2','Refreshing\x20token...','setRequestHeader','https://api.dropboxapi.com/oauth2/token','Kabu\x20storage\x20↦\x20Cloud\x20◆','No\x20files\x20found\x20to\x20restore.','confirm','accessToken','responseText','Folder\x20created','=([^&#]*)','send','refreshToken','Wait\x20a\x20little\x20bit...','uploadFileInCloud','https://content.dropboxapi.com/2/files/upload','Do\x20you\x20want\x20to\x20backup\x20','12585lQkXrS','Failed\x20to\x20upload\x20file\x20','getItem','113848sqyxEB','100ODTMxf','refresh_token','32061NFglnl','location','[\x5c?&#]','Restore\x20canceled\x20by\x20user.','Bearer\x20','refresh_token=','DOMContentLoaded','3530SgLJuG','addEventListener','44551404IUVaMi','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&response_type=','blob','setItem','POST','replace','filter','active','Do\x20you\x20want\x20to\x20restore\x20','folder','&redirect_uri=','parse','&token_access_type=','Download\x20failed\x20for\x20','error','listFiles','Cloud\x20↦\x20Kabu\x20storage\x20◆','authorization_code','entries','downloadFileInCloud','remove','onload','href','screenshot','Authorization\x20Code:','application/octet-stream','200xZUZLi','state','json','knh3uz2mx2hp2eu','212799vhZhPm','Unable\x20to\x20refresh\x20token','save',',\x20status:\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','nwb3dnfh09rhs31','status','Do\x20not\x20receive\x20authorization','2994ZMxuvR','&client_id=','code','search','Failed\x20to\x20refresh\x20Dropbox\x20token.','\x20files\x20in\x20Kabu?','error_description','Backing\x20up...','Error\x20creating\x20folder\x20','3849543NiTrDH','code=','96DqdSwC','log','uid','Folder\x20already\x20exists','stringify','Error\x20while\x20refreshing\x20token:'];a0_0x40d9=function(){return _0x40150f;};return a0_0x40d9();}export async function dpRefreshToken(){var _0x23f641=a0_0x5ddac3;if(!localStorage[_0x23f641(0xdc)](_0x23f641(0xd5)))throw _0x23f641(0xb9);try{const _0x14d88c=await fetch(_0x23f641(0xcc),{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x23f641(0xe5)+localStorage['getItem'](_0x23f641(0xd5))+_0x23f641(0x10c)}),_0x255b2c=await _0x14d88c['json']();if(!_0x255b2c[_0x23f641(0xf8)])return localStorage[_0x23f641(0xed)](_0x23f641(0xd0),_0x255b2c['access_token']),await lockNoti(_0x23f641(0xca),'',0xbb8),await delay(0x3e8),!![];else alert(_0x255b2c[_0x23f641(0x116)]||_0x23f641(0x114));}catch(_0x412de9){console['error'](_0x23f641(0x120),_0x412de9);}return![];}export async function dpUploadFile(_0x4e9c1e,_0x3c97e4,_0x2b4b18){var _0x5abe5c=a0_0x5ddac3;const _0x2a6f1c=localStorage[_0x5abe5c(0xdc)](_0x5abe5c(0xbc));var _0x74b302=JSON[_0x5abe5c(0x11f)]({'autorename':!![],'mode':_0x5abe5c(0xc4),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a6f1c+'/'+_0x2b4b18+'/'+_0x4e9c1e}),_0x31b0c0=new Blob([_0x3c97e4],{'type':'application/octet-stream'});for(var _0x5477c1=0x0;_0x5477c1<0x2;_0x5477c1++){var _0x571bf2=await fetch(_0x5abe5c(0xd8),{'method':_0x5abe5c(0xee),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x5abe5c(0xd0)),'Dropbox-API-Arg':_0x74b302,'Content-Type':_0x5abe5c(0x103)},'body':_0x31b0c0});if(_0x571bf2[_0x5abe5c(0x10e)]!=0xc8){if(_0x571bf2[_0x5abe5c(0x10e)]==0x191){var _0x1077b1=await dpRefreshToken();if(!_0x1077b1)throw _0x5abe5c(0x109);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x571bf2[_0x5abe5c(0x10e)];}else{var _0x4d8bdd=await _0x571bf2['json']();return console['log'](_0x5abe5c(0xcd),_0x4e9c1e),_0x4d8bdd;}}return![];}export async function dpDownloadFile(_0x73f581,_0x35ec01){var _0x3b9b46=a0_0x5ddac3;const _0xf9d22d=localStorage[_0x3b9b46(0xdc)](_0x3b9b46(0xbc));var _0x51c24a=JSON[_0x3b9b46(0x11f)]({'path':'/'+_0xf9d22d+'/'+_0x35ec01+'/'+_0x73f581});for(var _0x40c553=0x0;_0x40c553<0x2;_0x40c553++){var _0x42d76e=await fetch(_0x3b9b46(0x122),{'method':_0x3b9b46(0xee),'headers':{'Authorization':_0x3b9b46(0xe4)+localStorage[_0x3b9b46(0xdc)](_0x3b9b46(0xd0)),'Dropbox-API-Arg':_0x51c24a}});if(_0x42d76e[_0x3b9b46(0x10e)]!=0xc8){if(_0x42d76e[_0x3b9b46(0x10e)]==0x191){var _0x5de287=await dpRefreshToken();if(!_0x5de287)throw _0x3b9b46(0x109);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x42d76e[_0x3b9b46(0x10e)];}const _0x30f723=new File([await _0x42d76e[_0x3b9b46(0xec)]()],_0x73f581);return console[_0x3b9b46(0x11c)](_0x3b9b46(0xfa),_0x30f723[_0x3b9b46(0xc1)]),a0_0x3276d9[_0x3b9b46(0xd7)](_0x30f723,()=>{}),_0x30f723;}return![];}document['addEventListener'](a0_0x5ddac3(0xe6),function(){var _0x32ce8f=a0_0x5ddac3;dropboxRestore[_0x32ce8f(0xe8)]('click',async function(){var _0x48e1b5=_0x32ce8f;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x5cf74e=localStorage[_0x48e1b5(0xdc)](_0x48e1b5(0xbc)),_0x3e4c55=['state',_0x48e1b5(0x10a),_0x48e1b5(0x101)];if(!_0x5cf74e){window[_0x48e1b5(0x121)](_0x48e1b5(0xbb));return;}let _0x25e97a=[];for(const _0x11b2b3 of _0x3e4c55){let _0x717b0e={'path':'/'+_0x5cf74e+'/'+_0x11b2b3};for(let _0x1abf2c=0x0;_0x1abf2c<0x2;_0x1abf2c++){let _0x814d6e=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x48e1b5(0xe4)+localStorage[_0x48e1b5(0xdc)]('accessToken'),'Content-Type':_0x48e1b5(0xc5)},'body':JSON[_0x48e1b5(0x11f)](_0x717b0e)});if(_0x814d6e['status']===0xc8){let _0x179c48=await _0x814d6e[_0x48e1b5(0x106)](),_0x254754=_0x179c48[_0x48e1b5(0xfc)][_0x48e1b5(0xf0)](_0x1f1417=>_0x1f1417['.tag']==='file');_0x254754[_0x48e1b5(0xc2)]>0x0&&_0x25e97a['push'](..._0x254754['map'](_0x18caff=>({'name':_0x18caff['name'],'folder':_0x11b2b3})));break;}else{if(_0x814d6e[_0x48e1b5(0x10e)]===0x191){let _0x306e2e=await dpRefreshToken();if(!_0x306e2e)throw _0x48e1b5(0x109);}else{console[_0x48e1b5(0xf8)](_0x48e1b5(0xf7)+_0x11b2b3+_0x48e1b5(0x10b)+_0x814d6e['status']);break;}}}}if(_0x25e97a['length']>0x0){const _0x1da1a8=_0x48e1b5(0xf2)+_0x25e97a[_0x48e1b5(0xc2)]+_0x48e1b5(0xc0);if(window[_0x48e1b5(0xcf)](_0x1da1a8))for(const _0x17b102 of _0x25e97a){await lockNoti('Restoring...',_0x17b102[_0x48e1b5(0xc1)],0xbb8),await dpDownloadFile(_0x17b102[_0x48e1b5(0xc1)],_0x17b102[_0x48e1b5(0xf3)]);}else console[_0x48e1b5(0x11c)](_0x48e1b5(0xe3));}else console[_0x48e1b5(0x11c)](_0x48e1b5(0xce));}),dropboxBackup['addEventListener']('click',async function(){var _0x3e764c=_0x32ce8f;await lockNoti(_0x3e764c(0xd6),'',0x1388);const _0x2ff79d=localStorage['getItem'](_0x3e764c(0xbc));if(_0x2ff79d===null||_0x2ff79d==='')window['alert'](_0x3e764c(0xbb));else{const _0x22eb37=[_0x3e764c(0x105),_0x3e764c(0x10a),'screenshot'];for(const _0x4484fb of _0x22eb37){await dpCreateFolder(_0x4484fb);}let _0x46bce1=0x0;for(const _0x1ba5ca of _0x22eb37){const _0x3c7f40=a0_0x3276d9[_0x3e764c(0xf9)](_0x1ba5ca+'s');_0x46bce1+=_0x3c7f40[_0x3e764c(0xc2)];}if(window[_0x3e764c(0xcf)](_0x3e764c(0xd9)+_0x46bce1+_0x3e764c(0x115)))for(const _0x4ff328 of _0x22eb37){const _0x1ddcc2=a0_0x3276d9[_0x3e764c(0xf9)](_0x4ff328+'s');for(const _0x406fce of _0x1ddcc2){const _0x14cb72=await a0_0x3276d9[_0x3e764c(0xfd)](_0x3e764c(0xb8)+_0x4ff328+'s/'+_0x406fce);try{await lockNoti(_0x3e764c(0x117),_0x406fce,0xbb8),await dpUploadFile(_0x406fce,_0x14cb72,_0x4ff328);}catch(_0x4b320e){console['error'](_0x3e764c(0xdb)+_0x406fce+':',_0x4b320e);}}}else console[_0x3e764c(0x11c)](_0x3e764c(0xe3));}}),dropboxCloud[_0x32ce8f(0xe8)]('click',function(){var _0x5241e1=_0x32ce8f;const _0x5e2d07=localStorage[_0x5241e1(0xdc)](_0x5241e1(0xbc));_0x5e2d07===null||_0x5e2d07===''?authorizeWithDropbox():window[_0x5241e1(0xcf)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x5241e1(0xbc),''),dropboxRestore[_0x5241e1(0xb7)][_0x5241e1(0xfe)]('active'),dropboxBackup['classList'][_0x5241e1(0xfe)](_0x5241e1(0xf1)),dropboxCloud[_0x5241e1(0xb7)][_0x5241e1(0xfe)](_0x5241e1(0xf1)));}),handleDropboxCallback();});