function a0_0x4043(_0x363867,_0x52a6eb){var _0x2da128=a0_0x2da1();return a0_0x4043=function(_0x404325,_0x39b087){_0x404325=_0x404325-0x149;var _0x3c42e1=_0x2da128[_0x404325];return _0x3c42e1;},a0_0x4043(_0x363867,_0x52a6eb);}var a0_0x50ee52=a0_0x4043;(function(_0x5b4bd7,_0x57efbe){var _0x484a2c=a0_0x4043,_0x19e97d=_0x5b4bd7();while(!![]){try{var _0x503321=-parseInt(_0x484a2c(0x17e))/0x1+parseInt(_0x484a2c(0x16d))/0x2+-parseInt(_0x484a2c(0x196))/0x3*(parseInt(_0x484a2c(0x156))/0x4)+-parseInt(_0x484a2c(0x1b8))/0x5*(-parseInt(_0x484a2c(0x1ae))/0x6)+-parseInt(_0x484a2c(0x1ba))/0x7+parseInt(_0x484a2c(0x149))/0x8*(parseInt(_0x484a2c(0x1a7))/0x9)+-parseInt(_0x484a2c(0x169))/0xa*(parseInt(_0x484a2c(0x17f))/0xb);if(_0x503321===_0x57efbe)break;else _0x19e97d['push'](_0x19e97d['shift']());}catch(_0x184570){_0x19e97d['push'](_0x19e97d['shift']());}}}(a0_0x2da1,0x59872));import*as a0_0x26efe8 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x50ee52(0x192),clientSecret=a0_0x50ee52(0x193);function a0_0x2da1(){var _0x39a434=['log','uid','file','slice','.ss0','.ss4','137306MupAXk','11VJRQyV','.ss3','name','Unable\x20to\x20refresh\x20token','https://api.dropbox.com/oauth2/token','exec','parse','text/plain','Backing\x20up...','_dateState','state','https://content.dropboxapi.com/2/files/download','code','remove','href','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','getItem','FSSync','text','knh3uz2mx2hp2eu','nwb3dnfh09rhs31','Cloud\x20login\x20required!','downloadFileInCloud','291hlSJcs','charAt','application/x-www-form-urlencoded','onload','replace','&grant_type=','setRequestHeader','uploadSaveOrSaveState','Download\x20failed,\x20unknown\x20http\x20status:','_imageState','endsWith','length','addEventListener','.gba_slot','uId','Failed\x20to\x20upload\x20file\x20','&client_id=','1619487aNbcYA','Failed\x20to\x20refresh\x20Dropbox\x20token.','save','toUpperCase','status','application/json','.ss5','1458CqNBeS','Do\x20not\x20receive\x20authorization','Do\x20you\x20want\x20to\x20backup\x20','classList','.tag','blob','open','access_token','&response_type=','https://api.dropboxapi.com/oauth2/token','13495QLZLcs','click','740985NUgleN','https://www.dropbox.com/oauth2/authorize?client_id=','&token_access_type=','8PyTnfH','.ss6','Bearer\x20','error','Download\x20failed,\x20unknown\x20http\x20status:\x20','/data/','[\x5c?&#]','filter','accessToken','setItem','confirm','location','stringify','20660UsrGHL','https://api.dropboxapi.com/2/files/list_folder','Content-Type','json','split','Do\x20you\x20want\x20to\x20logout?','\x20files\x20in\x20Cloud?','.ss2','=([^&#]*)','&client_secret=','alert','list','substring','gba','Restore\x20canceled\x20by\x20user.','POST','Refreshing\x20token...','refresh_token=','entries','1835570vcqNiZ','refreshToken','Kabu\x20storage\x20↦\x20Cloud\x20◆','.txt','917258KyjzKO','Authorization\x20Code:','Do\x20you\x20want\x20to\x20restore\x20','&redirect_uri=','\x20files\x20in\x20Kabu?','code=','application/octet-stream','Restoring...','.ss1','authorization_code','lastIndexOf'];a0_0x2da1=function(){return _0x39a434;};return a0_0x2da1();}function authorizeWithDropbox(){var _0x5eb3df=a0_0x50ee52,_0x1946ba=window[_0x5eb3df(0x154)][_0x5eb3df(0x18d)][_0x5eb3df(0x15a)]('?')[0x0],_0x1602c3='code',_0x3e7051='offline',_0x403815=_0x5eb3df(0x1bb)+clientId+_0x5eb3df(0x1b6)+_0x1602c3+_0x5eb3df(0x1bc)+_0x3e7051+'&redirect_uri='+encodeURIComponent(_0x1946ba);window[_0x5eb3df(0x154)][_0x5eb3df(0x18d)]=_0x403815;}function handleDropboxCallback(){var _0x5801ad=a0_0x50ee52,_0x3a0d73=getUrlParameter(_0x5801ad(0x18b));_0x3a0d73?(getAccessToken(_0x3a0d73),console[_0x5801ad(0x178)](_0x5801ad(0x16e),_0x3a0d73)):console['log'](_0x5801ad(0x1af));}function getUrlParameter(_0x434a8e){var _0x2e133d=a0_0x50ee52;_0x434a8e=_0x434a8e[_0x2e133d(0x19a)](/[\[]/,'\x5c[')[_0x2e133d(0x19a)](/[\]]/,'\x5c]');var _0x3bd764=new RegExp(_0x2e133d(0x14f)+_0x434a8e+_0x2e133d(0x15e)),_0x3fb670=_0x3bd764[_0x2e133d(0x184)](location['search']);return _0x3fb670===null?'':decodeURIComponent(_0x3fb670[0x1][_0x2e133d(0x19a)](/\+/g,'\x20'));}function getAccessToken(_0x2863aa){var _0x22fe66=a0_0x50ee52,_0x1e41d7=_0x22fe66(0x176),_0x2ec8ae=window[_0x22fe66(0x154)][_0x22fe66(0x18d)][_0x22fe66(0x15a)]('?')[0x0],_0x5236ff=new XMLHttpRequest();_0x5236ff[_0x22fe66(0x1b4)](_0x22fe66(0x165),_0x22fe66(0x183)),_0x5236ff[_0x22fe66(0x19c)](_0x22fe66(0x158),_0x22fe66(0x198)),_0x5236ff[_0x22fe66(0x199)]=function(){var _0x5c5b77=_0x22fe66;if(_0x5236ff[_0x5c5b77(0x1ab)]===0xc8){var _0x5579a1=JSON[_0x5c5b77(0x185)](_0x5236ff['responseText']),_0x50aa9e=_0x5579a1['access_token'],_0x441a21=_0x5579a1['refresh_token'],_0x4846c4=_0x5579a1[_0x5c5b77(0x179)];localStorage[_0x5c5b77(0x152)]('accessToken',_0x50aa9e),localStorage[_0x5c5b77(0x152)](_0x5c5b77(0x16a),_0x441a21),localStorage[_0x5c5b77(0x152)](_0x5c5b77(0x1a4),_0x4846c4);}else console[_0x5c5b77(0x178)](_0x5c5b77(0x18e));},_0x5236ff['send'](_0x22fe66(0x172)+_0x2863aa+_0x22fe66(0x19b)+_0x1e41d7+_0x22fe66(0x1a6)+clientId+_0x22fe66(0x15f)+clientSecret+_0x22fe66(0x170)+encodeURIComponent(_0x2ec8ae));}export async function dpRefreshToken(){var _0x54d171=a0_0x50ee52;if(!localStorage[_0x54d171(0x18f)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x3cf6bc=await fetch(_0x54d171(0x1b7),{'method':_0x54d171(0x165),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x54d171(0x167)+localStorage[_0x54d171(0x18f)](_0x54d171(0x16a))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x30531c=await _0x3cf6bc[_0x54d171(0x159)]();if(!_0x30531c[_0x54d171(0x14c)])return localStorage[_0x54d171(0x152)](_0x54d171(0x151),_0x30531c[_0x54d171(0x1b5)]),await lockNoti('',_0x54d171(0x166),0xbb8),await delay(0x3e8),!![];else alert(_0x30531c['error_description']||_0x54d171(0x1a8));}catch(_0x23d951){console[_0x54d171(0x14c)]('Error\x20while\x20refreshing\x20token:',_0x23d951);}return![];}export async function dpUploadFile(_0x1e9fbc,_0x55137f){var _0x2f44a3=a0_0x50ee52;const _0x1e9667=localStorage[_0x2f44a3(0x18f)](_0x2f44a3(0x1a4));var _0x23a9bd=JSON[_0x2f44a3(0x155)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x1e9667+'/'+_0x1e9fbc}),_0x30956d=new Blob([_0x55137f],{'type':_0x2f44a3(0x173)});for(var _0x19cc10=0x0;_0x19cc10<0x2;_0x19cc10++){var _0x1c735a=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x2f44a3(0x165),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x2f44a3(0x18f)](_0x2f44a3(0x151)),'Dropbox-API-Arg':_0x23a9bd,'Content-Type':_0x2f44a3(0x173)},'body':_0x30956d});if(_0x1c735a[_0x2f44a3(0x1ab)]!=0xc8){if(_0x1c735a[_0x2f44a3(0x1ab)]==0x191){var _0x570f63=await dpRefreshToken();if(!_0x570f63)throw _0x2f44a3(0x182);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1c735a[_0x2f44a3(0x1ab)];}else{var _0x238730=await _0x1c735a['json']();return console[_0x2f44a3(0x178)](_0x2f44a3(0x16b),_0x1e9fbc),_0x238730;}}return![];}async function dpDownloadFile(_0x3437bc){var _0x14698b=a0_0x50ee52;const _0x2eaf05=localStorage['getItem'](_0x14698b(0x1a4));var _0x159395=JSON['stringify']({'path':'/'+_0x2eaf05+'/'+_0x3437bc});for(var _0x27c7dc=0x0;_0x27c7dc<0x2;_0x27c7dc++){var _0x442538=await fetch(_0x14698b(0x18a),{'method':_0x14698b(0x165),'headers':{'Authorization':_0x14698b(0x14b)+localStorage[_0x14698b(0x18f)]('accessToken'),'Dropbox-API-Arg':_0x159395}});if(_0x442538['status']!=0xc8){if(_0x442538[_0x14698b(0x1ab)]==0x191){var _0x3fa16c=await dpRefreshToken();if(!_0x3fa16c)throw _0x14698b(0x182);continue;}else throw _0x14698b(0x19e)+_0x442538[_0x14698b(0x1ab)];}const _0x3b0b69=new File([await _0x442538[_0x14698b(0x1b3)]()],_0x3437bc);console[_0x14698b(0x178)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x3b0b69[_0x14698b(0x181)]);if(_0x3437bc['endsWith']('.txt')){const _0x557326=await _0x3b0b69[_0x14698b(0x191)](),[_0x380c3c,_0x4a495d]=_0x557326[_0x14698b(0x15a)]('\x0a\x0a'),_0x14190e=_0x3437bc[_0x14698b(0x162)](0x0,_0x3437bc[_0x14698b(0x177)](_0x14698b(0x163))+0x3),_0x1cd5c1=_0x3437bc[_0x14698b(0x197)](_0x3437bc['length']-0x5);localStorage['setItem'](_0x14190e+_0x14698b(0x188)+_0x1cd5c1,_0x4a495d),localStorage[_0x14698b(0x152)](_0x14190e+_0x14698b(0x19f)+_0x1cd5c1,_0x380c3c);}else a0_0x26efe8[_0x14698b(0x19d)](_0x3b0b69,()=>{var _0x4788f0=_0x14698b;localStorageFile(),Module[_0x4788f0(0x190)]();});return _0x3b0b69;}return![];}document[a0_0x50ee52(0x1a2)]('DOMContentLoaded',function(){var _0x5d5f42=a0_0x50ee52;dropboxRestore[_0x5d5f42(0x1a2)](_0x5d5f42(0x1b9),async function(){var _0x2d5846=_0x5d5f42;const _0x577c25=localStorage[_0x2d5846(0x18f)](_0x2d5846(0x1a4));if(_0x577c25===null||_0x577c25==='')window['alert'](_0x2d5846(0x194));else{var _0x3803bf={'path':'/'+_0x577c25};for(var _0x31b131=0x0;_0x31b131<0x2;_0x31b131++){var _0xef07ed=await fetch(_0x2d5846(0x157),{'method':_0x2d5846(0x165),'headers':{'Authorization':_0x2d5846(0x14b)+localStorage[_0x2d5846(0x18f)](_0x2d5846(0x151)),'Content-Type':_0x2d5846(0x1ac)},'body':JSON[_0x2d5846(0x155)](_0x3803bf)});console['log']('status:\x20',_0xef07ed[_0x2d5846(0x1ab)]);if(_0xef07ed['status']!=0xc8){if(_0xef07ed[_0x2d5846(0x1ab)]==0x191){var _0x118c33=await dpRefreshToken();if(!_0x118c33)throw _0x2d5846(0x182);continue;}else throw _0x2d5846(0x14d)+_0xef07ed[_0x2d5846(0x1ab)];}else{const _0x5b6cc8=await _0xef07ed[_0x2d5846(0x159)](),_0x29c7fc=_0x5b6cc8[_0x2d5846(0x168)][_0x2d5846(0x150)](_0xeaab66=>_0xeaab66[_0x2d5846(0x1b2)]===_0x2d5846(0x17a))[_0x2d5846(0x1a1)],_0x275bd3=_0x2d5846(0x16f)+_0x29c7fc+_0x2d5846(0x15c);if(window[_0x2d5846(0x153)](_0x275bd3))for(const _0x2dade7 of _0x5b6cc8[_0x2d5846(0x168)]){_0x2dade7[_0x2d5846(0x1b2)]===_0x2d5846(0x17a)&&(await lockNoti(_0x2d5846(0x174),_0x2dade7['name'],0xbb8),await dpDownloadFile(_0x2dade7['name']));}else console[_0x2d5846(0x178)](_0x2d5846(0x164));return!![];}}return![];}}),dropboxBackup['addEventListener'](_0x5d5f42(0x1b9),async function(){var _0x15f41c=_0x5d5f42;const _0x3f561c=localStorage['getItem']('uId');if(_0x3f561c===null||_0x3f561c==='')window[_0x15f41c(0x160)](_0x15f41c(0x194));else{const _0x4666b2=[_0x15f41c(0x189),_0x15f41c(0x1a9)];let _0x37aaae=0x0;for(const _0x5b0265 of _0x4666b2){const _0x28c4e9=a0_0x26efe8['list'+(_0x5b0265['charAt'](0x0)[_0x15f41c(0x1aa)]()+_0x5b0265[_0x15f41c(0x17b)](0x1))]();_0x37aaae+=_0x28c4e9['length'];}if(window[_0x15f41c(0x153)](_0x15f41c(0x1b0)+_0x37aaae+_0x15f41c(0x171)))for(const _0x5b4b75 of _0x4666b2){const _0x15c304=a0_0x26efe8[_0x15f41c(0x161)+(_0x5b4b75['charAt'](0x0)['toUpperCase']()+_0x5b4b75[_0x15f41c(0x17b)](0x1))]();for(const _0x3e2eac of _0x15c304){const _0x2207a7=await a0_0x26efe8[_0x15f41c(0x195)](_0x15f41c(0x14e)+_0x5b4b75+'s/'+_0x3e2eac);try{await lockNoti('Backing\x20up...',_0x3e2eac,0xbb8),await dpUploadFile(_0x3e2eac,_0x2207a7);if(_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x17c))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x175))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x15d))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x180))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x17d))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x1ad))||_0x3e2eac[_0x15f41c(0x1a0)](_0x15f41c(0x14a))||_0x3e2eac['endsWith']('.ss7')){const _0x32a2f3=_0x3e2eac[_0x15f41c(0x162)](0x0,_0x3e2eac[_0x15f41c(0x177)]('.')),_0x35a408=_0x3e2eac[_0x15f41c(0x197)](_0x3e2eac[_0x15f41c(0x1a1)]-0x1),_0x5d441b=localStorage[_0x15f41c(0x18f)](_0x32a2f3+'.gba_imageState'+_0x35a408),_0xf39abd=localStorage['getItem'](_0x32a2f3+'.gba_dateState'+_0x35a408);if(_0x5d441b!==null){const _0x4a5441=_0x5d441b+'\x0a\x0a'+_0xf39abd,_0x4801b6=new Blob([_0x4a5441],{'type':_0x15f41c(0x186)});await lockNoti(_0x15f41c(0x187),_0x32a2f3+_0x15f41c(0x1a3)+_0x35a408+_0x15f41c(0x16c),0xbb8),await dpUploadFile(_0x32a2f3+_0x15f41c(0x1a3)+_0x35a408+'.txt',_0x4801b6);}}}catch(_0x1be833){console[_0x15f41c(0x14c)](_0x15f41c(0x1a5)+_0x3e2eac+':',_0x1be833);}}}else console[_0x15f41c(0x178)](_0x15f41c(0x164));}}),dropboxCloud[_0x5d5f42(0x1a2)]('click',function(){var _0x3f49d8=_0x5d5f42;const _0x62d513=localStorage[_0x3f49d8(0x18f)](_0x3f49d8(0x1a4));_0x62d513===null||_0x62d513===''?authorizeWithDropbox():window[_0x3f49d8(0x153)](_0x3f49d8(0x15b))&&(localStorage[_0x3f49d8(0x152)](_0x3f49d8(0x1a4),''),dropboxRestore['classList']['remove']('active'),dropboxBackup[_0x3f49d8(0x1b1)]['remove']('active'),dropboxCloud['classList'][_0x3f49d8(0x18c)]('active'));}),handleDropboxCallback();});