var a0_0xf80d6=a0_0x43e1;(function(_0x3412c7,_0x38e157){var _0x182ae5=a0_0x43e1,_0x5b249c=_0x3412c7();while(!![]){try{var _0x216dd7=parseInt(_0x182ae5(0x19e))/0x1+-parseInt(_0x182ae5(0x1a4))/0x2+parseInt(_0x182ae5(0x18f))/0x3+-parseInt(_0x182ae5(0x17c))/0x4*(-parseInt(_0x182ae5(0x1b5))/0x5)+parseInt(_0x182ae5(0x192))/0x6*(-parseInt(_0x182ae5(0x1a1))/0x7)+parseInt(_0x182ae5(0x1a2))/0x8*(parseInt(_0x182ae5(0x199))/0x9)+-parseInt(_0x182ae5(0x178))/0xa*(parseInt(_0x182ae5(0x15e))/0xb);if(_0x216dd7===_0x38e157)break;else _0x5b249c['push'](_0x5b249c['shift']());}catch(_0x31f53b){_0x5b249c['push'](_0x5b249c['shift']());}}}(a0_0x1657,0x826b3));import*as a0_0xa6f065 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0xf80d6(0x153);function authorizeWithDropbox(){var _0x449384=a0_0xf80d6,_0x2febbb=window[_0x449384(0x195)][_0x449384(0x157)][_0x449384(0x166)]('?')[0x0],_0x6be018='code',_0x31d265=_0x449384(0x1b3),_0x52fad7='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x6be018+_0x449384(0x164)+_0x31d265+_0x449384(0x17a)+encodeURIComponent(_0x2febbb);window[_0x449384(0x195)][_0x449384(0x157)]=_0x52fad7;}function handleDropboxCallback(){var _0x2745c1=a0_0xf80d6,_0x22489e=getUrlParameter(_0x2745c1(0x170));_0x22489e?(getAccessToken(_0x22489e),console[_0x2745c1(0x188)]('Authorization\x20Code:',_0x22489e)):console[_0x2745c1(0x188)](_0x2745c1(0x1ad));}function a0_0x43e1(_0x34440e,_0x5694a5){var _0x165792=a0_0x1657();return a0_0x43e1=function(_0x43e137,_0x1d615d){_0x43e137=_0x43e137-0x151;var _0x4affd1=_0x165792[_0x43e137];return _0x4affd1;},a0_0x43e1(_0x34440e,_0x5694a5);}function a0_0x1657(){var _0xc0b259=['authorization_code','status','\x20files\x20from\x20Cloud?','application/x-www-form-urlencoded','Failed\x20to\x20refresh\x20Dropbox\x20token.','parse','application/octet-stream','uploadFileInCloud','addEventListener','replace','uid','log','&grant_type=','&client_secret=','Folder\x20already\x20exists','send','/data/','code=','1285707BCnmxy','getItem','Content-Type','6ZWvdGJ','push','No\x20refresh\x20token','location','uId','Restoring...','Restore\x20canceled\x20by\x20user.','3429pSsjtR','confirm','screenshot','application/json','[\x5c?&#]','277997yHxGeU','Failed\x20to\x20upload\x20file\x20',',\x20status:\x20','1076054TOhYcc','7712UQRyqj','error','597240gNgwpR','Kabu\x20storage\x20↦\x20Cloud\x20◆','Do\x20you\x20want\x20to\x20backup\x20','access_token','Cloud\x20login\x20required!','Error\x20creating\x20folder\x20','Backing\x20up...','active','name','Do\x20not\x20receive\x20authorization','https://api.dropboxapi.com/2/files/create_folder_v2','json','state','setRequestHeader','Wait\x20a\x20little\x20bit...','offline','=([^&#]*)','27155dFbvCv','POST','length','listFiles','Refreshing\x20token...','nwb3dnfh09rhs31','\x20files\x20in\x20Kabu?','remove','save','href','alert','classList','https://content.dropboxapi.com/2/files/upload','Do\x20you\x20want\x20to\x20restore\x20','map','https://api.dropboxapi.com/oauth2/token','11tQtXmG','open','DOMContentLoaded','.tag','overwrite','Folder\x20created','&token_access_type=','Unable\x20to\x20refresh\x20token','split','search','Download\x20failed,\x20unknown\x20http\x20status:','https://content.dropboxapi.com/2/files/download','https://api.dropbox.com/oauth2/token','stringify','click','Cloud\x20↦\x20Kabu\x20storage\x20◆','error_description','setItem','code','downloadFileInCloud','filter','Bearer\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','accessToken','responseText','3208460TyZMXv','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&redirect_uri=','Do\x20you\x20want\x20to\x20logout?','172svVKKC'];a0_0x1657=function(){return _0xc0b259;};return a0_0x1657();}function getUrlParameter(_0x150361){var _0x1025cb=a0_0xf80d6;_0x150361=_0x150361['replace'](/[\[]/,'\x5c[')[_0x1025cb(0x186)](/[\]]/,'\x5c]');var _0x391c04=new RegExp(_0x1025cb(0x19d)+_0x150361+_0x1025cb(0x1b4)),_0x4403dd=_0x391c04['exec'](location[_0x1025cb(0x167)]);return _0x4403dd===null?'':decodeURIComponent(_0x4403dd[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x578984){var _0x504536=a0_0xf80d6,_0x9c5ca5=_0x504536(0x17d),_0x5b75f2=window[_0x504536(0x195)][_0x504536(0x157)][_0x504536(0x166)]('?')[0x0],_0x25a2f2=new XMLHttpRequest();_0x25a2f2[_0x504536(0x15f)](_0x504536(0x1b6),_0x504536(0x16a)),_0x25a2f2[_0x504536(0x1b1)](_0x504536(0x191),_0x504536(0x180)),_0x25a2f2['onload']=function(){var _0x596a0c=_0x504536;if(_0x25a2f2[_0x596a0c(0x17e)]===0xc8){var _0x5a3518=JSON[_0x596a0c(0x182)](_0x25a2f2[_0x596a0c(0x177)]),_0x1ae52a=_0x5a3518[_0x596a0c(0x1a7)],_0x4ce713=_0x5a3518['refresh_token'],_0x178c72=_0x5a3518[_0x596a0c(0x187)];localStorage[_0x596a0c(0x16f)](_0x596a0c(0x176),_0x1ae52a),localStorage[_0x596a0c(0x16f)]('refreshToken',_0x4ce713),localStorage['setItem'](_0x596a0c(0x196),_0x178c72);}else console[_0x596a0c(0x188)](_0x596a0c(0x179));},_0x25a2f2[_0x504536(0x18c)](_0x504536(0x18e)+_0x578984+_0x504536(0x189)+_0x9c5ca5+'&client_id='+clientId+_0x504536(0x18a)+clientSecret+_0x504536(0x17a)+encodeURIComponent(_0x5b75f2));}export async function dpCreateFolder(_0x1e9b1d){var _0x519b1e=a0_0xf80d6;const _0x3dc523=localStorage[_0x519b1e(0x190)](_0x519b1e(0x196));let _0xc84a85=localStorage[_0x519b1e(0x190)](_0x519b1e(0x176));const _0x45525c='/'+_0x3dc523+'/'+_0x1e9b1d,_0x32594d=JSON[_0x519b1e(0x16b)]({'path':_0x45525c,'autorename':![]});for(let _0x5c5501=0x0;_0x5c5501<0x2;_0x5c5501++){try{const _0x1e0f57=await fetch(_0x519b1e(0x1ae),{'method':_0x519b1e(0x1b6),'headers':{'Authorization':_0x519b1e(0x173)+_0xc84a85,'Content-Type':_0x519b1e(0x19c)},'body':_0x32594d});if(_0x1e0f57[_0x519b1e(0x17e)]===0x191){const _0x2b4d82=await dpRefreshToken();if(!_0x2b4d82)throw new Error(_0x519b1e(0x165));_0xc84a85=localStorage[_0x519b1e(0x190)](_0x519b1e(0x176));continue;}if(_0x1e0f57[_0x519b1e(0x17e)]===0x199)return{'message':_0x519b1e(0x18b),'path':_0x1e9b1d};if(!_0x1e0f57['ok'])throw new Error(_0x519b1e(0x1a9)+_0x1e9b1d);const _0x1265cb=await _0x1e0f57[_0x519b1e(0x1af)]();return await lockNoti(_0x519b1e(0x163),'',0xbb8),_0x1265cb;}catch(_0x277767){if(_0x5c5501===0x1)throw _0x277767;}}return![];}export async function dpRefreshToken(){var _0xa5a0c9=a0_0xf80d6;if(!localStorage[_0xa5a0c9(0x190)](_0xa5a0c9(0x175)))throw _0xa5a0c9(0x194);try{const _0x4c8fc0=await fetch(_0xa5a0c9(0x15d),{'method':'POST','headers':{'Content-Type':_0xa5a0c9(0x180)},'body':'refresh_token='+localStorage[_0xa5a0c9(0x190)](_0xa5a0c9(0x175))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x11330a=await _0x4c8fc0[_0xa5a0c9(0x1af)]();if(!_0x11330a[_0xa5a0c9(0x1a3)])return localStorage[_0xa5a0c9(0x16f)](_0xa5a0c9(0x176),_0x11330a[_0xa5a0c9(0x1a7)]),await lockNoti(_0xa5a0c9(0x152),'',0xbb8),await delay(0x3e8),!![];else alert(_0x11330a[_0xa5a0c9(0x16e)]||_0xa5a0c9(0x181));}catch(_0xfff399){console['error']('Error\x20while\x20refreshing\x20token:',_0xfff399);}return![];}export async function dpUploadFile(_0x22ad79,_0x293cb5,_0x435950){var _0x553ddd=a0_0xf80d6;const _0x447f60=localStorage[_0x553ddd(0x190)](_0x553ddd(0x196));var _0x1fa465=JSON['stringify']({'autorename':!![],'mode':_0x553ddd(0x162),'mute':!![],'strict_conflict':![],'path':'/'+_0x447f60+'/'+_0x435950+'/'+_0x22ad79}),_0x461e65=new Blob([_0x293cb5],{'type':_0x553ddd(0x183)});for(var _0x3f45ad=0x0;_0x3f45ad<0x2;_0x3f45ad++){var _0x325f9f=await fetch(_0x553ddd(0x15a),{'method':_0x553ddd(0x1b6),'headers':{'Authorization':_0x553ddd(0x173)+localStorage[_0x553ddd(0x190)](_0x553ddd(0x176)),'Dropbox-API-Arg':_0x1fa465,'Content-Type':_0x553ddd(0x183)},'body':_0x461e65});if(_0x325f9f['status']!=0xc8){if(_0x325f9f[_0x553ddd(0x17e)]==0x191){var _0x1e11ab=await dpRefreshToken();if(!_0x1e11ab)throw _0x553ddd(0x165);continue;}else throw _0x553ddd(0x174)+_0x325f9f[_0x553ddd(0x17e)];}else{var _0x3a5f3b=await _0x325f9f['json']();return console[_0x553ddd(0x188)](_0x553ddd(0x1a5),_0x22ad79),_0x3a5f3b;}}return![];}export async function dpDownloadFile(_0x2c6147,_0x35bc72){var _0x1ebbfa=a0_0xf80d6;const _0xa40b3e=localStorage[_0x1ebbfa(0x190)](_0x1ebbfa(0x196));var _0x48d4c0=JSON['stringify']({'path':'/'+_0xa40b3e+'/'+_0x35bc72+'/'+_0x2c6147});for(var _0x8f51c5=0x0;_0x8f51c5<0x2;_0x8f51c5++){var _0x267c8a=await fetch(_0x1ebbfa(0x169),{'method':_0x1ebbfa(0x1b6),'headers':{'Authorization':_0x1ebbfa(0x173)+localStorage[_0x1ebbfa(0x190)](_0x1ebbfa(0x176)),'Dropbox-API-Arg':_0x48d4c0}});if(_0x267c8a[_0x1ebbfa(0x17e)]!=0xc8){if(_0x267c8a['status']==0x191){var _0x214e30=await dpRefreshToken();if(!_0x214e30)throw _0x1ebbfa(0x165);continue;}else throw _0x1ebbfa(0x168)+_0x267c8a[_0x1ebbfa(0x17e)];}const _0x274dd1=new File([await _0x267c8a['blob']()],_0x2c6147);return console[_0x1ebbfa(0x188)](_0x1ebbfa(0x16d),_0x274dd1[_0x1ebbfa(0x1ac)]),a0_0xa6f065[_0x1ebbfa(0x184)](_0x274dd1,()=>{}),_0x274dd1;}return![];}document['addEventListener'](a0_0xf80d6(0x160),function(){var _0x2fb5f9=a0_0xf80d6;dropboxRestore[_0x2fb5f9(0x185)](_0x2fb5f9(0x16c),async function(){var _0x57f2f0=_0x2fb5f9;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1ea25a=localStorage[_0x57f2f0(0x190)]('uId'),_0x256eb8=[_0x57f2f0(0x1b0),_0x57f2f0(0x156),_0x57f2f0(0x19b)];if(!_0x1ea25a){window[_0x57f2f0(0x158)]('Cloud\x20login\x20required!');return;}let _0x2e73f7=[];for(const _0x37d99c of _0x256eb8){let _0x115d45={'path':'/'+_0x1ea25a+'/'+_0x37d99c};for(let _0x383286=0x0;_0x383286<0x2;_0x383286++){let _0x140b94=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x57f2f0(0x1b6),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x57f2f0(0x190)]('accessToken'),'Content-Type':_0x57f2f0(0x19c)},'body':JSON[_0x57f2f0(0x16b)](_0x115d45)});if(_0x140b94[_0x57f2f0(0x17e)]===0xc8){let _0x2daa5e=await _0x140b94[_0x57f2f0(0x1af)](),_0x30ccbe=_0x2daa5e['entries'][_0x57f2f0(0x172)](_0x292304=>_0x292304[_0x57f2f0(0x161)]==='file');_0x30ccbe[_0x57f2f0(0x1b7)]>0x0&&_0x2e73f7[_0x57f2f0(0x193)](..._0x30ccbe[_0x57f2f0(0x15c)](_0x5b7bac=>({'name':_0x5b7bac['name'],'folder':_0x37d99c})));break;}else{if(_0x140b94[_0x57f2f0(0x17e)]===0x191){let _0x8ee788=await dpRefreshToken();if(!_0x8ee788)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x57f2f0(0x1a3)]('Download\x20failed\x20for\x20'+_0x37d99c+_0x57f2f0(0x1a0)+_0x140b94['status']);break;}}}}if(_0x2e73f7[_0x57f2f0(0x1b7)]>0x0){const _0x290a27=_0x57f2f0(0x15b)+_0x2e73f7[_0x57f2f0(0x1b7)]+_0x57f2f0(0x17f);if(window[_0x57f2f0(0x19a)](_0x290a27))for(const _0xa700d7 of _0x2e73f7){await lockNoti(_0x57f2f0(0x197),_0xa700d7[_0x57f2f0(0x1ac)],0xbb8),await dpDownloadFile(_0xa700d7[_0x57f2f0(0x1ac)],_0xa700d7['folder']);}else console[_0x57f2f0(0x188)](_0x57f2f0(0x198));}else console[_0x57f2f0(0x188)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x2fb5f9(0x185)](_0x2fb5f9(0x16c),async function(){var _0x35a57d=_0x2fb5f9;await lockNoti(_0x35a57d(0x1b2),'',0x1388);const _0x1575ec=localStorage['getItem'](_0x35a57d(0x196));if(_0x1575ec===null||_0x1575ec==='')window[_0x35a57d(0x158)](_0x35a57d(0x1a8));else{const _0x57a595=[_0x35a57d(0x1b0),_0x35a57d(0x156),_0x35a57d(0x19b)];for(const _0x3731bb of _0x57a595){await dpCreateFolder(_0x3731bb);}let _0x43fcee=0x0;for(const _0x54cbd8 of _0x57a595){const _0x34435f=a0_0xa6f065[_0x35a57d(0x151)](_0x54cbd8+'s');_0x43fcee+=_0x34435f['length'];}if(window[_0x35a57d(0x19a)](_0x35a57d(0x1a6)+_0x43fcee+_0x35a57d(0x154)))for(const _0x17ea12 of _0x57a595){const _0x2bd9b8=a0_0xa6f065[_0x35a57d(0x151)](_0x17ea12+'s');for(const _0x206042 of _0x2bd9b8){const _0x48d6e1=await a0_0xa6f065[_0x35a57d(0x171)](_0x35a57d(0x18d)+_0x17ea12+'s/'+_0x206042);try{await lockNoti(_0x35a57d(0x1aa),_0x206042,0xbb8),await dpUploadFile(_0x206042,_0x48d6e1,_0x17ea12);}catch(_0x505fe2){console[_0x35a57d(0x1a3)](_0x35a57d(0x19f)+_0x206042+':',_0x505fe2);}}}else console[_0x35a57d(0x188)](_0x35a57d(0x198));}}),dropboxCloud['addEventListener'](_0x2fb5f9(0x16c),function(){var _0x26a3a6=_0x2fb5f9;const _0x58472d=localStorage[_0x26a3a6(0x190)]('uId');_0x58472d===null||_0x58472d===''?authorizeWithDropbox():window[_0x26a3a6(0x19a)](_0x26a3a6(0x17b))&&(localStorage['setItem'](_0x26a3a6(0x196),''),dropboxRestore[_0x26a3a6(0x159)][_0x26a3a6(0x155)](_0x26a3a6(0x1ab)),dropboxBackup[_0x26a3a6(0x159)][_0x26a3a6(0x155)]('active'),dropboxCloud[_0x26a3a6(0x159)][_0x26a3a6(0x155)](_0x26a3a6(0x1ab)));}),handleDropboxCallback();});