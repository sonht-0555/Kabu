var a0_0x1094d0=a0_0x34b6;(function(_0x1d7b5a,_0x23c53c){var _0x4b17b3=a0_0x34b6,_0x5d7c44=_0x1d7b5a();while(!![]){try{var _0x2bd288=parseInt(_0x4b17b3(0x199))/0x1*(-parseInt(_0x4b17b3(0x14a))/0x2)+-parseInt(_0x4b17b3(0x197))/0x3+-parseInt(_0x4b17b3(0x19d))/0x4*(parseInt(_0x4b17b3(0x188))/0x5)+-parseInt(_0x4b17b3(0x170))/0x6+-parseInt(_0x4b17b3(0x17a))/0x7+parseInt(_0x4b17b3(0x17f))/0x8+parseInt(_0x4b17b3(0x1a4))/0x9;if(_0x2bd288===_0x23c53c)break;else _0x5d7c44['push'](_0x5d7c44['shift']());}catch(_0x238e3e){_0x5d7c44['push'](_0x5d7c44['shift']());}}}(a0_0x2da5,0xe42f0));function a0_0x2da5(){var _0x3db281=['split','state','application/json','confirm','&client_id=','json','&redirect_uri=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Backing\x20up...','.tag','responseText','code','Bearer\x20','No\x20files\x20found\x20to\x20restore.','Failed\x20to\x20refresh\x20Dropbox\x20token.','\x20files\x20in\x20Kabu?','Cloud\x20login\x20required!','Error\x20creating\x20folder\x20','exec','downloadFileInCloud','Cloud\x20↦\x20Kabu\x20storage\x20◆','[\x5c?&#]','Do\x20not\x20receive\x20authorization','Download\x20failed,\x20unknown\x20http\x20status:','Do\x20you\x20want\x20to\x20backup\x20','https://api.dropboxapi.com/2/files/list_folder','getItem','stringify','overwrite','https://api.dropboxapi.com/oauth2/token','knh3uz2mx2hp2eu','3047562xEyhTs','listFiles','accessToken','save','https://content.dropboxapi.com/2/files/download','remove','Folder\x20created','classList','authorization_code','Kabu\x20storage\x20↦\x20Cloud\x20◆','8493737rvXmrE','status','replace','click','addEventListener','12289112GVspdv','length','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Content-Type','Refreshing\x20token...','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','uId','setItem','alert','86895zUJpHI','open','code=','offline','setRequestHeader','location','error_description','refresh_token','https://content.dropboxapi.com/2/files/upload','search','uploadFileInCloud','entries','application/x-www-form-urlencoded','&grant_type=','file','3102213exBFUP','send','977147Ivpzny','access_token','active','filter','360XkMUFD','href','Wait\x20a\x20little\x20bit...','Unable\x20to\x20refresh\x20token','screenshot','POST','&token_access_type=','42256323EcQVmb','Restore\x20canceled\x20by\x20user.','log','Failed\x20to\x20upload\x20file\x20','https://api.dropboxapi.com/2/files/create_folder_v2','https://www.dropbox.com/oauth2/authorize?client_id=','parse','2mayTCd','name','error','refreshToken','Authorization\x20Code:','&client_secret=','uid'];a0_0x2da5=function(){return _0x3db281;};return a0_0x2da5();}import*as a0_0x3a463f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1094d0(0x16f),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x43235d=a0_0x1094d0,_0x3d9458=window[_0x43235d(0x18d)][_0x43235d(0x19e)][_0x43235d(0x151)]('?')[0x0],_0x3c910b=_0x43235d(0x15c),_0x3ab7e7=_0x43235d(0x18b),_0x3ba05d=_0x43235d(0x148)+clientId+'&response_type='+_0x3c910b+_0x43235d(0x1a3)+_0x3ab7e7+_0x43235d(0x157)+encodeURIComponent(_0x3d9458);window[_0x43235d(0x18d)]['href']=_0x3ba05d;}function a0_0x34b6(_0x162f2d,_0xae08a){var _0x2da5d7=a0_0x2da5();return a0_0x34b6=function(_0x34b6e8,_0x492c65){_0x34b6e8=_0x34b6e8-0x144;var _0x580ead=_0x2da5d7[_0x34b6e8];return _0x580ead;},a0_0x34b6(_0x162f2d,_0xae08a);}function handleDropboxCallback(){var _0x3a0dee=a0_0x1094d0,_0x2845f7=getUrlParameter('code');_0x2845f7?(getAccessToken(_0x2845f7),console['log'](_0x3a0dee(0x14e),_0x2845f7)):console['log'](_0x3a0dee(0x167));}function getUrlParameter(_0x7851ff){var _0x3c5db4=a0_0x1094d0;_0x7851ff=_0x7851ff[_0x3c5db4(0x17c)](/[\[]/,'\x5c[')[_0x3c5db4(0x17c)](/[\]]/,'\x5c]');var _0x4c909b=new RegExp(_0x3c5db4(0x166)+_0x7851ff+'=([^&#]*)'),_0x457527=_0x4c909b[_0x3c5db4(0x163)](location[_0x3c5db4(0x191)]);return _0x457527===null?'':decodeURIComponent(_0x457527[0x1][_0x3c5db4(0x17c)](/\+/g,'\x20'));}function getAccessToken(_0x282b9f){var _0x3e19d5=a0_0x1094d0,_0x26e0fc=_0x3e19d5(0x178),_0x17ce75=window[_0x3e19d5(0x18d)][_0x3e19d5(0x19e)][_0x3e19d5(0x151)]('?')[0x0],_0x8a74c2=new XMLHttpRequest();_0x8a74c2[_0x3e19d5(0x189)](_0x3e19d5(0x1a2),'https://api.dropbox.com/oauth2/token'),_0x8a74c2[_0x3e19d5(0x18c)](_0x3e19d5(0x182),_0x3e19d5(0x194)),_0x8a74c2['onload']=function(){var _0x11d556=_0x3e19d5;if(_0x8a74c2[_0x11d556(0x17b)]===0xc8){var _0x4c46c0=JSON[_0x11d556(0x149)](_0x8a74c2[_0x11d556(0x15b)]),_0x3f7b9d=_0x4c46c0[_0x11d556(0x19a)],_0x4896d8=_0x4c46c0[_0x11d556(0x18f)],_0xef896b=_0x4c46c0[_0x11d556(0x150)];localStorage['setItem'](_0x11d556(0x172),_0x3f7b9d),localStorage['setItem'](_0x11d556(0x14d),_0x4896d8),localStorage[_0x11d556(0x186)](_0x11d556(0x185),_0xef896b);}else console['log'](_0x11d556(0x184));},_0x8a74c2[_0x3e19d5(0x198)](_0x3e19d5(0x18a)+_0x282b9f+_0x3e19d5(0x195)+_0x26e0fc+_0x3e19d5(0x155)+clientId+_0x3e19d5(0x14f)+clientSecret+_0x3e19d5(0x157)+encodeURIComponent(_0x17ce75));}export async function dpCreateFolder(_0x1beac2){var _0xf0a380=a0_0x1094d0;const _0x463188=localStorage[_0xf0a380(0x16b)](_0xf0a380(0x185));let _0x37c83b=localStorage[_0xf0a380(0x16b)](_0xf0a380(0x172));const _0x4dfd1f='/'+_0x463188+'/'+_0x1beac2,_0x49da03=JSON[_0xf0a380(0x16c)]({'path':_0x4dfd1f,'autorename':![]});for(let _0x359d4b=0x0;_0x359d4b<0x2;_0x359d4b++){try{const _0xdfe56e=await fetch(_0xf0a380(0x147),{'method':_0xf0a380(0x1a2),'headers':{'Authorization':_0xf0a380(0x15d)+_0x37c83b,'Content-Type':_0xf0a380(0x153)},'body':_0x49da03});if(_0xdfe56e[_0xf0a380(0x17b)]===0x191){const _0x2fba53=await dpRefreshToken();if(!_0x2fba53)throw new Error('Unable\x20to\x20refresh\x20token');_0x37c83b=localStorage['getItem'](_0xf0a380(0x172));continue;}if(_0xdfe56e[_0xf0a380(0x17b)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x1beac2};if(!_0xdfe56e['ok'])throw new Error(_0xf0a380(0x162)+_0x1beac2);const _0x354246=await _0xdfe56e[_0xf0a380(0x156)]();return await lockNoti(_0xf0a380(0x176),'',0xbb8),_0x354246;}catch(_0x58657a){if(_0x359d4b===0x1)throw _0x58657a;}}return![];}export async function dpRefreshToken(){var _0x2af29b=a0_0x1094d0;if(!localStorage[_0x2af29b(0x16b)](_0x2af29b(0x14d)))throw'No\x20refresh\x20token';try{const _0x5b5b46=await fetch(_0x2af29b(0x16e),{'method':_0x2af29b(0x1a2),'headers':{'Content-Type':_0x2af29b(0x194)},'body':'refresh_token='+localStorage[_0x2af29b(0x16b)](_0x2af29b(0x14d))+_0x2af29b(0x181)}),_0xa1364c=await _0x5b5b46['json']();if(!_0xa1364c['error'])return localStorage[_0x2af29b(0x186)](_0x2af29b(0x172),_0xa1364c['access_token']),await lockNoti(_0x2af29b(0x183),'',0xbb8),await delay(0x3e8),!![];else alert(_0xa1364c[_0x2af29b(0x18e)]||_0x2af29b(0x15f));}catch(_0x262a9f){console[_0x2af29b(0x14c)]('Error\x20while\x20refreshing\x20token:',_0x262a9f);}return![];}export async function dpUploadFile(_0x21d54d,_0x5e2389,_0x55f2e0){var _0x47e15b=a0_0x1094d0;const _0x324ab9=localStorage['getItem'](_0x47e15b(0x185));var _0x24181b=JSON[_0x47e15b(0x16c)]({'autorename':!![],'mode':_0x47e15b(0x16d),'mute':!![],'strict_conflict':![],'path':'/'+_0x324ab9+'/'+_0x55f2e0+'/'+_0x21d54d}),_0x16148b=new Blob([_0x5e2389],{'type':'application/octet-stream'});for(var _0x20c62e=0x0;_0x20c62e<0x2;_0x20c62e++){var _0x11aa6a=await fetch(_0x47e15b(0x190),{'method':_0x47e15b(0x1a2),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x47e15b(0x16b)](_0x47e15b(0x172)),'Dropbox-API-Arg':_0x24181b,'Content-Type':'application/octet-stream'},'body':_0x16148b});if(_0x11aa6a[_0x47e15b(0x17b)]!=0xc8){if(_0x11aa6a[_0x47e15b(0x17b)]==0x191){var _0x539881=await dpRefreshToken();if(!_0x539881)throw _0x47e15b(0x1a0);continue;}else throw _0x47e15b(0x158)+_0x11aa6a[_0x47e15b(0x17b)];}else{var _0x2180f6=await _0x11aa6a[_0x47e15b(0x156)]();return console['log'](_0x47e15b(0x179),_0x21d54d),_0x2180f6;}}return![];}export async function dpDownloadFile(_0x584af7,_0x2ad5ee){var _0x5ab523=a0_0x1094d0;const _0x36d627=localStorage[_0x5ab523(0x16b)](_0x5ab523(0x185));var _0x996de3=JSON[_0x5ab523(0x16c)]({'path':'/'+_0x36d627+'/'+_0x2ad5ee+'/'+_0x584af7});for(var _0x5a7e18=0x0;_0x5a7e18<0x2;_0x5a7e18++){var _0x410e31=await fetch(_0x5ab523(0x174),{'method':_0x5ab523(0x1a2),'headers':{'Authorization':_0x5ab523(0x15d)+localStorage[_0x5ab523(0x16b)](_0x5ab523(0x172)),'Dropbox-API-Arg':_0x996de3}});if(_0x410e31[_0x5ab523(0x17b)]!=0xc8){if(_0x410e31[_0x5ab523(0x17b)]==0x191){var _0xea6fb3=await dpRefreshToken();if(!_0xea6fb3)throw _0x5ab523(0x1a0);continue;}else throw _0x5ab523(0x168)+_0x410e31[_0x5ab523(0x17b)];}const _0x30a745=new File([await _0x410e31['blob']()],_0x584af7);return console[_0x5ab523(0x145)](_0x5ab523(0x165),_0x30a745['name']),a0_0x3a463f[_0x5ab523(0x192)](_0x30a745,()=>{}),_0x30a745;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x458b38=a0_0x1094d0;dropboxRestore['addEventListener'](_0x458b38(0x17d),async function(){var _0x4c7016=_0x458b38;await lockNoti(_0x4c7016(0x19f),'',0x1388);const _0x3685e5=localStorage[_0x4c7016(0x16b)]('uId'),_0x16e3db=[_0x4c7016(0x152),_0x4c7016(0x173),'screenshot'];if(!_0x3685e5){window[_0x4c7016(0x187)](_0x4c7016(0x161));return;}let _0x97cd5=[];for(const _0x3cdd2d of _0x16e3db){let _0x508060={'path':'/'+_0x3685e5+'/'+_0x3cdd2d};for(let _0x30227e=0x0;_0x30227e<0x2;_0x30227e++){let _0x153e94=await fetch(_0x4c7016(0x16a),{'method':_0x4c7016(0x1a2),'headers':{'Authorization':_0x4c7016(0x15d)+localStorage[_0x4c7016(0x16b)](_0x4c7016(0x172)),'Content-Type':_0x4c7016(0x153)},'body':JSON[_0x4c7016(0x16c)](_0x508060)});if(_0x153e94[_0x4c7016(0x17b)]===0xc8){let _0x15fb64=await _0x153e94[_0x4c7016(0x156)](),_0x2d0b3e=_0x15fb64[_0x4c7016(0x193)][_0x4c7016(0x19c)](_0x221f9c=>_0x221f9c[_0x4c7016(0x15a)]===_0x4c7016(0x196));_0x2d0b3e[_0x4c7016(0x180)]>0x0&&_0x97cd5['push'](..._0x2d0b3e['map'](_0xa922b1=>({'name':_0xa922b1['name'],'folder':_0x3cdd2d})));break;}else{if(_0x153e94[_0x4c7016(0x17b)]===0x191){let _0x2cff32=await dpRefreshToken();if(!_0x2cff32)throw _0x4c7016(0x1a0);}else{console[_0x4c7016(0x14c)]('Download\x20failed\x20for\x20'+_0x3cdd2d+',\x20status:\x20'+_0x153e94[_0x4c7016(0x17b)]);break;}}}}if(_0x97cd5['length']>0x0){const _0x4223ad='Do\x20you\x20want\x20to\x20restore\x20'+_0x97cd5[_0x4c7016(0x180)]+'\x20files\x20from\x20Cloud?';if(window[_0x4c7016(0x154)](_0x4223ad))for(const _0x2123ef of _0x97cd5){await lockNoti('Restoring...',_0x2123ef[_0x4c7016(0x14b)],0xbb8),await dpDownloadFile(_0x2123ef[_0x4c7016(0x14b)],_0x2123ef['folder']);}else console[_0x4c7016(0x145)](_0x4c7016(0x144));}else console[_0x4c7016(0x145)](_0x4c7016(0x15e));}),dropboxBackup[_0x458b38(0x17e)](_0x458b38(0x17d),async function(){var _0x553662=_0x458b38;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x8461fb=localStorage[_0x553662(0x16b)](_0x553662(0x185));if(_0x8461fb===null||_0x8461fb==='')window['alert'](_0x553662(0x161));else{const _0x1ae339=[_0x553662(0x152),_0x553662(0x173),_0x553662(0x1a1)];for(const _0x214b58 of _0x1ae339){await dpCreateFolder(_0x214b58);}let _0x1984dd=0x0;for(const _0x3d29f9 of _0x1ae339){const _0x290a53=a0_0x3a463f[_0x553662(0x171)](_0x3d29f9+'s');_0x1984dd+=_0x290a53['length'];}if(window[_0x553662(0x154)](_0x553662(0x169)+_0x1984dd+_0x553662(0x160)))for(const _0x15ed46 of _0x1ae339){const _0x24f254=a0_0x3a463f[_0x553662(0x171)](_0x15ed46+'s');for(const _0x597183 of _0x24f254){const _0x3b0fd2=await a0_0x3a463f[_0x553662(0x164)]('/data/'+_0x15ed46+'s/'+_0x597183);try{await lockNoti(_0x553662(0x159),_0x597183,0xbb8),await dpUploadFile(_0x597183,_0x3b0fd2,_0x15ed46);}catch(_0x314378){console[_0x553662(0x14c)](_0x553662(0x146)+_0x597183+':',_0x314378);}}}else console[_0x553662(0x145)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x458b38(0x17e)](_0x458b38(0x17d),function(){var _0x4fbb66=_0x458b38;const _0x1cd9cd=localStorage[_0x4fbb66(0x16b)](_0x4fbb66(0x185));_0x1cd9cd===null||_0x1cd9cd===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x4fbb66(0x186)](_0x4fbb66(0x185),''),dropboxRestore[_0x4fbb66(0x177)][_0x4fbb66(0x175)](_0x4fbb66(0x19b)),dropboxBackup[_0x4fbb66(0x177)][_0x4fbb66(0x175)](_0x4fbb66(0x19b)),dropboxCloud[_0x4fbb66(0x177)][_0x4fbb66(0x175)](_0x4fbb66(0x19b)));}),handleDropboxCallback();});