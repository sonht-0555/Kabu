var a0_0x46748a=a0_0x381a;(function(_0x5a9547,_0x1a6e00){var _0x5d1b16=a0_0x381a,_0x2cbed6=_0x5a9547();while(!![]){try{var _0xc1db15=-parseInt(_0x5d1b16(0x11b))/0x1+-parseInt(_0x5d1b16(0xe7))/0x2*(parseInt(_0x5d1b16(0xef))/0x3)+parseInt(_0x5d1b16(0xe9))/0x4+parseInt(_0x5d1b16(0xfb))/0x5*(-parseInt(_0x5d1b16(0x137))/0x6)+parseInt(_0x5d1b16(0xde))/0x7*(parseInt(_0x5d1b16(0x133))/0x8)+-parseInt(_0x5d1b16(0x120))/0x9*(parseInt(_0x5d1b16(0xfd))/0xa)+parseInt(_0x5d1b16(0x122))/0xb;if(_0xc1db15===_0x1a6e00)break;else _0x2cbed6['push'](_0x2cbed6['shift']());}catch(_0x1b59b7){_0x2cbed6['push'](_0x2cbed6['shift']());}}}(a0_0x1beb,0xd2705));import*as a0_0x286ca0 from'./main.js';function a0_0x1beb(){var _0x5eaaea=['uploadFileInCloud','toUpperCase','access_token','log','Download\x20failed\x20for\x20','authorization_code','&redirect_uri=','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/oauth2/token','refresh_token','/data/','&response_type=','Folder\x20already\x20exists','setRequestHeader','refreshToken','application/octet-stream','application/x-www-form-urlencoded','folder','push','state','split','534136BZownX','\x20files\x20in\x20Kabu?','parse','https://content.dropboxapi.com/2/files/download','onload','313749CkbgGi','accessToken','25939210QiIdly','stringify','Restore\x20canceled\x20by\x20user.','screenshot','classList','setItem','overwrite','name','&grant_type=','error','https://api.dropbox.com/oauth2/token','alert','&client_id=','Authorization\x20Code:','save','uid','nwb3dnfh09rhs31','781896ezhFGs','Error\x20creating\x20folder\x20','click','getItem','49326ouAJPw','Failed\x20to\x20upload\x20file\x20','status','length','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','uId','Backing\x20up...','exec','Restoring...','Unable\x20to\x20refresh\x20token','Do\x20you\x20want\x20to\x20backup\x20','14fEDPMK','=([^&#]*)','search','json','error_description','code','downloadFileInCloud','Bearer\x20','Cloud\x20login\x20required!','2sEzOuO','replace','2454648VISjxk','Wait\x20a\x20little\x20bit...','Do\x20you\x20want\x20to\x20restore\x20','Download\x20failed,\x20unknown\x20http\x20status:','list','slice','549447FsiklP','No\x20files\x20found\x20to\x20restore.','No\x20refresh\x20token','href','Failed\x20to\x20refresh\x20Dropbox\x20token.','code=',',\x20status:\x20','addEventListener','POST','open','confirm','send','775uCkyIq','location','90cmqrRL','application/json','remove','Do\x20not\x20receive\x20authorization','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Error\x20while\x20refreshing\x20token:','Upload\x20failed,\x20unknown\x20http\x20status:\x20','charAt','.tag'];a0_0x1beb=function(){return _0x5eaaea;};return a0_0x1beb();}import{localStorageFile}from'./storage.js';function a0_0x381a(_0x19392c,_0x286e35){var _0x1beb94=a0_0x1beb();return a0_0x381a=function(_0x381aba,_0x43b84d){_0x381aba=_0x381aba-0xd5;var _0x4adf6f=_0x1beb94[_0x381aba];return _0x4adf6f;},a0_0x381a(_0x19392c,_0x286e35);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x46748a(0x132);function authorizeWithDropbox(){var _0x3825d8=a0_0x46748a,_0x2aaf4f=window[_0x3825d8(0xfc)][_0x3825d8(0xf2)][_0x3825d8(0x11a)]('?')[0x0],_0x29d0ac=_0x3825d8(0xe3),_0x424dd4='offline',_0x55d276='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x3825d8(0x111)+_0x29d0ac+'&token_access_type='+_0x424dd4+_0x3825d8(0x10c)+encodeURIComponent(_0x2aaf4f);window[_0x3825d8(0xfc)]['href']=_0x55d276;}function handleDropboxCallback(){var _0x3ce11a=a0_0x46748a,_0x15a9e4=getUrlParameter(_0x3ce11a(0xe3));_0x15a9e4?(getAccessToken(_0x15a9e4),console[_0x3ce11a(0x109)](_0x3ce11a(0x12f),_0x15a9e4)):console['log'](_0x3ce11a(0x100));}function getUrlParameter(_0x299bd2){var _0x7bc68=a0_0x46748a;_0x299bd2=_0x299bd2[_0x7bc68(0xe8)](/[\[]/,'\x5c[')[_0x7bc68(0xe8)](/[\]]/,'\x5c]');var _0x54e6ab=new RegExp('[\x5c?&#]'+_0x299bd2+_0x7bc68(0xdf)),_0x3fa84d=_0x54e6ab[_0x7bc68(0xda)](location[_0x7bc68(0xe0)]);return _0x3fa84d===null?'':decodeURIComponent(_0x3fa84d[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x50b0b8){var _0x2883cc=a0_0x46748a,_0x3b121e=_0x2883cc(0x10b),_0x29b73c=window[_0x2883cc(0xfc)]['href']['split']('?')[0x0],_0x185573=new XMLHttpRequest();_0x185573[_0x2883cc(0xf8)](_0x2883cc(0xf7),_0x2883cc(0x12c)),_0x185573[_0x2883cc(0x113)]('Content-Type',_0x2883cc(0x116)),_0x185573[_0x2883cc(0x11f)]=function(){var _0x4aa191=_0x2883cc;if(_0x185573[_0x4aa191(0xd5)]===0xc8){var _0x5cfd36=JSON[_0x4aa191(0x11d)](_0x185573['responseText']),_0x3fe7b9=_0x5cfd36[_0x4aa191(0x108)],_0x134c87=_0x5cfd36[_0x4aa191(0x10f)],_0x37ed27=_0x5cfd36[_0x4aa191(0x131)];localStorage[_0x4aa191(0x127)](_0x4aa191(0x121),_0x3fe7b9),localStorage[_0x4aa191(0x127)](_0x4aa191(0x114),_0x134c87),localStorage[_0x4aa191(0x127)](_0x4aa191(0xd8),_0x37ed27);}else console[_0x4aa191(0x109)](_0x4aa191(0x101));},_0x185573[_0x2883cc(0xfa)](_0x2883cc(0xf4)+_0x50b0b8+_0x2883cc(0x12a)+_0x3b121e+_0x2883cc(0x12e)+clientId+'&client_secret='+clientSecret+_0x2883cc(0x10c)+encodeURIComponent(_0x29b73c));}export async function dpCreateFolder(_0x4c75e7){var _0x3e4d10=a0_0x46748a;const _0x4cef98=localStorage[_0x3e4d10(0x136)](_0x3e4d10(0xd8));let _0x538b1d=localStorage['getItem'](_0x3e4d10(0x121));const _0x18f96f='/'+_0x4cef98+'/'+_0x4c75e7,_0x29580a=JSON[_0x3e4d10(0x123)]({'path':_0x18f96f,'autorename':![]});for(let _0x150cf3=0x0;_0x150cf3<0x2;_0x150cf3++){try{const _0x497e92=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x3e4d10(0xf7),'headers':{'Authorization':'Bearer\x20'+_0x538b1d,'Content-Type':_0x3e4d10(0xfe)},'body':_0x29580a});if(_0x497e92[_0x3e4d10(0xd5)]===0x191){const _0x472419=await dpRefreshToken();if(!_0x472419)throw new Error('Unable\x20to\x20refresh\x20token');_0x538b1d=localStorage[_0x3e4d10(0x136)](_0x3e4d10(0x121));continue;}if(_0x497e92[_0x3e4d10(0xd5)]===0x199)return{'message':_0x3e4d10(0x112),'path':_0x4c75e7};if(!_0x497e92['ok'])throw new Error(_0x3e4d10(0x134)+_0x4c75e7);const _0x2b955e=await _0x497e92[_0x3e4d10(0xe1)]();return await lockNoti('Folder\x20created','',0xbb8),_0x2b955e;}catch(_0x1833f8){if(_0x150cf3===0x1)throw _0x1833f8;}}return![];}export async function dpRefreshToken(){var _0x126100=a0_0x46748a;if(!localStorage[_0x126100(0x136)](_0x126100(0x114)))throw _0x126100(0xf1);try{const _0xa920bd=await fetch(_0x126100(0x10e),{'method':_0x126100(0xf7),'headers':{'Content-Type':_0x126100(0x116)},'body':'refresh_token='+localStorage[_0x126100(0x136)](_0x126100(0x114))+_0x126100(0xd7)}),_0x585e58=await _0xa920bd[_0x126100(0xe1)]();if(!_0x585e58[_0x126100(0x12b)])return localStorage[_0x126100(0x127)](_0x126100(0x121),_0x585e58['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x585e58[_0x126100(0xe2)]||_0x126100(0xf3));}catch(_0x2cebf7){console['error'](_0x126100(0x102),_0x2cebf7);}return![];}export async function dpUploadFile(_0x1f83a2,_0x53730e,_0x1d9eb7){var _0x32f8ab=a0_0x46748a;const _0x2f5e16=localStorage['getItem'](_0x32f8ab(0xd8));var _0x3409f3=JSON[_0x32f8ab(0x123)]({'autorename':!![],'mode':_0x32f8ab(0x128),'mute':!![],'strict_conflict':![],'path':'/'+_0x2f5e16+'/'+_0x1d9eb7+'/'+_0x1f83a2}),_0x4e44f9=new Blob([_0x53730e],{'type':_0x32f8ab(0x115)});for(var _0x158922=0x0;_0x158922<0x2;_0x158922++){var _0x3c8dce=await fetch(_0x32f8ab(0x10d),{'method':_0x32f8ab(0xf7),'headers':{'Authorization':_0x32f8ab(0xe5)+localStorage[_0x32f8ab(0x136)](_0x32f8ab(0x121)),'Dropbox-API-Arg':_0x3409f3,'Content-Type':_0x32f8ab(0x115)},'body':_0x4e44f9});if(_0x3c8dce[_0x32f8ab(0xd5)]!=0xc8){if(_0x3c8dce[_0x32f8ab(0xd5)]==0x191){var _0x4b2f08=await dpRefreshToken();if(!_0x4b2f08)throw _0x32f8ab(0xdc);continue;}else throw _0x32f8ab(0x103)+_0x3c8dce[_0x32f8ab(0xd5)];}else{var _0x44a286=await _0x3c8dce[_0x32f8ab(0xe1)]();return console[_0x32f8ab(0x109)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x1f83a2),_0x44a286;}}return![];}export async function dpDownloadFile(_0x1c446d,_0x5e256d){var _0x4cb58b=a0_0x46748a;const _0x21f901=localStorage[_0x4cb58b(0x136)](_0x4cb58b(0xd8));var _0x6e86c6=JSON[_0x4cb58b(0x123)]({'path':'/'+_0x21f901+'/'+_0x5e256d+'/'+_0x1c446d});for(var _0x339496=0x0;_0x339496<0x2;_0x339496++){var _0x6a61e6=await fetch(_0x4cb58b(0x11e),{'method':_0x4cb58b(0xf7),'headers':{'Authorization':_0x4cb58b(0xe5)+localStorage[_0x4cb58b(0x136)](_0x4cb58b(0x121)),'Dropbox-API-Arg':_0x6e86c6}});if(_0x6a61e6[_0x4cb58b(0xd5)]!=0xc8){if(_0x6a61e6[_0x4cb58b(0xd5)]==0x191){var _0xd13bc4=await dpRefreshToken();if(!_0xd13bc4)throw _0x4cb58b(0xdc);continue;}else throw _0x4cb58b(0xec)+_0x6a61e6[_0x4cb58b(0xd5)];}const _0x1046b8=new File([await _0x6a61e6['blob']()],_0x1c446d);return console[_0x4cb58b(0x109)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x1046b8[_0x4cb58b(0x129)]),a0_0x286ca0[_0x4cb58b(0x106)](_0x1046b8,()=>{}),_0x1046b8;}return![];}document[a0_0x46748a(0xf6)]('DOMContentLoaded',function(){var _0x4dec8f=a0_0x46748a;dropboxRestore[_0x4dec8f(0xf6)](_0x4dec8f(0x135),async function(){var _0xc27daa=_0x4dec8f;await lockNoti(_0xc27daa(0xea),'',0x1388);const _0x3edcb7=localStorage['getItem'](_0xc27daa(0xd8)),_0x2f84fc=['state',_0xc27daa(0x130),_0xc27daa(0x125)];if(!_0x3edcb7){window[_0xc27daa(0x12d)](_0xc27daa(0xe6));return;}let _0x4e8853=[];for(const _0x3a6e36 of _0x2f84fc){let _0x592614={'path':'/'+_0x3edcb7+'/'+_0x3a6e36};for(let _0x1d7a16=0x0;_0x1d7a16<0x2;_0x1d7a16++){let _0x1318cd=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0xc27daa(0xe5)+localStorage[_0xc27daa(0x136)](_0xc27daa(0x121)),'Content-Type':'application/json'},'body':JSON['stringify'](_0x592614)});if(_0x1318cd['status']===0xc8){let _0x1fd263=await _0x1318cd[_0xc27daa(0xe1)](),_0x58df49=_0x1fd263['entries']['filter'](_0x132b17=>_0x132b17[_0xc27daa(0x105)]==='file');_0x58df49[_0xc27daa(0xd6)]>0x0&&_0x4e8853[_0xc27daa(0x118)](..._0x58df49['map'](_0x4f3372=>({'name':_0x4f3372[_0xc27daa(0x129)],'folder':_0x3a6e36})));break;}else{if(_0x1318cd['status']===0x191){let _0x49da6d=await dpRefreshToken();if(!_0x49da6d)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0xc27daa(0x10a)+_0x3a6e36+_0xc27daa(0xf5)+_0x1318cd[_0xc27daa(0xd5)]);break;}}}}if(_0x4e8853[_0xc27daa(0xd6)]>0x0){const _0x22d816=_0xc27daa(0xeb)+_0x4e8853['length']+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x22d816))for(const _0x1fdfc6 of _0x4e8853){await lockNoti(_0xc27daa(0xdb),_0x1fdfc6[_0xc27daa(0x129)],0xbb8),await dpDownloadFile(_0x1fdfc6[_0xc27daa(0x129)],_0x1fdfc6[_0xc27daa(0x117)]);}else console['log'](_0xc27daa(0x124));}else console[_0xc27daa(0x109)](_0xc27daa(0xf0));}),dropboxBackup[_0x4dec8f(0xf6)](_0x4dec8f(0x135),async function(){var _0x48c5eb=_0x4dec8f;await lockNoti(_0x48c5eb(0xea),'',0x1388);const _0x2fc479=localStorage[_0x48c5eb(0x136)](_0x48c5eb(0xd8));if(_0x2fc479===null||_0x2fc479==='')window['alert'](_0x48c5eb(0xe6));else{const _0x118a93=[_0x48c5eb(0x119),_0x48c5eb(0x130),'screenshot'];for(const _0x313043 of _0x118a93){await dpCreateFolder(_0x313043);}let _0x4f527d=0x0;for(const _0x558854 of _0x118a93){const _0x5af07a=a0_0x286ca0[_0x48c5eb(0xed)+(_0x558854[_0x48c5eb(0x104)](0x0)[_0x48c5eb(0x107)]()+_0x558854[_0x48c5eb(0xee)](0x1))]();_0x4f527d+=_0x5af07a[_0x48c5eb(0xd6)];}if(window[_0x48c5eb(0xf9)](_0x48c5eb(0xdd)+_0x4f527d+_0x48c5eb(0x11c)))for(const _0x351a52 of _0x118a93){const _0x270477=a0_0x286ca0[_0x48c5eb(0xed)+(_0x351a52[_0x48c5eb(0x104)](0x0)['toUpperCase']()+_0x351a52[_0x48c5eb(0xee)](0x1))]();for(const _0x3a97e0 of _0x270477){const _0x263e63=await a0_0x286ca0[_0x48c5eb(0xe4)](_0x48c5eb(0x110)+_0x351a52+'s/'+_0x3a97e0);try{await lockNoti(_0x48c5eb(0xd9),_0x3a97e0,0xbb8),await dpUploadFile(_0x3a97e0,_0x263e63,_0x351a52);}catch(_0x3b12e4){console['error'](_0x48c5eb(0x138)+_0x3a97e0+':',_0x3b12e4);}}}else console[_0x48c5eb(0x109)](_0x48c5eb(0x124));}}),dropboxCloud[_0x4dec8f(0xf6)](_0x4dec8f(0x135),function(){var _0x551747=_0x4dec8f;const _0x11fee3=localStorage[_0x551747(0x136)](_0x551747(0xd8));_0x11fee3===null||_0x11fee3===''?authorizeWithDropbox():window[_0x551747(0xf9)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x551747(0x127)](_0x551747(0xd8),''),dropboxRestore[_0x551747(0x126)][_0x551747(0xff)]('active'),dropboxBackup['classList'][_0x551747(0xff)]('active'),dropboxCloud['classList'][_0x551747(0xff)]('active'));}),handleDropboxCallback();});