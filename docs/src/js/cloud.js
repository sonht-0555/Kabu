function a0_0xff04(_0x18f5f7,_0x531b73){var _0x5f3c72=a0_0x5f3c();return a0_0xff04=function(_0xff04bd,_0x4ada70){_0xff04bd=_0xff04bd-0xf3;var _0xf99589=_0x5f3c72[_0xff04bd];return _0xf99589;},a0_0xff04(_0x18f5f7,_0x531b73);}var a0_0x2f828d=a0_0xff04;(function(_0x3aabb4,_0x7a3c9b){var _0x5013d8=a0_0xff04,_0x3c08d8=_0x3aabb4();while(!![]){try{var _0x40cd2d=parseInt(_0x5013d8(0xf4))/0x1+-parseInt(_0x5013d8(0x142))/0x2+-parseInt(_0x5013d8(0x106))/0x3+parseInt(_0x5013d8(0x155))/0x4*(-parseInt(_0x5013d8(0x15d))/0x5)+-parseInt(_0x5013d8(0xfe))/0x6*(-parseInt(_0x5013d8(0x149))/0x7)+parseInt(_0x5013d8(0x11e))/0x8+-parseInt(_0x5013d8(0x143))/0x9;if(_0x40cd2d===_0x7a3c9b)break;else _0x3c08d8['push'](_0x3c08d8['shift']());}catch(_0x4ece0d){_0x3c08d8['push'](_0x3c08d8['shift']());}}}(a0_0x5f3c,0xde6b7));import*as a0_0x504808 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x2f828d(0x134);function authorizeWithDropbox(){var _0x6cd001=a0_0x2f828d,_0x19701c=window[_0x6cd001(0x153)]['href'][_0x6cd001(0x108)]('?')[0x0],_0x3db3aa=_0x6cd001(0x14f),_0x250422='offline',_0x140f54=_0x6cd001(0x145)+clientId+_0x6cd001(0x151)+_0x3db3aa+_0x6cd001(0x122)+_0x250422+_0x6cd001(0x137)+encodeURIComponent(_0x19701c);window[_0x6cd001(0x153)]['href']=_0x140f54;}function handleDropboxCallback(){var _0x2f4a75=a0_0x2f828d,_0x49c8c4=getUrlParameter(_0x2f4a75(0x14f));_0x49c8c4?(getAccessToken(_0x49c8c4),console['log'](_0x2f4a75(0x15a),_0x49c8c4)):console[_0x2f4a75(0x15b)](_0x2f4a75(0x13b));}function getUrlParameter(_0x396e91){var _0x369566=a0_0x2f828d;_0x396e91=_0x396e91[_0x369566(0x119)](/[\[]/,'\x5c[')[_0x369566(0x119)](/[\]]/,'\x5c]');var _0x5a2524=new RegExp(_0x369566(0xfc)+_0x396e91+'=([^&#]*)'),_0x166e1c=_0x5a2524[_0x369566(0xfa)](location[_0x369566(0x10a)]);return _0x166e1c===null?'':decodeURIComponent(_0x166e1c[0x1][_0x369566(0x119)](/\+/g,'\x20'));}function getAccessToken(_0x21abbf){var _0x4c29e7=a0_0x2f828d,_0x433fbf=_0x4c29e7(0x140),_0x5bb05b=window['location']['href'][_0x4c29e7(0x108)]('?')[0x0],_0x24405b=new XMLHttpRequest();_0x24405b['open']('POST',_0x4c29e7(0x132)),_0x24405b[_0x4c29e7(0x101)](_0x4c29e7(0x111),_0x4c29e7(0x127)),_0x24405b[_0x4c29e7(0x100)]=function(){var _0x2b485f=_0x4c29e7;if(_0x24405b['status']===0xc8){var _0x23f3ee=JSON[_0x2b485f(0x10d)](_0x24405b[_0x2b485f(0x14c)]),_0x5b9962=_0x23f3ee['access_token'],_0x1b54d4=_0x23f3ee[_0x2b485f(0x158)],_0x5e7584=_0x23f3ee[_0x2b485f(0x156)];localStorage[_0x2b485f(0x12d)]('accessToken',_0x5b9962),localStorage[_0x2b485f(0x12d)](_0x2b485f(0x117),_0x1b54d4),localStorage['setItem'](_0x2b485f(0x120),_0x5e7584);}else console[_0x2b485f(0x15b)](_0x2b485f(0x13f));},_0x24405b[_0x4c29e7(0x115)](_0x4c29e7(0x131)+_0x21abbf+_0x4c29e7(0x147)+_0x433fbf+'&client_id='+clientId+_0x4c29e7(0x11b)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5bb05b));}export async function dpCreateFolder(_0x3320e9){var _0x1877b9=a0_0x2f828d;const _0x374ccc=localStorage[_0x1877b9(0x112)](_0x1877b9(0x120));let _0x3a9078=localStorage[_0x1877b9(0x112)](_0x1877b9(0x12c));const _0x4db34e='/'+_0x374ccc+'/'+_0x3320e9,_0x55fd0a=JSON[_0x1877b9(0x102)]({'path':_0x4db34e,'autorename':![]});for(let _0x5da328=0x0;_0x5da328<0x2;_0x5da328++){try{const _0x4103b3=await fetch(_0x1877b9(0x152),{'method':'POST','headers':{'Authorization':_0x1877b9(0x10c)+_0x3a9078,'Content-Type':'application/json'},'body':_0x55fd0a});if(_0x4103b3[_0x1877b9(0x126)]===0x191){const _0x49c041=await dpRefreshToken();if(!_0x49c041)throw new Error(_0x1877b9(0x138));_0x3a9078=localStorage[_0x1877b9(0x112)]('accessToken');continue;}if(_0x4103b3['status']===0x199)return{'message':_0x1877b9(0x159),'path':_0x3320e9};if(!_0x4103b3['ok'])throw new Error(_0x1877b9(0x128)+_0x3320e9);const _0x3682f8=await _0x4103b3[_0x1877b9(0x13d)]();return await lockNoti(_0x1877b9(0x10f),'',0xbb8),_0x3682f8;}catch(_0x546f2a){if(_0x5da328===0x1)throw _0x546f2a;}}return![];}function a0_0x5f3c(){var _0x26004d=['https://api.dropbox.com/oauth2/token','folder','nwb3dnfh09rhs31','push','toUpperCase','&redirect_uri=','Unable\x20to\x20refresh\x20token','alert','FSSync','Do\x20not\x20receive\x20authorization','https://content.dropboxapi.com/2/files/upload','json','/data/','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','authorization_code','click','1601146NLHpkr','313992sXDVHJ','Do\x20you\x20want\x20to\x20backup\x20','https://www.dropbox.com/oauth2/authorize?client_id=','active','&grant_type=','No\x20files\x20found\x20to\x20restore.','14KOCtzv','addEventListener','No\x20refresh\x20token','responseText','Do\x20you\x20want\x20to\x20restore\x20','error_description','code','.tag','&response_type=','https://api.dropboxapi.com/2/files/create_folder_v2','location','list','4mgapLZ','uid','remove','refresh_token','Folder\x20already\x20exists','Authorization\x20Code:','log','error','8433895GzlYUd','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Refreshing\x20token...','1058587AQrUyo','state','save','Error\x20while\x20refreshing\x20token:','Wait\x20a\x20little\x20bit...','overwrite','exec','Cloud\x20↦\x20Kabu\x20storage\x20◆','[\x5c?&#]','classList','4379490ZuyoQl','\x20files\x20in\x20Kabu?','onload','setRequestHeader','stringify','screenshot',',\x20status:\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','872871EkdDmX','Kabu\x20storage\x20↦\x20Cloud\x20◆','split','POST','search','downloadFileInCloud','Bearer\x20','parse','charAt','Folder\x20created','DOMContentLoaded','Content-Type','getItem','Restore\x20canceled\x20by\x20user.','entries','send','length','refreshToken','map','replace','uploadFileInCloud','&client_secret=','name','confirm','9646488XDMrxo','Do\x20you\x20want\x20to\x20logout?','uId','Backing\x20up...','&token_access_type=','Cloud\x20login\x20required!','application/octet-stream','slice','status','application/x-www-form-urlencoded','Error\x20creating\x20folder\x20','application/json','Download\x20failed,\x20unknown\x20http\x20status:','file','accessToken','setItem','Restoring...','\x20files\x20from\x20Cloud?','filter','code='];a0_0x5f3c=function(){return _0x26004d;};return a0_0x5f3c();}export async function dpRefreshToken(){var _0x483ec2=a0_0x2f828d;if(!localStorage['getItem']('refreshToken'))throw _0x483ec2(0x14b);try{const _0x4a8a08=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x483ec2(0x109),'headers':{'Content-Type':_0x483ec2(0x127)},'body':'refresh_token='+localStorage[_0x483ec2(0x112)](_0x483ec2(0x117))+_0x483ec2(0x15e)}),_0x2f70b6=await _0x4a8a08[_0x483ec2(0x13d)]();if(!_0x2f70b6[_0x483ec2(0x15c)])return localStorage[_0x483ec2(0x12d)](_0x483ec2(0x12c),_0x2f70b6['access_token']),await lockNoti(_0x483ec2(0xf3),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2f70b6[_0x483ec2(0x14e)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x3777f0){console[_0x483ec2(0x15c)](_0x483ec2(0xf7),_0x3777f0);}return![];}export async function dpUploadFile(_0x262c23,_0x5eb74f,_0x1e7b7c){var _0x2186c4=a0_0x2f828d;const _0x272763=localStorage[_0x2186c4(0x112)](_0x2186c4(0x120));var _0x358395=JSON[_0x2186c4(0x102)]({'autorename':!![],'mode':_0x2186c4(0xf9),'mute':!![],'strict_conflict':![],'path':'/'+_0x272763+'/'+_0x1e7b7c+'/'+_0x262c23}),_0x48b2ee=new Blob([_0x5eb74f],{'type':_0x2186c4(0x124)});for(var _0x8d186f=0x0;_0x8d186f<0x2;_0x8d186f++){var _0x5d72ee=await fetch(_0x2186c4(0x13c),{'method':_0x2186c4(0x109),'headers':{'Authorization':_0x2186c4(0x10c)+localStorage[_0x2186c4(0x112)](_0x2186c4(0x12c)),'Dropbox-API-Arg':_0x358395,'Content-Type':'application/octet-stream'},'body':_0x48b2ee});if(_0x5d72ee[_0x2186c4(0x126)]!=0xc8){if(_0x5d72ee[_0x2186c4(0x126)]==0x191){var _0x2f8967=await dpRefreshToken();if(!_0x2f8967)throw _0x2186c4(0x138);continue;}else throw _0x2186c4(0x105)+_0x5d72ee[_0x2186c4(0x126)];}else{var _0x166fd7=await _0x5d72ee[_0x2186c4(0x13d)]();return console[_0x2186c4(0x15b)](_0x2186c4(0x107),_0x262c23),_0x166fd7;}}return![];}export async function dpDownloadFile(_0x2f3460,_0x5829f4){var _0x3cf7d6=a0_0x2f828d;const _0x470f6c=localStorage[_0x3cf7d6(0x112)]('uId');var _0x3e1c42=JSON[_0x3cf7d6(0x102)]({'path':'/'+_0x470f6c+'/'+_0x5829f4+'/'+_0x2f3460});for(var _0x518cea=0x0;_0x518cea<0x2;_0x518cea++){var _0xb9b571=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x3cf7d6(0x109),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3cf7d6(0x112)](_0x3cf7d6(0x12c)),'Dropbox-API-Arg':_0x3e1c42}});if(_0xb9b571[_0x3cf7d6(0x126)]!=0xc8){if(_0xb9b571[_0x3cf7d6(0x126)]==0x191){var _0x324db1=await dpRefreshToken();if(!_0x324db1)throw _0x3cf7d6(0x138);continue;}else throw _0x3cf7d6(0x12a)+_0xb9b571[_0x3cf7d6(0x126)];}const _0x5cfb50=new File([await _0xb9b571['blob']()],_0x2f3460);return console['log'](_0x3cf7d6(0xfb),_0x5cfb50[_0x3cf7d6(0x11c)]),a0_0x504808[_0x3cf7d6(0x11a)](_0x5cfb50,()=>{var _0x1ac564=_0x3cf7d6;localStorageFile(),Module[_0x1ac564(0x13a)]();}),_0x5cfb50;}return![];}document[a0_0x2f828d(0x14a)](a0_0x2f828d(0x110),function(){var _0x35ca24=a0_0x2f828d;dropboxRestore['addEventListener']('click',async function(){var _0x30a8ed=a0_0xff04;await lockNoti(_0x30a8ed(0xf8),'',0x1388);const _0x380c08=localStorage[_0x30a8ed(0x112)](_0x30a8ed(0x120)),_0x3bf3d7=[_0x30a8ed(0xf5),_0x30a8ed(0xf6),_0x30a8ed(0x103)];if(!_0x380c08){window[_0x30a8ed(0x139)](_0x30a8ed(0x123));return;}let _0x5aab0d=[];for(const _0x3ddfb4 of _0x3bf3d7){let _0x5916f5={'path':'/'+_0x380c08+'/'+_0x3ddfb4};for(let _0x28f4e4=0x0;_0x28f4e4<0x2;_0x28f4e4++){let _0xb082d7=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x30a8ed(0x109),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x30a8ed(0x112)](_0x30a8ed(0x12c)),'Content-Type':_0x30a8ed(0x129)},'body':JSON[_0x30a8ed(0x102)](_0x5916f5)});if(_0xb082d7[_0x30a8ed(0x126)]===0xc8){let _0x46d064=await _0xb082d7[_0x30a8ed(0x13d)](),_0x582723=_0x46d064[_0x30a8ed(0x114)][_0x30a8ed(0x130)](_0x585b74=>_0x585b74[_0x30a8ed(0x150)]===_0x30a8ed(0x12b));_0x582723[_0x30a8ed(0x116)]>0x0&&_0x5aab0d[_0x30a8ed(0x135)](..._0x582723[_0x30a8ed(0x118)](_0x162e63=>({'name':_0x162e63['name'],'folder':_0x3ddfb4})));break;}else{if(_0xb082d7[_0x30a8ed(0x126)]===0x191){let _0x1dd569=await dpRefreshToken();if(!_0x1dd569)throw _0x30a8ed(0x138);}else{console[_0x30a8ed(0x15c)]('Download\x20failed\x20for\x20'+_0x3ddfb4+_0x30a8ed(0x104)+_0xb082d7[_0x30a8ed(0x126)]);break;}}}}if(_0x5aab0d['length']>0x0){const _0x30e340=_0x30a8ed(0x14d)+_0x5aab0d[_0x30a8ed(0x116)]+_0x30a8ed(0x12f);if(window['confirm'](_0x30e340))for(const _0x485718 of _0x5aab0d){await lockNoti(_0x30a8ed(0x12e),_0x485718[_0x30a8ed(0x11c)],0xbb8),await dpDownloadFile(_0x485718['name'],_0x485718[_0x30a8ed(0x133)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x30a8ed(0x15b)](_0x30a8ed(0x148));}),dropboxBackup[_0x35ca24(0x14a)](_0x35ca24(0x141),async function(){var _0x37ee26=_0x35ca24;await lockNoti(_0x37ee26(0xf8),'',0x1388);const _0x22e9e0=localStorage[_0x37ee26(0x112)](_0x37ee26(0x120));if(_0x22e9e0===null||_0x22e9e0==='')window[_0x37ee26(0x139)](_0x37ee26(0x123));else{const _0x4c797a=[_0x37ee26(0xf5),_0x37ee26(0xf6),'screenshot'];for(const _0x26ca1a of _0x4c797a){await dpCreateFolder(_0x26ca1a);}let _0x3c1342=0x0;for(const _0x9637c of _0x4c797a){const _0x4dcd45=a0_0x504808[_0x37ee26(0x154)+(_0x9637c[_0x37ee26(0x10e)](0x0)['toUpperCase']()+_0x9637c[_0x37ee26(0x125)](0x1))]();_0x3c1342+=_0x4dcd45[_0x37ee26(0x116)];}if(window[_0x37ee26(0x11d)](_0x37ee26(0x144)+_0x3c1342+_0x37ee26(0xff)))for(const _0x30ebd3 of _0x4c797a){const _0x337b93=a0_0x504808[_0x37ee26(0x154)+(_0x30ebd3['charAt'](0x0)[_0x37ee26(0x136)]()+_0x30ebd3['slice'](0x1))]();for(const _0x3baf9e of _0x337b93){const _0x535f63=await a0_0x504808[_0x37ee26(0x10b)](_0x37ee26(0x13e)+_0x30ebd3+'s/'+_0x3baf9e);try{await lockNoti(_0x37ee26(0x121),_0x3baf9e,0xbb8),await dpUploadFile(_0x3baf9e,_0x535f63,_0x30ebd3);}catch(_0x5944f2){console[_0x37ee26(0x15c)]('Failed\x20to\x20upload\x20file\x20'+_0x3baf9e+':',_0x5944f2);}}}else console['log'](_0x37ee26(0x113));}}),dropboxCloud[_0x35ca24(0x14a)](_0x35ca24(0x141),function(){var _0x5ab12f=_0x35ca24;const _0x5702f4=localStorage[_0x5ab12f(0x112)]('uId');_0x5702f4===null||_0x5702f4===''?authorizeWithDropbox():window[_0x5ab12f(0x11d)](_0x5ab12f(0x11f))&&(localStorage[_0x5ab12f(0x12d)]('uId',''),dropboxRestore[_0x5ab12f(0xfd)][_0x5ab12f(0x157)](_0x5ab12f(0x146)),dropboxBackup[_0x5ab12f(0xfd)][_0x5ab12f(0x157)](_0x5ab12f(0x146)),dropboxCloud['classList'][_0x5ab12f(0x157)]('active'));}),handleDropboxCallback();});