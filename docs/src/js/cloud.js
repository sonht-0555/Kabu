function a0_0x4484(){var _0x59426a=['39268360xJMYBf',',\x20status:\x20','log','refresh_token','3399095buwXQo','&response_type=','application/octet-stream','Kabu\x20storage\x20↦\x20Cloud\x20◆','[\x5c?&#]','Error\x20creating\x20folder\x20','Cloud\x20login\x20required!','Failed\x20to\x20refresh\x20Dropbox\x20token.','Folder\x20created','2349fwyeON','refresh_token=','code=','Failed\x20to\x20upload\x20file\x20','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','location','Unable\x20to\x20refresh\x20token','uId','447574YuqgHD','folder','40600xVKALW','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Backing\x20up...','=([^&#]*)','blob','confirm','Download\x20failed\x20for\x20','click','listFiles','split','Bearer\x20','push','open','onload','2179634EPASOr','https://www.dropbox.com/oauth2/authorize?client_id=','https://api.dropboxapi.com/oauth2/token','status','alert','offline','refreshToken','application/x-www-form-urlencoded','https://content.dropboxapi.com/2/files/upload','\x20files\x20in\x20Kabu?','knh3uz2mx2hp2eu','No\x20refresh\x20token','overwrite','application/json','downloadFileInCloud','save','Do\x20you\x20want\x20to\x20logout?','nwb3dnfh09rhs31','No\x20files\x20found\x20to\x20restore.','&client_id=','Restore\x20canceled\x20by\x20user.','entries','code','stringify','Authorization\x20Code:','&client_secret=','5314521DBDGzd','error_description','accessToken','screenshot','uploadFileInCloud','4pjqQYE','setRequestHeader','/data/','active','Download\x20failed,\x20unknown\x20http\x20status:','addEventListener','&grant_type=','json','file','exec','&redirect_uri=','remove','filter','Do\x20you\x20want\x20to\x20restore\x20','https://api.dropbox.com/oauth2/token','error','length','Folder\x20already\x20exists','access_token','Do\x20you\x20want\x20to\x20backup\x20','setItem','Error\x20while\x20refreshing\x20token:','search','responseText','href','getItem','114wOyaRU','Wait\x20a\x20little\x20bit...','name','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/2/files/list_folder','https://api.dropboxapi.com/2/files/create_folder_v2','633283rmJAvU','Do\x20not\x20receive\x20authorization','POST','state','classList'];a0_0x4484=function(){return _0x59426a;};return a0_0x4484();}var a0_0x251fcb=a0_0x21d3;(function(_0x31e187,_0x30fcb5){var _0x27fdb6=a0_0x21d3,_0x523dd1=_0x31e187();while(!![]){try{var _0x4f2b6a=parseInt(_0x27fdb6(0x88))/0x1+-parseInt(_0x27fdb6(0x98))/0x2+-parseInt(_0x27fdb6(0xb2))/0x3*(-parseInt(_0x27fdb6(0xb7))/0x4)+parseInt(_0x27fdb6(0xe0))/0x5+parseInt(_0x27fdb6(0xd1))/0x6*(parseInt(_0x27fdb6(0xd7))/0x7)+parseInt(_0x27fdb6(0x8a))/0x8*(parseInt(_0x27fdb6(0xe9))/0x9)+-parseInt(_0x27fdb6(0xdc))/0xa;if(_0x4f2b6a===_0x30fcb5)break;else _0x523dd1['push'](_0x523dd1['shift']());}catch(_0x314363){_0x523dd1['push'](_0x523dd1['shift']());}}}(a0_0x4484,0xe2025));import*as a0_0x16a35d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x251fcb(0xa2),clientSecret=a0_0x251fcb(0xa9);function authorizeWithDropbox(){var _0x461015=a0_0x251fcb,_0x252446=window[_0x461015(0x85)][_0x461015(0xcf)][_0x461015(0x93)]('?')[0x0],_0x4abff3=_0x461015(0xae),_0x2fbe91=_0x461015(0x9d),_0x129064=_0x461015(0x99)+clientId+_0x461015(0xe1)+_0x4abff3+'&token_access_type='+_0x2fbe91+_0x461015(0xc1)+encodeURIComponent(_0x252446);window[_0x461015(0x85)]['href']=_0x129064;}function handleDropboxCallback(){var _0x37cfe8=a0_0x251fcb,_0xdeb2d7=getUrlParameter(_0x37cfe8(0xae));_0xdeb2d7?(getAccessToken(_0xdeb2d7),console[_0x37cfe8(0xde)](_0x37cfe8(0xb0),_0xdeb2d7)):console[_0x37cfe8(0xde)](_0x37cfe8(0xd8));}function getUrlParameter(_0x39dcb8){var _0xb59fcf=a0_0x251fcb;_0x39dcb8=_0x39dcb8['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x5eb3e1=new RegExp(_0xb59fcf(0xe4)+_0x39dcb8+_0xb59fcf(0x8d)),_0x51d3f2=_0x5eb3e1[_0xb59fcf(0xc0)](location[_0xb59fcf(0xcd)]);return _0x51d3f2===null?'':decodeURIComponent(_0x51d3f2[0x1]['replace'](/\+/g,'\x20'));}function a0_0x21d3(_0x2987a2,_0x54586c){var _0x448458=a0_0x4484();return a0_0x21d3=function(_0x21d3cf,_0x584c45){_0x21d3cf=_0x21d3cf-0x83;var _0x48e1d9=_0x448458[_0x21d3cf];return _0x48e1d9;},a0_0x21d3(_0x2987a2,_0x54586c);}function getAccessToken(_0x4125f8){var _0x30ed23=a0_0x251fcb,_0x2e0cf8='authorization_code',_0x2c5272=window[_0x30ed23(0x85)]['href'][_0x30ed23(0x93)]('?')[0x0],_0x250fd6=new XMLHttpRequest();_0x250fd6[_0x30ed23(0x96)](_0x30ed23(0xd9),_0x30ed23(0xc5)),_0x250fd6[_0x30ed23(0xb8)]('Content-Type','application/x-www-form-urlencoded'),_0x250fd6[_0x30ed23(0x97)]=function(){var _0x24e65f=_0x30ed23;if(_0x250fd6[_0x24e65f(0x9b)]===0xc8){var _0x53b2b3=JSON['parse'](_0x250fd6[_0x24e65f(0xce)]),_0x1054a5=_0x53b2b3[_0x24e65f(0xc9)],_0x2132ff=_0x53b2b3[_0x24e65f(0xdf)],_0x5565a0=_0x53b2b3['uid'];localStorage[_0x24e65f(0xcb)](_0x24e65f(0xb4),_0x1054a5),localStorage[_0x24e65f(0xcb)](_0x24e65f(0x9e),_0x2132ff),localStorage[_0x24e65f(0xcb)](_0x24e65f(0x87),_0x5565a0);}else console['log'](_0x24e65f(0x84));},_0x250fd6['send'](_0x30ed23(0xeb)+_0x4125f8+_0x30ed23(0xbd)+_0x2e0cf8+_0x30ed23(0xab)+clientId+_0x30ed23(0xb1)+clientSecret+_0x30ed23(0xc1)+encodeURIComponent(_0x2c5272));}export async function dpCreateFolder(_0x4d29ce){var _0x121a57=a0_0x251fcb;const _0x48ce24=localStorage[_0x121a57(0xd0)]('uId');let _0x28a564=localStorage[_0x121a57(0xd0)](_0x121a57(0xb4));const _0x55478f='/'+_0x48ce24+'/'+_0x4d29ce,_0x5a86ff=JSON[_0x121a57(0xaf)]({'path':_0x55478f,'autorename':![]});for(let _0x54987b=0x0;_0x54987b<0x2;_0x54987b++){try{const _0x4f2948=await fetch(_0x121a57(0xd6),{'method':_0x121a57(0xd9),'headers':{'Authorization':_0x121a57(0x94)+_0x28a564,'Content-Type':_0x121a57(0xa5)},'body':_0x5a86ff});if(_0x4f2948[_0x121a57(0x9b)]===0x191){const _0x35c289=await dpRefreshToken();if(!_0x35c289)throw new Error('Unable\x20to\x20refresh\x20token');_0x28a564=localStorage[_0x121a57(0xd0)](_0x121a57(0xb4));continue;}if(_0x4f2948[_0x121a57(0x9b)]===0x199)return{'message':_0x121a57(0xc8),'path':_0x4d29ce};if(!_0x4f2948['ok'])throw new Error(_0x121a57(0xe5)+_0x4d29ce);const _0xebbe42=await _0x4f2948[_0x121a57(0xbe)]();return await lockNoti(_0x121a57(0xe8),'',0xbb8),_0xebbe42;}catch(_0xd7305f){if(_0x54987b===0x1)throw _0xd7305f;}}return![];}export async function dpRefreshToken(){var _0x2001eb=a0_0x251fcb;if(!localStorage[_0x2001eb(0xd0)](_0x2001eb(0x9e)))throw _0x2001eb(0xa3);try{const _0x4efd72=await fetch(_0x2001eb(0x9a),{'method':'POST','headers':{'Content-Type':_0x2001eb(0x9f)},'body':_0x2001eb(0xea)+localStorage['getItem']('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x387ceb=await _0x4efd72[_0x2001eb(0xbe)]();if(!_0x387ceb[_0x2001eb(0xc6)])return localStorage[_0x2001eb(0xcb)]('accessToken',_0x387ceb[_0x2001eb(0xc9)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x387ceb[_0x2001eb(0xb3)]||_0x2001eb(0xe7));}catch(_0x3d5ece){console[_0x2001eb(0xc6)](_0x2001eb(0xcc),_0x3d5ece);}return![];}export async function dpUploadFile(_0x36315c,_0xc7da03,_0x3f29ac){var _0x449be2=a0_0x251fcb;const _0x27fa58=localStorage[_0x449be2(0xd0)]('uId');var _0x51bbd0=JSON[_0x449be2(0xaf)]({'autorename':!![],'mode':_0x449be2(0xa4),'mute':!![],'strict_conflict':![],'path':'/'+_0x27fa58+'/'+_0x3f29ac+'/'+_0x36315c}),_0x2adb26=new Blob([_0xc7da03],{'type':'application/octet-stream'});for(var _0x321376=0x0;_0x321376<0x2;_0x321376++){var _0x356292=await fetch(_0x449be2(0xa0),{'method':_0x449be2(0xd9),'headers':{'Authorization':_0x449be2(0x94)+localStorage[_0x449be2(0xd0)](_0x449be2(0xb4)),'Dropbox-API-Arg':_0x51bbd0,'Content-Type':_0x449be2(0xe2)},'body':_0x2adb26});if(_0x356292[_0x449be2(0x9b)]!=0xc8){if(_0x356292['status']==0x191){var _0x468fa3=await dpRefreshToken();if(!_0x468fa3)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x449be2(0x8b)+_0x356292['status'];}else{var _0x24bf2d=await _0x356292[_0x449be2(0xbe)]();return console[_0x449be2(0xde)](_0x449be2(0xe3),_0x36315c),_0x24bf2d;}}return![];}export async function dpDownloadFile(_0x1eea57,_0x5c486d){var _0x2ddaac=a0_0x251fcb;const _0xc0bc58=localStorage[_0x2ddaac(0xd0)](_0x2ddaac(0x87));var _0x1dd88a=JSON[_0x2ddaac(0xaf)]({'path':'/'+_0xc0bc58+'/'+_0x5c486d+'/'+_0x1eea57});for(var _0x2641a7=0x0;_0x2641a7<0x2;_0x2641a7++){var _0x1e5adf=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x2ddaac(0xd9),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x2ddaac(0xd0)](_0x2ddaac(0xb4)),'Dropbox-API-Arg':_0x1dd88a}});if(_0x1e5adf[_0x2ddaac(0x9b)]!=0xc8){if(_0x1e5adf['status']==0x191){var _0x3d89ca=await dpRefreshToken();if(!_0x3d89ca)throw _0x2ddaac(0x86);continue;}else throw _0x2ddaac(0xbb)+_0x1e5adf[_0x2ddaac(0x9b)];}const _0x4d00a7=new File([await _0x1e5adf[_0x2ddaac(0x8e)]()],_0x1eea57);return console[_0x2ddaac(0xde)](_0x2ddaac(0x83),_0x4d00a7[_0x2ddaac(0xd3)]),a0_0x16a35d[_0x2ddaac(0xb6)](_0x4d00a7,()=>{}),_0x4d00a7;}return![];}document[a0_0x251fcb(0xbc)]('DOMContentLoaded',function(){var _0x362b67=a0_0x251fcb;dropboxRestore['addEventListener'](_0x362b67(0x91),async function(){var _0x23ea93=_0x362b67;await lockNoti(_0x23ea93(0xd2),'',0x1388);const _0x175915=localStorage[_0x23ea93(0xd0)](_0x23ea93(0x87)),_0x55f139=[_0x23ea93(0xda),'save',_0x23ea93(0xb5)];if(!_0x175915){window['alert']('Cloud\x20login\x20required!');return;}let _0x3cf2c9=[];for(const _0x52b6c6 of _0x55f139){let _0x41c2d8={'path':'/'+_0x175915+'/'+_0x52b6c6};for(let _0x4d77b9=0x0;_0x4d77b9<0x2;_0x4d77b9++){let _0x23f6cb=await fetch(_0x23ea93(0xd5),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x23ea93(0xb4)),'Content-Type':_0x23ea93(0xa5)},'body':JSON[_0x23ea93(0xaf)](_0x41c2d8)});if(_0x23f6cb[_0x23ea93(0x9b)]===0xc8){let _0x111c00=await _0x23f6cb[_0x23ea93(0xbe)](),_0x120778=_0x111c00[_0x23ea93(0xad)][_0x23ea93(0xc3)](_0x2c70b3=>_0x2c70b3['.tag']===_0x23ea93(0xbf));_0x120778[_0x23ea93(0xc7)]>0x0&&_0x3cf2c9[_0x23ea93(0x95)](..._0x120778['map'](_0x467bb7=>({'name':_0x467bb7[_0x23ea93(0xd3)],'folder':_0x52b6c6})));break;}else{if(_0x23f6cb[_0x23ea93(0x9b)]===0x191){let _0xa31d21=await dpRefreshToken();if(!_0xa31d21)throw _0x23ea93(0x86);}else{console[_0x23ea93(0xc6)](_0x23ea93(0x90)+_0x52b6c6+_0x23ea93(0xdd)+_0x23f6cb[_0x23ea93(0x9b)]);break;}}}}if(_0x3cf2c9[_0x23ea93(0xc7)]>0x0){const _0x16df0a=_0x23ea93(0xc4)+_0x3cf2c9[_0x23ea93(0xc7)]+_0x23ea93(0xd4);if(window['confirm'](_0x16df0a))for(const _0x389cf3 of _0x3cf2c9){await lockNoti('Restoring...',_0x389cf3[_0x23ea93(0xd3)],0xbb8),await dpDownloadFile(_0x389cf3[_0x23ea93(0xd3)],_0x389cf3[_0x23ea93(0x89)]);}else console['log'](_0x23ea93(0xac));}else console['log'](_0x23ea93(0xaa));}),dropboxBackup[_0x362b67(0xbc)](_0x362b67(0x91),async function(){var _0xc0b689=_0x362b67;await lockNoti(_0xc0b689(0xd2),'',0x1388);const _0x16be9e=localStorage[_0xc0b689(0xd0)](_0xc0b689(0x87));if(_0x16be9e===null||_0x16be9e==='')window[_0xc0b689(0x9c)](_0xc0b689(0xe6));else{const _0x181f8f=[_0xc0b689(0xda),_0xc0b689(0xa7),_0xc0b689(0xb5)];for(const _0x7ad99c of _0x181f8f){await dpCreateFolder(_0x7ad99c);}let _0x3d4ac5=0x0;for(const _0x402342 of _0x181f8f){const _0x3bb2cc=a0_0x16a35d[_0xc0b689(0x92)](_0x402342+'s');_0x3d4ac5+=_0x3bb2cc[_0xc0b689(0xc7)];}if(window[_0xc0b689(0x8f)](_0xc0b689(0xca)+_0x3d4ac5+_0xc0b689(0xa1)))for(const _0x50ccbb of _0x181f8f){const _0x1217a8=a0_0x16a35d['listFiles'](_0x50ccbb+'s');for(const _0x4b7f3e of _0x1217a8){const _0x4c3fa4=await a0_0x16a35d[_0xc0b689(0xa6)](_0xc0b689(0xb9)+_0x50ccbb+'s/'+_0x4b7f3e);try{await lockNoti(_0xc0b689(0x8c),_0x4b7f3e,0xbb8),await dpUploadFile(_0x4b7f3e,_0x4c3fa4,_0x50ccbb);}catch(_0x1da3a6){console['error'](_0xc0b689(0xec)+_0x4b7f3e+':',_0x1da3a6);}}}else console[_0xc0b689(0xde)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x362b67(0xbc)](_0x362b67(0x91),function(){var _0x44e59c=_0x362b67;const _0x425952=localStorage[_0x44e59c(0xd0)](_0x44e59c(0x87));_0x425952===null||_0x425952===''?authorizeWithDropbox():window[_0x44e59c(0x8f)](_0x44e59c(0xa8))&&(localStorage['setItem'](_0x44e59c(0x87),''),dropboxRestore[_0x44e59c(0xdb)]['remove'](_0x44e59c(0xba)),dropboxBackup['classList'][_0x44e59c(0xc2)](_0x44e59c(0xba)),dropboxCloud[_0x44e59c(0xdb)][_0x44e59c(0xc2)](_0x44e59c(0xba)));}),handleDropboxCallback();});