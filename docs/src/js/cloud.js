var a0_0x1a009d=a0_0x54bc;(function(_0x15ae06,_0x5900df){var _0x3d8de1=a0_0x54bc,_0x4fbd15=_0x15ae06();while(!![]){try{var _0xcb1a0=-parseInt(_0x3d8de1(0x1a5))/0x1*(parseInt(_0x3d8de1(0x1c8))/0x2)+-parseInt(_0x3d8de1(0x188))/0x3+-parseInt(_0x3d8de1(0x18d))/0x4*(parseInt(_0x3d8de1(0x1cd))/0x5)+-parseInt(_0x3d8de1(0x1b8))/0x6+-parseInt(_0x3d8de1(0x196))/0x7*(-parseInt(_0x3d8de1(0x19a))/0x8)+parseInt(_0x3d8de1(0x179))/0x9+parseInt(_0x3d8de1(0x1b0))/0xa;if(_0xcb1a0===_0x5900df)break;else _0x4fbd15['push'](_0x4fbd15['shift']());}catch(_0x5acc7f){_0x4fbd15['push'](_0x4fbd15['shift']());}}}(a0_0x1555,0x87fa9));import*as a0_0x528b9e from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1a009d(0x1a1),clientSecret=a0_0x1a009d(0x174);function a0_0x54bc(_0x53146a,_0x29567c){var _0x155564=a0_0x1555();return a0_0x54bc=function(_0x54bcbb,_0x487fec){_0x54bcbb=_0x54bcbb-0x172;var _0xa76243=_0x155564[_0x54bcbb];return _0xa76243;},a0_0x54bc(_0x53146a,_0x29567c);}function authorizeWithDropbox(){var _0x20d04f=a0_0x1a009d,_0x49ba70=window[_0x20d04f(0x1ce)][_0x20d04f(0x1bc)][_0x20d04f(0x1c0)]('?')[0x0],_0x2fdc2e=_0x20d04f(0x17c),_0x4d0127='offline',_0x3c1639=_0x20d04f(0x1d0)+clientId+_0x20d04f(0x18f)+_0x2fdc2e+_0x20d04f(0x17e)+_0x4d0127+_0x20d04f(0x1b1)+encodeURIComponent(_0x49ba70);window[_0x20d04f(0x1ce)][_0x20d04f(0x1bc)]=_0x3c1639;}function handleDropboxCallback(){var _0x58556e=a0_0x1a009d,_0x53b804=getUrlParameter(_0x58556e(0x17c));_0x53b804?(getAccessToken(_0x53b804),console[_0x58556e(0x1b7)](_0x58556e(0x17b),_0x53b804)):console[_0x58556e(0x1b7)](_0x58556e(0x1c3));}function getUrlParameter(_0x51460f){var _0x2e6af3=a0_0x1a009d;_0x51460f=_0x51460f[_0x2e6af3(0x1cc)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x418afc=new RegExp(_0x2e6af3(0x182)+_0x51460f+_0x2e6af3(0x18b)),_0x428582=_0x418afc[_0x2e6af3(0x18e)](location[_0x2e6af3(0x187)]);return _0x428582===null?'':decodeURIComponent(_0x428582[0x1][_0x2e6af3(0x1cc)](/\+/g,'\x20'));}function getAccessToken(_0x4e06fa){var _0x53aca4=a0_0x1a009d,_0x5311ee=_0x53aca4(0x199),_0x109150=window[_0x53aca4(0x1ce)]['href'][_0x53aca4(0x1c0)]('?')[0x0],_0x3d6764=new XMLHttpRequest();_0x3d6764[_0x53aca4(0x1b9)](_0x53aca4(0x197),_0x53aca4(0x195)),_0x3d6764['setRequestHeader'](_0x53aca4(0x1a0),_0x53aca4(0x1b3)),_0x3d6764['onload']=function(){var _0x2dfca0=_0x53aca4;if(_0x3d6764[_0x2dfca0(0x186)]===0xc8){var _0x1b5b18=JSON['parse'](_0x3d6764[_0x2dfca0(0x1c9)]),_0x20e029=_0x1b5b18['access_token'],_0x310ada=_0x1b5b18[_0x2dfca0(0x1c6)],_0xa6a84e=_0x1b5b18['uid'];localStorage[_0x2dfca0(0x1c4)](_0x2dfca0(0x1ab),_0x20e029),localStorage[_0x2dfca0(0x1c4)](_0x2dfca0(0x180),_0x310ada),localStorage[_0x2dfca0(0x1c4)](_0x2dfca0(0x185),_0xa6a84e);}else console['log'](_0x2dfca0(0x18c));},_0x3d6764['send']('code='+_0x4e06fa+_0x53aca4(0x1ac)+_0x5311ee+'&client_id='+clientId+_0x53aca4(0x1ca)+clientSecret+_0x53aca4(0x1b1)+encodeURIComponent(_0x109150));}export async function dpCreateFolder(_0x578b8d){var _0x363201=a0_0x1a009d;const _0x4b6a57=localStorage['getItem'](_0x363201(0x185));let _0x70a50b=localStorage['getItem'](_0x363201(0x1ab));const _0x1e6de9='/'+_0x4b6a57+'/'+_0x578b8d,_0x2cee39=JSON[_0x363201(0x178)]({'path':_0x1e6de9,'autorename':![]});for(let _0x3569c4=0x0;_0x3569c4<0x2;_0x3569c4++){try{const _0x45137e=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x363201(0x197),'headers':{'Authorization':_0x363201(0x1cf)+_0x70a50b,'Content-Type':_0x363201(0x172)},'body':_0x2cee39});if(_0x45137e[_0x363201(0x186)]===0x191){const _0xc3dcd=await dpRefreshToken();if(!_0xc3dcd)throw new Error(_0x363201(0x17a));_0x70a50b=localStorage['getItem']('accessToken');continue;}if(_0x45137e[_0x363201(0x186)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x578b8d};if(!_0x45137e['ok'])throw new Error(_0x363201(0x19d)+_0x578b8d);const _0x3508cd=await _0x45137e['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x3508cd;}catch(_0x13730d){if(_0x3569c4===0x1)throw _0x13730d;}}return![];}export async function dpRefreshToken(){var _0x58182e=a0_0x1a009d;if(!localStorage[_0x58182e(0x17d)]('refreshToken'))throw _0x58182e(0x1aa);try{const _0x585e09=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x58182e(0x197),'headers':{'Content-Type':_0x58182e(0x1b3)},'body':_0x58182e(0x1ae)+localStorage['getItem'](_0x58182e(0x180))+_0x58182e(0x1b6)}),_0x219bd6=await _0x585e09[_0x58182e(0x1c7)]();if(!_0x219bd6['error'])return localStorage[_0x58182e(0x1c4)](_0x58182e(0x1ab),_0x219bd6[_0x58182e(0x1ad)]),await lockNoti(_0x58182e(0x1cb),'',0xbb8),await delay(0x3e8),!![];else alert(_0x219bd6[_0x58182e(0x1b5)]||_0x58182e(0x1be));}catch(_0xff6a87){console[_0x58182e(0x181)]('Error\x20while\x20refreshing\x20token:',_0xff6a87);}return![];}export async function dpUploadFile(_0x2eba6b,_0x3f1a2c,_0x489a8e){var _0x164953=a0_0x1a009d;const _0x25be7d=localStorage[_0x164953(0x17d)](_0x164953(0x185));var _0x57a53a=JSON[_0x164953(0x178)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x25be7d+'/'+_0x489a8e+'/'+_0x2eba6b}),_0x113bdd=new Blob([_0x3f1a2c],{'type':'application/octet-stream'});for(var _0x4b0fa0=0x0;_0x4b0fa0<0x2;_0x4b0fa0++){var _0x54321b=await fetch(_0x164953(0x194),{'method':_0x164953(0x197),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x164953(0x17d)](_0x164953(0x1ab)),'Dropbox-API-Arg':_0x57a53a,'Content-Type':_0x164953(0x1a8)},'body':_0x113bdd});if(_0x54321b[_0x164953(0x186)]!=0xc8){if(_0x54321b[_0x164953(0x186)]==0x191){var _0x3b18f2=await dpRefreshToken();if(!_0x3b18f2)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x164953(0x1c1)+_0x54321b[_0x164953(0x186)];}else{var _0x27b15d=await _0x54321b[_0x164953(0x1c7)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x2eba6b),_0x27b15d;}}return![];}export async function dpDownloadFile(_0x26f48b,_0x3e1bfa){var _0x506540=a0_0x1a009d;const _0x17e63e=localStorage[_0x506540(0x17d)](_0x506540(0x185));var _0x5091b8=JSON[_0x506540(0x178)]({'path':'/'+_0x17e63e+'/'+_0x3e1bfa+'/'+_0x26f48b});for(var _0x1e8ec5=0x0;_0x1e8ec5<0x2;_0x1e8ec5++){var _0x2776c9=await fetch(_0x506540(0x19e),{'method':'POST','headers':{'Authorization':_0x506540(0x1cf)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x5091b8}});if(_0x2776c9[_0x506540(0x186)]!=0xc8){if(_0x2776c9[_0x506540(0x186)]==0x191){var _0x20e03b=await dpRefreshToken();if(!_0x20e03b)throw _0x506540(0x17a);continue;}else throw _0x506540(0x19c)+_0x2776c9[_0x506540(0x186)];}const _0x16ef82=new File([await _0x2776c9['blob']()],_0x26f48b);return console[_0x506540(0x1b7)](_0x506540(0x1af),_0x16ef82[_0x506540(0x1a3)]),a0_0x528b9e[_0x506540(0x1a4)](_0x16ef82,()=>{}),_0x16ef82;}return![];}document[a0_0x1a009d(0x190)]('DOMContentLoaded',function(){var _0xa8934a=a0_0x1a009d;dropboxRestore[_0xa8934a(0x190)]('click',async function(){var _0x310023=_0xa8934a;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x22ebb2=localStorage[_0x310023(0x17d)]('uId'),_0x371019=[_0x310023(0x183),'save',_0x310023(0x19f)];if(!_0x22ebb2){window['alert'](_0x310023(0x189));return;}let _0x41840f=[];for(const _0x294643 of _0x371019){let _0x310c2b={'path':'/'+_0x22ebb2+'/'+_0x294643};for(let _0x5be1d1=0x0;_0x5be1d1<0x2;_0x5be1d1++){let _0x167309=await fetch(_0x310023(0x19b),{'method':_0x310023(0x197),'headers':{'Authorization':_0x310023(0x1cf)+localStorage[_0x310023(0x17d)](_0x310023(0x1ab)),'Content-Type':_0x310023(0x172)},'body':JSON[_0x310023(0x178)](_0x310c2b)});if(_0x167309[_0x310023(0x186)]===0xc8){let _0x3d3e9f=await _0x167309[_0x310023(0x1c7)](),_0x55519c=_0x3d3e9f[_0x310023(0x1a6)]['filter'](_0xef7c07=>_0xef7c07[_0x310023(0x173)]===_0x310023(0x1a9));_0x55519c['length']>0x0&&_0x41840f[_0x310023(0x184)](..._0x55519c[_0x310023(0x1c2)](_0x1dfcc1=>({'name':_0x1dfcc1['name'],'folder':_0x294643})));break;}else{if(_0x167309[_0x310023(0x186)]===0x191){let _0x346acd=await dpRefreshToken();if(!_0x346acd)throw _0x310023(0x17a);}else{console['error']('Download\x20failed\x20for\x20'+_0x294643+',\x20status:\x20'+_0x167309[_0x310023(0x186)]);break;}}}}if(_0x41840f[_0x310023(0x177)]>0x0){const _0x103730='Do\x20you\x20want\x20to\x20restore\x20'+_0x41840f['length']+'\x20files\x20from\x20Cloud?';if(window[_0x310023(0x1b4)](_0x103730))for(const _0x5eac19 of _0x41840f){await lockNoti(_0x310023(0x175),_0x5eac19[_0x310023(0x1a3)],0xbb8),await dpDownloadFile(_0x5eac19['name'],_0x5eac19[_0x310023(0x18a)]);}else console['log'](_0x310023(0x17f));}else console['log'](_0x310023(0x1c5));}),dropboxBackup[_0xa8934a(0x190)](_0xa8934a(0x193),async function(){var _0x43eb11=_0xa8934a;await lockNoti(_0x43eb11(0x1bd),'',0x1388);const _0x4a2eb8=localStorage[_0x43eb11(0x17d)](_0x43eb11(0x185));if(_0x4a2eb8===null||_0x4a2eb8==='')window['alert'](_0x43eb11(0x189));else{const _0x383cf0=['state',_0x43eb11(0x1ba),_0x43eb11(0x19f)];for(const _0x31ffd1 of _0x383cf0){await dpCreateFolder(_0x31ffd1);}let _0x408d4b=0x0;for(const _0x140f86 of _0x383cf0){const _0x4f9b39=a0_0x528b9e[_0x43eb11(0x176)](_0x140f86+'s');_0x408d4b+=_0x4f9b39[_0x43eb11(0x177)];}if(window['confirm'](_0x43eb11(0x1bb)+_0x408d4b+_0x43eb11(0x191)))for(const _0xc46e53 of _0x383cf0){const _0x3d7775=a0_0x528b9e[_0x43eb11(0x176)](_0xc46e53+'s');for(const _0x517855 of _0x3d7775){const _0x3b4248=await a0_0x528b9e['downloadFileInCloud'](_0x43eb11(0x198)+_0xc46e53+'s/'+_0x517855);try{await lockNoti(_0x43eb11(0x192),_0x517855,0xbb8),await dpUploadFile(_0x517855,_0x3b4248,_0xc46e53);}catch(_0x612546){console[_0x43eb11(0x181)](_0x43eb11(0x1a7)+_0x517855+':',_0x612546);}}}else console[_0x43eb11(0x1b7)](_0x43eb11(0x17f));}}),dropboxCloud[_0xa8934a(0x190)](_0xa8934a(0x193),function(){var _0x3f2448=_0xa8934a;const _0x5f13f3=localStorage[_0x3f2448(0x17d)](_0x3f2448(0x185));_0x5f13f3===null||_0x5f13f3===''?authorizeWithDropbox():window[_0x3f2448(0x1b4)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x3f2448(0x185),''),dropboxRestore[_0x3f2448(0x1bf)]['remove'](_0x3f2448(0x1b2)),dropboxBackup[_0x3f2448(0x1bf)][_0x3f2448(0x1a2)](_0x3f2448(0x1b2)),dropboxCloud[_0x3f2448(0x1bf)][_0x3f2448(0x1a2)](_0x3f2448(0x1b2)));}),handleDropboxCallback();});function a0_0x1555(){var _0x11b3cc=['active','application/x-www-form-urlencoded','confirm','error_description','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','log','5747280JVOciT','open','save','Do\x20you\x20want\x20to\x20backup\x20','href','Wait\x20a\x20little\x20bit...','Failed\x20to\x20refresh\x20Dropbox\x20token.','classList','split','Upload\x20failed,\x20unknown\x20http\x20status:\x20','map','Do\x20not\x20receive\x20authorization','setItem','No\x20files\x20found\x20to\x20restore.','refresh_token','json','559904PxMeJb','responseText','&client_secret=','Refreshing\x20token...','replace','20LceyEE','location','Bearer\x20','https://www.dropbox.com/oauth2/authorize?client_id=','application/json','.tag','nwb3dnfh09rhs31','Restoring...','listFiles','length','stringify','6531894eHQdDu','Unable\x20to\x20refresh\x20token','Authorization\x20Code:','code','getItem','&token_access_type=','Restore\x20canceled\x20by\x20user.','refreshToken','error','[\x5c?&#]','state','push','uId','status','search','127026JkeZLD','Cloud\x20login\x20required!','folder','=([^&#]*)','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','36524QKJCMh','exec','&response_type=','addEventListener','\x20files\x20in\x20Kabu?','Backing\x20up...','click','https://content.dropboxapi.com/2/files/upload','https://api.dropbox.com/oauth2/token','5962691yGKQsa','POST','/data/','authorization_code','8dzTgjE','https://api.dropboxapi.com/2/files/list_folder','Download\x20failed,\x20unknown\x20http\x20status:','Error\x20creating\x20folder\x20','https://content.dropboxapi.com/2/files/download','screenshot','Content-Type','knh3uz2mx2hp2eu','remove','name','uploadFileInCloud','1LODfzk','entries','Failed\x20to\x20upload\x20file\x20','application/octet-stream','file','No\x20refresh\x20token','accessToken','&grant_type=','access_token','refresh_token=','Cloud\x20↦\x20Kabu\x20storage\x20◆','2960880tAchEr','&redirect_uri='];a0_0x1555=function(){return _0x11b3cc;};return a0_0x1555();}