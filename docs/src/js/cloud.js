var a0_0x1b1b61=a0_0x1bcb;(function(_0x270b23,_0x37822a){var _0x5b912d=a0_0x1bcb,_0x3e8470=_0x270b23();while(!![]){try{var _0x4a98b2=-parseInt(_0x5b912d(0x1eb))/0x1*(parseInt(_0x5b912d(0x1fc))/0x2)+-parseInt(_0x5b912d(0x1e3))/0x3+-parseInt(_0x5b912d(0x222))/0x4*(parseInt(_0x5b912d(0x1fa))/0x5)+-parseInt(_0x5b912d(0x1e8))/0x6+parseInt(_0x5b912d(0x1e0))/0x7+parseInt(_0x5b912d(0x1c4))/0x8+parseInt(_0x5b912d(0x202))/0x9*(parseInt(_0x5b912d(0x1e9))/0xa);if(_0x4a98b2===_0x37822a)break;else _0x3e8470['push'](_0x3e8470['shift']());}catch(_0x29e7b2){_0x3e8470['push'](_0x3e8470['shift']());}}}(a0_0x5128,0x4997e));import*as a0_0x4d9e9b from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x1b1b61(0x1e7);function authorizeWithDropbox(){var _0x584b07=a0_0x1b1b61,_0x79e36e=window['location'][_0x584b07(0x1d0)][_0x584b07(0x1dc)]('?')[0x0],_0x3c35e6=_0x584b07(0x21d),_0x573f1c=_0x584b07(0x224),_0x4fdc8d=_0x584b07(0x1f7)+clientId+_0x584b07(0x1c6)+_0x3c35e6+'&token_access_type='+_0x573f1c+_0x584b07(0x220)+encodeURIComponent(_0x79e36e);window['location'][_0x584b07(0x1d0)]=_0x4fdc8d;}function handleDropboxCallback(){var _0x222423=a0_0x1b1b61,_0x5793ae=getUrlParameter(_0x222423(0x21d));_0x5793ae?(getAccessToken(_0x5793ae),console['log'](_0x222423(0x1c9),_0x5793ae)):console['log'](_0x222423(0x20a));}function a0_0x1bcb(_0x335f72,_0x352705){var _0x51282d=a0_0x5128();return a0_0x1bcb=function(_0x1bcb35,_0x2b7b1d){_0x1bcb35=_0x1bcb35-0x1c4;var _0x5f1597=_0x51282d[_0x1bcb35];return _0x5f1597;},a0_0x1bcb(_0x335f72,_0x352705);}function getUrlParameter(_0x314bb4){var _0x13ada3=a0_0x1b1b61;_0x314bb4=_0x314bb4['replace'](/[\[]/,'\x5c[')[_0x13ada3(0x217)](/[\]]/,'\x5c]');var _0xe4d4e=new RegExp('[\x5c?&#]'+_0x314bb4+'=([^&#]*)'),_0x351d5f=_0xe4d4e[_0x13ada3(0x1e5)](location['search']);return _0x351d5f===null?'':decodeURIComponent(_0x351d5f[0x1][_0x13ada3(0x217)](/\+/g,'\x20'));}function getAccessToken(_0x22b64c){var _0x99cc91=a0_0x1b1b61,_0x578eed=_0x99cc91(0x213),_0x426fdb=window[_0x99cc91(0x208)][_0x99cc91(0x1d0)][_0x99cc91(0x1dc)]('?')[0x0],_0x4b7dba=new XMLHttpRequest();_0x4b7dba[_0x99cc91(0x1d1)](_0x99cc91(0x1da),_0x99cc91(0x1d2)),_0x4b7dba[_0x99cc91(0x203)](_0x99cc91(0x1e6),_0x99cc91(0x20e)),_0x4b7dba[_0x99cc91(0x1d7)]=function(){var _0x3dc43f=_0x99cc91;if(_0x4b7dba['status']===0xc8){var _0x1a68b7=JSON[_0x3dc43f(0x1ed)](_0x4b7dba['responseText']),_0x5400f8=_0x1a68b7['access_token'],_0x49c005=_0x1a68b7['refresh_token'],_0x3a3b98=_0x1a68b7[_0x3dc43f(0x1e4)];localStorage['setItem']('accessToken',_0x5400f8),localStorage[_0x3dc43f(0x20b)](_0x3dc43f(0x1f5),_0x49c005),localStorage[_0x3dc43f(0x20b)]('uId',_0x3a3b98);}else console[_0x3dc43f(0x1c7)](_0x3dc43f(0x215));},_0x4b7dba['send'](_0x99cc91(0x201)+_0x22b64c+_0x99cc91(0x1df)+_0x578eed+'&client_id='+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x426fdb));}export async function dpCreateFolder(_0x67d2e9){var _0x21e9e8=a0_0x1b1b61;const _0x105286=localStorage[_0x21e9e8(0x1e1)](_0x21e9e8(0x210));let _0x3cc288=localStorage['getItem'](_0x21e9e8(0x1d3));const _0x316abc='/'+_0x105286+'/'+_0x67d2e9,_0x4ecb32=JSON[_0x21e9e8(0x1fb)]({'path':_0x316abc,'autorename':![]});for(let _0x1514f9=0x0;_0x1514f9<0x2;_0x1514f9++){try{const _0x6a5e2b=await fetch(_0x21e9e8(0x200),{'method':_0x21e9e8(0x1da),'headers':{'Authorization':_0x21e9e8(0x1ec)+_0x3cc288,'Content-Type':_0x21e9e8(0x1c5)},'body':_0x4ecb32});if(_0x6a5e2b[_0x21e9e8(0x1f0)]===0x191){const _0x4bc906=await dpRefreshToken();if(!_0x4bc906)throw new Error(_0x21e9e8(0x1f9));_0x3cc288=localStorage[_0x21e9e8(0x1e1)](_0x21e9e8(0x1d3));continue;}if(_0x6a5e2b['status']===0x199)return{'message':_0x21e9e8(0x21f),'path':_0x67d2e9};if(!_0x6a5e2b['ok'])throw new Error(_0x21e9e8(0x1dd)+_0x67d2e9);const _0x49086d=await _0x6a5e2b[_0x21e9e8(0x1d5)]();return await lockNoti(_0x21e9e8(0x1cd),'',0xbb8),_0x49086d;}catch(_0x146e13){if(_0x1514f9===0x1)throw _0x146e13;}}return![];}export async function dpRefreshToken(){var _0x2e0747=a0_0x1b1b61;if(!localStorage[_0x2e0747(0x1e1)](_0x2e0747(0x1f5)))throw _0x2e0747(0x209);try{const _0x8feed=await fetch(_0x2e0747(0x1d4),{'method':_0x2e0747(0x1da),'headers':{'Content-Type':_0x2e0747(0x20e)},'body':_0x2e0747(0x20f)+localStorage['getItem'](_0x2e0747(0x1f5))+_0x2e0747(0x1c8)}),_0x1e3a33=await _0x8feed[_0x2e0747(0x1d5)]();if(!_0x1e3a33[_0x2e0747(0x1e2)])return localStorage['setItem']('accessToken',_0x1e3a33[_0x2e0747(0x205)]),await lockNoti(_0x2e0747(0x1fe),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1e3a33[_0x2e0747(0x218)]||_0x2e0747(0x1f6));}catch(_0x1469eb){console['error'](_0x2e0747(0x207),_0x1469eb);}return![];}export async function dpUploadFile(_0x380c75,_0x2822e1,_0xfbbc18){var _0x483d23=a0_0x1b1b61;const _0x1587ce=localStorage[_0x483d23(0x1e1)](_0x483d23(0x210));var _0x69a353=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x1587ce+'/'+_0xfbbc18+'/'+_0x380c75}),_0x29fdd1=new Blob([_0x2822e1],{'type':_0x483d23(0x1ca)});for(var _0x49cad5=0x0;_0x49cad5<0x2;_0x49cad5++){var _0x455768=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x483d23(0x1da),'headers':{'Authorization':_0x483d23(0x1ec)+localStorage[_0x483d23(0x1e1)](_0x483d23(0x1d3)),'Dropbox-API-Arg':_0x69a353,'Content-Type':_0x483d23(0x1ca)},'body':_0x29fdd1});if(_0x455768['status']!=0xc8){if(_0x455768['status']==0x191){var _0x281ebd=await dpRefreshToken();if(!_0x281ebd)throw _0x483d23(0x1f9);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x455768[_0x483d23(0x1f0)];}else{var _0x2dee7d=await _0x455768[_0x483d23(0x1d5)]();return console['log'](_0x483d23(0x20d),_0x380c75),_0x2dee7d;}}return![];}function a0_0x5128(){var _0x198de9=['/data/','listFiles','status','Failed\x20to\x20upload\x20file\x20','remove','active','classList','refreshToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://www.dropbox.com/oauth2/authorize?client_id=','Download\x20failed\x20for\x20','Unable\x20to\x20refresh\x20token','5eNRhUR','stringify','2RLVkgl','addEventListener','Refreshing\x20token...','uploadFileInCloud','https://api.dropboxapi.com/2/files/create_folder_v2','code=','1511253EpjgeA','setRequestHeader','name','access_token','DOMContentLoaded','Error\x20while\x20refreshing\x20token:','location','No\x20refresh\x20token','Do\x20not\x20receive\x20authorization','setItem','map','Kabu\x20storage\x20↦\x20Cloud\x20◆','application/x-www-form-urlencoded','refresh_token=','uId','downloadFileInCloud','Cloud\x20login\x20required!','authorization_code','confirm','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','\x20files\x20in\x20Kabu?','replace','error_description','\x20files\x20from\x20Cloud?','https://content.dropboxapi.com/2/files/download','state','folder','code','Wait\x20a\x20little\x20bit...','Folder\x20already\x20exists','&redirect_uri=','Restoring...','574380wNxZBg','Do\x20you\x20want\x20to\x20backup\x20','offline','click','Cloud\x20↦\x20Kabu\x20storage\x20◆','Download\x20failed,\x20unknown\x20http\x20status:','4284632fsfeuf','application/json','&response_type=','log','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Authorization\x20Code:','application/octet-stream','Restore\x20canceled\x20by\x20user.','Do\x20you\x20want\x20to\x20logout?','Folder\x20created','alert','length','href','open','https://api.dropbox.com/oauth2/token','accessToken','https://api.dropboxapi.com/oauth2/token','json','push','onload','filter','Backing\x20up...','POST',',\x20status:\x20','split','Error\x20creating\x20folder\x20','blob','&grant_type=','2032282DArfZr','getItem','error','1556082KOVpJq','uid','exec','Content-Type','nwb3dnfh09rhs31','2327262lUcXFV','50cTpFWL','screenshot','313886BhGvKw','Bearer\x20','parse'];a0_0x5128=function(){return _0x198de9;};return a0_0x5128();}export async function dpDownloadFile(_0x5c6397,_0x2df907){var _0x3f1377=a0_0x1b1b61;const _0x46e725=localStorage[_0x3f1377(0x1e1)](_0x3f1377(0x210));var _0x45327e=JSON['stringify']({'path':'/'+_0x46e725+'/'+_0x2df907+'/'+_0x5c6397});for(var _0x579798=0x0;_0x579798<0x2;_0x579798++){var _0x17b19c=await fetch(_0x3f1377(0x21a),{'method':_0x3f1377(0x1da),'headers':{'Authorization':_0x3f1377(0x1ec)+localStorage[_0x3f1377(0x1e1)](_0x3f1377(0x1d3)),'Dropbox-API-Arg':_0x45327e}});if(_0x17b19c[_0x3f1377(0x1f0)]!=0xc8){if(_0x17b19c[_0x3f1377(0x1f0)]==0x191){var _0x36dd72=await dpRefreshToken();if(!_0x36dd72)throw _0x3f1377(0x1f9);continue;}else throw _0x3f1377(0x227)+_0x17b19c[_0x3f1377(0x1f0)];}const _0x51285f=new File([await _0x17b19c[_0x3f1377(0x1de)]()],_0x5c6397);return console[_0x3f1377(0x1c7)](_0x3f1377(0x226),_0x51285f[_0x3f1377(0x204)]),a0_0x4d9e9b[_0x3f1377(0x1ff)](_0x51285f,()=>{}),_0x51285f;}return![];}document[a0_0x1b1b61(0x1fd)](a0_0x1b1b61(0x206),function(){var _0x46dff1=a0_0x1b1b61;dropboxRestore[_0x46dff1(0x1fd)](_0x46dff1(0x225),async function(){var _0x5658cd=_0x46dff1;await lockNoti(_0x5658cd(0x21e),'',0x1388);const _0x3f3c29=localStorage[_0x5658cd(0x1e1)]('uId'),_0x57eddc=[_0x5658cd(0x21b),'save','screenshot'];if(!_0x3f3c29){window[_0x5658cd(0x1ce)](_0x5658cd(0x212));return;}let _0x52467f=[];for(const _0x1be31d of _0x57eddc){let _0x4ab466={'path':'/'+_0x3f3c29+'/'+_0x1be31d};for(let _0x142b1c=0x0;_0x142b1c<0x2;_0x142b1c++){let _0x5f8f8=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x5658cd(0x1da),'headers':{'Authorization':_0x5658cd(0x1ec)+localStorage[_0x5658cd(0x1e1)]('accessToken'),'Content-Type':_0x5658cd(0x1c5)},'body':JSON[_0x5658cd(0x1fb)](_0x4ab466)});if(_0x5f8f8[_0x5658cd(0x1f0)]===0xc8){let _0xd81f28=await _0x5f8f8[_0x5658cd(0x1d5)](),_0x2c9403=_0xd81f28['entries'][_0x5658cd(0x1d8)](_0x4c0e62=>_0x4c0e62['.tag']==='file');_0x2c9403['length']>0x0&&_0x52467f[_0x5658cd(0x1d6)](..._0x2c9403[_0x5658cd(0x20c)](_0x2ee68d=>({'name':_0x2ee68d[_0x5658cd(0x204)],'folder':_0x1be31d})));break;}else{if(_0x5f8f8[_0x5658cd(0x1f0)]===0x191){let _0x43fb12=await dpRefreshToken();if(!_0x43fb12)throw _0x5658cd(0x1f9);}else{console[_0x5658cd(0x1e2)](_0x5658cd(0x1f8)+_0x1be31d+_0x5658cd(0x1db)+_0x5f8f8[_0x5658cd(0x1f0)]);break;}}}}if(_0x52467f['length']>0x0){const _0x52f02b='Do\x20you\x20want\x20to\x20restore\x20'+_0x52467f['length']+_0x5658cd(0x219);if(window['confirm'](_0x52f02b))for(const _0x2ee409 of _0x52467f){await lockNoti(_0x5658cd(0x221),_0x2ee409[_0x5658cd(0x204)],0xbb8),await dpDownloadFile(_0x2ee409[_0x5658cd(0x204)],_0x2ee409[_0x5658cd(0x21c)]);}else console[_0x5658cd(0x1c7)](_0x5658cd(0x1cb));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x46dff1(0x225),async function(){var _0x4bd946=_0x46dff1;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x3aecbc=localStorage[_0x4bd946(0x1e1)]('uId');if(_0x3aecbc===null||_0x3aecbc==='')window['alert']('Cloud\x20login\x20required!');else{const _0x537013=[_0x4bd946(0x21b),'save',_0x4bd946(0x1ea)];for(const _0x46d08b of _0x537013){await dpCreateFolder(_0x46d08b);}let _0x575543=0x0;for(const _0x353bf7 of _0x537013){const _0x1013f2=a0_0x4d9e9b[_0x4bd946(0x1ef)](_0x353bf7+'s');_0x575543+=_0x1013f2[_0x4bd946(0x1cf)];}if(window[_0x4bd946(0x214)](_0x4bd946(0x223)+_0x575543+_0x4bd946(0x216)))for(const _0xc1be63 of _0x537013){const _0x53a5ec=a0_0x4d9e9b['listFiles'](_0xc1be63+'s');for(const _0x42d6a0 of _0x53a5ec){const _0x455f2c=await a0_0x4d9e9b[_0x4bd946(0x211)](_0x4bd946(0x1ee)+_0xc1be63+'s/'+_0x42d6a0);try{await lockNoti(_0x4bd946(0x1d9),_0x42d6a0,0xbb8),await dpUploadFile(_0x42d6a0,_0x455f2c,_0xc1be63);}catch(_0x13bd59){console['error'](_0x4bd946(0x1f1)+_0x42d6a0+':',_0x13bd59);}}}else console[_0x4bd946(0x1c7)](_0x4bd946(0x1cb));}}),dropboxCloud[_0x46dff1(0x1fd)](_0x46dff1(0x225),function(){var _0x3a013c=_0x46dff1;const _0x2d399b=localStorage['getItem']('uId');_0x2d399b===null||_0x2d399b===''?authorizeWithDropbox():window[_0x3a013c(0x214)](_0x3a013c(0x1cc))&&(localStorage[_0x3a013c(0x20b)](_0x3a013c(0x210),''),dropboxRestore['classList'][_0x3a013c(0x1f2)]('active'),dropboxBackup[_0x3a013c(0x1f4)]['remove'](_0x3a013c(0x1f3)),dropboxCloud[_0x3a013c(0x1f4)][_0x3a013c(0x1f2)](_0x3a013c(0x1f3)));}),handleDropboxCallback();});