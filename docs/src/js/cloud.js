var a0_0x53e01b=a0_0x3e45;(function(_0x406600,_0x58479a){var _0xf1a49b=a0_0x3e45,_0x368661=_0x406600();while(!![]){try{var _0x276979=-parseInt(_0xf1a49b(0x104))/0x1+-parseInt(_0xf1a49b(0x118))/0x2*(-parseInt(_0xf1a49b(0xf4))/0x3)+-parseInt(_0xf1a49b(0xf1))/0x4*(parseInt(_0xf1a49b(0xff))/0x5)+-parseInt(_0xf1a49b(0x117))/0x6*(-parseInt(_0xf1a49b(0x10f))/0x7)+parseInt(_0xf1a49b(0x12d))/0x8+parseInt(_0xf1a49b(0xf2))/0x9*(parseInt(_0xf1a49b(0x10e))/0xa)+-parseInt(_0xf1a49b(0x108))/0xb*(parseInt(_0xf1a49b(0xde))/0xc);if(_0x276979===_0x58479a)break;else _0x368661['push'](_0x368661['shift']());}catch(_0xe9c672){_0x368661['push'](_0x368661['shift']());}}}(a0_0x56df,0x97910));import*as a0_0x3c58e2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x53e01b(0xf7);function authorizeWithDropbox(){var _0x1667e1=a0_0x53e01b,_0x497032=window['location']['href'][_0x1667e1(0x11b)]('?')[0x0],_0x4339a7=_0x1667e1(0x10a),_0x1d40a2=_0x1667e1(0xf6),_0x2cee8f='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x1667e1(0xfa)+_0x4339a7+_0x1667e1(0x10d)+_0x1d40a2+_0x1667e1(0xe6)+encodeURIComponent(_0x497032);window[_0x1667e1(0x126)][_0x1667e1(0xec)]=_0x2cee8f;}function handleDropboxCallback(){var _0x4661a6=a0_0x53e01b,_0x2808ce=getUrlParameter('code');_0x2808ce?(getAccessToken(_0x2808ce),console['log']('Authorization\x20Code:',_0x2808ce)):console[_0x4661a6(0xf8)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x5b01e1){var _0x5f4489=a0_0x53e01b;_0x5b01e1=_0x5b01e1['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2fdb74=new RegExp(_0x5f4489(0xcc)+_0x5b01e1+_0x5f4489(0x10c)),_0x6d436b=_0x2fdb74[_0x5f4489(0x121)](location[_0x5f4489(0x101)]);return _0x6d436b===null?'':decodeURIComponent(_0x6d436b[0x1][_0x5f4489(0x11a)](/\+/g,'\x20'));}function a0_0x56df(){var _0x2eac5c=['\x20files\x20in\x20Kabu?','setRequestHeader','state','location','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Content-Type','code=','Failed\x20to\x20refresh\x20Dropbox\x20token.','Refreshing\x20token...','access_token','1334128vrHCUV','remove','https://api.dropboxapi.com/2/files/create_folder_v2','list','toUpperCase','getItem','stringify','send','refresh_token=','accessToken','https://content.dropboxapi.com/2/files/upload','[\x5c?&#]','downloadFileInCloud','charAt','Failed\x20to\x20upload\x20file\x20','authorization_code','application/json','Error\x20creating\x20folder\x20','screenshot','classList','overwrite','uid','Restoring...','Bearer\x20','No\x20refresh\x20token','file','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','alert','Download\x20failed,\x20unknown\x20http\x20status:','5196EGkEgA','open','Unable\x20to\x20refresh\x20token','refreshToken','error','click','Do\x20you\x20want\x20to\x20backup\x20','&grant_type=','&redirect_uri=','confirm','.tag','active','blob','length','href','json','Cloud\x20↦\x20Kabu\x20storage\x20◆','onload','application/octet-stream','8fEAjCV','9ktfXPA','https://api.dropboxapi.com/2/files/list_folder','60111yInyGl','POST','offline','nwb3dnfh09rhs31','log','status','&response_type=','https://api.dropboxapi.com/oauth2/token','Restore\x20canceled\x20by\x20user.','error_description','name','1410975LYrUgr','&client_id=','search','DOMContentLoaded','setItem','652596LcSKRJ','responseText','uploadFileInCloud','Do\x20you\x20want\x20to\x20restore\x20','21340SKgNuy','uId','code','save','=([^&#]*)','&token_access_type=','6082990MQKsLZ','70grOMlq','addEventListener','Cloud\x20login\x20required!','/data/','filter','Wait\x20a\x20little\x20bit...','Download\x20failed\x20for\x20','folder','648744XHEGtv','82EbRSIY','Folder\x20already\x20exists','replace','split','map','FSSync','application/x-www-form-urlencoded','entries','https://api.dropbox.com/oauth2/token','exec','Folder\x20created'];a0_0x56df=function(){return _0x2eac5c;};return a0_0x56df();}function getAccessToken(_0x62ac7a){var _0x1c1596=a0_0x53e01b,_0x4ba450=_0x1c1596(0xd0),_0x333d2d=window[_0x1c1596(0x126)]['href'][_0x1c1596(0x11b)]('?')[0x0],_0x442dde=new XMLHttpRequest();_0x442dde[_0x1c1596(0xdf)]('POST',_0x1c1596(0x120)),_0x442dde[_0x1c1596(0x124)](_0x1c1596(0x128),_0x1c1596(0x11e)),_0x442dde[_0x1c1596(0xef)]=function(){var _0x41596e=_0x1c1596;if(_0x442dde[_0x41596e(0xf9)]===0xc8){var _0x132eec=JSON['parse'](_0x442dde[_0x41596e(0x105)]),_0x418d76=_0x132eec[_0x41596e(0x12c)],_0x331476=_0x132eec['refresh_token'],_0x6f9134=_0x132eec[_0x41596e(0xd6)];localStorage[_0x41596e(0x103)](_0x41596e(0x136),_0x418d76),localStorage[_0x41596e(0x103)](_0x41596e(0xe1),_0x331476),localStorage[_0x41596e(0x103)](_0x41596e(0x109),_0x6f9134);}else console[_0x41596e(0xf8)](_0x41596e(0xdb));},_0x442dde[_0x1c1596(0x134)](_0x1c1596(0x129)+_0x62ac7a+_0x1c1596(0xe5)+_0x4ba450+_0x1c1596(0x100)+clientId+'&client_secret='+clientSecret+_0x1c1596(0xe6)+encodeURIComponent(_0x333d2d));}export async function dpCreateFolder(_0x507f12){var _0x25114a=a0_0x53e01b;const _0x2a37a3=localStorage[_0x25114a(0x132)]('uId');let _0x45f3a3=localStorage[_0x25114a(0x132)](_0x25114a(0x136));const _0xd30e68='/'+_0x2a37a3+'/'+_0x507f12,_0x468c08=JSON[_0x25114a(0x133)]({'path':_0xd30e68,'autorename':![]});for(let _0x4c4843=0x0;_0x4c4843<0x2;_0x4c4843++){try{const _0x2c188d=await fetch(_0x25114a(0x12f),{'method':_0x25114a(0xf5),'headers':{'Authorization':_0x25114a(0xd8)+_0x45f3a3,'Content-Type':_0x25114a(0xd1)},'body':_0x468c08});if(_0x2c188d[_0x25114a(0xf9)]===0x191){const _0xb55b51=await dpRefreshToken();if(!_0xb55b51)throw new Error(_0x25114a(0xe0));_0x45f3a3=localStorage[_0x25114a(0x132)](_0x25114a(0x136));continue;}if(_0x2c188d['status']===0x199)return{'message':_0x25114a(0x119),'path':_0x507f12};if(!_0x2c188d['ok'])throw new Error(_0x25114a(0xd2)+_0x507f12);const _0x32d819=await _0x2c188d[_0x25114a(0xed)]();return await lockNoti(_0x25114a(0x122),'',0xbb8),_0x32d819;}catch(_0x394d7d){if(_0x4c4843===0x1)throw _0x394d7d;}}return![];}function a0_0x3e45(_0x444b6e,_0x3d2fff){var _0x56dff3=a0_0x56df();return a0_0x3e45=function(_0x3e4530,_0x2c2a11){_0x3e4530=_0x3e4530-0xcb;var _0x358f98=_0x56dff3[_0x3e4530];return _0x358f98;},a0_0x3e45(_0x444b6e,_0x3d2fff);}export async function dpRefreshToken(){var _0x53896d=a0_0x53e01b;if(!localStorage['getItem'](_0x53896d(0xe1)))throw _0x53896d(0xd9);try{const _0x22d7de=await fetch(_0x53896d(0xfb),{'method':_0x53896d(0xf5),'headers':{'Content-Type':_0x53896d(0x11e)},'body':_0x53896d(0x135)+localStorage[_0x53896d(0x132)]('refreshToken')+_0x53896d(0x127)}),_0x56a7a2=await _0x22d7de['json']();if(!_0x56a7a2[_0x53896d(0xe2)])return localStorage[_0x53896d(0x103)](_0x53896d(0x136),_0x56a7a2[_0x53896d(0x12c)]),await lockNoti(_0x53896d(0x12b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x56a7a2[_0x53896d(0xfd)]||_0x53896d(0x12a));}catch(_0x5641bc){console[_0x53896d(0xe2)]('Error\x20while\x20refreshing\x20token:',_0x5641bc);}return![];}export async function dpUploadFile(_0x400bf3,_0xd431d1,_0x1b3f2a){var _0x3a6104=a0_0x53e01b;const _0x3be3cc=localStorage[_0x3a6104(0x132)](_0x3a6104(0x109));var _0x1d41b1=JSON['stringify']({'autorename':!![],'mode':_0x3a6104(0xd5),'mute':!![],'strict_conflict':![],'path':'/'+_0x3be3cc+'/'+_0x1b3f2a+'/'+_0x400bf3}),_0xde4c3d=new Blob([_0xd431d1],{'type':_0x3a6104(0xf0)});for(var _0xc958c9=0x0;_0xc958c9<0x2;_0xc958c9++){var _0x5c9134=await fetch(_0x3a6104(0xcb),{'method':_0x3a6104(0xf5),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3a6104(0x132)](_0x3a6104(0x136)),'Dropbox-API-Arg':_0x1d41b1,'Content-Type':'application/octet-stream'},'body':_0xde4c3d});if(_0x5c9134['status']!=0xc8){if(_0x5c9134[_0x3a6104(0xf9)]==0x191){var _0x41718c=await dpRefreshToken();if(!_0x41718c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x5c9134[_0x3a6104(0xf9)];}else{var _0x185213=await _0x5c9134[_0x3a6104(0xed)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x400bf3),_0x185213;}}return![];}export async function dpDownloadFile(_0x1d5c89,_0x427d4d){var _0xf269b6=a0_0x53e01b;const _0x506750=localStorage[_0xf269b6(0x132)]('uId');var _0x5cf505=JSON[_0xf269b6(0x133)]({'path':'/'+_0x506750+'/'+_0x427d4d+'/'+_0x1d5c89});for(var _0x362ed1=0x0;_0x362ed1<0x2;_0x362ed1++){var _0x2c3960=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0xf269b6(0xf5),'headers':{'Authorization':_0xf269b6(0xd8)+localStorage[_0xf269b6(0x132)](_0xf269b6(0x136)),'Dropbox-API-Arg':_0x5cf505}});if(_0x2c3960[_0xf269b6(0xf9)]!=0xc8){if(_0x2c3960[_0xf269b6(0xf9)]==0x191){var _0x5a0025=await dpRefreshToken();if(!_0x5a0025)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xf269b6(0xdd)+_0x2c3960['status'];}const _0x3cdc58=new File([await _0x2c3960[_0xf269b6(0xea)]()],_0x1d5c89);return console[_0xf269b6(0xf8)](_0xf269b6(0xee),_0x3cdc58[_0xf269b6(0xfe)]),a0_0x3c58e2[_0xf269b6(0x106)](_0x3cdc58,()=>{var _0x1ca2b3=_0xf269b6;localStorageFile(),Module[_0x1ca2b3(0x11d)]();}),_0x3cdc58;}return![];}document[a0_0x53e01b(0x110)](a0_0x53e01b(0x102),function(){var _0x502b62=a0_0x53e01b;dropboxRestore[_0x502b62(0x110)](_0x502b62(0xe3),async function(){var _0x54987e=_0x502b62;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x53e88c=localStorage['getItem'](_0x54987e(0x109)),_0x47a104=[_0x54987e(0x125),_0x54987e(0x10b),_0x54987e(0xd3)];if(!_0x53e88c){window[_0x54987e(0xdc)](_0x54987e(0x111));return;}let _0x100dff=[];for(const _0x1960bc of _0x47a104){let _0x380cd2={'path':'/'+_0x53e88c+'/'+_0x1960bc};for(let _0x10f102=0x0;_0x10f102<0x2;_0x10f102++){let _0x4a0dd9=await fetch(_0x54987e(0xf3),{'method':_0x54987e(0xf5),'headers':{'Authorization':_0x54987e(0xd8)+localStorage[_0x54987e(0x132)]('accessToken'),'Content-Type':_0x54987e(0xd1)},'body':JSON[_0x54987e(0x133)](_0x380cd2)});if(_0x4a0dd9[_0x54987e(0xf9)]===0xc8){let _0x2e050c=await _0x4a0dd9[_0x54987e(0xed)](),_0x927400=_0x2e050c[_0x54987e(0x11f)][_0x54987e(0x113)](_0x20438c=>_0x20438c[_0x54987e(0xe8)]===_0x54987e(0xda));_0x927400[_0x54987e(0xeb)]>0x0&&_0x100dff['push'](..._0x927400[_0x54987e(0x11c)](_0x25248=>({'name':_0x25248[_0x54987e(0xfe)],'folder':_0x1960bc})));break;}else{if(_0x4a0dd9[_0x54987e(0xf9)]===0x191){let _0x8bdc24=await dpRefreshToken();if(!_0x8bdc24)throw _0x54987e(0xe0);}else{console[_0x54987e(0xe2)](_0x54987e(0x115)+_0x1960bc+',\x20status:\x20'+_0x4a0dd9[_0x54987e(0xf9)]);break;}}}}if(_0x100dff[_0x54987e(0xeb)]>0x0){const _0x28acd6=_0x54987e(0x107)+_0x100dff[_0x54987e(0xeb)]+'\x20files\x20from\x20Cloud?';if(window[_0x54987e(0xe7)](_0x28acd6))for(const _0x4e930d of _0x100dff){await lockNoti(_0x54987e(0xd7),_0x4e930d[_0x54987e(0xfe)],0xbb8),await dpDownloadFile(_0x4e930d[_0x54987e(0xfe)],_0x4e930d[_0x54987e(0x116)]);}else console[_0x54987e(0xf8)](_0x54987e(0xfc));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x502b62(0x110)](_0x502b62(0xe3),async function(){var _0x3df174=_0x502b62;await lockNoti(_0x3df174(0x114),'',0x1388);const _0x43f300=localStorage[_0x3df174(0x132)]('uId');if(_0x43f300===null||_0x43f300==='')window[_0x3df174(0xdc)](_0x3df174(0x111));else{const _0x2740d7=[_0x3df174(0x125),_0x3df174(0x10b),'screenshot'];for(const _0x17e962 of _0x2740d7){await dpCreateFolder(_0x17e962);}let _0x9ec59e=0x0;for(const _0x14642e of _0x2740d7){const _0x55c519=a0_0x3c58e2[_0x3df174(0x130)+(_0x14642e['charAt'](0x0)[_0x3df174(0x131)]()+_0x14642e['slice'](0x1))]();_0x9ec59e+=_0x55c519[_0x3df174(0xeb)];}if(window['confirm'](_0x3df174(0xe4)+_0x9ec59e+_0x3df174(0x123)))for(const _0xcaea38 of _0x2740d7){const _0x11a5fe=a0_0x3c58e2[_0x3df174(0x130)+(_0xcaea38[_0x3df174(0xce)](0x0)[_0x3df174(0x131)]()+_0xcaea38['slice'](0x1))]();for(const _0x35cb34 of _0x11a5fe){const _0xe88db8=await a0_0x3c58e2[_0x3df174(0xcd)](_0x3df174(0x112)+_0xcaea38+'s/'+_0x35cb34);try{await lockNoti('Backing\x20up...',_0x35cb34,0xbb8),await dpUploadFile(_0x35cb34,_0xe88db8,_0xcaea38);}catch(_0x5023fe){console[_0x3df174(0xe2)](_0x3df174(0xcf)+_0x35cb34+':',_0x5023fe);}}}else console['log'](_0x3df174(0xfc));}}),dropboxCloud[_0x502b62(0x110)](_0x502b62(0xe3),function(){var _0x2de156=_0x502b62;const _0x57922a=localStorage[_0x2de156(0x132)](_0x2de156(0x109));_0x57922a===null||_0x57922a===''?authorizeWithDropbox():window[_0x2de156(0xe7)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x2de156(0x103)](_0x2de156(0x109),''),dropboxRestore[_0x2de156(0xd4)][_0x2de156(0x12e)]('active'),dropboxBackup['classList'][_0x2de156(0x12e)](_0x2de156(0xe9)),dropboxCloud[_0x2de156(0xd4)][_0x2de156(0x12e)](_0x2de156(0xe9)));}),handleDropboxCallback();});