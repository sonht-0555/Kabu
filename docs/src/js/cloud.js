var a0_0x425b66=a0_0x39be;(function(_0x301acf,_0x4690de){var _0x151313=a0_0x39be,_0x4ad3db=_0x301acf();while(!![]){try{var _0x404e91=-parseInt(_0x151313(0x17f))/0x1+-parseInt(_0x151313(0x15f))/0x2*(parseInt(_0x151313(0x199))/0x3)+-parseInt(_0x151313(0x147))/0x4*(-parseInt(_0x151313(0x14c))/0x5)+-parseInt(_0x151313(0x14d))/0x6*(-parseInt(_0x151313(0x198))/0x7)+-parseInt(_0x151313(0x177))/0x8*(-parseInt(_0x151313(0x18c))/0x9)+parseInt(_0x151313(0x1a6))/0xa+-parseInt(_0x151313(0x149))/0xb;if(_0x404e91===_0x4690de)break;else _0x4ad3db['push'](_0x4ad3db['shift']());}catch(_0xcc824){_0x4ad3db['push'](_0x4ad3db['shift']());}}}(a0_0x1d01,0xaed05));import*as a0_0x47b30d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x425b66(0x152),clientSecret=a0_0x425b66(0x187);function authorizeWithDropbox(){var _0x29b29f=a0_0x425b66,_0x4d3a0f=window[_0x29b29f(0x193)][_0x29b29f(0x1a1)][_0x29b29f(0x16a)]('?')[0x0],_0x51a039=_0x29b29f(0x14f),_0x4a3e83=_0x29b29f(0x174),_0x2d0d06=_0x29b29f(0x14e)+clientId+_0x29b29f(0x19f)+_0x51a039+_0x29b29f(0x18d)+_0x4a3e83+_0x29b29f(0x145)+encodeURIComponent(_0x4d3a0f);window[_0x29b29f(0x193)][_0x29b29f(0x1a1)]=_0x2d0d06;}function handleDropboxCallback(){var _0x5557f3=a0_0x425b66,_0x6762b8=getUrlParameter('code');_0x6762b8?(getAccessToken(_0x6762b8),console[_0x5557f3(0x142)](_0x5557f3(0x191),_0x6762b8)):console[_0x5557f3(0x142)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x105d2d){var _0x1a0220=a0_0x425b66;_0x105d2d=_0x105d2d[_0x1a0220(0x17b)](/[\[]/,'\x5c[')[_0x1a0220(0x17b)](/[\]]/,'\x5c]');var _0x540ed6=new RegExp(_0x1a0220(0x19a)+_0x105d2d+_0x1a0220(0x16d)),_0x168ac4=_0x540ed6['exec'](location[_0x1a0220(0x160)]);return _0x168ac4===null?'':decodeURIComponent(_0x168ac4[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x21dffb){var _0x1227f7=a0_0x425b66,_0x4d50a1=_0x1227f7(0x1a7),_0x2b3ee3=window[_0x1227f7(0x193)][_0x1227f7(0x1a1)][_0x1227f7(0x16a)]('?')[0x0],_0x762c1f=new XMLHttpRequest();_0x762c1f[_0x1227f7(0x161)](_0x1227f7(0x17e),_0x1227f7(0x148)),_0x762c1f[_0x1227f7(0x18e)](_0x1227f7(0x170),_0x1227f7(0x150)),_0x762c1f[_0x1227f7(0x15e)]=function(){var _0x5ebe41=_0x1227f7;if(_0x762c1f[_0x5ebe41(0x173)]===0xc8){var _0x6a2fee=JSON[_0x5ebe41(0x181)](_0x762c1f['responseText']),_0x2264c8=_0x6a2fee[_0x5ebe41(0x1a3)],_0xb2ac70=_0x6a2fee[_0x5ebe41(0x179)],_0x224c61=_0x6a2fee['uid'];localStorage['setItem'](_0x5ebe41(0x168),_0x2264c8),localStorage[_0x5ebe41(0x195)](_0x5ebe41(0x151),_0xb2ac70),localStorage['setItem'](_0x5ebe41(0x14b),_0x224c61);}else console[_0x5ebe41(0x142)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x762c1f[_0x1227f7(0x166)](_0x1227f7(0x155)+_0x21dffb+_0x1227f7(0x143)+_0x4d50a1+_0x1227f7(0x158)+clientId+_0x1227f7(0x1a2)+clientSecret+_0x1227f7(0x145)+encodeURIComponent(_0x2b3ee3));}function a0_0x39be(_0x248fdf,_0x61edbf){var _0x1d0125=a0_0x1d01();return a0_0x39be=function(_0x39bea5,_0x155e60){_0x39bea5=_0x39bea5-0x141;var _0xb4eef4=_0x1d0125[_0x39bea5];return _0xb4eef4;},a0_0x39be(_0x248fdf,_0x61edbf);}export async function dpCreateFolder(_0x3ade30){var _0x5f0bb3=a0_0x425b66;const _0x4e01f6=localStorage[_0x5f0bb3(0x153)]('uId');let _0x2e6d80=localStorage[_0x5f0bb3(0x153)](_0x5f0bb3(0x168));const _0x5c1f17='/'+_0x4e01f6+'/'+_0x3ade30,_0x595bfc=JSON[_0x5f0bb3(0x17d)]({'path':_0x5c1f17,'autorename':![]});for(let _0x1eee8a=0x0;_0x1eee8a<0x2;_0x1eee8a++){try{const _0x18751e=await fetch(_0x5f0bb3(0x162),{'method':_0x5f0bb3(0x17e),'headers':{'Authorization':_0x5f0bb3(0x14a)+_0x2e6d80,'Content-Type':_0x5f0bb3(0x19c)},'body':_0x595bfc});if(_0x18751e[_0x5f0bb3(0x173)]===0x191){const _0x1bf042=await dpRefreshToken();if(!_0x1bf042)throw new Error(_0x5f0bb3(0x17c));_0x2e6d80=localStorage[_0x5f0bb3(0x153)](_0x5f0bb3(0x168));continue;}if(_0x18751e['status']===0x199)return{'message':_0x5f0bb3(0x1a8),'path':_0x3ade30};if(!_0x18751e['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x3ade30);const _0x2b1154=await _0x18751e[_0x5f0bb3(0x16c)]();return await lockNoti(_0x5f0bb3(0x167),'',0xbb8),_0x2b1154;}catch(_0x16eaee){if(_0x1eee8a===0x1)throw _0x16eaee;}}return![];}export async function dpRefreshToken(){var _0x213c85=a0_0x425b66;if(!localStorage[_0x213c85(0x153)](_0x213c85(0x151)))throw _0x213c85(0x154);try{const _0x72b946=await fetch(_0x213c85(0x15b),{'method':_0x213c85(0x17e),'headers':{'Content-Type':_0x213c85(0x150)},'body':_0x213c85(0x19d)+localStorage[_0x213c85(0x153)](_0x213c85(0x151))+_0x213c85(0x190)}),_0x56e72c=await _0x72b946[_0x213c85(0x16c)]();if(!_0x56e72c[_0x213c85(0x189)])return localStorage['setItem'](_0x213c85(0x168),_0x56e72c['access_token']),await lockNoti(_0x213c85(0x15c),'',0xbb8),await delay(0x3e8),!![];else alert(_0x56e72c['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x52ccc9){console[_0x213c85(0x189)](_0x213c85(0x141),_0x52ccc9);}return![];}export async function dpUploadFile(_0x3c1c09,_0x143de0,_0x13e7bb){var _0xf21a50=a0_0x425b66;const _0x473ef7=localStorage[_0xf21a50(0x153)](_0xf21a50(0x14b));var _0x1e5779=JSON[_0xf21a50(0x17d)]({'autorename':!![],'mode':_0xf21a50(0x192),'mute':!![],'strict_conflict':![],'path':'/'+_0x473ef7+'/'+_0x13e7bb+'/'+_0x3c1c09}),_0x2ce8f3=new Blob([_0x143de0],{'type':_0xf21a50(0x178)});for(var _0xd0278b=0x0;_0xd0278b<0x2;_0xd0278b++){var _0xb551cc=await fetch(_0xf21a50(0x197),{'method':'POST','headers':{'Authorization':_0xf21a50(0x14a)+localStorage[_0xf21a50(0x153)](_0xf21a50(0x168)),'Dropbox-API-Arg':_0x1e5779,'Content-Type':_0xf21a50(0x178)},'body':_0x2ce8f3});if(_0xb551cc['status']!=0xc8){if(_0xb551cc[_0xf21a50(0x173)]==0x191){var _0x244688=await dpRefreshToken();if(!_0x244688)throw _0xf21a50(0x17c);continue;}else throw _0xf21a50(0x185)+_0xb551cc[_0xf21a50(0x173)];}else{var _0x4705aa=await _0xb551cc[_0xf21a50(0x16c)]();return console['log'](_0xf21a50(0x18f),_0x3c1c09),_0x4705aa;}}return![];}export async function dpDownloadFile(_0xaff201,_0x54ca52){var _0x17d31e=a0_0x425b66;const _0x49c243=localStorage['getItem'](_0x17d31e(0x14b));var _0x18152b=JSON['stringify']({'path':'/'+_0x49c243+'/'+_0x54ca52+'/'+_0xaff201});for(var _0xf40b9b=0x0;_0xf40b9b<0x2;_0xf40b9b++){var _0x5054ee=await fetch(_0x17d31e(0x165),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x17d31e(0x153)](_0x17d31e(0x168)),'Dropbox-API-Arg':_0x18152b}});if(_0x5054ee[_0x17d31e(0x173)]!=0xc8){if(_0x5054ee['status']==0x191){var _0x1018c1=await dpRefreshToken();if(!_0x1018c1)throw _0x17d31e(0x17c);continue;}else throw _0x17d31e(0x183)+_0x5054ee[_0x17d31e(0x173)];}const _0x973860=new File([await _0x5054ee['blob']()],_0xaff201);return console[_0x17d31e(0x142)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x973860[_0x17d31e(0x18b)]),a0_0x47b30d[_0x17d31e(0x146)](_0x973860,()=>{}),_0x973860;}return![];}document[a0_0x425b66(0x16f)](a0_0x425b66(0x169),function(){var _0x301526=a0_0x425b66;dropboxRestore[_0x301526(0x16f)](_0x301526(0x1a5),async function(){var _0x4f9aa0=_0x301526;await lockNoti(_0x4f9aa0(0x19b),'',0x1388);const _0x2bd665=localStorage[_0x4f9aa0(0x153)](_0x4f9aa0(0x14b)),_0x5a0008=[_0x4f9aa0(0x19e),'save',_0x4f9aa0(0x144)];if(!_0x2bd665){window[_0x4f9aa0(0x16e)](_0x4f9aa0(0x17a));return;}let _0x24a141=[];for(const _0x3f9a5b of _0x5a0008){let _0x360419={'path':'/'+_0x2bd665+'/'+_0x3f9a5b};for(let _0x37570b=0x0;_0x37570b<0x2;_0x37570b++){let _0x2de687=await fetch(_0x4f9aa0(0x159),{'method':_0x4f9aa0(0x17e),'headers':{'Authorization':_0x4f9aa0(0x14a)+localStorage[_0x4f9aa0(0x153)](_0x4f9aa0(0x168)),'Content-Type':_0x4f9aa0(0x19c)},'body':JSON[_0x4f9aa0(0x17d)](_0x360419)});if(_0x2de687[_0x4f9aa0(0x173)]===0xc8){let _0x5ef4c1=await _0x2de687[_0x4f9aa0(0x16c)](),_0x1fcf1f=_0x5ef4c1[_0x4f9aa0(0x176)][_0x4f9aa0(0x184)](_0x575b0d=>_0x575b0d[_0x4f9aa0(0x194)]===_0x4f9aa0(0x163));_0x1fcf1f[_0x4f9aa0(0x1a0)]>0x0&&_0x24a141[_0x4f9aa0(0x180)](..._0x1fcf1f[_0x4f9aa0(0x182)](_0x182d0f=>({'name':_0x182d0f[_0x4f9aa0(0x18b)],'folder':_0x3f9a5b})));break;}else{if(_0x2de687[_0x4f9aa0(0x173)]===0x191){let _0x2260ed=await dpRefreshToken();if(!_0x2260ed)throw _0x4f9aa0(0x17c);}else{console[_0x4f9aa0(0x189)](_0x4f9aa0(0x172)+_0x3f9a5b+',\x20status:\x20'+_0x2de687[_0x4f9aa0(0x173)]);break;}}}}if(_0x24a141[_0x4f9aa0(0x1a0)]>0x0){const _0x2ec923='Do\x20you\x20want\x20to\x20restore\x20'+_0x24a141['length']+_0x4f9aa0(0x15d);if(window[_0x4f9aa0(0x18a)](_0x2ec923))for(const _0x4839c5 of _0x24a141){await lockNoti(_0x4f9aa0(0x1a4),_0x4839c5[_0x4f9aa0(0x18b)],0xbb8),await dpDownloadFile(_0x4839c5[_0x4f9aa0(0x18b)],_0x4839c5[_0x4f9aa0(0x16b)]);}else console['log'](_0x4f9aa0(0x196));}else console[_0x4f9aa0(0x142)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x301526(0x16f)](_0x301526(0x1a5),async function(){var _0x3667d1=_0x301526;await lockNoti(_0x3667d1(0x19b),'',0x1388);const _0x1f4d28=localStorage['getItem'](_0x3667d1(0x14b));if(_0x1f4d28===null||_0x1f4d28==='')window[_0x3667d1(0x16e)](_0x3667d1(0x17a));else{const _0x22b689=[_0x3667d1(0x19e),'save',_0x3667d1(0x144)];for(const _0x509cc4 of _0x22b689){await dpCreateFolder(_0x509cc4);}let _0x59b1bd=0x0;for(const _0x33dc19 of _0x22b689){const _0x31fc26=a0_0x47b30d['listFiles'](_0x33dc19+'s');_0x59b1bd+=_0x31fc26[_0x3667d1(0x1a0)];}if(window['confirm'](_0x3667d1(0x171)+_0x59b1bd+_0x3667d1(0x175)))for(const _0x4f1fb9 of _0x22b689){const _0x338b0f=a0_0x47b30d[_0x3667d1(0x186)](_0x4f1fb9+'s');for(const _0x68b949 of _0x338b0f){const _0x2b9ae1=await a0_0x47b30d['downloadFileInCloud']('/data/'+_0x4f1fb9+'s/'+_0x68b949);try{await lockNoti(_0x3667d1(0x157),_0x68b949,0xbb8),await dpUploadFile(_0x68b949,_0x2b9ae1,_0x4f1fb9);}catch(_0x5efa80){console[_0x3667d1(0x189)](_0x3667d1(0x156)+_0x68b949+':',_0x5efa80);}}}else console[_0x3667d1(0x142)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x301526(0x16f)]('click',function(){var _0x1a2d16=_0x301526;const _0x56a8b9=localStorage[_0x1a2d16(0x153)](_0x1a2d16(0x14b));_0x56a8b9===null||_0x56a8b9===''?authorizeWithDropbox():window[_0x1a2d16(0x18a)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x1a2d16(0x195)](_0x1a2d16(0x14b),''),dropboxRestore[_0x1a2d16(0x15a)][_0x1a2d16(0x188)](_0x1a2d16(0x164)),dropboxBackup['classList']['remove'](_0x1a2d16(0x164)),dropboxCloud[_0x1a2d16(0x15a)]['remove']('active'));}),handleDropboxCallback();});function a0_0x1d01(){var _0x517ae3=['Restoring...','click','9035780QKNTtt','authorization_code','Folder\x20already\x20exists','Error\x20while\x20refreshing\x20token:','log','&grant_type=','screenshot','&redirect_uri=','uploadFileInCloud','4dnBaUg','https://api.dropbox.com/oauth2/token','3917595zCMPnv','Bearer\x20','uId','5927095lmauRM','28146zMKdZe','https://www.dropbox.com/oauth2/authorize?client_id=','code','application/x-www-form-urlencoded','refreshToken','knh3uz2mx2hp2eu','getItem','No\x20refresh\x20token','code=','Failed\x20to\x20upload\x20file\x20','Backing\x20up...','&client_id=','https://api.dropboxapi.com/2/files/list_folder','classList','https://api.dropboxapi.com/oauth2/token','Refreshing\x20token...','\x20files\x20from\x20Cloud?','onload','2062316oJMUYV','search','open','https://api.dropboxapi.com/2/files/create_folder_v2','file','active','https://content.dropboxapi.com/2/files/download','send','Folder\x20created','accessToken','DOMContentLoaded','split','folder','json','=([^&#]*)','alert','addEventListener','Content-Type','Do\x20you\x20want\x20to\x20backup\x20','Download\x20failed\x20for\x20','status','offline','\x20files\x20in\x20Kabu?','entries','16zapYXj','application/octet-stream','refresh_token','Cloud\x20login\x20required!','replace','Unable\x20to\x20refresh\x20token','stringify','POST','384272WhmtjF','push','parse','map','Download\x20failed,\x20unknown\x20http\x20status:','filter','Upload\x20failed,\x20unknown\x20http\x20status:\x20','listFiles','nwb3dnfh09rhs31','remove','error','confirm','name','168336tANINm','&token_access_type=','setRequestHeader','Kabu\x20storage\x20↦\x20Cloud\x20◆','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Authorization\x20Code:','overwrite','location','.tag','setItem','Restore\x20canceled\x20by\x20user.','https://content.dropboxapi.com/2/files/upload','539oiVYyF','3wFBwKN','[\x5c?&#]','Wait\x20a\x20little\x20bit...','application/json','refresh_token=','state','&response_type=','length','href','&client_secret=','access_token'];a0_0x1d01=function(){return _0x517ae3;};return a0_0x1d01();}