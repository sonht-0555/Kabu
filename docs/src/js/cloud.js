var a0_0x5a45e7=a0_0x1bda;(function(_0x3649e5,_0x560ae1){var _0x31b8f8=a0_0x1bda,_0x424a01=_0x3649e5();while(!![]){try{var _0x4dc44a=parseInt(_0x31b8f8(0x1fb))/0x1*(-parseInt(_0x31b8f8(0x228))/0x2)+-parseInt(_0x31b8f8(0x1d3))/0x3+parseInt(_0x31b8f8(0x215))/0x4+parseInt(_0x31b8f8(0x211))/0x5+-parseInt(_0x31b8f8(0x206))/0x6+parseInt(_0x31b8f8(0x22e))/0x7*(-parseInt(_0x31b8f8(0x227))/0x8)+-parseInt(_0x31b8f8(0x205))/0x9*(-parseInt(_0x31b8f8(0x231))/0xa);if(_0x4dc44a===_0x560ae1)break;else _0x424a01['push'](_0x424a01['shift']());}catch(_0x1eb272){_0x424a01['push'](_0x424a01['shift']());}}}(a0_0x492f,0x6af7d));import*as a0_0x3c8eb0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5a45e7(0x209),clientSecret=a0_0x5a45e7(0x1f0);function authorizeWithDropbox(){var _0x2597b1=a0_0x5a45e7,_0x4e1f11=window[_0x2597b1(0x1ed)]['href']['split']('?')[0x0],_0x33ea02='code',_0x4918c2=_0x2597b1(0x1f9),_0x4ffb8f=_0x2597b1(0x223)+clientId+_0x2597b1(0x20e)+_0x33ea02+_0x2597b1(0x1d8)+_0x4918c2+'&redirect_uri='+encodeURIComponent(_0x4e1f11);window[_0x2597b1(0x1ed)][_0x2597b1(0x1fc)]=_0x4ffb8f;}function handleDropboxCallback(){var _0x4ec479=a0_0x5a45e7,_0x11ae5e=getUrlParameter(_0x4ec479(0x219));_0x11ae5e?(getAccessToken(_0x11ae5e),console['log']('Authorization\x20Code:',_0x11ae5e)):console['log'](_0x4ec479(0x204));}function a0_0x492f(){var _0x346be7=['10woCHFX','access_token','Restore\x20canceled\x20by\x20user.','&client_secret=','Cloud\x20login\x20required!','.tag','Do\x20you\x20want\x20to\x20restore\x20','listFiles','https://api.dropbox.com/oauth2/token','Error\x20while\x20refreshing\x20token:','2448138iRRFdo','save','length','exec','Cloud\x20↦\x20Kabu\x20storage\x20◆','&token_access_type=','Do\x20you\x20want\x20to\x20logout?','refresh_token','application/octet-stream','active','setItem','\x20files\x20in\x20Kabu?','https://api.dropboxapi.com/2/files/create_folder_v2','Folder\x20created','folder','uploadFileInCloud','confirm','addEventListener','entries','stringify','uId','setRequestHeader','&redirect_uri=','replace','Error\x20creating\x20folder\x20','remove','location','accessToken','&grant_type=','nwb3dnfh09rhs31','code=','Refreshing\x20token...','downloadFileInCloud','classList','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','open','log','Folder\x20already\x20exists','offline','name','54qiRQBx','href','json','filter','application/json','Backing\x20up...','refresh_token=','getItem','state','Do\x20not\x20receive\x20authorization','16263945RTWCHd','1725822ZxsdPl','\x20files\x20from\x20Cloud?','&client_id=','knh3uz2mx2hp2eu','alert','onload','refreshToken','click','&response_type=','https://content.dropboxapi.com/2/files/download','file','2076045bZZhmq','overwrite','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Kabu\x20storage\x20↦\x20Cloud\x20◆','1298676wEiuof','No\x20files\x20found\x20to\x20restore.','=([^&#]*)','authorization_code','code','Bearer\x20','push','error','status','responseText','https://api.dropboxapi.com/oauth2/token','application/x-www-form-urlencoded','https://api.dropboxapi.com/2/files/list_folder','screenshot','https://www.dropbox.com/oauth2/authorize?client_id=','POST','No\x20refresh\x20token',',\x20status:\x20','2238776QItTUp','6134OnPPLI','https://content.dropboxapi.com/2/files/upload','Unable\x20to\x20refresh\x20token','map','DOMContentLoaded','Content-Type','21SRpKEl','send','Do\x20you\x20want\x20to\x20backup\x20'];a0_0x492f=function(){return _0x346be7;};return a0_0x492f();}function getUrlParameter(_0x3212cc){var _0x5c9e5c=a0_0x5a45e7;_0x3212cc=_0x3212cc[_0x5c9e5c(0x1ea)](/[\[]/,'\x5c[')[_0x5c9e5c(0x1ea)](/[\]]/,'\x5c]');var _0x50656d=new RegExp('[\x5c?&#]'+_0x3212cc+_0x5c9e5c(0x217)),_0x35b485=_0x50656d[_0x5c9e5c(0x1d6)](location['search']);return _0x35b485===null?'':decodeURIComponent(_0x35b485[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x4673ec){var _0x160829=a0_0x5a45e7,_0x2246d9=_0x160829(0x218),_0xa0b062=window[_0x160829(0x1ed)][_0x160829(0x1fc)]['split']('?')[0x0],_0x1d3570=new XMLHttpRequest();_0x1d3570[_0x160829(0x1f6)](_0x160829(0x224),_0x160829(0x239)),_0x1d3570[_0x160829(0x1e8)](_0x160829(0x22d),_0x160829(0x220)),_0x1d3570[_0x160829(0x20b)]=function(){var _0x23e34b=_0x160829;if(_0x1d3570[_0x23e34b(0x21d)]===0xc8){var _0x181497=JSON['parse'](_0x1d3570[_0x23e34b(0x21e)]),_0x41709d=_0x181497[_0x23e34b(0x232)],_0x100402=_0x181497[_0x23e34b(0x1da)],_0x355e51=_0x181497['uid'];localStorage[_0x23e34b(0x1dd)](_0x23e34b(0x1ee),_0x41709d),localStorage[_0x23e34b(0x1dd)](_0x23e34b(0x20c),_0x100402),localStorage[_0x23e34b(0x1dd)](_0x23e34b(0x1e7),_0x355e51);}else console[_0x23e34b(0x1f7)](_0x23e34b(0x1f5));},_0x1d3570[_0x160829(0x22f)](_0x160829(0x1f1)+_0x4673ec+_0x160829(0x1ef)+_0x2246d9+_0x160829(0x208)+clientId+_0x160829(0x234)+clientSecret+_0x160829(0x1e9)+encodeURIComponent(_0xa0b062));}export async function dpCreateFolder(_0x52f482){var _0x30fa07=a0_0x5a45e7;const _0x43462e=localStorage[_0x30fa07(0x202)]('uId');let _0x467dc3=localStorage[_0x30fa07(0x202)](_0x30fa07(0x1ee));const _0x694969='/'+_0x43462e+'/'+_0x52f482,_0x5473da=JSON[_0x30fa07(0x1e6)]({'path':_0x694969,'autorename':![]});for(let _0x9c3a38=0x0;_0x9c3a38<0x2;_0x9c3a38++){try{const _0x36643b=await fetch(_0x30fa07(0x1df),{'method':_0x30fa07(0x224),'headers':{'Authorization':_0x30fa07(0x21a)+_0x467dc3,'Content-Type':_0x30fa07(0x1ff)},'body':_0x5473da});if(_0x36643b[_0x30fa07(0x21d)]===0x191){const _0x410782=await dpRefreshToken();if(!_0x410782)throw new Error('Unable\x20to\x20refresh\x20token');_0x467dc3=localStorage[_0x30fa07(0x202)](_0x30fa07(0x1ee));continue;}if(_0x36643b[_0x30fa07(0x21d)]===0x199)return{'message':_0x30fa07(0x1f8),'path':_0x52f482};if(!_0x36643b['ok'])throw new Error(_0x30fa07(0x1eb)+_0x52f482);const _0x470b13=await _0x36643b[_0x30fa07(0x1fd)]();return await lockNoti(_0x30fa07(0x1e0),'',0xbb8),_0x470b13;}catch(_0x4b5779){if(_0x9c3a38===0x1)throw _0x4b5779;}}return![];}export async function dpRefreshToken(){var _0x254fa1=a0_0x5a45e7;if(!localStorage[_0x254fa1(0x202)](_0x254fa1(0x20c)))throw _0x254fa1(0x225);try{const _0x217a64=await fetch(_0x254fa1(0x21f),{'method':'POST','headers':{'Content-Type':_0x254fa1(0x220)},'body':_0x254fa1(0x201)+localStorage[_0x254fa1(0x202)]('refreshToken')+_0x254fa1(0x213)}),_0x2e7516=await _0x217a64[_0x254fa1(0x1fd)]();if(!_0x2e7516[_0x254fa1(0x21c)])return localStorage['setItem']('accessToken',_0x2e7516['access_token']),await lockNoti(_0x254fa1(0x1f2),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2e7516['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x2c4d7e){console[_0x254fa1(0x21c)](_0x254fa1(0x1d2),_0x2c4d7e);}return![];}export async function dpUploadFile(_0xf1edce,_0x5051f1,_0x2f2d95){var _0x53ba7c=a0_0x5a45e7;const _0x2d091b=localStorage[_0x53ba7c(0x202)](_0x53ba7c(0x1e7));var _0x55d3a6=JSON[_0x53ba7c(0x1e6)]({'autorename':!![],'mode':_0x53ba7c(0x212),'mute':!![],'strict_conflict':![],'path':'/'+_0x2d091b+'/'+_0x2f2d95+'/'+_0xf1edce}),_0x1494f1=new Blob([_0x5051f1],{'type':_0x53ba7c(0x1db)});for(var _0x60064=0x0;_0x60064<0x2;_0x60064++){var _0x2f9ab5=await fetch(_0x53ba7c(0x229),{'method':_0x53ba7c(0x224),'headers':{'Authorization':_0x53ba7c(0x21a)+localStorage[_0x53ba7c(0x202)](_0x53ba7c(0x1ee)),'Dropbox-API-Arg':_0x55d3a6,'Content-Type':_0x53ba7c(0x1db)},'body':_0x1494f1});if(_0x2f9ab5['status']!=0xc8){if(_0x2f9ab5[_0x53ba7c(0x21d)]==0x191){var _0xfe1523=await dpRefreshToken();if(!_0xfe1523)throw _0x53ba7c(0x22a);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x2f9ab5[_0x53ba7c(0x21d)];}else{var _0x53941e=await _0x2f9ab5[_0x53ba7c(0x1fd)]();return console[_0x53ba7c(0x1f7)](_0x53ba7c(0x214),_0xf1edce),_0x53941e;}}return![];}function a0_0x1bda(_0x574870,_0x2abdeb){var _0x492fdf=a0_0x492f();return a0_0x1bda=function(_0x1bda9b,_0x44ab0f){_0x1bda9b=_0x1bda9b-0x1d2;var _0x3394cf=_0x492fdf[_0x1bda9b];return _0x3394cf;},a0_0x1bda(_0x574870,_0x2abdeb);}export async function dpDownloadFile(_0x55d28b,_0x5d8ca5){var _0x2c2ddf=a0_0x5a45e7;const _0x4a3939=localStorage[_0x2c2ddf(0x202)](_0x2c2ddf(0x1e7));var _0x1926c7=JSON[_0x2c2ddf(0x1e6)]({'path':'/'+_0x4a3939+'/'+_0x5d8ca5+'/'+_0x55d28b});for(var _0x296110=0x0;_0x296110<0x2;_0x296110++){var _0x3b2f45=await fetch(_0x2c2ddf(0x20f),{'method':_0x2c2ddf(0x224),'headers':{'Authorization':_0x2c2ddf(0x21a)+localStorage['getItem'](_0x2c2ddf(0x1ee)),'Dropbox-API-Arg':_0x1926c7}});if(_0x3b2f45[_0x2c2ddf(0x21d)]!=0xc8){if(_0x3b2f45[_0x2c2ddf(0x21d)]==0x191){var _0x4968dc=await dpRefreshToken();if(!_0x4968dc)throw _0x2c2ddf(0x22a);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3b2f45[_0x2c2ddf(0x21d)];}const _0x2f6984=new File([await _0x3b2f45['blob']()],_0x55d28b);return console['log'](_0x2c2ddf(0x1d7),_0x2f6984[_0x2c2ddf(0x1fa)]),a0_0x3c8eb0[_0x2c2ddf(0x1e2)](_0x2f6984,()=>{}),_0x2f6984;}return![];}document[a0_0x5a45e7(0x1e4)](a0_0x5a45e7(0x22c),function(){var _0x3c7360=a0_0x5a45e7;dropboxRestore[_0x3c7360(0x1e4)](_0x3c7360(0x20d),async function(){var _0x188e3a=_0x3c7360;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x52cf93=localStorage[_0x188e3a(0x202)](_0x188e3a(0x1e7)),_0x282efe=[_0x188e3a(0x203),_0x188e3a(0x1d4),_0x188e3a(0x222)];if(!_0x52cf93){window['alert'](_0x188e3a(0x235));return;}let _0x1020b5=[];for(const _0x3e892f of _0x282efe){let _0x3276f3={'path':'/'+_0x52cf93+'/'+_0x3e892f};for(let _0x1812e5=0x0;_0x1812e5<0x2;_0x1812e5++){let _0x183e2f=await fetch(_0x188e3a(0x221),{'method':_0x188e3a(0x224),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x188e3a(0x202)](_0x188e3a(0x1ee)),'Content-Type':_0x188e3a(0x1ff)},'body':JSON[_0x188e3a(0x1e6)](_0x3276f3)});if(_0x183e2f[_0x188e3a(0x21d)]===0xc8){let _0xefcd4b=await _0x183e2f[_0x188e3a(0x1fd)](),_0x27bcfd=_0xefcd4b[_0x188e3a(0x1e5)][_0x188e3a(0x1fe)](_0x5e7f71=>_0x5e7f71[_0x188e3a(0x236)]===_0x188e3a(0x210));_0x27bcfd['length']>0x0&&_0x1020b5[_0x188e3a(0x21b)](..._0x27bcfd[_0x188e3a(0x22b)](_0x107971=>({'name':_0x107971[_0x188e3a(0x1fa)],'folder':_0x3e892f})));break;}else{if(_0x183e2f[_0x188e3a(0x21d)]===0x191){let _0x56bf66=await dpRefreshToken();if(!_0x56bf66)throw _0x188e3a(0x22a);}else{console[_0x188e3a(0x21c)]('Download\x20failed\x20for\x20'+_0x3e892f+_0x188e3a(0x226)+_0x183e2f[_0x188e3a(0x21d)]);break;}}}}if(_0x1020b5[_0x188e3a(0x1d5)]>0x0){const _0x1650da=_0x188e3a(0x237)+_0x1020b5[_0x188e3a(0x1d5)]+_0x188e3a(0x207);if(window[_0x188e3a(0x1e3)](_0x1650da))for(const _0x14193d of _0x1020b5){await lockNoti('Restoring...',_0x14193d[_0x188e3a(0x1fa)],0xbb8),await dpDownloadFile(_0x14193d[_0x188e3a(0x1fa)],_0x14193d[_0x188e3a(0x1e1)]);}else console[_0x188e3a(0x1f7)](_0x188e3a(0x233));}else console['log'](_0x188e3a(0x216));}),dropboxBackup[_0x3c7360(0x1e4)]('click',async function(){var _0x453fce=_0x3c7360;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x3206df=localStorage[_0x453fce(0x202)](_0x453fce(0x1e7));if(_0x3206df===null||_0x3206df==='')window[_0x453fce(0x20a)](_0x453fce(0x235));else{const _0x54567e=[_0x453fce(0x203),'save',_0x453fce(0x222)];for(const _0x46bab8 of _0x54567e){await dpCreateFolder(_0x46bab8);}let _0xe68c88=0x0;for(const _0x33ea66 of _0x54567e){const _0x1987f0=a0_0x3c8eb0[_0x453fce(0x238)](_0x33ea66+'s');_0xe68c88+=_0x1987f0[_0x453fce(0x1d5)];}if(window[_0x453fce(0x1e3)](_0x453fce(0x230)+_0xe68c88+_0x453fce(0x1de)))for(const _0x683d35 of _0x54567e){const _0x4f6128=a0_0x3c8eb0['listFiles'](_0x683d35+'s');for(const _0x4b15a6 of _0x4f6128){const _0x319db2=await a0_0x3c8eb0[_0x453fce(0x1f3)]('/data/'+_0x683d35+'s/'+_0x4b15a6);try{await lockNoti(_0x453fce(0x200),_0x4b15a6,0xbb8),await dpUploadFile(_0x4b15a6,_0x319db2,_0x683d35);}catch(_0x4462b3){console[_0x453fce(0x21c)]('Failed\x20to\x20upload\x20file\x20'+_0x4b15a6+':',_0x4462b3);}}}else console[_0x453fce(0x1f7)](_0x453fce(0x233));}}),dropboxCloud[_0x3c7360(0x1e4)](_0x3c7360(0x20d),function(){var _0x391f19=_0x3c7360;const _0x5c2b65=localStorage[_0x391f19(0x202)](_0x391f19(0x1e7));_0x5c2b65===null||_0x5c2b65===''?authorizeWithDropbox():window[_0x391f19(0x1e3)](_0x391f19(0x1d9))&&(localStorage[_0x391f19(0x1dd)](_0x391f19(0x1e7),''),dropboxRestore[_0x391f19(0x1f4)][_0x391f19(0x1ec)](_0x391f19(0x1dc)),dropboxBackup['classList'][_0x391f19(0x1ec)](_0x391f19(0x1dc)),dropboxCloud[_0x391f19(0x1f4)][_0x391f19(0x1ec)](_0x391f19(0x1dc)));}),handleDropboxCallback();});