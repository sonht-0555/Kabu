function a0_0x4f02(){var _0x136719=['/data/','blob','Failed\x20to\x20refresh\x20Dropbox\x20token.','replace','uploadSaveOrSaveState','.ss5','nwb3dnfh09rhs31','32394150uLPMQU','&token_access_type=','length','4887830CdKSOT','name','log','stringify','.tag','https://api.dropboxapi.com/oauth2/token','3222063lcCrMA','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','json','charAt','No\x20refresh\x20token','=([^&#]*)','list','code','href','_imageState','endsWith','Cloud\x20login\x20required!','.ss6','knh3uz2mx2hp2eu','Upload\x20failed,\x20unknown\x20http\x20status:\x20','exec','3100048BnIFPr','addEventListener','3YYwmMm','error','refresh_token=','1141546NwnMwg','Backing\x20up...','9842400cjsrGd','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','refreshToken','POST','Bearer\x20','.txt','Do\x20not\x20receive\x20authorization','.ss4','Do\x20you\x20want\x20to\x20logout?','748854uSiaET','.ss0','Restore\x20canceled\x20by\x20user.','[\x5c?&#]','\x20files\x20in\x20Cloud?','accessToken','.ss7','.gba_dateState','Error\x20while\x20refreshing\x20token:','DOMContentLoaded','&redirect_uri=','status','active','Failed\x20to\x20upload\x20file\x20','save','entries','https://api.dropboxapi.com/2/files/list_folder','&response_type=','getItem','https://content.dropboxapi.com/2/files/upload','confirm','toUpperCase','Restoring...','slice','offline','status:\x20','.ss1','Do\x20you\x20want\x20to\x20restore\x20','Unable\x20to\x20refresh\x20token','Content-Type','&client_secret=','Do\x20you\x20want\x20to\x20backup\x20','file','location','alert','lastIndexOf','access_token','substring','Download\x20failed,\x20unknown\x20http\x20status:','setItem','responseText','uId','filter','application/octet-stream','classList','state','code=','setRequestHeader','click','42OcHHfB','Refreshing\x20token...','authorization_code','text','uid','Authorization\x20Code:','text/plain','FSSync','.ss2','Download\x20failed,\x20unknown\x20http\x20status:\x20','remove','split','https://content.dropboxapi.com/2/files/download','gba','application/x-www-form-urlencoded','Cloud\x20↦\x20Kabu\x20storage\x20◆'];a0_0x4f02=function(){return _0x136719;};return a0_0x4f02();}var a0_0x59d219=a0_0x4cc0;(function(_0x25a1ed,_0x34997d){var _0x2637bd=a0_0x4cc0,_0x273456=_0x25a1ed();while(!![]){try{var _0x161113=-parseInt(_0x2637bd(0x147))/0x1*(parseInt(_0x2637bd(0x155))/0x2)+-parseInt(_0x2637bd(0x135))/0x3+parseInt(_0x2637bd(0x145))/0x4+parseInt(_0x2637bd(0x12f))/0x5+parseInt(_0x2637bd(0x115))/0x6*(-parseInt(_0x2637bd(0x14a))/0x7)+-parseInt(_0x2637bd(0x14c))/0x8+parseInt(_0x2637bd(0x12c))/0x9;if(_0x161113===_0x34997d)break;else _0x273456['push'](_0x273456['shift']());}catch(_0x3f9ff1){_0x273456['push'](_0x273456['shift']());}}}(a0_0x4f02,0xbf1bc));import*as a0_0x6e2777 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x59d219(0x142),clientSecret=a0_0x59d219(0x12b);function authorizeWithDropbox(){var _0x4a141b=a0_0x59d219,_0xc927ca=window[_0x4a141b(0x105)][_0x4a141b(0x13d)][_0x4a141b(0x120)]('?')[0x0],_0x7cdcba='code',_0x2927c5=_0x4a141b(0xfc),_0xa31e6a='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x4a141b(0xf5)+_0x7cdcba+_0x4a141b(0x12d)+_0x2927c5+'&redirect_uri='+encodeURIComponent(_0xc927ca);window['location'][_0x4a141b(0x13d)]=_0xa31e6a;}function handleDropboxCallback(){var _0x44e622=a0_0x59d219,_0x14401c=getUrlParameter(_0x44e622(0x13c));_0x14401c?(getAccessToken(_0x14401c),console['log'](_0x44e622(0x11a),_0x14401c)):console[_0x44e622(0x131)](_0x44e622(0x152));}function getUrlParameter(_0x26d5a0){var _0xe5e6f8=a0_0x59d219;_0x26d5a0=_0x26d5a0[_0xe5e6f8(0x128)](/[\[]/,'\x5c[')[_0xe5e6f8(0x128)](/[\]]/,'\x5c]');var _0x15e6eb=new RegExp(_0xe5e6f8(0x158)+_0x26d5a0+_0xe5e6f8(0x13a)),_0x37c025=_0x15e6eb[_0xe5e6f8(0x144)](location['search']);return _0x37c025===null?'':decodeURIComponent(_0x37c025[0x1][_0xe5e6f8(0x128)](/\+/g,'\x20'));}function getAccessToken(_0x38835c){var _0x13eec2=a0_0x59d219,_0x439460=_0x13eec2(0x117),_0xf8518b=window['location']['href'][_0x13eec2(0x120)]('?')[0x0],_0x596189=new XMLHttpRequest();_0x596189['open'](_0x13eec2(0x14f),'https://api.dropbox.com/oauth2/token'),_0x596189[_0x13eec2(0x113)](_0x13eec2(0x101),_0x13eec2(0x123)),_0x596189['onload']=function(){var _0x3958a1=_0x13eec2;if(_0x596189[_0x3958a1(0xef)]===0xc8){var _0x1fdbb2=JSON['parse'](_0x596189[_0x3958a1(0x10c)]),_0x3a4703=_0x1fdbb2[_0x3958a1(0x108)],_0x472a17=_0x1fdbb2['refresh_token'],_0x1b3a79=_0x1fdbb2[_0x3958a1(0x119)];localStorage['setItem'](_0x3958a1(0x15a),_0x3a4703),localStorage[_0x3958a1(0x10b)](_0x3958a1(0x14e),_0x472a17),localStorage[_0x3958a1(0x10b)](_0x3958a1(0x10d),_0x1b3a79);}else console[_0x3958a1(0x131)](_0x3958a1(0x136));},_0x596189['send'](_0x13eec2(0x112)+_0x38835c+'&grant_type='+_0x439460+'&client_id='+clientId+_0x13eec2(0x102)+clientSecret+_0x13eec2(0xee)+encodeURIComponent(_0xf8518b));}function a0_0x4cc0(_0x2d4ade,_0x3c9a2d){var _0x4f02e8=a0_0x4f02();return a0_0x4cc0=function(_0x4cc0a3,_0x3507cc){_0x4cc0a3=_0x4cc0a3-0xee;var _0x4fb091=_0x4f02e8[_0x4cc0a3];return _0x4fb091;},a0_0x4cc0(_0x2d4ade,_0x3c9a2d);}export async function dpRefreshToken(){var _0x49d86a=a0_0x59d219;if(!localStorage[_0x49d86a(0xf6)](_0x49d86a(0x14e)))throw _0x49d86a(0x139);try{const _0x41b82=await fetch(_0x49d86a(0x134),{'method':_0x49d86a(0x14f),'headers':{'Content-Type':_0x49d86a(0x123)},'body':_0x49d86a(0x149)+localStorage[_0x49d86a(0xf6)]('refreshToken')+_0x49d86a(0x14d)}),_0x3024b7=await _0x41b82[_0x49d86a(0x137)]();if(!_0x3024b7[_0x49d86a(0x148)])return localStorage['setItem'](_0x49d86a(0x15a),_0x3024b7[_0x49d86a(0x108)]),await lockNoti('',_0x49d86a(0x116),0xbb8),await delay(0x3e8),!![];else alert(_0x3024b7['error_description']||_0x49d86a(0x127));}catch(_0x312007){console[_0x49d86a(0x148)](_0x49d86a(0x15d),_0x312007);}return![];}export async function dpUploadFile(_0x59a5cc,_0x3c862a){var _0x566280=a0_0x59d219;const _0x374396=localStorage[_0x566280(0xf6)](_0x566280(0x10d));var _0x4f99d4=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x374396+'/'+_0x59a5cc}),_0x57a6b2=new Blob([_0x3c862a],{'type':_0x566280(0x10f)});for(var _0x886af4=0x0;_0x886af4<0x2;_0x886af4++){var _0x29786a=await fetch(_0x566280(0xf7),{'method':_0x566280(0x14f),'headers':{'Authorization':_0x566280(0x150)+localStorage[_0x566280(0xf6)](_0x566280(0x15a)),'Dropbox-API-Arg':_0x4f99d4,'Content-Type':'application/octet-stream'},'body':_0x57a6b2});if(_0x29786a[_0x566280(0xef)]!=0xc8){if(_0x29786a[_0x566280(0xef)]==0x191){var _0x32f39d=await dpRefreshToken();if(!_0x32f39d)throw _0x566280(0x100);continue;}else throw _0x566280(0x143)+_0x29786a[_0x566280(0xef)];}else{var _0x3f510c=await _0x29786a['json']();return console[_0x566280(0x131)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x59a5cc),_0x3f510c;}}return![];}async function dpDownloadFile(_0x397643){var _0x2eca89=a0_0x59d219;const _0x403729=localStorage[_0x2eca89(0xf6)](_0x2eca89(0x10d));var _0x176960=JSON[_0x2eca89(0x132)]({'path':'/'+_0x403729+'/'+_0x397643});for(var _0x141455=0x0;_0x141455<0x2;_0x141455++){var _0x3e47f0=await fetch(_0x2eca89(0x121),{'method':'POST','headers':{'Authorization':_0x2eca89(0x150)+localStorage['getItem'](_0x2eca89(0x15a)),'Dropbox-API-Arg':_0x176960}});if(_0x3e47f0[_0x2eca89(0xef)]!=0xc8){if(_0x3e47f0[_0x2eca89(0xef)]==0x191){var _0x365716=await dpRefreshToken();if(!_0x365716)throw _0x2eca89(0x100);continue;}else throw _0x2eca89(0x10a)+_0x3e47f0[_0x2eca89(0xef)];}const _0x59614e=new File([await _0x3e47f0[_0x2eca89(0x126)]()],_0x397643);console[_0x2eca89(0x131)](_0x2eca89(0x124),_0x59614e['name']);if(_0x397643['endsWith'](_0x2eca89(0x151))){const _0x3d4a66=await _0x59614e[_0x2eca89(0x118)](),[_0x5ec728,_0x1f1c42]=_0x3d4a66['split']('\x0a\x0a'),_0x49585e=_0x397643[_0x2eca89(0x109)](0x0,_0x397643[_0x2eca89(0x107)](_0x2eca89(0x122))+0x3),_0x491fdb=_0x397643[_0x2eca89(0x138)](_0x397643[_0x2eca89(0x12e)]-0x5);localStorage[_0x2eca89(0x10b)](_0x49585e+'_dateState'+_0x491fdb,_0x1f1c42),localStorage['setItem'](_0x49585e+_0x2eca89(0x13e)+_0x491fdb,_0x5ec728);}else a0_0x6e2777[_0x2eca89(0x129)](_0x59614e,()=>{var _0x3b0d63=_0x2eca89;localStorageFile(),Module[_0x3b0d63(0x11c)]();});return _0x59614e;}return![];}document[a0_0x59d219(0x146)](a0_0x59d219(0x15e),function(){var _0x2e79e9=a0_0x59d219;dropboxRestore[_0x2e79e9(0x146)](_0x2e79e9(0x114),async function(){var _0x315766=_0x2e79e9;const _0x29a1ab=localStorage[_0x315766(0xf6)](_0x315766(0x10d));if(_0x29a1ab===null||_0x29a1ab==='')window[_0x315766(0x106)](_0x315766(0x140));else{var _0x365263={'path':'/'+_0x29a1ab};for(var _0x58feb5=0x0;_0x58feb5<0x2;_0x58feb5++){var _0x2d12cc=await fetch(_0x315766(0xf4),{'method':'POST','headers':{'Authorization':_0x315766(0x150)+localStorage[_0x315766(0xf6)](_0x315766(0x15a)),'Content-Type':'application/json'},'body':JSON[_0x315766(0x132)](_0x365263)});console['log'](_0x315766(0xfd),_0x2d12cc[_0x315766(0xef)]);if(_0x2d12cc[_0x315766(0xef)]!=0xc8){if(_0x2d12cc[_0x315766(0xef)]==0x191){var _0x35cc5a=await dpRefreshToken();if(!_0x35cc5a)throw _0x315766(0x100);continue;}else throw _0x315766(0x11e)+_0x2d12cc[_0x315766(0xef)];}else{const _0x533770=await _0x2d12cc['json'](),_0x1e1022=_0x533770['entries'][_0x315766(0x10e)](_0x5b4eec=>_0x5b4eec[_0x315766(0x133)]===_0x315766(0x104))['length'],_0x506702=_0x315766(0xff)+_0x1e1022+_0x315766(0x159);if(window[_0x315766(0xf8)](_0x506702))for(const _0x143407 of _0x533770[_0x315766(0xf3)]){_0x143407['.tag']==='file'&&(await lockNoti(_0x315766(0xfa),_0x143407['name'],0xbb8),await dpDownloadFile(_0x143407[_0x315766(0x130)]));}else console[_0x315766(0x131)]('Restore\x20canceled\x20by\x20user.');return!![];}}return![];}}),dropboxBackup[_0x2e79e9(0x146)]('click',async function(){var _0x12da8f=_0x2e79e9;const _0x17973b=localStorage[_0x12da8f(0xf6)](_0x12da8f(0x10d));if(_0x17973b===null||_0x17973b==='')window['alert'](_0x12da8f(0x140));else{const _0x4c5ba2=[_0x12da8f(0x111),_0x12da8f(0xf2)];let _0x544a22=0x0;for(const _0x40793b of _0x4c5ba2){const _0x14b00a=a0_0x6e2777[_0x12da8f(0x13b)+(_0x40793b[_0x12da8f(0x138)](0x0)[_0x12da8f(0xf9)]()+_0x40793b['slice'](0x1))]();_0x544a22+=_0x14b00a[_0x12da8f(0x12e)];}if(window[_0x12da8f(0xf8)](_0x12da8f(0x103)+_0x544a22+'\x20files\x20in\x20Kabu?'))for(const _0xd7726f of _0x4c5ba2){const _0x1995ef=a0_0x6e2777['list'+(_0xd7726f[_0x12da8f(0x138)](0x0)[_0x12da8f(0xf9)]()+_0xd7726f[_0x12da8f(0xfb)](0x1))]();for(const _0x41c95c of _0x1995ef){const _0x180da8=await a0_0x6e2777['downloadFileInCloud'](_0x12da8f(0x125)+_0xd7726f+'s/'+_0x41c95c);try{await lockNoti(_0x12da8f(0x14b),_0x41c95c,0xbb8),await dpUploadFile(_0x41c95c,_0x180da8);if(_0x41c95c[_0x12da8f(0x13f)](_0x12da8f(0x156))||_0x41c95c['endsWith'](_0x12da8f(0xfe))||_0x41c95c['endsWith'](_0x12da8f(0x11d))||_0x41c95c[_0x12da8f(0x13f)]('.ss3')||_0x41c95c[_0x12da8f(0x13f)](_0x12da8f(0x153))||_0x41c95c['endsWith'](_0x12da8f(0x12a))||_0x41c95c[_0x12da8f(0x13f)](_0x12da8f(0x141))||_0x41c95c['endsWith'](_0x12da8f(0x15b))){const _0x1e237d=_0x41c95c[_0x12da8f(0x109)](0x0,_0x41c95c[_0x12da8f(0x107)]('.')),_0x5d39c0=_0x41c95c[_0x12da8f(0x138)](_0x41c95c[_0x12da8f(0x12e)]-0x1),_0x3ac612=localStorage[_0x12da8f(0xf6)](_0x1e237d+'.gba_imageState'+_0x5d39c0),_0x21e14d=localStorage['getItem'](_0x1e237d+_0x12da8f(0x15c)+_0x5d39c0);if(_0x3ac612!==null){const _0x2b449c=_0x3ac612+'\x0a\x0a'+_0x21e14d,_0x1e6934=new Blob([_0x2b449c],{'type':_0x12da8f(0x11b)});await lockNoti(_0x12da8f(0x14b),_0x1e237d+'.gba_slot'+_0x5d39c0+_0x12da8f(0x151),0xbb8),await dpUploadFile(_0x1e237d+'.gba_slot'+_0x5d39c0+_0x12da8f(0x151),_0x1e6934);}}}catch(_0x1cab13){console[_0x12da8f(0x148)](_0x12da8f(0xf1)+_0x41c95c+':',_0x1cab13);}}}else console['log'](_0x12da8f(0x157));}}),dropboxCloud[_0x2e79e9(0x146)]('click',function(){var _0x27a730=_0x2e79e9;const _0x54b937=localStorage['getItem'](_0x27a730(0x10d));_0x54b937===null||_0x54b937===''?authorizeWithDropbox():window[_0x27a730(0xf8)](_0x27a730(0x154))&&(localStorage[_0x27a730(0x10b)](_0x27a730(0x10d),''),dropboxRestore[_0x27a730(0x110)][_0x27a730(0x11f)](_0x27a730(0xf0)),dropboxBackup[_0x27a730(0x110)][_0x27a730(0x11f)]('active'),dropboxCloud[_0x27a730(0x110)]['remove']('active'));}),handleDropboxCallback();});