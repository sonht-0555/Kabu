var a0_0x593ca0=a0_0x11bc;(function(_0x5ccc24,_0x48ea79){var _0x391f98=a0_0x11bc,_0x41099f=_0x5ccc24();while(!![]){try{var _0xa73ace=parseInt(_0x391f98(0x17b))/0x1*(-parseInt(_0x391f98(0x187))/0x2)+-parseInt(_0x391f98(0x139))/0x3+parseInt(_0x391f98(0x135))/0x4*(-parseInt(_0x391f98(0x17a))/0x5)+parseInt(_0x391f98(0x160))/0x6+-parseInt(_0x391f98(0x14f))/0x7+-parseInt(_0x391f98(0x177))/0x8+-parseInt(_0x391f98(0x168))/0x9*(-parseInt(_0x391f98(0x176))/0xa);if(_0xa73ace===_0x48ea79)break;else _0x41099f['push'](_0x41099f['shift']());}catch(_0x372739){_0x41099f['push'](_0x41099f['shift']());}}}(a0_0x1054,0xd3702));function a0_0x1054(){var _0x5ca1d9=['confirm','screenshot','Error\x20while\x20refreshing\x20token:','Download\x20failed\x20for\x20','location','https://api.dropboxapi.com/2/files/list_folder','save','Error\x20creating\x20folder\x20','6840130xxXNod','12601832msLmGV','downloadFileInCloud','status','15uxoKtT','1542637YoxbnM','application/json','state','Do\x20you\x20want\x20to\x20backup\x20','\x20files\x20from\x20Cloud?','&token_access_type=','Do\x20you\x20want\x20to\x20logout?','&redirect_uri=','knh3uz2mx2hp2eu','&client_secret=','code','onload','2pEyhQQ','push','click','uId','Bearer\x20','stringify','Unable\x20to\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','&client_id=','listFiles','accessToken','application/x-www-form-urlencoded','/data/','&grant_type=','folder','POST','DOMContentLoaded','offline','blob',',\x20status:\x20','addEventListener','&response_type=','277756SyqvfG','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Restore\x20canceled\x20by\x20user.','Backing\x20up...','1220478WVSeDH','Download\x20failed,\x20unknown\x20http\x20status:','https://www.dropbox.com/oauth2/authorize?client_id=','exec','error','search','entries','https://api.dropboxapi.com/oauth2/token','Restoring...','file','code=','Kabu\x20storage\x20↦\x20Cloud\x20◆','active','split','responseText','name','replace','authorization_code','=([^&#]*)','Folder\x20created','overwrite','open','2637131URRjjY','alert','length','uploadFileInCloud','Cloud\x20↦\x20Kabu\x20storage\x20◆','refresh_token','uid','application/octet-stream','Content-Type','getItem','refresh_token=','Wait\x20a\x20little\x20bit...','remove','filter','access_token','classList','log','5230284ZKuQwK','setItem','parse','Cloud\x20login\x20required!','json','Folder\x20already\x20exists','Failed\x20to\x20upload\x20file\x20','refreshToken','54GLYcSS','Authorization\x20Code:','href','.tag','https://api.dropbox.com/oauth2/token','setRequestHeader'];a0_0x1054=function(){return _0x5ca1d9;};return a0_0x1054();}import*as a0_0x10560b from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x11bc(_0x803c5,_0x15c881){var _0x10549c=a0_0x1054();return a0_0x11bc=function(_0x11bc83,_0x5c746b){_0x11bc83=_0x11bc83-0x133;var _0x7fdf8=_0x10549c[_0x11bc83];return _0x7fdf8;},a0_0x11bc(_0x803c5,_0x15c881);}var clientId=a0_0x593ca0(0x183),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x503c3d=a0_0x593ca0,_0x4b6054=window[_0x503c3d(0x172)][_0x503c3d(0x16a)][_0x503c3d(0x146)]('?')[0x0],_0x4384fb=_0x503c3d(0x185),_0x1fb7aa=_0x503c3d(0x198),_0x229b2a=_0x503c3d(0x13b)+clientId+_0x503c3d(0x134)+_0x4384fb+_0x503c3d(0x180)+_0x1fb7aa+_0x503c3d(0x182)+encodeURIComponent(_0x4b6054);window['location'][_0x503c3d(0x16a)]=_0x229b2a;}function handleDropboxCallback(){var _0x536475=a0_0x593ca0,_0x534f21=getUrlParameter('code');_0x534f21?(getAccessToken(_0x534f21),console[_0x536475(0x15f)](_0x536475(0x169),_0x534f21)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x371f68){var _0x1d5054=a0_0x593ca0;_0x371f68=_0x371f68['replace'](/[\[]/,'\x5c[')[_0x1d5054(0x149)](/[\]]/,'\x5c]');var _0x5f6a3=new RegExp('[\x5c?&#]'+_0x371f68+_0x1d5054(0x14b)),_0x2024f0=_0x5f6a3[_0x1d5054(0x13c)](location[_0x1d5054(0x13e)]);return _0x2024f0===null?'':decodeURIComponent(_0x2024f0[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0xa4e440){var _0x448fa4=a0_0x593ca0,_0x53197d=_0x448fa4(0x14a),_0x38be0e=window[_0x448fa4(0x172)][_0x448fa4(0x16a)][_0x448fa4(0x146)]('?')[0x0],_0x361bf0=new XMLHttpRequest();_0x361bf0[_0x448fa4(0x14e)](_0x448fa4(0x196),_0x448fa4(0x16c)),_0x361bf0[_0x448fa4(0x16d)](_0x448fa4(0x157),_0x448fa4(0x192)),_0x361bf0[_0x448fa4(0x186)]=function(){var _0x4a0dc8=_0x448fa4;if(_0x361bf0[_0x4a0dc8(0x179)]===0xc8){var _0x1127fe=JSON[_0x4a0dc8(0x162)](_0x361bf0[_0x4a0dc8(0x147)]),_0x43e907=_0x1127fe[_0x4a0dc8(0x15d)],_0xb6e0e5=_0x1127fe[_0x4a0dc8(0x154)],_0x4b7a85=_0x1127fe[_0x4a0dc8(0x155)];localStorage[_0x4a0dc8(0x161)]('accessToken',_0x43e907),localStorage['setItem']('refreshToken',_0xb6e0e5),localStorage[_0x4a0dc8(0x161)](_0x4a0dc8(0x18a),_0x4b7a85);}else console[_0x4a0dc8(0x15f)](_0x4a0dc8(0x136));},_0x361bf0['send'](_0x448fa4(0x143)+_0xa4e440+_0x448fa4(0x194)+_0x53197d+_0x448fa4(0x18f)+clientId+_0x448fa4(0x184)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x38be0e));}export async function dpCreateFolder(_0x4cbf78){var _0x44be50=a0_0x593ca0;const _0x30f926=localStorage['getItem']('uId');let _0xfdb79b=localStorage[_0x44be50(0x158)](_0x44be50(0x191));const _0x5325c6='/'+_0x30f926+'/'+_0x4cbf78,_0x32c6c1=JSON['stringify']({'path':_0x5325c6,'autorename':![]});for(let _0xaef80e=0x0;_0xaef80e<0x2;_0xaef80e++){try{const _0x250d40=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x44be50(0x18b)+_0xfdb79b,'Content-Type':_0x44be50(0x17c)},'body':_0x32c6c1});if(_0x250d40[_0x44be50(0x179)]===0x191){const _0x2d6b7f=await dpRefreshToken();if(!_0x2d6b7f)throw new Error(_0x44be50(0x18d));_0xfdb79b=localStorage['getItem'](_0x44be50(0x191));continue;}if(_0x250d40[_0x44be50(0x179)]===0x199)return{'message':_0x44be50(0x165),'path':_0x4cbf78};if(!_0x250d40['ok'])throw new Error(_0x44be50(0x175)+_0x4cbf78);const _0x502651=await _0x250d40[_0x44be50(0x164)]();return await lockNoti(_0x44be50(0x14c),'',0xbb8),_0x502651;}catch(_0xe2e7b6){if(_0xaef80e===0x1)throw _0xe2e7b6;}}return![];}export async function dpRefreshToken(){var _0x36dcbd=a0_0x593ca0;if(!localStorage[_0x36dcbd(0x158)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x1c7206=await fetch(_0x36dcbd(0x140),{'method':_0x36dcbd(0x196),'headers':{'Content-Type':_0x36dcbd(0x192)},'body':_0x36dcbd(0x159)+localStorage[_0x36dcbd(0x158)](_0x36dcbd(0x167))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2b5d68=await _0x1c7206[_0x36dcbd(0x164)]();if(!_0x2b5d68[_0x36dcbd(0x13d)])return localStorage[_0x36dcbd(0x161)](_0x36dcbd(0x191),_0x2b5d68[_0x36dcbd(0x15d)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x2b5d68['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x5f50cf){console[_0x36dcbd(0x13d)](_0x36dcbd(0x170),_0x5f50cf);}return![];}export async function dpUploadFile(_0x300e85,_0x4c717e,_0x5ad4a3){var _0xb6ee88=a0_0x593ca0;const _0x45dc4e=localStorage[_0xb6ee88(0x158)](_0xb6ee88(0x18a));var _0x1feade=JSON[_0xb6ee88(0x18c)]({'autorename':!![],'mode':_0xb6ee88(0x14d),'mute':!![],'strict_conflict':![],'path':'/'+_0x45dc4e+'/'+_0x5ad4a3+'/'+_0x300e85}),_0x110f85=new Blob([_0x4c717e],{'type':'application/octet-stream'});for(var _0x50f900=0x0;_0x50f900<0x2;_0x50f900++){var _0x4a64e0=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0xb6ee88(0x158)]('accessToken'),'Dropbox-API-Arg':_0x1feade,'Content-Type':_0xb6ee88(0x156)},'body':_0x110f85});if(_0x4a64e0[_0xb6ee88(0x179)]!=0xc8){if(_0x4a64e0['status']==0x191){var _0x5ca1fc=await dpRefreshToken();if(!_0x5ca1fc)throw _0xb6ee88(0x18d);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x4a64e0[_0xb6ee88(0x179)];}else{var _0x48cb95=await _0x4a64e0['json']();return console[_0xb6ee88(0x15f)](_0xb6ee88(0x144),_0x300e85),_0x48cb95;}}return![];}export async function dpDownloadFile(_0x1b2361,_0x2f4cf3){var _0x37d7fd=a0_0x593ca0;const _0x1c0262=localStorage[_0x37d7fd(0x158)](_0x37d7fd(0x18a));var _0x5118d7=JSON['stringify']({'path':'/'+_0x1c0262+'/'+_0x2f4cf3+'/'+_0x1b2361});for(var _0x580c1a=0x0;_0x580c1a<0x2;_0x580c1a++){var _0x11c2a2=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x37d7fd(0x196),'headers':{'Authorization':_0x37d7fd(0x18b)+localStorage['getItem'](_0x37d7fd(0x191)),'Dropbox-API-Arg':_0x5118d7}});if(_0x11c2a2[_0x37d7fd(0x179)]!=0xc8){if(_0x11c2a2[_0x37d7fd(0x179)]==0x191){var _0x2629d0=await dpRefreshToken();if(!_0x2629d0)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x37d7fd(0x13a)+_0x11c2a2[_0x37d7fd(0x179)];}const _0xd16458=new File([await _0x11c2a2[_0x37d7fd(0x199)]()],_0x1b2361);return console[_0x37d7fd(0x15f)](_0x37d7fd(0x153),_0xd16458[_0x37d7fd(0x148)]),a0_0x10560b[_0x37d7fd(0x152)](_0xd16458,()=>{}),_0xd16458;}return![];}document['addEventListener'](a0_0x593ca0(0x197),function(){var _0x43f59c=a0_0x593ca0;dropboxRestore[_0x43f59c(0x133)](_0x43f59c(0x189),async function(){var _0x363d8f=_0x43f59c;await lockNoti(_0x363d8f(0x15a),'',0x1388);const _0x1d9d98=localStorage[_0x363d8f(0x158)](_0x363d8f(0x18a)),_0x230e23=[_0x363d8f(0x17d),_0x363d8f(0x174),_0x363d8f(0x16f)];if(!_0x1d9d98){window[_0x363d8f(0x150)](_0x363d8f(0x163));return;}let _0x3de1f4=[];for(const _0x21b1f9 of _0x230e23){let _0x5dcf73={'path':'/'+_0x1d9d98+'/'+_0x21b1f9};for(let _0x5126dc=0x0;_0x5126dc<0x2;_0x5126dc++){let _0x470e6c=await fetch(_0x363d8f(0x173),{'method':_0x363d8f(0x196),'headers':{'Authorization':_0x363d8f(0x18b)+localStorage['getItem'](_0x363d8f(0x191)),'Content-Type':_0x363d8f(0x17c)},'body':JSON[_0x363d8f(0x18c)](_0x5dcf73)});if(_0x470e6c[_0x363d8f(0x179)]===0xc8){let _0x464ea4=await _0x470e6c[_0x363d8f(0x164)](),_0x1ecf1c=_0x464ea4[_0x363d8f(0x13f)][_0x363d8f(0x15c)](_0x3496a3=>_0x3496a3[_0x363d8f(0x16b)]===_0x363d8f(0x142));_0x1ecf1c[_0x363d8f(0x151)]>0x0&&_0x3de1f4[_0x363d8f(0x188)](..._0x1ecf1c['map'](_0x422dac=>({'name':_0x422dac[_0x363d8f(0x148)],'folder':_0x21b1f9})));break;}else{if(_0x470e6c['status']===0x191){let _0x131231=await dpRefreshToken();if(!_0x131231)throw _0x363d8f(0x18d);}else{console[_0x363d8f(0x13d)](_0x363d8f(0x171)+_0x21b1f9+_0x363d8f(0x19a)+_0x470e6c[_0x363d8f(0x179)]);break;}}}}if(_0x3de1f4[_0x363d8f(0x151)]>0x0){const _0x46d9aa=_0x363d8f(0x18e)+_0x3de1f4[_0x363d8f(0x151)]+_0x363d8f(0x17f);if(window[_0x363d8f(0x16e)](_0x46d9aa))for(const _0x3b5db0 of _0x3de1f4){await lockNoti(_0x363d8f(0x141),_0x3b5db0['name'],0xbb8),await dpDownloadFile(_0x3b5db0[_0x363d8f(0x148)],_0x3b5db0[_0x363d8f(0x195)]);}else console['log'](_0x363d8f(0x137));}else console[_0x363d8f(0x15f)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x43f59c(0x133)](_0x43f59c(0x189),async function(){var _0x9f2e02=_0x43f59c;await lockNoti(_0x9f2e02(0x15a),'',0x1388);const _0xe3d756=localStorage['getItem'](_0x9f2e02(0x18a));if(_0xe3d756===null||_0xe3d756==='')window[_0x9f2e02(0x150)]('Cloud\x20login\x20required!');else{const _0x107ee8=[_0x9f2e02(0x17d),_0x9f2e02(0x174),_0x9f2e02(0x16f)];for(const _0x549b70 of _0x107ee8){await dpCreateFolder(_0x549b70);}let _0x1e5723=0x0;for(const _0x480df1 of _0x107ee8){const _0x3dcd1c=a0_0x10560b[_0x9f2e02(0x190)](_0x480df1+'s');_0x1e5723+=_0x3dcd1c[_0x9f2e02(0x151)];}if(window['confirm'](_0x9f2e02(0x17e)+_0x1e5723+'\x20files\x20in\x20Kabu?'))for(const _0x1c956f of _0x107ee8){const _0x156084=a0_0x10560b[_0x9f2e02(0x190)](_0x1c956f+'s');for(const _0x508251 of _0x156084){const _0x36067e=await a0_0x10560b[_0x9f2e02(0x178)](_0x9f2e02(0x193)+_0x1c956f+'s/'+_0x508251);try{await lockNoti(_0x9f2e02(0x138),_0x508251,0xbb8),await dpUploadFile(_0x508251,_0x36067e,_0x1c956f);}catch(_0x502c55){console[_0x9f2e02(0x13d)](_0x9f2e02(0x166)+_0x508251+':',_0x502c55);}}}else console[_0x9f2e02(0x15f)](_0x9f2e02(0x137));}}),dropboxCloud[_0x43f59c(0x133)](_0x43f59c(0x189),function(){var _0x2223da=_0x43f59c;const _0x1b38ab=localStorage['getItem'](_0x2223da(0x18a));_0x1b38ab===null||_0x1b38ab===''?authorizeWithDropbox():window[_0x2223da(0x16e)](_0x2223da(0x181))&&(localStorage[_0x2223da(0x161)](_0x2223da(0x18a),''),dropboxRestore[_0x2223da(0x15e)]['remove'](_0x2223da(0x145)),dropboxBackup[_0x2223da(0x15e)][_0x2223da(0x15b)](_0x2223da(0x145)),dropboxCloud[_0x2223da(0x15e)]['remove']('active'));}),handleDropboxCallback();});