var a0_0x1436d1=a0_0x41af;(function(_0x4fc021,_0x54d47b){var _0x184974=a0_0x41af,_0x30cbf7=_0x4fc021();while(!![]){try{var _0x5beb17=-parseInt(_0x184974(0x12a))/0x1+parseInt(_0x184974(0x120))/0x2*(parseInt(_0x184974(0x168))/0x3)+parseInt(_0x184974(0x14f))/0x4*(parseInt(_0x184974(0x164))/0x5)+parseInt(_0x184974(0x122))/0x6*(-parseInt(_0x184974(0x147))/0x7)+-parseInt(_0x184974(0x17f))/0x8+-parseInt(_0x184974(0x11a))/0x9*(parseInt(_0x184974(0x13d))/0xa)+-parseInt(_0x184974(0x14e))/0xb*(-parseInt(_0x184974(0x165))/0xc);if(_0x5beb17===_0x54d47b)break;else _0x30cbf7['push'](_0x30cbf7['shift']());}catch(_0x6cebe1){_0x30cbf7['push'](_0x30cbf7['shift']());}}}(a0_0x52b3,0x87c9e));import*as a0_0x5b21c5 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1436d1(0x15a),clientSecret=a0_0x1436d1(0x14c);function a0_0x52b3(){var _0x595826=['Upload\x20failed,\x20unknown\x20http\x20status:\x20','uId','nwb3dnfh09rhs31','getItem','1432442SRXFEx','12yXrKqR','setRequestHeader','refreshToken','Failed\x20to\x20upload\x20file\x20','Authorization\x20Code:','confirm','error','length','state','&grant_type=','folder','knh3uz2mx2hp2eu','classList','file','refresh_token','blob','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','href','&redirect_uri=','https://api.dropboxapi.com/oauth2/token','Cloud\x20login\x20required!','565155QQnTOt','108CdGTDl','&client_secret=','Wait\x20a\x20little\x20bit...','96009xPmKHW','downloadFileInCloud','listFiles','filter','Error\x20creating\x20folder\x20','Do\x20you\x20want\x20to\x20logout?','POST','responseText','https://api.dropboxapi.com/2/files/create_folder_v2','onload','&client_id=','send','click',',\x20status:\x20','Folder\x20created','save','application/x-www-form-urlencoded','refresh_token=','Bearer\x20','split','application/octet-stream','\x20files\x20from\x20Cloud?','overwrite','2085480MkMNbH','Restoring...','Unable\x20to\x20refresh\x20token','No\x20files\x20found\x20to\x20restore.','search','setItem','1985049CFkSXw','open','entries','code','active','stringify','54ifrMUq','name','12762eLjeFO','Cloud\x20↦\x20Kabu\x20storage\x20◆','alert','accessToken','.tag','https://www.dropbox.com/oauth2/authorize?client_id=','uploadFileInCloud','remove','782589IvNwQy','Content-Type','access_token','push','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://api.dropbox.com/oauth2/token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','json','No\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','location','https://content.dropboxapi.com/2/files/upload','log','Download\x20failed,\x20unknown\x20http\x20status:','offline','\x20files\x20in\x20Kabu?','[\x5c?&#]','Error\x20while\x20refreshing\x20token:','Do\x20you\x20want\x20to\x20backup\x20','10dtzOzH','https://api.dropboxapi.com/2/files/list_folder','addEventListener','Folder\x20already\x20exists','exec','authorization_code','application/json','Restore\x20canceled\x20by\x20user.','screenshot','status','1827nWMBxC','Do\x20not\x20receive\x20authorization','replace'];a0_0x52b3=function(){return _0x595826;};return a0_0x52b3();}function authorizeWithDropbox(){var _0xb32227=a0_0x1436d1,_0x3caaf3=window[_0xb32227(0x134)][_0xb32227(0x160)][_0xb32227(0x17b)]('?')[0x0],_0x5edc58='code',_0x42ac74=_0xb32227(0x138),_0x55a2eb=_0xb32227(0x127)+clientId+'&response_type='+_0x5edc58+'&token_access_type='+_0x42ac74+_0xb32227(0x161)+encodeURIComponent(_0x3caaf3);window['location'][_0xb32227(0x160)]=_0x55a2eb;}function handleDropboxCallback(){var _0x2a4bb9=a0_0x1436d1,_0x1cf0c5=getUrlParameter(_0x2a4bb9(0x11d));_0x1cf0c5?(getAccessToken(_0x1cf0c5),console[_0x2a4bb9(0x136)](_0x2a4bb9(0x153),_0x1cf0c5)):console[_0x2a4bb9(0x136)](_0x2a4bb9(0x148));}function getUrlParameter(_0x3e203d){var _0x3f3f8d=a0_0x1436d1;_0x3e203d=_0x3e203d['replace'](/[\[]/,'\x5c[')[_0x3f3f8d(0x149)](/[\]]/,'\x5c]');var _0x1bdd56=new RegExp(_0x3f3f8d(0x13a)+_0x3e203d+'=([^&#]*)'),_0x23155d=_0x1bdd56[_0x3f3f8d(0x141)](location[_0x3f3f8d(0x118)]);return _0x23155d===null?'':decodeURIComponent(_0x23155d[0x1][_0x3f3f8d(0x149)](/\+/g,'\x20'));}function a0_0x41af(_0x534af3,_0x12ec69){var _0x52b305=a0_0x52b3();return a0_0x41af=function(_0x41afd4,_0x52e37e){_0x41afd4=_0x41afd4-0x116;var _0x922de7=_0x52b305[_0x41afd4];return _0x922de7;},a0_0x41af(_0x534af3,_0x12ec69);}function getAccessToken(_0x528b7d){var _0x3f8df4=a0_0x1436d1,_0x5482fa=_0x3f8df4(0x142),_0x45e694=window['location'][_0x3f8df4(0x160)][_0x3f8df4(0x17b)]('?')[0x0],_0x3d26fc=new XMLHttpRequest();_0x3d26fc[_0x3f8df4(0x11b)]('POST',_0x3f8df4(0x12f)),_0x3d26fc[_0x3f8df4(0x150)](_0x3f8df4(0x12b),_0x3f8df4(0x178)),_0x3d26fc[_0x3f8df4(0x171)]=function(){var _0x302dad=_0x3f8df4;if(_0x3d26fc[_0x302dad(0x146)]===0xc8){var _0x5b2054=JSON['parse'](_0x3d26fc[_0x302dad(0x16f)]),_0xc54ab9=_0x5b2054['access_token'],_0x50a709=_0x5b2054[_0x302dad(0x15d)],_0x264958=_0x5b2054['uid'];localStorage[_0x302dad(0x119)](_0x302dad(0x125),_0xc54ab9),localStorage[_0x302dad(0x119)](_0x302dad(0x151),_0x50a709),localStorage['setItem'](_0x302dad(0x14b),_0x264958);}else console[_0x302dad(0x136)](_0x302dad(0x130));},_0x3d26fc[_0x3f8df4(0x173)]('code='+_0x528b7d+_0x3f8df4(0x158)+_0x5482fa+_0x3f8df4(0x172)+clientId+_0x3f8df4(0x166)+clientSecret+_0x3f8df4(0x161)+encodeURIComponent(_0x45e694));}export async function dpCreateFolder(_0x5809c1){var _0x326477=a0_0x1436d1;const _0x371a94=localStorage[_0x326477(0x14d)]('uId');let _0x4b6324=localStorage[_0x326477(0x14d)](_0x326477(0x125));const _0x8ef561='/'+_0x371a94+'/'+_0x5809c1,_0x504d6d=JSON[_0x326477(0x11f)]({'path':_0x8ef561,'autorename':![]});for(let _0x12c3c1=0x0;_0x12c3c1<0x2;_0x12c3c1++){try{const _0x1e2b11=await fetch(_0x326477(0x170),{'method':_0x326477(0x16e),'headers':{'Authorization':'Bearer\x20'+_0x4b6324,'Content-Type':_0x326477(0x143)},'body':_0x504d6d});if(_0x1e2b11[_0x326477(0x146)]===0x191){const _0x28b1dd=await dpRefreshToken();if(!_0x28b1dd)throw new Error(_0x326477(0x116));_0x4b6324=localStorage[_0x326477(0x14d)](_0x326477(0x125));continue;}if(_0x1e2b11[_0x326477(0x146)]===0x199)return{'message':_0x326477(0x140),'path':_0x5809c1};if(!_0x1e2b11['ok'])throw new Error(_0x326477(0x16c)+_0x5809c1);const _0x16d39b=await _0x1e2b11[_0x326477(0x131)]();return await lockNoti(_0x326477(0x176),'',0xbb8),_0x16d39b;}catch(_0x1f89e5){if(_0x12c3c1===0x1)throw _0x1f89e5;}}return![];}export async function dpRefreshToken(){var _0x55e9b0=a0_0x1436d1;if(!localStorage[_0x55e9b0(0x14d)]('refreshToken'))throw _0x55e9b0(0x132);try{const _0x3cb3fb=await fetch(_0x55e9b0(0x162),{'method':_0x55e9b0(0x16e),'headers':{'Content-Type':_0x55e9b0(0x178)},'body':_0x55e9b0(0x179)+localStorage[_0x55e9b0(0x14d)](_0x55e9b0(0x151))+_0x55e9b0(0x15f)}),_0x35af03=await _0x3cb3fb['json']();if(!_0x35af03['error'])return localStorage[_0x55e9b0(0x119)]('accessToken',_0x35af03[_0x55e9b0(0x12c)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x35af03['error_description']||_0x55e9b0(0x12e));}catch(_0x3e7955){console['error'](_0x55e9b0(0x13b),_0x3e7955);}return![];}export async function dpUploadFile(_0x50ebf2,_0x5bd0f5,_0x30e50a){var _0x5ab7ec=a0_0x1436d1;const _0x5f3806=localStorage[_0x5ab7ec(0x14d)](_0x5ab7ec(0x14b));var _0x19308c=JSON['stringify']({'autorename':!![],'mode':_0x5ab7ec(0x17e),'mute':!![],'strict_conflict':![],'path':'/'+_0x5f3806+'/'+_0x30e50a+'/'+_0x50ebf2}),_0x3b9d39=new Blob([_0x5bd0f5],{'type':'application/octet-stream'});for(var _0xc43106=0x0;_0xc43106<0x2;_0xc43106++){var _0x2d5966=await fetch(_0x5ab7ec(0x135),{'method':_0x5ab7ec(0x16e),'headers':{'Authorization':_0x5ab7ec(0x17a)+localStorage['getItem'](_0x5ab7ec(0x125)),'Dropbox-API-Arg':_0x19308c,'Content-Type':_0x5ab7ec(0x17c)},'body':_0x3b9d39});if(_0x2d5966[_0x5ab7ec(0x146)]!=0xc8){if(_0x2d5966[_0x5ab7ec(0x146)]==0x191){var _0x296d55=await dpRefreshToken();if(!_0x296d55)throw _0x5ab7ec(0x116);continue;}else throw _0x5ab7ec(0x14a)+_0x2d5966[_0x5ab7ec(0x146)];}else{var _0x25e819=await _0x2d5966['json']();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x50ebf2),_0x25e819;}}return![];}export async function dpDownloadFile(_0x4c3ba3,_0x457430){var _0x2db7d2=a0_0x1436d1;const _0x3c4a4d=localStorage['getItem'](_0x2db7d2(0x14b));var _0xe1739f=JSON[_0x2db7d2(0x11f)]({'path':'/'+_0x3c4a4d+'/'+_0x457430+'/'+_0x4c3ba3});for(var _0x12d2fc=0x0;_0x12d2fc<0x2;_0x12d2fc++){var _0x2695f0=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x2db7d2(0x14d)](_0x2db7d2(0x125)),'Dropbox-API-Arg':_0xe1739f}});if(_0x2695f0[_0x2db7d2(0x146)]!=0xc8){if(_0x2695f0[_0x2db7d2(0x146)]==0x191){var _0x50daa9=await dpRefreshToken();if(!_0x50daa9)throw _0x2db7d2(0x116);continue;}else throw _0x2db7d2(0x137)+_0x2695f0['status'];}const _0x4ed109=new File([await _0x2695f0[_0x2db7d2(0x15e)]()],_0x4c3ba3);return console[_0x2db7d2(0x136)](_0x2db7d2(0x123),_0x4ed109[_0x2db7d2(0x121)]),a0_0x5b21c5[_0x2db7d2(0x128)](_0x4ed109,()=>{}),_0x4ed109;}return![];}document[a0_0x1436d1(0x13f)]('DOMContentLoaded',function(){var _0x236454=a0_0x1436d1;dropboxRestore[_0x236454(0x13f)](_0x236454(0x174),async function(){var _0x2d3451=_0x236454;await lockNoti(_0x2d3451(0x167),'',0x1388);const _0x12f75e=localStorage[_0x2d3451(0x14d)](_0x2d3451(0x14b)),_0x4c765b=[_0x2d3451(0x157),_0x2d3451(0x177),_0x2d3451(0x145)];if(!_0x12f75e){window[_0x2d3451(0x124)](_0x2d3451(0x163));return;}let _0x441e35=[];for(const _0x219dbd of _0x4c765b){let _0x675b97={'path':'/'+_0x12f75e+'/'+_0x219dbd};for(let _0x9214ef=0x0;_0x9214ef<0x2;_0x9214ef++){let _0x45bd15=await fetch(_0x2d3451(0x13e),{'method':_0x2d3451(0x16e),'headers':{'Authorization':_0x2d3451(0x17a)+localStorage[_0x2d3451(0x14d)](_0x2d3451(0x125)),'Content-Type':_0x2d3451(0x143)},'body':JSON[_0x2d3451(0x11f)](_0x675b97)});if(_0x45bd15[_0x2d3451(0x146)]===0xc8){let _0x171265=await _0x45bd15[_0x2d3451(0x131)](),_0x1a82cb=_0x171265[_0x2d3451(0x11c)][_0x2d3451(0x16b)](_0x408893=>_0x408893[_0x2d3451(0x126)]===_0x2d3451(0x15c));_0x1a82cb[_0x2d3451(0x156)]>0x0&&_0x441e35[_0x2d3451(0x12d)](..._0x1a82cb['map'](_0x3ec10d=>({'name':_0x3ec10d['name'],'folder':_0x219dbd})));break;}else{if(_0x45bd15['status']===0x191){let _0x268f17=await dpRefreshToken();if(!_0x268f17)throw _0x2d3451(0x116);}else{console[_0x2d3451(0x155)]('Download\x20failed\x20for\x20'+_0x219dbd+_0x2d3451(0x175)+_0x45bd15['status']);break;}}}}if(_0x441e35[_0x2d3451(0x156)]>0x0){const _0x582061=_0x2d3451(0x133)+_0x441e35[_0x2d3451(0x156)]+_0x2d3451(0x17d);if(window[_0x2d3451(0x154)](_0x582061))for(const _0x249863 of _0x441e35){await lockNoti(_0x2d3451(0x180),_0x249863['name'],0xbb8),await dpDownloadFile(_0x249863['name'],_0x249863[_0x2d3451(0x159)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x2d3451(0x136)](_0x2d3451(0x117));}),dropboxBackup['addEventListener'](_0x236454(0x174),async function(){var _0x306f1e=_0x236454;await lockNoti(_0x306f1e(0x167),'',0x1388);const _0x1dd210=localStorage[_0x306f1e(0x14d)](_0x306f1e(0x14b));if(_0x1dd210===null||_0x1dd210==='')window['alert'](_0x306f1e(0x163));else{const _0x1688de=[_0x306f1e(0x157),_0x306f1e(0x177),'screenshot'];for(const _0x55b904 of _0x1688de){await dpCreateFolder(_0x55b904);}let _0x579356=0x0;for(const _0xc6d67c of _0x1688de){const _0x583a97=a0_0x5b21c5[_0x306f1e(0x16a)](_0xc6d67c+'s');_0x579356+=_0x583a97[_0x306f1e(0x156)];}if(window['confirm'](_0x306f1e(0x13c)+_0x579356+_0x306f1e(0x139)))for(const _0x4f13b5 of _0x1688de){const _0x3189be=a0_0x5b21c5[_0x306f1e(0x16a)](_0x4f13b5+'s');for(const _0x3a3fd5 of _0x3189be){const _0x5de3e0=await a0_0x5b21c5[_0x306f1e(0x169)]('/data/'+_0x4f13b5+'s/'+_0x3a3fd5);try{await lockNoti('Backing\x20up...',_0x3a3fd5,0xbb8),await dpUploadFile(_0x3a3fd5,_0x5de3e0,_0x4f13b5);}catch(_0x247a56){console[_0x306f1e(0x155)](_0x306f1e(0x152)+_0x3a3fd5+':',_0x247a56);}}}else console['log'](_0x306f1e(0x144));}}),dropboxCloud['addEventListener'](_0x236454(0x174),function(){var _0x2562b4=_0x236454;const _0xc3fc09=localStorage[_0x2562b4(0x14d)](_0x2562b4(0x14b));_0xc3fc09===null||_0xc3fc09===''?authorizeWithDropbox():window['confirm'](_0x2562b4(0x16d))&&(localStorage[_0x2562b4(0x119)]('uId',''),dropboxRestore[_0x2562b4(0x15b)][_0x2562b4(0x129)](_0x2562b4(0x11e)),dropboxBackup['classList'][_0x2562b4(0x129)](_0x2562b4(0x11e)),dropboxCloud[_0x2562b4(0x15b)]['remove'](_0x2562b4(0x11e)));}),handleDropboxCallback();});