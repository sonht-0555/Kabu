var a0_0x5e3e73=a0_0x316e;(function(_0xc6e721,_0x35d6b7){var _0x2b5506=a0_0x316e,_0x35cf0c=_0xc6e721();while(!![]){try{var _0x3a95e5=parseInt(_0x2b5506(0x149))/0x1*(parseInt(_0x2b5506(0x14c))/0x2)+parseInt(_0x2b5506(0x138))/0x3+-parseInt(_0x2b5506(0x120))/0x4*(-parseInt(_0x2b5506(0x161))/0x5)+parseInt(_0x2b5506(0x11c))/0x6*(-parseInt(_0x2b5506(0x14e))/0x7)+-parseInt(_0x2b5506(0x14d))/0x8+-parseInt(_0x2b5506(0x14b))/0x9+-parseInt(_0x2b5506(0x15f))/0xa;if(_0x3a95e5===_0x35d6b7)break;else _0x35cf0c['push'](_0x35cf0c['shift']());}catch(_0x1c5644){_0x35cf0c['push'](_0x35cf0c['shift']());}}}(a0_0x494c,0x5f360));import*as a0_0xe4987d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5e3e73(0x116),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x69cd56=a0_0x5e3e73,_0x50954a=window['location'][_0x69cd56(0x13f)][_0x69cd56(0x11e)]('?')[0x0],_0x4cbe7b='code',_0x337a2e=_0x69cd56(0x15b),_0x5850ef=_0x69cd56(0x12b)+clientId+_0x69cd56(0x121)+_0x4cbe7b+_0x69cd56(0x133)+_0x337a2e+'&redirect_uri='+encodeURIComponent(_0x50954a);window[_0x69cd56(0x122)][_0x69cd56(0x13f)]=_0x5850ef;}function handleDropboxCallback(){var _0x4089e3=a0_0x5e3e73,_0x39c0cc=getUrlParameter(_0x4089e3(0x12c));_0x39c0cc?(getAccessToken(_0x39c0cc),console[_0x4089e3(0x15c)](_0x4089e3(0x119),_0x39c0cc)):console[_0x4089e3(0x15c)](_0x4089e3(0x16b));}function getUrlParameter(_0x1b899b){var _0xd0f926=a0_0x5e3e73;_0x1b899b=_0x1b899b[_0xd0f926(0x126)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0xf2de0d=new RegExp('[\x5c?&#]'+_0x1b899b+'=([^&#]*)'),_0x36c6e3=_0xf2de0d['exec'](location[_0xd0f926(0x135)]);return _0x36c6e3===null?'':decodeURIComponent(_0x36c6e3[0x1][_0xd0f926(0x126)](/\+/g,'\x20'));}function getAccessToken(_0x417ec5){var _0x3189a3=a0_0x5e3e73,_0xb70f75=_0x3189a3(0x17c),_0x2175cf=window[_0x3189a3(0x122)][_0x3189a3(0x13f)][_0x3189a3(0x11e)]('?')[0x0],_0x4de37f=new XMLHttpRequest();_0x4de37f[_0x3189a3(0x141)](_0x3189a3(0x144),'https://api.dropbox.com/oauth2/token'),_0x4de37f[_0x3189a3(0x158)]('Content-Type',_0x3189a3(0x13c)),_0x4de37f[_0x3189a3(0x16a)]=function(){var _0x724e42=_0x3189a3;if(_0x4de37f[_0x724e42(0x11f)]===0xc8){var _0x4a07bf=JSON['parse'](_0x4de37f['responseText']),_0x392b1a=_0x4a07bf[_0x724e42(0x165)],_0x970542=_0x4a07bf['refresh_token'],_0x142391=_0x4a07bf['uid'];localStorage[_0x724e42(0x154)](_0x724e42(0x13a),_0x392b1a),localStorage[_0x724e42(0x154)](_0x724e42(0x13d),_0x970542),localStorage[_0x724e42(0x154)](_0x724e42(0x132),_0x142391);}else console[_0x724e42(0x15c)](_0x724e42(0x179));},_0x4de37f[_0x3189a3(0x130)](_0x3189a3(0x11a)+_0x417ec5+_0x3189a3(0x128)+_0xb70f75+_0x3189a3(0x142)+clientId+'&client_secret='+clientSecret+_0x3189a3(0x17a)+encodeURIComponent(_0x2175cf));}function a0_0x316e(_0x18ad53,_0x1138a9){var _0x494ca7=a0_0x494c();return a0_0x316e=function(_0x316ef9,_0x15eb63){_0x316ef9=_0x316ef9-0x116;var _0x23ca08=_0x494ca7[_0x316ef9];return _0x23ca08;},a0_0x316e(_0x18ad53,_0x1138a9);}export async function dpCreateFolder(_0x713c95){var _0x3688b0=a0_0x5e3e73;const _0x181f9b=localStorage[_0x3688b0(0x155)](_0x3688b0(0x132));let _0x1f33fc=localStorage['getItem'](_0x3688b0(0x13a));const _0x544534='/'+_0x181f9b+'/'+_0x713c95,_0x2f6b22=JSON[_0x3688b0(0x162)]({'path':_0x544534,'autorename':![]});for(let _0x43984e=0x0;_0x43984e<0x2;_0x43984e++){try{const _0x1573dd=await fetch(_0x3688b0(0x136),{'method':_0x3688b0(0x144),'headers':{'Authorization':_0x3688b0(0x11d)+_0x1f33fc,'Content-Type':_0x3688b0(0x15a)},'body':_0x2f6b22});if(_0x1573dd[_0x3688b0(0x11f)]===0x191){const _0x239f67=await dpRefreshToken();if(!_0x239f67)throw new Error(_0x3688b0(0x143));_0x1f33fc=localStorage[_0x3688b0(0x155)](_0x3688b0(0x13a));continue;}if(_0x1573dd[_0x3688b0(0x11f)]===0x199)return{'message':_0x3688b0(0x178),'path':_0x713c95};if(!_0x1573dd['ok'])throw new Error(_0x3688b0(0x159)+_0x713c95);const _0x21107b=await _0x1573dd[_0x3688b0(0x173)]();return await lockNoti(_0x3688b0(0x147),'',0xbb8),_0x21107b;}catch(_0x116aed){if(_0x43984e===0x1)throw _0x116aed;}}return![];}export async function dpRefreshToken(){var _0x1c09fd=a0_0x5e3e73;if(!localStorage[_0x1c09fd(0x155)](_0x1c09fd(0x13d)))throw _0x1c09fd(0x152);try{const _0x433dda=await fetch(_0x1c09fd(0x172),{'method':_0x1c09fd(0x144),'headers':{'Content-Type':_0x1c09fd(0x13c)},'body':_0x1c09fd(0x168)+localStorage['getItem'](_0x1c09fd(0x13d))+_0x1c09fd(0x123)}),_0x201bd0=await _0x433dda[_0x1c09fd(0x173)]();if(!_0x201bd0[_0x1c09fd(0x176)])return localStorage['setItem']('accessToken',_0x201bd0[_0x1c09fd(0x165)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x201bd0[_0x1c09fd(0x13b)]||_0x1c09fd(0x15d));}catch(_0x2ba0b5){console[_0x1c09fd(0x176)](_0x1c09fd(0x16d),_0x2ba0b5);}return![];}function a0_0x494c(){var _0x3db76a=['split','status','930352ntkBtq','&response_type=','location','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Restore\x20canceled\x20by\x20user.','list','replace','https://content.dropboxapi.com/2/files/download','&grant_type=','Restoring...','FSSync','https://www.dropbox.com/oauth2/authorize?client_id=','code','Do\x20you\x20want\x20to\x20logout?','Cloud\x20↦\x20Kabu\x20storage\x20◆','blob','send','active','uId','&token_access_type=',',\x20status:\x20','search','https://api.dropboxapi.com/2/files/create_folder_v2','Do\x20you\x20want\x20to\x20restore\x20','138609EGyHDT','\x20files\x20in\x20Kabu?','accessToken','error_description','application/x-www-form-urlencoded','refreshToken','screenshot','href','length','open','&client_id=','Unable\x20to\x20refresh\x20token','POST','overwrite','No\x20files\x20found\x20to\x20restore.','Folder\x20created','/data/','126Wwegox','DOMContentLoaded','77346dcLFMo','7358rhZDxp','2490048FXSlUu','21MmaDgn','Cloud\x20login\x20required!','Failed\x20to\x20upload\x20file\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','No\x20refresh\x20token','alert','setItem','getItem','push','\x20files\x20from\x20Cloud?','setRequestHeader','Error\x20creating\x20folder\x20','application/json','offline','log','Failed\x20to\x20refresh\x20Dropbox\x20token.','confirm','2086790hDdtdw','folder','15IRrCNd','stringify','name','map','access_token','save','remove','refresh_token=','toUpperCase','onload','Do\x20not\x20receive\x20authorization','Download\x20failed,\x20unknown\x20http\x20status:','Error\x20while\x20refreshing\x20token:','Download\x20failed\x20for\x20','slice','application/octet-stream','https://api.dropboxapi.com/2/files/list_folder','https://api.dropboxapi.com/oauth2/token','json','click','.tag','error','classList','Folder\x20already\x20exists','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&redirect_uri=','Backing\x20up...','authorization_code','knh3uz2mx2hp2eu','addEventListener','Wait\x20a\x20little\x20bit...','Authorization\x20Code:','code=','file','578016OfixQH','Bearer\x20'];a0_0x494c=function(){return _0x3db76a;};return a0_0x494c();}export async function dpUploadFile(_0x5eea30,_0x3d1a94,_0x30f46f){var _0xf89295=a0_0x5e3e73;const _0x37ca4d=localStorage['getItem'](_0xf89295(0x132));var _0x8f57e8=JSON[_0xf89295(0x162)]({'autorename':!![],'mode':_0xf89295(0x145),'mute':!![],'strict_conflict':![],'path':'/'+_0x37ca4d+'/'+_0x30f46f+'/'+_0x5eea30}),_0xd64c9=new Blob([_0x3d1a94],{'type':_0xf89295(0x170)});for(var _0x28fb93=0x0;_0x28fb93<0x2;_0x28fb93++){var _0x521ca0=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0xf89295(0x11d)+localStorage['getItem'](_0xf89295(0x13a)),'Dropbox-API-Arg':_0x8f57e8,'Content-Type':_0xf89295(0x170)},'body':_0xd64c9});if(_0x521ca0[_0xf89295(0x11f)]!=0xc8){if(_0x521ca0['status']==0x191){var _0x5eabc6=await dpRefreshToken();if(!_0x5eabc6)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x521ca0['status'];}else{var _0x3b5652=await _0x521ca0['json']();return console[_0xf89295(0x15c)](_0xf89295(0x151),_0x5eea30),_0x3b5652;}}return![];}export async function dpDownloadFile(_0x291949,_0x5cdc07){var _0x126000=a0_0x5e3e73;const _0x4e4a59=localStorage[_0x126000(0x155)](_0x126000(0x132));var _0x254541=JSON[_0x126000(0x162)]({'path':'/'+_0x4e4a59+'/'+_0x5cdc07+'/'+_0x291949});for(var _0x2cd617=0x0;_0x2cd617<0x2;_0x2cd617++){var _0x323433=await fetch(_0x126000(0x127),{'method':_0x126000(0x144),'headers':{'Authorization':_0x126000(0x11d)+localStorage[_0x126000(0x155)](_0x126000(0x13a)),'Dropbox-API-Arg':_0x254541}});if(_0x323433['status']!=0xc8){if(_0x323433['status']==0x191){var _0x1ffa59=await dpRefreshToken();if(!_0x1ffa59)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x126000(0x16c)+_0x323433[_0x126000(0x11f)];}const _0x98ce17=new File([await _0x323433[_0x126000(0x12f)]()],_0x291949);return console[_0x126000(0x15c)](_0x126000(0x12e),_0x98ce17[_0x126000(0x163)]),a0_0xe4987d['uploadFileInCloud'](_0x98ce17,()=>{var _0x45ab0e=_0x126000;localStorageFile(),Module[_0x45ab0e(0x12a)]();}),_0x98ce17;}return![];}document[a0_0x5e3e73(0x117)](a0_0x5e3e73(0x14a),function(){var _0x4554be=a0_0x5e3e73;dropboxRestore[_0x4554be(0x117)](_0x4554be(0x174),async function(){var _0x176d56=_0x4554be;await lockNoti(_0x176d56(0x118),'',0x1388);const _0x5da10b=localStorage[_0x176d56(0x155)](_0x176d56(0x132)),_0x1fd3ed=['state',_0x176d56(0x166),_0x176d56(0x13e)];if(!_0x5da10b){window[_0x176d56(0x153)]('Cloud\x20login\x20required!');return;}let _0x45bdfb=[];for(const _0x4dab0d of _0x1fd3ed){let _0x581660={'path':'/'+_0x5da10b+'/'+_0x4dab0d};for(let _0x2bd196=0x0;_0x2bd196<0x2;_0x2bd196++){let _0x263408=await fetch(_0x176d56(0x171),{'method':_0x176d56(0x144),'headers':{'Authorization':_0x176d56(0x11d)+localStorage[_0x176d56(0x155)](_0x176d56(0x13a)),'Content-Type':_0x176d56(0x15a)},'body':JSON[_0x176d56(0x162)](_0x581660)});if(_0x263408[_0x176d56(0x11f)]===0xc8){let _0xbad3e0=await _0x263408[_0x176d56(0x173)](),_0x3513f6=_0xbad3e0['entries']['filter'](_0x3e63e5=>_0x3e63e5[_0x176d56(0x175)]===_0x176d56(0x11b));_0x3513f6['length']>0x0&&_0x45bdfb[_0x176d56(0x156)](..._0x3513f6[_0x176d56(0x164)](_0x3aff59=>({'name':_0x3aff59['name'],'folder':_0x4dab0d})));break;}else{if(_0x263408[_0x176d56(0x11f)]===0x191){let _0x55a7a7=await dpRefreshToken();if(!_0x55a7a7)throw _0x176d56(0x143);}else{console[_0x176d56(0x176)](_0x176d56(0x16e)+_0x4dab0d+_0x176d56(0x134)+_0x263408['status']);break;}}}}if(_0x45bdfb[_0x176d56(0x140)]>0x0){const _0x1b69d7=_0x176d56(0x137)+_0x45bdfb['length']+_0x176d56(0x157);if(window[_0x176d56(0x15e)](_0x1b69d7))for(const _0x16f08b of _0x45bdfb){await lockNoti(_0x176d56(0x129),_0x16f08b[_0x176d56(0x163)],0xbb8),await dpDownloadFile(_0x16f08b['name'],_0x16f08b[_0x176d56(0x160)]);}else console['log'](_0x176d56(0x124));}else console[_0x176d56(0x15c)](_0x176d56(0x146));}),dropboxBackup['addEventListener'](_0x4554be(0x174),async function(){var _0x3b4d24=_0x4554be;await lockNoti(_0x3b4d24(0x118),'',0x1388);const _0x41ce71=localStorage[_0x3b4d24(0x155)](_0x3b4d24(0x132));if(_0x41ce71===null||_0x41ce71==='')window[_0x3b4d24(0x153)](_0x3b4d24(0x14f));else{const _0x5f2f77=['state',_0x3b4d24(0x166),_0x3b4d24(0x13e)];for(const _0x590f9b of _0x5f2f77){await dpCreateFolder(_0x590f9b);}let _0x41da6d=0x0;for(const _0x4f15ac of _0x5f2f77){const _0x5c0add=a0_0xe4987d[_0x3b4d24(0x125)+(_0x4f15ac['charAt'](0x0)[_0x3b4d24(0x169)]()+_0x4f15ac[_0x3b4d24(0x16f)](0x1))]();_0x41da6d+=_0x5c0add['length'];}if(window[_0x3b4d24(0x15e)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x41da6d+_0x3b4d24(0x139)))for(const _0x1950b2 of _0x5f2f77){const _0x217231=a0_0xe4987d[_0x3b4d24(0x125)+(_0x1950b2['charAt'](0x0)[_0x3b4d24(0x169)]()+_0x1950b2[_0x3b4d24(0x16f)](0x1))]();for(const _0x309ddc of _0x217231){const _0x1c15f7=await a0_0xe4987d['downloadFileInCloud'](_0x3b4d24(0x148)+_0x1950b2+'s/'+_0x309ddc);try{await lockNoti(_0x3b4d24(0x17b),_0x309ddc,0xbb8),await dpUploadFile(_0x309ddc,_0x1c15f7,_0x1950b2);}catch(_0x4dafb1){console['error'](_0x3b4d24(0x150)+_0x309ddc+':',_0x4dafb1);}}}else console[_0x3b4d24(0x15c)](_0x3b4d24(0x124));}}),dropboxCloud[_0x4554be(0x117)](_0x4554be(0x174),function(){var _0x5632f1=_0x4554be;const _0x26a370=localStorage['getItem']('uId');_0x26a370===null||_0x26a370===''?authorizeWithDropbox():window['confirm'](_0x5632f1(0x12d))&&(localStorage[_0x5632f1(0x154)](_0x5632f1(0x132),''),dropboxRestore[_0x5632f1(0x177)][_0x5632f1(0x167)](_0x5632f1(0x131)),dropboxBackup[_0x5632f1(0x177)][_0x5632f1(0x167)](_0x5632f1(0x131)),dropboxCloud[_0x5632f1(0x177)][_0x5632f1(0x167)](_0x5632f1(0x131)));}),handleDropboxCallback();});