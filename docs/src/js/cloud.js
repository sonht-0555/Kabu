function a0_0x3b9a(){var _0x347e00=['2973501MBHYDs','replace','refreshToken','setItem','application/json','screenshot','\x20files\x20in\x20Kabu?','downloadFileInCloud','uploadFileInCloud','105664LLeGch','map','classList','access_token','length','code','Error\x20creating\x20folder\x20','Do\x20not\x20receive\x20authorization','DOMContentLoaded','&token_access_type=','10nKTioH','POST','blob','name','No\x20files\x20found\x20to\x20restore.','status','Bearer\x20','84rjJVnI','Folder\x20created','https://www.dropbox.com/oauth2/authorize?client_id=','Failed\x20to\x20upload\x20file\x20','Refreshing\x20token...','search','uId','&response_type=','Content-Type','&grant_type=','Restoring...','application/x-www-form-urlencoded','&client_secret=','Wait\x20a\x20little\x20bit...','Backing\x20up...','click','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/2/files/list_folder','location','2770572vKaWqJ','https://content.dropboxapi.com/2/files/upload','state','overwrite','[\x5c?&#]','authorization_code','file','confirm','Kabu\x20storage\x20↦\x20Cloud\x20◆','offline','&redirect_uri=','244716pqzCDT','setRequestHeader','Restore\x20canceled\x20by\x20user.','remove','open','push','7JJEfGx','248458YXCqtc','exec','code=','href','110676ctqXkJ','Do\x20you\x20want\x20to\x20logout?','=([^&#]*)','Authorization\x20Code:','&client_id=','https://api.dropbox.com/oauth2/token','/data/','application/octet-stream','accessToken','Download\x20failed,\x20unknown\x20http\x20status:','onload','stringify','log','https://content.dropboxapi.com/2/files/download','uid','1826haxpdg','knh3uz2mx2hp2eu','Error\x20while\x20refreshing\x20token:','Do\x20you\x20want\x20to\x20restore\x20','Cloud\x20login\x20required!','https://api.dropboxapi.com/oauth2/token','Cloud\x20↦\x20Kabu\x20storage\x20◆',',\x20status:\x20','71035mXcJrL','.tag','folder','entries','alert','error','getItem','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','json','listFiles','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','27PMLheU','active','addEventListener','No\x20refresh\x20token','Failed\x20to\x20refresh\x20Dropbox\x20token.'];a0_0x3b9a=function(){return _0x347e00;};return a0_0x3b9a();}var a0_0x506c13=a0_0x46a9;(function(_0x4d4745,_0x3300d0){var _0x3f4470=a0_0x46a9,_0x1de090=_0x4d4745();while(!![]){try{var _0x4a3944=-parseInt(_0x3f4470(0x1e3))/0x1+parseInt(_0x3f4470(0x1ea))/0x2*(-parseInt(_0x3f4470(0x1a6))/0x3)+-parseInt(_0x3f4470(0x1c5))/0x4*(-parseInt(_0x3f4470(0x19b))/0x5)+parseInt(_0x3f4470(0x1d8))/0x6+-parseInt(_0x3f4470(0x1e9))/0x7*(parseInt(_0x3f4470(0x1b4))/0x8)+parseInt(_0x3f4470(0x1ab))/0x9*(-parseInt(_0x3f4470(0x1be))/0xa)+parseInt(_0x3f4470(0x193))/0xb*(parseInt(_0x3f4470(0x184))/0xc);if(_0x4a3944===_0x3300d0)break;else _0x1de090['push'](_0x1de090['shift']());}catch(_0x31467){_0x1de090['push'](_0x1de090['shift']());}}}(a0_0x3b9a,0x8ec31));import*as a0_0x43471e from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x506c13(0x194),clientSecret='nwb3dnfh09rhs31';function a0_0x46a9(_0x9ce9e,_0xd8100){var _0x3b9a22=a0_0x3b9a();return a0_0x46a9=function(_0x46a916,_0x28b985){_0x46a916=_0x46a916-0x182;var _0xfe4d54=_0x3b9a22[_0x46a916];return _0xfe4d54;},a0_0x46a9(_0x9ce9e,_0xd8100);}function authorizeWithDropbox(){var _0x194a58=a0_0x506c13,_0x4c1f0d=window[_0x194a58(0x1d7)][_0x194a58(0x183)]['split']('?')[0x0],_0x526963=_0x194a58(0x1b9),_0x5e833b=_0x194a58(0x1e1),_0x5e54f6=_0x194a58(0x1c7)+clientId+_0x194a58(0x1cc)+_0x526963+_0x194a58(0x1bd)+_0x5e833b+_0x194a58(0x1e2)+encodeURIComponent(_0x4c1f0d);window[_0x194a58(0x1d7)][_0x194a58(0x183)]=_0x5e54f6;}function handleDropboxCallback(){var _0x4d2708=a0_0x506c13,_0x40949e=getUrlParameter(_0x4d2708(0x1b9));_0x40949e?(getAccessToken(_0x40949e),console[_0x4d2708(0x190)](_0x4d2708(0x187),_0x40949e)):console[_0x4d2708(0x190)](_0x4d2708(0x1bb));}function getUrlParameter(_0x1ef4d9){var _0xd4faf3=a0_0x506c13;_0x1ef4d9=_0x1ef4d9[_0xd4faf3(0x1ac)](/[\[]/,'\x5c[')[_0xd4faf3(0x1ac)](/[\]]/,'\x5c]');var _0x271eba=new RegExp(_0xd4faf3(0x1dc)+_0x1ef4d9+_0xd4faf3(0x186)),_0x413f4c=_0x271eba[_0xd4faf3(0x1eb)](location[_0xd4faf3(0x1ca)]);return _0x413f4c===null?'':decodeURIComponent(_0x413f4c[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x34fd5b){var _0x50342d=a0_0x506c13,_0x91b505=_0x50342d(0x1dd),_0x2443b5=window[_0x50342d(0x1d7)][_0x50342d(0x183)]['split']('?')[0x0],_0x505199=new XMLHttpRequest();_0x505199[_0x50342d(0x1e7)](_0x50342d(0x1bf),_0x50342d(0x189)),_0x505199[_0x50342d(0x1e4)](_0x50342d(0x1cd),_0x50342d(0x1d0)),_0x505199[_0x50342d(0x18e)]=function(){var _0x4d86b7=_0x50342d;if(_0x505199[_0x4d86b7(0x1c3)]===0xc8){var _0x30f3b4=JSON['parse'](_0x505199['responseText']),_0xbd3761=_0x30f3b4[_0x4d86b7(0x1b7)],_0x20534f=_0x30f3b4['refresh_token'],_0xffde72=_0x30f3b4[_0x4d86b7(0x192)];localStorage[_0x4d86b7(0x1ae)](_0x4d86b7(0x18c),_0xbd3761),localStorage[_0x4d86b7(0x1ae)](_0x4d86b7(0x1ad),_0x20534f),localStorage[_0x4d86b7(0x1ae)](_0x4d86b7(0x1cb),_0xffde72);}else console[_0x4d86b7(0x190)](_0x4d86b7(0x1a2));},_0x505199['send'](_0x50342d(0x182)+_0x34fd5b+_0x50342d(0x1ce)+_0x91b505+_0x50342d(0x188)+clientId+_0x50342d(0x1d1)+clientSecret+_0x50342d(0x1e2)+encodeURIComponent(_0x2443b5));}export async function dpCreateFolder(_0x594eaa){var _0x56e112=a0_0x506c13;const _0x484700=localStorage[_0x56e112(0x1a1)](_0x56e112(0x1cb));let _0x9f40f=localStorage[_0x56e112(0x1a1)](_0x56e112(0x18c));const _0x4827da='/'+_0x484700+'/'+_0x594eaa,_0x225723=JSON[_0x56e112(0x18f)]({'path':_0x4827da,'autorename':![]});for(let _0x16653c=0x0;_0x16653c<0x2;_0x16653c++){try{const _0x380627=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x56e112(0x1bf),'headers':{'Authorization':_0x56e112(0x1c4)+_0x9f40f,'Content-Type':_0x56e112(0x1af)},'body':_0x225723});if(_0x380627[_0x56e112(0x1c3)]===0x191){const _0x4352de=await dpRefreshToken();if(!_0x4352de)throw new Error('Unable\x20to\x20refresh\x20token');_0x9f40f=localStorage[_0x56e112(0x1a1)](_0x56e112(0x18c));continue;}if(_0x380627[_0x56e112(0x1c3)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x594eaa};if(!_0x380627['ok'])throw new Error(_0x56e112(0x1ba)+_0x594eaa);const _0x541554=await _0x380627[_0x56e112(0x1a3)]();return await lockNoti(_0x56e112(0x1c6),'',0xbb8),_0x541554;}catch(_0x393798){if(_0x16653c===0x1)throw _0x393798;}}return![];}export async function dpRefreshToken(){var _0x3774f7=a0_0x506c13;if(!localStorage[_0x3774f7(0x1a1)](_0x3774f7(0x1ad)))throw _0x3774f7(0x1a9);try{const _0x263c79=await fetch(_0x3774f7(0x198),{'method':_0x3774f7(0x1bf),'headers':{'Content-Type':_0x3774f7(0x1d0)},'body':'refresh_token='+localStorage[_0x3774f7(0x1a1)]('refreshToken')+_0x3774f7(0x1a5)}),_0x420c96=await _0x263c79['json']();if(!_0x420c96[_0x3774f7(0x1a0)])return localStorage[_0x3774f7(0x1ae)](_0x3774f7(0x18c),_0x420c96[_0x3774f7(0x1b7)]),await lockNoti(_0x3774f7(0x1c9),'',0xbb8),await delay(0x3e8),!![];else alert(_0x420c96['error_description']||_0x3774f7(0x1aa));}catch(_0x1383f7){console['error'](_0x3774f7(0x195),_0x1383f7);}return![];}export async function dpUploadFile(_0x2115f0,_0x2b0df5,_0x209ef1){var _0x21a13c=a0_0x506c13;const _0x449bff=localStorage[_0x21a13c(0x1a1)](_0x21a13c(0x1cb));var _0x5b5e4e=JSON[_0x21a13c(0x18f)]({'autorename':!![],'mode':_0x21a13c(0x1db),'mute':!![],'strict_conflict':![],'path':'/'+_0x449bff+'/'+_0x209ef1+'/'+_0x2115f0}),_0x3030ed=new Blob([_0x2b0df5],{'type':_0x21a13c(0x18b)});for(var _0x421d1e=0x0;_0x421d1e<0x2;_0x421d1e++){var _0xa4126e=await fetch(_0x21a13c(0x1d9),{'method':'POST','headers':{'Authorization':_0x21a13c(0x1c4)+localStorage['getItem'](_0x21a13c(0x18c)),'Dropbox-API-Arg':_0x5b5e4e,'Content-Type':_0x21a13c(0x18b)},'body':_0x3030ed});if(_0xa4126e[_0x21a13c(0x1c3)]!=0xc8){if(_0xa4126e['status']==0x191){var _0x17eeaf=await dpRefreshToken();if(!_0x17eeaf)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0xa4126e[_0x21a13c(0x1c3)];}else{var _0x5c87de=await _0xa4126e[_0x21a13c(0x1a3)]();return console[_0x21a13c(0x190)](_0x21a13c(0x1e0),_0x2115f0),_0x5c87de;}}return![];}export async function dpDownloadFile(_0x38d001,_0x9af3){var _0x134dff=a0_0x506c13;const _0x345eba=localStorage['getItem'](_0x134dff(0x1cb));var _0x510c8e=JSON[_0x134dff(0x18f)]({'path':'/'+_0x345eba+'/'+_0x9af3+'/'+_0x38d001});for(var _0x1db1a3=0x0;_0x1db1a3<0x2;_0x1db1a3++){var _0x3d112c=await fetch(_0x134dff(0x191),{'method':_0x134dff(0x1bf),'headers':{'Authorization':_0x134dff(0x1c4)+localStorage[_0x134dff(0x1a1)]('accessToken'),'Dropbox-API-Arg':_0x510c8e}});if(_0x3d112c[_0x134dff(0x1c3)]!=0xc8){if(_0x3d112c[_0x134dff(0x1c3)]==0x191){var _0xc68d8b=await dpRefreshToken();if(!_0xc68d8b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x134dff(0x18d)+_0x3d112c[_0x134dff(0x1c3)];}const _0x50d323=new File([await _0x3d112c[_0x134dff(0x1c0)]()],_0x38d001);return console[_0x134dff(0x190)](_0x134dff(0x199),_0x50d323['name']),a0_0x43471e[_0x134dff(0x1b3)](_0x50d323,()=>{}),_0x50d323;}return![];}document[a0_0x506c13(0x1a8)](a0_0x506c13(0x1bc),function(){var _0x556d0a=a0_0x506c13;dropboxRestore[_0x556d0a(0x1a8)]('click',async function(){var _0x209791=_0x556d0a;await lockNoti(_0x209791(0x1d2),'',0x1388);const _0x3675c6=localStorage['getItem'](_0x209791(0x1cb)),_0x1d5a69=[_0x209791(0x1da),'save',_0x209791(0x1b0)];if(!_0x3675c6){window[_0x209791(0x19f)]('Cloud\x20login\x20required!');return;}let _0x5cbb40=[];for(const _0x146149 of _0x1d5a69){let _0x16465c={'path':'/'+_0x3675c6+'/'+_0x146149};for(let _0x506740=0x0;_0x506740<0x2;_0x506740++){let _0x12cdd1=await fetch(_0x209791(0x1d6),{'method':_0x209791(0x1bf),'headers':{'Authorization':_0x209791(0x1c4)+localStorage[_0x209791(0x1a1)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x209791(0x18f)](_0x16465c)});if(_0x12cdd1['status']===0xc8){let _0x4bbb79=await _0x12cdd1['json'](),_0x54ca77=_0x4bbb79[_0x209791(0x19e)]['filter'](_0x53d9d9=>_0x53d9d9[_0x209791(0x19c)]===_0x209791(0x1de));_0x54ca77['length']>0x0&&_0x5cbb40[_0x209791(0x1e8)](..._0x54ca77[_0x209791(0x1b5)](_0x23df74=>({'name':_0x23df74[_0x209791(0x1c1)],'folder':_0x146149})));break;}else{if(_0x12cdd1[_0x209791(0x1c3)]===0x191){let _0x6bf1a9=await dpRefreshToken();if(!_0x6bf1a9)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x209791(0x1a0)]('Download\x20failed\x20for\x20'+_0x146149+_0x209791(0x19a)+_0x12cdd1[_0x209791(0x1c3)]);break;}}}}if(_0x5cbb40[_0x209791(0x1b8)]>0x0){const _0x12dd91=_0x209791(0x196)+_0x5cbb40[_0x209791(0x1b8)]+_0x209791(0x1d5);if(window[_0x209791(0x1df)](_0x12dd91))for(const _0x167a6e of _0x5cbb40){await lockNoti(_0x209791(0x1cf),_0x167a6e['name'],0xbb8),await dpDownloadFile(_0x167a6e[_0x209791(0x1c1)],_0x167a6e[_0x209791(0x19d)]);}else console[_0x209791(0x190)]('Restore\x20canceled\x20by\x20user.');}else console[_0x209791(0x190)](_0x209791(0x1c2));}),dropboxBackup[_0x556d0a(0x1a8)](_0x556d0a(0x1d4),async function(){var _0x3c5f3e=_0x556d0a;await lockNoti(_0x3c5f3e(0x1d2),'',0x1388);const _0x56ba4a=localStorage[_0x3c5f3e(0x1a1)]('uId');if(_0x56ba4a===null||_0x56ba4a==='')window[_0x3c5f3e(0x19f)](_0x3c5f3e(0x197));else{const _0x335b1e=[_0x3c5f3e(0x1da),'save',_0x3c5f3e(0x1b0)];for(const _0x378c0d of _0x335b1e){await dpCreateFolder(_0x378c0d);}let _0x4b7ba8=0x0;for(const _0x32a7a2 of _0x335b1e){const _0x305530=a0_0x43471e[_0x3c5f3e(0x1a4)](_0x32a7a2+'s');_0x4b7ba8+=_0x305530[_0x3c5f3e(0x1b8)];}if(window[_0x3c5f3e(0x1df)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4b7ba8+_0x3c5f3e(0x1b1)))for(const _0x4d3df2 of _0x335b1e){const _0x44ffb0=a0_0x43471e[_0x3c5f3e(0x1a4)](_0x4d3df2+'s');for(const _0x4de0a3 of _0x44ffb0){const _0x2c4e2d=await a0_0x43471e[_0x3c5f3e(0x1b2)](_0x3c5f3e(0x18a)+_0x4d3df2+'s/'+_0x4de0a3);try{await lockNoti(_0x3c5f3e(0x1d3),_0x4de0a3,0xbb8),await dpUploadFile(_0x4de0a3,_0x2c4e2d,_0x4d3df2);}catch(_0x470099){console[_0x3c5f3e(0x1a0)](_0x3c5f3e(0x1c8)+_0x4de0a3+':',_0x470099);}}}else console[_0x3c5f3e(0x190)](_0x3c5f3e(0x1e5));}}),dropboxCloud[_0x556d0a(0x1a8)](_0x556d0a(0x1d4),function(){var _0x5a465b=_0x556d0a;const _0x14908c=localStorage[_0x5a465b(0x1a1)](_0x5a465b(0x1cb));_0x14908c===null||_0x14908c===''?authorizeWithDropbox():window['confirm'](_0x5a465b(0x185))&&(localStorage['setItem'](_0x5a465b(0x1cb),''),dropboxRestore[_0x5a465b(0x1b6)][_0x5a465b(0x1e6)](_0x5a465b(0x1a7)),dropboxBackup[_0x5a465b(0x1b6)][_0x5a465b(0x1e6)](_0x5a465b(0x1a7)),dropboxCloud[_0x5a465b(0x1b6)][_0x5a465b(0x1e6)](_0x5a465b(0x1a7)));}),handleDropboxCallback();});