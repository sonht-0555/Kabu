var a0_0x1c61b4=a0_0x1756;(function(_0x14ca26,_0x3eb3b1){var _0x32de94=a0_0x1756,_0x2beca0=_0x14ca26();while(!![]){try{var _0x7f9e12=parseInt(_0x32de94(0xcb))/0x1*(-parseInt(_0x32de94(0xbf))/0x2)+-parseInt(_0x32de94(0xba))/0x3+parseInt(_0x32de94(0xfd))/0x4*(parseInt(_0x32de94(0xf2))/0x5)+parseInt(_0x32de94(0xf9))/0x6*(-parseInt(_0x32de94(0xe0))/0x7)+-parseInt(_0x32de94(0xfb))/0x8*(-parseInt(_0x32de94(0xd5))/0x9)+parseInt(_0x32de94(0xf8))/0xa*(parseInt(_0x32de94(0xe8))/0xb)+parseInt(_0x32de94(0x110))/0xc;if(_0x7f9e12===_0x3eb3b1)break;else _0x2beca0['push'](_0x2beca0['shift']());}catch(_0x5aec22){_0x2beca0['push'](_0x2beca0['shift']());}}}(a0_0x23c4,0x1c500));import*as a0_0x55335b from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x23c4(){var _0x19501d=['POST','&grant_type=','confirm','22ehBOvF','status','Folder\x20already\x20exists','href','split','active','.tag','Cloud\x20login\x20required!','Error\x20creating\x20folder\x20','Upload\x20failed,\x20unknown\x20http\x20status:\x20','code=','json','12973VoEMFK','Authorization\x20Code:','location','Error\x20while\x20refreshing\x20token:','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','map','alert','onload','Restore\x20canceled\x20by\x20user.','classList','9ImcYvc','&client_id=','listFiles','https://api.dropbox.com/oauth2/token','folder',',\x20status:\x20','&client_secret=','https://www.dropbox.com/oauth2/authorize?client_id=','Wait\x20a\x20little\x20bit...','https://content.dropboxapi.com/2/files/upload','remove','1267PKurbi','code','entries','refreshToken','filter','error_description','state','Do\x20not\x20receive\x20authorization','11EDqdVX','=([^&#]*)','&redirect_uri=','\x20files\x20from\x20Cloud?','log','Unable\x20to\x20refresh\x20token','https://api.dropboxapi.com/2/files/create_folder_v2','setRequestHeader','DOMContentLoaded','name','1051815TtAwCb','click','setItem','Do\x20you\x20want\x20to\x20restore\x20','Content-Type','refresh_token=','1936390vLGeJm','7188ajSPea','application/octet-stream','45648Ailzzj','exec','4SaZALa','length','file','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Folder\x20created','uploadFileInCloud','Bearer\x20','error','/data/','Cloud\x20↦\x20Kabu\x20storage\x20◆','addEventListener','&token_access_type=','accessToken','uid','stringify','getItem','screenshot','application/json','Kabu\x20storage\x20↦\x20Cloud\x20◆','3240876yOtJMk','access_token','uId','Do\x20you\x20want\x20to\x20backup\x20','downloadFileInCloud','save','Refreshing\x20token...','Failed\x20to\x20upload\x20file\x20','knh3uz2mx2hp2eu','search','replace','send','Download\x20failed,\x20unknown\x20http\x20status:','Backing\x20up...','[\x5c?&#]','612816fVmGXi','Do\x20you\x20want\x20to\x20logout?'];a0_0x23c4=function(){return _0x19501d;};return a0_0x23c4();}function a0_0x1756(_0x1890e5,_0x53523d){var _0x23c4d7=a0_0x23c4();return a0_0x1756=function(_0x175678,_0x5c454d){_0x175678=_0x175678-0xb7;var _0x1b7300=_0x23c4d7[_0x175678];return _0x1b7300;},a0_0x1756(_0x1890e5,_0x53523d);}var clientId=a0_0x1c61b4(0x118),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4494a5=a0_0x1c61b4,_0x5ae898=window[_0x4494a5(0xcd)]['href'][_0x4494a5(0xc3)]('?')[0x0],_0xb44192=_0x4494a5(0xe1),_0x59255d='offline',_0x2e2714=_0x4494a5(0xdc)+clientId+'&response_type='+_0xb44192+_0x4494a5(0x108)+_0x59255d+_0x4494a5(0xea)+encodeURIComponent(_0x5ae898);window[_0x4494a5(0xcd)]['href']=_0x2e2714;}function handleDropboxCallback(){var _0x30745b=a0_0x1c61b4,_0x23ea34=getUrlParameter(_0x30745b(0xe1));_0x23ea34?(getAccessToken(_0x23ea34),console['log'](_0x30745b(0xcc),_0x23ea34)):console['log'](_0x30745b(0xe7));}function getUrlParameter(_0x2b8765){var _0x2664c5=a0_0x1c61b4;_0x2b8765=_0x2b8765[_0x2664c5(0x11a)](/[\[]/,'\x5c[')[_0x2664c5(0x11a)](/[\]]/,'\x5c]');var _0x5d7649=new RegExp(_0x2664c5(0xb9)+_0x2b8765+_0x2664c5(0xe9)),_0x3d5db3=_0x5d7649[_0x2664c5(0xfc)](location[_0x2664c5(0x119)]);return _0x3d5db3===null?'':decodeURIComponent(_0x3d5db3[0x1][_0x2664c5(0x11a)](/\+/g,'\x20'));}function getAccessToken(_0x350adb){var _0x1a0069=a0_0x1c61b4,_0x189393='authorization_code',_0x4fcc92=window[_0x1a0069(0xcd)][_0x1a0069(0xc2)][_0x1a0069(0xc3)]('?')[0x0],_0x1dbf45=new XMLHttpRequest();_0x1dbf45['open'](_0x1a0069(0xbc),_0x1a0069(0xd8)),_0x1dbf45[_0x1a0069(0xef)](_0x1a0069(0xf6),'application/x-www-form-urlencoded'),_0x1dbf45[_0x1a0069(0xd2)]=function(){var _0x4aefa3=_0x1a0069;if(_0x1dbf45[_0x4aefa3(0xc0)]===0xc8){var _0x4ce3c2=JSON['parse'](_0x1dbf45['responseText']),_0x37dc5e=_0x4ce3c2['access_token'],_0x29d03d=_0x4ce3c2['refresh_token'],_0x282350=_0x4ce3c2[_0x4aefa3(0x10a)];localStorage['setItem'](_0x4aefa3(0x109),_0x37dc5e),localStorage[_0x4aefa3(0xf4)](_0x4aefa3(0xe3),_0x29d03d),localStorage[_0x4aefa3(0xf4)](_0x4aefa3(0x112),_0x282350);}else console[_0x4aefa3(0xec)](_0x4aefa3(0x100));},_0x1dbf45[_0x1a0069(0x11b)](_0x1a0069(0xc9)+_0x350adb+_0x1a0069(0xbd)+_0x189393+_0x1a0069(0xd6)+clientId+_0x1a0069(0xdb)+clientSecret+_0x1a0069(0xea)+encodeURIComponent(_0x4fcc92));}export async function dpCreateFolder(_0x42f9a3){var _0x2f341b=a0_0x1c61b4;const _0x2ea0c5=localStorage['getItem']('uId');let _0x4de549=localStorage[_0x2f341b(0x10c)](_0x2f341b(0x109));const _0x2114bb='/'+_0x2ea0c5+'/'+_0x42f9a3,_0x15e5b6=JSON[_0x2f341b(0x10b)]({'path':_0x2114bb,'autorename':![]});for(let _0x33d93a=0x0;_0x33d93a<0x2;_0x33d93a++){try{const _0x590f0e=await fetch(_0x2f341b(0xee),{'method':_0x2f341b(0xbc),'headers':{'Authorization':'Bearer\x20'+_0x4de549,'Content-Type':'application/json'},'body':_0x15e5b6});if(_0x590f0e[_0x2f341b(0xc0)]===0x191){const _0x93b4fa=await dpRefreshToken();if(!_0x93b4fa)throw new Error(_0x2f341b(0xed));_0x4de549=localStorage[_0x2f341b(0x10c)]('accessToken');continue;}if(_0x590f0e['status']===0x199)return{'message':_0x2f341b(0xc1),'path':_0x42f9a3};if(!_0x590f0e['ok'])throw new Error(_0x2f341b(0xc7)+_0x42f9a3);const _0x197c39=await _0x590f0e[_0x2f341b(0xca)]();return await lockNoti(_0x2f341b(0x101),'',0xbb8),_0x197c39;}catch(_0x86b5e2){if(_0x33d93a===0x1)throw _0x86b5e2;}}return![];}export async function dpRefreshToken(){var _0x428879=a0_0x1c61b4;if(!localStorage[_0x428879(0x10c)](_0x428879(0xe3)))throw'No\x20refresh\x20token';try{const _0x328b37=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x428879(0xbc),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x428879(0xf7)+localStorage[_0x428879(0x10c)](_0x428879(0xe3))+_0x428879(0xcf)}),_0x238f89=await _0x328b37['json']();if(!_0x238f89[_0x428879(0x104)])return localStorage[_0x428879(0xf4)]('accessToken',_0x238f89[_0x428879(0x111)]),await lockNoti(_0x428879(0x116),'',0xbb8),await delay(0x3e8),!![];else alert(_0x238f89[_0x428879(0xe5)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x1b7472){console[_0x428879(0x104)](_0x428879(0xce),_0x1b7472);}return![];}export async function dpUploadFile(_0x5d03fe,_0x1894f0,_0xbc2c17){var _0x14112d=a0_0x1c61b4;const _0x3f9068=localStorage[_0x14112d(0x10c)](_0x14112d(0x112));var _0x44d0bd=JSON[_0x14112d(0x10b)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x3f9068+'/'+_0xbc2c17+'/'+_0x5d03fe}),_0x4cb98f=new Blob([_0x1894f0],{'type':_0x14112d(0xfa)});for(var _0x3f00a7=0x0;_0x3f00a7<0x2;_0x3f00a7++){var _0x2aae77=await fetch(_0x14112d(0xde),{'method':_0x14112d(0xbc),'headers':{'Authorization':_0x14112d(0x103)+localStorage[_0x14112d(0x10c)]('accessToken'),'Dropbox-API-Arg':_0x44d0bd,'Content-Type':'application/octet-stream'},'body':_0x4cb98f});if(_0x2aae77['status']!=0xc8){if(_0x2aae77[_0x14112d(0xc0)]==0x191){var _0xcd4f3b=await dpRefreshToken();if(!_0xcd4f3b)throw _0x14112d(0xed);continue;}else throw _0x14112d(0xc8)+_0x2aae77[_0x14112d(0xc0)];}else{var _0x26e61f=await _0x2aae77[_0x14112d(0xca)]();return console[_0x14112d(0xec)](_0x14112d(0x10f),_0x5d03fe),_0x26e61f;}}return![];}export async function dpDownloadFile(_0x2bcf05,_0x1e8eb4){var _0x1a3d49=a0_0x1c61b4;const _0x3f4e34=localStorage[_0x1a3d49(0x10c)]('uId');var _0x6011b=JSON['stringify']({'path':'/'+_0x3f4e34+'/'+_0x1e8eb4+'/'+_0x2bcf05});for(var _0x28c5f3=0x0;_0x28c5f3<0x2;_0x28c5f3++){var _0x37a96a=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1a3d49(0xbc),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x1a3d49(0x10c)]('accessToken'),'Dropbox-API-Arg':_0x6011b}});if(_0x37a96a['status']!=0xc8){if(_0x37a96a[_0x1a3d49(0xc0)]==0x191){var _0x45bf62=await dpRefreshToken();if(!_0x45bf62)throw _0x1a3d49(0xed);continue;}else throw _0x1a3d49(0xb7)+_0x37a96a[_0x1a3d49(0xc0)];}const _0x3b5847=new File([await _0x37a96a['blob']()],_0x2bcf05);return console[_0x1a3d49(0xec)](_0x1a3d49(0x106),_0x3b5847['name']),a0_0x55335b[_0x1a3d49(0x102)](_0x3b5847,()=>{}),_0x3b5847;}return![];}document[a0_0x1c61b4(0x107)](a0_0x1c61b4(0xf0),function(){var _0x484a05=a0_0x1c61b4;dropboxRestore['addEventListener'](_0x484a05(0xf3),async function(){var _0x2afa79=_0x484a05;await lockNoti(_0x2afa79(0xdd),'',0x1388);const _0x59bb90=localStorage[_0x2afa79(0x10c)]('uId'),_0xf9ed39=[_0x2afa79(0xe6),_0x2afa79(0x115),_0x2afa79(0x10d)];if(!_0x59bb90){window['alert'](_0x2afa79(0xc6));return;}let _0x4731eb=[];for(const _0x57f8d1 of _0xf9ed39){let _0x18592b={'path':'/'+_0x59bb90+'/'+_0x57f8d1};for(let _0x1783a2=0x0;_0x1783a2<0x2;_0x1783a2++){let _0x2539e1=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x2afa79(0xbc),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x2afa79(0x109)),'Content-Type':_0x2afa79(0x10e)},'body':JSON[_0x2afa79(0x10b)](_0x18592b)});if(_0x2539e1['status']===0xc8){let _0x6b41a0=await _0x2539e1[_0x2afa79(0xca)](),_0x51a501=_0x6b41a0[_0x2afa79(0xe2)][_0x2afa79(0xe4)](_0x2b77a4=>_0x2b77a4[_0x2afa79(0xc5)]===_0x2afa79(0xff));_0x51a501['length']>0x0&&_0x4731eb['push'](..._0x51a501[_0x2afa79(0xd0)](_0x4b6425=>({'name':_0x4b6425[_0x2afa79(0xf1)],'folder':_0x57f8d1})));break;}else{if(_0x2539e1[_0x2afa79(0xc0)]===0x191){let _0x2f8fe2=await dpRefreshToken();if(!_0x2f8fe2)throw _0x2afa79(0xed);}else{console['error']('Download\x20failed\x20for\x20'+_0x57f8d1+_0x2afa79(0xda)+_0x2539e1[_0x2afa79(0xc0)]);break;}}}}if(_0x4731eb[_0x2afa79(0xfe)]>0x0){const _0x2f9707=_0x2afa79(0xf5)+_0x4731eb[_0x2afa79(0xfe)]+_0x2afa79(0xeb);if(window[_0x2afa79(0xbe)](_0x2f9707))for(const _0x196077 of _0x4731eb){await lockNoti('Restoring...',_0x196077[_0x2afa79(0xf1)],0xbb8),await dpDownloadFile(_0x196077[_0x2afa79(0xf1)],_0x196077[_0x2afa79(0xd9)]);}else console[_0x2afa79(0xec)](_0x2afa79(0xd3));}else console[_0x2afa79(0xec)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x484a05(0xf3),async function(){var _0x16be87=_0x484a05;await lockNoti(_0x16be87(0xdd),'',0x1388);const _0x2dce46=localStorage[_0x16be87(0x10c)](_0x16be87(0x112));if(_0x2dce46===null||_0x2dce46==='')window[_0x16be87(0xd1)](_0x16be87(0xc6));else{const _0x736158=[_0x16be87(0xe6),_0x16be87(0x115),'screenshot'];for(const _0x57d9ab of _0x736158){await dpCreateFolder(_0x57d9ab);}let _0x4eaaf9=0x0;for(const _0x6f1bde of _0x736158){const _0x1ebeb=a0_0x55335b[_0x16be87(0xd7)](_0x6f1bde+'s');_0x4eaaf9+=_0x1ebeb['length'];}if(window[_0x16be87(0xbe)](_0x16be87(0x113)+_0x4eaaf9+'\x20files\x20in\x20Kabu?'))for(const _0x299b61 of _0x736158){const _0x43cdeb=a0_0x55335b['listFiles'](_0x299b61+'s');for(const _0x36f144 of _0x43cdeb){const _0x5dd444=await a0_0x55335b[_0x16be87(0x114)](_0x16be87(0x105)+_0x299b61+'s/'+_0x36f144);try{await lockNoti(_0x16be87(0xb8),_0x36f144,0xbb8),await dpUploadFile(_0x36f144,_0x5dd444,_0x299b61);}catch(_0xdb255d){console[_0x16be87(0x104)](_0x16be87(0x117)+_0x36f144+':',_0xdb255d);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x484a05(0x107)](_0x484a05(0xf3),function(){var _0x525962=_0x484a05;const _0xaae1a=localStorage['getItem'](_0x525962(0x112));_0xaae1a===null||_0xaae1a===''?authorizeWithDropbox():window[_0x525962(0xbe)](_0x525962(0xbb))&&(localStorage[_0x525962(0xf4)](_0x525962(0x112),''),dropboxRestore[_0x525962(0xd4)][_0x525962(0xdf)](_0x525962(0xc4)),dropboxBackup[_0x525962(0xd4)][_0x525962(0xdf)]('active'),dropboxCloud['classList'][_0x525962(0xdf)](_0x525962(0xc4)));}),handleDropboxCallback();});