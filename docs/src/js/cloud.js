var a0_0x23873b=a0_0x48c4;(function(_0xd9bbbf,_0x583954){var _0x491391=a0_0x48c4,_0x3e803c=_0xd9bbbf();while(!![]){try{var _0x1a3446=parseInt(_0x491391(0x1d7))/0x1*(-parseInt(_0x491391(0x225))/0x2)+-parseInt(_0x491391(0x21f))/0x3*(-parseInt(_0x491391(0x1e0))/0x4)+-parseInt(_0x491391(0x235))/0x5*(-parseInt(_0x491391(0x22f))/0x6)+parseInt(_0x491391(0x1d5))/0x7*(-parseInt(_0x491391(0x1f9))/0x8)+-parseInt(_0x491391(0x1fe))/0x9*(parseInt(_0x491391(0x1e8))/0xa)+-parseInt(_0x491391(0x1ed))/0xb+parseInt(_0x491391(0x227))/0xc;if(_0x1a3446===_0x583954)break;else _0x3e803c['push'](_0x3e803c['shift']());}catch(_0x438894){_0x3e803c['push'](_0x3e803c['shift']());}}}(a0_0x3ff7,0xe76c9));import*as a0_0x24ba79 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x23873b(0x22d),clientSecret=a0_0x23873b(0x1dc);function authorizeWithDropbox(){var _0x3b6dab=a0_0x23873b,_0x316b30=window[_0x3b6dab(0x200)]['href'][_0x3b6dab(0x1e9)]('?')[0x0],_0x1bc58b=_0x3b6dab(0x204),_0x3858ae=_0x3b6dab(0x1ef),_0x2304ae='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x1bc58b+'&token_access_type='+_0x3858ae+_0x3b6dab(0x1ec)+encodeURIComponent(_0x316b30);window[_0x3b6dab(0x200)]['href']=_0x2304ae;}function handleDropboxCallback(){var _0x5205a9=a0_0x23873b,_0x31041a=getUrlParameter('code');_0x31041a?(getAccessToken(_0x31041a),console[_0x5205a9(0x21e)](_0x5205a9(0x205),_0x31041a)):console[_0x5205a9(0x21e)](_0x5205a9(0x207));}function getUrlParameter(_0x1c4694){var _0x39bc56=a0_0x23873b;_0x1c4694=_0x1c4694[_0x39bc56(0x1da)](/[\[]/,'\x5c[')[_0x39bc56(0x1da)](/[\]]/,'\x5c]');var _0x5dc3de=new RegExp(_0x39bc56(0x1d6)+_0x1c4694+'=([^&#]*)'),_0x3c967f=_0x5dc3de['exec'](location['search']);return _0x3c967f===null?'':decodeURIComponent(_0x3c967f[0x1][_0x39bc56(0x1da)](/\+/g,'\x20'));}function getAccessToken(_0x19ab29){var _0x382f30=a0_0x23873b,_0x1d050a=_0x382f30(0x1f5),_0x30aa0d=window['location']['href'][_0x382f30(0x1e9)]('?')[0x0],_0x21311a=new XMLHttpRequest();_0x21311a[_0x382f30(0x1e7)](_0x382f30(0x20f),_0x382f30(0x1eb)),_0x21311a['setRequestHeader']('Content-Type',_0x382f30(0x20a)),_0x21311a['onload']=function(){var _0x4ad028=_0x382f30;if(_0x21311a['status']===0xc8){var _0x23821b=JSON[_0x4ad028(0x221)](_0x21311a['responseText']),_0x277de0=_0x23821b[_0x4ad028(0x220)],_0x323433=_0x23821b[_0x4ad028(0x1e5)],_0x289f96=_0x23821b[_0x4ad028(0x214)];localStorage[_0x4ad028(0x213)]('accessToken',_0x277de0),localStorage[_0x4ad028(0x213)](_0x4ad028(0x1d9),_0x323433),localStorage['setItem'](_0x4ad028(0x20d),_0x289f96);}else console[_0x4ad028(0x21e)](_0x4ad028(0x20b));},_0x21311a[_0x382f30(0x216)]('code='+_0x19ab29+_0x382f30(0x22a)+_0x1d050a+_0x382f30(0x1d2)+clientId+_0x382f30(0x223)+clientSecret+_0x382f30(0x1ec)+encodeURIComponent(_0x30aa0d));}function a0_0x48c4(_0x4b7468,_0xdb2352){var _0x3ff7c0=a0_0x3ff7();return a0_0x48c4=function(_0x48c463,_0x4b50d3){_0x48c463=_0x48c463-0x1d2;var _0xcba7a2=_0x3ff7c0[_0x48c463];return _0xcba7a2;},a0_0x48c4(_0x4b7468,_0xdb2352);}export async function dpCreateFolder(_0xa94480){var _0x1d2761=a0_0x23873b;const _0x307d06=localStorage[_0x1d2761(0x222)](_0x1d2761(0x20d));let _0x331b8c=localStorage['getItem'](_0x1d2761(0x21d));const _0x28c6b4='/'+_0x307d06+'/'+_0xa94480,_0x31a08b=JSON[_0x1d2761(0x21b)]({'path':_0x28c6b4,'autorename':![]});for(let _0x265765=0x0;_0x265765<0x2;_0x265765++){try{const _0x40e736=await fetch(_0x1d2761(0x1de),{'method':_0x1d2761(0x20f),'headers':{'Authorization':_0x1d2761(0x228)+_0x331b8c,'Content-Type':_0x1d2761(0x1ea)},'body':_0x31a08b});if(_0x40e736[_0x1d2761(0x210)]===0x191){const _0x575f31=await dpRefreshToken();if(!_0x575f31)throw new Error(_0x1d2761(0x22c));_0x331b8c=localStorage['getItem']('accessToken');continue;}if(_0x40e736[_0x1d2761(0x210)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0xa94480};if(!_0x40e736['ok'])throw new Error(_0x1d2761(0x1df)+_0xa94480);const _0x15d669=await _0x40e736[_0x1d2761(0x233)]();return await lockNoti(_0x1d2761(0x1f0),'',0xbb8),_0x15d669;}catch(_0x4710f1){if(_0x265765===0x1)throw _0x4710f1;}}return![];}export async function dpRefreshToken(){var _0x51a7bd=a0_0x23873b;if(!localStorage['getItem'](_0x51a7bd(0x1d9)))throw'No\x20refresh\x20token';try{const _0x5c544e=await fetch(_0x51a7bd(0x1e1),{'method':_0x51a7bd(0x20f),'headers':{'Content-Type':_0x51a7bd(0x20a)},'body':_0x51a7bd(0x1fc)+localStorage[_0x51a7bd(0x222)]('refreshToken')+_0x51a7bd(0x1ff)}),_0x1fe5e2=await _0x5c544e['json']();if(!_0x1fe5e2[_0x51a7bd(0x1f4)])return localStorage['setItem']('accessToken',_0x1fe5e2['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x1fe5e2[_0x51a7bd(0x209)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x37d165){console[_0x51a7bd(0x1f4)](_0x51a7bd(0x1fa),_0x37d165);}return![];}export async function dpUploadFile(_0x4db4f4,_0x14cbd3,_0x56ef7d){var _0xdb9a2e=a0_0x23873b;const _0x543d06=localStorage[_0xdb9a2e(0x222)](_0xdb9a2e(0x20d));var _0xe3ce2c=JSON['stringify']({'autorename':!![],'mode':_0xdb9a2e(0x226),'mute':!![],'strict_conflict':![],'path':'/'+_0x543d06+'/'+_0x56ef7d+'/'+_0x4db4f4}),_0x2ffc6d=new Blob([_0x14cbd3],{'type':_0xdb9a2e(0x1d3)});for(var _0x35b364=0x0;_0x35b364<0x2;_0x35b364++){var _0x54603a=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0xdb9a2e(0x20f),'headers':{'Authorization':_0xdb9a2e(0x228)+localStorage[_0xdb9a2e(0x222)]('accessToken'),'Dropbox-API-Arg':_0xe3ce2c,'Content-Type':_0xdb9a2e(0x1d3)},'body':_0x2ffc6d});if(_0x54603a[_0xdb9a2e(0x210)]!=0xc8){if(_0x54603a[_0xdb9a2e(0x210)]==0x191){var _0x529df0=await dpRefreshToken();if(!_0x529df0)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xdb9a2e(0x1f1)+_0x54603a['status'];}else{var _0x5298bd=await _0x54603a['json']();return console[_0xdb9a2e(0x21e)](_0xdb9a2e(0x1d4),_0x4db4f4),_0x5298bd;}}return![];}export async function dpDownloadFile(_0x51b85c,_0x233f54){var _0x34d0a5=a0_0x23873b;const _0x33e7c6=localStorage[_0x34d0a5(0x222)]('uId');var _0x57265b=JSON['stringify']({'path':'/'+_0x33e7c6+'/'+_0x233f54+'/'+_0x51b85c});for(var _0x5b0eb8=0x0;_0x5b0eb8<0x2;_0x5b0eb8++){var _0x27256a=await fetch(_0x34d0a5(0x1f7),{'method':_0x34d0a5(0x20f),'headers':{'Authorization':_0x34d0a5(0x228)+localStorage[_0x34d0a5(0x222)]('accessToken'),'Dropbox-API-Arg':_0x57265b}});if(_0x27256a[_0x34d0a5(0x210)]!=0xc8){if(_0x27256a[_0x34d0a5(0x210)]==0x191){var _0x37ba7d=await dpRefreshToken();if(!_0x37ba7d)throw _0x34d0a5(0x22c);continue;}else throw _0x34d0a5(0x212)+_0x27256a[_0x34d0a5(0x210)];}const _0x4cdb27=new File([await _0x27256a[_0x34d0a5(0x22e)]()],_0x51b85c);return console[_0x34d0a5(0x21e)](_0x34d0a5(0x1e4),_0x4cdb27[_0x34d0a5(0x231)]),a0_0x24ba79['uploadFileInCloud'](_0x4cdb27,()=>{var _0x7b2622=_0x34d0a5;localStorageFile(),Module[_0x7b2622(0x206)]();}),_0x4cdb27;}return![];}document[a0_0x23873b(0x1e2)](a0_0x23873b(0x1f2),function(){var _0x438124=a0_0x23873b;dropboxRestore['addEventListener'](_0x438124(0x1ee),async function(){var _0xf104a9=_0x438124;await lockNoti(_0xf104a9(0x1fd),'',0x1388);const _0x201938=localStorage['getItem']('uId'),_0x20b482=[_0xf104a9(0x20c),_0xf104a9(0x229),_0xf104a9(0x232)];if(!_0x201938){window[_0xf104a9(0x202)](_0xf104a9(0x211));return;}let _0x50543f=[];for(const _0x43fb20 of _0x20b482){let _0x3e4af8={'path':'/'+_0x201938+'/'+_0x43fb20};for(let _0x25ba52=0x0;_0x25ba52<0x2;_0x25ba52++){let _0x4dbc38=await fetch(_0xf104a9(0x1dd),{'method':'POST','headers':{'Authorization':_0xf104a9(0x228)+localStorage[_0xf104a9(0x222)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0xf104a9(0x21b)](_0x3e4af8)});if(_0x4dbc38[_0xf104a9(0x210)]===0xc8){let _0x29f9e3=await _0x4dbc38[_0xf104a9(0x233)](),_0x2dc768=_0x29f9e3['entries'][_0xf104a9(0x208)](_0x4e62c2=>_0x4e62c2['.tag']===_0xf104a9(0x1f3));_0x2dc768[_0xf104a9(0x219)]>0x0&&_0x50543f[_0xf104a9(0x1fb)](..._0x2dc768[_0xf104a9(0x1e3)](_0x3a5ddc=>({'name':_0x3a5ddc[_0xf104a9(0x231)],'folder':_0x43fb20})));break;}else{if(_0x4dbc38[_0xf104a9(0x210)]===0x191){let _0x2a7877=await dpRefreshToken();if(!_0x2a7877)throw'Unable\x20to\x20refresh\x20token';}else{console[_0xf104a9(0x1f4)](_0xf104a9(0x215)+_0x43fb20+',\x20status:\x20'+_0x4dbc38[_0xf104a9(0x210)]);break;}}}}if(_0x50543f['length']>0x0){const _0x4da84a=_0xf104a9(0x230)+_0x50543f[_0xf104a9(0x219)]+_0xf104a9(0x203);if(window[_0xf104a9(0x1d8)](_0x4da84a))for(const _0xfcb5f8 of _0x50543f){await lockNoti('Restoring...',_0xfcb5f8['name'],0xbb8),await dpDownloadFile(_0xfcb5f8[_0xf104a9(0x231)],_0xfcb5f8[_0xf104a9(0x217)]);}else console['log'](_0xf104a9(0x22b));}else console[_0xf104a9(0x21e)](_0xf104a9(0x1f6));}),dropboxBackup['addEventListener'](_0x438124(0x1ee),async function(){var _0x46b8d7=_0x438124;await lockNoti(_0x46b8d7(0x1fd),'',0x1388);const _0x404773=localStorage[_0x46b8d7(0x222)]('uId');if(_0x404773===null||_0x404773==='')window['alert'](_0x46b8d7(0x211));else{const _0x43797b=['state','save',_0x46b8d7(0x232)];for(const _0x36ada2 of _0x43797b){await dpCreateFolder(_0x36ada2);}let _0x503411=0x0;for(const _0xb8fe72 of _0x43797b){const _0x5f5049=a0_0x24ba79[_0x46b8d7(0x1db)+(_0xb8fe72[_0x46b8d7(0x236)](0x0)['toUpperCase']()+_0xb8fe72[_0x46b8d7(0x21c)](0x1))]();_0x503411+=_0x5f5049[_0x46b8d7(0x219)];}if(window[_0x46b8d7(0x1d8)](_0x46b8d7(0x224)+_0x503411+_0x46b8d7(0x234)))for(const _0x14af78 of _0x43797b){const _0xc0cb65=a0_0x24ba79[_0x46b8d7(0x1db)+(_0x14af78[_0x46b8d7(0x236)](0x0)['toUpperCase']()+_0x14af78[_0x46b8d7(0x21c)](0x1))]();for(const _0x272d4a of _0xc0cb65){const _0xceb3d5=await a0_0x24ba79['downloadFileInCloud'](_0x46b8d7(0x218)+_0x14af78+'s/'+_0x272d4a);try{await lockNoti('Backing\x20up...',_0x272d4a,0xbb8),await dpUploadFile(_0x272d4a,_0xceb3d5,_0x14af78);}catch(_0x590872){console['error'](_0x46b8d7(0x1f8)+_0x272d4a+':',_0x590872);}}}else console[_0x46b8d7(0x21e)](_0x46b8d7(0x22b));}}),dropboxCloud[_0x438124(0x1e2)](_0x438124(0x1ee),function(){var _0x329e51=_0x438124;const _0x37479f=localStorage['getItem']('uId');_0x37479f===null||_0x37479f===''?authorizeWithDropbox():window[_0x329e51(0x1d8)](_0x329e51(0x201))&&(localStorage[_0x329e51(0x213)](_0x329e51(0x20d),''),dropboxRestore[_0x329e51(0x1e6)][_0x329e51(0x20e)]('active'),dropboxBackup[_0x329e51(0x1e6)][_0x329e51(0x20e)](_0x329e51(0x21a)),dropboxCloud[_0x329e51(0x1e6)][_0x329e51(0x20e)](_0x329e51(0x21a)));}),handleDropboxCallback();});function a0_0x3ff7(){var _0x2c3773=['access_token','parse','getItem','&client_secret=','Do\x20you\x20want\x20to\x20backup\x20','60266AIUZkW','overwrite','20117460uxfHKn','Bearer\x20','save','&grant_type=','Restore\x20canceled\x20by\x20user.','Unable\x20to\x20refresh\x20token','knh3uz2mx2hp2eu','blob','1117218tXvHbK','Do\x20you\x20want\x20to\x20restore\x20','name','screenshot','json','\x20files\x20in\x20Kabu?','45nuaTsE','charAt','&client_id=','application/octet-stream','Kabu\x20storage\x20↦\x20Cloud\x20◆','7LLNtmQ','[\x5c?&#]','2OIkaGj','confirm','refreshToken','replace','list','nwb3dnfh09rhs31','https://api.dropboxapi.com/2/files/list_folder','https://api.dropboxapi.com/2/files/create_folder_v2','Error\x20creating\x20folder\x20','2840UJqbXd','https://api.dropboxapi.com/oauth2/token','addEventListener','map','Cloud\x20↦\x20Kabu\x20storage\x20◆','refresh_token','classList','open','10FonRbS','split','application/json','https://api.dropbox.com/oauth2/token','&redirect_uri=','12235883HcdhRS','click','offline','Folder\x20created','Upload\x20failed,\x20unknown\x20http\x20status:\x20','DOMContentLoaded','file','error','authorization_code','No\x20files\x20found\x20to\x20restore.','https://content.dropboxapi.com/2/files/download','Failed\x20to\x20upload\x20file\x20','6955816lvHqli','Error\x20while\x20refreshing\x20token:','push','refresh_token=','Wait\x20a\x20little\x20bit...','11906127pVMnxF','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','location','Do\x20you\x20want\x20to\x20logout?','alert','\x20files\x20from\x20Cloud?','code','Authorization\x20Code:','FSSync','Do\x20not\x20receive\x20authorization','filter','error_description','application/x-www-form-urlencoded','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','state','uId','remove','POST','status','Cloud\x20login\x20required!','Download\x20failed,\x20unknown\x20http\x20status:','setItem','uid','Download\x20failed\x20for\x20','send','folder','/data/','length','active','stringify','slice','accessToken','log','4059utgdcH'];a0_0x3ff7=function(){return _0x2c3773;};return a0_0x3ff7();}