var a0_0x2b83d2=a0_0x39cf;(function(_0x51219b,_0x22a22e){var _0x2a32dd=a0_0x39cf,_0x25d5ee=_0x51219b();while(!![]){try{var _0x27bcd8=-parseInt(_0x2a32dd(0xe4))/0x1*(parseInt(_0x2a32dd(0xc0))/0x2)+-parseInt(_0x2a32dd(0xea))/0x3+-parseInt(_0x2a32dd(0xbd))/0x4*(parseInt(_0x2a32dd(0xb0))/0x5)+-parseInt(_0x2a32dd(0xa9))/0x6*(parseInt(_0x2a32dd(0x97))/0x7)+-parseInt(_0x2a32dd(0xcf))/0x8+-parseInt(_0x2a32dd(0xba))/0x9*(parseInt(_0x2a32dd(0x9e))/0xa)+parseInt(_0x2a32dd(0xf6))/0xb;if(_0x27bcd8===_0x22a22e)break;else _0x25d5ee['push'](_0x25d5ee['shift']());}catch(_0x160f1a){_0x25d5ee['push'](_0x25d5ee['shift']());}}}(a0_0x17e5,0xbfd49));import*as a0_0x3e35d0 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2b83d2(0xd6),clientSecret='nwb3dnfh09rhs31';function a0_0x17e5(){var _0x173bd0=['charAt','application/octet-stream','file','Cloud\x20↦\x20Kabu\x20storage\x20◆','&client_secret=','parse','\x20files\x20from\x20Cloud?','No\x20refresh\x20token','POST','active','error_description','Failed\x20to\x20refresh\x20Dropbox\x20token.','save','refresh_token','416712qwMSGK','state','application/json','split','Folder\x20already\x20exists','remove','open','knh3uz2mx2hp2eu','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20backup\x20','Error\x20while\x20refreshing\x20token:','authorization_code','Failed\x20to\x20upload\x20file\x20','.tag','Folder\x20created','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','stringify','downloadFileInCloud','confirm','Bearer\x20','\x20files\x20in\x20Kabu?','5SPbqOd','=([^&#]*)','&response_type=','Cloud\x20login\x20required!','json','Refreshing\x20token...','2495142DeYdar','code','https://api.dropboxapi.com/2/files/list_folder','accessToken','entries','onload','Unable\x20to\x20refresh\x20token','Backing\x20up...','access_token','uid','error','Error\x20creating\x20folder\x20','48066051LpTzBW','https://www.dropbox.com/oauth2/authorize?client_id=','classList','status','responseText','location','addEventListener','2769718uQaDFe','screenshot','send','&grant_type=','DOMContentLoaded','replace','https://api.dropboxapi.com/2/files/create_folder_v2','4059730dpRbMI','Restore\x20canceled\x20by\x20user.','list','uId','Wait\x20a\x20little\x20bit...','https://content.dropboxapi.com/2/files/upload','getItem','click','log','search','https://api.dropbox.com/oauth2/token','12bJSBsV','setRequestHeader','blob','length','exec','Download\x20failed\x20for\x20','No\x20files\x20found\x20to\x20restore.','498985gmKZUA','folder','setItem','&redirect_uri=','toUpperCase','name','refreshToken','https://api.dropboxapi.com/oauth2/token','Download\x20failed,\x20unknown\x20http\x20status:','slice','9QmgKBB','href','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','60tTILTN','offline','Kabu\x20storage\x20↦\x20Cloud\x20◆','2330PyZYSw'];a0_0x17e5=function(){return _0x173bd0;};return a0_0x17e5();}function authorizeWithDropbox(){var _0x1acf20=a0_0x2b83d2,_0x5369a1=window['location'][_0x1acf20(0xbb)]['split']('?')[0x0],_0x579766='code',_0x14ffb2=_0x1acf20(0xbe),_0x2035c7=_0x1acf20(0x91)+clientId+_0x1acf20(0xe6)+_0x579766+'&token_access_type='+_0x14ffb2+'&redirect_uri='+encodeURIComponent(_0x5369a1);window[_0x1acf20(0x95)]['href']=_0x2035c7;}function handleDropboxCallback(){var _0x20ebd2=a0_0x2b83d2,_0x5a0802=getUrlParameter(_0x20ebd2(0xeb));_0x5a0802?(getAccessToken(_0x5a0802),console[_0x20ebd2(0xa6)]('Authorization\x20Code:',_0x5a0802)):console['log']('Do\x20not\x20receive\x20authorization');}function a0_0x39cf(_0x17ce76,_0x41ee41){var _0x17e521=a0_0x17e5();return a0_0x39cf=function(_0x39cf23,_0x135352){_0x39cf23=_0x39cf23-0x91;var _0x5922fe=_0x17e521[_0x39cf23];return _0x5922fe;},a0_0x39cf(_0x17ce76,_0x41ee41);}function getUrlParameter(_0x33c756){var _0x406654=a0_0x2b83d2;_0x33c756=_0x33c756['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x40fdca=new RegExp('[\x5c?&#]'+_0x33c756+_0x406654(0xe5)),_0x4e17ba=_0x40fdca[_0x406654(0xad)](location[_0x406654(0xa7)]);return _0x4e17ba===null?'':decodeURIComponent(_0x4e17ba[0x1][_0x406654(0x9c)](/\+/g,'\x20'));}function getAccessToken(_0x2aa8d5){var _0x38560d=a0_0x2b83d2,_0x54b841=_0x38560d(0xda),_0x3221f0=window['location']['href'][_0x38560d(0xd2)]('?')[0x0],_0x332d58=new XMLHttpRequest();_0x332d58[_0x38560d(0xd5)]('POST',_0x38560d(0xa8)),_0x332d58[_0x38560d(0xaa)]('Content-Type',_0x38560d(0xd7)),_0x332d58[_0x38560d(0xef)]=function(){var _0x1bff2a=_0x38560d;if(_0x332d58[_0x1bff2a(0x93)]===0xc8){var _0x274c36=JSON[_0x1bff2a(0xc6)](_0x332d58[_0x1bff2a(0x94)]),_0x293042=_0x274c36[_0x1bff2a(0xf2)],_0xa95537=_0x274c36[_0x1bff2a(0xce)],_0x4aa24e=_0x274c36[_0x1bff2a(0xf3)];localStorage[_0x1bff2a(0xb2)](_0x1bff2a(0xed),_0x293042),localStorage['setItem'](_0x1bff2a(0xb6),_0xa95537),localStorage['setItem'](_0x1bff2a(0xa1),_0x4aa24e);}else console[_0x1bff2a(0xa6)](_0x1bff2a(0xde));},_0x332d58[_0x38560d(0x99)]('code='+_0x2aa8d5+_0x38560d(0x9a)+_0x54b841+'&client_id='+clientId+_0x38560d(0xc5)+clientSecret+_0x38560d(0xb3)+encodeURIComponent(_0x3221f0));}export async function dpCreateFolder(_0x10218b){var _0x3c8190=a0_0x2b83d2;const _0x253187=localStorage[_0x3c8190(0xa4)](_0x3c8190(0xa1));let _0x247a0f=localStorage[_0x3c8190(0xa4)](_0x3c8190(0xed));const _0x3755a4='/'+_0x253187+'/'+_0x10218b,_0x15ed2c=JSON[_0x3c8190(0xdf)]({'path':_0x3755a4,'autorename':![]});for(let _0x5aba34=0x0;_0x5aba34<0x2;_0x5aba34++){try{const _0x4c8eeb=await fetch(_0x3c8190(0x9d),{'method':_0x3c8190(0xc9),'headers':{'Authorization':_0x3c8190(0xe2)+_0x247a0f,'Content-Type':_0x3c8190(0xd1)},'body':_0x15ed2c});if(_0x4c8eeb['status']===0x191){const _0x3f9885=await dpRefreshToken();if(!_0x3f9885)throw new Error('Unable\x20to\x20refresh\x20token');_0x247a0f=localStorage['getItem'](_0x3c8190(0xed));continue;}if(_0x4c8eeb[_0x3c8190(0x93)]===0x199)return{'message':_0x3c8190(0xd3),'path':_0x10218b};if(!_0x4c8eeb['ok'])throw new Error(_0x3c8190(0xf5)+_0x10218b);const _0x489a04=await _0x4c8eeb[_0x3c8190(0xe8)]();return await lockNoti(_0x3c8190(0xdd),'',0xbb8),_0x489a04;}catch(_0x6c3320){if(_0x5aba34===0x1)throw _0x6c3320;}}return![];}export async function dpRefreshToken(){var _0x18fdd5=a0_0x2b83d2;if(!localStorage['getItem'](_0x18fdd5(0xb6)))throw _0x18fdd5(0xc8);try{const _0x6de030=await fetch(_0x18fdd5(0xb7),{'method':_0x18fdd5(0xc9),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0x18fdd5(0xa4)](_0x18fdd5(0xb6))+_0x18fdd5(0xbc)}),_0x1aac0b=await _0x6de030['json']();if(!_0x1aac0b[_0x18fdd5(0xf4)])return localStorage[_0x18fdd5(0xb2)](_0x18fdd5(0xed),_0x1aac0b[_0x18fdd5(0xf2)]),await lockNoti(_0x18fdd5(0xe9),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1aac0b[_0x18fdd5(0xcb)]||_0x18fdd5(0xcc));}catch(_0x3ed75a){console['error'](_0x18fdd5(0xd9),_0x3ed75a);}return![];}export async function dpUploadFile(_0x4d4ed4,_0x25ce8e,_0x516a4f){var _0x4010b9=a0_0x2b83d2;const _0x10dab5=localStorage['getItem'](_0x4010b9(0xa1));var _0x3916d2=JSON[_0x4010b9(0xdf)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x10dab5+'/'+_0x516a4f+'/'+_0x4d4ed4}),_0x264104=new Blob([_0x25ce8e],{'type':_0x4010b9(0xc2)});for(var _0x5c7270=0x0;_0x5c7270<0x2;_0x5c7270++){var _0x4634b6=await fetch(_0x4010b9(0xa3),{'method':_0x4010b9(0xc9),'headers':{'Authorization':_0x4010b9(0xe2)+localStorage['getItem'](_0x4010b9(0xed)),'Dropbox-API-Arg':_0x3916d2,'Content-Type':_0x4010b9(0xc2)},'body':_0x264104});if(_0x4634b6[_0x4010b9(0x93)]!=0xc8){if(_0x4634b6[_0x4010b9(0x93)]==0x191){var _0x5752bf=await dpRefreshToken();if(!_0x5752bf)throw _0x4010b9(0xf0);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x4634b6[_0x4010b9(0x93)];}else{var _0x1411ba=await _0x4634b6[_0x4010b9(0xe8)]();return console[_0x4010b9(0xa6)](_0x4010b9(0xbf),_0x4d4ed4),_0x1411ba;}}return![];}export async function dpDownloadFile(_0x5ac550,_0x316734){var _0x5579e2=a0_0x2b83d2;const _0x485e72=localStorage[_0x5579e2(0xa4)]('uId');var _0x5c0eef=JSON[_0x5579e2(0xdf)]({'path':'/'+_0x485e72+'/'+_0x316734+'/'+_0x5ac550});for(var _0x2af3b8=0x0;_0x2af3b8<0x2;_0x2af3b8++){var _0x2e7a6f=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x5579e2(0xc9),'headers':{'Authorization':_0x5579e2(0xe2)+localStorage[_0x5579e2(0xa4)]('accessToken'),'Dropbox-API-Arg':_0x5c0eef}});if(_0x2e7a6f[_0x5579e2(0x93)]!=0xc8){if(_0x2e7a6f[_0x5579e2(0x93)]==0x191){var _0x1ca576=await dpRefreshToken();if(!_0x1ca576)throw _0x5579e2(0xf0);continue;}else throw _0x5579e2(0xb8)+_0x2e7a6f[_0x5579e2(0x93)];}const _0x4947ce=new File([await _0x2e7a6f[_0x5579e2(0xab)]()],_0x5ac550);return console[_0x5579e2(0xa6)](_0x5579e2(0xc4),_0x4947ce[_0x5579e2(0xb5)]),a0_0x3e35d0['uploadFileInCloud'](_0x4947ce,()=>{localStorageFile(),Module['FSSync']();}),_0x4947ce;}return![];}document['addEventListener'](a0_0x2b83d2(0x9b),function(){var _0x5c33e5=a0_0x2b83d2;dropboxRestore[_0x5c33e5(0x96)](_0x5c33e5(0xa5),async function(){var _0x4f6b05=_0x5c33e5;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x750a90=localStorage['getItem']('uId'),_0x9d7cfd=[_0x4f6b05(0xd0),_0x4f6b05(0xcd),_0x4f6b05(0x98)];if(!_0x750a90){window['alert'](_0x4f6b05(0xe7));return;}let _0x1952fe=[];for(const _0xaa59c2 of _0x9d7cfd){let _0x427f06={'path':'/'+_0x750a90+'/'+_0xaa59c2};for(let _0x2478b1=0x0;_0x2478b1<0x2;_0x2478b1++){let _0x5b5a48=await fetch(_0x4f6b05(0xec),{'method':'POST','headers':{'Authorization':_0x4f6b05(0xe2)+localStorage[_0x4f6b05(0xa4)](_0x4f6b05(0xed)),'Content-Type':_0x4f6b05(0xd1)},'body':JSON[_0x4f6b05(0xdf)](_0x427f06)});if(_0x5b5a48[_0x4f6b05(0x93)]===0xc8){let _0x15a689=await _0x5b5a48[_0x4f6b05(0xe8)](),_0x35c612=_0x15a689[_0x4f6b05(0xee)]['filter'](_0x1ea901=>_0x1ea901[_0x4f6b05(0xdc)]===_0x4f6b05(0xc3));_0x35c612['length']>0x0&&_0x1952fe['push'](..._0x35c612['map'](_0x3e1ee3=>({'name':_0x3e1ee3[_0x4f6b05(0xb5)],'folder':_0xaa59c2})));break;}else{if(_0x5b5a48[_0x4f6b05(0x93)]===0x191){let _0x493d23=await dpRefreshToken();if(!_0x493d23)throw _0x4f6b05(0xf0);}else{console[_0x4f6b05(0xf4)](_0x4f6b05(0xae)+_0xaa59c2+',\x20status:\x20'+_0x5b5a48[_0x4f6b05(0x93)]);break;}}}}if(_0x1952fe[_0x4f6b05(0xac)]>0x0){const _0xb93414='Do\x20you\x20want\x20to\x20restore\x20'+_0x1952fe[_0x4f6b05(0xac)]+_0x4f6b05(0xc7);if(window[_0x4f6b05(0xe1)](_0xb93414))for(const _0x36b1cf of _0x1952fe){await lockNoti('Restoring...',_0x36b1cf['name'],0xbb8),await dpDownloadFile(_0x36b1cf['name'],_0x36b1cf[_0x4f6b05(0xb1)]);}else console[_0x4f6b05(0xa6)]('Restore\x20canceled\x20by\x20user.');}else console[_0x4f6b05(0xa6)](_0x4f6b05(0xaf));}),dropboxBackup['addEventListener'](_0x5c33e5(0xa5),async function(){var _0x2df262=_0x5c33e5;await lockNoti(_0x2df262(0xa2),'',0x1388);const _0x2b599d=localStorage[_0x2df262(0xa4)](_0x2df262(0xa1));if(_0x2b599d===null||_0x2b599d==='')window['alert'](_0x2df262(0xe7));else{const _0x5c040b=[_0x2df262(0xd0),_0x2df262(0xcd),_0x2df262(0x98)];for(const _0x504905 of _0x5c040b){await dpCreateFolder(_0x504905);}let _0x1efcd5=0x0;for(const _0x5e4643 of _0x5c040b){const _0x4aa71a=a0_0x3e35d0[_0x2df262(0xa0)+(_0x5e4643[_0x2df262(0xc1)](0x0)[_0x2df262(0xb4)]()+_0x5e4643[_0x2df262(0xb9)](0x1))]();_0x1efcd5+=_0x4aa71a['length'];}if(window[_0x2df262(0xe1)](_0x2df262(0xd8)+_0x1efcd5+_0x2df262(0xe3)))for(const _0x4dbbd8 of _0x5c040b){const _0x119c5b=a0_0x3e35d0['list'+(_0x4dbbd8[_0x2df262(0xc1)](0x0)[_0x2df262(0xb4)]()+_0x4dbbd8['slice'](0x1))]();for(const _0xef3567 of _0x119c5b){const _0x2ddde0=await a0_0x3e35d0[_0x2df262(0xe0)]('/data/'+_0x4dbbd8+'s/'+_0xef3567);try{await lockNoti(_0x2df262(0xf1),_0xef3567,0xbb8),await dpUploadFile(_0xef3567,_0x2ddde0,_0x4dbbd8);}catch(_0x1b5198){console[_0x2df262(0xf4)](_0x2df262(0xdb)+_0xef3567+':',_0x1b5198);}}}else console['log'](_0x2df262(0x9f));}}),dropboxCloud[_0x5c33e5(0x96)]('click',function(){var _0x310685=_0x5c33e5;const _0x32220d=localStorage[_0x310685(0xa4)](_0x310685(0xa1));_0x32220d===null||_0x32220d===''?authorizeWithDropbox():window[_0x310685(0xe1)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x310685(0xb2)](_0x310685(0xa1),''),dropboxRestore[_0x310685(0x92)]['remove'](_0x310685(0xca)),dropboxBackup[_0x310685(0x92)][_0x310685(0xd4)](_0x310685(0xca)),dropboxCloud['classList'][_0x310685(0xd4)](_0x310685(0xca)));}),handleDropboxCallback();});