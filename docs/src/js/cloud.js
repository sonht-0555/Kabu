var a0_0x4d0297=a0_0x7022;(function(_0x1c5987,_0x19562a){var _0x18d344=a0_0x7022,_0x687628=_0x1c5987();while(!![]){try{var _0x2d995f=-parseInt(_0x18d344(0x12c))/0x1+-parseInt(_0x18d344(0x171))/0x2+parseInt(_0x18d344(0x167))/0x3+-parseInt(_0x18d344(0x116))/0x4+parseInt(_0x18d344(0x132))/0x5+-parseInt(_0x18d344(0x144))/0x6*(-parseInt(_0x18d344(0x168))/0x7)+parseInt(_0x18d344(0x155))/0x8;if(_0x2d995f===_0x19562a)break;else _0x687628['push'](_0x687628['shift']());}catch(_0x43974b){_0x687628['push'](_0x687628['shift']());}}}(a0_0x3c31,0x97396));import*as a0_0x5bd73b from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4d0297(0x12f),clientSecret=a0_0x4d0297(0x14e);function authorizeWithDropbox(){var _0x1c2379=a0_0x4d0297,_0x198add=window[_0x1c2379(0x145)][_0x1c2379(0x141)][_0x1c2379(0x125)]('?')[0x0],_0x346643=_0x1c2379(0x175),_0x5d865c=_0x1c2379(0x121),_0x248dc8='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x1c2379(0x14c)+_0x346643+_0x1c2379(0x16e)+_0x5d865c+_0x1c2379(0x134)+encodeURIComponent(_0x198add);window[_0x1c2379(0x145)][_0x1c2379(0x141)]=_0x248dc8;}function a0_0x7022(_0x2ba0b8,_0x287a9a){var _0x3c3193=a0_0x3c31();return a0_0x7022=function(_0x7022fd,_0x4af3f9){_0x7022fd=_0x7022fd-0x115;var _0x38bbe9=_0x3c3193[_0x7022fd];return _0x38bbe9;},a0_0x7022(_0x2ba0b8,_0x287a9a);}function handleDropboxCallback(){var _0x33f532=a0_0x4d0297,_0x35fdf7=getUrlParameter(_0x33f532(0x175));_0x35fdf7?(getAccessToken(_0x35fdf7),console[_0x33f532(0x16c)](_0x33f532(0x137),_0x35fdf7)):console[_0x33f532(0x16c)](_0x33f532(0x122));}function getUrlParameter(_0x18536e){var _0x5c8488=a0_0x4d0297;_0x18536e=_0x18536e[_0x5c8488(0x170)](/[\[]/,'\x5c[')[_0x5c8488(0x170)](/[\]]/,'\x5c]');var _0x207a43=new RegExp(_0x5c8488(0x127)+_0x18536e+'=([^&#]*)'),_0x33de89=_0x207a43[_0x5c8488(0x156)](location[_0x5c8488(0x117)]);return _0x33de89===null?'':decodeURIComponent(_0x33de89[0x1][_0x5c8488(0x170)](/\+/g,'\x20'));}function getAccessToken(_0xcb49f5){var _0x5d7e13=a0_0x4d0297,_0x352211=_0x5d7e13(0x179),_0x46ae1a=window[_0x5d7e13(0x145)][_0x5d7e13(0x141)][_0x5d7e13(0x125)]('?')[0x0],_0x391194=new XMLHttpRequest();_0x391194[_0x5d7e13(0x11d)](_0x5d7e13(0x140),'https://api.dropbox.com/oauth2/token'),_0x391194[_0x5d7e13(0x176)](_0x5d7e13(0x152),_0x5d7e13(0x142)),_0x391194[_0x5d7e13(0x12d)]=function(){var _0x55ad08=_0x5d7e13;if(_0x391194[_0x55ad08(0x11f)]===0xc8){var _0x4e3c71=JSON[_0x55ad08(0x173)](_0x391194['responseText']),_0x47e75a=_0x4e3c71[_0x55ad08(0x158)],_0x5bdcef=_0x4e3c71[_0x55ad08(0x11b)],_0x3d1d43=_0x4e3c71[_0x55ad08(0x12e)];localStorage[_0x55ad08(0x161)](_0x55ad08(0x13c),_0x47e75a),localStorage[_0x55ad08(0x161)](_0x55ad08(0x120),_0x5bdcef),localStorage[_0x55ad08(0x161)](_0x55ad08(0x123),_0x3d1d43);}else console[_0x55ad08(0x16c)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x391194[_0x5d7e13(0x143)](_0x5d7e13(0x149)+_0xcb49f5+_0x5d7e13(0x15c)+_0x352211+_0x5d7e13(0x15e)+clientId+_0x5d7e13(0x165)+clientSecret+_0x5d7e13(0x134)+encodeURIComponent(_0x46ae1a));}export async function dpCreateFolder(_0x4889db){var _0x100bd6=a0_0x4d0297;const _0x36a26e=localStorage[_0x100bd6(0x177)]('uId');let _0x5a0a17=localStorage[_0x100bd6(0x177)](_0x100bd6(0x13c));const _0x3291cb='/'+_0x36a26e+'/'+_0x4889db,_0x555d20=JSON[_0x100bd6(0x160)]({'path':_0x3291cb,'autorename':![]});for(let _0x158c37=0x0;_0x158c37<0x2;_0x158c37++){try{const _0x2fcc55=await fetch(_0x100bd6(0x150),{'method':_0x100bd6(0x140),'headers':{'Authorization':_0x100bd6(0x14a)+_0x5a0a17,'Content-Type':_0x100bd6(0x14f)},'body':_0x555d20});if(_0x2fcc55[_0x100bd6(0x11f)]===0x191){const _0x29fe91=await dpRefreshToken();if(!_0x29fe91)throw new Error(_0x100bd6(0x139));_0x5a0a17=localStorage['getItem'](_0x100bd6(0x13c));continue;}if(_0x2fcc55['status']===0x199)return{'message':_0x100bd6(0x13b),'path':_0x4889db};if(!_0x2fcc55['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x4889db);const _0x138068=await _0x2fcc55[_0x100bd6(0x146)]();return await lockNoti('Folder\x20created','',0xbb8),_0x138068;}catch(_0xcf7f08){if(_0x158c37===0x1)throw _0xcf7f08;}}return![];}export async function dpRefreshToken(){var _0x40cb60=a0_0x4d0297;if(!localStorage[_0x40cb60(0x177)](_0x40cb60(0x120)))throw _0x40cb60(0x13a);try{const _0xc438ea=await fetch(_0x40cb60(0x128),{'method':_0x40cb60(0x140),'headers':{'Content-Type':_0x40cb60(0x142)},'body':_0x40cb60(0x153)+localStorage['getItem'](_0x40cb60(0x120))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x5e2db7=await _0xc438ea[_0x40cb60(0x146)]();if(!_0x5e2db7['error'])return localStorage['setItem'](_0x40cb60(0x13c),_0x5e2db7[_0x40cb60(0x158)]),await lockNoti(_0x40cb60(0x130),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5e2db7['error_description']||_0x40cb60(0x13d));}catch(_0x462af1){console[_0x40cb60(0x119)](_0x40cb60(0x135),_0x462af1);}return![];}export async function dpUploadFile(_0x4481ed,_0x1e5dbd,_0x39fa84){var _0x10723d=a0_0x4d0297;const _0x4a0f5e=localStorage[_0x10723d(0x177)](_0x10723d(0x123));var _0x8c76fd=JSON[_0x10723d(0x160)]({'autorename':!![],'mode':_0x10723d(0x178),'mute':!![],'strict_conflict':![],'path':'/'+_0x4a0f5e+'/'+_0x39fa84+'/'+_0x4481ed}),_0xbf8872=new Blob([_0x1e5dbd],{'type':_0x10723d(0x129)});for(var _0x54612c=0x0;_0x54612c<0x2;_0x54612c++){var _0x4b3251=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x10723d(0x140),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x10723d(0x177)](_0x10723d(0x13c)),'Dropbox-API-Arg':_0x8c76fd,'Content-Type':_0x10723d(0x129)},'body':_0xbf8872});if(_0x4b3251['status']!=0xc8){if(_0x4b3251[_0x10723d(0x11f)]==0x191){var _0x251e86=await dpRefreshToken();if(!_0x251e86)throw _0x10723d(0x139);continue;}else throw _0x10723d(0x14d)+_0x4b3251['status'];}else{var _0x2ef777=await _0x4b3251[_0x10723d(0x146)]();return console[_0x10723d(0x16c)](_0x10723d(0x172),_0x4481ed),_0x2ef777;}}return![];}function a0_0x3c31(){var _0x31ab4d=['classList','3293276owaoOC','search','addEventListener','error','active','refresh_token','toUpperCase','open','slice','status','refreshToken','offline','Do\x20not\x20receive\x20authorization','uId','https://api.dropboxapi.com/2/files/list_folder','split','Failed\x20to\x20upload\x20file\x20','[\x5c?&#]','https://api.dropboxapi.com/oauth2/token','application/octet-stream','list','Download\x20failed\x20for\x20','832731SfzdOf','onload','uid','knh3uz2mx2hp2eu','Refreshing\x20token...','name','2232935NfHZNW','charAt','&redirect_uri=','Error\x20while\x20refreshing\x20token:',',\x20status:\x20','Authorization\x20Code:','alert','Unable\x20to\x20refresh\x20token','No\x20refresh\x20token','Folder\x20already\x20exists','accessToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','screenshot','entries','POST','href','application/x-www-form-urlencoded','send','209910jqBPzy','location','json','remove','click','code=','Bearer\x20','map','&response_type=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','nwb3dnfh09rhs31','application/json','https://api.dropboxapi.com/2/files/create_folder_v2','push','Content-Type','refresh_token=','FSSync','13494776eEtpMZ','exec','confirm','access_token','folder','Cloud\x20↦\x20Kabu\x20storage\x20◆','state','&grant_type=','Do\x20you\x20want\x20to\x20backup\x20','&client_id=','Cloud\x20login\x20required!','stringify','setItem','Do\x20you\x20want\x20to\x20logout?','downloadFileInCloud','filter','&client_secret=','file','244794KAPPAY','105HjODsz','No\x20files\x20found\x20to\x20restore.','Wait\x20a\x20little\x20bit...','length','log','DOMContentLoaded','&token_access_type=','/data/','replace','928686MifzcW','Kabu\x20storage\x20↦\x20Cloud\x20◆','parse','\x20files\x20in\x20Kabu?','code','setRequestHeader','getItem','overwrite','authorization_code'];a0_0x3c31=function(){return _0x31ab4d;};return a0_0x3c31();}export async function dpDownloadFile(_0x4716c5,_0x4a1f5f){var _0x283ae2=a0_0x4d0297;const _0x37a953=localStorage[_0x283ae2(0x177)]('uId');var _0x3671d9=JSON['stringify']({'path':'/'+_0x37a953+'/'+_0x4a1f5f+'/'+_0x4716c5});for(var _0x122765=0x0;_0x122765<0x2;_0x122765++){var _0x24369a=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x283ae2(0x14a)+localStorage[_0x283ae2(0x177)](_0x283ae2(0x13c)),'Dropbox-API-Arg':_0x3671d9}});if(_0x24369a['status']!=0xc8){if(_0x24369a['status']==0x191){var _0x13b5ac=await dpRefreshToken();if(!_0x13b5ac)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x24369a[_0x283ae2(0x11f)];}const _0x1a8dc8=new File([await _0x24369a['blob']()],_0x4716c5);return console[_0x283ae2(0x16c)](_0x283ae2(0x15a),_0x1a8dc8[_0x283ae2(0x131)]),a0_0x5bd73b['uploadFileInCloud'](_0x1a8dc8,()=>{var _0x4eb68b=_0x283ae2;localStorageFile(),Module[_0x4eb68b(0x154)]();}),_0x1a8dc8;}return![];}document['addEventListener'](a0_0x4d0297(0x16d),function(){var _0x580286=a0_0x4d0297;dropboxRestore['addEventListener'](_0x580286(0x148),async function(){var _0x4f146f=_0x580286;await lockNoti(_0x4f146f(0x16a),'',0x1388);const _0x277f94=localStorage['getItem'](_0x4f146f(0x123)),_0x5a0bd0=[_0x4f146f(0x15b),'save',_0x4f146f(0x13e)];if(!_0x277f94){window[_0x4f146f(0x138)]('Cloud\x20login\x20required!');return;}let _0x5f3e73=[];for(const _0x5a63b6 of _0x5a0bd0){let _0x323d56={'path':'/'+_0x277f94+'/'+_0x5a63b6};for(let _0x58aea1=0x0;_0x58aea1<0x2;_0x58aea1++){let _0x5d0a8d=await fetch(_0x4f146f(0x124),{'method':'POST','headers':{'Authorization':_0x4f146f(0x14a)+localStorage[_0x4f146f(0x177)](_0x4f146f(0x13c)),'Content-Type':_0x4f146f(0x14f)},'body':JSON[_0x4f146f(0x160)](_0x323d56)});if(_0x5d0a8d[_0x4f146f(0x11f)]===0xc8){let _0x221399=await _0x5d0a8d[_0x4f146f(0x146)](),_0x2308b1=_0x221399[_0x4f146f(0x13f)][_0x4f146f(0x164)](_0x45cf47=>_0x45cf47['.tag']===_0x4f146f(0x166));_0x2308b1[_0x4f146f(0x16b)]>0x0&&_0x5f3e73[_0x4f146f(0x151)](..._0x2308b1[_0x4f146f(0x14b)](_0x4c1124=>({'name':_0x4c1124[_0x4f146f(0x131)],'folder':_0x5a63b6})));break;}else{if(_0x5d0a8d[_0x4f146f(0x11f)]===0x191){let _0x5c3404=await dpRefreshToken();if(!_0x5c3404)throw _0x4f146f(0x139);}else{console[_0x4f146f(0x119)](_0x4f146f(0x12b)+_0x5a63b6+_0x4f146f(0x136)+_0x5d0a8d[_0x4f146f(0x11f)]);break;}}}}if(_0x5f3e73[_0x4f146f(0x16b)]>0x0){const _0x11c5f1='Do\x20you\x20want\x20to\x20restore\x20'+_0x5f3e73[_0x4f146f(0x16b)]+'\x20files\x20from\x20Cloud?';if(window[_0x4f146f(0x157)](_0x11c5f1))for(const _0xb0bf94 of _0x5f3e73){await lockNoti('Restoring...',_0xb0bf94[_0x4f146f(0x131)],0xbb8),await dpDownloadFile(_0xb0bf94['name'],_0xb0bf94[_0x4f146f(0x159)]);}else console[_0x4f146f(0x16c)]('Restore\x20canceled\x20by\x20user.');}else console['log'](_0x4f146f(0x169));}),dropboxBackup[_0x580286(0x118)]('click',async function(){var _0x54b53b=_0x580286;await lockNoti(_0x54b53b(0x16a),'',0x1388);const _0x1acecd=localStorage['getItem'](_0x54b53b(0x123));if(_0x1acecd===null||_0x1acecd==='')window[_0x54b53b(0x138)](_0x54b53b(0x15f));else{const _0x1cf5b0=['state','save',_0x54b53b(0x13e)];for(const _0x16c469 of _0x1cf5b0){await dpCreateFolder(_0x16c469);}let _0x3ba996=0x0;for(const _0x4c5aae of _0x1cf5b0){const _0x19d294=a0_0x5bd73b['list'+(_0x4c5aae[_0x54b53b(0x133)](0x0)[_0x54b53b(0x11c)]()+_0x4c5aae[_0x54b53b(0x11e)](0x1))]();_0x3ba996+=_0x19d294[_0x54b53b(0x16b)];}if(window[_0x54b53b(0x157)](_0x54b53b(0x15d)+_0x3ba996+_0x54b53b(0x174)))for(const _0x55a953 of _0x1cf5b0){const _0x500520=a0_0x5bd73b[_0x54b53b(0x12a)+(_0x55a953[_0x54b53b(0x133)](0x0)['toUpperCase']()+_0x55a953[_0x54b53b(0x11e)](0x1))]();for(const _0x523996 of _0x500520){const _0x5cc480=await a0_0x5bd73b[_0x54b53b(0x163)](_0x54b53b(0x16f)+_0x55a953+'s/'+_0x523996);try{await lockNoti('Backing\x20up...',_0x523996,0xbb8),await dpUploadFile(_0x523996,_0x5cc480,_0x55a953);}catch(_0x1ddd13){console[_0x54b53b(0x119)](_0x54b53b(0x126)+_0x523996+':',_0x1ddd13);}}}else console[_0x54b53b(0x16c)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener'](_0x580286(0x148),function(){var _0x2bec83=_0x580286;const _0x29a2d2=localStorage[_0x2bec83(0x177)]('uId');_0x29a2d2===null||_0x29a2d2===''?authorizeWithDropbox():window[_0x2bec83(0x157)](_0x2bec83(0x162))&&(localStorage[_0x2bec83(0x161)](_0x2bec83(0x123),''),dropboxRestore[_0x2bec83(0x115)]['remove'](_0x2bec83(0x11a)),dropboxBackup[_0x2bec83(0x115)][_0x2bec83(0x147)](_0x2bec83(0x11a)),dropboxCloud[_0x2bec83(0x115)][_0x2bec83(0x147)]('active'));}),handleDropboxCallback();});