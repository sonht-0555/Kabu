var a0_0x4ad27d=a0_0x2bd5;(function(_0x25e86d,_0x3e3774){var _0x38d8a8=a0_0x2bd5,_0x38d967=_0x25e86d();while(!![]){try{var _0x418c61=parseInt(_0x38d8a8(0x1ac))/0x1*(parseInt(_0x38d8a8(0x15d))/0x2)+-parseInt(_0x38d8a8(0x164))/0x3*(parseInt(_0x38d8a8(0x17f))/0x4)+parseInt(_0x38d8a8(0x166))/0x5*(parseInt(_0x38d8a8(0x167))/0x6)+parseInt(_0x38d8a8(0x1af))/0x7*(parseInt(_0x38d8a8(0x169))/0x8)+parseInt(_0x38d8a8(0x1b5))/0x9+parseInt(_0x38d8a8(0x15f))/0xa*(-parseInt(_0x38d8a8(0x188))/0xb)+parseInt(_0x38d8a8(0x1c3))/0xc;if(_0x418c61===_0x3e3774)break;else _0x38d967['push'](_0x38d967['shift']());}catch(_0x44a744){_0x38d967['push'](_0x38d967['shift']());}}}(a0_0x204d,0x3fa2f));import*as a0_0x1dd55f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4ad27d(0x19c),clientSecret=a0_0x4ad27d(0x172);function authorizeWithDropbox(){var _0x5f5282=a0_0x4ad27d,_0x419fe6=window['location']['href'][_0x5f5282(0x1bc)]('?')[0x0],_0x20d602=_0x5f5282(0x198),_0x4eb1b2=_0x5f5282(0x1a9),_0x2becb5=_0x5f5282(0x18c)+clientId+_0x5f5282(0x1b2)+_0x20d602+_0x5f5282(0x176)+_0x4eb1b2+_0x5f5282(0x16e)+encodeURIComponent(_0x419fe6);window[_0x5f5282(0x1c0)]['href']=_0x2becb5;}function a0_0x204d(){var _0x290aa9=['Wait\x20a\x20little\x20bit...','Download\x20failed,\x20unknown\x20http\x20status:','Error\x20creating\x20folder\x20','refreshToken','Folder\x20created','refresh_token','\x20files\x20from\x20Cloud?','overwrite','https://api.dropbox.com/oauth2/token','Do\x20you\x20want\x20to\x20logout?','\x20files\x20in\x20Kabu?','POST','offline','Bearer\x20','Cloud\x20login\x20required!','1pNAwNK','authorization_code','click','50659sblwnq','https://api.dropboxapi.com/2/files/list_folder','/data/','&response_type=','uid','status','673650ubAtVF','application/octet-stream','list','save','length','No\x20files\x20found\x20to\x20restore.','uId','split','Content-Type','Do\x20you\x20want\x20to\x20restore\x20','blob','location','addEventListener','remove','3961932CJUFtZ','getItem','json','application/json','name','entries','alert','951110BAYtSy','open','55060HYbkin','[\x5c?&#]','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Refreshing\x20token...','FSSync','3fpoOjW','Failed\x20to\x20upload\x20file\x20','5DHRgQG','251778Vslblo','filter','104xNNfZe','access_token','screenshot','Upload\x20failed,\x20unknown\x20http\x20status:\x20','parse','&redirect_uri=','stringify','Kabu\x20storage\x20↦\x20Cloud\x20◆','application/x-www-form-urlencoded','nwb3dnfh09rhs31','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','slice','onload','&token_access_type=','Cloud\x20↦\x20Kabu\x20storage\x20◆','setItem','uploadFileInCloud','Folder\x20already\x20exists','folder','active','file','send','975588PNMWpk','toUpperCase','accessToken','https://api.dropboxapi.com/2/files/create_folder_v2','DOMContentLoaded','downloadFileInCloud','code=','Error\x20while\x20refreshing\x20token:','responseText','1023sPSjff','error_description','Restoring...','https://content.dropboxapi.com/2/files/download','https://www.dropbox.com/oauth2/authorize?client_id=','classList','charAt','Restore\x20canceled\x20by\x20user.','state','href','replace','error','search','Download\x20failed\x20for\x20','log','Unable\x20to\x20refresh\x20token','code','Failed\x20to\x20refresh\x20Dropbox\x20token.','confirm','&client_id=','knh3uz2mx2hp2eu'];a0_0x204d=function(){return _0x290aa9;};return a0_0x204d();}function handleDropboxCallback(){var _0x40e536=a0_0x4ad27d,_0x5c6f16=getUrlParameter(_0x40e536(0x198));_0x5c6f16?(getAccessToken(_0x5c6f16),console['log']('Authorization\x20Code:',_0x5c6f16)):console[_0x40e536(0x196)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x32dde4){var _0x3ddd14=a0_0x4ad27d;_0x32dde4=_0x32dde4['replace'](/[\[]/,'\x5c[')[_0x3ddd14(0x192)](/[\]]/,'\x5c]');var _0x1726ed=new RegExp(_0x3ddd14(0x160)+_0x32dde4+'=([^&#]*)'),_0x465235=_0x1726ed['exec'](location[_0x3ddd14(0x194)]);return _0x465235===null?'':decodeURIComponent(_0x465235[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x2d3732){var _0x524535=a0_0x4ad27d,_0x32db82=_0x524535(0x1ad),_0x4a313e=window[_0x524535(0x1c0)][_0x524535(0x191)][_0x524535(0x1bc)]('?')[0x0],_0x2d4781=new XMLHttpRequest();_0x2d4781[_0x524535(0x15e)](_0x524535(0x1a8),_0x524535(0x1a5)),_0x2d4781['setRequestHeader'](_0x524535(0x1bd),_0x524535(0x171)),_0x2d4781[_0x524535(0x175)]=function(){var _0x43dd7e=_0x524535;if(_0x2d4781[_0x43dd7e(0x1b4)]===0xc8){var _0x4e35b6=JSON[_0x43dd7e(0x16d)](_0x2d4781[_0x43dd7e(0x187)]),_0x472dbc=_0x4e35b6[_0x43dd7e(0x16a)],_0x60978a=_0x4e35b6[_0x43dd7e(0x1a2)],_0x594240=_0x4e35b6[_0x43dd7e(0x1b3)];localStorage['setItem'](_0x43dd7e(0x181),_0x472dbc),localStorage[_0x43dd7e(0x178)](_0x43dd7e(0x1a0),_0x60978a),localStorage[_0x43dd7e(0x178)](_0x43dd7e(0x1bb),_0x594240);}else console[_0x43dd7e(0x196)](_0x43dd7e(0x173));},_0x2d4781[_0x524535(0x17e)](_0x524535(0x185)+_0x2d3732+'&grant_type='+_0x32db82+_0x524535(0x19b)+clientId+'&client_secret='+clientSecret+_0x524535(0x16e)+encodeURIComponent(_0x4a313e));}function a0_0x2bd5(_0x3102c8,_0x33ccf2){var _0x204de3=a0_0x204d();return a0_0x2bd5=function(_0x2bd571,_0x20ef4c){_0x2bd571=_0x2bd571-0x15c;var _0x27bb9a=_0x204de3[_0x2bd571];return _0x27bb9a;},a0_0x2bd5(_0x3102c8,_0x33ccf2);}export async function dpCreateFolder(_0x3e1e5d){var _0x20a5c6=a0_0x4ad27d;const _0x288ebc=localStorage['getItem'](_0x20a5c6(0x1bb));let _0x5917e9=localStorage['getItem'](_0x20a5c6(0x181));const _0x17988c='/'+_0x288ebc+'/'+_0x3e1e5d,_0x368a3a=JSON[_0x20a5c6(0x16f)]({'path':_0x17988c,'autorename':![]});for(let _0x5b9ec0=0x0;_0x5b9ec0<0x2;_0x5b9ec0++){try{const _0x24a83b=await fetch(_0x20a5c6(0x182),{'method':_0x20a5c6(0x1a8),'headers':{'Authorization':'Bearer\x20'+_0x5917e9,'Content-Type':_0x20a5c6(0x1c6)},'body':_0x368a3a});if(_0x24a83b[_0x20a5c6(0x1b4)]===0x191){const _0x56f1ae=await dpRefreshToken();if(!_0x56f1ae)throw new Error(_0x20a5c6(0x197));_0x5917e9=localStorage[_0x20a5c6(0x1c4)](_0x20a5c6(0x181));continue;}if(_0x24a83b[_0x20a5c6(0x1b4)]===0x199)return{'message':_0x20a5c6(0x17a),'path':_0x3e1e5d};if(!_0x24a83b['ok'])throw new Error(_0x20a5c6(0x19f)+_0x3e1e5d);const _0x5cbee6=await _0x24a83b[_0x20a5c6(0x1c5)]();return await lockNoti(_0x20a5c6(0x1a1),'',0xbb8),_0x5cbee6;}catch(_0x158332){if(_0x5b9ec0===0x1)throw _0x158332;}}return![];}export async function dpRefreshToken(){var _0xb5b518=a0_0x4ad27d;if(!localStorage[_0xb5b518(0x1c4)](_0xb5b518(0x1a0)))throw'No\x20refresh\x20token';try{const _0x20addf=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0xb5b518(0x1a8),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':'refresh_token='+localStorage[_0xb5b518(0x1c4)](_0xb5b518(0x1a0))+_0xb5b518(0x161)}),_0x2b4d41=await _0x20addf[_0xb5b518(0x1c5)]();if(!_0x2b4d41['error'])return localStorage['setItem'](_0xb5b518(0x181),_0x2b4d41['access_token']),await lockNoti(_0xb5b518(0x162),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2b4d41[_0xb5b518(0x189)]||_0xb5b518(0x199));}catch(_0x369a36){console['error'](_0xb5b518(0x186),_0x369a36);}return![];}export async function dpUploadFile(_0xbad4ef,_0x50457d,_0x24086d){var _0x1b5435=a0_0x4ad27d;const _0x30634c=localStorage[_0x1b5435(0x1c4)](_0x1b5435(0x1bb));var _0x827182=JSON[_0x1b5435(0x16f)]({'autorename':!![],'mode':_0x1b5435(0x1a4),'mute':!![],'strict_conflict':![],'path':'/'+_0x30634c+'/'+_0x24086d+'/'+_0xbad4ef}),_0x10aae1=new Blob([_0x50457d],{'type':_0x1b5435(0x1b6)});for(var _0x4827f0=0x0;_0x4827f0<0x2;_0x4827f0++){var _0x50f228=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x1b5435(0x1a8),'headers':{'Authorization':_0x1b5435(0x1aa)+localStorage[_0x1b5435(0x1c4)](_0x1b5435(0x181)),'Dropbox-API-Arg':_0x827182,'Content-Type':'application/octet-stream'},'body':_0x10aae1});if(_0x50f228[_0x1b5435(0x1b4)]!=0xc8){if(_0x50f228[_0x1b5435(0x1b4)]==0x191){var _0x2d8df8=await dpRefreshToken();if(!_0x2d8df8)throw _0x1b5435(0x197);continue;}else throw _0x1b5435(0x16c)+_0x50f228[_0x1b5435(0x1b4)];}else{var _0x36173a=await _0x50f228[_0x1b5435(0x1c5)]();return console[_0x1b5435(0x196)](_0x1b5435(0x170),_0xbad4ef),_0x36173a;}}return![];}export async function dpDownloadFile(_0x33a6c6,_0x189074){var _0x24c9c4=a0_0x4ad27d;const _0x1375ee=localStorage[_0x24c9c4(0x1c4)](_0x24c9c4(0x1bb));var _0x174df7=JSON[_0x24c9c4(0x16f)]({'path':'/'+_0x1375ee+'/'+_0x189074+'/'+_0x33a6c6});for(var _0x9ed0e3=0x0;_0x9ed0e3<0x2;_0x9ed0e3++){var _0x4bf7a5=await fetch(_0x24c9c4(0x18b),{'method':_0x24c9c4(0x1a8),'headers':{'Authorization':_0x24c9c4(0x1aa)+localStorage[_0x24c9c4(0x1c4)](_0x24c9c4(0x181)),'Dropbox-API-Arg':_0x174df7}});if(_0x4bf7a5[_0x24c9c4(0x1b4)]!=0xc8){if(_0x4bf7a5[_0x24c9c4(0x1b4)]==0x191){var _0x3ddf86=await dpRefreshToken();if(!_0x3ddf86)throw _0x24c9c4(0x197);continue;}else throw _0x24c9c4(0x19e)+_0x4bf7a5[_0x24c9c4(0x1b4)];}const _0x2eaf94=new File([await _0x4bf7a5[_0x24c9c4(0x1bf)]()],_0x33a6c6);return console['log'](_0x24c9c4(0x177),_0x2eaf94[_0x24c9c4(0x1c7)]),a0_0x1dd55f[_0x24c9c4(0x179)](_0x2eaf94,()=>{var _0x3d8229=_0x24c9c4;localStorageFile(),Module[_0x3d8229(0x163)]();}),_0x2eaf94;}return![];}document[a0_0x4ad27d(0x1c1)](a0_0x4ad27d(0x183),function(){var _0x6653b6=a0_0x4ad27d;dropboxRestore[_0x6653b6(0x1c1)](_0x6653b6(0x1ae),async function(){var _0x3dd065=_0x6653b6;await lockNoti(_0x3dd065(0x19d),'',0x1388);const _0x3f4ab0=localStorage['getItem'](_0x3dd065(0x1bb)),_0x31b06f=[_0x3dd065(0x190),_0x3dd065(0x1b8),_0x3dd065(0x16b)];if(!_0x3f4ab0){window['alert'](_0x3dd065(0x1ab));return;}let _0x211335=[];for(const _0x51b4c9 of _0x31b06f){let _0x4609cc={'path':'/'+_0x3f4ab0+'/'+_0x51b4c9};for(let _0x1698d3=0x0;_0x1698d3<0x2;_0x1698d3++){let _0x2253a8=await fetch(_0x3dd065(0x1b0),{'method':_0x3dd065(0x1a8),'headers':{'Authorization':_0x3dd065(0x1aa)+localStorage[_0x3dd065(0x1c4)]('accessToken'),'Content-Type':_0x3dd065(0x1c6)},'body':JSON[_0x3dd065(0x16f)](_0x4609cc)});if(_0x2253a8[_0x3dd065(0x1b4)]===0xc8){let _0x4b62c5=await _0x2253a8[_0x3dd065(0x1c5)](),_0x4cdd76=_0x4b62c5[_0x3dd065(0x1c8)][_0x3dd065(0x168)](_0x251ffb=>_0x251ffb['.tag']===_0x3dd065(0x17d));_0x4cdd76[_0x3dd065(0x1b9)]>0x0&&_0x211335['push'](..._0x4cdd76['map'](_0x3800d3=>({'name':_0x3800d3['name'],'folder':_0x51b4c9})));break;}else{if(_0x2253a8['status']===0x191){let _0x196b62=await dpRefreshToken();if(!_0x196b62)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x3dd065(0x195)+_0x51b4c9+',\x20status:\x20'+_0x2253a8[_0x3dd065(0x1b4)]);break;}}}}if(_0x211335[_0x3dd065(0x1b9)]>0x0){const _0x5c23fb=_0x3dd065(0x1be)+_0x211335[_0x3dd065(0x1b9)]+_0x3dd065(0x1a3);if(window[_0x3dd065(0x19a)](_0x5c23fb))for(const _0x22a9ab of _0x211335){await lockNoti(_0x3dd065(0x18a),_0x22a9ab['name'],0xbb8),await dpDownloadFile(_0x22a9ab[_0x3dd065(0x1c7)],_0x22a9ab[_0x3dd065(0x17b)]);}else console[_0x3dd065(0x196)](_0x3dd065(0x18f));}else console[_0x3dd065(0x196)](_0x3dd065(0x1ba));}),dropboxBackup[_0x6653b6(0x1c1)](_0x6653b6(0x1ae),async function(){var _0x4c2640=_0x6653b6;await lockNoti(_0x4c2640(0x19d),'',0x1388);const _0x284a69=localStorage[_0x4c2640(0x1c4)]('uId');if(_0x284a69===null||_0x284a69==='')window[_0x4c2640(0x15c)]('Cloud\x20login\x20required!');else{const _0x37b71f=[_0x4c2640(0x190),_0x4c2640(0x1b8),_0x4c2640(0x16b)];for(const _0x2949ee of _0x37b71f){await dpCreateFolder(_0x2949ee);}let _0x2c63ab=0x0;for(const _0x2b2b73 of _0x37b71f){const _0x19bde6=a0_0x1dd55f[_0x4c2640(0x1b7)+(_0x2b2b73[_0x4c2640(0x18e)](0x0)[_0x4c2640(0x180)]()+_0x2b2b73[_0x4c2640(0x174)](0x1))]();_0x2c63ab+=_0x19bde6[_0x4c2640(0x1b9)];}if(window[_0x4c2640(0x19a)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x2c63ab+_0x4c2640(0x1a7)))for(const _0x2546e6 of _0x37b71f){const _0xd642d5=a0_0x1dd55f[_0x4c2640(0x1b7)+(_0x2546e6[_0x4c2640(0x18e)](0x0)[_0x4c2640(0x180)]()+_0x2546e6[_0x4c2640(0x174)](0x1))]();for(const _0x5f231b of _0xd642d5){const _0x124c18=await a0_0x1dd55f[_0x4c2640(0x184)](_0x4c2640(0x1b1)+_0x2546e6+'s/'+_0x5f231b);try{await lockNoti('Backing\x20up...',_0x5f231b,0xbb8),await dpUploadFile(_0x5f231b,_0x124c18,_0x2546e6);}catch(_0x46dcd0){console[_0x4c2640(0x193)](_0x4c2640(0x165)+_0x5f231b+':',_0x46dcd0);}}}else console[_0x4c2640(0x196)](_0x4c2640(0x18f));}}),dropboxCloud['addEventListener']('click',function(){var _0x4260c0=_0x6653b6;const _0xb76f1e=localStorage[_0x4260c0(0x1c4)]('uId');_0xb76f1e===null||_0xb76f1e===''?authorizeWithDropbox():window[_0x4260c0(0x19a)](_0x4260c0(0x1a6))&&(localStorage[_0x4260c0(0x178)]('uId',''),dropboxRestore[_0x4260c0(0x18d)][_0x4260c0(0x1c2)]('active'),dropboxBackup[_0x4260c0(0x18d)][_0x4260c0(0x1c2)](_0x4260c0(0x17c)),dropboxCloud[_0x4260c0(0x18d)][_0x4260c0(0x1c2)](_0x4260c0(0x17c)));}),handleDropboxCallback();});