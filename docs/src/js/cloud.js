var a0_0x28e8f8=a0_0x110a;(function(_0x55e5e6,_0x10e1d1){var _0x138a23=a0_0x110a,_0x3fdafd=_0x55e5e6();while(!![]){try{var _0x2d4420=parseInt(_0x138a23(0x15f))/0x1+-parseInt(_0x138a23(0x1b8))/0x2+-parseInt(_0x138a23(0x19d))/0x3*(-parseInt(_0x138a23(0x181))/0x4)+parseInt(_0x138a23(0x1b7))/0x5*(parseInt(_0x138a23(0x174))/0x6)+parseInt(_0x138a23(0x179))/0x7*(parseInt(_0x138a23(0x177))/0x8)+-parseInt(_0x138a23(0x182))/0x9+parseInt(_0x138a23(0x190))/0xa*(-parseInt(_0x138a23(0x188))/0xb);if(_0x2d4420===_0x10e1d1)break;else _0x3fdafd['push'](_0x3fdafd['shift']());}catch(_0x41c9e4){_0x3fdafd['push'](_0x3fdafd['shift']());}}}(a0_0x2f2a,0x59a10));import*as a0_0x5e793a from'./main.js';function a0_0x110a(_0x504fbf,_0x1bac5a){var _0x2f2aac=a0_0x2f2a();return a0_0x110a=function(_0x110a19,_0xc32cb6){_0x110a19=_0x110a19-0x153;var _0x50f311=_0x2f2aac[_0x110a19];return _0x50f311;},a0_0x110a(_0x504fbf,_0x1bac5a);}function a0_0x2f2a(){var _0x3d257d=['Do\x20you\x20want\x20to\x20logout?','push','Restoring...','onload','Unable\x20to\x20refresh\x20token','map','offline','Download\x20failed\x20for\x20','code','=([^&#]*)','log','error','Folder\x20created','application/octet-stream','https://api.dropboxapi.com/2/files/list_folder','2650460eAlEnn','207162almQwQ','Failed\x20to\x20upload\x20file\x20','DOMContentLoaded','Error\x20while\x20refreshing\x20token:','https://api.dropbox.com/oauth2/token','Kabu\x20storage\x20↦\x20Cloud\x20◆','split','Bearer\x20','uId','accessToken','Wait\x20a\x20little\x20bit...','alert','setRequestHeader','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','671856mdgVlF','Restore\x20canceled\x20by\x20user.','json','stringify','responseText','refresh_token','Failed\x20to\x20refresh\x20Dropbox\x20token.','getItem','click','blob','Upload\x20failed,\x20unknown\x20http\x20status:\x20','classList','&client_id=','application/x-www-form-urlencoded','Content-Type','access_token','POST','application/json','Backing\x20up...','refreshToken','Do\x20you\x20want\x20to\x20backup\x20','6DKojjd','active','&response_type=','3655224Arnrpo','open','7cVsDGy','Download\x20failed,\x20unknown\x20http\x20status:','href','screenshot','/data/','Refreshing\x20token...','filter','parse','8TtJDlh','6547104wLhbeb','overwrite','Do\x20not\x20receive\x20authorization','https://www.dropbox.com/oauth2/authorize?client_id=','state','Cloud\x20login\x20required!','60786hvPuQh','addEventListener','search','folder','status','save','exec','.tag','1030dWNwlG','remove','name','nwb3dnfh09rhs31','refresh_token=','&grant_type=','error_description','&redirect_uri=','file','length','confirm','https://content.dropboxapi.com/2/files/download','replace','162726usdWqG','Cloud\x20↦\x20Kabu\x20storage\x20◆','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','setItem','location',',\x20status:\x20','https://api.dropboxapi.com/oauth2/token','&token_access_type=','listFiles','uploadFileInCloud','send'];a0_0x2f2a=function(){return _0x3d257d;};return a0_0x2f2a();}import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x28e8f8(0x193);function authorizeWithDropbox(){var _0x10e285=a0_0x28e8f8,_0xa5db4e=window[_0x10e285(0x1a1)][_0x10e285(0x17b)][_0x10e285(0x157)]('?')[0x0],_0x56c44f=_0x10e285(0x1b0),_0x440fb4=_0x10e285(0x1ae),_0x3a2ee9=_0x10e285(0x185)+clientId+_0x10e285(0x176)+_0x56c44f+_0x10e285(0x1a4)+_0x440fb4+'&redirect_uri='+encodeURIComponent(_0xa5db4e);window[_0x10e285(0x1a1)]['href']=_0x3a2ee9;}function handleDropboxCallback(){var _0x3cb3c0=a0_0x28e8f8,_0x544c36=getUrlParameter(_0x3cb3c0(0x1b0));_0x544c36?(getAccessToken(_0x544c36),console[_0x3cb3c0(0x1b2)]('Authorization\x20Code:',_0x544c36)):console[_0x3cb3c0(0x1b2)](_0x3cb3c0(0x184));}function getUrlParameter(_0x20d799){var _0xbbaf1=a0_0x28e8f8;_0x20d799=_0x20d799['replace'](/[\[]/,'\x5c[')[_0xbbaf1(0x19c)](/[\]]/,'\x5c]');var _0xe71b71=new RegExp('[\x5c?&#]'+_0x20d799+_0xbbaf1(0x1b1)),_0x32e0c6=_0xe71b71[_0xbbaf1(0x18e)](location[_0xbbaf1(0x18a)]);return _0x32e0c6===null?'':decodeURIComponent(_0x32e0c6[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x4a772c){var _0x4ebf91=a0_0x28e8f8,_0x50def2='authorization_code',_0x453a5f=window[_0x4ebf91(0x1a1)][_0x4ebf91(0x17b)][_0x4ebf91(0x157)]('?')[0x0],_0x345dd8=new XMLHttpRequest();_0x345dd8[_0x4ebf91(0x178)](_0x4ebf91(0x16f),_0x4ebf91(0x155)),_0x345dd8[_0x4ebf91(0x15d)](_0x4ebf91(0x16d),_0x4ebf91(0x16c)),_0x345dd8[_0x4ebf91(0x1ab)]=function(){var _0x1c3d04=_0x4ebf91;if(_0x345dd8[_0x1c3d04(0x18c)]===0xc8){var _0x5bd20c=JSON[_0x1c3d04(0x180)](_0x345dd8[_0x1c3d04(0x163)]),_0x467b24=_0x5bd20c[_0x1c3d04(0x16e)],_0x2b65d6=_0x5bd20c[_0x1c3d04(0x164)],_0x35f912=_0x5bd20c['uid'];localStorage[_0x1c3d04(0x1a0)](_0x1c3d04(0x15a),_0x467b24),localStorage['setItem']('refreshToken',_0x2b65d6),localStorage['setItem'](_0x1c3d04(0x159),_0x35f912);}else console['log'](_0x1c3d04(0x15e));},_0x345dd8[_0x4ebf91(0x1a7)]('code='+_0x4a772c+_0x4ebf91(0x195)+_0x50def2+_0x4ebf91(0x16b)+clientId+'&client_secret='+clientSecret+_0x4ebf91(0x197)+encodeURIComponent(_0x453a5f));}export async function dpCreateFolder(_0x36a7df){var _0xb13a5d=a0_0x28e8f8;const _0x541906=localStorage['getItem'](_0xb13a5d(0x159));let _0x39b46d=localStorage['getItem'](_0xb13a5d(0x15a));const _0x4011a7='/'+_0x541906+'/'+_0x36a7df,_0x10a6bf=JSON[_0xb13a5d(0x162)]({'path':_0x4011a7,'autorename':![]});for(let _0x3cd9ec=0x0;_0x3cd9ec<0x2;_0x3cd9ec++){try{const _0x18f24a=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0xb13a5d(0x16f),'headers':{'Authorization':_0xb13a5d(0x158)+_0x39b46d,'Content-Type':'application/json'},'body':_0x10a6bf});if(_0x18f24a[_0xb13a5d(0x18c)]===0x191){const _0x50b79c=await dpRefreshToken();if(!_0x50b79c)throw new Error('Unable\x20to\x20refresh\x20token');_0x39b46d=localStorage[_0xb13a5d(0x166)](_0xb13a5d(0x15a));continue;}if(_0x18f24a[_0xb13a5d(0x18c)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x36a7df};if(!_0x18f24a['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x36a7df);const _0x2fe40f=await _0x18f24a[_0xb13a5d(0x161)]();return await lockNoti(_0xb13a5d(0x1b4),'',0xbb8),_0x2fe40f;}catch(_0x2b291c){if(_0x3cd9ec===0x1)throw _0x2b291c;}}return![];}export async function dpRefreshToken(){var _0x50a06f=a0_0x28e8f8;if(!localStorage[_0x50a06f(0x166)](_0x50a06f(0x172)))throw'No\x20refresh\x20token';try{const _0x3dd479=await fetch(_0x50a06f(0x1a3),{'method':_0x50a06f(0x16f),'headers':{'Content-Type':_0x50a06f(0x16c)},'body':_0x50a06f(0x194)+localStorage[_0x50a06f(0x166)]('refreshToken')+_0x50a06f(0x19f)}),_0x4e59ec=await _0x3dd479[_0x50a06f(0x161)]();if(!_0x4e59ec['error'])return localStorage[_0x50a06f(0x1a0)](_0x50a06f(0x15a),_0x4e59ec['access_token']),await lockNoti(_0x50a06f(0x17e),'',0xbb8),await delay(0x3e8),!![];else alert(_0x4e59ec[_0x50a06f(0x196)]||_0x50a06f(0x165));}catch(_0x59f629){console[_0x50a06f(0x1b3)](_0x50a06f(0x154),_0x59f629);}return![];}export async function dpUploadFile(_0xa0bbf7,_0x358ffa,_0x4e4a9d){var _0x5d123f=a0_0x28e8f8;const _0x2e7f09=localStorage[_0x5d123f(0x166)]('uId');var _0x2ed446=JSON['stringify']({'autorename':!![],'mode':_0x5d123f(0x183),'mute':!![],'strict_conflict':![],'path':'/'+_0x2e7f09+'/'+_0x4e4a9d+'/'+_0xa0bbf7}),_0x20b5cf=new Blob([_0x358ffa],{'type':'application/octet-stream'});for(var _0x239e8a=0x0;_0x239e8a<0x2;_0x239e8a++){var _0x363383=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x5d123f(0x166)]('accessToken'),'Dropbox-API-Arg':_0x2ed446,'Content-Type':_0x5d123f(0x1b5)},'body':_0x20b5cf});if(_0x363383[_0x5d123f(0x18c)]!=0xc8){if(_0x363383[_0x5d123f(0x18c)]==0x191){var _0x25ed78=await dpRefreshToken();if(!_0x25ed78)throw _0x5d123f(0x1ac);continue;}else throw _0x5d123f(0x169)+_0x363383[_0x5d123f(0x18c)];}else{var _0x4155a2=await _0x363383['json']();return console[_0x5d123f(0x1b2)](_0x5d123f(0x156),_0xa0bbf7),_0x4155a2;}}return![];}export async function dpDownloadFile(_0x3c3934,_0x16bb9d){var _0x516a44=a0_0x28e8f8;const _0x43781c=localStorage['getItem']('uId');var _0x391975=JSON[_0x516a44(0x162)]({'path':'/'+_0x43781c+'/'+_0x16bb9d+'/'+_0x3c3934});for(var _0x376b5c=0x0;_0x376b5c<0x2;_0x376b5c++){var _0xd51bf8=await fetch(_0x516a44(0x19b),{'method':_0x516a44(0x16f),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x516a44(0x166)](_0x516a44(0x15a)),'Dropbox-API-Arg':_0x391975}});if(_0xd51bf8[_0x516a44(0x18c)]!=0xc8){if(_0xd51bf8[_0x516a44(0x18c)]==0x191){var _0xf19153=await dpRefreshToken();if(!_0xf19153)throw _0x516a44(0x1ac);continue;}else throw _0x516a44(0x17a)+_0xd51bf8['status'];}const _0x19eb3c=new File([await _0xd51bf8[_0x516a44(0x168)]()],_0x3c3934);return console[_0x516a44(0x1b2)](_0x516a44(0x19e),_0x19eb3c[_0x516a44(0x192)]),a0_0x5e793a[_0x516a44(0x1a6)](_0x19eb3c,()=>{}),_0x19eb3c;}return![];}document[a0_0x28e8f8(0x189)](a0_0x28e8f8(0x153),function(){var _0x2e9d5a=a0_0x28e8f8;dropboxRestore['addEventListener'](_0x2e9d5a(0x167),async function(){var _0x7d52af=_0x2e9d5a;await lockNoti(_0x7d52af(0x15b),'',0x1388);const _0x4baaa2=localStorage[_0x7d52af(0x166)](_0x7d52af(0x159)),_0x557938=['state',_0x7d52af(0x18d),_0x7d52af(0x17c)];if(!_0x4baaa2){window[_0x7d52af(0x15c)](_0x7d52af(0x187));return;}let _0x3ecc15=[];for(const _0xd20ff7 of _0x557938){let _0x287426={'path':'/'+_0x4baaa2+'/'+_0xd20ff7};for(let _0x3bb8ff=0x0;_0x3bb8ff<0x2;_0x3bb8ff++){let _0x20906b=await fetch(_0x7d52af(0x1b6),{'method':_0x7d52af(0x16f),'headers':{'Authorization':_0x7d52af(0x158)+localStorage[_0x7d52af(0x166)](_0x7d52af(0x15a)),'Content-Type':_0x7d52af(0x170)},'body':JSON[_0x7d52af(0x162)](_0x287426)});if(_0x20906b['status']===0xc8){let _0x2f6eed=await _0x20906b['json'](),_0x202be8=_0x2f6eed['entries'][_0x7d52af(0x17f)](_0x481bc5=>_0x481bc5[_0x7d52af(0x18f)]===_0x7d52af(0x198));_0x202be8[_0x7d52af(0x199)]>0x0&&_0x3ecc15[_0x7d52af(0x1a9)](..._0x202be8[_0x7d52af(0x1ad)](_0x440a0c=>({'name':_0x440a0c[_0x7d52af(0x192)],'folder':_0xd20ff7})));break;}else{if(_0x20906b[_0x7d52af(0x18c)]===0x191){let _0x275efd=await dpRefreshToken();if(!_0x275efd)throw _0x7d52af(0x1ac);}else{console[_0x7d52af(0x1b3)](_0x7d52af(0x1af)+_0xd20ff7+_0x7d52af(0x1a2)+_0x20906b[_0x7d52af(0x18c)]);break;}}}}if(_0x3ecc15['length']>0x0){const _0x505bf0='Do\x20you\x20want\x20to\x20restore\x20'+_0x3ecc15[_0x7d52af(0x199)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x505bf0))for(const _0x276ea1 of _0x3ecc15){await lockNoti(_0x7d52af(0x1aa),_0x276ea1['name'],0xbb8),await dpDownloadFile(_0x276ea1['name'],_0x276ea1[_0x7d52af(0x18b)]);}else console[_0x7d52af(0x1b2)](_0x7d52af(0x160));}else console[_0x7d52af(0x1b2)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x2e9d5a(0x189)](_0x2e9d5a(0x167),async function(){var _0x489136=_0x2e9d5a;await lockNoti(_0x489136(0x15b),'',0x1388);const _0x5348c0=localStorage[_0x489136(0x166)]('uId');if(_0x5348c0===null||_0x5348c0==='')window[_0x489136(0x15c)](_0x489136(0x187));else{const _0x230c5a=[_0x489136(0x186),_0x489136(0x18d),'screenshot'];for(const _0x2c55ad of _0x230c5a){await dpCreateFolder(_0x2c55ad);}let _0x3179ff=0x0;for(const _0x3f9669 of _0x230c5a){const _0x52abe0=a0_0x5e793a[_0x489136(0x1a5)](_0x3f9669+'s');_0x3179ff+=_0x52abe0['length'];}if(window['confirm'](_0x489136(0x173)+_0x3179ff+'\x20files\x20in\x20Kabu?'))for(const _0x32c7e4 of _0x230c5a){const _0x5498df=a0_0x5e793a[_0x489136(0x1a5)](_0x32c7e4+'s');for(const _0x3541f9 of _0x5498df){const _0xfee54c=await a0_0x5e793a['downloadFileInCloud'](_0x489136(0x17d)+_0x32c7e4+'s/'+_0x3541f9);try{await lockNoti(_0x489136(0x171),_0x3541f9,0xbb8),await dpUploadFile(_0x3541f9,_0xfee54c,_0x32c7e4);}catch(_0x5b1507){console[_0x489136(0x1b3)](_0x489136(0x1b9)+_0x3541f9+':',_0x5b1507);}}}else console[_0x489136(0x1b2)](_0x489136(0x160));}}),dropboxCloud[_0x2e9d5a(0x189)](_0x2e9d5a(0x167),function(){var _0x306e94=_0x2e9d5a;const _0xc78450=localStorage[_0x306e94(0x166)](_0x306e94(0x159));_0xc78450===null||_0xc78450===''?authorizeWithDropbox():window[_0x306e94(0x19a)](_0x306e94(0x1a8))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x306e94(0x16a)][_0x306e94(0x191)](_0x306e94(0x175)),dropboxBackup['classList'][_0x306e94(0x191)](_0x306e94(0x175)),dropboxCloud[_0x306e94(0x16a)]['remove'](_0x306e94(0x175)));}),handleDropboxCallback();});