var a0_0x501889=a0_0x3289;(function(_0x1dd73d,_0x427830){var _0x2a664c=a0_0x3289,_0x1c889f=_0x1dd73d();while(!![]){try{var _0x4f8c7e=parseInt(_0x2a664c(0x165))/0x1+-parseInt(_0x2a664c(0x15d))/0x2*(parseInt(_0x2a664c(0x168))/0x3)+parseInt(_0x2a664c(0x153))/0x4*(parseInt(_0x2a664c(0x170))/0x5)+parseInt(_0x2a664c(0x17e))/0x6*(parseInt(_0x2a664c(0x14c))/0x7)+parseInt(_0x2a664c(0x11f))/0x8+-parseInt(_0x2a664c(0x14b))/0x9*(-parseInt(_0x2a664c(0x138))/0xa)+parseInt(_0x2a664c(0x13d))/0xb*(-parseInt(_0x2a664c(0x187))/0xc);if(_0x4f8c7e===_0x427830)break;else _0x1c889f['push'](_0x1c889f['shift']());}catch(_0x23bcda){_0x1c889f['push'](_0x1c889f['shift']());}}}(a0_0x5f44,0xbcfcb));function a0_0x5f44(){var _0x836874=['map','Error\x20while\x20refreshing\x20token:','515mEVief','href','search','&response_type=','push','click','application/x-www-form-urlencoded','listFiles','open','remove','Wait\x20a\x20little\x20bit...','application/octet-stream','&redirect_uri=','screenshot','467766XdgfAP','application/json','blob','status','Do\x20you\x20want\x20to\x20backup\x20','overwrite','uploadFileInCloud','https://api.dropboxapi.com/2/files/list_folder','Backing\x20up...','21293376vycmGd','error','5266608toIZFT','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','.tag','Do\x20you\x20want\x20to\x20restore\x20','split','json','replace','log','confirm','offline','Failed\x20to\x20upload\x20file\x20',',\x20status:\x20','error_description','=([^&#]*)','&client_id=','setItem','Restoring...','https://www.dropbox.com/oauth2/authorize?client_id=','nwb3dnfh09rhs31','accessToken','knh3uz2mx2hp2eu','Kabu\x20storage\x20↦\x20Cloud\x20◆','refreshToken','folder','510MiRwdX','No\x20files\x20found\x20to\x20restore.','parse','https://api.dropboxapi.com/oauth2/token','Do\x20you\x20want\x20to\x20logout?','11wmqvuK','[\x5c?&#]','&client_secret=','exec','Cloud\x20login\x20required!','No\x20refresh\x20token','onload','POST','Do\x20not\x20receive\x20authorization','getItem','uid','Download\x20failed,\x20unknown\x20http\x20status:','https://content.dropboxapi.com/2/files/download','location','238383OOIFab','14GmeytB','Content-Type','Folder\x20already\x20exists','&token_access_type=','&grant_type=','stringify','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','15496cxglxX','Bearer\x20','classList','code','send','addEventListener','length','Authorization\x20Code:','https://api.dropboxapi.com/2/files/create_folder_v2','refresh_token','2frtRYK','\x20files\x20in\x20Kabu?','Restore\x20canceled\x20by\x20user.','Error\x20creating\x20folder\x20','alert','active','/data/','https://content.dropboxapi.com/2/files/upload','1325843xZzHpP','entries','name','4024233icSPoV','save','Download\x20failed\x20for\x20','access_token','Unable\x20to\x20refresh\x20token','uId'];a0_0x5f44=function(){return _0x836874;};return a0_0x5f44();}function a0_0x3289(_0x170f5e,_0x1ff0ad){var _0x5f448b=a0_0x5f44();return a0_0x3289=function(_0x328907,_0x7826d){_0x328907=_0x328907-0x11e;var _0x27833b=_0x5f448b[_0x328907];return _0x27833b;},a0_0x3289(_0x170f5e,_0x1ff0ad);}import*as a0_0x23ef04 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x501889(0x134),clientSecret=a0_0x501889(0x132);function authorizeWithDropbox(){var _0x439cb5=a0_0x501889,_0xcd299=window['location'][_0x439cb5(0x171)][_0x439cb5(0x124)]('?')[0x0],_0x281645=_0x439cb5(0x156),_0x14bf35=_0x439cb5(0x129),_0x486b4d=_0x439cb5(0x131)+clientId+_0x439cb5(0x173)+_0x281645+_0x439cb5(0x14f)+_0x14bf35+'&redirect_uri='+encodeURIComponent(_0xcd299);window[_0x439cb5(0x14a)][_0x439cb5(0x171)]=_0x486b4d;}function handleDropboxCallback(){var _0x1d36e6=a0_0x501889,_0x57a169=getUrlParameter('code');_0x57a169?(getAccessToken(_0x57a169),console['log'](_0x1d36e6(0x15a),_0x57a169)):console[_0x1d36e6(0x127)](_0x1d36e6(0x145));}function getUrlParameter(_0x197813){var _0x40b54a=a0_0x501889;_0x197813=_0x197813[_0x40b54a(0x126)](/[\[]/,'\x5c[')[_0x40b54a(0x126)](/[\]]/,'\x5c]');var _0x49db2e=new RegExp(_0x40b54a(0x13e)+_0x197813+_0x40b54a(0x12d)),_0x3e60f1=_0x49db2e[_0x40b54a(0x140)](location[_0x40b54a(0x172)]);return _0x3e60f1===null?'':decodeURIComponent(_0x3e60f1[0x1][_0x40b54a(0x126)](/\+/g,'\x20'));}function getAccessToken(_0xbd133d){var _0x2e4d8a=a0_0x501889,_0x540d61='authorization_code',_0x2efb6c=window[_0x2e4d8a(0x14a)][_0x2e4d8a(0x171)][_0x2e4d8a(0x124)]('?')[0x0],_0x14662e=new XMLHttpRequest();_0x14662e[_0x2e4d8a(0x178)](_0x2e4d8a(0x144),'https://api.dropbox.com/oauth2/token'),_0x14662e['setRequestHeader'](_0x2e4d8a(0x14d),_0x2e4d8a(0x176)),_0x14662e[_0x2e4d8a(0x143)]=function(){var _0x482cbc=_0x2e4d8a;if(_0x14662e['status']===0xc8){var _0x504d56=JSON[_0x482cbc(0x13a)](_0x14662e['responseText']),_0x301ce9=_0x504d56[_0x482cbc(0x16b)],_0x582ab0=_0x504d56[_0x482cbc(0x15c)],_0x5b63e8=_0x504d56[_0x482cbc(0x147)];localStorage[_0x482cbc(0x12f)](_0x482cbc(0x133),_0x301ce9),localStorage[_0x482cbc(0x12f)](_0x482cbc(0x136),_0x582ab0),localStorage[_0x482cbc(0x12f)]('uId',_0x5b63e8);}else console['log'](_0x482cbc(0x152));},_0x14662e[_0x2e4d8a(0x157)]('code='+_0xbd133d+_0x2e4d8a(0x150)+_0x540d61+_0x2e4d8a(0x12e)+clientId+_0x2e4d8a(0x13f)+clientSecret+_0x2e4d8a(0x17c)+encodeURIComponent(_0x2efb6c));}export async function dpCreateFolder(_0x481651){var _0xe50d7d=a0_0x501889;const _0x1af919=localStorage[_0xe50d7d(0x146)](_0xe50d7d(0x16d));let _0x35df29=localStorage[_0xe50d7d(0x146)](_0xe50d7d(0x133));const _0x5565c2='/'+_0x1af919+'/'+_0x481651,_0xabf94d=JSON['stringify']({'path':_0x5565c2,'autorename':![]});for(let _0x46eb74=0x0;_0x46eb74<0x2;_0x46eb74++){try{const _0x4ecb4f=await fetch(_0xe50d7d(0x15b),{'method':'POST','headers':{'Authorization':_0xe50d7d(0x154)+_0x35df29,'Content-Type':_0xe50d7d(0x17f)},'body':_0xabf94d});if(_0x4ecb4f[_0xe50d7d(0x181)]===0x191){const _0x45feb3=await dpRefreshToken();if(!_0x45feb3)throw new Error(_0xe50d7d(0x16c));_0x35df29=localStorage[_0xe50d7d(0x146)](_0xe50d7d(0x133));continue;}if(_0x4ecb4f[_0xe50d7d(0x181)]===0x199)return{'message':_0xe50d7d(0x14e),'path':_0x481651};if(!_0x4ecb4f['ok'])throw new Error(_0xe50d7d(0x160)+_0x481651);const _0x58e394=await _0x4ecb4f[_0xe50d7d(0x125)]();return await lockNoti('Folder\x20created','',0xbb8),_0x58e394;}catch(_0x1cedbf){if(_0x46eb74===0x1)throw _0x1cedbf;}}return![];}export async function dpRefreshToken(){var _0x27f1c4=a0_0x501889;if(!localStorage[_0x27f1c4(0x146)](_0x27f1c4(0x136)))throw _0x27f1c4(0x142);try{const _0x1efe11=await fetch(_0x27f1c4(0x13b),{'method':_0x27f1c4(0x144),'headers':{'Content-Type':_0x27f1c4(0x176)},'body':'refresh_token='+localStorage[_0x27f1c4(0x146)](_0x27f1c4(0x136))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x474b04=await _0x1efe11[_0x27f1c4(0x125)]();if(!_0x474b04[_0x27f1c4(0x11e)])return localStorage[_0x27f1c4(0x12f)](_0x27f1c4(0x133),_0x474b04[_0x27f1c4(0x16b)]),await lockNoti(_0x27f1c4(0x120),'',0xbb8),await delay(0x3e8),!![];else alert(_0x474b04[_0x27f1c4(0x12c)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x485bea){console[_0x27f1c4(0x11e)](_0x27f1c4(0x16f),_0x485bea);}return![];}export async function dpUploadFile(_0x3ea7a5,_0x117236,_0x351826){var _0x52dc56=a0_0x501889;const _0x3b16a1=localStorage['getItem'](_0x52dc56(0x16d));var _0x305519=JSON[_0x52dc56(0x151)]({'autorename':!![],'mode':_0x52dc56(0x183),'mute':!![],'strict_conflict':![],'path':'/'+_0x3b16a1+'/'+_0x351826+'/'+_0x3ea7a5}),_0x5d27f2=new Blob([_0x117236],{'type':'application/octet-stream'});for(var _0x51a21e=0x0;_0x51a21e<0x2;_0x51a21e++){var _0x587a44=await fetch(_0x52dc56(0x164),{'method':_0x52dc56(0x144),'headers':{'Authorization':_0x52dc56(0x154)+localStorage[_0x52dc56(0x146)](_0x52dc56(0x133)),'Dropbox-API-Arg':_0x305519,'Content-Type':_0x52dc56(0x17b)},'body':_0x5d27f2});if(_0x587a44[_0x52dc56(0x181)]!=0xc8){if(_0x587a44[_0x52dc56(0x181)]==0x191){var _0x4ec633=await dpRefreshToken();if(!_0x4ec633)throw _0x52dc56(0x16c);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x587a44[_0x52dc56(0x181)];}else{var _0x2573e1=await _0x587a44[_0x52dc56(0x125)]();return console[_0x52dc56(0x127)](_0x52dc56(0x135),_0x3ea7a5),_0x2573e1;}}return![];}export async function dpDownloadFile(_0x1f7390,_0x317772){var _0xd77de0=a0_0x501889;const _0x58f114=localStorage['getItem'](_0xd77de0(0x16d));var _0x381267=JSON[_0xd77de0(0x151)]({'path':'/'+_0x58f114+'/'+_0x317772+'/'+_0x1f7390});for(var _0xdc1fd9=0x0;_0xdc1fd9<0x2;_0xdc1fd9++){var _0x4c8012=await fetch(_0xd77de0(0x149),{'method':_0xd77de0(0x144),'headers':{'Authorization':_0xd77de0(0x154)+localStorage['getItem'](_0xd77de0(0x133)),'Dropbox-API-Arg':_0x381267}});if(_0x4c8012[_0xd77de0(0x181)]!=0xc8){if(_0x4c8012[_0xd77de0(0x181)]==0x191){var _0x2cddef=await dpRefreshToken();if(!_0x2cddef)throw _0xd77de0(0x16c);continue;}else throw _0xd77de0(0x148)+_0x4c8012[_0xd77de0(0x181)];}const _0x2e6436=new File([await _0x4c8012[_0xd77de0(0x180)]()],_0x1f7390);return console[_0xd77de0(0x127)](_0xd77de0(0x121),_0x2e6436[_0xd77de0(0x167)]),a0_0x23ef04[_0xd77de0(0x184)](_0x2e6436,()=>{}),_0x2e6436;}return![];}document[a0_0x501889(0x158)]('DOMContentLoaded',function(){var _0x2cf3fa=a0_0x501889;dropboxRestore['addEventListener'](_0x2cf3fa(0x175),async function(){var _0x2a7f08=_0x2cf3fa;await lockNoti(_0x2a7f08(0x17a),'',0x1388);const _0x54f86b=localStorage[_0x2a7f08(0x146)](_0x2a7f08(0x16d)),_0x5e9614=['state',_0x2a7f08(0x169),_0x2a7f08(0x17d)];if(!_0x54f86b){window[_0x2a7f08(0x161)](_0x2a7f08(0x141));return;}let _0x1c456c=[];for(const _0x4debed of _0x5e9614){let _0x16412={'path':'/'+_0x54f86b+'/'+_0x4debed};for(let _0x5b4520=0x0;_0x5b4520<0x2;_0x5b4520++){let _0x3ee687=await fetch(_0x2a7f08(0x185),{'method':_0x2a7f08(0x144),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x2a7f08(0x146)](_0x2a7f08(0x133)),'Content-Type':_0x2a7f08(0x17f)},'body':JSON[_0x2a7f08(0x151)](_0x16412)});if(_0x3ee687[_0x2a7f08(0x181)]===0xc8){let _0x36afa8=await _0x3ee687[_0x2a7f08(0x125)](),_0x3bc996=_0x36afa8[_0x2a7f08(0x166)]['filter'](_0x4cb5e8=>_0x4cb5e8[_0x2a7f08(0x122)]==='file');_0x3bc996['length']>0x0&&_0x1c456c[_0x2a7f08(0x174)](..._0x3bc996[_0x2a7f08(0x16e)](_0x30e122=>({'name':_0x30e122['name'],'folder':_0x4debed})));break;}else{if(_0x3ee687['status']===0x191){let _0x13986a=await dpRefreshToken();if(!_0x13986a)throw _0x2a7f08(0x16c);}else{console[_0x2a7f08(0x11e)](_0x2a7f08(0x16a)+_0x4debed+_0x2a7f08(0x12b)+_0x3ee687[_0x2a7f08(0x181)]);break;}}}}if(_0x1c456c[_0x2a7f08(0x159)]>0x0){const _0x2b9128=_0x2a7f08(0x123)+_0x1c456c[_0x2a7f08(0x159)]+'\x20files\x20from\x20Cloud?';if(window[_0x2a7f08(0x128)](_0x2b9128))for(const _0x4c3f82 of _0x1c456c){await lockNoti(_0x2a7f08(0x130),_0x4c3f82[_0x2a7f08(0x167)],0xbb8),await dpDownloadFile(_0x4c3f82[_0x2a7f08(0x167)],_0x4c3f82[_0x2a7f08(0x137)]);}else console[_0x2a7f08(0x127)](_0x2a7f08(0x15f));}else console[_0x2a7f08(0x127)](_0x2a7f08(0x139));}),dropboxBackup['addEventListener']('click',async function(){var _0x190381=_0x2cf3fa;await lockNoti(_0x190381(0x17a),'',0x1388);const _0x3fb3ed=localStorage[_0x190381(0x146)](_0x190381(0x16d));if(_0x3fb3ed===null||_0x3fb3ed==='')window[_0x190381(0x161)](_0x190381(0x141));else{const _0x1aee66=['state',_0x190381(0x169),_0x190381(0x17d)];for(const _0xb9664c of _0x1aee66){await dpCreateFolder(_0xb9664c);}let _0xcd5566=0x0;for(const _0x6c3120 of _0x1aee66){const _0x2754d3=a0_0x23ef04[_0x190381(0x177)](_0x6c3120+'s');_0xcd5566+=_0x2754d3['length'];}if(window[_0x190381(0x128)](_0x190381(0x182)+_0xcd5566+_0x190381(0x15e)))for(const _0x193613 of _0x1aee66){const _0x567d29=a0_0x23ef04[_0x190381(0x177)](_0x193613+'s');for(const _0x43959e of _0x567d29){const _0x27983a=await a0_0x23ef04['downloadFileInCloud'](_0x190381(0x163)+_0x193613+'s/'+_0x43959e);try{await lockNoti(_0x190381(0x186),_0x43959e,0xbb8),await dpUploadFile(_0x43959e,_0x27983a,_0x193613);}catch(_0xae1efe){console[_0x190381(0x11e)](_0x190381(0x12a)+_0x43959e+':',_0xae1efe);}}}else console[_0x190381(0x127)](_0x190381(0x15f));}}),dropboxCloud[_0x2cf3fa(0x158)]('click',function(){var _0xe23330=_0x2cf3fa;const _0x25acb6=localStorage[_0xe23330(0x146)](_0xe23330(0x16d));_0x25acb6===null||_0x25acb6===''?authorizeWithDropbox():window['confirm'](_0xe23330(0x13c))&&(localStorage['setItem']('uId',''),dropboxRestore[_0xe23330(0x155)][_0xe23330(0x179)](_0xe23330(0x162)),dropboxBackup['classList'][_0xe23330(0x179)](_0xe23330(0x162)),dropboxCloud[_0xe23330(0x155)][_0xe23330(0x179)](_0xe23330(0x162)));}),handleDropboxCallback();});