var a0_0xd128d1=a0_0xa8e9;(function(_0x2fa8f8,_0x337e24){var _0x29bfa8=a0_0xa8e9,_0x872452=_0x2fa8f8();while(!![]){try{var _0x133f6a=-parseInt(_0x29bfa8(0x117))/0x1*(parseInt(_0x29bfa8(0x108))/0x2)+parseInt(_0x29bfa8(0xd2))/0x3+parseInt(_0x29bfa8(0xeb))/0x4+-parseInt(_0x29bfa8(0xf4))/0x5+parseInt(_0x29bfa8(0xe4))/0x6+-parseInt(_0x29bfa8(0xc7))/0x7+parseInt(_0x29bfa8(0x102))/0x8*(-parseInt(_0x29bfa8(0xe1))/0x9);if(_0x133f6a===_0x337e24)break;else _0x872452['push'](_0x872452['shift']());}catch(_0x35648c){_0x872452['push'](_0x872452['shift']());}}}(a0_0x14b2,0x45e76));import*as a0_0x272996 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0xd128d1(0xe9);function authorizeWithDropbox(){var _0x50a3e2=a0_0xd128d1,_0x31ed86=window[_0x50a3e2(0xbe)]['href'][_0x50a3e2(0xea)]('?')[0x0],_0xba4d45=_0x50a3e2(0x101),_0x386cc9=_0x50a3e2(0x115),_0x5fd8bc=_0x50a3e2(0x103)+clientId+_0x50a3e2(0xef)+_0xba4d45+_0x50a3e2(0x104)+_0x386cc9+'&redirect_uri='+encodeURIComponent(_0x31ed86);window['location'][_0x50a3e2(0xf9)]=_0x5fd8bc;}function a0_0x14b2(){var _0x80c61a=['confirm','code','3304sYiwOJ','https://www.dropbox.com/oauth2/authorize?client_id=','&token_access_type=','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Content-Type','Authorization\x20Code:','106WHoeZb','setRequestHeader','\x20files\x20in\x20Kabu?','[\x5c?&#]','responseText','application/json','onload','DOMContentLoaded','json','Error\x20while\x20refreshing\x20token:','Cloud\x20login\x20required!','No\x20refresh\x20token','Do\x20not\x20receive\x20authorization','offline','error_description','9867KdSPMk','Folder\x20created','code=','&client_id=','setItem','send','Refreshing\x20token...','Error\x20creating\x20folder\x20','Restoring...','remove','click','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropbox.com/oauth2/token','location','refresh_token','addEventListener','filter','https://content.dropboxapi.com/2/files/upload','uid','&client_secret=','error','status','821331gZFLuh','application/octet-stream','Download\x20failed\x20for\x20','search','exec','folder','Do\x20you\x20want\x20to\x20logout?','=([^&#]*)','Backing\x20up...','&grant_type=','uId','1308732waMUFM','file','https://content.dropboxapi.com/2/files/download','getItem','Failed\x20to\x20refresh\x20Dropbox\x20token.','parse','Bearer\x20','Do\x20you\x20want\x20to\x20restore\x20','replace','active','No\x20files\x20found\x20to\x20restore.','classList','POST','Failed\x20to\x20upload\x20file\x20','state','234iQJBfs','Restore\x20canceled\x20by\x20user.','listFiles','2736510qlgfyJ','entries','Kabu\x20storage\x20↦\x20Cloud\x20◆','accessToken','save','nwb3dnfh09rhs31','split','2226476DhBaHp','access_token','name','refreshToken','&response_type=','Folder\x20already\x20exists','\x20files\x20from\x20Cloud?','length','screenshot','2558000NrGfSV','downloadFileInCloud','alert','Unable\x20to\x20refresh\x20token','log','href','application/x-www-form-urlencoded','stringify','/data/','refresh_token=','Do\x20you\x20want\x20to\x20backup\x20','.tag'];a0_0x14b2=function(){return _0x80c61a;};return a0_0x14b2();}function handleDropboxCallback(){var _0x247432=a0_0xd128d1,_0x51eb64=getUrlParameter(_0x247432(0x101));_0x51eb64?(getAccessToken(_0x51eb64),console[_0x247432(0xf8)](_0x247432(0x107),_0x51eb64)):console['log'](_0x247432(0x114));}function getUrlParameter(_0x562bb8){var _0x5dd4ea=a0_0xd128d1;_0x562bb8=_0x562bb8[_0x5dd4ea(0xda)](/[\[]/,'\x5c[')[_0x5dd4ea(0xda)](/[\]]/,'\x5c]');var _0x32b043=new RegExp(_0x5dd4ea(0x10b)+_0x562bb8+_0x5dd4ea(0xce)),_0x410fe2=_0x32b043[_0x5dd4ea(0xcb)](location[_0x5dd4ea(0xca)]);return _0x410fe2===null?'':decodeURIComponent(_0x410fe2[0x1][_0x5dd4ea(0xda)](/\+/g,'\x20'));}function a0_0xa8e9(_0xf5a812,_0x4e8acf){var _0x14b2d8=a0_0x14b2();return a0_0xa8e9=function(_0xa8e97d,_0x2e98f7){_0xa8e97d=_0xa8e97d-0xbb;var _0x1caffd=_0x14b2d8[_0xa8e97d];return _0x1caffd;},a0_0xa8e9(_0xf5a812,_0x4e8acf);}function getAccessToken(_0x4757dd){var _0x4b47f4=a0_0xd128d1,_0xdaf1b3='authorization_code',_0x4c03cd=window[_0x4b47f4(0xbe)][_0x4b47f4(0xf9)][_0x4b47f4(0xea)]('?')[0x0],_0x180992=new XMLHttpRequest();_0x180992['open'](_0x4b47f4(0xde),_0x4b47f4(0xbd)),_0x180992[_0x4b47f4(0x109)](_0x4b47f4(0x106),_0x4b47f4(0xfa)),_0x180992[_0x4b47f4(0x10e)]=function(){var _0x2b3fc3=_0x4b47f4;if(_0x180992['status']===0xc8){var _0x14b29b=JSON[_0x2b3fc3(0xd7)](_0x180992[_0x2b3fc3(0x10c)]),_0x3e1f2f=_0x14b29b[_0x2b3fc3(0xec)],_0x5c27ff=_0x14b29b[_0x2b3fc3(0xbf)],_0x4484aa=_0x14b29b[_0x2b3fc3(0xc3)];localStorage[_0x2b3fc3(0x11b)](_0x2b3fc3(0xe7),_0x3e1f2f),localStorage['setItem'](_0x2b3fc3(0xee),_0x5c27ff),localStorage['setItem'](_0x2b3fc3(0xd1),_0x4484aa);}else console[_0x2b3fc3(0xf8)](_0x2b3fc3(0xbc));},_0x180992[_0x4b47f4(0x11c)](_0x4b47f4(0x119)+_0x4757dd+_0x4b47f4(0xd0)+_0xdaf1b3+_0x4b47f4(0x11a)+clientId+_0x4b47f4(0xc4)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4c03cd));}export async function dpCreateFolder(_0x1aa3cd){var _0x3ea7de=a0_0xd128d1;const _0xae2903=localStorage[_0x3ea7de(0xd5)](_0x3ea7de(0xd1));let _0x236c62=localStorage['getItem'](_0x3ea7de(0xe7));const _0x55fdfa='/'+_0xae2903+'/'+_0x1aa3cd,_0x567cf8=JSON[_0x3ea7de(0xfb)]({'path':_0x55fdfa,'autorename':![]});for(let _0x14d91b=0x0;_0x14d91b<0x2;_0x14d91b++){try{const _0x459a10=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x3ea7de(0xde),'headers':{'Authorization':_0x3ea7de(0xd8)+_0x236c62,'Content-Type':_0x3ea7de(0x10d)},'body':_0x567cf8});if(_0x459a10['status']===0x191){const _0x5bf64a=await dpRefreshToken();if(!_0x5bf64a)throw new Error(_0x3ea7de(0xf7));_0x236c62=localStorage[_0x3ea7de(0xd5)]('accessToken');continue;}if(_0x459a10[_0x3ea7de(0xc6)]===0x199)return{'message':_0x3ea7de(0xf0),'path':_0x1aa3cd};if(!_0x459a10['ok'])throw new Error(_0x3ea7de(0x11e)+_0x1aa3cd);const _0x91f17a=await _0x459a10[_0x3ea7de(0x110)]();return await lockNoti(_0x3ea7de(0x118),'',0xbb8),_0x91f17a;}catch(_0x5d9a73){if(_0x14d91b===0x1)throw _0x5d9a73;}}return![];}export async function dpRefreshToken(){var _0x20d13b=a0_0xd128d1;if(!localStorage[_0x20d13b(0xd5)](_0x20d13b(0xee)))throw _0x20d13b(0x113);try{const _0x1d81c0=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x20d13b(0xde),'headers':{'Content-Type':_0x20d13b(0xfa)},'body':_0x20d13b(0xfd)+localStorage['getItem']('refreshToken')+_0x20d13b(0x105)}),_0x26b4c2=await _0x1d81c0[_0x20d13b(0x110)]();if(!_0x26b4c2[_0x20d13b(0xc5)])return localStorage[_0x20d13b(0x11b)](_0x20d13b(0xe7),_0x26b4c2[_0x20d13b(0xec)]),await lockNoti(_0x20d13b(0x11d),'',0xbb8),await delay(0x3e8),!![];else alert(_0x26b4c2[_0x20d13b(0x116)]||_0x20d13b(0xd6));}catch(_0x49ca83){console[_0x20d13b(0xc5)](_0x20d13b(0x111),_0x49ca83);}return![];}export async function dpUploadFile(_0x12b012,_0xad0202,_0x3ba513){var _0x31029a=a0_0xd128d1;const _0x2dd9d3=localStorage[_0x31029a(0xd5)](_0x31029a(0xd1));var _0x280b13=JSON[_0x31029a(0xfb)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x2dd9d3+'/'+_0x3ba513+'/'+_0x12b012}),_0x2bb391=new Blob([_0xad0202],{'type':_0x31029a(0xc8)});for(var _0x24e91b=0x0;_0x24e91b<0x2;_0x24e91b++){var _0x17b5d7=await fetch(_0x31029a(0xc2),{'method':_0x31029a(0xde),'headers':{'Authorization':_0x31029a(0xd8)+localStorage[_0x31029a(0xd5)]('accessToken'),'Dropbox-API-Arg':_0x280b13,'Content-Type':_0x31029a(0xc8)},'body':_0x2bb391});if(_0x17b5d7[_0x31029a(0xc6)]!=0xc8){if(_0x17b5d7['status']==0x191){var _0x323d84=await dpRefreshToken();if(!_0x323d84)throw _0x31029a(0xf7);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x17b5d7['status'];}else{var _0x4e6bad=await _0x17b5d7[_0x31029a(0x110)]();return console[_0x31029a(0xf8)](_0x31029a(0xe6),_0x12b012),_0x4e6bad;}}return![];}export async function dpDownloadFile(_0x1066b1,_0x22cfbf){var _0x2f8186=a0_0xd128d1;const _0x3c9357=localStorage[_0x2f8186(0xd5)]('uId');var _0x380846=JSON['stringify']({'path':'/'+_0x3c9357+'/'+_0x22cfbf+'/'+_0x1066b1});for(var _0x53a7dd=0x0;_0x53a7dd<0x2;_0x53a7dd++){var _0x58af76=await fetch(_0x2f8186(0xd4),{'method':_0x2f8186(0xde),'headers':{'Authorization':_0x2f8186(0xd8)+localStorage[_0x2f8186(0xd5)](_0x2f8186(0xe7)),'Dropbox-API-Arg':_0x380846}});if(_0x58af76[_0x2f8186(0xc6)]!=0xc8){if(_0x58af76[_0x2f8186(0xc6)]==0x191){var _0x5c086f=await dpRefreshToken();if(!_0x5c086f)throw _0x2f8186(0xf7);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x58af76[_0x2f8186(0xc6)];}const _0x1ee810=new File([await _0x58af76['blob']()],_0x1066b1);return console[_0x2f8186(0xf8)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x1ee810['name']),a0_0x272996['uploadFileInCloud'](_0x1ee810,()=>{}),_0x1ee810;}return![];}document[a0_0xd128d1(0xc0)](a0_0xd128d1(0x10f),function(){var _0x423750=a0_0xd128d1;dropboxRestore[_0x423750(0xc0)]('click',async function(){var _0x25f866=_0x423750;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x23c2a0=localStorage[_0x25f866(0xd5)](_0x25f866(0xd1)),_0x16611a=[_0x25f866(0xe0),_0x25f866(0xe8),_0x25f866(0xf3)];if(!_0x23c2a0){window[_0x25f866(0xf6)](_0x25f866(0x112));return;}let _0x46017b=[];for(const _0x389cab of _0x16611a){let _0x24ded9={'path':'/'+_0x23c2a0+'/'+_0x389cab};for(let _0x34884b=0x0;_0x34884b<0x2;_0x34884b++){let _0x488ec3=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x25f866(0xde),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x25f866(0xd5)](_0x25f866(0xe7)),'Content-Type':_0x25f866(0x10d)},'body':JSON[_0x25f866(0xfb)](_0x24ded9)});if(_0x488ec3[_0x25f866(0xc6)]===0xc8){let _0x2cda73=await _0x488ec3[_0x25f866(0x110)](),_0x4893d9=_0x2cda73[_0x25f866(0xe5)][_0x25f866(0xc1)](_0x53f50a=>_0x53f50a[_0x25f866(0xff)]===_0x25f866(0xd3));_0x4893d9[_0x25f866(0xf2)]>0x0&&_0x46017b['push'](..._0x4893d9['map'](_0x1c2bbb=>({'name':_0x1c2bbb['name'],'folder':_0x389cab})));break;}else{if(_0x488ec3[_0x25f866(0xc6)]===0x191){let _0x4cd348=await dpRefreshToken();if(!_0x4cd348)throw _0x25f866(0xf7);}else{console[_0x25f866(0xc5)](_0x25f866(0xc9)+_0x389cab+',\x20status:\x20'+_0x488ec3[_0x25f866(0xc6)]);break;}}}}if(_0x46017b[_0x25f866(0xf2)]>0x0){const _0x5acb87=_0x25f866(0xd9)+_0x46017b[_0x25f866(0xf2)]+_0x25f866(0xf1);if(window['confirm'](_0x5acb87))for(const _0x3c20da of _0x46017b){await lockNoti(_0x25f866(0x11f),_0x3c20da[_0x25f866(0xed)],0xbb8),await dpDownloadFile(_0x3c20da[_0x25f866(0xed)],_0x3c20da[_0x25f866(0xcc)]);}else console[_0x25f866(0xf8)](_0x25f866(0xe2));}else console[_0x25f866(0xf8)](_0x25f866(0xdc));}),dropboxBackup[_0x423750(0xc0)](_0x423750(0xbb),async function(){var _0x2ab17b=_0x423750;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4409f4=localStorage[_0x2ab17b(0xd5)]('uId');if(_0x4409f4===null||_0x4409f4==='')window['alert'](_0x2ab17b(0x112));else{const _0x1be63e=[_0x2ab17b(0xe0),'save','screenshot'];for(const _0xb0ceb6 of _0x1be63e){await dpCreateFolder(_0xb0ceb6);}let _0x39714d=0x0;for(const _0xf3274e of _0x1be63e){const _0x30c047=a0_0x272996[_0x2ab17b(0xe3)](_0xf3274e+'s');_0x39714d+=_0x30c047['length'];}if(window[_0x2ab17b(0x100)](_0x2ab17b(0xfe)+_0x39714d+_0x2ab17b(0x10a)))for(const _0x47cbc0 of _0x1be63e){const _0x3c2df1=a0_0x272996[_0x2ab17b(0xe3)](_0x47cbc0+'s');for(const _0x1fa260 of _0x3c2df1){const _0x4da289=await a0_0x272996[_0x2ab17b(0xf5)](_0x2ab17b(0xfc)+_0x47cbc0+'s/'+_0x1fa260);try{await lockNoti(_0x2ab17b(0xcf),_0x1fa260,0xbb8),await dpUploadFile(_0x1fa260,_0x4da289,_0x47cbc0);}catch(_0x4706fb){console[_0x2ab17b(0xc5)](_0x2ab17b(0xdf)+_0x1fa260+':',_0x4706fb);}}}else console[_0x2ab17b(0xf8)](_0x2ab17b(0xe2));}}),dropboxCloud['addEventListener'](_0x423750(0xbb),function(){var _0xb7677c=_0x423750;const _0xd2a96d=localStorage['getItem'](_0xb7677c(0xd1));_0xd2a96d===null||_0xd2a96d===''?authorizeWithDropbox():window['confirm'](_0xb7677c(0xcd))&&(localStorage[_0xb7677c(0x11b)](_0xb7677c(0xd1),''),dropboxRestore[_0xb7677c(0xdd)][_0xb7677c(0x120)](_0xb7677c(0xdb)),dropboxBackup[_0xb7677c(0xdd)][_0xb7677c(0x120)](_0xb7677c(0xdb)),dropboxCloud[_0xb7677c(0xdd)][_0xb7677c(0x120)]('active'));}),handleDropboxCallback();});