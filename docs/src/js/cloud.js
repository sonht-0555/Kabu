var a0_0x4aac60=a0_0x29f0;(function(_0x448c41,_0x3be7c5){var _0x2e3b6f=a0_0x29f0,_0x1643cc=_0x448c41();while(!![]){try{var _0x29b943=-parseInt(_0x2e3b6f(0x133))/0x1*(-parseInt(_0x2e3b6f(0x125))/0x2)+parseInt(_0x2e3b6f(0xfc))/0x3*(parseInt(_0x2e3b6f(0x10c))/0x4)+-parseInt(_0x2e3b6f(0x14a))/0x5*(-parseInt(_0x2e3b6f(0x135))/0x6)+parseInt(_0x2e3b6f(0x115))/0x7+parseInt(_0x2e3b6f(0x13f))/0x8*(-parseInt(_0x2e3b6f(0x128))/0x9)+parseInt(_0x2e3b6f(0x144))/0xa+parseInt(_0x2e3b6f(0x127))/0xb*(-parseInt(_0x2e3b6f(0x134))/0xc);if(_0x29b943===_0x3be7c5)break;else _0x1643cc['push'](_0x1643cc['shift']());}catch(_0x449c7e){_0x1643cc['push'](_0x1643cc['shift']());}}}(a0_0x3a8d,0xbb6f2));import*as a0_0xa4ab8b from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4aac60(0x121),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0xc784c7=a0_0x4aac60,_0x113156=window[_0xc784c7(0x14c)][_0xc784c7(0x141)][_0xc784c7(0x103)]('?')[0x0],_0x5ab024=_0xc784c7(0x137),_0x5bde86=_0xc784c7(0x11f),_0x4b47b6=_0xc784c7(0xf7)+clientId+_0xc784c7(0x156)+_0x5ab024+_0xc784c7(0x11c)+_0x5bde86+_0xc784c7(0x149)+encodeURIComponent(_0x113156);window[_0xc784c7(0x14c)][_0xc784c7(0x141)]=_0x4b47b6;}function handleDropboxCallback(){var _0x3b5230=a0_0x4aac60,_0x20ad78=getUrlParameter(_0x3b5230(0x137));_0x20ad78?(getAccessToken(_0x20ad78),console['log'](_0x3b5230(0x12e),_0x20ad78)):console[_0x3b5230(0xf8)](_0x3b5230(0x113));}function getUrlParameter(_0xec89d8){var _0x5e5f30=a0_0x4aac60;_0xec89d8=_0xec89d8[_0x5e5f30(0x11a)](/[\[]/,'\x5c[')[_0x5e5f30(0x11a)](/[\]]/,'\x5c]');var _0x921a3e=new RegExp(_0x5e5f30(0x122)+_0xec89d8+_0x5e5f30(0xfb)),_0x82c743=_0x921a3e['exec'](location['search']);return _0x82c743===null?'':decodeURIComponent(_0x82c743[0x1][_0x5e5f30(0x11a)](/\+/g,'\x20'));}function a0_0x29f0(_0x5abd3e,_0x2f2e5c){var _0x3a8d5b=a0_0x3a8d();return a0_0x29f0=function(_0x29f0a3,_0x4740d0){_0x29f0a3=_0x29f0a3-0xf5;var _0x427136=_0x3a8d5b[_0x29f0a3];return _0x427136;},a0_0x29f0(_0x5abd3e,_0x2f2e5c);}function getAccessToken(_0x265d53){var _0x41c8a5=a0_0x4aac60,_0x410f99=_0x41c8a5(0x119),_0x4ff12e=window[_0x41c8a5(0x14c)][_0x41c8a5(0x141)][_0x41c8a5(0x103)]('?')[0x0],_0x1fe3a2=new XMLHttpRequest();_0x1fe3a2[_0x41c8a5(0xff)]('POST',_0x41c8a5(0x116)),_0x1fe3a2[_0x41c8a5(0x142)](_0x41c8a5(0x12f),_0x41c8a5(0x12d)),_0x1fe3a2['onload']=function(){var _0x5ae31a=_0x41c8a5;if(_0x1fe3a2[_0x5ae31a(0x132)]===0xc8){var _0x4c4623=JSON['parse'](_0x1fe3a2[_0x5ae31a(0x126)]),_0x1fd9a8=_0x4c4623[_0x5ae31a(0x104)],_0x49cde7=_0x4c4623[_0x5ae31a(0x153)],_0x5e8098=_0x4c4623['uid'];localStorage[_0x5ae31a(0x10f)](_0x5ae31a(0x11b),_0x1fd9a8),localStorage[_0x5ae31a(0x10f)](_0x5ae31a(0x139),_0x49cde7),localStorage[_0x5ae31a(0x10f)](_0x5ae31a(0x108),_0x5e8098);}else console[_0x5ae31a(0xf8)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x1fe3a2[_0x41c8a5(0x15c)](_0x41c8a5(0x159)+_0x265d53+_0x41c8a5(0x150)+_0x410f99+'&client_id='+clientId+_0x41c8a5(0x13c)+clientSecret+_0x41c8a5(0x149)+encodeURIComponent(_0x4ff12e));}export async function dpCreateFolder(_0x1e53f7){var _0xaf944f=a0_0x4aac60;const _0x1b2b7a=localStorage[_0xaf944f(0xf6)](_0xaf944f(0x108));let _0x56d550=localStorage['getItem']('accessToken');const _0x38bb6d='/'+_0x1b2b7a+'/'+_0x1e53f7,_0x4e4bf0=JSON[_0xaf944f(0x10e)]({'path':_0x38bb6d,'autorename':![]});for(let _0x442b32=0x0;_0x442b32<0x2;_0x442b32++){try{const _0x407380=await fetch(_0xaf944f(0x140),{'method':_0xaf944f(0x138),'headers':{'Authorization':'Bearer\x20'+_0x56d550,'Content-Type':_0xaf944f(0x14f)},'body':_0x4e4bf0});if(_0x407380[_0xaf944f(0x132)]===0x191){const _0x46bf4b=await dpRefreshToken();if(!_0x46bf4b)throw new Error(_0xaf944f(0x13d));_0x56d550=localStorage[_0xaf944f(0xf6)](_0xaf944f(0x11b));continue;}if(_0x407380[_0xaf944f(0x132)]===0x199)return{'message':_0xaf944f(0x102),'path':_0x1e53f7};if(!_0x407380['ok'])throw new Error(_0xaf944f(0x147)+_0x1e53f7);const _0xc8b905=await _0x407380[_0xaf944f(0x120)]();return await lockNoti(_0xaf944f(0x151),'',0xbb8),_0xc8b905;}catch(_0x1cd589){if(_0x442b32===0x1)throw _0x1cd589;}}return![];}export async function dpRefreshToken(){var _0x1976f6=a0_0x4aac60;if(!localStorage[_0x1976f6(0xf6)](_0x1976f6(0x139)))throw _0x1976f6(0x106);try{const _0x3b1668=await fetch(_0x1976f6(0xf5),{'method':_0x1976f6(0x138),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x1976f6(0x112)+localStorage[_0x1976f6(0xf6)](_0x1976f6(0x139))+_0x1976f6(0x10a)}),_0x18d736=await _0x3b1668[_0x1976f6(0x120)]();if(!_0x18d736[_0x1976f6(0x15b)])return localStorage[_0x1976f6(0x10f)](_0x1976f6(0x11b),_0x18d736[_0x1976f6(0x104)]),await lockNoti(_0x1976f6(0x157),'',0xbb8),await delay(0x3e8),!![];else alert(_0x18d736[_0x1976f6(0x15a)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x54d901){console[_0x1976f6(0x15b)](_0x1976f6(0x117),_0x54d901);}return![];}export async function dpUploadFile(_0x4becd3,_0x1c488f,_0x3d4f50){var _0x1b3865=a0_0x4aac60;const _0x733585=localStorage[_0x1b3865(0xf6)](_0x1b3865(0x108));var _0x5e18c8=JSON[_0x1b3865(0x10e)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x733585+'/'+_0x3d4f50+'/'+_0x4becd3}),_0x220cee=new Blob([_0x1c488f],{'type':'application/octet-stream'});for(var _0x511acf=0x0;_0x511acf<0x2;_0x511acf++){var _0x272b2a=await fetch(_0x1b3865(0x100),{'method':_0x1b3865(0x138),'headers':{'Authorization':_0x1b3865(0x155)+localStorage[_0x1b3865(0xf6)](_0x1b3865(0x11b)),'Dropbox-API-Arg':_0x5e18c8,'Content-Type':_0x1b3865(0x10d)},'body':_0x220cee});if(_0x272b2a['status']!=0xc8){if(_0x272b2a[_0x1b3865(0x132)]==0x191){var _0x401c7c=await dpRefreshToken();if(!_0x401c7c)throw _0x1b3865(0x13d);continue;}else throw _0x1b3865(0x13a)+_0x272b2a[_0x1b3865(0x132)];}else{var _0x41be8d=await _0x272b2a[_0x1b3865(0x120)]();return console[_0x1b3865(0xf8)](_0x1b3865(0x13b),_0x4becd3),_0x41be8d;}}return![];}export async function dpDownloadFile(_0x5c7eeb,_0x111b58){var _0x4f8da9=a0_0x4aac60;const _0x461703=localStorage['getItem'](_0x4f8da9(0x108));var _0x176f94=JSON[_0x4f8da9(0x10e)]({'path':'/'+_0x461703+'/'+_0x111b58+'/'+_0x5c7eeb});for(var _0x35286a=0x0;_0x35286a<0x2;_0x35286a++){var _0x15a430=await fetch(_0x4f8da9(0x154),{'method':'POST','headers':{'Authorization':_0x4f8da9(0x155)+localStorage[_0x4f8da9(0xf6)]('accessToken'),'Dropbox-API-Arg':_0x176f94}});if(_0x15a430[_0x4f8da9(0x132)]!=0xc8){if(_0x15a430[_0x4f8da9(0x132)]==0x191){var _0x223565=await dpRefreshToken();if(!_0x223565)throw _0x4f8da9(0x13d);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x15a430['status'];}const _0x2dd1d3=new File([await _0x15a430[_0x4f8da9(0x148)]()],_0x5c7eeb);return console[_0x4f8da9(0xf8)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2dd1d3[_0x4f8da9(0x123)]),a0_0xa4ab8b[_0x4f8da9(0x14e)](_0x2dd1d3,()=>{}),_0x2dd1d3;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x45a1bb=a0_0x4aac60;dropboxRestore[_0x45a1bb(0x12c)](_0x45a1bb(0x11d),async function(){var _0x5d7f7e=_0x45a1bb;await lockNoti(_0x5d7f7e(0x124),'',0x1388);const _0x5edd1b=localStorage['getItem'](_0x5d7f7e(0x108)),_0x5c4ff2=[_0x5d7f7e(0xf9),'save',_0x5d7f7e(0x158)];if(!_0x5edd1b){window['alert'](_0x5d7f7e(0x143));return;}let _0x3ffca8=[];for(const _0x50ac0c of _0x5c4ff2){let _0x277591={'path':'/'+_0x5edd1b+'/'+_0x50ac0c};for(let _0x43bbf9=0x0;_0x43bbf9<0x2;_0x43bbf9++){let _0x28df42=await fetch(_0x5d7f7e(0x101),{'method':'POST','headers':{'Authorization':_0x5d7f7e(0x155)+localStorage['getItem'](_0x5d7f7e(0x11b)),'Content-Type':_0x5d7f7e(0x14f)},'body':JSON[_0x5d7f7e(0x10e)](_0x277591)});if(_0x28df42[_0x5d7f7e(0x132)]===0xc8){let _0xb9705c=await _0x28df42[_0x5d7f7e(0x120)](),_0x5887f6=_0xb9705c[_0x5d7f7e(0xfd)][_0x5d7f7e(0x136)](_0x525034=>_0x525034[_0x5d7f7e(0x114)]===_0x5d7f7e(0x105));_0x5887f6['length']>0x0&&_0x3ffca8[_0x5d7f7e(0x109)](..._0x5887f6[_0x5d7f7e(0x11e)](_0x5c9027=>({'name':_0x5c9027['name'],'folder':_0x50ac0c})));break;}else{if(_0x28df42[_0x5d7f7e(0x132)]===0x191){let _0x1c03e3=await dpRefreshToken();if(!_0x1c03e3)throw _0x5d7f7e(0x13d);}else{console[_0x5d7f7e(0x15b)](_0x5d7f7e(0x130)+_0x50ac0c+_0x5d7f7e(0x107)+_0x28df42[_0x5d7f7e(0x132)]);break;}}}}if(_0x3ffca8[_0x5d7f7e(0x146)]>0x0){const _0x290b2d='Do\x20you\x20want\x20to\x20restore\x20'+_0x3ffca8['length']+_0x5d7f7e(0x129);if(window['confirm'](_0x290b2d))for(const _0x2a0b2b of _0x3ffca8){await lockNoti(_0x5d7f7e(0x111),_0x2a0b2b[_0x5d7f7e(0x123)],0xbb8),await dpDownloadFile(_0x2a0b2b['name'],_0x2a0b2b['folder']);}else console[_0x5d7f7e(0xf8)](_0x5d7f7e(0x110));}else console[_0x5d7f7e(0xf8)](_0x5d7f7e(0x12b));}),dropboxBackup[_0x45a1bb(0x12c)](_0x45a1bb(0x11d),async function(){var _0x532d09=_0x45a1bb;await lockNoti(_0x532d09(0x124),'',0x1388);const _0x165e90=localStorage[_0x532d09(0xf6)](_0x532d09(0x108));if(_0x165e90===null||_0x165e90==='')window[_0x532d09(0x145)](_0x532d09(0x143));else{const _0x3c9912=[_0x532d09(0xf9),_0x532d09(0x118),_0x532d09(0x158)];for(const _0x9965d8 of _0x3c9912){await dpCreateFolder(_0x9965d8);}let _0xc2412f=0x0;for(const _0x436bf7 of _0x3c9912){const _0x494f23=a0_0xa4ab8b[_0x532d09(0xfe)](_0x436bf7+'s');_0xc2412f+=_0x494f23['length'];}if(window[_0x532d09(0x131)](_0x532d09(0x10b)+_0xc2412f+_0x532d09(0xfa)))for(const _0x2756f2 of _0x3c9912){const _0x3325e4=a0_0xa4ab8b[_0x532d09(0xfe)](_0x2756f2+'s');for(const _0x365791 of _0x3325e4){const _0x319132=await a0_0xa4ab8b[_0x532d09(0x152)]('/data/'+_0x2756f2+'s/'+_0x365791);try{await lockNoti(_0x532d09(0x13e),_0x365791,0xbb8),await dpUploadFile(_0x365791,_0x319132,_0x2756f2);}catch(_0xa10d7d){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x365791+':',_0xa10d7d);}}}else console[_0x532d09(0xf8)](_0x532d09(0x110));}}),dropboxCloud['addEventListener']('click',function(){var _0x8a3007=_0x45a1bb;const _0x537ad8=localStorage[_0x8a3007(0xf6)](_0x8a3007(0x108));_0x537ad8===null||_0x537ad8===''?authorizeWithDropbox():window[_0x8a3007(0x131)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x8a3007(0x10f)](_0x8a3007(0x108),''),dropboxRestore['classList'][_0x8a3007(0x12a)](_0x8a3007(0x14b)),dropboxBackup[_0x8a3007(0x14d)][_0x8a3007(0x12a)]('active'),dropboxCloud[_0x8a3007(0x14d)][_0x8a3007(0x12a)](_0x8a3007(0x14b)));}),handleDropboxCallback();});function a0_0x3a8d(){var _0x312613=['application/x-www-form-urlencoded','Authorization\x20Code:','Content-Type','Download\x20failed\x20for\x20','confirm','status','99347RhrbQX','1647204CjZfAo','499512ldCiXm','filter','code','POST','refreshToken','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','&client_secret=','Unable\x20to\x20refresh\x20token','Backing\x20up...','2388632POryoB','https://api.dropboxapi.com/2/files/create_folder_v2','href','setRequestHeader','Cloud\x20login\x20required!','13488950JLfihS','alert','length','Error\x20creating\x20folder\x20','blob','&redirect_uri=','30MncBcj','active','location','classList','uploadFileInCloud','application/json','&grant_type=','Folder\x20created','downloadFileInCloud','refresh_token','https://content.dropboxapi.com/2/files/download','Bearer\x20','&response_type=','Refreshing\x20token...','screenshot','code=','error_description','error','send','https://api.dropboxapi.com/oauth2/token','getItem','https://www.dropbox.com/oauth2/authorize?client_id=','log','state','\x20files\x20in\x20Kabu?','=([^&#]*)','149010PhEheb','entries','listFiles','open','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/2/files/list_folder','Folder\x20already\x20exists','split','access_token','file','No\x20refresh\x20token',',\x20status:\x20','uId','push','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Do\x20you\x20want\x20to\x20backup\x20','108RzvbYj','application/octet-stream','stringify','setItem','Restore\x20canceled\x20by\x20user.','Restoring...','refresh_token=','Do\x20not\x20receive\x20authorization','.tag','9095751FelXNT','https://api.dropbox.com/oauth2/token','Error\x20while\x20refreshing\x20token:','save','authorization_code','replace','accessToken','&token_access_type=','click','map','offline','json','knh3uz2mx2hp2eu','[\x5c?&#]','name','Wait\x20a\x20little\x20bit...','14ErdDHa','responseText','330PEKoES','9KtNgNa','\x20files\x20from\x20Cloud?','remove','No\x20files\x20found\x20to\x20restore.','addEventListener'];a0_0x3a8d=function(){return _0x312613;};return a0_0x3a8d();}