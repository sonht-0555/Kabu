var a0_0x2802b4=a0_0x3863;(function(_0x41d32a,_0x2e2ed9){var _0x1640ed=a0_0x3863,_0x19df4c=_0x41d32a();while(!![]){try{var _0x28b7a8=parseInt(_0x1640ed(0x142))/0x1+-parseInt(_0x1640ed(0xfd))/0x2*(-parseInt(_0x1640ed(0x15e))/0x3)+parseInt(_0x1640ed(0x13c))/0x4+parseInt(_0x1640ed(0x131))/0x5+-parseInt(_0x1640ed(0x126))/0x6*(-parseInt(_0x1640ed(0x15a))/0x7)+-parseInt(_0x1640ed(0x15d))/0x8*(parseInt(_0x1640ed(0x123))/0x9)+-parseInt(_0x1640ed(0xfb))/0xa;if(_0x28b7a8===_0x2e2ed9)break;else _0x19df4c['push'](_0x19df4c['shift']());}catch(_0xf46e9e){_0x19df4c['push'](_0x19df4c['shift']());}}}(a0_0x9be4,0x466b3));import*as a0_0x3dceff from'./main.js';function a0_0x9be4(){var _0x1ae030=['parse','Refreshing\x20token...','knh3uz2mx2hp2eu','json','.tag','screenshot','Cloud\x20login\x20required!','accessToken','Download\x20failed\x20for\x20','setItem','Do\x20you\x20want\x20to\x20logout?','Folder\x20created','DOMContentLoaded','POST','No\x20files\x20found\x20to\x20restore.','Error\x20while\x20refreshing\x20token:','filter','uId','Unable\x20to\x20refresh\x20token','click','https://content.dropboxapi.com/2/files/upload','Bearer\x20','entries','9dBEVDy','Restoring...','setRequestHeader','59316FUoErz','file','log','https://api.dropboxapi.com/oauth2/token','&response_type=','https://api.dropbox.com/oauth2/token','offline','Authorization\x20Code:','application/x-www-form-urlencoded','exec','blob','1310685buVSXM','Restore\x20canceled\x20by\x20user.','folder','classList',',\x20status:\x20','split','&client_id=','Do\x20not\x20receive\x20authorization','href','Content-Type','access_token','304312UqjtOR','Wait\x20a\x20little\x20bit...','listFiles','error','Backing\x20up...','Download\x20failed,\x20unknown\x20http\x20status:','361807suVHHF','Error\x20creating\x20folder\x20','alert','remove','refresh_token=','save','responseText','&client_secret=','&redirect_uri=','application/octet-stream','authorization_code','Failed\x20to\x20refresh\x20Dropbox\x20token.','No\x20refresh\x20token','confirm','downloadFileInCloud','addEventListener','status','length','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','=([^&#]*)','\x20files\x20from\x20Cloud?','uid','active','send','245FTuGSS','replace','Kabu\x20storage\x20↦\x20Cloud\x20◆','547064SQKKXs','51tvRBRz','Do\x20you\x20want\x20to\x20backup\x20','refreshToken','overwrite','12581190RAQNoa','getItem','66930Ilibho','&grant_type=','/data/','application/json','Do\x20you\x20want\x20to\x20restore\x20','Failed\x20to\x20upload\x20file\x20','nwb3dnfh09rhs31','location','Cloud\x20↦\x20Kabu\x20storage\x20◆','code=','stringify','state','search','code','name'];a0_0x9be4=function(){return _0x1ae030;};return a0_0x9be4();}import{localStorageFile}from'./storage.js';var clientId=a0_0x2802b4(0x10e),clientSecret=a0_0x2802b4(0x103);function authorizeWithDropbox(){var _0x2ab857=a0_0x2802b4,_0x20f490=window[_0x2ab857(0x104)][_0x2ab857(0x139)][_0x2ab857(0x136)]('?')[0x0],_0x48cce6='code',_0x4f9e66=_0x2ab857(0x12c),_0x13c8ce='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2ab857(0x12a)+_0x48cce6+'&token_access_type='+_0x4f9e66+_0x2ab857(0x14a)+encodeURIComponent(_0x20f490);window[_0x2ab857(0x104)][_0x2ab857(0x139)]=_0x13c8ce;}function handleDropboxCallback(){var _0x45e58f=a0_0x2802b4,_0x1a1509=getUrlParameter(_0x45e58f(0x10a));_0x1a1509?(getAccessToken(_0x1a1509),console[_0x45e58f(0x128)](_0x45e58f(0x12d),_0x1a1509)):console[_0x45e58f(0x128)](_0x45e58f(0x138));}function getUrlParameter(_0x3c6234){var _0x51fee8=a0_0x2802b4;_0x3c6234=_0x3c6234[_0x51fee8(0x15b)](/[\[]/,'\x5c[')[_0x51fee8(0x15b)](/[\]]/,'\x5c]');var _0x123803=new RegExp('[\x5c?&#]'+_0x3c6234+_0x51fee8(0x155)),_0x1cfad9=_0x123803[_0x51fee8(0x12f)](location[_0x51fee8(0x109)]);return _0x1cfad9===null?'':decodeURIComponent(_0x1cfad9[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x35ce31){var _0x1595ea=a0_0x2802b4,_0x495627=_0x1595ea(0x14c),_0x4af643=window[_0x1595ea(0x104)][_0x1595ea(0x139)][_0x1595ea(0x136)]('?')[0x0],_0x4de833=new XMLHttpRequest();_0x4de833['open'](_0x1595ea(0x119),_0x1595ea(0x12b)),_0x4de833[_0x1595ea(0x125)](_0x1595ea(0x13a),'application/x-www-form-urlencoded'),_0x4de833['onload']=function(){var _0x166ebd=_0x1595ea;if(_0x4de833[_0x166ebd(0x152)]===0xc8){var _0x5ef682=JSON[_0x166ebd(0x10c)](_0x4de833[_0x166ebd(0x148)]),_0x5ec5b4=_0x5ef682[_0x166ebd(0x13b)],_0x246e59=_0x5ef682['refresh_token'],_0x5b75c2=_0x5ef682[_0x166ebd(0x157)];localStorage[_0x166ebd(0x115)](_0x166ebd(0x113),_0x5ec5b4),localStorage['setItem'](_0x166ebd(0x160),_0x246e59),localStorage['setItem']('uId',_0x5b75c2);}else console['log'](_0x166ebd(0x154));},_0x4de833[_0x1595ea(0x159)](_0x1595ea(0x106)+_0x35ce31+_0x1595ea(0xfe)+_0x495627+_0x1595ea(0x137)+clientId+_0x1595ea(0x149)+clientSecret+_0x1595ea(0x14a)+encodeURIComponent(_0x4af643));}export async function dpCreateFolder(_0x382731){var _0x3c732c=a0_0x2802b4;const _0x7460d8=localStorage['getItem'](_0x3c732c(0x11d));let _0x230dd0=localStorage[_0x3c732c(0xfc)](_0x3c732c(0x113));const _0x2e85d6='/'+_0x7460d8+'/'+_0x382731,_0x262f9b=JSON[_0x3c732c(0x107)]({'path':_0x2e85d6,'autorename':![]});for(let _0x1f6cd3=0x0;_0x1f6cd3<0x2;_0x1f6cd3++){try{const _0x274311=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x3c732c(0x119),'headers':{'Authorization':_0x3c732c(0x121)+_0x230dd0,'Content-Type':'application/json'},'body':_0x262f9b});if(_0x274311[_0x3c732c(0x152)]===0x191){const _0x3168b5=await dpRefreshToken();if(!_0x3168b5)throw new Error('Unable\x20to\x20refresh\x20token');_0x230dd0=localStorage['getItem'](_0x3c732c(0x113));continue;}if(_0x274311[_0x3c732c(0x152)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x382731};if(!_0x274311['ok'])throw new Error(_0x3c732c(0x143)+_0x382731);const _0x119c9f=await _0x274311[_0x3c732c(0x10f)]();return await lockNoti(_0x3c732c(0x117),'',0xbb8),_0x119c9f;}catch(_0x2079ce){if(_0x1f6cd3===0x1)throw _0x2079ce;}}return![];}export async function dpRefreshToken(){var _0x3f0454=a0_0x2802b4;if(!localStorage['getItem'](_0x3f0454(0x160)))throw _0x3f0454(0x14e);try{const _0xf2bbde=await fetch(_0x3f0454(0x129),{'method':_0x3f0454(0x119),'headers':{'Content-Type':_0x3f0454(0x12e)},'body':_0x3f0454(0x146)+localStorage[_0x3f0454(0xfc)](_0x3f0454(0x160))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0xc062df=await _0xf2bbde[_0x3f0454(0x10f)]();if(!_0xc062df[_0x3f0454(0x13f)])return localStorage['setItem'](_0x3f0454(0x113),_0xc062df[_0x3f0454(0x13b)]),await lockNoti(_0x3f0454(0x10d),'',0xbb8),await delay(0x3e8),!![];else alert(_0xc062df['error_description']||_0x3f0454(0x14d));}catch(_0x1a8b96){console['error'](_0x3f0454(0x11b),_0x1a8b96);}return![];}export async function dpUploadFile(_0x583176,_0x797f8b,_0x4a70a0){var _0x29794c=a0_0x2802b4;const _0x8f408f=localStorage['getItem'](_0x29794c(0x11d));var _0x3db3fe=JSON[_0x29794c(0x107)]({'autorename':!![],'mode':_0x29794c(0xfa),'mute':!![],'strict_conflict':![],'path':'/'+_0x8f408f+'/'+_0x4a70a0+'/'+_0x583176}),_0x539e0f=new Blob([_0x797f8b],{'type':'application/octet-stream'});for(var _0x2b3201=0x0;_0x2b3201<0x2;_0x2b3201++){var _0x426beb=await fetch(_0x29794c(0x120),{'method':_0x29794c(0x119),'headers':{'Authorization':_0x29794c(0x121)+localStorage[_0x29794c(0xfc)](_0x29794c(0x113)),'Dropbox-API-Arg':_0x3db3fe,'Content-Type':_0x29794c(0x14b)},'body':_0x539e0f});if(_0x426beb[_0x29794c(0x152)]!=0xc8){if(_0x426beb[_0x29794c(0x152)]==0x191){var _0x2ef27c=await dpRefreshToken();if(!_0x2ef27c)throw _0x29794c(0x11e);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x426beb['status'];}else{var _0x47df2e=await _0x426beb[_0x29794c(0x10f)]();return console[_0x29794c(0x128)](_0x29794c(0x15c),_0x583176),_0x47df2e;}}return![];}export async function dpDownloadFile(_0x31e61e,_0xf11f44){var _0xcd500f=a0_0x2802b4;const _0x1ba2de=localStorage[_0xcd500f(0xfc)](_0xcd500f(0x11d));var _0x3b50b2=JSON[_0xcd500f(0x107)]({'path':'/'+_0x1ba2de+'/'+_0xf11f44+'/'+_0x31e61e});for(var _0x1927bf=0x0;_0x1927bf<0x2;_0x1927bf++){var _0x26ce7d=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0xcd500f(0x119),'headers':{'Authorization':_0xcd500f(0x121)+localStorage[_0xcd500f(0xfc)](_0xcd500f(0x113)),'Dropbox-API-Arg':_0x3b50b2}});if(_0x26ce7d[_0xcd500f(0x152)]!=0xc8){if(_0x26ce7d['status']==0x191){var _0x4e8d2d=await dpRefreshToken();if(!_0x4e8d2d)throw _0xcd500f(0x11e);continue;}else throw _0xcd500f(0x141)+_0x26ce7d['status'];}const _0x131e48=new File([await _0x26ce7d[_0xcd500f(0x130)]()],_0x31e61e);return console['log'](_0xcd500f(0x105),_0x131e48[_0xcd500f(0x10b)]),a0_0x3dceff['uploadFileInCloud'](_0x131e48,()=>{}),_0x131e48;}return![];}function a0_0x3863(_0x21bd41,_0x564cc3){var _0x9be46f=a0_0x9be4();return a0_0x3863=function(_0x3863aa,_0x379302){_0x3863aa=_0x3863aa-0xfa;var _0x481832=_0x9be46f[_0x3863aa];return _0x481832;},a0_0x3863(_0x21bd41,_0x564cc3);}document[a0_0x2802b4(0x151)](a0_0x2802b4(0x118),function(){var _0xb7e2e5=a0_0x2802b4;dropboxRestore[_0xb7e2e5(0x151)](_0xb7e2e5(0x11f),async function(){var _0xbc7ffc=_0xb7e2e5;await lockNoti(_0xbc7ffc(0x13d),'',0x1388);const _0x1ac055=localStorage[_0xbc7ffc(0xfc)](_0xbc7ffc(0x11d)),_0x45c2d2=['state','save','screenshot'];if(!_0x1ac055){window['alert'](_0xbc7ffc(0x112));return;}let _0x126a96=[];for(const _0x39d6f4 of _0x45c2d2){let _0x128239={'path':'/'+_0x1ac055+'/'+_0x39d6f4};for(let _0x32a4a2=0x0;_0x32a4a2<0x2;_0x32a4a2++){let _0x332012=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0xbc7ffc(0x119),'headers':{'Authorization':'Bearer\x20'+localStorage[_0xbc7ffc(0xfc)]('accessToken'),'Content-Type':_0xbc7ffc(0x100)},'body':JSON['stringify'](_0x128239)});if(_0x332012[_0xbc7ffc(0x152)]===0xc8){let _0xe34b33=await _0x332012['json'](),_0x3a0e6c=_0xe34b33[_0xbc7ffc(0x122)][_0xbc7ffc(0x11c)](_0x3b122c=>_0x3b122c[_0xbc7ffc(0x110)]===_0xbc7ffc(0x127));_0x3a0e6c['length']>0x0&&_0x126a96['push'](..._0x3a0e6c['map'](_0xd0a52c=>({'name':_0xd0a52c[_0xbc7ffc(0x10b)],'folder':_0x39d6f4})));break;}else{if(_0x332012[_0xbc7ffc(0x152)]===0x191){let _0x13fd10=await dpRefreshToken();if(!_0x13fd10)throw _0xbc7ffc(0x11e);}else{console['error'](_0xbc7ffc(0x114)+_0x39d6f4+_0xbc7ffc(0x135)+_0x332012['status']);break;}}}}if(_0x126a96[_0xbc7ffc(0x153)]>0x0){const _0x8ed096=_0xbc7ffc(0x101)+_0x126a96[_0xbc7ffc(0x153)]+_0xbc7ffc(0x156);if(window[_0xbc7ffc(0x14f)](_0x8ed096))for(const _0x5523cc of _0x126a96){await lockNoti(_0xbc7ffc(0x124),_0x5523cc[_0xbc7ffc(0x10b)],0xbb8),await dpDownloadFile(_0x5523cc[_0xbc7ffc(0x10b)],_0x5523cc[_0xbc7ffc(0x133)]);}else console['log'](_0xbc7ffc(0x132));}else console[_0xbc7ffc(0x128)](_0xbc7ffc(0x11a));}),dropboxBackup['addEventListener'](_0xb7e2e5(0x11f),async function(){var _0x26c27a=_0xb7e2e5;await lockNoti(_0x26c27a(0x13d),'',0x1388);const _0x53d829=localStorage['getItem'](_0x26c27a(0x11d));if(_0x53d829===null||_0x53d829==='')window[_0x26c27a(0x144)]('Cloud\x20login\x20required!');else{const _0x588dbe=[_0x26c27a(0x108),_0x26c27a(0x147),_0x26c27a(0x111)];for(const _0x9764d9 of _0x588dbe){await dpCreateFolder(_0x9764d9);}let _0x16adc9=0x0;for(const _0x5bb3eb of _0x588dbe){const _0x10f4e2=a0_0x3dceff[_0x26c27a(0x13e)](_0x5bb3eb+'s');_0x16adc9+=_0x10f4e2[_0x26c27a(0x153)];}if(window['confirm'](_0x26c27a(0x15f)+_0x16adc9+'\x20files\x20in\x20Kabu?'))for(const _0x47a46e of _0x588dbe){const _0x31467b=a0_0x3dceff[_0x26c27a(0x13e)](_0x47a46e+'s');for(const _0xfb51ca of _0x31467b){const _0x224d40=await a0_0x3dceff[_0x26c27a(0x150)](_0x26c27a(0xff)+_0x47a46e+'s/'+_0xfb51ca);try{await lockNoti(_0x26c27a(0x140),_0xfb51ca,0xbb8),await dpUploadFile(_0xfb51ca,_0x224d40,_0x47a46e);}catch(_0x459cb7){console[_0x26c27a(0x13f)](_0x26c27a(0x102)+_0xfb51ca+':',_0x459cb7);}}}else console[_0x26c27a(0x128)](_0x26c27a(0x132));}}),dropboxCloud[_0xb7e2e5(0x151)](_0xb7e2e5(0x11f),function(){var _0x42a7a3=_0xb7e2e5;const _0x9a306e=localStorage[_0x42a7a3(0xfc)](_0x42a7a3(0x11d));_0x9a306e===null||_0x9a306e===''?authorizeWithDropbox():window[_0x42a7a3(0x14f)](_0x42a7a3(0x116))&&(localStorage[_0x42a7a3(0x115)]('uId',''),dropboxRestore[_0x42a7a3(0x134)][_0x42a7a3(0x145)]('active'),dropboxBackup[_0x42a7a3(0x134)][_0x42a7a3(0x145)](_0x42a7a3(0x158)),dropboxCloud[_0x42a7a3(0x134)][_0x42a7a3(0x145)](_0x42a7a3(0x158)));}),handleDropboxCallback();});