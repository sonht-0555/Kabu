function a0_0xe66b(){var _0x1b4259=['map','4775975iaaacg','push','click','getItem','send','https://api.dropboxapi.com/2/files/list_folder','uId','https://content.dropboxapi.com/2/files/upload','26922XkaqLc','refresh_token','&token_access_type=','alert','application/octet-stream','save','confirm','No\x20refresh\x20token','Backing\x20up...','Download\x20failed,\x20unknown\x20http\x20status:','replace','application/x-www-form-urlencoded','&client_id=','error_description','application/json','knh3uz2mx2hp2eu','setItem',',\x20status:\x20','onload','code','6790XGktun','uid','access_token','/data/','Do\x20you\x20want\x20to\x20logout?','\x20files\x20in\x20Kabu?','&response_type=','&redirect_uri=','open','https://content.dropboxapi.com/2/files/download','Error\x20creating\x20folder\x20','refresh_token=','folder','status','Kabu\x20storage\x20↦\x20Cloud\x20◆','Content-Type','10571lBfhiW','Cloud\x20login\x20required!','name','POST','Do\x20not\x20receive\x20authorization','state','listFiles','https://api.dropboxapi.com/2/files/create_folder_v2','12344Rccyzu','Refreshing\x20token...','file','offline','filter','Upload\x20failed,\x20unknown\x20http\x20status:\x20','4626099rRzBvD','remove','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','No\x20files\x20found\x20to\x20restore.','blob','Do\x20you\x20want\x20to\x20backup\x20','&client_secret=','.tag','1345013pUjVvc','json','responseText','7517574TQdsFX','Download\x20failed\x20for\x20','Unable\x20to\x20refresh\x20token','active','6503WuHiSB','location','split','Failed\x20to\x20refresh\x20Dropbox\x20token.','exec','accessToken','4oJcvQe','Restore\x20canceled\x20by\x20user.','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','addEventListener','Wait\x20a\x20little\x20bit...','Authorization\x20Code:','setRequestHeader','classList','stringify','overwrite','entries','[\x5c?&#]','error','Folder\x20already\x20exists','authorization_code','Failed\x20to\x20upload\x20file\x20','search','screenshot','38qHcHeU','refreshToken','code=','log','Restoring...','Bearer\x20','downloadFileInCloud'];a0_0xe66b=function(){return _0x1b4259;};return a0_0xe66b();}function a0_0x1c51(_0x21ef3c,_0x3a28ec){var _0xe66b8c=a0_0xe66b();return a0_0x1c51=function(_0x1c5117,_0x3a13de){_0x1c5117=_0x1c5117-0xd4;var _0x1dfd00=_0xe66b8c[_0x1c5117];return _0x1dfd00;},a0_0x1c51(_0x21ef3c,_0x3a28ec);}var a0_0x5055ff=a0_0x1c51;(function(_0x150844,_0x1dde5e){var _0x25d712=a0_0x1c51,_0x3664c6=_0x150844();while(!![]){try{var _0x358c17=-parseInt(_0x25d712(0xff))/0x1+parseInt(_0x25d712(0x11e))/0x2*(parseInt(_0x25d712(0x12e))/0x3)+-parseInt(_0x25d712(0x10c))/0x4*(-parseInt(_0x25d712(0x126))/0x5)+parseInt(_0x25d712(0x102))/0x6+parseInt(_0x25d712(0x106))/0x7*(-parseInt(_0x25d712(0xf1))/0x8)+parseInt(_0x25d712(0xf7))/0x9+-parseInt(_0x25d712(0xd9))/0xa*(-parseInt(_0x25d712(0xe9))/0xb);if(_0x358c17===_0x1dde5e)break;else _0x3664c6['push'](_0x3664c6['shift']());}catch(_0x2e7cba){_0x3664c6['push'](_0x3664c6['shift']());}}}(a0_0xe66b,0xbb2ec));import*as a0_0x538d06 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5055ff(0xd4),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x2a320e=a0_0x5055ff,_0x25d6bf=window[_0x2a320e(0x107)]['href']['split']('?')[0x0],_0x5569c0=_0x2a320e(0xd8),_0x39e627=_0x2a320e(0xf4),_0x1938f7='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2a320e(0xdf)+_0x5569c0+_0x2a320e(0x130)+_0x39e627+_0x2a320e(0xe0)+encodeURIComponent(_0x25d6bf);window[_0x2a320e(0x107)]['href']=_0x1938f7;}function handleDropboxCallback(){var _0x3a5111=a0_0x5055ff,_0x5c368c=getUrlParameter(_0x3a5111(0xd8));_0x5c368c?(getAccessToken(_0x5c368c),console[_0x3a5111(0x121)](_0x3a5111(0x111),_0x5c368c)):console[_0x3a5111(0x121)](_0x3a5111(0xed));}function getUrlParameter(_0x1ef8ba){var _0xea990b=a0_0x5055ff;_0x1ef8ba=_0x1ef8ba[_0xea990b(0x138)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x328f9b=new RegExp(_0xea990b(0x117)+_0x1ef8ba+'=([^&#]*)'),_0x298e3d=_0x328f9b[_0xea990b(0x10a)](location[_0xea990b(0x11c)]);return _0x298e3d===null?'':decodeURIComponent(_0x298e3d[0x1][_0xea990b(0x138)](/\+/g,'\x20'));}function getAccessToken(_0x4fa7ce){var _0x1ba0d7=a0_0x5055ff,_0x2b36bf=_0x1ba0d7(0x11a),_0x4fa1ba=window['location']['href'][_0x1ba0d7(0x108)]('?')[0x0],_0x40f3f9=new XMLHttpRequest();_0x40f3f9[_0x1ba0d7(0xe1)]('POST','https://api.dropbox.com/oauth2/token'),_0x40f3f9[_0x1ba0d7(0x112)](_0x1ba0d7(0xe8),_0x1ba0d7(0x139)),_0x40f3f9[_0x1ba0d7(0xd7)]=function(){var _0x3dba8f=_0x1ba0d7;if(_0x40f3f9[_0x3dba8f(0xe6)]===0xc8){var _0x22b97c=JSON['parse'](_0x40f3f9[_0x3dba8f(0x101)]),_0x58b6f0=_0x22b97c[_0x3dba8f(0xdb)],_0x31f748=_0x22b97c[_0x3dba8f(0x12f)],_0x500fff=_0x22b97c[_0x3dba8f(0xda)];localStorage[_0x3dba8f(0xd5)](_0x3dba8f(0x10b),_0x58b6f0),localStorage[_0x3dba8f(0xd5)](_0x3dba8f(0x11f),_0x31f748),localStorage[_0x3dba8f(0xd5)](_0x3dba8f(0x12c),_0x500fff);}else console[_0x3dba8f(0x121)](_0x3dba8f(0x10e));},_0x40f3f9[_0x1ba0d7(0x12a)](_0x1ba0d7(0x120)+_0x4fa7ce+'&grant_type='+_0x2b36bf+_0x1ba0d7(0x13a)+clientId+_0x1ba0d7(0xfd)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4fa1ba));}export async function dpCreateFolder(_0x5afc8e){var _0x311362=a0_0x5055ff;const _0x46bc13=localStorage[_0x311362(0x129)](_0x311362(0x12c));let _0xc944c9=localStorage[_0x311362(0x129)](_0x311362(0x10b));const _0xf57384='/'+_0x46bc13+'/'+_0x5afc8e,_0x47a78d=JSON[_0x311362(0x114)]({'path':_0xf57384,'autorename':![]});for(let _0x3895d2=0x0;_0x3895d2<0x2;_0x3895d2++){try{const _0x3b552d=await fetch(_0x311362(0xf0),{'method':'POST','headers':{'Authorization':_0x311362(0x123)+_0xc944c9,'Content-Type':_0x311362(0x13c)},'body':_0x47a78d});if(_0x3b552d[_0x311362(0xe6)]===0x191){const _0x160366=await dpRefreshToken();if(!_0x160366)throw new Error('Unable\x20to\x20refresh\x20token');_0xc944c9=localStorage[_0x311362(0x129)]('accessToken');continue;}if(_0x3b552d['status']===0x199)return{'message':_0x311362(0x119),'path':_0x5afc8e};if(!_0x3b552d['ok'])throw new Error(_0x311362(0xe3)+_0x5afc8e);const _0x1d994f=await _0x3b552d[_0x311362(0x100)]();return await lockNoti('Folder\x20created','',0xbb8),_0x1d994f;}catch(_0x2cc5e3){if(_0x3895d2===0x1)throw _0x2cc5e3;}}return![];}export async function dpRefreshToken(){var _0x357965=a0_0x5055ff;if(!localStorage[_0x357965(0x129)](_0x357965(0x11f)))throw _0x357965(0x135);try{const _0x1a69ba=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x357965(0xec),'headers':{'Content-Type':_0x357965(0x139)},'body':_0x357965(0xe4)+localStorage[_0x357965(0x129)](_0x357965(0x11f))+_0x357965(0xf9)}),_0xa38814=await _0x1a69ba[_0x357965(0x100)]();if(!_0xa38814[_0x357965(0x118)])return localStorage['setItem'](_0x357965(0x10b),_0xa38814['access_token']),await lockNoti(_0x357965(0xf2),'',0xbb8),await delay(0x3e8),!![];else alert(_0xa38814[_0x357965(0x13b)]||_0x357965(0x109));}catch(_0x5c0e8f){console['error']('Error\x20while\x20refreshing\x20token:',_0x5c0e8f);}return![];}export async function dpUploadFile(_0x117271,_0x2e733b,_0x56aaa4){var _0x3f4f0b=a0_0x5055ff;const _0x403185=localStorage[_0x3f4f0b(0x129)](_0x3f4f0b(0x12c));var _0xff3dfd=JSON[_0x3f4f0b(0x114)]({'autorename':!![],'mode':_0x3f4f0b(0x115),'mute':!![],'strict_conflict':![],'path':'/'+_0x403185+'/'+_0x56aaa4+'/'+_0x117271}),_0x4d9bb8=new Blob([_0x2e733b],{'type':_0x3f4f0b(0x132)});for(var _0x444e7e=0x0;_0x444e7e<0x2;_0x444e7e++){var _0x3b2b14=await fetch(_0x3f4f0b(0x12d),{'method':_0x3f4f0b(0xec),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3f4f0b(0x129)]('accessToken'),'Dropbox-API-Arg':_0xff3dfd,'Content-Type':_0x3f4f0b(0x132)},'body':_0x4d9bb8});if(_0x3b2b14[_0x3f4f0b(0xe6)]!=0xc8){if(_0x3b2b14[_0x3f4f0b(0xe6)]==0x191){var _0x461f07=await dpRefreshToken();if(!_0x461f07)throw _0x3f4f0b(0x104);continue;}else throw _0x3f4f0b(0xf6)+_0x3b2b14['status'];}else{var _0x1bda86=await _0x3b2b14[_0x3f4f0b(0x100)]();return console[_0x3f4f0b(0x121)](_0x3f4f0b(0xe7),_0x117271),_0x1bda86;}}return![];}export async function dpDownloadFile(_0x4aa629,_0x154cc1){var _0x594a09=a0_0x5055ff;const _0xcbcbf2=localStorage[_0x594a09(0x129)](_0x594a09(0x12c));var _0x2f836e=JSON[_0x594a09(0x114)]({'path':'/'+_0xcbcbf2+'/'+_0x154cc1+'/'+_0x4aa629});for(var _0x1dd5d9=0x0;_0x1dd5d9<0x2;_0x1dd5d9++){var _0x260493=await fetch(_0x594a09(0xe2),{'method':_0x594a09(0xec),'headers':{'Authorization':_0x594a09(0x123)+localStorage[_0x594a09(0x129)](_0x594a09(0x10b)),'Dropbox-API-Arg':_0x2f836e}});if(_0x260493[_0x594a09(0xe6)]!=0xc8){if(_0x260493[_0x594a09(0xe6)]==0x191){var _0x139191=await dpRefreshToken();if(!_0x139191)throw _0x594a09(0x104);continue;}else throw _0x594a09(0x137)+_0x260493[_0x594a09(0xe6)];}const _0x5a45e3=new File([await _0x260493[_0x594a09(0xfb)]()],_0x4aa629);return console[_0x594a09(0x121)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x5a45e3[_0x594a09(0xeb)]),a0_0x538d06['uploadFileInCloud'](_0x5a45e3,()=>{}),_0x5a45e3;}return![];}document[a0_0x5055ff(0x10f)]('DOMContentLoaded',function(){var _0x5a9405=a0_0x5055ff;dropboxRestore[_0x5a9405(0x10f)](_0x5a9405(0x128),async function(){var _0x2d5b68=_0x5a9405;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x524620=localStorage[_0x2d5b68(0x129)]('uId'),_0x49745e=[_0x2d5b68(0xee),_0x2d5b68(0x133),_0x2d5b68(0x11d)];if(!_0x524620){window[_0x2d5b68(0x131)](_0x2d5b68(0xea));return;}let _0x4fc845=[];for(const _0xa285da of _0x49745e){let _0x2bda5a={'path':'/'+_0x524620+'/'+_0xa285da};for(let _0x418bda=0x0;_0x418bda<0x2;_0x418bda++){let _0x94a87e=await fetch(_0x2d5b68(0x12b),{'method':_0x2d5b68(0xec),'headers':{'Authorization':_0x2d5b68(0x123)+localStorage[_0x2d5b68(0x129)](_0x2d5b68(0x10b)),'Content-Type':'application/json'},'body':JSON['stringify'](_0x2bda5a)});if(_0x94a87e[_0x2d5b68(0xe6)]===0xc8){let _0x44fb2e=await _0x94a87e[_0x2d5b68(0x100)](),_0x5713f5=_0x44fb2e[_0x2d5b68(0x116)][_0x2d5b68(0xf5)](_0x315ee6=>_0x315ee6[_0x2d5b68(0xfe)]===_0x2d5b68(0xf3));_0x5713f5['length']>0x0&&_0x4fc845[_0x2d5b68(0x127)](..._0x5713f5[_0x2d5b68(0x125)](_0x49e7eb=>({'name':_0x49e7eb[_0x2d5b68(0xeb)],'folder':_0xa285da})));break;}else{if(_0x94a87e['status']===0x191){let _0x8cd2ea=await dpRefreshToken();if(!_0x8cd2ea)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x2d5b68(0x118)](_0x2d5b68(0x103)+_0xa285da+_0x2d5b68(0xd6)+_0x94a87e[_0x2d5b68(0xe6)]);break;}}}}if(_0x4fc845['length']>0x0){const _0x421d0d='Do\x20you\x20want\x20to\x20restore\x20'+_0x4fc845['length']+'\x20files\x20from\x20Cloud?';if(window[_0x2d5b68(0x134)](_0x421d0d))for(const _0x3ceea0 of _0x4fc845){await lockNoti(_0x2d5b68(0x122),_0x3ceea0[_0x2d5b68(0xeb)],0xbb8),await dpDownloadFile(_0x3ceea0[_0x2d5b68(0xeb)],_0x3ceea0[_0x2d5b68(0xe5)]);}else console['log'](_0x2d5b68(0x10d));}else console[_0x2d5b68(0x121)](_0x2d5b68(0xfa));}),dropboxBackup[_0x5a9405(0x10f)](_0x5a9405(0x128),async function(){var _0x248b47=_0x5a9405;await lockNoti(_0x248b47(0x110),'',0x1388);const _0x27c8b2=localStorage[_0x248b47(0x129)]('uId');if(_0x27c8b2===null||_0x27c8b2==='')window['alert'](_0x248b47(0xea));else{const _0x32a9be=[_0x248b47(0xee),_0x248b47(0x133),_0x248b47(0x11d)];for(const _0x409c10 of _0x32a9be){await dpCreateFolder(_0x409c10);}let _0x215944=0x0;for(const _0x29648f of _0x32a9be){const _0x2f3cc7=a0_0x538d06['listFiles'](_0x29648f+'s');_0x215944+=_0x2f3cc7['length'];}if(window[_0x248b47(0x134)](_0x248b47(0xfc)+_0x215944+_0x248b47(0xde)))for(const _0xcc0d25 of _0x32a9be){const _0x17606d=a0_0x538d06[_0x248b47(0xef)](_0xcc0d25+'s');for(const _0x2094be of _0x17606d){const _0x5825c7=await a0_0x538d06[_0x248b47(0x124)](_0x248b47(0xdc)+_0xcc0d25+'s/'+_0x2094be);try{await lockNoti(_0x248b47(0x136),_0x2094be,0xbb8),await dpUploadFile(_0x2094be,_0x5825c7,_0xcc0d25);}catch(_0x34ad7e){console[_0x248b47(0x118)](_0x248b47(0x11b)+_0x2094be+':',_0x34ad7e);}}}else console[_0x248b47(0x121)](_0x248b47(0x10d));}}),dropboxCloud[_0x5a9405(0x10f)](_0x5a9405(0x128),function(){var _0x2f2d16=_0x5a9405;const _0x56e11c=localStorage['getItem']('uId');_0x56e11c===null||_0x56e11c===''?authorizeWithDropbox():window['confirm'](_0x2f2d16(0xdd))&&(localStorage[_0x2f2d16(0xd5)](_0x2f2d16(0x12c),''),dropboxRestore[_0x2f2d16(0x113)][_0x2f2d16(0xf8)](_0x2f2d16(0x105)),dropboxBackup[_0x2f2d16(0x113)][_0x2f2d16(0xf8)]('active'),dropboxCloud[_0x2f2d16(0x113)][_0x2f2d16(0xf8)](_0x2f2d16(0x105)));}),handleDropboxCallback();});