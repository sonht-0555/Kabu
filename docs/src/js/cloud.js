var a0_0x26024f=a0_0x2eee;(function(_0x47e062,_0x1fde6a){var _0x53e9a5=a0_0x2eee,_0x42f994=_0x47e062();while(!![]){try{var _0x4edae6=-parseInt(_0x53e9a5(0x194))/0x1+-parseInt(_0x53e9a5(0x1ab))/0x2+parseInt(_0x53e9a5(0x1c1))/0x3+parseInt(_0x53e9a5(0x174))/0x4*(parseInt(_0x53e9a5(0x1a3))/0x5)+-parseInt(_0x53e9a5(0x16b))/0x6+-parseInt(_0x53e9a5(0x1b1))/0x7+parseInt(_0x53e9a5(0x1c6))/0x8;if(_0x4edae6===_0x1fde6a)break;else _0x42f994['push'](_0x42f994['shift']());}catch(_0x38a043){_0x42f994['push'](_0x42f994['shift']());}}}(a0_0x967a,0x187ed));import*as a0_0x530347 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x26024f(0x1c4);function authorizeWithDropbox(){var _0x5a3010=a0_0x26024f,_0x236c3e=window[_0x5a3010(0x18b)][_0x5a3010(0x17a)][_0x5a3010(0x19a)]('?')[0x0],_0x154cfd='code',_0x3309ce='offline',_0x1f006c=_0x5a3010(0x177)+clientId+'&response_type='+_0x154cfd+_0x5a3010(0x16d)+_0x3309ce+_0x5a3010(0x1a9)+encodeURIComponent(_0x236c3e);window[_0x5a3010(0x18b)]['href']=_0x1f006c;}function handleDropboxCallback(){var _0x3acb4b=a0_0x26024f,_0x513b68=getUrlParameter('code');_0x513b68?(getAccessToken(_0x513b68),console['log'](_0x3acb4b(0x172),_0x513b68)):console[_0x3acb4b(0x18d)](_0x3acb4b(0x180));}function a0_0x967a(){var _0x1e03f1=['push','replace','uid','Folder\x20already\x20exists','application/json','location','stringify','log','Content-Type','getItem','\x20files\x20from\x20Cloud?','Do\x20you\x20want\x20to\x20logout?','setItem','Folder\x20created','58767uThNYH','downloadFileInCloud','application/x-www-form-urlencoded','https://api.dropbox.com/oauth2/token','confirm','POST','split','state','Do\x20you\x20want\x20to\x20backup\x20','onload','click','slice','.tag','Refreshing\x20token...','Cloud\x20login\x20required!','434135atqoJj','Failed\x20to\x20refresh\x20Dropbox\x20token.','accessToken','folder','https://api.dropboxapi.com/2/files/list_folder','Wait\x20a\x20little\x20bit...','&redirect_uri=','parse','393366bUbyGp','list','classList','Cloud\x20↦\x20Kabu\x20storage\x20◆','blob','error','781949aWZoUZ','Do\x20you\x20want\x20to\x20restore\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Error\x20creating\x20folder\x20','toUpperCase','alert','Upload\x20failed,\x20unknown\x20http\x20status:\x20','setRequestHeader','save','length','refresh_token','addEventListener','https://api.dropboxapi.com/oauth2/token','screenshot','Download\x20failed\x20for\x20','file','52758BoJoIv','Unable\x20to\x20refresh\x20token','entries','nwb3dnfh09rhs31','open','3619016QqZvaY','Failed\x20to\x20upload\x20file\x20','Bearer\x20','json','=([^&#]*)','error_description','&client_id=',',\x20status:\x20','status','application/octet-stream','active','send','No\x20files\x20found\x20to\x20restore.','535800Huncmp','refreshToken','&token_access_type=','name','refresh_token=','access_token','code=','Authorization\x20Code:','Backing\x20up...','4kDQDyk','Restore\x20canceled\x20by\x20user.','https://api.dropboxapi.com/2/files/create_folder_v2','https://www.dropbox.com/oauth2/authorize?client_id=','uId','Kabu\x20storage\x20↦\x20Cloud\x20◆','href','https://content.dropboxapi.com/2/files/download','overwrite','charAt','https://content.dropboxapi.com/2/files/upload','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20not\x20receive\x20authorization','remove','responseText','uploadFileInCloud','map','[\x5c?&#]'];a0_0x967a=function(){return _0x1e03f1;};return a0_0x967a();}function getUrlParameter(_0xbced7e){var _0x11439c=a0_0x26024f;_0xbced7e=_0xbced7e[_0x11439c(0x187)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x59a2e5=new RegExp(_0x11439c(0x185)+_0xbced7e+_0x11439c(0x1ca)),_0x41e960=_0x59a2e5['exec'](location['search']);return _0x41e960===null?'':decodeURIComponent(_0x41e960[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x1ced98){var _0x33661f=a0_0x26024f,_0xa3d8fc='authorization_code',_0x5b1ba8=window[_0x33661f(0x18b)][_0x33661f(0x17a)][_0x33661f(0x19a)]('?')[0x0],_0xd7cd14=new XMLHttpRequest();_0xd7cd14[_0x33661f(0x1c5)](_0x33661f(0x199),_0x33661f(0x197)),_0xd7cd14[_0x33661f(0x1b8)](_0x33661f(0x18e),_0x33661f(0x196)),_0xd7cd14[_0x33661f(0x19d)]=function(){var _0x45abe8=_0x33661f;if(_0xd7cd14[_0x45abe8(0x1ce)]===0xc8){var _0x9df2ea=JSON[_0x45abe8(0x1aa)](_0xd7cd14[_0x45abe8(0x182)]),_0x52dde1=_0x9df2ea[_0x45abe8(0x170)],_0x3df56a=_0x9df2ea[_0x45abe8(0x1bb)],_0x37163f=_0x9df2ea[_0x45abe8(0x188)];localStorage[_0x45abe8(0x192)](_0x45abe8(0x1a5),_0x52dde1),localStorage[_0x45abe8(0x192)](_0x45abe8(0x16c),_0x3df56a),localStorage['setItem'](_0x45abe8(0x178),_0x37163f);}else console[_0x45abe8(0x18d)](_0x45abe8(0x17f));},_0xd7cd14[_0x33661f(0x169)](_0x33661f(0x171)+_0x1ced98+'&grant_type='+_0xa3d8fc+_0x33661f(0x1cc)+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5b1ba8));}export async function dpCreateFolder(_0x5b6a31){var _0x217c2e=a0_0x26024f;const _0x569a41=localStorage[_0x217c2e(0x18f)](_0x217c2e(0x178));let _0x4e4ee2=localStorage[_0x217c2e(0x18f)](_0x217c2e(0x1a5));const _0x2a5aaf='/'+_0x569a41+'/'+_0x5b6a31,_0x14f1d1=JSON[_0x217c2e(0x18c)]({'path':_0x2a5aaf,'autorename':![]});for(let _0x270b52=0x0;_0x270b52<0x2;_0x270b52++){try{const _0x36c0ca=await fetch(_0x217c2e(0x176),{'method':_0x217c2e(0x199),'headers':{'Authorization':_0x217c2e(0x1c8)+_0x4e4ee2,'Content-Type':_0x217c2e(0x18a)},'body':_0x14f1d1});if(_0x36c0ca['status']===0x191){const _0x676221=await dpRefreshToken();if(!_0x676221)throw new Error(_0x217c2e(0x1c2));_0x4e4ee2=localStorage[_0x217c2e(0x18f)](_0x217c2e(0x1a5));continue;}if(_0x36c0ca['status']===0x199)return{'message':_0x217c2e(0x189),'path':_0x5b6a31};if(!_0x36c0ca['ok'])throw new Error(_0x217c2e(0x1b4)+_0x5b6a31);const _0x630419=await _0x36c0ca[_0x217c2e(0x1c9)]();return await lockNoti(_0x217c2e(0x193),'',0xbb8),_0x630419;}catch(_0x513300){if(_0x270b52===0x1)throw _0x513300;}}return![];}export async function dpRefreshToken(){var _0x3f302a=a0_0x26024f;if(!localStorage[_0x3f302a(0x18f)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x48103e=await fetch(_0x3f302a(0x1bd),{'method':_0x3f302a(0x199),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x3f302a(0x16f)+localStorage[_0x3f302a(0x18f)](_0x3f302a(0x16c))+_0x3f302a(0x1b3)}),_0x115540=await _0x48103e['json']();if(!_0x115540[_0x3f302a(0x1b0)])return localStorage[_0x3f302a(0x192)](_0x3f302a(0x1a5),_0x115540[_0x3f302a(0x170)]),await lockNoti(_0x3f302a(0x1a1),'',0xbb8),await delay(0x3e8),!![];else alert(_0x115540[_0x3f302a(0x1cb)]||_0x3f302a(0x1a4));}catch(_0x48298d){console[_0x3f302a(0x1b0)]('Error\x20while\x20refreshing\x20token:',_0x48298d);}return![];}function a0_0x2eee(_0x2b991d,_0x53b328){var _0x967a0e=a0_0x967a();return a0_0x2eee=function(_0x2eee88,_0x49b29a){_0x2eee88=_0x2eee88-0x169;var _0x60c238=_0x967a0e[_0x2eee88];return _0x60c238;},a0_0x2eee(_0x2b991d,_0x53b328);}export async function dpUploadFile(_0x539711,_0x4c1743,_0x4c870d){var _0x3a7196=a0_0x26024f;const _0x4c05ad=localStorage[_0x3a7196(0x18f)](_0x3a7196(0x178));var _0x3615e4=JSON[_0x3a7196(0x18c)]({'autorename':!![],'mode':_0x3a7196(0x17c),'mute':!![],'strict_conflict':![],'path':'/'+_0x4c05ad+'/'+_0x4c870d+'/'+_0x539711}),_0x57f395=new Blob([_0x4c1743],{'type':_0x3a7196(0x1cf)});for(var _0x2647df=0x0;_0x2647df<0x2;_0x2647df++){var _0x2d8d36=await fetch(_0x3a7196(0x17e),{'method':_0x3a7196(0x199),'headers':{'Authorization':_0x3a7196(0x1c8)+localStorage[_0x3a7196(0x18f)](_0x3a7196(0x1a5)),'Dropbox-API-Arg':_0x3615e4,'Content-Type':_0x3a7196(0x1cf)},'body':_0x57f395});if(_0x2d8d36[_0x3a7196(0x1ce)]!=0xc8){if(_0x2d8d36[_0x3a7196(0x1ce)]==0x191){var _0x326644=await dpRefreshToken();if(!_0x326644)throw _0x3a7196(0x1c2);continue;}else throw _0x3a7196(0x1b7)+_0x2d8d36['status'];}else{var _0x4a96f0=await _0x2d8d36[_0x3a7196(0x1c9)]();return console['log'](_0x3a7196(0x179),_0x539711),_0x4a96f0;}}return![];}export async function dpDownloadFile(_0x455f6e,_0x1f6fae){var _0x5397f0=a0_0x26024f;const _0x114502=localStorage[_0x5397f0(0x18f)](_0x5397f0(0x178));var _0xfdc632=JSON[_0x5397f0(0x18c)]({'path':'/'+_0x114502+'/'+_0x1f6fae+'/'+_0x455f6e});for(var _0x3285b7=0x0;_0x3285b7<0x2;_0x3285b7++){var _0x3b2553=await fetch(_0x5397f0(0x17b),{'method':_0x5397f0(0x199),'headers':{'Authorization':_0x5397f0(0x1c8)+localStorage['getItem'](_0x5397f0(0x1a5)),'Dropbox-API-Arg':_0xfdc632}});if(_0x3b2553[_0x5397f0(0x1ce)]!=0xc8){if(_0x3b2553['status']==0x191){var _0x3cdc1c=await dpRefreshToken();if(!_0x3cdc1c)throw _0x5397f0(0x1c2);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3b2553[_0x5397f0(0x1ce)];}const _0x26044f=new File([await _0x3b2553[_0x5397f0(0x1af)]()],_0x455f6e);return console[_0x5397f0(0x18d)](_0x5397f0(0x1ae),_0x26044f[_0x5397f0(0x16e)]),a0_0x530347[_0x5397f0(0x183)](_0x26044f,()=>{}),_0x26044f;}return![];}document[a0_0x26024f(0x1bc)]('DOMContentLoaded',function(){var _0x4ceb52=a0_0x26024f;dropboxRestore['addEventListener'](_0x4ceb52(0x19e),async function(){var _0x80bc55=_0x4ceb52;await lockNoti(_0x80bc55(0x1a8),'',0x1388);const _0x3829f8=localStorage['getItem']('uId'),_0x272bb5=[_0x80bc55(0x19b),_0x80bc55(0x1b9),_0x80bc55(0x1be)];if(!_0x3829f8){window[_0x80bc55(0x1b6)](_0x80bc55(0x1a2));return;}let _0x59bba0=[];for(const _0x2d4aa8 of _0x272bb5){let _0xb4ded3={'path':'/'+_0x3829f8+'/'+_0x2d4aa8};for(let _0x5bcc7e=0x0;_0x5bcc7e<0x2;_0x5bcc7e++){let _0x2e1b76=await fetch(_0x80bc55(0x1a7),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x80bc55(0x18f)](_0x80bc55(0x1a5)),'Content-Type':_0x80bc55(0x18a)},'body':JSON[_0x80bc55(0x18c)](_0xb4ded3)});if(_0x2e1b76[_0x80bc55(0x1ce)]===0xc8){let _0x3f95b1=await _0x2e1b76[_0x80bc55(0x1c9)](),_0x1946b4=_0x3f95b1[_0x80bc55(0x1c3)]['filter'](_0x2faa12=>_0x2faa12[_0x80bc55(0x1a0)]===_0x80bc55(0x1c0));_0x1946b4['length']>0x0&&_0x59bba0[_0x80bc55(0x186)](..._0x1946b4[_0x80bc55(0x184)](_0x24df99=>({'name':_0x24df99['name'],'folder':_0x2d4aa8})));break;}else{if(_0x2e1b76[_0x80bc55(0x1ce)]===0x191){let _0x23f471=await dpRefreshToken();if(!_0x23f471)throw _0x80bc55(0x1c2);}else{console[_0x80bc55(0x1b0)](_0x80bc55(0x1bf)+_0x2d4aa8+_0x80bc55(0x1cd)+_0x2e1b76[_0x80bc55(0x1ce)]);break;}}}}if(_0x59bba0[_0x80bc55(0x1ba)]>0x0){const _0x166501=_0x80bc55(0x1b2)+_0x59bba0[_0x80bc55(0x1ba)]+_0x80bc55(0x190);if(window[_0x80bc55(0x198)](_0x166501))for(const _0x77e70a of _0x59bba0){await lockNoti('Restoring...',_0x77e70a['name'],0xbb8),await dpDownloadFile(_0x77e70a[_0x80bc55(0x16e)],_0x77e70a[_0x80bc55(0x1a6)]);}else console['log'](_0x80bc55(0x175));}else console['log'](_0x80bc55(0x16a));}),dropboxBackup[_0x4ceb52(0x1bc)](_0x4ceb52(0x19e),async function(){var _0x25fc5a=_0x4ceb52;await lockNoti(_0x25fc5a(0x1a8),'',0x1388);const _0x37b1dd=localStorage[_0x25fc5a(0x18f)]('uId');if(_0x37b1dd===null||_0x37b1dd==='')window['alert'](_0x25fc5a(0x1a2));else{const _0x4c7004=[_0x25fc5a(0x19b),'save',_0x25fc5a(0x1be)];for(const _0x32e64f of _0x4c7004){await dpCreateFolder(_0x32e64f);}let _0x45493f=0x0;for(const _0x6b58d2 of _0x4c7004){const _0x44c78d=a0_0x530347[_0x25fc5a(0x1ac)+(_0x6b58d2[_0x25fc5a(0x17d)](0x0)[_0x25fc5a(0x1b5)]()+_0x6b58d2[_0x25fc5a(0x19f)](0x1))]();_0x45493f+=_0x44c78d[_0x25fc5a(0x1ba)];}if(window[_0x25fc5a(0x198)](_0x25fc5a(0x19c)+_0x45493f+'\x20files\x20in\x20Kabu?'))for(const _0x2c5140 of _0x4c7004){const _0x30615d=a0_0x530347['list'+(_0x2c5140[_0x25fc5a(0x17d)](0x0)['toUpperCase']()+_0x2c5140[_0x25fc5a(0x19f)](0x1))]();for(const _0x2b11ba of _0x30615d){const _0x2822eb=await a0_0x530347[_0x25fc5a(0x195)]('/data/'+_0x2c5140+'s/'+_0x2b11ba);try{await lockNoti(_0x25fc5a(0x173),_0x2b11ba,0xbb8),await dpUploadFile(_0x2b11ba,_0x2822eb,_0x2c5140);}catch(_0x2a2305){console['error'](_0x25fc5a(0x1c7)+_0x2b11ba+':',_0x2a2305);}}}else console[_0x25fc5a(0x18d)](_0x25fc5a(0x175));}}),dropboxCloud[_0x4ceb52(0x1bc)](_0x4ceb52(0x19e),function(){var _0x30df63=_0x4ceb52;const _0x286245=localStorage[_0x30df63(0x18f)]('uId');_0x286245===null||_0x286245===''?authorizeWithDropbox():window[_0x30df63(0x198)](_0x30df63(0x191))&&(localStorage[_0x30df63(0x192)](_0x30df63(0x178),''),dropboxRestore[_0x30df63(0x1ad)][_0x30df63(0x181)](_0x30df63(0x1d0)),dropboxBackup[_0x30df63(0x1ad)][_0x30df63(0x181)](_0x30df63(0x1d0)),dropboxCloud[_0x30df63(0x1ad)][_0x30df63(0x181)](_0x30df63(0x1d0)));}),handleDropboxCallback();});