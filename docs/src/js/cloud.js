var a0_0x79b837=a0_0x1b3f;function a0_0x78b7(){var _0x267b40=['Do\x20you\x20want\x20to\x20backup\x20','1197669mMLNbo','log','access_token','error','responseText','application/x-www-form-urlencoded','uploadFileInCloud','confirm','code=','json','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','setRequestHeader','Failed\x20to\x20upload\x20file\x20','code','Download\x20failed,\x20unknown\x20http\x20status:','setItem','listFiles','state','offline','Folder\x20created','Authorization\x20Code:','Cloud\x20login\x20required!','Restore\x20canceled\x20by\x20user.','&redirect_uri=','[\x5c?&#]','folder','Bearer\x20','authorization_code','Error\x20while\x20refreshing\x20token:','classList','428024eipOyH',',\x20status:\x20','\x20files\x20in\x20Kabu?','18758gzlrNw','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Folder\x20already\x20exists','Error\x20creating\x20folder\x20','Content-Type','screenshot','remove','alert','No\x20refresh\x20token','href','stringify','uId','10freULX','&token_access_type=','4895847LAJLIL','https://api.dropboxapi.com/2/files/list_folder','https://api.dropbox.com/oauth2/token','uid','&response_type=','Do\x20you\x20want\x20to\x20restore\x20','POST','Wait\x20a\x20little\x20bit...','name','refresh_token=','getItem','10DSysnj','964QpaiSo','1750818DIixCO','/data/','knh3uz2mx2hp2eu','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://content.dropboxapi.com/2/files/upload','status','9755UdppdX','application/octet-stream','addEventListener','Unable\x20to\x20refresh\x20token','application/json','save','&client_secret=','map','7ejDxEN','\x20files\x20from\x20Cloud?','search','Restoring...','open','https://api.dropboxapi.com/2/files/create_folder_v2','Failed\x20to\x20refresh\x20Dropbox\x20token.','replace','&client_id=','onload','https://www.dropbox.com/oauth2/authorize?client_id=','Download\x20failed\x20for\x20','click','Do\x20not\x20receive\x20authorization','Backing\x20up...','location','36QfRbec','downloadFileInCloud','refresh_token','length','entries','https://content.dropboxapi.com/2/files/download','Upload\x20failed,\x20unknown\x20http\x20status:\x20','accessToken','filter','755514RIdkXW','active','refreshToken','Do\x20you\x20want\x20to\x20logout?','overwrite','No\x20files\x20found\x20to\x20restore.','send'];a0_0x78b7=function(){return _0x267b40;};return a0_0x78b7();}(function(_0x3e2b9,_0x4aa80c){var _0x3eaef1=a0_0x1b3f,_0x40f6a6=_0x3e2b9();while(!![]){try{var _0x11ea8d=parseInt(_0x3eaef1(0x176))/0x1*(parseInt(_0x3eaef1(0x16a))/0x2)+-parseInt(_0x3eaef1(0x140))/0x3+parseInt(_0x3eaef1(0x118))/0x4*(parseInt(_0x3eaef1(0x11f))/0x5)+-parseInt(_0x3eaef1(0x119))/0x6+-parseInt(_0x3eaef1(0x127))/0x7*(-parseInt(_0x3eaef1(0x167))/0x8)+parseInt(_0x3eaef1(0x178))/0x9*(parseInt(_0x3eaef1(0x117))/0xa)+-parseInt(_0x3eaef1(0x148))/0xb*(parseInt(_0x3eaef1(0x137))/0xc);if(_0x11ea8d===_0x4aa80c)break;else _0x40f6a6['push'](_0x40f6a6['shift']());}catch(_0x4822f6){_0x40f6a6['push'](_0x40f6a6['shift']());}}}(a0_0x78b7,0x47175));import*as a0_0x2f3142 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x79b837(0x11b),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x60201f=a0_0x79b837,_0x4ed019=window[_0x60201f(0x136)]['href']['split']('?')[0x0],_0x2bea95=_0x60201f(0x156),_0x2452ff=_0x60201f(0x15b),_0x4d090c=_0x60201f(0x131)+clientId+_0x60201f(0x17c)+_0x2bea95+_0x60201f(0x177)+_0x2452ff+'&redirect_uri='+encodeURIComponent(_0x4ed019);window['location'][_0x60201f(0x173)]=_0x4d090c;}function handleDropboxCallback(){var _0x460c1e=a0_0x79b837,_0x5ce6c8=getUrlParameter('code');_0x5ce6c8?(getAccessToken(_0x5ce6c8),console[_0x460c1e(0x149)](_0x460c1e(0x15d),_0x5ce6c8)):console['log'](_0x460c1e(0x134));}function getUrlParameter(_0x27811c){var _0x5c195f=a0_0x79b837;_0x27811c=_0x27811c['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x4cace7=new RegExp(_0x5c195f(0x161)+_0x27811c+'=([^&#]*)'),_0x43b906=_0x4cace7['exec'](location[_0x5c195f(0x129)]);return _0x43b906===null?'':decodeURIComponent(_0x43b906[0x1][_0x5c195f(0x12e)](/\+/g,'\x20'));}function getAccessToken(_0x6d97b7){var _0x199d30=a0_0x79b837,_0xd31936=_0x199d30(0x164),_0x37e36e=window[_0x199d30(0x136)][_0x199d30(0x173)]['split']('?')[0x0],_0x17e591=new XMLHttpRequest();_0x17e591[_0x199d30(0x12b)](_0x199d30(0x112),_0x199d30(0x17a)),_0x17e591[_0x199d30(0x154)](_0x199d30(0x16e),_0x199d30(0x14d)),_0x17e591[_0x199d30(0x130)]=function(){var _0x859734=_0x199d30;if(_0x17e591['status']===0xc8){var _0x351573=JSON['parse'](_0x17e591[_0x859734(0x14c)]),_0x48237f=_0x351573[_0x859734(0x14a)],_0x2d91b4=_0x351573[_0x859734(0x139)],_0x9580a7=_0x351573[_0x859734(0x17b)];localStorage['setItem'](_0x859734(0x13e),_0x48237f),localStorage[_0x859734(0x158)](_0x859734(0x142),_0x2d91b4),localStorage[_0x859734(0x158)]('uId',_0x9580a7);}else console[_0x859734(0x149)](_0x859734(0x16b));},_0x17e591[_0x199d30(0x146)](_0x199d30(0x150)+_0x6d97b7+'&grant_type='+_0xd31936+_0x199d30(0x12f)+clientId+_0x199d30(0x125)+clientSecret+_0x199d30(0x160)+encodeURIComponent(_0x37e36e));}export async function dpCreateFolder(_0x51a63c){var _0x516f8d=a0_0x79b837;const _0x355ec0=localStorage[_0x516f8d(0x116)](_0x516f8d(0x175));let _0x156494=localStorage[_0x516f8d(0x116)]('accessToken');const _0x3aa79e='/'+_0x355ec0+'/'+_0x51a63c,_0x17489e=JSON['stringify']({'path':_0x3aa79e,'autorename':![]});for(let _0x42d9b4=0x0;_0x42d9b4<0x2;_0x42d9b4++){try{const _0x165b4b=await fetch(_0x516f8d(0x12c),{'method':_0x516f8d(0x112),'headers':{'Authorization':_0x516f8d(0x163)+_0x156494,'Content-Type':_0x516f8d(0x123)},'body':_0x17489e});if(_0x165b4b['status']===0x191){const _0x2a0ca1=await dpRefreshToken();if(!_0x2a0ca1)throw new Error(_0x516f8d(0x122));_0x156494=localStorage['getItem'](_0x516f8d(0x13e));continue;}if(_0x165b4b[_0x516f8d(0x11e)]===0x199)return{'message':_0x516f8d(0x16c),'path':_0x51a63c};if(!_0x165b4b['ok'])throw new Error(_0x516f8d(0x16d)+_0x51a63c);const _0x41e600=await _0x165b4b[_0x516f8d(0x151)]();return await lockNoti(_0x516f8d(0x15c),'',0xbb8),_0x41e600;}catch(_0x25e8cd){if(_0x42d9b4===0x1)throw _0x25e8cd;}}return![];}export async function dpRefreshToken(){var _0x44119f=a0_0x79b837;if(!localStorage[_0x44119f(0x116)](_0x44119f(0x142)))throw _0x44119f(0x172);try{const _0x2df98b=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x44119f(0x112),'headers':{'Content-Type':_0x44119f(0x14d)},'body':_0x44119f(0x115)+localStorage[_0x44119f(0x116)]('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0xf3f8e=await _0x2df98b['json']();if(!_0xf3f8e[_0x44119f(0x14b)])return localStorage[_0x44119f(0x158)](_0x44119f(0x13e),_0xf3f8e[_0x44119f(0x14a)]),await lockNoti(_0x44119f(0x152),'',0xbb8),await delay(0x3e8),!![];else alert(_0xf3f8e['error_description']||_0x44119f(0x12d));}catch(_0x5c40a1){console[_0x44119f(0x14b)](_0x44119f(0x165),_0x5c40a1);}return![];}export async function dpUploadFile(_0x3c715e,_0x37456a,_0x10370e){var _0x2442d7=a0_0x79b837;const _0x2f1ef1=localStorage[_0x2442d7(0x116)]('uId');var _0x4c4814=JSON['stringify']({'autorename':!![],'mode':_0x2442d7(0x144),'mute':!![],'strict_conflict':![],'path':'/'+_0x2f1ef1+'/'+_0x10370e+'/'+_0x3c715e}),_0x329a45=new Blob([_0x37456a],{'type':_0x2442d7(0x120)});for(var _0x2d70bf=0x0;_0x2d70bf<0x2;_0x2d70bf++){var _0x3c7553=await fetch(_0x2442d7(0x11d),{'method':_0x2442d7(0x112),'headers':{'Authorization':_0x2442d7(0x163)+localStorage['getItem'](_0x2442d7(0x13e)),'Dropbox-API-Arg':_0x4c4814,'Content-Type':_0x2442d7(0x120)},'body':_0x329a45});if(_0x3c7553[_0x2442d7(0x11e)]!=0xc8){if(_0x3c7553[_0x2442d7(0x11e)]==0x191){var _0x1c435b=await dpRefreshToken();if(!_0x1c435b)throw _0x2442d7(0x122);continue;}else throw _0x2442d7(0x13d)+_0x3c7553[_0x2442d7(0x11e)];}else{var _0x5b9267=await _0x3c7553[_0x2442d7(0x151)]();return console[_0x2442d7(0x149)](_0x2442d7(0x11c),_0x3c715e),_0x5b9267;}}return![];}export async function dpDownloadFile(_0x887c4d,_0x350291){var _0x1fa354=a0_0x79b837;const _0x4342bd=localStorage[_0x1fa354(0x116)](_0x1fa354(0x175));var _0x42fe92=JSON[_0x1fa354(0x174)]({'path':'/'+_0x4342bd+'/'+_0x350291+'/'+_0x887c4d});for(var _0x2884c3=0x0;_0x2884c3<0x2;_0x2884c3++){var _0x3aa69e=await fetch(_0x1fa354(0x13c),{'method':_0x1fa354(0x112),'headers':{'Authorization':_0x1fa354(0x163)+localStorage[_0x1fa354(0x116)](_0x1fa354(0x13e)),'Dropbox-API-Arg':_0x42fe92}});if(_0x3aa69e[_0x1fa354(0x11e)]!=0xc8){if(_0x3aa69e[_0x1fa354(0x11e)]==0x191){var _0x153bcc=await dpRefreshToken();if(!_0x153bcc)throw _0x1fa354(0x122);continue;}else throw _0x1fa354(0x157)+_0x3aa69e[_0x1fa354(0x11e)];}const _0x245f3d=new File([await _0x3aa69e['blob']()],_0x887c4d);return console[_0x1fa354(0x149)](_0x1fa354(0x153),_0x245f3d['name']),a0_0x2f3142[_0x1fa354(0x14e)](_0x245f3d,()=>{}),_0x245f3d;}return![];}function a0_0x1b3f(_0x3927da,_0x44b279){var _0x78b7a5=a0_0x78b7();return a0_0x1b3f=function(_0x1b3f2a,_0x3fd9e9){_0x1b3f2a=_0x1b3f2a-0x111;var _0x3e93c2=_0x78b7a5[_0x1b3f2a];return _0x3e93c2;},a0_0x1b3f(_0x3927da,_0x44b279);}document['addEventListener']('DOMContentLoaded',function(){var _0x4f46d1=a0_0x79b837;dropboxRestore[_0x4f46d1(0x121)]('click',async function(){var _0x52e111=_0x4f46d1;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x40f108=localStorage['getItem'](_0x52e111(0x175)),_0x40175e=[_0x52e111(0x15a),_0x52e111(0x124),'screenshot'];if(!_0x40f108){window[_0x52e111(0x171)]('Cloud\x20login\x20required!');return;}let _0x25b98a=[];for(const _0x1c9fd0 of _0x40175e){let _0x40ef92={'path':'/'+_0x40f108+'/'+_0x1c9fd0};for(let _0x5f5057=0x0;_0x5f5057<0x2;_0x5f5057++){let _0x10fa08=await fetch(_0x52e111(0x179),{'method':_0x52e111(0x112),'headers':{'Authorization':_0x52e111(0x163)+localStorage[_0x52e111(0x116)](_0x52e111(0x13e)),'Content-Type':_0x52e111(0x123)},'body':JSON[_0x52e111(0x174)](_0x40ef92)});if(_0x10fa08['status']===0xc8){let _0x1f66a3=await _0x10fa08['json'](),_0x242487=_0x1f66a3[_0x52e111(0x13b)][_0x52e111(0x13f)](_0x1c1186=>_0x1c1186['.tag']==='file');_0x242487[_0x52e111(0x13a)]>0x0&&_0x25b98a['push'](..._0x242487[_0x52e111(0x126)](_0x83532d=>({'name':_0x83532d['name'],'folder':_0x1c9fd0})));break;}else{if(_0x10fa08['status']===0x191){let _0x29ceaa=await dpRefreshToken();if(!_0x29ceaa)throw _0x52e111(0x122);}else{console[_0x52e111(0x14b)](_0x52e111(0x132)+_0x1c9fd0+_0x52e111(0x168)+_0x10fa08[_0x52e111(0x11e)]);break;}}}}if(_0x25b98a['length']>0x0){const _0x4bb44e=_0x52e111(0x111)+_0x25b98a[_0x52e111(0x13a)]+_0x52e111(0x128);if(window['confirm'](_0x4bb44e))for(const _0x19febd of _0x25b98a){await lockNoti(_0x52e111(0x12a),_0x19febd['name'],0xbb8),await dpDownloadFile(_0x19febd[_0x52e111(0x114)],_0x19febd[_0x52e111(0x162)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x52e111(0x149)](_0x52e111(0x145));}),dropboxBackup[_0x4f46d1(0x121)](_0x4f46d1(0x133),async function(){var _0x4734ec=_0x4f46d1;await lockNoti(_0x4734ec(0x113),'',0x1388);const _0x5bf033=localStorage['getItem'](_0x4734ec(0x175));if(_0x5bf033===null||_0x5bf033==='')window[_0x4734ec(0x171)](_0x4734ec(0x15e));else{const _0x34784f=['state',_0x4734ec(0x124),_0x4734ec(0x16f)];for(const _0x124bde of _0x34784f){await dpCreateFolder(_0x124bde);}let _0x2e8540=0x0;for(const _0x57348d of _0x34784f){const _0x356e45=a0_0x2f3142[_0x4734ec(0x159)](_0x57348d+'s');_0x2e8540+=_0x356e45[_0x4734ec(0x13a)];}if(window[_0x4734ec(0x14f)](_0x4734ec(0x147)+_0x2e8540+_0x4734ec(0x169)))for(const _0x99edde of _0x34784f){const _0x27268a=a0_0x2f3142['listFiles'](_0x99edde+'s');for(const _0x2ab0a2 of _0x27268a){const _0x5196f2=await a0_0x2f3142[_0x4734ec(0x138)](_0x4734ec(0x11a)+_0x99edde+'s/'+_0x2ab0a2);try{await lockNoti(_0x4734ec(0x135),_0x2ab0a2,0xbb8),await dpUploadFile(_0x2ab0a2,_0x5196f2,_0x99edde);}catch(_0x5c4253){console[_0x4734ec(0x14b)](_0x4734ec(0x155)+_0x2ab0a2+':',_0x5c4253);}}}else console[_0x4734ec(0x149)](_0x4734ec(0x15f));}}),dropboxCloud[_0x4f46d1(0x121)](_0x4f46d1(0x133),function(){var _0x434a34=_0x4f46d1;const _0x1d23d2=localStorage['getItem'](_0x434a34(0x175));_0x1d23d2===null||_0x1d23d2===''?authorizeWithDropbox():window[_0x434a34(0x14f)](_0x434a34(0x143))&&(localStorage['setItem'](_0x434a34(0x175),''),dropboxRestore[_0x434a34(0x166)]['remove'](_0x434a34(0x141)),dropboxBackup[_0x434a34(0x166)][_0x434a34(0x170)](_0x434a34(0x141)),dropboxCloud[_0x434a34(0x166)][_0x434a34(0x170)](_0x434a34(0x141)));}),handleDropboxCallback();});