var a0_0x48a06b=a0_0x2efd;(function(_0x5d1d36,_0xdc4b8b){var _0x20b072=a0_0x2efd,_0x4993f4=_0x5d1d36();while(!![]){try{var _0x2241ad=parseInt(_0x20b072(0x1fd))/0x1*(-parseInt(_0x20b072(0x20c))/0x2)+parseInt(_0x20b072(0x245))/0x3*(parseInt(_0x20b072(0x211))/0x4)+-parseInt(_0x20b072(0x244))/0x5*(parseInt(_0x20b072(0x24e))/0x6)+parseInt(_0x20b072(0x243))/0x7+-parseInt(_0x20b072(0x228))/0x8*(parseInt(_0x20b072(0x23f))/0x9)+-parseInt(_0x20b072(0x217))/0xa*(-parseInt(_0x20b072(0x255))/0xb)+-parseInt(_0x20b072(0x1f9))/0xc*(-parseInt(_0x20b072(0x223))/0xd);if(_0x2241ad===_0xdc4b8b)break;else _0x4993f4['push'](_0x4993f4['shift']());}catch(_0x36c07e){_0x4993f4['push'](_0x4993f4['shift']());}}}(a0_0x2111,0x3a6bb));import*as a0_0xab52fc from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x48a06b(0x24b),clientSecret=a0_0x48a06b(0x1f2);function authorizeWithDropbox(){var _0x128492=a0_0x48a06b,_0x21afa6=window[_0x128492(0x1fe)][_0x128492(0x253)][_0x128492(0x202)]('?')[0x0],_0x33a13a=_0x128492(0x24a),_0x1b9460=_0x128492(0x212),_0x3f1919=_0x128492(0x20b)+clientId+_0x128492(0x230)+_0x33a13a+'&token_access_type='+_0x1b9460+_0x128492(0x248)+encodeURIComponent(_0x21afa6);window['location'][_0x128492(0x253)]=_0x3f1919;}function a0_0x2111(){var _0x5a96c6=['refreshToken','click','\x20files\x20in\x20Kabu?','split','Do\x20you\x20want\x20to\x20restore\x20','Download\x20failed\x20for\x20','responseText','map','addEventListener','Backing\x20up...','active','error_description','https://www.dropbox.com/oauth2/authorize?client_id=','2GZWOwI','classList','exec','https://content.dropboxapi.com/2/files/download','onload','630696kvfPSC','offline','application/x-www-form-urlencoded','screenshot','Download\x20failed,\x20unknown\x20http\x20status:','Folder\x20created','513270kINiPC','Failed\x20to\x20upload\x20file\x20','Do\x20not\x20receive\x20authorization',',\x20status:\x20','stringify','remove','file','Cloud\x20login\x20required!','overwrite','Do\x20you\x20want\x20to\x20backup\x20','https://content.dropboxapi.com/2/files/upload','length','104BheJpy','uploadFileInCloud','name','/data/','Restore\x20canceled\x20by\x20user.','176DpINbI','Do\x20you\x20want\x20to\x20logout?','blob','application/json','accessToken','&grant_type=','Restoring...','No\x20files\x20found\x20to\x20restore.','&response_type=','filter','refresh_token=','No\x20refresh\x20token','.tag','Folder\x20already\x20exists','uid','send','uId','json','folder','Unable\x20to\x20refresh\x20token','state','listFiles','=([^&#]*)','104589oENmhC','POST','Upload\x20failed,\x20unknown\x20http\x20status:\x20','alert','611345rWlmlU','4520FwrTPB','9GcbmmI','[\x5c?&#]','\x20files\x20from\x20Cloud?','&redirect_uri=','setItem','code','knh3uz2mx2hp2eu','confirm','log','2946dtwWLM','DOMContentLoaded','entries','Bearer\x20','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','href','application/octet-stream','11JWhWog','https://api.dropboxapi.com/2/files/list_folder','getItem','Cloud\x20↦\x20Kabu\x20storage\x20◆','status','nwb3dnfh09rhs31','setRequestHeader','replace','error','push','authorization_code','&client_id=','711588uWNlnv','Content-Type','https://api.dropbox.com/oauth2/token','Wait\x20a\x20little\x20bit...','147259FnPBRn','location'];a0_0x2111=function(){return _0x5a96c6;};return a0_0x2111();}function handleDropboxCallback(){var _0x1b2557=a0_0x48a06b,_0x1c086a=getUrlParameter(_0x1b2557(0x24a));_0x1c086a?(getAccessToken(_0x1c086a),console[_0x1b2557(0x24d)]('Authorization\x20Code:',_0x1c086a)):console[_0x1b2557(0x24d)](_0x1b2557(0x219));}function getUrlParameter(_0x3d70ec){var _0x49fd47=a0_0x48a06b;_0x3d70ec=_0x3d70ec[_0x49fd47(0x1f4)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x494bc2=new RegExp(_0x49fd47(0x246)+_0x3d70ec+_0x49fd47(0x23e)),_0x5a229f=_0x494bc2[_0x49fd47(0x20e)](location['search']);return _0x5a229f===null?'':decodeURIComponent(_0x5a229f[0x1]['replace'](/\+/g,'\x20'));}function a0_0x2efd(_0x266af5,_0x198859){var _0x211100=a0_0x2111();return a0_0x2efd=function(_0x2efd4a,_0x1f9e27){_0x2efd4a=_0x2efd4a-0x1ee;var _0x42f841=_0x211100[_0x2efd4a];return _0x42f841;},a0_0x2efd(_0x266af5,_0x198859);}function getAccessToken(_0x5af6dd){var _0x68340c=a0_0x48a06b,_0xb848cb=_0x68340c(0x1f7),_0x461dc7=window[_0x68340c(0x1fe)][_0x68340c(0x253)][_0x68340c(0x202)]('?')[0x0],_0x39f58c=new XMLHttpRequest();_0x39f58c['open'](_0x68340c(0x240),_0x68340c(0x1fb)),_0x39f58c[_0x68340c(0x1f3)](_0x68340c(0x1fa),_0x68340c(0x213)),_0x39f58c[_0x68340c(0x210)]=function(){var _0x380bce=_0x68340c;if(_0x39f58c[_0x380bce(0x1f1)]===0xc8){var _0x66da30=JSON['parse'](_0x39f58c[_0x380bce(0x205)]),_0x413556=_0x66da30['access_token'],_0x4a84be=_0x66da30['refresh_token'],_0x37c181=_0x66da30[_0x380bce(0x236)];localStorage['setItem'](_0x380bce(0x22c),_0x413556),localStorage['setItem'](_0x380bce(0x1ff),_0x4a84be),localStorage[_0x380bce(0x249)](_0x380bce(0x238),_0x37c181);}else console[_0x380bce(0x24d)](_0x380bce(0x252));},_0x39f58c[_0x68340c(0x237)]('code='+_0x5af6dd+_0x68340c(0x22d)+_0xb848cb+_0x68340c(0x1f8)+clientId+'&client_secret='+clientSecret+_0x68340c(0x248)+encodeURIComponent(_0x461dc7));}export async function dpCreateFolder(_0x518804){var _0x2b75e7=a0_0x48a06b;const _0x3c876b=localStorage[_0x2b75e7(0x1ef)](_0x2b75e7(0x238));let _0x569e4f=localStorage['getItem']('accessToken');const _0x127c33='/'+_0x3c876b+'/'+_0x518804,_0x211962=JSON[_0x2b75e7(0x21b)]({'path':_0x127c33,'autorename':![]});for(let _0x62a5b2=0x0;_0x62a5b2<0x2;_0x62a5b2++){try{const _0x31f3a6=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x2b75e7(0x240),'headers':{'Authorization':_0x2b75e7(0x251)+_0x569e4f,'Content-Type':_0x2b75e7(0x22b)},'body':_0x211962});if(_0x31f3a6['status']===0x191){const _0x26a116=await dpRefreshToken();if(!_0x26a116)throw new Error('Unable\x20to\x20refresh\x20token');_0x569e4f=localStorage['getItem'](_0x2b75e7(0x22c));continue;}if(_0x31f3a6['status']===0x199)return{'message':_0x2b75e7(0x235),'path':_0x518804};if(!_0x31f3a6['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x518804);const _0x429c9d=await _0x31f3a6[_0x2b75e7(0x239)]();return await lockNoti(_0x2b75e7(0x216),'',0xbb8),_0x429c9d;}catch(_0x13012a){if(_0x62a5b2===0x1)throw _0x13012a;}}return![];}export async function dpRefreshToken(){var _0x2e3e23=a0_0x48a06b;if(!localStorage['getItem'](_0x2e3e23(0x1ff)))throw _0x2e3e23(0x233);try{const _0x301edc=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x2e3e23(0x240),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x2e3e23(0x232)+localStorage[_0x2e3e23(0x1ef)](_0x2e3e23(0x1ff))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x417ba0=await _0x301edc[_0x2e3e23(0x239)]();if(!_0x417ba0['error'])return localStorage[_0x2e3e23(0x249)](_0x2e3e23(0x22c),_0x417ba0['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x417ba0[_0x2e3e23(0x20a)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x14f70d){console[_0x2e3e23(0x1f5)]('Error\x20while\x20refreshing\x20token:',_0x14f70d);}return![];}export async function dpUploadFile(_0x4a9397,_0x555a0b,_0x49cdb7){var _0xaeb6d5=a0_0x48a06b;const _0x28b19b=localStorage['getItem'](_0xaeb6d5(0x238));var _0x1ff112=JSON[_0xaeb6d5(0x21b)]({'autorename':!![],'mode':_0xaeb6d5(0x21f),'mute':!![],'strict_conflict':![],'path':'/'+_0x28b19b+'/'+_0x49cdb7+'/'+_0x4a9397}),_0x4ab5e6=new Blob([_0x555a0b],{'type':_0xaeb6d5(0x254)});for(var _0x306894=0x0;_0x306894<0x2;_0x306894++){var _0x114893=await fetch(_0xaeb6d5(0x221),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0xaeb6d5(0x1ef)]('accessToken'),'Dropbox-API-Arg':_0x1ff112,'Content-Type':_0xaeb6d5(0x254)},'body':_0x4ab5e6});if(_0x114893['status']!=0xc8){if(_0x114893['status']==0x191){var _0x29cc82=await dpRefreshToken();if(!_0x29cc82)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xaeb6d5(0x241)+_0x114893[_0xaeb6d5(0x1f1)];}else{var _0x27a024=await _0x114893['json']();return console[_0xaeb6d5(0x24d)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x4a9397),_0x27a024;}}return![];}export async function dpDownloadFile(_0x2e7af8,_0x3ebc22){var _0x41ac68=a0_0x48a06b;const _0xf2f3a5=localStorage[_0x41ac68(0x1ef)]('uId');var _0xde5303=JSON['stringify']({'path':'/'+_0xf2f3a5+'/'+_0x3ebc22+'/'+_0x2e7af8});for(var _0xfc60a2=0x0;_0xfc60a2<0x2;_0xfc60a2++){var _0x3501e1=await fetch(_0x41ac68(0x20f),{'method':_0x41ac68(0x240),'headers':{'Authorization':_0x41ac68(0x251)+localStorage[_0x41ac68(0x1ef)](_0x41ac68(0x22c)),'Dropbox-API-Arg':_0xde5303}});if(_0x3501e1['status']!=0xc8){if(_0x3501e1['status']==0x191){var _0x567be0=await dpRefreshToken();if(!_0x567be0)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x41ac68(0x215)+_0x3501e1[_0x41ac68(0x1f1)];}const _0x46bf6c=new File([await _0x3501e1[_0x41ac68(0x22a)]()],_0x2e7af8);return console['log'](_0x41ac68(0x1f0),_0x46bf6c[_0x41ac68(0x225)]),a0_0xab52fc[_0x41ac68(0x224)](_0x46bf6c,()=>{}),_0x46bf6c;}return![];}document[a0_0x48a06b(0x207)](a0_0x48a06b(0x24f),function(){var _0x577694=a0_0x48a06b;dropboxRestore[_0x577694(0x207)](_0x577694(0x200),async function(){var _0x1cace6=_0x577694;await lockNoti(_0x1cace6(0x1fc),'',0x1388);const _0x1de4d8=localStorage[_0x1cace6(0x1ef)](_0x1cace6(0x238)),_0x18e87f=[_0x1cace6(0x23c),'save',_0x1cace6(0x214)];if(!_0x1de4d8){window['alert'](_0x1cace6(0x21e));return;}let _0x579d85=[];for(const _0x3b957f of _0x18e87f){let _0x5a620b={'path':'/'+_0x1de4d8+'/'+_0x3b957f};for(let _0x5dedcc=0x0;_0x5dedcc<0x2;_0x5dedcc++){let _0x25a46c=await fetch(_0x1cace6(0x1ee),{'method':'POST','headers':{'Authorization':_0x1cace6(0x251)+localStorage[_0x1cace6(0x1ef)](_0x1cace6(0x22c)),'Content-Type':'application/json'},'body':JSON[_0x1cace6(0x21b)](_0x5a620b)});if(_0x25a46c['status']===0xc8){let _0x2b79f1=await _0x25a46c[_0x1cace6(0x239)](),_0x4168c5=_0x2b79f1[_0x1cace6(0x250)][_0x1cace6(0x231)](_0x182642=>_0x182642[_0x1cace6(0x234)]===_0x1cace6(0x21d));_0x4168c5['length']>0x0&&_0x579d85[_0x1cace6(0x1f6)](..._0x4168c5[_0x1cace6(0x206)](_0xf62fba=>({'name':_0xf62fba[_0x1cace6(0x225)],'folder':_0x3b957f})));break;}else{if(_0x25a46c['status']===0x191){let _0x4790c4=await dpRefreshToken();if(!_0x4790c4)throw _0x1cace6(0x23b);}else{console[_0x1cace6(0x1f5)](_0x1cace6(0x204)+_0x3b957f+_0x1cace6(0x21a)+_0x25a46c[_0x1cace6(0x1f1)]);break;}}}}if(_0x579d85['length']>0x0){const _0x49e1d6=_0x1cace6(0x203)+_0x579d85[_0x1cace6(0x222)]+_0x1cace6(0x247);if(window[_0x1cace6(0x24c)](_0x49e1d6))for(const _0x444bcf of _0x579d85){await lockNoti(_0x1cace6(0x22e),_0x444bcf[_0x1cace6(0x225)],0xbb8),await dpDownloadFile(_0x444bcf[_0x1cace6(0x225)],_0x444bcf[_0x1cace6(0x23a)]);}else console[_0x1cace6(0x24d)](_0x1cace6(0x227));}else console[_0x1cace6(0x24d)](_0x1cace6(0x22f));}),dropboxBackup[_0x577694(0x207)](_0x577694(0x200),async function(){var _0x4446cb=_0x577694;await lockNoti(_0x4446cb(0x1fc),'',0x1388);const _0x1ca3cb=localStorage[_0x4446cb(0x1ef)]('uId');if(_0x1ca3cb===null||_0x1ca3cb==='')window[_0x4446cb(0x242)](_0x4446cb(0x21e));else{const _0x15d595=[_0x4446cb(0x23c),'save',_0x4446cb(0x214)];for(const _0x477fb9 of _0x15d595){await dpCreateFolder(_0x477fb9);}let _0x20ba99=0x0;for(const _0x1493be of _0x15d595){const _0x4be8c9=a0_0xab52fc[_0x4446cb(0x23d)](_0x1493be+'s');_0x20ba99+=_0x4be8c9[_0x4446cb(0x222)];}if(window[_0x4446cb(0x24c)](_0x4446cb(0x220)+_0x20ba99+_0x4446cb(0x201)))for(const _0x190fb2 of _0x15d595){const _0x59d442=a0_0xab52fc['listFiles'](_0x190fb2+'s');for(const _0x4cffdf of _0x59d442){const _0x50ab5d=await a0_0xab52fc['downloadFileInCloud'](_0x4446cb(0x226)+_0x190fb2+'s/'+_0x4cffdf);try{await lockNoti(_0x4446cb(0x208),_0x4cffdf,0xbb8),await dpUploadFile(_0x4cffdf,_0x50ab5d,_0x190fb2);}catch(_0x168d37){console[_0x4446cb(0x1f5)](_0x4446cb(0x218)+_0x4cffdf+':',_0x168d37);}}}else console[_0x4446cb(0x24d)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x577694(0x207)](_0x577694(0x200),function(){var _0x5e9404=_0x577694;const _0x20f70a=localStorage[_0x5e9404(0x1ef)]('uId');_0x20f70a===null||_0x20f70a===''?authorizeWithDropbox():window['confirm'](_0x5e9404(0x229))&&(localStorage[_0x5e9404(0x249)](_0x5e9404(0x238),''),dropboxRestore[_0x5e9404(0x20d)][_0x5e9404(0x21c)](_0x5e9404(0x209)),dropboxBackup[_0x5e9404(0x20d)][_0x5e9404(0x21c)](_0x5e9404(0x209)),dropboxCloud[_0x5e9404(0x20d)][_0x5e9404(0x21c)](_0x5e9404(0x209)));}),handleDropboxCallback();});