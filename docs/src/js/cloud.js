function a0_0x4603(_0x2bd169,_0x2fd4f5){var _0x2e8c51=a0_0x2e8c();return a0_0x4603=function(_0x460318,_0x3af5ed){_0x460318=_0x460318-0xd3;var _0xccb63a=_0x2e8c51[_0x460318];return _0xccb63a;},a0_0x4603(_0x2bd169,_0x2fd4f5);}var a0_0x1061d1=a0_0x4603;function a0_0x2e8c(){var _0xd63524=['1925oTqGvd','Folder\x20already\x20exists','805242mxpulv','downloadFileInCloud','remove','1nAehzL','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refresh_token=','Backing\x20up...','Download\x20failed,\x20unknown\x20http\x20status:','offline','Error\x20while\x20refreshing\x20token:','=([^&#]*)','https://api.dropbox.com/oauth2/token','map','name','https://www.dropbox.com/oauth2/authorize?client_id=','https://api.dropboxapi.com/2/files/create_folder_v2','2896052jYvwbD','/data/','[\x5c?&#]','search','&response_type=','access_token','setItem','6839190ZoMdHy','uid','POST','Failed\x20to\x20upload\x20file\x20','&client_secret=','charAt','error_description','code','active','application/octet-stream','folder','knh3uz2mx2hp2eu','error','state','filter','json','toUpperCase','Kabu\x20storage\x20↦\x20Cloud\x20◆','code=','addEventListener','setRequestHeader','file','Content-Type','https://api.dropboxapi.com/oauth2/token','getItem','uploadFileInCloud','&redirect_uri=','log','Unable\x20to\x20refresh\x20token','application/x-www-form-urlencoded','click','push','Authorization\x20Code:','Do\x20you\x20want\x20to\x20backup\x20','split','exec','18270920OIMZJH','location','replace','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','length','Failed\x20to\x20refresh\x20Dropbox\x20token.','Wait\x20a\x20little\x20bit...','Bearer\x20','classList','save','accessToken','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','blob','stringify','href','confirm','\x20files\x20in\x20Kabu?','authorization_code','Restore\x20canceled\x20by\x20user.','Refreshing\x20token...','FSSync','&client_id=','list','418014EqzYIL','refreshToken','status','overwrite','Folder\x20created','70YlzBYI','https://content.dropboxapi.com/2/files/download','slice','Cloud\x20login\x20required!','parse','.tag','2794368QPuJiC','uId','application/json','open','responseText','send','alert','entries','https://content.dropboxapi.com/2/files/upload','104kaxeVf','Download\x20failed\x20for\x20'];a0_0x2e8c=function(){return _0xd63524;};return a0_0x2e8c();}(function(_0x51d91f,_0x286af5){var _0x3d8787=a0_0x4603,_0x2cb50d=_0x51d91f();while(!![]){try{var _0x459a56=parseInt(_0x3d8787(0x130))/0x1*(parseInt(_0x3d8787(0x12d))/0x2)+parseInt(_0x3d8787(0x120))/0x3+-parseInt(_0x3d8787(0xd3))/0x4+parseInt(_0x3d8787(0x11a))/0x5*(parseInt(_0x3d8787(0x115))/0x6)+-parseInt(_0x3d8787(0x12b))/0x7*(-parseInt(_0x3d8787(0x129))/0x8)+parseInt(_0x3d8787(0xda))/0x9+-parseInt(_0x3d8787(0xfe))/0xa;if(_0x459a56===_0x286af5)break;else _0x2cb50d['push'](_0x2cb50d['shift']());}catch(_0x4f5428){_0x2cb50d['push'](_0x2cb50d['shift']());}}}(a0_0x2e8c,0x7f65f));import*as a0_0x18b99d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1061d1(0xe5),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x2cc1cb=a0_0x1061d1,_0x5543c0=window[_0x2cc1cb(0xff)][_0x2cc1cb(0x10c)]['split']('?')[0x0],_0x3a838d=_0x2cc1cb(0xe1),_0x468dbb=_0x2cc1cb(0x135),_0x1b69c2=_0x2cc1cb(0x13b)+clientId+_0x2cc1cb(0xd7)+_0x3a838d+'&token_access_type='+_0x468dbb+_0x2cc1cb(0xf4)+encodeURIComponent(_0x5543c0);window['location']['href']=_0x1b69c2;}function handleDropboxCallback(){var _0x411d97=a0_0x1061d1,_0x1113f9=getUrlParameter(_0x411d97(0xe1));_0x1113f9?(getAccessToken(_0x1113f9),console[_0x411d97(0xf5)](_0x411d97(0xfa),_0x1113f9)):console[_0x411d97(0xf5)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x315cfa){var _0x6569b5=a0_0x1061d1;_0x315cfa=_0x315cfa[_0x6569b5(0x100)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x51b689=new RegExp(_0x6569b5(0xd5)+_0x315cfa+_0x6569b5(0x137)),_0x83d629=_0x51b689[_0x6569b5(0xfd)](location[_0x6569b5(0xd6)]);return _0x83d629===null?'':decodeURIComponent(_0x83d629[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x1333b9){var _0xfff88=a0_0x1061d1,_0x470c49=_0xfff88(0x10f),_0x3f3aaf=window[_0xfff88(0xff)][_0xfff88(0x10c)][_0xfff88(0xfc)]('?')[0x0],_0x5ac2fe=new XMLHttpRequest();_0x5ac2fe[_0xfff88(0x123)](_0xfff88(0xdc),_0xfff88(0x138)),_0x5ac2fe[_0xfff88(0xee)](_0xfff88(0xf0),_0xfff88(0xf7)),_0x5ac2fe['onload']=function(){var _0x3ce388=_0xfff88;if(_0x5ac2fe['status']===0xc8){var _0x4aa4b2=JSON[_0x3ce388(0x11e)](_0x5ac2fe[_0x3ce388(0x124)]),_0xc9998e=_0x4aa4b2[_0x3ce388(0xd8)],_0x33a0bc=_0x4aa4b2['refresh_token'],_0x1dd9d2=_0x4aa4b2[_0x3ce388(0xdb)];localStorage['setItem']('accessToken',_0xc9998e),localStorage[_0x3ce388(0xd9)](_0x3ce388(0x116),_0x33a0bc),localStorage[_0x3ce388(0xd9)](_0x3ce388(0x121),_0x1dd9d2);}else console[_0x3ce388(0xf5)](_0x3ce388(0x109));},_0x5ac2fe[_0xfff88(0x125)](_0xfff88(0xec)+_0x1333b9+'&grant_type='+_0x470c49+_0xfff88(0x113)+clientId+_0xfff88(0xde)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x3f3aaf));}export async function dpCreateFolder(_0x5925dd){var _0x4d8ea0=a0_0x1061d1;const _0x2e89e6=localStorage[_0x4d8ea0(0xf2)](_0x4d8ea0(0x121));let _0x510cf4=localStorage[_0x4d8ea0(0xf2)]('accessToken');const _0x1f7bdc='/'+_0x2e89e6+'/'+_0x5925dd,_0x392cfe=JSON[_0x4d8ea0(0x10b)]({'path':_0x1f7bdc,'autorename':![]});for(let _0xa603b1=0x0;_0xa603b1<0x2;_0xa603b1++){try{const _0x2d6b6c=await fetch(_0x4d8ea0(0x13c),{'method':'POST','headers':{'Authorization':_0x4d8ea0(0x105)+_0x510cf4,'Content-Type':_0x4d8ea0(0x122)},'body':_0x392cfe});if(_0x2d6b6c['status']===0x191){const _0x3876db=await dpRefreshToken();if(!_0x3876db)throw new Error(_0x4d8ea0(0xf6));_0x510cf4=localStorage['getItem'](_0x4d8ea0(0x108));continue;}if(_0x2d6b6c[_0x4d8ea0(0x117)]===0x199)return{'message':_0x4d8ea0(0x12c),'path':_0x5925dd};if(!_0x2d6b6c['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x5925dd);const _0x58be2d=await _0x2d6b6c['json']();return await lockNoti(_0x4d8ea0(0x119),'',0xbb8),_0x58be2d;}catch(_0xf64745){if(_0xa603b1===0x1)throw _0xf64745;}}return![];}export async function dpRefreshToken(){var _0x4e4362=a0_0x1061d1;if(!localStorage['getItem'](_0x4e4362(0x116)))throw'No\x20refresh\x20token';try{const _0x3269ab=await fetch(_0x4e4362(0xf1),{'method':_0x4e4362(0xdc),'headers':{'Content-Type':_0x4e4362(0xf7)},'body':_0x4e4362(0x132)+localStorage[_0x4e4362(0xf2)](_0x4e4362(0x116))+_0x4e4362(0x101)}),_0x47fa52=await _0x3269ab['json']();if(!_0x47fa52[_0x4e4362(0xe6)])return localStorage[_0x4e4362(0xd9)](_0x4e4362(0x108),_0x47fa52[_0x4e4362(0xd8)]),await lockNoti(_0x4e4362(0x111),'',0xbb8),await delay(0x3e8),!![];else alert(_0x47fa52[_0x4e4362(0xe0)]||_0x4e4362(0x103));}catch(_0x42d166){console[_0x4e4362(0xe6)](_0x4e4362(0x136),_0x42d166);}return![];}export async function dpUploadFile(_0x307edc,_0x2d379f,_0x214a16){var _0x1a412d=a0_0x1061d1;const _0x35e3e2=localStorage[_0x1a412d(0xf2)](_0x1a412d(0x121));var _0x26042f=JSON[_0x1a412d(0x10b)]({'autorename':!![],'mode':_0x1a412d(0x118),'mute':!![],'strict_conflict':![],'path':'/'+_0x35e3e2+'/'+_0x214a16+'/'+_0x307edc}),_0x4920ba=new Blob([_0x2d379f],{'type':'application/octet-stream'});for(var _0x249e96=0x0;_0x249e96<0x2;_0x249e96++){var _0x520f87=await fetch(_0x1a412d(0x128),{'method':_0x1a412d(0xdc),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x1a412d(0x108)),'Dropbox-API-Arg':_0x26042f,'Content-Type':_0x1a412d(0xe3)},'body':_0x4920ba});if(_0x520f87[_0x1a412d(0x117)]!=0xc8){if(_0x520f87[_0x1a412d(0x117)]==0x191){var _0x512275=await dpRefreshToken();if(!_0x512275)throw _0x1a412d(0xf6);continue;}else throw _0x1a412d(0x131)+_0x520f87[_0x1a412d(0x117)];}else{var _0x121097=await _0x520f87[_0x1a412d(0xe9)]();return console[_0x1a412d(0xf5)](_0x1a412d(0xeb),_0x307edc),_0x121097;}}return![];}export async function dpDownloadFile(_0x75d3d4,_0x590a9a){var _0x14fdc3=a0_0x1061d1;const _0x123fae=localStorage[_0x14fdc3(0xf2)](_0x14fdc3(0x121));var _0x40834f=JSON[_0x14fdc3(0x10b)]({'path':'/'+_0x123fae+'/'+_0x590a9a+'/'+_0x75d3d4});for(var _0x2a4418=0x0;_0x2a4418<0x2;_0x2a4418++){var _0x376721=await fetch(_0x14fdc3(0x11b),{'method':_0x14fdc3(0xdc),'headers':{'Authorization':_0x14fdc3(0x105)+localStorage[_0x14fdc3(0xf2)](_0x14fdc3(0x108)),'Dropbox-API-Arg':_0x40834f}});if(_0x376721[_0x14fdc3(0x117)]!=0xc8){if(_0x376721[_0x14fdc3(0x117)]==0x191){var _0x29360f=await dpRefreshToken();if(!_0x29360f)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x14fdc3(0x134)+_0x376721['status'];}const _0x2df0a2=new File([await _0x376721[_0x14fdc3(0x10a)]()],_0x75d3d4);return console[_0x14fdc3(0xf5)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2df0a2[_0x14fdc3(0x13a)]),a0_0x18b99d[_0x14fdc3(0xf3)](_0x2df0a2,()=>{var _0x4c0285=_0x14fdc3;localStorageFile(),Module[_0x4c0285(0x112)]();}),_0x2df0a2;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x3fd55f=a0_0x1061d1;dropboxRestore[_0x3fd55f(0xed)]('click',async function(){var _0x36c8dc=_0x3fd55f;await lockNoti(_0x36c8dc(0x104),'',0x1388);const _0x4f72c7=localStorage['getItem']('uId'),_0x1803eb=['state',_0x36c8dc(0x107),'screenshot'];if(!_0x4f72c7){window[_0x36c8dc(0x126)](_0x36c8dc(0x11d));return;}let _0x66e8ad=[];for(const _0x4e52b5 of _0x1803eb){let _0x129db5={'path':'/'+_0x4f72c7+'/'+_0x4e52b5};for(let _0x10991b=0x0;_0x10991b<0x2;_0x10991b++){let _0x8a7bf4=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x36c8dc(0xdc),'headers':{'Authorization':_0x36c8dc(0x105)+localStorage[_0x36c8dc(0xf2)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x36c8dc(0x10b)](_0x129db5)});if(_0x8a7bf4[_0x36c8dc(0x117)]===0xc8){let _0x25106a=await _0x8a7bf4[_0x36c8dc(0xe9)](),_0x300134=_0x25106a[_0x36c8dc(0x127)][_0x36c8dc(0xe8)](_0x1d3723=>_0x1d3723[_0x36c8dc(0x11f)]===_0x36c8dc(0xef));_0x300134[_0x36c8dc(0x102)]>0x0&&_0x66e8ad[_0x36c8dc(0xf9)](..._0x300134[_0x36c8dc(0x139)](_0x15fd92=>({'name':_0x15fd92['name'],'folder':_0x4e52b5})));break;}else{if(_0x8a7bf4[_0x36c8dc(0x117)]===0x191){let _0x296d0a=await dpRefreshToken();if(!_0x296d0a)throw _0x36c8dc(0xf6);}else{console['error'](_0x36c8dc(0x12a)+_0x4e52b5+',\x20status:\x20'+_0x8a7bf4['status']);break;}}}}if(_0x66e8ad[_0x36c8dc(0x102)]>0x0){const _0x387db4='Do\x20you\x20want\x20to\x20restore\x20'+_0x66e8ad[_0x36c8dc(0x102)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x387db4))for(const _0x50f131 of _0x66e8ad){await lockNoti('Restoring...',_0x50f131['name'],0xbb8),await dpDownloadFile(_0x50f131[_0x36c8dc(0x13a)],_0x50f131[_0x36c8dc(0xe4)]);}else console[_0x36c8dc(0xf5)](_0x36c8dc(0x110));}else console[_0x36c8dc(0xf5)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x3fd55f(0xed)](_0x3fd55f(0xf8),async function(){var _0x5b091b=_0x3fd55f;await lockNoti(_0x5b091b(0x104),'',0x1388);const _0x119690=localStorage[_0x5b091b(0xf2)](_0x5b091b(0x121));if(_0x119690===null||_0x119690==='')window[_0x5b091b(0x126)](_0x5b091b(0x11d));else{const _0x49a6e3=[_0x5b091b(0xe7),_0x5b091b(0x107),'screenshot'];for(const _0x5737eb of _0x49a6e3){await dpCreateFolder(_0x5737eb);}let _0x299153=0x0;for(const _0xffccd9 of _0x49a6e3){const _0x10bb51=a0_0x18b99d[_0x5b091b(0x114)+(_0xffccd9[_0x5b091b(0xdf)](0x0)[_0x5b091b(0xea)]()+_0xffccd9['slice'](0x1))]();_0x299153+=_0x10bb51[_0x5b091b(0x102)];}if(window[_0x5b091b(0x10d)](_0x5b091b(0xfb)+_0x299153+_0x5b091b(0x10e)))for(const _0x3169de of _0x49a6e3){const _0x147576=a0_0x18b99d[_0x5b091b(0x114)+(_0x3169de[_0x5b091b(0xdf)](0x0)[_0x5b091b(0xea)]()+_0x3169de[_0x5b091b(0x11c)](0x1))]();for(const _0x1435a7 of _0x147576){const _0x44141a=await a0_0x18b99d[_0x5b091b(0x12e)](_0x5b091b(0xd4)+_0x3169de+'s/'+_0x1435a7);try{await lockNoti(_0x5b091b(0x133),_0x1435a7,0xbb8),await dpUploadFile(_0x1435a7,_0x44141a,_0x3169de);}catch(_0x1ff740){console['error'](_0x5b091b(0xdd)+_0x1435a7+':',_0x1ff740);}}}else console['log'](_0x5b091b(0x110));}}),dropboxCloud[_0x3fd55f(0xed)]('click',function(){var _0x15ba6e=_0x3fd55f;const _0x33fa61=localStorage[_0x15ba6e(0xf2)](_0x15ba6e(0x121));_0x33fa61===null||_0x33fa61===''?authorizeWithDropbox():window[_0x15ba6e(0x10d)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x15ba6e(0xd9)](_0x15ba6e(0x121),''),dropboxRestore[_0x15ba6e(0x106)]['remove'](_0x15ba6e(0xe2)),dropboxBackup[_0x15ba6e(0x106)][_0x15ba6e(0x12f)]('active'),dropboxCloud[_0x15ba6e(0x106)][_0x15ba6e(0x12f)]('active'));}),handleDropboxCallback();});