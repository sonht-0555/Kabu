var a0_0x14b553=a0_0xb94b;(function(_0x1ee041,_0x1bfb3f){var _0x52eb84=a0_0xb94b,_0x493897=_0x1ee041();while(!![]){try{var _0x563664=-parseInt(_0x52eb84(0x9d))/0x1*(-parseInt(_0x52eb84(0xda))/0x2)+-parseInt(_0x52eb84(0xc3))/0x3+-parseInt(_0x52eb84(0xc7))/0x4*(-parseInt(_0x52eb84(0x98))/0x5)+parseInt(_0x52eb84(0xce))/0x6+parseInt(_0x52eb84(0xc2))/0x7*(-parseInt(_0x52eb84(0xb1))/0x8)+parseInt(_0x52eb84(0xbf))/0x9*(-parseInt(_0x52eb84(0xe5))/0xa)+parseInt(_0x52eb84(0x94))/0xb;if(_0x563664===_0x1bfb3f)break;else _0x493897['push'](_0x493897['shift']());}catch(_0x54699d){_0x493897['push'](_0x493897['shift']());}}}(a0_0x34e6,0x6ac6a));import*as a0_0x83d80 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x34e6(){var _0x365dcc=['setItem','authorization_code','&grant_type=','=([^&#]*)','Cloud\x20login\x20required!','alert','offline','Failed\x20to\x20refresh\x20Dropbox\x20token.','1524490adSlOR','Error\x20creating\x20folder\x20','\x20files\x20from\x20Cloud?','Do\x20you\x20want\x20to\x20restore\x20','charAt','addEventListener','send','href','blob','onload','folder','access_token','Restore\x20canceled\x20by\x20user.','refreshToken','confirm','stringify','status','Wait\x20a\x20little\x20bit...','Unable\x20to\x20refresh\x20token','Content-Type','FSSync','14502147zwDctn','Refreshing\x20token...','Restoring...','nwb3dnfh09rhs31','270NzdRNm','location','Folder\x20already\x20exists','application/x-www-form-urlencoded','https://content.dropboxapi.com/2/files/download','239826qzWRFK','Upload\x20failed,\x20unknown\x20http\x20status:\x20','code','refresh_token=','setRequestHeader','uId','active','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','DOMContentLoaded','classList','getItem','save','downloadFileInCloud','accessToken','https://api.dropbox.com/oauth2/token','map','knh3uz2mx2hp2eu','file','Authorization\x20Code:','/data/','2296464ZOKXfa','state','length','overwrite','Do\x20not\x20receive\x20authorization','application/octet-stream','remove','responseText','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','https://api.dropboxapi.com/2/files/create_folder_v2','https://content.dropboxapi.com/2/files/upload','&token_access_type=','&redirect_uri=','list','45xgcKMO','Bearer\x20','parse','7kJqYoq','1488867MuFKUJ','uploadFileInCloud','Do\x20you\x20want\x20to\x20logout?','POST','20904KtoJMV','split','open','Download\x20failed,\x20unknown\x20http\x20status:','name','Cloud\x20↦\x20Kabu\x20storage\x20◆','&client_secret=','855234beHTFy','json','log','Kabu\x20storage\x20↦\x20Cloud\x20◆','&client_id=','application/json','No\x20refresh\x20token','error_description','https://api.dropboxapi.com/oauth2/token','error',',\x20status:\x20','replace','2xavDCK','uid','click'];a0_0x34e6=function(){return _0x365dcc;};return a0_0x34e6();}var clientId=a0_0x14b553(0xad),clientSecret=a0_0x14b553(0x97);function authorizeWithDropbox(){var _0x184323=a0_0x14b553,_0x421aaa=window[_0x184323(0x99)][_0x184323(0x86)]['split']('?')[0x0],_0x1cdb36=_0x184323(0x9f),_0x5c2281=_0x184323(0xe3),_0x502fdb='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x1cdb36+_0x184323(0xbc)+_0x5c2281+'&redirect_uri='+encodeURIComponent(_0x421aaa);window['location']['href']=_0x502fdb;}function handleDropboxCallback(){var _0x3e3f01=a0_0x14b553,_0x535424=getUrlParameter(_0x3e3f01(0x9f));_0x535424?(getAccessToken(_0x535424),console[_0x3e3f01(0xd0)](_0x3e3f01(0xaf),_0x535424)):console[_0x3e3f01(0xd0)](_0x3e3f01(0xb5));}function a0_0xb94b(_0x5ba653,_0x4f5f31){var _0x34e6a0=a0_0x34e6();return a0_0xb94b=function(_0xb94bd4,_0x2a4890){_0xb94bd4=_0xb94bd4-0x84;var _0x448477=_0x34e6a0[_0xb94bd4];return _0x448477;},a0_0xb94b(_0x5ba653,_0x4f5f31);}function getUrlParameter(_0x50b2e9){var _0x10d9e6=a0_0x14b553;_0x50b2e9=_0x50b2e9[_0x10d9e6(0xd9)](/[\[]/,'\x5c[')[_0x10d9e6(0xd9)](/[\]]/,'\x5c]');var _0x262516=new RegExp('[\x5c?&#]'+_0x50b2e9+_0x10d9e6(0xe0)),_0x51eb45=_0x262516['exec'](location['search']);return _0x51eb45===null?'':decodeURIComponent(_0x51eb45[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x40abcb){var _0x2dbe69=a0_0x14b553,_0x946f5e=_0x2dbe69(0xde),_0x4ef282=window['location'][_0x2dbe69(0x86)][_0x2dbe69(0xc8)]('?')[0x0],_0x207e29=new XMLHttpRequest();_0x207e29[_0x2dbe69(0xc9)](_0x2dbe69(0xc6),_0x2dbe69(0xab)),_0x207e29[_0x2dbe69(0xa1)](_0x2dbe69(0x92),_0x2dbe69(0x9b)),_0x207e29[_0x2dbe69(0x88)]=function(){var _0x18cc94=_0x2dbe69;if(_0x207e29['status']===0xc8){var _0x46a06f=JSON[_0x18cc94(0xc1)](_0x207e29[_0x18cc94(0xb8)]),_0xe93f58=_0x46a06f[_0x18cc94(0x8a)],_0x35c1d3=_0x46a06f['refresh_token'],_0x2cad96=_0x46a06f[_0x18cc94(0xdb)];localStorage['setItem']('accessToken',_0xe93f58),localStorage['setItem'](_0x18cc94(0x8c),_0x35c1d3),localStorage[_0x18cc94(0xdd)](_0x18cc94(0xa2),_0x2cad96);}else console['log'](_0x18cc94(0xa4));},_0x207e29[_0x2dbe69(0x85)]('code='+_0x40abcb+_0x2dbe69(0xdf)+_0x946f5e+_0x2dbe69(0xd2)+clientId+_0x2dbe69(0xcd)+clientSecret+_0x2dbe69(0xbd)+encodeURIComponent(_0x4ef282));}export async function dpCreateFolder(_0xd79153){var _0x3a3b7b=a0_0x14b553;const _0xa7f32f=localStorage[_0x3a3b7b(0xa7)](_0x3a3b7b(0xa2));let _0xc8044=localStorage[_0x3a3b7b(0xa7)](_0x3a3b7b(0xaa));const _0x91a1c2='/'+_0xa7f32f+'/'+_0xd79153,_0x85e0c4=JSON[_0x3a3b7b(0x8e)]({'path':_0x91a1c2,'autorename':![]});for(let _0x3628cb=0x0;_0x3628cb<0x2;_0x3628cb++){try{const _0x20ea58=await fetch(_0x3a3b7b(0xba),{'method':'POST','headers':{'Authorization':_0x3a3b7b(0xc0)+_0xc8044,'Content-Type':_0x3a3b7b(0xd3)},'body':_0x85e0c4});if(_0x20ea58[_0x3a3b7b(0x8f)]===0x191){const _0x1e1491=await dpRefreshToken();if(!_0x1e1491)throw new Error(_0x3a3b7b(0x91));_0xc8044=localStorage[_0x3a3b7b(0xa7)](_0x3a3b7b(0xaa));continue;}if(_0x20ea58[_0x3a3b7b(0x8f)]===0x199)return{'message':_0x3a3b7b(0x9a),'path':_0xd79153};if(!_0x20ea58['ok'])throw new Error(_0x3a3b7b(0xe6)+_0xd79153);const _0x202fb3=await _0x20ea58[_0x3a3b7b(0xcf)]();return await lockNoti('Folder\x20created','',0xbb8),_0x202fb3;}catch(_0xed90de){if(_0x3628cb===0x1)throw _0xed90de;}}return![];}export async function dpRefreshToken(){var _0x3a7ec7=a0_0x14b553;if(!localStorage[_0x3a7ec7(0xa7)](_0x3a7ec7(0x8c)))throw _0x3a7ec7(0xd4);try{const _0x225f52=await fetch(_0x3a7ec7(0xd6),{'method':_0x3a7ec7(0xc6),'headers':{'Content-Type':_0x3a7ec7(0x9b)},'body':_0x3a7ec7(0xa0)+localStorage[_0x3a7ec7(0xa7)](_0x3a7ec7(0x8c))+_0x3a7ec7(0xb9)}),_0xedd1c5=await _0x225f52['json']();if(!_0xedd1c5[_0x3a7ec7(0xd7)])return localStorage[_0x3a7ec7(0xdd)](_0x3a7ec7(0xaa),_0xedd1c5[_0x3a7ec7(0x8a)]),await lockNoti(_0x3a7ec7(0x95),'',0xbb8),await delay(0x3e8),!![];else alert(_0xedd1c5[_0x3a7ec7(0xd5)]||_0x3a7ec7(0xe4));}catch(_0x4ecf09){console[_0x3a7ec7(0xd7)]('Error\x20while\x20refreshing\x20token:',_0x4ecf09);}return![];}export async function dpUploadFile(_0x548abc,_0x1f6a5a,_0xc4285){var _0x29e7a6=a0_0x14b553;const _0x1b3127=localStorage[_0x29e7a6(0xa7)](_0x29e7a6(0xa2));var _0x1492a2=JSON[_0x29e7a6(0x8e)]({'autorename':!![],'mode':_0x29e7a6(0xb4),'mute':!![],'strict_conflict':![],'path':'/'+_0x1b3127+'/'+_0xc4285+'/'+_0x548abc}),_0x4c3ff6=new Blob([_0x1f6a5a],{'type':_0x29e7a6(0xb6)});for(var _0x2b9a35=0x0;_0x2b9a35<0x2;_0x2b9a35++){var _0x4223c5=await fetch(_0x29e7a6(0xbb),{'method':_0x29e7a6(0xc6),'headers':{'Authorization':_0x29e7a6(0xc0)+localStorage[_0x29e7a6(0xa7)]('accessToken'),'Dropbox-API-Arg':_0x1492a2,'Content-Type':_0x29e7a6(0xb6)},'body':_0x4c3ff6});if(_0x4223c5[_0x29e7a6(0x8f)]!=0xc8){if(_0x4223c5[_0x29e7a6(0x8f)]==0x191){var _0x476b46=await dpRefreshToken();if(!_0x476b46)throw _0x29e7a6(0x91);continue;}else throw _0x29e7a6(0x9e)+_0x4223c5[_0x29e7a6(0x8f)];}else{var _0x42191d=await _0x4223c5[_0x29e7a6(0xcf)]();return console[_0x29e7a6(0xd0)](_0x29e7a6(0xd1),_0x548abc),_0x42191d;}}return![];}export async function dpDownloadFile(_0x59b084,_0x5214db){var _0x2ba2ba=a0_0x14b553;const _0x1b469f=localStorage[_0x2ba2ba(0xa7)](_0x2ba2ba(0xa2));var _0x2c767d=JSON['stringify']({'path':'/'+_0x1b469f+'/'+_0x5214db+'/'+_0x59b084});for(var _0x35b764=0x0;_0x35b764<0x2;_0x35b764++){var _0x2b7bdf=await fetch(_0x2ba2ba(0x9c),{'method':_0x2ba2ba(0xc6),'headers':{'Authorization':_0x2ba2ba(0xc0)+localStorage[_0x2ba2ba(0xa7)](_0x2ba2ba(0xaa)),'Dropbox-API-Arg':_0x2c767d}});if(_0x2b7bdf[_0x2ba2ba(0x8f)]!=0xc8){if(_0x2b7bdf['status']==0x191){var _0xed75ac=await dpRefreshToken();if(!_0xed75ac)throw _0x2ba2ba(0x91);continue;}else throw _0x2ba2ba(0xca)+_0x2b7bdf[_0x2ba2ba(0x8f)];}const _0xea6630=new File([await _0x2b7bdf[_0x2ba2ba(0x87)]()],_0x59b084);return console[_0x2ba2ba(0xd0)](_0x2ba2ba(0xcc),_0xea6630['name']),a0_0x83d80[_0x2ba2ba(0xc4)](_0xea6630,()=>{var _0x1c8af3=_0x2ba2ba;localStorageFile(),Module[_0x1c8af3(0x93)]();}),_0xea6630;}return![];}document['addEventListener'](a0_0x14b553(0xa5),function(){var _0x3f83d8=a0_0x14b553;dropboxRestore[_0x3f83d8(0x84)]('click',async function(){var _0x48a040=_0x3f83d8;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x27b221=localStorage[_0x48a040(0xa7)]('uId'),_0x379771=[_0x48a040(0xb2),_0x48a040(0xa8),'screenshot'];if(!_0x27b221){window[_0x48a040(0xe2)](_0x48a040(0xe1));return;}let _0xa648df=[];for(const _0x2f81c8 of _0x379771){let _0x246cfc={'path':'/'+_0x27b221+'/'+_0x2f81c8};for(let _0x3cb9c5=0x0;_0x3cb9c5<0x2;_0x3cb9c5++){let _0x21e8a1=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x48a040(0xc0)+localStorage[_0x48a040(0xa7)]('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x48a040(0x8e)](_0x246cfc)});if(_0x21e8a1[_0x48a040(0x8f)]===0xc8){let _0x434262=await _0x21e8a1[_0x48a040(0xcf)](),_0x54701d=_0x434262['entries']['filter'](_0x423290=>_0x423290['.tag']===_0x48a040(0xae));_0x54701d['length']>0x0&&_0xa648df['push'](..._0x54701d[_0x48a040(0xac)](_0xa48042=>({'name':_0xa48042[_0x48a040(0xcb)],'folder':_0x2f81c8})));break;}else{if(_0x21e8a1[_0x48a040(0x8f)]===0x191){let _0x45bad0=await dpRefreshToken();if(!_0x45bad0)throw _0x48a040(0x91);}else{console[_0x48a040(0xd7)]('Download\x20failed\x20for\x20'+_0x2f81c8+_0x48a040(0xd8)+_0x21e8a1[_0x48a040(0x8f)]);break;}}}}if(_0xa648df[_0x48a040(0xb3)]>0x0){const _0x12e31c=_0x48a040(0xe8)+_0xa648df[_0x48a040(0xb3)]+_0x48a040(0xe7);if(window['confirm'](_0x12e31c))for(const _0x40f202 of _0xa648df){await lockNoti(_0x48a040(0x96),_0x40f202[_0x48a040(0xcb)],0xbb8),await dpDownloadFile(_0x40f202[_0x48a040(0xcb)],_0x40f202[_0x48a040(0x89)]);}else console[_0x48a040(0xd0)](_0x48a040(0x8b));}else console[_0x48a040(0xd0)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x3f83d8(0xdc),async function(){var _0x4f6c79=_0x3f83d8;await lockNoti(_0x4f6c79(0x90),'',0x1388);const _0xd98014=localStorage[_0x4f6c79(0xa7)](_0x4f6c79(0xa2));if(_0xd98014===null||_0xd98014==='')window['alert'](_0x4f6c79(0xe1));else{const _0x5831ef=[_0x4f6c79(0xb2),_0x4f6c79(0xa8),'screenshot'];for(const _0x1c8d71 of _0x5831ef){await dpCreateFolder(_0x1c8d71);}let _0x4900f1=0x0;for(const _0x193d46 of _0x5831ef){const _0x1dbfd9=a0_0x83d80[_0x4f6c79(0xbe)+(_0x193d46[_0x4f6c79(0xe9)](0x0)['toUpperCase']()+_0x193d46['slice'](0x1))]();_0x4900f1+=_0x1dbfd9[_0x4f6c79(0xb3)];}if(window[_0x4f6c79(0x8d)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4900f1+'\x20files\x20in\x20Kabu?'))for(const _0x990195 of _0x5831ef){const _0x5755ed=a0_0x83d80['list'+(_0x990195[_0x4f6c79(0xe9)](0x0)['toUpperCase']()+_0x990195['slice'](0x1))]();for(const _0x33b269 of _0x5755ed){const _0x18d509=await a0_0x83d80[_0x4f6c79(0xa9)](_0x4f6c79(0xb0)+_0x990195+'s/'+_0x33b269);try{await lockNoti('Backing\x20up...',_0x33b269,0xbb8),await dpUploadFile(_0x33b269,_0x18d509,_0x990195);}catch(_0x5f386d){console[_0x4f6c79(0xd7)]('Failed\x20to\x20upload\x20file\x20'+_0x33b269+':',_0x5f386d);}}}else console[_0x4f6c79(0xd0)](_0x4f6c79(0x8b));}}),dropboxCloud[_0x3f83d8(0x84)](_0x3f83d8(0xdc),function(){var _0xb4b4b3=_0x3f83d8;const _0x4547f5=localStorage[_0xb4b4b3(0xa7)](_0xb4b4b3(0xa2));_0x4547f5===null||_0x4547f5===''?authorizeWithDropbox():window[_0xb4b4b3(0x8d)](_0xb4b4b3(0xc5))&&(localStorage[_0xb4b4b3(0xdd)]('uId',''),dropboxRestore[_0xb4b4b3(0xa6)]['remove']('active'),dropboxBackup[_0xb4b4b3(0xa6)]['remove']('active'),dropboxCloud['classList'][_0xb4b4b3(0xb7)](_0xb4b4b3(0xa3)));}),handleDropboxCallback();});