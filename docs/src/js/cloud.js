function a0_0x2608(){var _0xe5605e=['folder','click','file','506441eMauZx','Failed\x20to\x20upload\x20file\x20','=([^&#]*)','184GDuLOS','Content-Type','error_description','Cloud\x20↦\x20Kabu\x20storage\x20◆','Error\x20creating\x20folder\x20','https://content.dropboxapi.com/2/files/download','error','&client_id=','setRequestHeader','code=','replace','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Wait\x20a\x20little\x20bit...','map','Restore\x20canceled\x20by\x20user.','https://api.dropboxapi.com/2/files/create_folder_v2','split','Do\x20not\x20receive\x20authorization','refreshToken','accessToken','setItem','Cloud\x20login\x20required!','14xaBfan','Folder\x20created','confirm','screenshot','56930ddeYzn','refresh_token=','Bearer\x20','authorization_code','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','Failed\x20to\x20refresh\x20Dropbox\x20token.','overwrite','/data/','No\x20files\x20found\x20to\x20restore.','Folder\x20already\x20exists','getItem','log','remove','https://api.dropbox.com/oauth2/token','https://api.dropboxapi.com/2/files/list_folder','code','onload','status','classList','parse','application/octet-stream','2pjUWmt','access_token','240ZBCevl','offline','Backing\x20up...','Do\x20you\x20want\x20to\x20logout?','Download\x20failed,\x20unknown\x20http\x20status:','state','Error\x20while\x20refreshing\x20token:','open','Upload\x20failed,\x20unknown\x20http\x20status:\x20','\x20files\x20from\x20Cloud?','json','send','2368149eaMBhd','No\x20refresh\x20token','listFiles','href','application/json','push','blob','name','uploadFileInCloud','save','Refreshing\x20token...','search','length','[\x5c?&#]','knh3uz2mx2hp2eu','Kabu\x20storage\x20↦\x20Cloud\x20◆','390330emClDL','&redirect_uri=','Restoring...','123483jVFckI','active','POST','uId','&grant_type=','uid','stringify','11tqFYbN','7760abDCMt','Unable\x20to\x20refresh\x20token','751446QFJBeH','location','80IzAoYX','addEventListener','&token_access_type=','Authorization\x20Code:','https://content.dropboxapi.com/2/files/upload','.tag','\x20files\x20in\x20Kabu?'];a0_0x2608=function(){return _0xe5605e;};return a0_0x2608();}var a0_0x1df95a=a0_0x74c7;(function(_0x12e01c,_0x15ba08){var _0x11816b=a0_0x74c7,_0x16c47a=_0x12e01c();while(!![]){try{var _0x3149a5=-parseInt(_0x11816b(0x11a))/0x1+-parseInt(_0x11816b(0xf9))/0x2*(-parseInt(_0x11816b(0x107))/0x3)+-parseInt(_0x11816b(0x133))/0x4*(parseInt(_0x11816b(0x122))/0x5)+parseInt(_0x11816b(0x124))/0x6*(parseInt(_0x11816b(0xdf))/0x7)+parseInt(_0x11816b(0x126))/0x8*(parseInt(_0x11816b(0x117))/0x9)+-parseInt(_0x11816b(0xe3))/0xa*(parseInt(_0x11816b(0x121))/0xb)+parseInt(_0x11816b(0xfb))/0xc*(-parseInt(_0x11816b(0x130))/0xd);if(_0x3149a5===_0x15ba08)break;else _0x16c47a['push'](_0x16c47a['shift']());}catch(_0x2b7a18){_0x16c47a['push'](_0x16c47a['shift']());}}}(a0_0x2608,0x78921));import*as a0_0x5f2c19 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1df95a(0x115),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x416576=a0_0x1df95a,_0x3ee49e=window[_0x416576(0x125)][_0x416576(0x10a)][_0x416576(0x143)]('?')[0x0],_0x40000f='code',_0x489bb8=_0x416576(0xfc),_0x4680ad='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x40000f+_0x416576(0x128)+_0x489bb8+_0x416576(0x118)+encodeURIComponent(_0x3ee49e);window['location']['href']=_0x4680ad;}function handleDropboxCallback(){var _0x473a6b=a0_0x1df95a,_0x2f8002=getUrlParameter(_0x473a6b(0xf3));_0x2f8002?(getAccessToken(_0x2f8002),console[_0x473a6b(0xef)](_0x473a6b(0x129),_0x2f8002)):console[_0x473a6b(0xef)](_0x473a6b(0x144));}function getUrlParameter(_0x597d27){var _0x45a97e=a0_0x1df95a;_0x597d27=_0x597d27[_0x45a97e(0x13d)](/[\[]/,'\x5c[')[_0x45a97e(0x13d)](/[\]]/,'\x5c]');var _0x26b2e4=new RegExp(_0x45a97e(0x114)+_0x597d27+_0x45a97e(0x132)),_0x51480c=_0x26b2e4['exec'](location[_0x45a97e(0x112)]);return _0x51480c===null?'':decodeURIComponent(_0x51480c[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x4d079a){var _0x2ae8f8=a0_0x1df95a,_0x302886=_0x2ae8f8(0xe6),_0x53118b=window[_0x2ae8f8(0x125)][_0x2ae8f8(0x10a)][_0x2ae8f8(0x143)]('?')[0x0],_0x412600=new XMLHttpRequest();_0x412600[_0x2ae8f8(0x102)](_0x2ae8f8(0x11c),_0x2ae8f8(0xf1)),_0x412600[_0x2ae8f8(0x13b)](_0x2ae8f8(0x134),'application/x-www-form-urlencoded'),_0x412600[_0x2ae8f8(0xf4)]=function(){var _0xd456d4=_0x2ae8f8;if(_0x412600['status']===0xc8){var _0x3ecf84=JSON[_0xd456d4(0xf7)](_0x412600['responseText']),_0x39105e=_0x3ecf84['access_token'],_0xb55117=_0x3ecf84['refresh_token'],_0x49a0bb=_0x3ecf84[_0xd456d4(0x11f)];localStorage[_0xd456d4(0xdd)]('accessToken',_0x39105e),localStorage['setItem'](_0xd456d4(0xdb),_0xb55117),localStorage[_0xd456d4(0xdd)](_0xd456d4(0x11d),_0x49a0bb);}else console[_0xd456d4(0xef)](_0xd456d4(0xe7));},_0x412600[_0x2ae8f8(0x106)](_0x2ae8f8(0x13c)+_0x4d079a+_0x2ae8f8(0x11e)+_0x302886+_0x2ae8f8(0x13a)+clientId+'&client_secret='+clientSecret+_0x2ae8f8(0x118)+encodeURIComponent(_0x53118b));}function a0_0x74c7(_0x2164ba,_0x5eaa7b){var _0x2608c5=a0_0x2608();return a0_0x74c7=function(_0x74c7ef,_0x6558d2){_0x74c7ef=_0x74c7ef-0xdb;var _0x44d8b2=_0x2608c5[_0x74c7ef];return _0x44d8b2;},a0_0x74c7(_0x2164ba,_0x5eaa7b);}export async function dpCreateFolder(_0x590c34){var _0x213360=a0_0x1df95a;const _0x56b2c0=localStorage['getItem'](_0x213360(0x11d));let _0x1e209b=localStorage['getItem'](_0x213360(0xdc));const _0x35b1a5='/'+_0x56b2c0+'/'+_0x590c34,_0x596300=JSON[_0x213360(0x120)]({'path':_0x35b1a5,'autorename':![]});for(let _0x33e34d=0x0;_0x33e34d<0x2;_0x33e34d++){try{const _0x6725f4=await fetch(_0x213360(0x142),{'method':'POST','headers':{'Authorization':_0x213360(0xe5)+_0x1e209b,'Content-Type':_0x213360(0x10b)},'body':_0x596300});if(_0x6725f4[_0x213360(0xf5)]===0x191){const _0x113d60=await dpRefreshToken();if(!_0x113d60)throw new Error('Unable\x20to\x20refresh\x20token');_0x1e209b=localStorage[_0x213360(0xee)]('accessToken');continue;}if(_0x6725f4[_0x213360(0xf5)]===0x199)return{'message':_0x213360(0xed),'path':_0x590c34};if(!_0x6725f4['ok'])throw new Error(_0x213360(0x137)+_0x590c34);const _0x1772be=await _0x6725f4[_0x213360(0x105)]();return await lockNoti(_0x213360(0xe0),'',0xbb8),_0x1772be;}catch(_0x10be9c){if(_0x33e34d===0x1)throw _0x10be9c;}}return![];}export async function dpRefreshToken(){var _0x47294d=a0_0x1df95a;if(!localStorage['getItem'](_0x47294d(0xdb)))throw _0x47294d(0x108);try{const _0x9af790=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x47294d(0xe4)+localStorage[_0x47294d(0xee)](_0x47294d(0xdb))+_0x47294d(0x13e)}),_0x318290=await _0x9af790[_0x47294d(0x105)]();if(!_0x318290[_0x47294d(0x139)])return localStorage[_0x47294d(0xdd)]('accessToken',_0x318290[_0x47294d(0xfa)]),await lockNoti(_0x47294d(0x111),'',0xbb8),await delay(0x3e8),!![];else alert(_0x318290[_0x47294d(0x135)]||_0x47294d(0xe9));}catch(_0x52670a){console['error'](_0x47294d(0x101),_0x52670a);}return![];}export async function dpUploadFile(_0x13196d,_0x1b6f00,_0x2fb97a){var _0x3f4d62=a0_0x1df95a;const _0x27bfdb=localStorage[_0x3f4d62(0xee)](_0x3f4d62(0x11d));var _0x553555=JSON['stringify']({'autorename':!![],'mode':_0x3f4d62(0xea),'mute':!![],'strict_conflict':![],'path':'/'+_0x27bfdb+'/'+_0x2fb97a+'/'+_0x13196d}),_0x4c83a9=new Blob([_0x1b6f00],{'type':_0x3f4d62(0xf8)});for(var _0x322748=0x0;_0x322748<0x2;_0x322748++){var _0x31dde4=await fetch(_0x3f4d62(0x12a),{'method':_0x3f4d62(0x11c),'headers':{'Authorization':_0x3f4d62(0xe5)+localStorage[_0x3f4d62(0xee)](_0x3f4d62(0xdc)),'Dropbox-API-Arg':_0x553555,'Content-Type':_0x3f4d62(0xf8)},'body':_0x4c83a9});if(_0x31dde4[_0x3f4d62(0xf5)]!=0xc8){if(_0x31dde4[_0x3f4d62(0xf5)]==0x191){var _0x41c6db=await dpRefreshToken();if(!_0x41c6db)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x3f4d62(0x103)+_0x31dde4['status'];}else{var _0x4232e0=await _0x31dde4[_0x3f4d62(0x105)]();return console[_0x3f4d62(0xef)](_0x3f4d62(0x116),_0x13196d),_0x4232e0;}}return![];}export async function dpDownloadFile(_0xd79719,_0x3c8bc8){var _0x1f2379=a0_0x1df95a;const _0x153af4=localStorage[_0x1f2379(0xee)](_0x1f2379(0x11d));var _0x3c095a=JSON['stringify']({'path':'/'+_0x153af4+'/'+_0x3c8bc8+'/'+_0xd79719});for(var _0x5a6947=0x0;_0x5a6947<0x2;_0x5a6947++){var _0x5c92ee=await fetch(_0x1f2379(0x138),{'method':'POST','headers':{'Authorization':_0x1f2379(0xe5)+localStorage['getItem'](_0x1f2379(0xdc)),'Dropbox-API-Arg':_0x3c095a}});if(_0x5c92ee[_0x1f2379(0xf5)]!=0xc8){if(_0x5c92ee[_0x1f2379(0xf5)]==0x191){var _0x4c2faf=await dpRefreshToken();if(!_0x4c2faf)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x1f2379(0xff)+_0x5c92ee['status'];}const _0xf1a71a=new File([await _0x5c92ee[_0x1f2379(0x10d)]()],_0xd79719);return console[_0x1f2379(0xef)](_0x1f2379(0x136),_0xf1a71a[_0x1f2379(0x10e)]),a0_0x5f2c19[_0x1f2379(0x10f)](_0xf1a71a,()=>{}),_0xf1a71a;}return![];}document[a0_0x1df95a(0x127)]('DOMContentLoaded',function(){var _0x25fa43=a0_0x1df95a;dropboxRestore['addEventListener'](_0x25fa43(0x12e),async function(){var _0x3b9356=_0x25fa43;await lockNoti(_0x3b9356(0x13f),'',0x1388);const _0x87fd1a=localStorage[_0x3b9356(0xee)](_0x3b9356(0x11d)),_0x1df2ee=[_0x3b9356(0x100),_0x3b9356(0x110),_0x3b9356(0xe2)];if(!_0x87fd1a){window['alert'](_0x3b9356(0xde));return;}let _0x32b39b=[];for(const _0x4d0cd9 of _0x1df2ee){let _0x3d7850={'path':'/'+_0x87fd1a+'/'+_0x4d0cd9};for(let _0x42c348=0x0;_0x42c348<0x2;_0x42c348++){let _0x5a4696=await fetch(_0x3b9356(0xf2),{'method':_0x3b9356(0x11c),'headers':{'Authorization':_0x3b9356(0xe5)+localStorage[_0x3b9356(0xee)](_0x3b9356(0xdc)),'Content-Type':_0x3b9356(0x10b)},'body':JSON[_0x3b9356(0x120)](_0x3d7850)});if(_0x5a4696[_0x3b9356(0xf5)]===0xc8){let _0x3782f5=await _0x5a4696[_0x3b9356(0x105)](),_0xff42c8=_0x3782f5['entries']['filter'](_0x1b0b99=>_0x1b0b99[_0x3b9356(0x12b)]===_0x3b9356(0x12f));_0xff42c8[_0x3b9356(0x113)]>0x0&&_0x32b39b[_0x3b9356(0x10c)](..._0xff42c8[_0x3b9356(0x140)](_0x55537c=>({'name':_0x55537c[_0x3b9356(0x10e)],'folder':_0x4d0cd9})));break;}else{if(_0x5a4696[_0x3b9356(0xf5)]===0x191){let _0x40d86f=await dpRefreshToken();if(!_0x40d86f)throw _0x3b9356(0x123);}else{console['error']('Download\x20failed\x20for\x20'+_0x4d0cd9+',\x20status:\x20'+_0x5a4696[_0x3b9356(0xf5)]);break;}}}}if(_0x32b39b['length']>0x0){const _0x995c28=_0x3b9356(0xe8)+_0x32b39b['length']+_0x3b9356(0x104);if(window[_0x3b9356(0xe1)](_0x995c28))for(const _0x229cc9 of _0x32b39b){await lockNoti(_0x3b9356(0x119),_0x229cc9[_0x3b9356(0x10e)],0xbb8),await dpDownloadFile(_0x229cc9[_0x3b9356(0x10e)],_0x229cc9[_0x3b9356(0x12d)]);}else console['log']('Restore\x20canceled\x20by\x20user.');}else console[_0x3b9356(0xef)](_0x3b9356(0xec));}),dropboxBackup[_0x25fa43(0x127)]('click',async function(){var _0x3c857f=_0x25fa43;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x398347=localStorage[_0x3c857f(0xee)]('uId');if(_0x398347===null||_0x398347==='')window['alert']('Cloud\x20login\x20required!');else{const _0x3623ee=[_0x3c857f(0x100),_0x3c857f(0x110),_0x3c857f(0xe2)];for(const _0x399a80 of _0x3623ee){await dpCreateFolder(_0x399a80);}let _0x2a8477=0x0;for(const _0x32fe1b of _0x3623ee){const _0x203bb5=a0_0x5f2c19[_0x3c857f(0x109)](_0x32fe1b+'s');_0x2a8477+=_0x203bb5[_0x3c857f(0x113)];}if(window[_0x3c857f(0xe1)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x2a8477+_0x3c857f(0x12c)))for(const _0x2d567f of _0x3623ee){const _0x12ec09=a0_0x5f2c19['listFiles'](_0x2d567f+'s');for(const _0x329e21 of _0x12ec09){const _0x480aff=await a0_0x5f2c19['downloadFileInCloud'](_0x3c857f(0xeb)+_0x2d567f+'s/'+_0x329e21);try{await lockNoti(_0x3c857f(0xfd),_0x329e21,0xbb8),await dpUploadFile(_0x329e21,_0x480aff,_0x2d567f);}catch(_0x19cd3d){console[_0x3c857f(0x139)](_0x3c857f(0x131)+_0x329e21+':',_0x19cd3d);}}}else console[_0x3c857f(0xef)](_0x3c857f(0x141));}}),dropboxCloud[_0x25fa43(0x127)](_0x25fa43(0x12e),function(){var _0x30ef27=_0x25fa43;const _0x3b6184=localStorage['getItem']('uId');_0x3b6184===null||_0x3b6184===''?authorizeWithDropbox():window['confirm'](_0x30ef27(0xfe))&&(localStorage[_0x30ef27(0xdd)](_0x30ef27(0x11d),''),dropboxRestore[_0x30ef27(0xf6)][_0x30ef27(0xf0)](_0x30ef27(0x11b)),dropboxBackup[_0x30ef27(0xf6)]['remove'](_0x30ef27(0x11b)),dropboxCloud[_0x30ef27(0xf6)]['remove']('active'));}),handleDropboxCallback();});