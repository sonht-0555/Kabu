var a0_0x424006=a0_0x1649;(function(_0x4328c4,_0x5d977a){var _0x3892e9=a0_0x1649,_0x1acd50=_0x4328c4();while(!![]){try{var _0x5cafdb=-parseInt(_0x3892e9(0xb1))/0x1*(parseInt(_0x3892e9(0xce))/0x2)+parseInt(_0x3892e9(0xd0))/0x3*(parseInt(_0x3892e9(0xac))/0x4)+parseInt(_0x3892e9(0xbe))/0x5*(parseInt(_0x3892e9(0xe9))/0x6)+-parseInt(_0x3892e9(0xa5))/0x7+parseInt(_0x3892e9(0x97))/0x8+-parseInt(_0x3892e9(0xab))/0x9*(parseInt(_0x3892e9(0xe8))/0xa)+-parseInt(_0x3892e9(0xb4))/0xb;if(_0x5cafdb===_0x5d977a)break;else _0x1acd50['push'](_0x1acd50['shift']());}catch(_0x1cbfc4){_0x1acd50['push'](_0x1acd50['shift']());}}}(a0_0x3bbe,0xd2cc7));import*as a0_0x29a23b from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1649(_0x4467f4,_0x797ca9){var _0x3bbe5e=a0_0x3bbe();return a0_0x1649=function(_0x164946,_0x1c1488){_0x164946=_0x164946-0x85;var _0x4501a7=_0x3bbe5e[_0x164946];return _0x4501a7;},a0_0x1649(_0x4467f4,_0x797ca9);}var clientId=a0_0x424006(0xd7),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4858f5=a0_0x424006,_0x54bc2e=window['location'][_0x4858f5(0xdb)][_0x4858f5(0x85)]('?')[0x0],_0x45d891=_0x4858f5(0xd2),_0xacafa9='offline',_0x700caa=_0x4858f5(0xc3)+clientId+_0x4858f5(0xe1)+_0x45d891+_0x4858f5(0x91)+_0xacafa9+_0x4858f5(0xbd)+encodeURIComponent(_0x54bc2e);window[_0x4858f5(0xaf)][_0x4858f5(0xdb)]=_0x700caa;}function handleDropboxCallback(){var _0x32d58f=a0_0x424006,_0xad8fb5=getUrlParameter(_0x32d58f(0xd2));_0xad8fb5?(getAccessToken(_0xad8fb5),console['log'](_0x32d58f(0xd9),_0xad8fb5)):console[_0x32d58f(0xc2)](_0x32d58f(0xaa));}function getUrlParameter(_0x377fe7){var _0x1760b9=a0_0x424006;_0x377fe7=_0x377fe7[_0x1760b9(0x9a)](/[\[]/,'\x5c[')[_0x1760b9(0x9a)](/[\]]/,'\x5c]');var _0x2a7eb0=new RegExp(_0x1760b9(0xae)+_0x377fe7+_0x1760b9(0xda)),_0x36a0a4=_0x2a7eb0[_0x1760b9(0xd4)](location[_0x1760b9(0xc7)]);return _0x36a0a4===null?'':decodeURIComponent(_0x36a0a4[0x1][_0x1760b9(0x9a)](/\+/g,'\x20'));}function getAccessToken(_0x2df8e9){var _0x8aa1bc=a0_0x424006,_0x2c53c9='authorization_code',_0x414ea3=window[_0x8aa1bc(0xaf)][_0x8aa1bc(0xdb)][_0x8aa1bc(0x85)]('?')[0x0],_0x25b032=new XMLHttpRequest();_0x25b032['open'](_0x8aa1bc(0x8c),_0x8aa1bc(0xcc)),_0x25b032[_0x8aa1bc(0xe3)](_0x8aa1bc(0xa0),_0x8aa1bc(0xe7)),_0x25b032[_0x8aa1bc(0x93)]=function(){var _0x15897f=_0x8aa1bc;if(_0x25b032[_0x15897f(0xd1)]===0xc8){var _0x23c96b=JSON[_0x15897f(0xa2)](_0x25b032[_0x15897f(0xe2)]),_0x66278=_0x23c96b[_0x15897f(0xb3)],_0x59516a=_0x23c96b[_0x15897f(0xbf)],_0x3e0ba6=_0x23c96b[_0x15897f(0x96)];localStorage['setItem'](_0x15897f(0xd3),_0x66278),localStorage['setItem'](_0x15897f(0xa6),_0x59516a),localStorage[_0x15897f(0x88)]('uId',_0x3e0ba6);}else console[_0x15897f(0xc2)](_0x15897f(0xb9));},_0x25b032[_0x8aa1bc(0xa9)](_0x8aa1bc(0xdc)+_0x2df8e9+_0x8aa1bc(0xa3)+_0x2c53c9+'&client_id='+clientId+_0x8aa1bc(0xcb)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x414ea3));}function a0_0x3bbe(){var _0xcf418d=['Content-Type','length','parse','&grant_type=','blob','3915877fFXFoX','refreshToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','map','send','Do\x20not\x20receive\x20authorization','359847QyqpFj','12oyzrjU','addEventListener','[\x5c?&#]','location','application/octet-stream','12fkbVzJ','https://content.dropboxapi.com/2/files/download','access_token','1387826smSRuE','Bearer\x20','uId','Refreshing\x20token...','Error\x20while\x20refreshing\x20token:','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20you\x20want\x20to\x20restore\x20','push','Do\x20you\x20want\x20to\x20backup\x20','&redirect_uri=','135fkCiCB','refresh_token','file','.tag','log','https://www.dropbox.com/oauth2/authorize?client_id=','Unable\x20to\x20refresh\x20token','error','classList','search','Failed\x20to\x20upload\x20file\x20','Error\x20creating\x20folder\x20','downloadFileInCloud','&client_secret=','https://api.dropbox.com/oauth2/token','Wait\x20a\x20little\x20bit...','51872giYUaV','click','401046kzhRrM','status','code','accessToken','exec','overwrite','folder','knh3uz2mx2hp2eu','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Authorization\x20Code:','=([^&#]*)','href','code=','Do\x20you\x20want\x20to\x20logout?','save','entries','Cloud\x20login\x20required!','&response_type=','responseText','setRequestHeader','\x20files\x20from\x20Cloud?','toUpperCase','alert','application/x-www-form-urlencoded','170YbtwvB','127698eQkRPw','Restoring...','Upload\x20failed,\x20unknown\x20http\x20status:\x20','list','split','screenshot','remove','setItem','Restore\x20canceled\x20by\x20user.','refresh_token=','state','POST','name','DOMContentLoaded',',\x20status:\x20','/data/','&token_access_type=','confirm','onload','json','No\x20files\x20found\x20to\x20restore.','uid','12514112fiyoIn','https://api.dropboxapi.com/oauth2/token','stringify','replace','getItem','filter','https://content.dropboxapi.com/2/files/upload','Download\x20failed\x20for\x20','FSSync'];a0_0x3bbe=function(){return _0xcf418d;};return a0_0x3bbe();}export async function dpCreateFolder(_0x1b83cd){var _0x353618=a0_0x424006;const _0x1fb00b=localStorage[_0x353618(0x9b)]('uId');let _0x59cce8=localStorage['getItem']('accessToken');const _0xa09feb='/'+_0x1fb00b+'/'+_0x1b83cd,_0xc2d4a1=JSON[_0x353618(0x99)]({'path':_0xa09feb,'autorename':![]});for(let _0x43f001=0x0;_0x43f001<0x2;_0x43f001++){try{const _0x409f96=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x353618(0xb5)+_0x59cce8,'Content-Type':'application/json'},'body':_0xc2d4a1});if(_0x409f96[_0x353618(0xd1)]===0x191){const _0x4cf4ef=await dpRefreshToken();if(!_0x4cf4ef)throw new Error(_0x353618(0xc4));_0x59cce8=localStorage[_0x353618(0x9b)](_0x353618(0xd3));continue;}if(_0x409f96[_0x353618(0xd1)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x1b83cd};if(!_0x409f96['ok'])throw new Error(_0x353618(0xc9)+_0x1b83cd);const _0x33a18c=await _0x409f96['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x33a18c;}catch(_0x5576b0){if(_0x43f001===0x1)throw _0x5576b0;}}return![];}export async function dpRefreshToken(){var _0x40dcea=a0_0x424006;if(!localStorage[_0x40dcea(0x9b)](_0x40dcea(0xa6)))throw'No\x20refresh\x20token';try{const _0x1e8f78=await fetch(_0x40dcea(0x98),{'method':_0x40dcea(0x8c),'headers':{'Content-Type':_0x40dcea(0xe7)},'body':_0x40dcea(0x8a)+localStorage['getItem']('refreshToken')+_0x40dcea(0xd8)}),_0x2a2938=await _0x1e8f78[_0x40dcea(0x94)]();if(!_0x2a2938[_0x40dcea(0xc5)])return localStorage[_0x40dcea(0x88)](_0x40dcea(0xd3),_0x2a2938[_0x40dcea(0xb3)]),await lockNoti(_0x40dcea(0xb7),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2a2938['error_description']||_0x40dcea(0xa7));}catch(_0xeb7c3c){console[_0x40dcea(0xc5)](_0x40dcea(0xb8),_0xeb7c3c);}return![];}export async function dpUploadFile(_0x190ea8,_0x5bc88a,_0x250aae){var _0x5a3250=a0_0x424006;const _0x2407f8=localStorage[_0x5a3250(0x9b)]('uId');var _0x33670c=JSON[_0x5a3250(0x99)]({'autorename':!![],'mode':_0x5a3250(0xd5),'mute':!![],'strict_conflict':![],'path':'/'+_0x2407f8+'/'+_0x250aae+'/'+_0x190ea8}),_0x1dc9f0=new Blob([_0x5bc88a],{'type':_0x5a3250(0xb0)});for(var _0x36331a=0x0;_0x36331a<0x2;_0x36331a++){var _0x1b5eaa=await fetch(_0x5a3250(0x9d),{'method':_0x5a3250(0x8c),'headers':{'Authorization':_0x5a3250(0xb5)+localStorage['getItem'](_0x5a3250(0xd3)),'Dropbox-API-Arg':_0x33670c,'Content-Type':'application/octet-stream'},'body':_0x1dc9f0});if(_0x1b5eaa[_0x5a3250(0xd1)]!=0xc8){if(_0x1b5eaa[_0x5a3250(0xd1)]==0x191){var _0xd1cdd0=await dpRefreshToken();if(!_0xd1cdd0)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5a3250(0xeb)+_0x1b5eaa[_0x5a3250(0xd1)];}else{var _0xf21401=await _0x1b5eaa[_0x5a3250(0x94)]();return console[_0x5a3250(0xc2)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x190ea8),_0xf21401;}}return![];}export async function dpDownloadFile(_0x18d085,_0x235dd2){var _0x166571=a0_0x424006;const _0x5c721b=localStorage['getItem'](_0x166571(0xb6));var _0x5eebfb=JSON[_0x166571(0x99)]({'path':'/'+_0x5c721b+'/'+_0x235dd2+'/'+_0x18d085});for(var _0xa31b40=0x0;_0xa31b40<0x2;_0xa31b40++){var _0xf55d29=await fetch(_0x166571(0xb2),{'method':_0x166571(0x8c),'headers':{'Authorization':_0x166571(0xb5)+localStorage[_0x166571(0x9b)](_0x166571(0xd3)),'Dropbox-API-Arg':_0x5eebfb}});if(_0xf55d29['status']!=0xc8){if(_0xf55d29[_0x166571(0xd1)]==0x191){var _0x4308bc=await dpRefreshToken();if(!_0x4308bc)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0xf55d29[_0x166571(0xd1)];}const _0x541053=new File([await _0xf55d29[_0x166571(0xa4)]()],_0x18d085);return console[_0x166571(0xc2)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x541053[_0x166571(0x8d)]),a0_0x29a23b['uploadFileInCloud'](_0x541053,()=>{var _0x456ad6=_0x166571;localStorageFile(),Module[_0x456ad6(0x9f)]();}),_0x541053;}return![];}document[a0_0x424006(0xad)](a0_0x424006(0x8e),function(){var _0x4b834d=a0_0x424006;dropboxRestore[_0x4b834d(0xad)](_0x4b834d(0xcf),async function(){var _0x37ecbd=_0x4b834d;await lockNoti(_0x37ecbd(0xcd),'',0x1388);const _0x4c8733=localStorage[_0x37ecbd(0x9b)](_0x37ecbd(0xb6)),_0x205a34=[_0x37ecbd(0x8b),_0x37ecbd(0xde),'screenshot'];if(!_0x4c8733){window[_0x37ecbd(0xe6)](_0x37ecbd(0xe0));return;}let _0x1c0438=[];for(const _0xb32f8a of _0x205a34){let _0x3c9672={'path':'/'+_0x4c8733+'/'+_0xb32f8a};for(let _0x4be565=0x0;_0x4be565<0x2;_0x4be565++){let _0x11c8f9=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x37ecbd(0x8c),'headers':{'Authorization':_0x37ecbd(0xb5)+localStorage[_0x37ecbd(0x9b)](_0x37ecbd(0xd3)),'Content-Type':'application/json'},'body':JSON['stringify'](_0x3c9672)});if(_0x11c8f9['status']===0xc8){let _0x119e61=await _0x11c8f9[_0x37ecbd(0x94)](),_0x15b559=_0x119e61[_0x37ecbd(0xdf)][_0x37ecbd(0x9c)](_0x25351e=>_0x25351e[_0x37ecbd(0xc1)]===_0x37ecbd(0xc0));_0x15b559[_0x37ecbd(0xa1)]>0x0&&_0x1c0438[_0x37ecbd(0xbb)](..._0x15b559[_0x37ecbd(0xa8)](_0x18f457=>({'name':_0x18f457[_0x37ecbd(0x8d)],'folder':_0xb32f8a})));break;}else{if(_0x11c8f9[_0x37ecbd(0xd1)]===0x191){let _0x3625c3=await dpRefreshToken();if(!_0x3625c3)throw _0x37ecbd(0xc4);}else{console['error'](_0x37ecbd(0x9e)+_0xb32f8a+_0x37ecbd(0x8f)+_0x11c8f9[_0x37ecbd(0xd1)]);break;}}}}if(_0x1c0438[_0x37ecbd(0xa1)]>0x0){const _0x3e3543=_0x37ecbd(0xba)+_0x1c0438[_0x37ecbd(0xa1)]+_0x37ecbd(0xe4);if(window[_0x37ecbd(0x92)](_0x3e3543))for(const _0x1c797c of _0x1c0438){await lockNoti(_0x37ecbd(0xea),_0x1c797c[_0x37ecbd(0x8d)],0xbb8),await dpDownloadFile(_0x1c797c[_0x37ecbd(0x8d)],_0x1c797c[_0x37ecbd(0xd6)]);}else console[_0x37ecbd(0xc2)]('Restore\x20canceled\x20by\x20user.');}else console[_0x37ecbd(0xc2)](_0x37ecbd(0x95));}),dropboxBackup[_0x4b834d(0xad)](_0x4b834d(0xcf),async function(){var _0x34139d=_0x4b834d;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1a5a4c=localStorage[_0x34139d(0x9b)](_0x34139d(0xb6));if(_0x1a5a4c===null||_0x1a5a4c==='')window[_0x34139d(0xe6)](_0x34139d(0xe0));else{const _0x29186f=[_0x34139d(0x8b),_0x34139d(0xde),_0x34139d(0x86)];for(const _0x16bfa4 of _0x29186f){await dpCreateFolder(_0x16bfa4);}let _0x3774ef=0x0;for(const _0x543c33 of _0x29186f){const _0x258a37=a0_0x29a23b['list'+(_0x543c33['charAt'](0x0)[_0x34139d(0xe5)]()+_0x543c33['slice'](0x1))]();_0x3774ef+=_0x258a37[_0x34139d(0xa1)];}if(window[_0x34139d(0x92)](_0x34139d(0xbc)+_0x3774ef+'\x20files\x20in\x20Kabu?'))for(const _0x6425ff of _0x29186f){const _0x20e0af=a0_0x29a23b[_0x34139d(0xec)+(_0x6425ff['charAt'](0x0)[_0x34139d(0xe5)]()+_0x6425ff['slice'](0x1))]();for(const _0x43dc32 of _0x20e0af){const _0x1cefd4=await a0_0x29a23b[_0x34139d(0xca)](_0x34139d(0x90)+_0x6425ff+'s/'+_0x43dc32);try{await lockNoti('Backing\x20up...',_0x43dc32,0xbb8),await dpUploadFile(_0x43dc32,_0x1cefd4,_0x6425ff);}catch(_0x4bb7de){console[_0x34139d(0xc5)](_0x34139d(0xc8)+_0x43dc32+':',_0x4bb7de);}}}else console[_0x34139d(0xc2)](_0x34139d(0x89));}}),dropboxCloud['addEventListener']('click',function(){var _0x2ef145=_0x4b834d;const _0x3ff1b7=localStorage[_0x2ef145(0x9b)]('uId');_0x3ff1b7===null||_0x3ff1b7===''?authorizeWithDropbox():window[_0x2ef145(0x92)](_0x2ef145(0xdd))&&(localStorage[_0x2ef145(0x88)](_0x2ef145(0xb6),''),dropboxRestore[_0x2ef145(0xc6)][_0x2ef145(0x87)]('active'),dropboxBackup[_0x2ef145(0xc6)][_0x2ef145(0x87)]('active'),dropboxCloud[_0x2ef145(0xc6)][_0x2ef145(0x87)]('active'));}),handleDropboxCallback();});