var a0_0x5a8145=a0_0x416b;(function(_0x1445bc,_0xb2c195){var _0x4bc83d=a0_0x416b,_0x3a3a25=_0x1445bc();while(!![]){try{var _0x5bcd52=parseInt(_0x4bc83d(0x1c9))/0x1*(parseInt(_0x4bc83d(0x1e4))/0x2)+-parseInt(_0x4bc83d(0x1b0))/0x3+-parseInt(_0x4bc83d(0x1ee))/0x4*(-parseInt(_0x4bc83d(0x1e7))/0x5)+-parseInt(_0x4bc83d(0x1b8))/0x6+-parseInt(_0x4bc83d(0x1c3))/0x7*(-parseInt(_0x4bc83d(0x1b6))/0x8)+parseInt(_0x4bc83d(0x20a))/0x9*(parseInt(_0x4bc83d(0x203))/0xa)+-parseInt(_0x4bc83d(0x214))/0xb;if(_0x5bcd52===_0xb2c195)break;else _0x3a3a25['push'](_0x3a3a25['shift']());}catch(_0x5558ff){_0x3a3a25['push'](_0x3a3a25['shift']());}}}(a0_0x456c,0x8c5f7));import*as a0_0x5de806 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5a8145(0x1d9),clientSecret=a0_0x5a8145(0x204);function authorizeWithDropbox(){var _0xb5f916=a0_0x5a8145,_0x3db727=window[_0xb5f916(0x1f1)]['href'][_0xb5f916(0x1fc)]('?')[0x0],_0x524232=_0xb5f916(0x1b5),_0x58cfa8=_0xb5f916(0x1f2),_0xf86d8b='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0xb5f916(0x211)+_0x524232+_0xb5f916(0x215)+_0x58cfa8+_0xb5f916(0x205)+encodeURIComponent(_0x3db727);window['location'][_0xb5f916(0x1f3)]=_0xf86d8b;}function a0_0x416b(_0x1c2ee8,_0x1ab550){var _0x456c6c=a0_0x456c();return a0_0x416b=function(_0x416b5f,_0x3b099c){_0x416b5f=_0x416b5f-0x1b0;var _0x1c551e=_0x456c6c[_0x416b5f];return _0x1c551e;},a0_0x416b(_0x1c2ee8,_0x1ab550);}function handleDropboxCallback(){var _0x54448e=a0_0x5a8145,_0x2cbac9=getUrlParameter('code');_0x2cbac9?(getAccessToken(_0x2cbac9),console[_0x54448e(0x1bd)](_0x54448e(0x1c4),_0x2cbac9)):console[_0x54448e(0x1bd)](_0x54448e(0x1d3));}function getUrlParameter(_0xe5337e){var _0x4bf238=a0_0x5a8145;_0xe5337e=_0xe5337e[_0x4bf238(0x1d2)](/[\[]/,'\x5c[')[_0x4bf238(0x1d2)](/[\]]/,'\x5c]');var _0x558e92=new RegExp(_0x4bf238(0x1b7)+_0xe5337e+_0x4bf238(0x1d0)),_0x2e0945=_0x558e92[_0x4bf238(0x1ba)](location[_0x4bf238(0x1c8)]);return _0x2e0945===null?'':decodeURIComponent(_0x2e0945[0x1][_0x4bf238(0x1d2)](/\+/g,'\x20'));}function getAccessToken(_0x49b254){var _0x57240a=a0_0x5a8145,_0x1f19be=_0x57240a(0x1b3),_0x5e73d6=window[_0x57240a(0x1f1)][_0x57240a(0x1f3)]['split']('?')[0x0],_0x1a020d=new XMLHttpRequest();_0x1a020d[_0x57240a(0x210)]('POST',_0x57240a(0x1cb)),_0x1a020d[_0x57240a(0x20d)]('Content-Type',_0x57240a(0x202)),_0x1a020d[_0x57240a(0x1f5)]=function(){var _0x3150e0=_0x57240a;if(_0x1a020d[_0x3150e0(0x1dc)]===0xc8){var _0x468dfd=JSON[_0x3150e0(0x1c7)](_0x1a020d[_0x3150e0(0x1ff)]),_0x5ee5af=_0x468dfd[_0x3150e0(0x1c0)],_0x27badc=_0x468dfd['refresh_token'],_0x3ad30c=_0x468dfd['uid'];localStorage[_0x3150e0(0x1ea)](_0x3150e0(0x1de),_0x5ee5af),localStorage[_0x3150e0(0x1ea)](_0x3150e0(0x1f8),_0x27badc),localStorage[_0x3150e0(0x1ea)](_0x3150e0(0x1ec),_0x3ad30c);}else console[_0x3150e0(0x1bd)](_0x3150e0(0x1bb));},_0x1a020d[_0x57240a(0x1fd)]('code='+_0x49b254+_0x57240a(0x1d5)+_0x1f19be+'&client_id='+clientId+_0x57240a(0x200)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x5e73d6));}export async function dpCreateFolder(_0x3ff4d8){var _0x10fd27=a0_0x5a8145;const _0x343ee4=localStorage['getItem']('uId');let _0x14f9e4=localStorage[_0x10fd27(0x1fa)](_0x10fd27(0x1de));const _0x45900b='/'+_0x343ee4+'/'+_0x3ff4d8,_0x1cec44=JSON[_0x10fd27(0x1fb)]({'path':_0x45900b,'autorename':![]});for(let _0x54ec51=0x0;_0x54ec51<0x2;_0x54ec51++){try{const _0x5b1aef=await fetch(_0x10fd27(0x1b2),{'method':_0x10fd27(0x1dd),'headers':{'Authorization':'Bearer\x20'+_0x14f9e4,'Content-Type':_0x10fd27(0x208)},'body':_0x1cec44});if(_0x5b1aef[_0x10fd27(0x1dc)]===0x191){const _0x3e8dec=await dpRefreshToken();if(!_0x3e8dec)throw new Error('Unable\x20to\x20refresh\x20token');_0x14f9e4=localStorage[_0x10fd27(0x1fa)](_0x10fd27(0x1de));continue;}if(_0x5b1aef[_0x10fd27(0x1dc)]===0x199)return{'message':_0x10fd27(0x1f7),'path':_0x3ff4d8};if(!_0x5b1aef['ok'])throw new Error(_0x10fd27(0x1e6)+_0x3ff4d8);const _0x92d1d0=await _0x5b1aef['json']();return await lockNoti(_0x10fd27(0x1e8),'',0xbb8),_0x92d1d0;}catch(_0x33d6d4){if(_0x54ec51===0x1)throw _0x33d6d4;}}return![];}export async function dpRefreshToken(){var _0x31b8fa=a0_0x5a8145;if(!localStorage[_0x31b8fa(0x1fa)](_0x31b8fa(0x1f8)))throw'No\x20refresh\x20token';try{const _0x11191c=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x31b8fa(0x1dd),'headers':{'Content-Type':_0x31b8fa(0x202)},'body':_0x31b8fa(0x1cc)+localStorage[_0x31b8fa(0x1fa)]('refreshToken')+_0x31b8fa(0x1db)}),_0x5f334c=await _0x11191c[_0x31b8fa(0x1e2)]();if(!_0x5f334c[_0x31b8fa(0x201)])return localStorage['setItem'](_0x31b8fa(0x1de),_0x5f334c[_0x31b8fa(0x1c0)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x5f334c[_0x31b8fa(0x1e5)]||_0x31b8fa(0x1d6));}catch(_0x8f75d6){console[_0x31b8fa(0x201)]('Error\x20while\x20refreshing\x20token:',_0x8f75d6);}return![];}export async function dpUploadFile(_0x5956c3,_0x780b5a,_0x4486a9){var _0x1996fb=a0_0x5a8145;const _0x160c40=localStorage['getItem'](_0x1996fb(0x1ec));var _0x5d0e97=JSON[_0x1996fb(0x1fb)]({'autorename':!![],'mode':_0x1996fb(0x1b1),'mute':!![],'strict_conflict':![],'path':'/'+_0x160c40+'/'+_0x4486a9+'/'+_0x5956c3}),_0xf0c210=new Blob([_0x780b5a],{'type':_0x1996fb(0x1df)});for(var _0x3eba24=0x0;_0x3eba24<0x2;_0x3eba24++){var _0x1e5f3c=await fetch(_0x1996fb(0x1d4),{'method':_0x1996fb(0x1dd),'headers':{'Authorization':_0x1996fb(0x1da)+localStorage[_0x1996fb(0x1fa)](_0x1996fb(0x1de)),'Dropbox-API-Arg':_0x5d0e97,'Content-Type':_0x1996fb(0x1df)},'body':_0xf0c210});if(_0x1e5f3c[_0x1996fb(0x1dc)]!=0xc8){if(_0x1e5f3c[_0x1996fb(0x1dc)]==0x191){var _0x1355ee=await dpRefreshToken();if(!_0x1355ee)throw _0x1996fb(0x1c6);continue;}else throw _0x1996fb(0x20e)+_0x1e5f3c[_0x1996fb(0x1dc)];}else{var _0x320b8a=await _0x1e5f3c['json']();return console[_0x1996fb(0x1bd)](_0x1996fb(0x1d7),_0x5956c3),_0x320b8a;}}return![];}export async function dpDownloadFile(_0x20938f,_0x26c53b){var _0x1c01d4=a0_0x5a8145;const _0x45d83b=localStorage[_0x1c01d4(0x1fa)]('uId');var _0x398a99=JSON['stringify']({'path':'/'+_0x45d83b+'/'+_0x26c53b+'/'+_0x20938f});for(var _0x38a798=0x0;_0x38a798<0x2;_0x38a798++){var _0x287ae8=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1c01d4(0x1dd),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x1c01d4(0x1fa)](_0x1c01d4(0x1de)),'Dropbox-API-Arg':_0x398a99}});if(_0x287ae8[_0x1c01d4(0x1dc)]!=0xc8){if(_0x287ae8[_0x1c01d4(0x1dc)]==0x191){var _0x5f5568=await dpRefreshToken();if(!_0x5f5568)throw _0x1c01d4(0x1c6);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x287ae8[_0x1c01d4(0x1dc)];}const _0x3691ff=new File([await _0x287ae8[_0x1c01d4(0x1ed)]()],_0x20938f);return console[_0x1c01d4(0x1bd)](_0x1c01d4(0x1c2),_0x3691ff[_0x1c01d4(0x1eb)]),a0_0x5de806[_0x1c01d4(0x1f6)](_0x3691ff,()=>{}),_0x3691ff;}return![];}function a0_0x456c(){var _0x252e89=['15234813qwGKzQ','&token_access_type=','filter','3006573xeTKdI','overwrite','https://api.dropboxapi.com/2/files/create_folder_v2','authorization_code','Do\x20you\x20want\x20to\x20backup\x20','code','2011904sJJbao','[\x5c?&#]','3577944KhQbKl','remove','exec','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','alert','log','addEventListener','confirm','access_token','Download\x20failed\x20for\x20','Cloud\x20↦\x20Kabu\x20storage\x20◆','28FMBUwH','Authorization\x20Code:','listFiles','Unable\x20to\x20refresh\x20token','parse','search','135316wiWTPR','DOMContentLoaded','https://api.dropbox.com/oauth2/token','refresh_token=','Do\x20you\x20want\x20to\x20logout?','file','Cloud\x20login\x20required!','=([^&#]*)','state','replace','Do\x20not\x20receive\x20authorization','https://content.dropboxapi.com/2/files/upload','&grant_type=','Failed\x20to\x20refresh\x20Dropbox\x20token.','Kabu\x20storage\x20↦\x20Cloud\x20◆','save','knh3uz2mx2hp2eu','Bearer\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','status','POST','accessToken','application/octet-stream','Do\x20you\x20want\x20to\x20restore\x20','active','json','screenshot','14UqTYCb','error_description','Error\x20creating\x20folder\x20','5Ecrdzi','Folder\x20created','length','setItem','name','uId','blob','3142696HpBdPq','Restoring...','\x20files\x20in\x20Kabu?','location','offline','href','https://api.dropboxapi.com/2/files/list_folder','onload','uploadFileInCloud','Folder\x20already\x20exists','refreshToken','push','getItem','stringify','split','send','Restore\x20canceled\x20by\x20user.','responseText','&client_secret=','error','application/x-www-form-urlencoded','290Pnhlvh','nwb3dnfh09rhs31','&redirect_uri=','/data/','Failed\x20to\x20upload\x20file\x20','application/json','No\x20files\x20found\x20to\x20restore.','254367IqoXhE','Wait\x20a\x20little\x20bit...','click','setRequestHeader','Upload\x20failed,\x20unknown\x20http\x20status:\x20','.tag','open','&response_type=','classList','downloadFileInCloud'];a0_0x456c=function(){return _0x252e89;};return a0_0x456c();}document[a0_0x5a8145(0x1be)](a0_0x5a8145(0x1ca),function(){var _0xb705e=a0_0x5a8145;dropboxRestore[_0xb705e(0x1be)](_0xb705e(0x20c),async function(){var _0x5c637f=_0xb705e;await lockNoti(_0x5c637f(0x20b),'',0x1388);const _0x436ace=localStorage['getItem'](_0x5c637f(0x1ec)),_0x742c4c=['state',_0x5c637f(0x1d8),'screenshot'];if(!_0x436ace){window[_0x5c637f(0x1bc)]('Cloud\x20login\x20required!');return;}let _0x106c62=[];for(const _0x526942 of _0x742c4c){let _0x17cb64={'path':'/'+_0x436ace+'/'+_0x526942};for(let _0x45f098=0x0;_0x45f098<0x2;_0x45f098++){let _0x1aff6f=await fetch(_0x5c637f(0x1f4),{'method':_0x5c637f(0x1dd),'headers':{'Authorization':_0x5c637f(0x1da)+localStorage['getItem']('accessToken'),'Content-Type':_0x5c637f(0x208)},'body':JSON[_0x5c637f(0x1fb)](_0x17cb64)});if(_0x1aff6f['status']===0xc8){let _0x3531c0=await _0x1aff6f[_0x5c637f(0x1e2)](),_0x5ebeda=_0x3531c0['entries'][_0x5c637f(0x216)](_0x4eb5b8=>_0x4eb5b8[_0x5c637f(0x20f)]===_0x5c637f(0x1ce));_0x5ebeda[_0x5c637f(0x1e9)]>0x0&&_0x106c62[_0x5c637f(0x1f9)](..._0x5ebeda['map'](_0x16873c=>({'name':_0x16873c[_0x5c637f(0x1eb)],'folder':_0x526942})));break;}else{if(_0x1aff6f['status']===0x191){let _0x4bbc86=await dpRefreshToken();if(!_0x4bbc86)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x5c637f(0x201)](_0x5c637f(0x1c1)+_0x526942+',\x20status:\x20'+_0x1aff6f['status']);break;}}}}if(_0x106c62[_0x5c637f(0x1e9)]>0x0){const _0x41bc4d=_0x5c637f(0x1e0)+_0x106c62[_0x5c637f(0x1e9)]+'\x20files\x20from\x20Cloud?';if(window['confirm'](_0x41bc4d))for(const _0x2ab70b of _0x106c62){await lockNoti(_0x5c637f(0x1ef),_0x2ab70b['name'],0xbb8),await dpDownloadFile(_0x2ab70b[_0x5c637f(0x1eb)],_0x2ab70b['folder']);}else console[_0x5c637f(0x1bd)](_0x5c637f(0x1fe));}else console[_0x5c637f(0x1bd)](_0x5c637f(0x209));}),dropboxBackup['addEventListener']('click',async function(){var _0x40c514=_0xb705e;await lockNoti(_0x40c514(0x20b),'',0x1388);const _0x5f1736=localStorage['getItem']('uId');if(_0x5f1736===null||_0x5f1736==='')window[_0x40c514(0x1bc)](_0x40c514(0x1cf));else{const _0x16d5f4=[_0x40c514(0x1d1),_0x40c514(0x1d8),_0x40c514(0x1e3)];for(const _0x225bdb of _0x16d5f4){await dpCreateFolder(_0x225bdb);}let _0x3d1aeb=0x0;for(const _0x34232e of _0x16d5f4){const _0x1786c4=a0_0x5de806[_0x40c514(0x1c5)](_0x34232e+'s');_0x3d1aeb+=_0x1786c4[_0x40c514(0x1e9)];}if(window[_0x40c514(0x1bf)](_0x40c514(0x1b4)+_0x3d1aeb+_0x40c514(0x1f0)))for(const _0x567f97 of _0x16d5f4){const _0x17645d=a0_0x5de806[_0x40c514(0x1c5)](_0x567f97+'s');for(const _0x18a7d1 of _0x17645d){const _0x2a593a=await a0_0x5de806[_0x40c514(0x213)](_0x40c514(0x206)+_0x567f97+'s/'+_0x18a7d1);try{await lockNoti('Backing\x20up...',_0x18a7d1,0xbb8),await dpUploadFile(_0x18a7d1,_0x2a593a,_0x567f97);}catch(_0x1d25b4){console['error'](_0x40c514(0x207)+_0x18a7d1+':',_0x1d25b4);}}}else console['log'](_0x40c514(0x1fe));}}),dropboxCloud['addEventListener'](_0xb705e(0x20c),function(){var _0x4858a9=_0xb705e;const _0x22716d=localStorage['getItem'](_0x4858a9(0x1ec));_0x22716d===null||_0x22716d===''?authorizeWithDropbox():window[_0x4858a9(0x1bf)](_0x4858a9(0x1cd))&&(localStorage[_0x4858a9(0x1ea)](_0x4858a9(0x1ec),''),dropboxRestore[_0x4858a9(0x212)][_0x4858a9(0x1b9)](_0x4858a9(0x1e1)),dropboxBackup[_0x4858a9(0x212)][_0x4858a9(0x1b9)]('active'),dropboxCloud[_0x4858a9(0x212)][_0x4858a9(0x1b9)](_0x4858a9(0x1e1)));}),handleDropboxCallback();});