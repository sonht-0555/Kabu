var a0_0x2429c4=a0_0x50f8;(function(_0x5b6244,_0x49e96a){var _0x15270e=a0_0x50f8,_0x3620d4=_0x5b6244();while(!![]){try{var _0x4cee1b=-parseInt(_0x15270e(0x1d2))/0x1*(parseInt(_0x15270e(0x19f))/0x2)+-parseInt(_0x15270e(0x1d0))/0x3+-parseInt(_0x15270e(0x1d6))/0x4*(-parseInt(_0x15270e(0x1cd))/0x5)+parseInt(_0x15270e(0x1f5))/0x6*(parseInt(_0x15270e(0x1c1))/0x7)+-parseInt(_0x15270e(0x1a4))/0x8+parseInt(_0x15270e(0x1b9))/0x9*(parseInt(_0x15270e(0x19a))/0xa)+-parseInt(_0x15270e(0x1d8))/0xb*(-parseInt(_0x15270e(0x1ae))/0xc);if(_0x4cee1b===_0x49e96a)break;else _0x3620d4['push'](_0x3620d4['shift']());}catch(_0xc6af81){_0x3620d4['push'](_0x3620d4['shift']());}}}(a0_0x5ad2,0x4f334));import*as a0_0x2b2dc9 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x2429c4(0x1e6),clientSecret=a0_0x2429c4(0x19b);function authorizeWithDropbox(){var _0x48d953=a0_0x2429c4,_0x54dd07=window[_0x48d953(0x1c7)][_0x48d953(0x1f2)][_0x48d953(0x1ea)]('?')[0x0],_0xacc177=_0x48d953(0x1bb),_0x4e16af='offline',_0x2a7fda='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0xacc177+_0x48d953(0x1aa)+_0x4e16af+'&redirect_uri='+encodeURIComponent(_0x54dd07);window[_0x48d953(0x1c7)][_0x48d953(0x1f2)]=_0x2a7fda;}function handleDropboxCallback(){var _0x102b2c=a0_0x2429c4,_0x15f575=getUrlParameter(_0x102b2c(0x1bb));_0x15f575?(getAccessToken(_0x15f575),console[_0x102b2c(0x1a3)]('Authorization\x20Code:',_0x15f575)):console[_0x102b2c(0x1a3)]('Do\x20not\x20receive\x20authorization');}function a0_0x5ad2(){var _0xee6ea0=['Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token',',\x20status:\x20','slice','application/json','18uUULVK','&redirect_uri=','code','.tag','overwrite','Restoring...','Failed\x20to\x20upload\x20file\x20','alert','223083FMnnhh','application/x-www-form-urlencoded','screenshot','Refreshing\x20token...','addEventListener','classList','location','Error\x20while\x20refreshing\x20token:','length','error','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','toUpperCase','979230uxSIkG','No\x20files\x20found\x20to\x20restore.','list','1774416YHorpj','name','1847vshIYL','https://api.dropboxapi.com/2/files/create_folder_v2','access_token','state','4FDLEps','No\x20refresh\x20token','101222Mivwou','Download\x20failed\x20for\x20','Restore\x20canceled\x20by\x20user.','json','responseText','Unable\x20to\x20refresh\x20token','Cloud\x20login\x20required!','uId','file','authorization_code','setItem','Error\x20creating\x20folder\x20','&client_id=','error_description','knh3uz2mx2hp2eu','click','https://api.dropboxapi.com/oauth2/token','setRequestHeader','split','Do\x20you\x20want\x20to\x20backup\x20','refresh_token','https://content.dropboxapi.com/2/files/upload','Do\x20you\x20want\x20to\x20logout?','charAt','filter','entries','href','Bearer\x20','search','18avIACA','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refreshToken','confirm','&grant_type=','accessToken','POST','exec','884990hBuHIS','nwb3dnfh09rhs31','Folder\x20already\x20exists','Folder\x20created','open','626NoEgms','stringify','save','map','log','4457664KvprWw','Download\x20failed,\x20unknown\x20http\x20status:','Wait\x20a\x20little\x20bit...','https://api.dropboxapi.com/2/files/list_folder','getItem','replace','&token_access_type=','remove','active','https://api.dropbox.com/oauth2/token','2064pmCCoX','parse','Kabu\x20storage\x20↦\x20Cloud\x20◆','send','status','DOMContentLoaded','folder'];a0_0x5ad2=function(){return _0xee6ea0;};return a0_0x5ad2();}function getUrlParameter(_0x3f5859){var _0x3e848f=a0_0x2429c4;_0x3f5859=_0x3f5859[_0x3e848f(0x1a9)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x3c673c=new RegExp('[\x5c?&#]'+_0x3f5859+'=([^&#]*)'),_0x4ea0df=_0x3c673c[_0x3e848f(0x199)](location[_0x3e848f(0x1f4)]);return _0x4ea0df===null?'':decodeURIComponent(_0x4ea0df[0x1][_0x3e848f(0x1a9)](/\+/g,'\x20'));}function getAccessToken(_0x67fc1c){var _0x14f19d=a0_0x2429c4,_0xe6436d=_0x14f19d(0x1e1),_0x3cdd6a=window[_0x14f19d(0x1c7)]['href'][_0x14f19d(0x1ea)]('?')[0x0],_0xa0a0bd=new XMLHttpRequest();_0xa0a0bd[_0x14f19d(0x19e)](_0x14f19d(0x198),_0x14f19d(0x1ad)),_0xa0a0bd[_0x14f19d(0x1e9)]('Content-Type',_0x14f19d(0x1c2)),_0xa0a0bd['onload']=function(){var _0x42b08c=_0x14f19d;if(_0xa0a0bd[_0x42b08c(0x1b2)]===0xc8){var _0x5d198d=JSON[_0x42b08c(0x1af)](_0xa0a0bd[_0x42b08c(0x1dc)]),_0x1d1e22=_0x5d198d[_0x42b08c(0x1d4)],_0x463b91=_0x5d198d[_0x42b08c(0x1ec)],_0x343537=_0x5d198d['uid'];localStorage[_0x42b08c(0x1e2)](_0x42b08c(0x197),_0x1d1e22),localStorage[_0x42b08c(0x1e2)](_0x42b08c(0x1f7),_0x463b91),localStorage['setItem'](_0x42b08c(0x1df),_0x343537);}else console[_0x42b08c(0x1a3)](_0x42b08c(0x1b5));},_0xa0a0bd[_0x14f19d(0x1b1)]('code='+_0x67fc1c+_0x14f19d(0x196)+_0xe6436d+_0x14f19d(0x1e4)+clientId+'&client_secret='+clientSecret+_0x14f19d(0x1ba)+encodeURIComponent(_0x3cdd6a));}export async function dpCreateFolder(_0x406da9){var _0x192780=a0_0x2429c4;const _0x214b50=localStorage[_0x192780(0x1a8)](_0x192780(0x1df));let _0x2b2555=localStorage[_0x192780(0x1a8)]('accessToken');const _0x3d46af='/'+_0x214b50+'/'+_0x406da9,_0x147f8f=JSON['stringify']({'path':_0x3d46af,'autorename':![]});for(let _0x52a429=0x0;_0x52a429<0x2;_0x52a429++){try{const _0xd10c6f=await fetch(_0x192780(0x1d3),{'method':_0x192780(0x198),'headers':{'Authorization':_0x192780(0x1f3)+_0x2b2555,'Content-Type':_0x192780(0x1b8)},'body':_0x147f8f});if(_0xd10c6f[_0x192780(0x1b2)]===0x191){const _0x1f1646=await dpRefreshToken();if(!_0x1f1646)throw new Error(_0x192780(0x1dd));_0x2b2555=localStorage[_0x192780(0x1a8)](_0x192780(0x197));continue;}if(_0xd10c6f[_0x192780(0x1b2)]===0x199)return{'message':_0x192780(0x19c),'path':_0x406da9};if(!_0xd10c6f['ok'])throw new Error(_0x192780(0x1e3)+_0x406da9);const _0x3082d5=await _0xd10c6f[_0x192780(0x1db)]();return await lockNoti(_0x192780(0x19d),'',0xbb8),_0x3082d5;}catch(_0x281d38){if(_0x52a429===0x1)throw _0x281d38;}}return![];}export async function dpRefreshToken(){var _0x5d5599=a0_0x2429c4;if(!localStorage[_0x5d5599(0x1a8)]('refreshToken'))throw _0x5d5599(0x1d7);try{const _0x2789ac=await fetch(_0x5d5599(0x1e8),{'method':'POST','headers':{'Content-Type':_0x5d5599(0x1c2)},'body':'refresh_token='+localStorage[_0x5d5599(0x1a8)](_0x5d5599(0x1f7))+_0x5d5599(0x1cb)}),_0x1a9926=await _0x2789ac[_0x5d5599(0x1db)]();if(!_0x1a9926[_0x5d5599(0x1ca)])return localStorage[_0x5d5599(0x1e2)]('accessToken',_0x1a9926[_0x5d5599(0x1d4)]),await lockNoti(_0x5d5599(0x1c4),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1a9926[_0x5d5599(0x1e5)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x59d261){console[_0x5d5599(0x1ca)](_0x5d5599(0x1c8),_0x59d261);}return![];}function a0_0x50f8(_0x33a6b3,_0x1a36a9){var _0x5ad242=a0_0x5ad2();return a0_0x50f8=function(_0x50f893,_0x5a6b6c){_0x50f893=_0x50f893-0x195;var _0x4cb47a=_0x5ad242[_0x50f893];return _0x4cb47a;},a0_0x50f8(_0x33a6b3,_0x1a36a9);}export async function dpUploadFile(_0x414760,_0x346574,_0x41262f){var _0x5b35fa=a0_0x2429c4;const _0x2fd333=localStorage[_0x5b35fa(0x1a8)](_0x5b35fa(0x1df));var _0x12b65e=JSON[_0x5b35fa(0x1a0)]({'autorename':!![],'mode':_0x5b35fa(0x1bd),'mute':!![],'strict_conflict':![],'path':'/'+_0x2fd333+'/'+_0x41262f+'/'+_0x414760}),_0x3e77fb=new Blob([_0x346574],{'type':'application/octet-stream'});for(var _0x48a8d4=0x0;_0x48a8d4<0x2;_0x48a8d4++){var _0x16a17f=await fetch(_0x5b35fa(0x1ed),{'method':_0x5b35fa(0x198),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5b35fa(0x1a8)](_0x5b35fa(0x197)),'Dropbox-API-Arg':_0x12b65e,'Content-Type':'application/octet-stream'},'body':_0x3e77fb});if(_0x16a17f['status']!=0xc8){if(_0x16a17f[_0x5b35fa(0x1b2)]==0x191){var _0x58e071=await dpRefreshToken();if(!_0x58e071)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5b35fa(0x1f6)+_0x16a17f['status'];}else{var _0x30697d=await _0x16a17f[_0x5b35fa(0x1db)]();return console['log'](_0x5b35fa(0x1b0),_0x414760),_0x30697d;}}return![];}export async function dpDownloadFile(_0x29fb13,_0x18729d){var _0x405610=a0_0x2429c4;const _0x420470=localStorage[_0x405610(0x1a8)](_0x405610(0x1df));var _0x3ffd88=JSON[_0x405610(0x1a0)]({'path':'/'+_0x420470+'/'+_0x18729d+'/'+_0x29fb13});for(var _0x387094=0x0;_0x387094<0x2;_0x387094++){var _0x3635d3=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x405610(0x198),'headers':{'Authorization':_0x405610(0x1f3)+localStorage[_0x405610(0x1a8)]('accessToken'),'Dropbox-API-Arg':_0x3ffd88}});if(_0x3635d3[_0x405610(0x1b2)]!=0xc8){if(_0x3635d3[_0x405610(0x1b2)]==0x191){var _0x535361=await dpRefreshToken();if(!_0x535361)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x405610(0x1a5)+_0x3635d3[_0x405610(0x1b2)];}const _0x2da870=new File([await _0x3635d3['blob']()],_0x29fb13);return console[_0x405610(0x1a3)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x2da870['name']),a0_0x2b2dc9['uploadFileInCloud'](_0x2da870,()=>{localStorageFile(),Module['FSSync']();}),_0x2da870;}return![];}document['addEventListener'](a0_0x2429c4(0x1b3),function(){var _0x2d0e14=a0_0x2429c4;dropboxRestore[_0x2d0e14(0x1c5)](_0x2d0e14(0x1e7),async function(){var _0x378907=_0x2d0e14;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4fd6a5=localStorage['getItem'](_0x378907(0x1df)),_0x491c6e=[_0x378907(0x1d5),_0x378907(0x1a1),_0x378907(0x1c3)];if(!_0x4fd6a5){window['alert'](_0x378907(0x1de));return;}let _0xd5b009=[];for(const _0x29807c of _0x491c6e){let _0x457f8a={'path':'/'+_0x4fd6a5+'/'+_0x29807c};for(let _0x283c9f=0x0;_0x283c9f<0x2;_0x283c9f++){let _0x202229=await fetch(_0x378907(0x1a7),{'method':_0x378907(0x198),'headers':{'Authorization':_0x378907(0x1f3)+localStorage[_0x378907(0x1a8)](_0x378907(0x197)),'Content-Type':_0x378907(0x1b8)},'body':JSON[_0x378907(0x1a0)](_0x457f8a)});if(_0x202229[_0x378907(0x1b2)]===0xc8){let _0x3a487c=await _0x202229[_0x378907(0x1db)](),_0x47a680=_0x3a487c[_0x378907(0x1f1)][_0x378907(0x1f0)](_0x1fb553=>_0x1fb553[_0x378907(0x1bc)]===_0x378907(0x1e0));_0x47a680['length']>0x0&&_0xd5b009['push'](..._0x47a680[_0x378907(0x1a2)](_0x26a84e=>({'name':_0x26a84e[_0x378907(0x1d1)],'folder':_0x29807c})));break;}else{if(_0x202229[_0x378907(0x1b2)]===0x191){let _0xc29a7c=await dpRefreshToken();if(!_0xc29a7c)throw'Unable\x20to\x20refresh\x20token';}else{console['error'](_0x378907(0x1d9)+_0x29807c+_0x378907(0x1b6)+_0x202229['status']);break;}}}}if(_0xd5b009[_0x378907(0x1c9)]>0x0){const _0x45c3c5='Do\x20you\x20want\x20to\x20restore\x20'+_0xd5b009['length']+'\x20files\x20from\x20Cloud?';if(window[_0x378907(0x195)](_0x45c3c5))for(const _0x50194d of _0xd5b009){await lockNoti(_0x378907(0x1be),_0x50194d['name'],0xbb8),await dpDownloadFile(_0x50194d[_0x378907(0x1d1)],_0x50194d[_0x378907(0x1b4)]);}else console[_0x378907(0x1a3)](_0x378907(0x1da));}else console[_0x378907(0x1a3)](_0x378907(0x1ce));}),dropboxBackup[_0x2d0e14(0x1c5)]('click',async function(){var _0x14d02f=_0x2d0e14;await lockNoti(_0x14d02f(0x1a6),'',0x1388);const _0xa8a19c=localStorage[_0x14d02f(0x1a8)](_0x14d02f(0x1df));if(_0xa8a19c===null||_0xa8a19c==='')window[_0x14d02f(0x1c0)]('Cloud\x20login\x20required!');else{const _0x4b54b3=['state','save',_0x14d02f(0x1c3)];for(const _0x3ad715 of _0x4b54b3){await dpCreateFolder(_0x3ad715);}let _0x5254ea=0x0;for(const _0x17b19e of _0x4b54b3){const _0xee9593=a0_0x2b2dc9[_0x14d02f(0x1cf)+(_0x17b19e['charAt'](0x0)['toUpperCase']()+_0x17b19e[_0x14d02f(0x1b7)](0x1))]();_0x5254ea+=_0xee9593['length'];}if(window['confirm'](_0x14d02f(0x1eb)+_0x5254ea+'\x20files\x20in\x20Kabu?'))for(const _0x1414f4 of _0x4b54b3){const _0x5bc212=a0_0x2b2dc9[_0x14d02f(0x1cf)+(_0x1414f4[_0x14d02f(0x1ef)](0x0)[_0x14d02f(0x1cc)]()+_0x1414f4[_0x14d02f(0x1b7)](0x1))]();for(const _0x3aeee4 of _0x5bc212){const _0x280b43=await a0_0x2b2dc9['downloadFileInCloud']('/data/'+_0x1414f4+'s/'+_0x3aeee4);try{await lockNoti('Backing\x20up...',_0x3aeee4,0xbb8),await dpUploadFile(_0x3aeee4,_0x280b43,_0x1414f4);}catch(_0x63e8d2){console[_0x14d02f(0x1ca)](_0x14d02f(0x1bf)+_0x3aeee4+':',_0x63e8d2);}}}else console[_0x14d02f(0x1a3)](_0x14d02f(0x1da));}}),dropboxCloud[_0x2d0e14(0x1c5)]('click',function(){var _0x5a57c0=_0x2d0e14;const _0x2bc927=localStorage['getItem']('uId');_0x2bc927===null||_0x2bc927===''?authorizeWithDropbox():window['confirm'](_0x5a57c0(0x1ee))&&(localStorage[_0x5a57c0(0x1e2)](_0x5a57c0(0x1df),''),dropboxRestore[_0x5a57c0(0x1c6)][_0x5a57c0(0x1ab)](_0x5a57c0(0x1ac)),dropboxBackup[_0x5a57c0(0x1c6)]['remove'](_0x5a57c0(0x1ac)),dropboxCloud[_0x5a57c0(0x1c6)]['remove']('active'));}),handleDropboxCallback();});