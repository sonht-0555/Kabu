var a0_0x3a6d65=a0_0xf9c4;(function(_0x22aa6b,_0x505ea6){var _0xe732cc=a0_0xf9c4,_0x1fbe22=_0x22aa6b();while(!![]){try{var _0x1a905=parseInt(_0xe732cc(0x18b))/0x1*(parseInt(_0xe732cc(0x14b))/0x2)+parseInt(_0xe732cc(0x15e))/0x3*(-parseInt(_0xe732cc(0x171))/0x4)+-parseInt(_0xe732cc(0x177))/0x5*(parseInt(_0xe732cc(0x13f))/0x6)+-parseInt(_0xe732cc(0x19b))/0x7*(parseInt(_0xe732cc(0x14d))/0x8)+parseInt(_0xe732cc(0x187))/0x9+parseInt(_0xe732cc(0x15a))/0xa*(parseInt(_0xe732cc(0x13b))/0xb)+parseInt(_0xe732cc(0x16d))/0xc;if(_0x1a905===_0x505ea6)break;else _0x1fbe22['push'](_0x1fbe22['shift']());}catch(_0x472a65){_0x1fbe22['push'](_0x1fbe22['shift']());}}}(a0_0x248a,0xc93aa));import*as a0_0x26807d from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x248a(){var _0x1beb49=['remove','status','.tag','2ZZXvtf','/data/','48dqziXH','Error\x20while\x20refreshing\x20token:','Folder\x20created','Do\x20you\x20want\x20to\x20restore\x20','state','folder','split','Authorization\x20Code:','active','\x20files\x20from\x20Cloud?','No\x20files\x20found\x20to\x20restore.','setItem','refreshToken','187390KOUGGf','location','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','code','935688HKUnLj','Download\x20failed\x20for\x20','open','https://api.dropboxapi.com/oauth2/token','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://api.dropboxapi.com/2/files/create_folder_v2','charAt','application/x-www-form-urlencoded','uId','map','=([^&#]*)','&client_secret=','https://content.dropboxapi.com/2/files/upload','slice','Failed\x20to\x20upload\x20file\x20','4172064bBDQCV','responseText','list','Cloud\x20login\x20required!','4EweNIG','search','&client_id=','Restore\x20canceled\x20by\x20user.','length','\x20files\x20in\x20Kabu?','5eAeULp','offline','log','save','https://api.dropboxapi.com/2/files/list_folder','filter','refresh_token','Refreshing\x20token...','Unable\x20to\x20refresh\x20token','&token_access_type=','Restoring...','Error\x20creating\x20folder\x20','Do\x20you\x20want\x20to\x20logout?','application/json','href','knh3uz2mx2hp2eu','13519935FlLzjP','https://www.dropbox.com/oauth2/authorize?client_id=','name','accessToken','1277021cxbtXI','overwrite','code=','stringify','click','POST','classList','uploadFileInCloud','access_token','Bearer\x20','Wait\x20a\x20little\x20bit...','error','refresh_token=','alert','addEventListener','application/octet-stream','1837388XcbHJc','Download\x20failed,\x20unknown\x20http\x20status:','toUpperCase','Kabu\x20storage\x20↦\x20Cloud\x20◆','authorization_code','&grant_type=','json','&redirect_uri=','319kBTnrN','Folder\x20already\x20exists','getItem','screenshot','5755830UrrdKO','replace','push','entries','error_description','file','confirm','No\x20refresh\x20token','https://content.dropboxapi.com/2/files/download'];a0_0x248a=function(){return _0x1beb49;};return a0_0x248a();}var clientId=a0_0x3a6d65(0x186),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x1609f6=a0_0x3a6d65,_0x4142c2=window[_0x1609f6(0x15b)][_0x1609f6(0x185)][_0x1609f6(0x153)]('?')[0x0],_0x3fcf9e=_0x1609f6(0x15d),_0x3f62ca=_0x1609f6(0x178),_0x4c4137=_0x1609f6(0x188)+clientId+'&response_type='+_0x3fcf9e+_0x1609f6(0x180)+_0x3f62ca+_0x1609f6(0x13a)+encodeURIComponent(_0x4142c2);window[_0x1609f6(0x15b)]['href']=_0x4c4137;}function handleDropboxCallback(){var _0x5eb726=a0_0x3a6d65,_0x532b52=getUrlParameter(_0x5eb726(0x15d));_0x532b52?(getAccessToken(_0x532b52),console[_0x5eb726(0x179)](_0x5eb726(0x154),_0x532b52)):console[_0x5eb726(0x179)]('Do\x20not\x20receive\x20authorization');}function a0_0xf9c4(_0x556cd2,_0x559f65){var _0x248aa2=a0_0x248a();return a0_0xf9c4=function(_0xf9c41,_0x783478){_0xf9c41=_0xf9c41-0x136;var _0x47a4ba=_0x248aa2[_0xf9c41];return _0x47a4ba;},a0_0xf9c4(_0x556cd2,_0x559f65);}function getUrlParameter(_0x18d877){var _0x21333a=a0_0x3a6d65;_0x18d877=_0x18d877[_0x21333a(0x140)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x59e763=new RegExp('[\x5c?&#]'+_0x18d877+_0x21333a(0x168)),_0x24332d=_0x59e763['exec'](location[_0x21333a(0x172)]);return _0x24332d===null?'':decodeURIComponent(_0x24332d[0x1][_0x21333a(0x140)](/\+/g,'\x20'));}function getAccessToken(_0x5ab14f){var _0xd070ac=a0_0x3a6d65,_0xaebc88=_0xd070ac(0x137),_0x37b1e2=window[_0xd070ac(0x15b)][_0xd070ac(0x185)][_0xd070ac(0x153)]('?')[0x0],_0x40bc2b=new XMLHttpRequest();_0x40bc2b[_0xd070ac(0x160)]('POST','https://api.dropbox.com/oauth2/token'),_0x40bc2b['setRequestHeader']('Content-Type',_0xd070ac(0x165)),_0x40bc2b['onload']=function(){var _0x43a25d=_0xd070ac;if(_0x40bc2b[_0x43a25d(0x149)]===0xc8){var _0x2fb658=JSON['parse'](_0x40bc2b[_0x43a25d(0x16e)]),_0x1742df=_0x2fb658[_0x43a25d(0x193)],_0x1e52f4=_0x2fb658[_0x43a25d(0x17d)],_0x22351a=_0x2fb658['uid'];localStorage[_0x43a25d(0x158)](_0x43a25d(0x18a),_0x1742df),localStorage[_0x43a25d(0x158)](_0x43a25d(0x159),_0x1e52f4),localStorage[_0x43a25d(0x158)](_0x43a25d(0x166),_0x22351a);}else console[_0x43a25d(0x179)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x40bc2b['send'](_0xd070ac(0x18d)+_0x5ab14f+_0xd070ac(0x138)+_0xaebc88+_0xd070ac(0x173)+clientId+_0xd070ac(0x169)+clientSecret+_0xd070ac(0x13a)+encodeURIComponent(_0x37b1e2));}export async function dpCreateFolder(_0x4046e0){var _0x434e35=a0_0x3a6d65;const _0x35c281=localStorage[_0x434e35(0x13d)]('uId');let _0x5d1afb=localStorage[_0x434e35(0x13d)](_0x434e35(0x18a));const _0x580e06='/'+_0x35c281+'/'+_0x4046e0,_0x108a87=JSON['stringify']({'path':_0x580e06,'autorename':![]});for(let _0x2a2866=0x0;_0x2a2866<0x2;_0x2a2866++){try{const _0x1f19b4=await fetch(_0x434e35(0x163),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x5d1afb,'Content-Type':_0x434e35(0x184)},'body':_0x108a87});if(_0x1f19b4[_0x434e35(0x149)]===0x191){const _0x245821=await dpRefreshToken();if(!_0x245821)throw new Error(_0x434e35(0x17f));_0x5d1afb=localStorage[_0x434e35(0x13d)]('accessToken');continue;}if(_0x1f19b4[_0x434e35(0x149)]===0x199)return{'message':_0x434e35(0x13c),'path':_0x4046e0};if(!_0x1f19b4['ok'])throw new Error(_0x434e35(0x182)+_0x4046e0);const _0xa22b05=await _0x1f19b4[_0x434e35(0x139)]();return await lockNoti(_0x434e35(0x14f),'',0xbb8),_0xa22b05;}catch(_0x2fdbf3){if(_0x2a2866===0x1)throw _0x2fdbf3;}}return![];}export async function dpRefreshToken(){var _0xe60e23=a0_0x3a6d65;if(!localStorage[_0xe60e23(0x13d)](_0xe60e23(0x159)))throw _0xe60e23(0x146);try{const _0x3e6a13=await fetch(_0xe60e23(0x161),{'method':_0xe60e23(0x190),'headers':{'Content-Type':_0xe60e23(0x165)},'body':_0xe60e23(0x197)+localStorage[_0xe60e23(0x13d)](_0xe60e23(0x159))+_0xe60e23(0x15c)}),_0x466d8a=await _0x3e6a13['json']();if(!_0x466d8a[_0xe60e23(0x196)])return localStorage[_0xe60e23(0x158)]('accessToken',_0x466d8a['access_token']),await lockNoti(_0xe60e23(0x17e),'',0xbb8),await delay(0x3e8),!![];else alert(_0x466d8a[_0xe60e23(0x143)]||_0xe60e23(0x162));}catch(_0x1218d4){console['error'](_0xe60e23(0x14e),_0x1218d4);}return![];}export async function dpUploadFile(_0x17b6cd,_0x3aefbf,_0x1b2717){var _0x5873d6=a0_0x3a6d65;const _0x33a842=localStorage['getItem'](_0x5873d6(0x166));var _0x4ca90a=JSON[_0x5873d6(0x18e)]({'autorename':!![],'mode':_0x5873d6(0x18c),'mute':!![],'strict_conflict':![],'path':'/'+_0x33a842+'/'+_0x1b2717+'/'+_0x17b6cd}),_0x5bcfe9=new Blob([_0x3aefbf],{'type':_0x5873d6(0x19a)});for(var _0xc5a102=0x0;_0xc5a102<0x2;_0xc5a102++){var _0x181af7=await fetch(_0x5873d6(0x16a),{'method':_0x5873d6(0x190),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5873d6(0x13d)]('accessToken'),'Dropbox-API-Arg':_0x4ca90a,'Content-Type':'application/octet-stream'},'body':_0x5bcfe9});if(_0x181af7['status']!=0xc8){if(_0x181af7[_0x5873d6(0x149)]==0x191){var _0x3cd15d=await dpRefreshToken();if(!_0x3cd15d)throw _0x5873d6(0x17f);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x181af7['status'];}else{var _0x4bf257=await _0x181af7['json']();return console[_0x5873d6(0x179)](_0x5873d6(0x136),_0x17b6cd),_0x4bf257;}}return![];}export async function dpDownloadFile(_0x34ce60,_0x219c53){var _0x1c01f0=a0_0x3a6d65;const _0x4e7672=localStorage['getItem'](_0x1c01f0(0x166));var _0x4dc5f9=JSON['stringify']({'path':'/'+_0x4e7672+'/'+_0x219c53+'/'+_0x34ce60});for(var _0x46e555=0x0;_0x46e555<0x2;_0x46e555++){var _0x500820=await fetch(_0x1c01f0(0x147),{'method':_0x1c01f0(0x190),'headers':{'Authorization':_0x1c01f0(0x194)+localStorage[_0x1c01f0(0x13d)]('accessToken'),'Dropbox-API-Arg':_0x4dc5f9}});if(_0x500820[_0x1c01f0(0x149)]!=0xc8){if(_0x500820[_0x1c01f0(0x149)]==0x191){var _0x34986a=await dpRefreshToken();if(!_0x34986a)throw _0x1c01f0(0x17f);continue;}else throw _0x1c01f0(0x19c)+_0x500820[_0x1c01f0(0x149)];}const _0x1b0c05=new File([await _0x500820['blob']()],_0x34ce60);return console[_0x1c01f0(0x179)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x1b0c05[_0x1c01f0(0x189)]),a0_0x26807d[_0x1c01f0(0x192)](_0x1b0c05,()=>{localStorageFile(),Module['FSSync']();}),_0x1b0c05;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x583f3b=a0_0x3a6d65;dropboxRestore[_0x583f3b(0x199)]('click',async function(){var _0x56e03e=_0x583f3b;await lockNoti(_0x56e03e(0x195),'',0x1388);const _0x26e14a=localStorage[_0x56e03e(0x13d)](_0x56e03e(0x166)),_0x565bcb=[_0x56e03e(0x151),_0x56e03e(0x17a),'screenshot'];if(!_0x26e14a){window[_0x56e03e(0x198)](_0x56e03e(0x170));return;}let _0x54d9e2=[];for(const _0x4e3e8d of _0x565bcb){let _0x4ad5a9={'path':'/'+_0x26e14a+'/'+_0x4e3e8d};for(let _0x2b671e=0x0;_0x2b671e<0x2;_0x2b671e++){let _0x11ba3d=await fetch(_0x56e03e(0x17b),{'method':_0x56e03e(0x190),'headers':{'Authorization':_0x56e03e(0x194)+localStorage[_0x56e03e(0x13d)](_0x56e03e(0x18a)),'Content-Type':'application/json'},'body':JSON[_0x56e03e(0x18e)](_0x4ad5a9)});if(_0x11ba3d[_0x56e03e(0x149)]===0xc8){let _0x223bc1=await _0x11ba3d[_0x56e03e(0x139)](),_0x215e57=_0x223bc1[_0x56e03e(0x142)][_0x56e03e(0x17c)](_0x5d2cb1=>_0x5d2cb1[_0x56e03e(0x14a)]===_0x56e03e(0x144));_0x215e57[_0x56e03e(0x175)]>0x0&&_0x54d9e2[_0x56e03e(0x141)](..._0x215e57[_0x56e03e(0x167)](_0x158901=>({'name':_0x158901[_0x56e03e(0x189)],'folder':_0x4e3e8d})));break;}else{if(_0x11ba3d[_0x56e03e(0x149)]===0x191){let _0x5babfa=await dpRefreshToken();if(!_0x5babfa)throw _0x56e03e(0x17f);}else{console[_0x56e03e(0x196)](_0x56e03e(0x15f)+_0x4e3e8d+',\x20status:\x20'+_0x11ba3d[_0x56e03e(0x149)]);break;}}}}if(_0x54d9e2[_0x56e03e(0x175)]>0x0){const _0xa3666b=_0x56e03e(0x150)+_0x54d9e2[_0x56e03e(0x175)]+_0x56e03e(0x156);if(window[_0x56e03e(0x145)](_0xa3666b))for(const _0x58a80e of _0x54d9e2){await lockNoti(_0x56e03e(0x181),_0x58a80e[_0x56e03e(0x189)],0xbb8),await dpDownloadFile(_0x58a80e[_0x56e03e(0x189)],_0x58a80e[_0x56e03e(0x152)]);}else console[_0x56e03e(0x179)](_0x56e03e(0x174));}else console[_0x56e03e(0x179)](_0x56e03e(0x157));}),dropboxBackup['addEventListener'](_0x583f3b(0x18f),async function(){var _0x36843a=_0x583f3b;await lockNoti(_0x36843a(0x195),'',0x1388);const _0x21d303=localStorage[_0x36843a(0x13d)](_0x36843a(0x166));if(_0x21d303===null||_0x21d303==='')window[_0x36843a(0x198)](_0x36843a(0x170));else{const _0x2d546e=[_0x36843a(0x151),'save',_0x36843a(0x13e)];for(const _0x40e095 of _0x2d546e){await dpCreateFolder(_0x40e095);}let _0x439f68=0x0;for(const _0x593a08 of _0x2d546e){const _0x4326ec=a0_0x26807d[_0x36843a(0x16f)+(_0x593a08['charAt'](0x0)[_0x36843a(0x19d)]()+_0x593a08[_0x36843a(0x16b)](0x1))]();_0x439f68+=_0x4326ec[_0x36843a(0x175)];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x439f68+_0x36843a(0x176)))for(const _0x87322 of _0x2d546e){const _0x12c822=a0_0x26807d['list'+(_0x87322[_0x36843a(0x164)](0x0)[_0x36843a(0x19d)]()+_0x87322[_0x36843a(0x16b)](0x1))]();for(const _0x5dff83 of _0x12c822){const _0x291d35=await a0_0x26807d['downloadFileInCloud'](_0x36843a(0x14c)+_0x87322+'s/'+_0x5dff83);try{await lockNoti('Backing\x20up...',_0x5dff83,0xbb8),await dpUploadFile(_0x5dff83,_0x291d35,_0x87322);}catch(_0x15c64d){console[_0x36843a(0x196)](_0x36843a(0x16c)+_0x5dff83+':',_0x15c64d);}}}else console[_0x36843a(0x179)](_0x36843a(0x174));}}),dropboxCloud[_0x583f3b(0x199)]('click',function(){var _0x577e3b=_0x583f3b;const _0x2a9a8a=localStorage[_0x577e3b(0x13d)](_0x577e3b(0x166));_0x2a9a8a===null||_0x2a9a8a===''?authorizeWithDropbox():window['confirm'](_0x577e3b(0x183))&&(localStorage[_0x577e3b(0x158)](_0x577e3b(0x166),''),dropboxRestore[_0x577e3b(0x191)][_0x577e3b(0x148)]('active'),dropboxBackup[_0x577e3b(0x191)][_0x577e3b(0x148)](_0x577e3b(0x155)),dropboxCloud[_0x577e3b(0x191)]['remove'](_0x577e3b(0x155)));}),handleDropboxCallback();});