var a0_0x242a29=a0_0x57fc;(function(_0x2d2ff4,_0x3a4890){var _0x3e58de=a0_0x57fc,_0x26da0a=_0x2d2ff4();while(!![]){try{var _0x217728=-parseInt(_0x3e58de(0x1ee))/0x1*(-parseInt(_0x3e58de(0x204))/0x2)+-parseInt(_0x3e58de(0x1de))/0x3+-parseInt(_0x3e58de(0x1df))/0x4+-parseInt(_0x3e58de(0x1b3))/0x5*(-parseInt(_0x3e58de(0x1f5))/0x6)+-parseInt(_0x3e58de(0x1da))/0x7*(parseInt(_0x3e58de(0x1bf))/0x8)+parseInt(_0x3e58de(0x203))/0x9+-parseInt(_0x3e58de(0x205))/0xa*(parseInt(_0x3e58de(0x1e8))/0xb);if(_0x217728===_0x3a4890)break;else _0x26da0a['push'](_0x26da0a['shift']());}catch(_0x1f6da1){_0x26da0a['push'](_0x26da0a['shift']());}}}(a0_0x29f1,0x58391));import*as a0_0x3e80f6 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x57fc(_0xd7aab7,_0x189da1){var _0x29f16e=a0_0x29f1();return a0_0x57fc=function(_0x57fce6,_0x9d2f84){_0x57fce6=_0x57fce6-0x1b0;var _0x4ebfd6=_0x29f16e[_0x57fce6];return _0x4ebfd6;},a0_0x57fc(_0xd7aab7,_0x189da1);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x242a29(0x1c8);function authorizeWithDropbox(){var _0x59e4ba=a0_0x242a29,_0x58386c=window['location']['href'][_0x59e4ba(0x20f)]('?')[0x0],_0x293207=_0x59e4ba(0x20c),_0x237fca=_0x59e4ba(0x1ec),_0x1f0224=_0x59e4ba(0x1c3)+clientId+_0x59e4ba(0x1ff)+_0x293207+_0x59e4ba(0x1e0)+_0x237fca+_0x59e4ba(0x1f6)+encodeURIComponent(_0x58386c);window[_0x59e4ba(0x1bd)][_0x59e4ba(0x207)]=_0x1f0224;}function handleDropboxCallback(){var _0x5a7f70=a0_0x242a29,_0x182558=getUrlParameter(_0x5a7f70(0x20c));_0x182558?(getAccessToken(_0x182558),console[_0x5a7f70(0x1e7)](_0x5a7f70(0x1bc),_0x182558)):console['log'](_0x5a7f70(0x1e3));}function a0_0x29f1(){var _0x414abf=['uploadFileInCloud','Unable\x20to\x20refresh\x20token','code','application/x-www-form-urlencoded','Error\x20creating\x20folder\x20','split','https://api.dropboxapi.com/2/files/create_folder_v2','application/json','addEventListener','Download\x20failed\x20for\x20','confirm','Cloud\x20↦\x20Kabu\x20storage\x20◆','40YdamPj','https://api.dropboxapi.com/oauth2/token','Wait\x20a\x20little\x20bit...','save','https://api.dropbox.com/oauth2/token','Restoring...','=([^&#]*)','Backing\x20up...',',\x20status:\x20','Authorization\x20Code:','location','Do\x20you\x20want\x20to\x20restore\x20','8zBZSqe','remove','name','Bearer\x20','https://www.dropbox.com/oauth2/authorize?client_id=','alert','classList','refreshToken','Do\x20you\x20want\x20to\x20logout?','nwb3dnfh09rhs31','map','error','entries','folder','json','uid','Refreshing\x20token...','Cloud\x20login\x20required!','\x20files\x20in\x20Kabu?','state','search','accessToken','No\x20files\x20found\x20to\x20restore.','Failed\x20to\x20upload\x20file\x20','length','[\x5c?&#]','&client_secret=','935816qpQyyy','active','Content-Type','blob','751971fmXvLr','587148OIpEmI','&token_access_type=','overwrite','getItem','Do\x20not\x20receive\x20authorization','status','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','application/octet-stream','log','33NWtAdS','\x20files\x20from\x20Cloud?','Restore\x20canceled\x20by\x20user.','setRequestHeader','offline','filter','9267tDfNpm','Failed\x20to\x20refresh\x20Dropbox\x20token.','stringify','onload','Upload\x20failed,\x20unknown\x20http\x20status:\x20','access_token','screenshot','350418xHxCeT','&redirect_uri=','Do\x20you\x20want\x20to\x20backup\x20','https://content.dropboxapi.com/2/files/download','POST','https://api.dropboxapi.com/2/files/list_folder','Error\x20while\x20refreshing\x20token:','replace','Kabu\x20storage\x20↦\x20Cloud\x20◆','uId','&response_type=','refresh_token=','setItem','&client_id=','1037025TDxCtl','130FYfwrD','974370IInaGI','https://content.dropboxapi.com/2/files/upload','href','open','code='];a0_0x29f1=function(){return _0x414abf;};return a0_0x29f1();}function getUrlParameter(_0xe50918){var _0x2e3966=a0_0x242a29;_0xe50918=_0xe50918[_0x2e3966(0x1fc)](/[\[]/,'\x5c[')[_0x2e3966(0x1fc)](/[\]]/,'\x5c]');var _0x360c69=new RegExp(_0x2e3966(0x1d8)+_0xe50918+_0x2e3966(0x1b9)),_0x1784ed=_0x360c69['exec'](location[_0x2e3966(0x1d3)]);return _0x1784ed===null?'':decodeURIComponent(_0x1784ed[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0xcb54cf){var _0x23c555=a0_0x242a29,_0x19e4c4='authorization_code',_0x4af228=window[_0x23c555(0x1bd)][_0x23c555(0x207)][_0x23c555(0x20f)]('?')[0x0],_0x233912=new XMLHttpRequest();_0x233912[_0x23c555(0x208)](_0x23c555(0x1f9),_0x23c555(0x1b7)),_0x233912[_0x23c555(0x1eb)](_0x23c555(0x1dc),_0x23c555(0x20d)),_0x233912[_0x23c555(0x1f1)]=function(){var _0x3b9c45=_0x23c555;if(_0x233912['status']===0xc8){var _0x4c584d=JSON['parse'](_0x233912['responseText']),_0x43965b=_0x4c584d[_0x3b9c45(0x1f3)],_0x2de131=_0x4c584d['refresh_token'],_0x75a880=_0x4c584d[_0x3b9c45(0x1ce)];localStorage['setItem']('accessToken',_0x43965b),localStorage[_0x3b9c45(0x201)](_0x3b9c45(0x1c6),_0x2de131),localStorage[_0x3b9c45(0x201)](_0x3b9c45(0x1fe),_0x75a880);}else console[_0x3b9c45(0x1e7)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x233912['send'](_0x23c555(0x209)+_0xcb54cf+'&grant_type='+_0x19e4c4+_0x23c555(0x202)+clientId+_0x23c555(0x1d9)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4af228));}export async function dpCreateFolder(_0x358c65){var _0x477c32=a0_0x242a29;const _0xea3d66=localStorage[_0x477c32(0x1e2)](_0x477c32(0x1fe));let _0x5277c6=localStorage['getItem'](_0x477c32(0x1d4));const _0x3a13be='/'+_0xea3d66+'/'+_0x358c65,_0x2116fd=JSON[_0x477c32(0x1f0)]({'path':_0x3a13be,'autorename':![]});for(let _0x118047=0x0;_0x118047<0x2;_0x118047++){try{const _0x1b5709=await fetch(_0x477c32(0x210),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x5277c6,'Content-Type':_0x477c32(0x211)},'body':_0x2116fd});if(_0x1b5709[_0x477c32(0x1e4)]===0x191){const _0x46339a=await dpRefreshToken();if(!_0x46339a)throw new Error(_0x477c32(0x20b));_0x5277c6=localStorage['getItem'](_0x477c32(0x1d4));continue;}if(_0x1b5709[_0x477c32(0x1e4)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x358c65};if(!_0x1b5709['ok'])throw new Error(_0x477c32(0x20e)+_0x358c65);const _0x40f9c5=await _0x1b5709[_0x477c32(0x1cd)]();return await lockNoti('Folder\x20created','',0xbb8),_0x40f9c5;}catch(_0x15711c){if(_0x118047===0x1)throw _0x15711c;}}return![];}export async function dpRefreshToken(){var _0x3228e4=a0_0x242a29;if(!localStorage[_0x3228e4(0x1e2)](_0x3228e4(0x1c6)))throw'No\x20refresh\x20token';try{const _0x5aa7bd=await fetch(_0x3228e4(0x1b4),{'method':_0x3228e4(0x1f9),'headers':{'Content-Type':_0x3228e4(0x20d)},'body':_0x3228e4(0x200)+localStorage['getItem']('refreshToken')+_0x3228e4(0x1e5)}),_0x693cd5=await _0x5aa7bd[_0x3228e4(0x1cd)]();if(!_0x693cd5[_0x3228e4(0x1ca)])return localStorage['setItem'](_0x3228e4(0x1d4),_0x693cd5[_0x3228e4(0x1f3)]),await lockNoti(_0x3228e4(0x1cf),'',0xbb8),await delay(0x3e8),!![];else alert(_0x693cd5['error_description']||_0x3228e4(0x1ef));}catch(_0x13adc5){console[_0x3228e4(0x1ca)](_0x3228e4(0x1fb),_0x13adc5);}return![];}export async function dpUploadFile(_0x53fe2c,_0x30ca2c,_0x4d4e31){var _0x5ecff3=a0_0x242a29;const _0x5366c1=localStorage[_0x5ecff3(0x1e2)](_0x5ecff3(0x1fe));var _0x4b2033=JSON[_0x5ecff3(0x1f0)]({'autorename':!![],'mode':_0x5ecff3(0x1e1),'mute':!![],'strict_conflict':![],'path':'/'+_0x5366c1+'/'+_0x4d4e31+'/'+_0x53fe2c}),_0xf72035=new Blob([_0x30ca2c],{'type':_0x5ecff3(0x1e6)});for(var _0x4e319a=0x0;_0x4e319a<0x2;_0x4e319a++){var _0xd948f1=await fetch(_0x5ecff3(0x206),{'method':_0x5ecff3(0x1f9),'headers':{'Authorization':_0x5ecff3(0x1c2)+localStorage[_0x5ecff3(0x1e2)](_0x5ecff3(0x1d4)),'Dropbox-API-Arg':_0x4b2033,'Content-Type':'application/octet-stream'},'body':_0xf72035});if(_0xd948f1[_0x5ecff3(0x1e4)]!=0xc8){if(_0xd948f1['status']==0x191){var _0x372329=await dpRefreshToken();if(!_0x372329)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5ecff3(0x1f2)+_0xd948f1[_0x5ecff3(0x1e4)];}else{var _0x6b0e84=await _0xd948f1['json']();return console[_0x5ecff3(0x1e7)](_0x5ecff3(0x1fd),_0x53fe2c),_0x6b0e84;}}return![];}export async function dpDownloadFile(_0x32925e,_0x43ec6a){var _0x52d41f=a0_0x242a29;const _0x155baf=localStorage['getItem'](_0x52d41f(0x1fe));var _0x4396cf=JSON[_0x52d41f(0x1f0)]({'path':'/'+_0x155baf+'/'+_0x43ec6a+'/'+_0x32925e});for(var _0x46d36c=0x0;_0x46d36c<0x2;_0x46d36c++){var _0x11734b=await fetch(_0x52d41f(0x1f8),{'method':_0x52d41f(0x1f9),'headers':{'Authorization':_0x52d41f(0x1c2)+localStorage[_0x52d41f(0x1e2)](_0x52d41f(0x1d4)),'Dropbox-API-Arg':_0x4396cf}});if(_0x11734b[_0x52d41f(0x1e4)]!=0xc8){if(_0x11734b['status']==0x191){var _0x35b259=await dpRefreshToken();if(!_0x35b259)throw _0x52d41f(0x20b);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x11734b[_0x52d41f(0x1e4)];}const _0x35cd87=new File([await _0x11734b[_0x52d41f(0x1dd)]()],_0x32925e);return console['log'](_0x52d41f(0x1b2),_0x35cd87[_0x52d41f(0x1c1)]),a0_0x3e80f6[_0x52d41f(0x20a)](_0x35cd87,()=>{}),_0x35cd87;}return![];}document[a0_0x242a29(0x212)]('DOMContentLoaded',function(){var _0x4576c5=a0_0x242a29;dropboxRestore[_0x4576c5(0x212)]('click',async function(){var _0x527de4=_0x4576c5;await lockNoti(_0x527de4(0x1b5),'',0x1388);const _0x1f01eb=localStorage[_0x527de4(0x1e2)](_0x527de4(0x1fe)),_0x25655d=[_0x527de4(0x1d2),_0x527de4(0x1b6),_0x527de4(0x1f4)];if(!_0x1f01eb){window[_0x527de4(0x1c4)]('Cloud\x20login\x20required!');return;}let _0x22b2ad=[];for(const _0x1d910d of _0x25655d){let _0x21f37b={'path':'/'+_0x1f01eb+'/'+_0x1d910d};for(let _0x125402=0x0;_0x125402<0x2;_0x125402++){let _0x339a15=await fetch(_0x527de4(0x1fa),{'method':_0x527de4(0x1f9),'headers':{'Authorization':_0x527de4(0x1c2)+localStorage['getItem'](_0x527de4(0x1d4)),'Content-Type':_0x527de4(0x211)},'body':JSON[_0x527de4(0x1f0)](_0x21f37b)});if(_0x339a15[_0x527de4(0x1e4)]===0xc8){let _0x214695=await _0x339a15['json'](),_0x7d2cb7=_0x214695[_0x527de4(0x1cb)][_0x527de4(0x1ed)](_0x5b618c=>_0x5b618c['.tag']==='file');_0x7d2cb7['length']>0x0&&_0x22b2ad['push'](..._0x7d2cb7[_0x527de4(0x1c9)](_0x9ab08e=>({'name':_0x9ab08e[_0x527de4(0x1c1)],'folder':_0x1d910d})));break;}else{if(_0x339a15[_0x527de4(0x1e4)]===0x191){let _0x59b83f=await dpRefreshToken();if(!_0x59b83f)throw _0x527de4(0x20b);}else{console[_0x527de4(0x1ca)](_0x527de4(0x1b0)+_0x1d910d+_0x527de4(0x1bb)+_0x339a15[_0x527de4(0x1e4)]);break;}}}}if(_0x22b2ad['length']>0x0){const _0x101712=_0x527de4(0x1be)+_0x22b2ad['length']+_0x527de4(0x1e9);if(window[_0x527de4(0x1b1)](_0x101712))for(const _0x5c2c4a of _0x22b2ad){await lockNoti(_0x527de4(0x1b8),_0x5c2c4a[_0x527de4(0x1c1)],0xbb8),await dpDownloadFile(_0x5c2c4a[_0x527de4(0x1c1)],_0x5c2c4a[_0x527de4(0x1cc)]);}else console['log'](_0x527de4(0x1ea));}else console[_0x527de4(0x1e7)](_0x527de4(0x1d5));}),dropboxBackup[_0x4576c5(0x212)]('click',async function(){var _0x57c4d9=_0x4576c5;await lockNoti(_0x57c4d9(0x1b5),'',0x1388);const _0x19c3d8=localStorage[_0x57c4d9(0x1e2)](_0x57c4d9(0x1fe));if(_0x19c3d8===null||_0x19c3d8==='')window[_0x57c4d9(0x1c4)](_0x57c4d9(0x1d0));else{const _0x4658be=[_0x57c4d9(0x1d2),_0x57c4d9(0x1b6),_0x57c4d9(0x1f4)];for(const _0x15983e of _0x4658be){await dpCreateFolder(_0x15983e);}let _0x3b8626=0x0;for(const _0xa2436b of _0x4658be){const _0x3e7e2f=a0_0x3e80f6['listFiles'](_0xa2436b+'s');_0x3b8626+=_0x3e7e2f[_0x57c4d9(0x1d7)];}if(window[_0x57c4d9(0x1b1)](_0x57c4d9(0x1f7)+_0x3b8626+_0x57c4d9(0x1d1)))for(const _0x43985b of _0x4658be){const _0x1978e3=a0_0x3e80f6['listFiles'](_0x43985b+'s');for(const _0xceebb6 of _0x1978e3){const _0x1e3346=await a0_0x3e80f6['downloadFileInCloud']('/data/'+_0x43985b+'s/'+_0xceebb6);try{await lockNoti(_0x57c4d9(0x1ba),_0xceebb6,0xbb8),await dpUploadFile(_0xceebb6,_0x1e3346,_0x43985b);}catch(_0xd88b3d){console[_0x57c4d9(0x1ca)](_0x57c4d9(0x1d6)+_0xceebb6+':',_0xd88b3d);}}}else console[_0x57c4d9(0x1e7)](_0x57c4d9(0x1ea));}}),dropboxCloud[_0x4576c5(0x212)]('click',function(){var _0x3b08a0=_0x4576c5;const _0x45b67f=localStorage[_0x3b08a0(0x1e2)](_0x3b08a0(0x1fe));_0x45b67f===null||_0x45b67f===''?authorizeWithDropbox():window[_0x3b08a0(0x1b1)](_0x3b08a0(0x1c7))&&(localStorage[_0x3b08a0(0x201)]('uId',''),dropboxRestore[_0x3b08a0(0x1c5)]['remove']('active'),dropboxBackup[_0x3b08a0(0x1c5)][_0x3b08a0(0x1c0)](_0x3b08a0(0x1db)),dropboxCloud['classList'][_0x3b08a0(0x1c0)](_0x3b08a0(0x1db)));}),handleDropboxCallback();});