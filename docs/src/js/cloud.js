var a0_0x471909=a0_0x35a5;(function(_0x4c6951,_0x29d01b){var _0x22d029=a0_0x35a5,_0x545e18=_0x4c6951();while(!![]){try{var _0x38ef46=-parseInt(_0x22d029(0x15c))/0x1*(parseInt(_0x22d029(0x181))/0x2)+-parseInt(_0x22d029(0x185))/0x3+parseInt(_0x22d029(0x17c))/0x4+parseInt(_0x22d029(0x13e))/0x5*(-parseInt(_0x22d029(0x190))/0x6)+parseInt(_0x22d029(0x167))/0x7*(-parseInt(_0x22d029(0x16c))/0x8)+-parseInt(_0x22d029(0x153))/0x9*(parseInt(_0x22d029(0x171))/0xa)+parseInt(_0x22d029(0x183))/0xb;if(_0x38ef46===_0x29d01b)break;else _0x545e18['push'](_0x545e18['shift']());}catch(_0x239258){_0x545e18['push'](_0x545e18['shift']());}}}(a0_0xe4b0,0x68491));import*as a0_0x226f67 from'./main.js';function a0_0xe4b0(){var _0x3011ff=['Cloud\x20↦\x20Kabu\x20storage\x20◆','158978weLFEl','Error\x20while\x20refreshing\x20token:','32118515cErbZd','setRequestHeader','2525919fKoGDs','&token_access_type=','/data/','application/x-www-form-urlencoded','stringify','Folder\x20already\x20exists','application/octet-stream','remove','knh3uz2mx2hp2eu','https://api.dropboxapi.com/2/files/create_folder_v2','uid','12LuRvRM','replace','error_description','code','toUpperCase','overwrite','json','setItem','=([^&#]*)','Backing\x20up...','https://api.dropbox.com/oauth2/token','accessToken','save','Cloud\x20login\x20required!','screenshot','POST','access_token','Folder\x20created','Wait\x20a\x20little\x20bit...','Do\x20you\x20want\x20to\x20logout?','Do\x20you\x20want\x20to\x20restore\x20','Bearer\x20','2039960wslIsm','blob','offline','Do\x20you\x20want\x20to\x20backup\x20','code=','uploadFileInCloud','charAt','search','length','error','Refreshing\x20token...','Restore\x20canceled\x20by\x20user.','log','state','Download\x20failed,\x20unknown\x20http\x20status:','No\x20refresh\x20token','refresh_token','.tag','location','authorization_code','classList','9mATcTR','status','\x20files\x20from\x20Cloud?','onload','Error\x20creating\x20folder\x20','getItem','Content-Type','Unable\x20to\x20refresh\x20token','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','7vSHllG','send','DOMContentLoaded','&grant_type=','\x20files\x20in\x20Kabu?','No\x20files\x20found\x20to\x20restore.','Kabu\x20storage\x20↦\x20Cloud\x20◆','nwb3dnfh09rhs31','href','refresh_token=','uId','2933guzUfx','https://api.dropboxapi.com/oauth2/token','addEventListener','Upload\x20failed,\x20unknown\x20http\x20status:\x20','map','7192MohiXn','name','active','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','confirm','2780920RtQcQl','&client_secret=','https://www.dropbox.com/oauth2/authorize?client_id=','Restoring...','&response_type=','filter','Authorization\x20Code:','click','Download\x20failed\x20for\x20','refreshToken','application/json','1505764eLjTEK','alert','Do\x20not\x20receive\x20authorization','https://content.dropboxapi.com/2/files/download'];a0_0xe4b0=function(){return _0x3011ff;};return a0_0xe4b0();}import{localStorageFile}from'./storage.js';var clientId=a0_0x471909(0x18d),clientSecret=a0_0x471909(0x163);function authorizeWithDropbox(){var _0x1df7fa=a0_0x471909,_0xf68c3c=window[_0x1df7fa(0x150)]['href']['split']('?')[0x0],_0x5f30a0=_0x1df7fa(0x193),_0x44f9ce=_0x1df7fa(0x140),_0x5417cc=_0x1df7fa(0x173)+clientId+_0x1df7fa(0x175)+_0x5f30a0+_0x1df7fa(0x186)+_0x44f9ce+'&redirect_uri='+encodeURIComponent(_0xf68c3c);window[_0x1df7fa(0x150)][_0x1df7fa(0x164)]=_0x5417cc;}function handleDropboxCallback(){var _0x10a237=a0_0x471909,_0x326f4d=getUrlParameter(_0x10a237(0x193));_0x326f4d?(getAccessToken(_0x326f4d),console[_0x10a237(0x14a)](_0x10a237(0x177),_0x326f4d)):console[_0x10a237(0x14a)](_0x10a237(0x17e));}function getUrlParameter(_0x47e633){var _0x5c4cc0=a0_0x471909;_0x47e633=_0x47e633['replace'](/[\[]/,'\x5c[')[_0x5c4cc0(0x191)](/[\]]/,'\x5c]');var _0xd35b03=new RegExp('[\x5c?&#]'+_0x47e633+_0x5c4cc0(0x198)),_0x9cc4f8=_0xd35b03['exec'](location[_0x5c4cc0(0x145)]);return _0x9cc4f8===null?'':decodeURIComponent(_0x9cc4f8[0x1][_0x5c4cc0(0x191)](/\+/g,'\x20'));}function getAccessToken(_0x2e5ab5){var _0x51b628=a0_0x471909,_0x474f77=_0x51b628(0x151),_0x23a7e2=window[_0x51b628(0x150)][_0x51b628(0x164)]['split']('?')[0x0],_0x5662b6=new XMLHttpRequest();_0x5662b6['open'](_0x51b628(0x137),_0x51b628(0x19a)),_0x5662b6[_0x51b628(0x184)](_0x51b628(0x159),_0x51b628(0x188)),_0x5662b6[_0x51b628(0x156)]=function(){var _0x1a1f00=_0x51b628;if(_0x5662b6[_0x1a1f00(0x154)]===0xc8){var _0x14a073=JSON['parse'](_0x5662b6['responseText']),_0x5d3cb6=_0x14a073[_0x1a1f00(0x138)],_0x2ad210=_0x14a073[_0x1a1f00(0x14e)],_0x22f6cb=_0x14a073[_0x1a1f00(0x18f)];localStorage[_0x1a1f00(0x197)]('accessToken',_0x5d3cb6),localStorage[_0x1a1f00(0x197)]('refreshToken',_0x2ad210),localStorage[_0x1a1f00(0x197)]('uId',_0x22f6cb);}else console[_0x1a1f00(0x14a)](_0x1a1f00(0x15b));},_0x5662b6[_0x51b628(0x15d)](_0x51b628(0x142)+_0x2e5ab5+_0x51b628(0x15f)+_0x474f77+'&client_id='+clientId+_0x51b628(0x172)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x23a7e2));}export async function dpCreateFolder(_0x58c2cc){var _0x3138cd=a0_0x471909;const _0x1c94e3=localStorage[_0x3138cd(0x158)](_0x3138cd(0x166));let _0x41bb79=localStorage[_0x3138cd(0x158)](_0x3138cd(0x19b));const _0x349b75='/'+_0x1c94e3+'/'+_0x58c2cc,_0x4a7b2e=JSON[_0x3138cd(0x189)]({'path':_0x349b75,'autorename':![]});for(let _0x1ae81d=0x0;_0x1ae81d<0x2;_0x1ae81d++){try{const _0x59eeb7=await fetch(_0x3138cd(0x18e),{'method':_0x3138cd(0x137),'headers':{'Authorization':_0x3138cd(0x13d)+_0x41bb79,'Content-Type':_0x3138cd(0x17b)},'body':_0x4a7b2e});if(_0x59eeb7[_0x3138cd(0x154)]===0x191){const _0x4c21bc=await dpRefreshToken();if(!_0x4c21bc)throw new Error(_0x3138cd(0x15a));_0x41bb79=localStorage['getItem'](_0x3138cd(0x19b));continue;}if(_0x59eeb7[_0x3138cd(0x154)]===0x199)return{'message':_0x3138cd(0x18a),'path':_0x58c2cc};if(!_0x59eeb7['ok'])throw new Error(_0x3138cd(0x157)+_0x58c2cc);const _0x291f80=await _0x59eeb7['json']();return await lockNoti(_0x3138cd(0x139),'',0xbb8),_0x291f80;}catch(_0x1f325e){if(_0x1ae81d===0x1)throw _0x1f325e;}}return![];}export async function dpRefreshToken(){var _0x39d685=a0_0x471909;if(!localStorage[_0x39d685(0x158)](_0x39d685(0x17a)))throw _0x39d685(0x14d);try{const _0x570904=await fetch(_0x39d685(0x168),{'method':'POST','headers':{'Content-Type':_0x39d685(0x188)},'body':_0x39d685(0x165)+localStorage[_0x39d685(0x158)](_0x39d685(0x17a))+_0x39d685(0x16f)}),_0x2a400f=await _0x570904['json']();if(!_0x2a400f[_0x39d685(0x147)])return localStorage['setItem'](_0x39d685(0x19b),_0x2a400f[_0x39d685(0x138)]),await lockNoti(_0x39d685(0x148),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2a400f[_0x39d685(0x192)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x32972e){console[_0x39d685(0x147)](_0x39d685(0x182),_0x32972e);}return![];}function a0_0x35a5(_0x2441cd,_0xce2ac7){var _0xe4b09c=a0_0xe4b0();return a0_0x35a5=function(_0x35a536,_0x1e5fb2){_0x35a536=_0x35a536-0x136;var _0x12bac7=_0xe4b09c[_0x35a536];return _0x12bac7;},a0_0x35a5(_0x2441cd,_0xce2ac7);}export async function dpUploadFile(_0x596ed2,_0x246316,_0x20e676){var _0xd9fee0=a0_0x471909;const _0x258ec8=localStorage[_0xd9fee0(0x158)](_0xd9fee0(0x166));var _0x189e89=JSON['stringify']({'autorename':!![],'mode':_0xd9fee0(0x195),'mute':!![],'strict_conflict':![],'path':'/'+_0x258ec8+'/'+_0x20e676+'/'+_0x596ed2}),_0x2c9053=new Blob([_0x246316],{'type':_0xd9fee0(0x18b)});for(var _0x1c8792=0x0;_0x1c8792<0x2;_0x1c8792++){var _0x4a1dbb=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0xd9fee0(0x13d)+localStorage[_0xd9fee0(0x158)](_0xd9fee0(0x19b)),'Dropbox-API-Arg':_0x189e89,'Content-Type':_0xd9fee0(0x18b)},'body':_0x2c9053});if(_0x4a1dbb[_0xd9fee0(0x154)]!=0xc8){if(_0x4a1dbb[_0xd9fee0(0x154)]==0x191){var _0x8279e7=await dpRefreshToken();if(!_0x8279e7)throw _0xd9fee0(0x15a);continue;}else throw _0xd9fee0(0x16a)+_0x4a1dbb['status'];}else{var _0x42e93c=await _0x4a1dbb[_0xd9fee0(0x196)]();return console[_0xd9fee0(0x14a)](_0xd9fee0(0x162),_0x596ed2),_0x42e93c;}}return![];}export async function dpDownloadFile(_0x47c33f,_0xd6abf7){var _0x2e1ff0=a0_0x471909;const _0x34d5eb=localStorage[_0x2e1ff0(0x158)](_0x2e1ff0(0x166));var _0x1f65f2=JSON[_0x2e1ff0(0x189)]({'path':'/'+_0x34d5eb+'/'+_0xd6abf7+'/'+_0x47c33f});for(var _0x25c564=0x0;_0x25c564<0x2;_0x25c564++){var _0x636958=await fetch(_0x2e1ff0(0x17f),{'method':_0x2e1ff0(0x137),'headers':{'Authorization':_0x2e1ff0(0x13d)+localStorage[_0x2e1ff0(0x158)](_0x2e1ff0(0x19b)),'Dropbox-API-Arg':_0x1f65f2}});if(_0x636958[_0x2e1ff0(0x154)]!=0xc8){if(_0x636958['status']==0x191){var _0x1fb361=await dpRefreshToken();if(!_0x1fb361)throw _0x2e1ff0(0x15a);continue;}else throw _0x2e1ff0(0x14c)+_0x636958[_0x2e1ff0(0x154)];}const _0x1735e9=new File([await _0x636958[_0x2e1ff0(0x13f)]()],_0x47c33f);return console[_0x2e1ff0(0x14a)](_0x2e1ff0(0x180),_0x1735e9[_0x2e1ff0(0x16d)]),a0_0x226f67[_0x2e1ff0(0x143)](_0x1735e9,()=>{localStorageFile(),Module['FSSync']();}),_0x1735e9;}return![];}document[a0_0x471909(0x169)](a0_0x471909(0x15e),function(){var _0x1d776a=a0_0x471909;dropboxRestore[_0x1d776a(0x169)](_0x1d776a(0x178),async function(){var _0x5c0edc=_0x1d776a;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x4325d0=localStorage[_0x5c0edc(0x158)](_0x5c0edc(0x166)),_0x18057f=[_0x5c0edc(0x14b),_0x5c0edc(0x19c),_0x5c0edc(0x136)];if(!_0x4325d0){window[_0x5c0edc(0x17d)](_0x5c0edc(0x19d));return;}let _0x536599=[];for(const _0x2dfe63 of _0x18057f){let _0x925f70={'path':'/'+_0x4325d0+'/'+_0x2dfe63};for(let _0x42753d=0x0;_0x42753d<0x2;_0x42753d++){let _0x420873=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x5c0edc(0x13d)+localStorage[_0x5c0edc(0x158)]('accessToken'),'Content-Type':_0x5c0edc(0x17b)},'body':JSON[_0x5c0edc(0x189)](_0x925f70)});if(_0x420873[_0x5c0edc(0x154)]===0xc8){let _0x5ae7c5=await _0x420873['json'](),_0x1afae7=_0x5ae7c5['entries'][_0x5c0edc(0x176)](_0x2545ed=>_0x2545ed[_0x5c0edc(0x14f)]==='file');_0x1afae7['length']>0x0&&_0x536599['push'](..._0x1afae7[_0x5c0edc(0x16b)](_0x5babdf=>({'name':_0x5babdf[_0x5c0edc(0x16d)],'folder':_0x2dfe63})));break;}else{if(_0x420873[_0x5c0edc(0x154)]===0x191){let _0x41e85e=await dpRefreshToken();if(!_0x41e85e)throw _0x5c0edc(0x15a);}else{console['error'](_0x5c0edc(0x179)+_0x2dfe63+',\x20status:\x20'+_0x420873[_0x5c0edc(0x154)]);break;}}}}if(_0x536599['length']>0x0){const _0x57c3c4=_0x5c0edc(0x13c)+_0x536599[_0x5c0edc(0x146)]+_0x5c0edc(0x155);if(window['confirm'](_0x57c3c4))for(const _0x2cb7c8 of _0x536599){await lockNoti(_0x5c0edc(0x174),_0x2cb7c8['name'],0xbb8),await dpDownloadFile(_0x2cb7c8[_0x5c0edc(0x16d)],_0x2cb7c8['folder']);}else console[_0x5c0edc(0x14a)](_0x5c0edc(0x149));}else console['log'](_0x5c0edc(0x161));}),dropboxBackup[_0x1d776a(0x169)]('click',async function(){var _0x51ee04=_0x1d776a;await lockNoti(_0x51ee04(0x13a),'',0x1388);const _0x121b04=localStorage['getItem'](_0x51ee04(0x166));if(_0x121b04===null||_0x121b04==='')window['alert'](_0x51ee04(0x19d));else{const _0x49a4a4=[_0x51ee04(0x14b),_0x51ee04(0x19c),_0x51ee04(0x136)];for(const _0x4262d4 of _0x49a4a4){await dpCreateFolder(_0x4262d4);}let _0x34f875=0x0;for(const _0x15404c of _0x49a4a4){const _0x59b898=a0_0x226f67['list'+(_0x15404c[_0x51ee04(0x144)](0x0)['toUpperCase']()+_0x15404c['slice'](0x1))]();_0x34f875+=_0x59b898[_0x51ee04(0x146)];}if(window['confirm'](_0x51ee04(0x141)+_0x34f875+_0x51ee04(0x160)))for(const _0x44c1a8 of _0x49a4a4){const _0x1a2705=a0_0x226f67['list'+(_0x44c1a8['charAt'](0x0)[_0x51ee04(0x194)]()+_0x44c1a8['slice'](0x1))]();for(const _0x564ddc of _0x1a2705){const _0x2e595d=await a0_0x226f67['downloadFileInCloud'](_0x51ee04(0x187)+_0x44c1a8+'s/'+_0x564ddc);try{await lockNoti(_0x51ee04(0x199),_0x564ddc,0xbb8),await dpUploadFile(_0x564ddc,_0x2e595d,_0x44c1a8);}catch(_0x19567c){console[_0x51ee04(0x147)]('Failed\x20to\x20upload\x20file\x20'+_0x564ddc+':',_0x19567c);}}}else console[_0x51ee04(0x14a)](_0x51ee04(0x149));}}),dropboxCloud[_0x1d776a(0x169)](_0x1d776a(0x178),function(){var _0x1940ac=_0x1d776a;const _0x47435f=localStorage[_0x1940ac(0x158)](_0x1940ac(0x166));_0x47435f===null||_0x47435f===''?authorizeWithDropbox():window[_0x1940ac(0x170)](_0x1940ac(0x13b))&&(localStorage[_0x1940ac(0x197)](_0x1940ac(0x166),''),dropboxRestore[_0x1940ac(0x152)][_0x1940ac(0x18c)](_0x1940ac(0x16e)),dropboxBackup[_0x1940ac(0x152)]['remove'](_0x1940ac(0x16e)),dropboxCloud[_0x1940ac(0x152)][_0x1940ac(0x18c)](_0x1940ac(0x16e)));}),handleDropboxCallback();});