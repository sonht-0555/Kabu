var a0_0x52078a=a0_0xf4fd;(function(_0x17bcc4,_0x444ed){var _0x51cd0a=a0_0xf4fd,_0x5db690=_0x17bcc4();while(!![]){try{var _0x226062=-parseInt(_0x51cd0a(0x1b2))/0x1*(parseInt(_0x51cd0a(0x19e))/0x2)+parseInt(_0x51cd0a(0x188))/0x3+parseInt(_0x51cd0a(0x16b))/0x4*(-parseInt(_0x51cd0a(0x1a6))/0x5)+-parseInt(_0x51cd0a(0x194))/0x6+parseInt(_0x51cd0a(0x19a))/0x7+-parseInt(_0x51cd0a(0x19c))/0x8+parseInt(_0x51cd0a(0x17d))/0x9;if(_0x226062===_0x444ed)break;else _0x5db690['push'](_0x5db690['shift']());}catch(_0x331a6d){_0x5db690['push'](_0x5db690['shift']());}}}(a0_0x1655,0xb9f13));import*as a0_0xf637f1 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1655(){var _0x153dab=['length','setRequestHeader','endsWith','.ss2','.ss3','Content-Type','_dateState','toUpperCase','status','offline','Cloud\x20login\x20required!','https://www.dropbox.com/oauth2/authorize?client_id=','error','downloadFileInCloud','.gba_dateState','split','Backing\x20up...','code','Do\x20you\x20want\x20to\x20logout?','exec','json','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','refresh_token','DOMContentLoaded','Unable\x20to\x20refresh\x20token','FSSync','uploadSaveOrSaveState','slice','location','substring','Kabu\x20storage\x20↦\x20Cloud\x20◆','No\x20refresh\x20token','34708swZcHJ','access_token','filter','entries','responseText','Do\x20not\x20receive\x20authorization','.ss0','Restore\x20canceled\x20by\x20user.','.ss7','refreshToken','.ss1','&token_access_type=','charAt','blob','href','click','Restoring...','Cloud\x20↦\x20Kabu\x20storage\x20◆','11593485NAyjAV','\x20files\x20in\x20Kabu?','Error\x20while\x20refreshing\x20token:','overwrite','list','https://api.dropbox.com/oauth2/token','Authorization\x20Code:','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','_imageState','file','code=','1799676htZXjf','addEventListener','.txt','Download\x20failed,\x20unknown\x20http\x20status:','Do\x20you\x20want\x20to\x20backup\x20','&grant_type=','stringify','Download\x20failed,\x20unknown\x20http\x20status:\x20','replace','active','save','name','1248780cAnqZq','search','.ss6','&client_secret=','.tag','POST','7350679JqWYmt','getItem','2272960PIObfG','&redirect_uri=','214DRrgNi','\x20files\x20in\x20Cloud?','open','confirm','/data/','[\x5c?&#]','.ss5','parse','855wAfRaP','.gba_slot','classList','alert','&client_id=','authorization_code','Bearer\x20','Refreshing\x20token...','application/x-www-form-urlencoded','remove','accessToken','state','1874WOTVaJ','log','setItem','.gba_imageState','application/json','application/octet-stream','https://content.dropboxapi.com/2/files/upload','lastIndexOf','uId'];a0_0x1655=function(){return _0x153dab;};return a0_0x1655();}var clientId='knh3uz2mx2hp2eu',clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x3e9f11=a0_0xf4fd,_0x3218b7=window[_0x3e9f11(0x167)][_0x3e9f11(0x179)][_0x3e9f11(0x15a)]('?')[0x0],_0x33f371=_0x3e9f11(0x15c),_0x40c9a5=_0x3e9f11(0x154),_0x17194f=_0x3e9f11(0x156)+clientId+'&response_type='+_0x33f371+_0x3e9f11(0x176)+_0x40c9a5+'&redirect_uri='+encodeURIComponent(_0x3218b7);window[_0x3e9f11(0x167)]['href']=_0x17194f;}function handleDropboxCallback(){var _0x432d6e=a0_0xf4fd,_0x5d7dee=getUrlParameter(_0x432d6e(0x15c));_0x5d7dee?(getAccessToken(_0x5d7dee),console['log'](_0x432d6e(0x183),_0x5d7dee)):console[_0x432d6e(0x1b3)](_0x432d6e(0x170));}function getUrlParameter(_0x192ff2){var _0x37a8f2=a0_0xf4fd;_0x192ff2=_0x192ff2[_0x37a8f2(0x190)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x5e38b2=new RegExp(_0x37a8f2(0x1a3)+_0x192ff2+'=([^&#]*)'),_0x5f4a0b=_0x5e38b2[_0x37a8f2(0x15e)](location[_0x37a8f2(0x195)]);return _0x5f4a0b===null?'':decodeURIComponent(_0x5f4a0b[0x1][_0x37a8f2(0x190)](/\+/g,'\x20'));}function getAccessToken(_0x1870c0){var _0x26ea45=a0_0xf4fd,_0xcc623f=_0x26ea45(0x1ab),_0x3ab2b0=window[_0x26ea45(0x167)][_0x26ea45(0x179)]['split']('?')[0x0],_0x45f93c=new XMLHttpRequest();_0x45f93c[_0x26ea45(0x1a0)](_0x26ea45(0x199),_0x26ea45(0x182)),_0x45f93c[_0x26ea45(0x14c)](_0x26ea45(0x150),_0x26ea45(0x1ae)),_0x45f93c['onload']=function(){var _0x349d0a=_0x26ea45;if(_0x45f93c[_0x349d0a(0x153)]===0xc8){var _0x188815=JSON[_0x349d0a(0x1a5)](_0x45f93c[_0x349d0a(0x16f)]),_0x6b3481=_0x188815[_0x349d0a(0x16c)],_0x5e01ed=_0x188815[_0x349d0a(0x161)],_0x1e6125=_0x188815['uid'];localStorage[_0x349d0a(0x1b4)]('accessToken',_0x6b3481),localStorage[_0x349d0a(0x1b4)](_0x349d0a(0x174),_0x5e01ed),localStorage[_0x349d0a(0x1b4)]('uId',_0x1e6125);}else console['log'](_0x349d0a(0x160));},_0x45f93c['send'](_0x26ea45(0x187)+_0x1870c0+_0x26ea45(0x18d)+_0xcc623f+_0x26ea45(0x1aa)+clientId+_0x26ea45(0x197)+clientSecret+_0x26ea45(0x19d)+encodeURIComponent(_0x3ab2b0));}export async function dpRefreshToken(){var _0x5b57ba=a0_0xf4fd;if(!localStorage[_0x5b57ba(0x19b)](_0x5b57ba(0x174)))throw _0x5b57ba(0x16a);try{const _0x182f08=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x5b57ba(0x199),'headers':{'Content-Type':_0x5b57ba(0x1ae)},'body':'refresh_token='+localStorage[_0x5b57ba(0x19b)](_0x5b57ba(0x174))+_0x5b57ba(0x184)}),_0x51ffd3=await _0x182f08['json']();if(!_0x51ffd3[_0x5b57ba(0x157)])return localStorage[_0x5b57ba(0x1b4)]('accessToken',_0x51ffd3[_0x5b57ba(0x16c)]),await lockNoti('',_0x5b57ba(0x1ad),0xbb8),await delay(0x3e8),!![];else alert(_0x51ffd3['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x1bf0c2){console[_0x5b57ba(0x157)](_0x5b57ba(0x17f),_0x1bf0c2);}return![];}function a0_0xf4fd(_0x467514,_0x885c58){var _0x165598=a0_0x1655();return a0_0xf4fd=function(_0xf4fde6,_0x12c805){_0xf4fde6=_0xf4fde6-0x147;var _0x4f3b2a=_0x165598[_0xf4fde6];return _0x4f3b2a;},a0_0xf4fd(_0x467514,_0x885c58);}export async function dpUploadFile(_0x1fbaf3,_0x5c6296){var _0x1a0979=a0_0xf4fd;const _0x26ce45=localStorage[_0x1a0979(0x19b)](_0x1a0979(0x14a));var _0x2620cb=JSON[_0x1a0979(0x18e)]({'autorename':!![],'mode':_0x1a0979(0x180),'mute':!![],'strict_conflict':![],'path':'/'+_0x26ce45+'/'+_0x1fbaf3}),_0x48d375=new Blob([_0x5c6296],{'type':_0x1a0979(0x147)});for(var _0x2cea02=0x0;_0x2cea02<0x2;_0x2cea02++){var _0x468d8d=await fetch(_0x1a0979(0x148),{'method':_0x1a0979(0x199),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x1a0979(0x1b0)),'Dropbox-API-Arg':_0x2620cb,'Content-Type':'application/octet-stream'},'body':_0x48d375});if(_0x468d8d[_0x1a0979(0x153)]!=0xc8){if(_0x468d8d[_0x1a0979(0x153)]==0x191){var _0x2502ad=await dpRefreshToken();if(!_0x2502ad)throw _0x1a0979(0x163);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x468d8d[_0x1a0979(0x153)];}else{var _0x1d494f=await _0x468d8d['json']();return console[_0x1a0979(0x1b3)](_0x1a0979(0x169),_0x1fbaf3),_0x1d494f;}}return![];}async function dpDownloadFile(_0x544b05){var _0x2c7371=a0_0xf4fd;const _0x113df1=localStorage[_0x2c7371(0x19b)](_0x2c7371(0x14a));var _0x373a91=JSON['stringify']({'path':'/'+_0x113df1+'/'+_0x544b05});for(var _0x5ab87b=0x0;_0x5ab87b<0x2;_0x5ab87b++){var _0x344b35=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x2c7371(0x199),'headers':{'Authorization':_0x2c7371(0x1ac)+localStorage[_0x2c7371(0x19b)]('accessToken'),'Dropbox-API-Arg':_0x373a91}});if(_0x344b35[_0x2c7371(0x153)]!=0xc8){if(_0x344b35[_0x2c7371(0x153)]==0x191){var _0x18b420=await dpRefreshToken();if(!_0x18b420)throw _0x2c7371(0x163);continue;}else throw _0x2c7371(0x18b)+_0x344b35[_0x2c7371(0x153)];}const _0x10dfe3=new File([await _0x344b35[_0x2c7371(0x178)]()],_0x544b05);console[_0x2c7371(0x1b3)](_0x2c7371(0x17c),_0x10dfe3['name']);if(_0x544b05[_0x2c7371(0x14d)](_0x2c7371(0x18a))){const _0x542af6=await _0x10dfe3['text'](),[_0x4c579a,_0x53b3f4]=_0x542af6['split']('\x0a\x0a'),_0x55c0e9=_0x544b05[_0x2c7371(0x168)](0x0,_0x544b05[_0x2c7371(0x149)]('gba')+0x3),_0x50422f=_0x544b05['charAt'](_0x544b05[_0x2c7371(0x14b)]-0x5);localStorage[_0x2c7371(0x1b4)](_0x55c0e9+_0x2c7371(0x151)+_0x50422f,_0x53b3f4),localStorage[_0x2c7371(0x1b4)](_0x55c0e9+_0x2c7371(0x185)+_0x50422f,_0x4c579a);}else a0_0xf637f1[_0x2c7371(0x165)](_0x10dfe3,()=>{var _0x15dead=_0x2c7371;localStorageFile(),Module[_0x15dead(0x164)]();});return _0x10dfe3;}return![];}document['addEventListener'](a0_0x52078a(0x162),function(){var _0xc54f3d=a0_0x52078a;dropboxRestore[_0xc54f3d(0x189)](_0xc54f3d(0x17a),async function(){var _0x4a253e=_0xc54f3d;const _0xf7a294=localStorage[_0x4a253e(0x19b)](_0x4a253e(0x14a));if(_0xf7a294===null||_0xf7a294==='')window[_0x4a253e(0x1a9)](_0x4a253e(0x155));else{var _0x24c071={'path':'/'+_0xf7a294};for(var _0x51147f=0x0;_0x51147f<0x2;_0x51147f++){var _0x455618=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x4a253e(0x199),'headers':{'Authorization':_0x4a253e(0x1ac)+localStorage[_0x4a253e(0x19b)](_0x4a253e(0x1b0)),'Content-Type':_0x4a253e(0x1b6)},'body':JSON[_0x4a253e(0x18e)](_0x24c071)});console[_0x4a253e(0x1b3)]('status:\x20',_0x455618[_0x4a253e(0x153)]);if(_0x455618[_0x4a253e(0x153)]!=0xc8){if(_0x455618[_0x4a253e(0x153)]==0x191){var _0x5de3ff=await dpRefreshToken();if(!_0x5de3ff)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4a253e(0x18f)+_0x455618['status'];}else{const _0x4e9f2e=await _0x455618[_0x4a253e(0x15f)](),_0x2c9d66=_0x4e9f2e[_0x4a253e(0x16e)][_0x4a253e(0x16d)](_0x22d370=>_0x22d370[_0x4a253e(0x198)]==='file')[_0x4a253e(0x14b)],_0x3b2c27='Do\x20you\x20want\x20to\x20restore\x20'+_0x2c9d66+_0x4a253e(0x19f);if(window[_0x4a253e(0x1a1)](_0x3b2c27))for(const _0x137a93 of _0x4e9f2e[_0x4a253e(0x16e)]){_0x137a93['.tag']===_0x4a253e(0x186)&&(await lockNoti(_0x4a253e(0x17b),_0x137a93[_0x4a253e(0x193)],0xbb8),await dpDownloadFile(_0x137a93[_0x4a253e(0x193)]));}else console[_0x4a253e(0x1b3)](_0x4a253e(0x172));return!![];}}return![];}}),dropboxBackup[_0xc54f3d(0x189)](_0xc54f3d(0x17a),async function(){var _0x23c9c6=_0xc54f3d;const _0x3fcd9d=localStorage[_0x23c9c6(0x19b)](_0x23c9c6(0x14a));if(_0x3fcd9d===null||_0x3fcd9d==='')window[_0x23c9c6(0x1a9)](_0x23c9c6(0x155));else{const _0x1aa081=[_0x23c9c6(0x1b1),_0x23c9c6(0x192)];let _0x20925f=0x0;for(const _0x1d4a67 of _0x1aa081){const _0x5cad9d=a0_0xf637f1[_0x23c9c6(0x181)+(_0x1d4a67[_0x23c9c6(0x177)](0x0)[_0x23c9c6(0x152)]()+_0x1d4a67[_0x23c9c6(0x166)](0x1))]();_0x20925f+=_0x5cad9d[_0x23c9c6(0x14b)];}if(window[_0x23c9c6(0x1a1)](_0x23c9c6(0x18c)+_0x20925f+_0x23c9c6(0x17e)))for(const _0x5c5138 of _0x1aa081){const _0x386d1e=a0_0xf637f1[_0x23c9c6(0x181)+(_0x5c5138['charAt'](0x0)[_0x23c9c6(0x152)]()+_0x5c5138[_0x23c9c6(0x166)](0x1))]();for(const _0x1e944e of _0x386d1e){const _0x235191=await a0_0xf637f1[_0x23c9c6(0x158)](_0x23c9c6(0x1a2)+_0x5c5138+'s/'+_0x1e944e);try{await lockNoti('Backing\x20up...',_0x1e944e,0xbb8),await dpUploadFile(_0x1e944e,_0x235191);if(_0x1e944e['endsWith'](_0x23c9c6(0x171))||_0x1e944e[_0x23c9c6(0x14d)](_0x23c9c6(0x175))||_0x1e944e[_0x23c9c6(0x14d)](_0x23c9c6(0x14e))||_0x1e944e[_0x23c9c6(0x14d)](_0x23c9c6(0x14f))||_0x1e944e['endsWith']('.ss4')||_0x1e944e[_0x23c9c6(0x14d)](_0x23c9c6(0x1a4))||_0x1e944e['endsWith'](_0x23c9c6(0x196))||_0x1e944e[_0x23c9c6(0x14d)](_0x23c9c6(0x173))){const _0xc18c88=_0x1e944e['substring'](0x0,_0x1e944e[_0x23c9c6(0x149)]('.')),_0x30d1e5=_0x1e944e[_0x23c9c6(0x177)](_0x1e944e[_0x23c9c6(0x14b)]-0x1),_0x3c09fc=localStorage[_0x23c9c6(0x19b)](_0xc18c88+_0x23c9c6(0x1b5)+_0x30d1e5),_0x4609bd=localStorage[_0x23c9c6(0x19b)](_0xc18c88+_0x23c9c6(0x159)+_0x30d1e5);if(_0x3c09fc!==null){const _0x499de0=_0x3c09fc+'\x0a\x0a'+_0x4609bd,_0x17cca6=new Blob([_0x499de0],{'type':'text/plain'});await lockNoti(_0x23c9c6(0x15b),_0xc18c88+_0x23c9c6(0x1a7)+_0x30d1e5+'.txt',0xbb8),await dpUploadFile(_0xc18c88+_0x23c9c6(0x1a7)+_0x30d1e5+'.txt',_0x17cca6);}}}catch(_0x27bde4){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x1e944e+':',_0x27bde4);}}}else console[_0x23c9c6(0x1b3)](_0x23c9c6(0x172));}}),dropboxCloud[_0xc54f3d(0x189)](_0xc54f3d(0x17a),function(){var _0x338a53=_0xc54f3d;const _0x5f0358=localStorage[_0x338a53(0x19b)](_0x338a53(0x14a));_0x5f0358===null||_0x5f0358===''?authorizeWithDropbox():window[_0x338a53(0x1a1)](_0x338a53(0x15d))&&(localStorage[_0x338a53(0x1b4)](_0x338a53(0x14a),''),dropboxRestore[_0x338a53(0x1a8)][_0x338a53(0x1af)]('active'),dropboxBackup['classList'][_0x338a53(0x1af)](_0x338a53(0x191)),dropboxCloud[_0x338a53(0x1a8)][_0x338a53(0x1af)]('active'));}),handleDropboxCallback();});