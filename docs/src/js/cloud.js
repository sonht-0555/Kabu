var a0_0x50986b=a0_0x30d5;(function(_0x242784,_0x326f65){var _0xe56a2c=a0_0x30d5,_0x6c668d=_0x242784();while(!![]){try{var _0x213d0a=parseInt(_0xe56a2c(0x13b))/0x1*(-parseInt(_0xe56a2c(0x185))/0x2)+-parseInt(_0xe56a2c(0x12e))/0x3*(parseInt(_0xe56a2c(0x135))/0x4)+-parseInt(_0xe56a2c(0x13f))/0x5+-parseInt(_0xe56a2c(0x18f))/0x6*(parseInt(_0xe56a2c(0x160))/0x7)+parseInt(_0xe56a2c(0x180))/0x8+-parseInt(_0xe56a2c(0x153))/0x9+parseInt(_0xe56a2c(0x144))/0xa;if(_0x213d0a===_0x326f65)break;else _0x6c668d['push'](_0x6c668d['shift']());}catch(_0x3bb316){_0x6c668d['push'](_0x6c668d['shift']());}}}(a0_0x2ca9,0x4da57));import*as a0_0x40b502 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x30d5(_0x74d13f,_0x3a6c1d){var _0x2ca960=a0_0x2ca9();return a0_0x30d5=function(_0x30d506,_0x62f2fe){_0x30d506=_0x30d506-0x12b;var _0x104f65=_0x2ca960[_0x30d506];return _0x104f65;},a0_0x30d5(_0x74d13f,_0x3a6c1d);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x50986b(0x141);function authorizeWithDropbox(){var _0x2d46f2=a0_0x50986b,_0x47fd0c=window[_0x2d46f2(0x14f)][_0x2d46f2(0x140)][_0x2d46f2(0x158)]('?')[0x0],_0x341873=_0x2d46f2(0x163),_0x29ad19=_0x2d46f2(0x161),_0x10e868='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2d46f2(0x14d)+_0x341873+_0x2d46f2(0x190)+_0x29ad19+_0x2d46f2(0x14c)+encodeURIComponent(_0x47fd0c);window['location']['href']=_0x10e868;}function handleDropboxCallback(){var _0x2f3c05=a0_0x50986b,_0x2ebe19=getUrlParameter(_0x2f3c05(0x163));_0x2ebe19?(getAccessToken(_0x2ebe19),console['log'](_0x2f3c05(0x167),_0x2ebe19)):console[_0x2f3c05(0x149)](_0x2f3c05(0x15c));}function getUrlParameter(_0x383f6f){var _0x498c57=a0_0x50986b;_0x383f6f=_0x383f6f[_0x498c57(0x17a)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x906f0f=new RegExp(_0x498c57(0x139)+_0x383f6f+_0x498c57(0x146)),_0x4f5bca=_0x906f0f['exec'](location[_0x498c57(0x175)]);return _0x4f5bca===null?'':decodeURIComponent(_0x4f5bca[0x1][_0x498c57(0x17a)](/\+/g,'\x20'));}function a0_0x2ca9(){var _0x1246de=['&token_access_type=','json','blob','https://api.dropboxapi.com/2/files/list_folder','9FsoALg',',\x20status:\x20','Content-Type','responseText','application/json','Unable\x20to\x20refresh\x20token','setRequestHeader','169836QZbDZo','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','DOMContentLoaded','error','[\x5c?&#]','parse','1GjCqHG','Refreshing\x20token...','Cloud\x20↦\x20Kabu\x20storage\x20◆','name','1911515gBrYFw','href','nwb3dnfh09rhs31','addEventListener','&grant_type=','17905740oNYMnL','Upload\x20failed,\x20unknown\x20http\x20status:\x20','=([^&#]*)','authorization_code','POST','log','Bearer\x20','\x20files\x20in\x20Kabu?','&redirect_uri=','&response_type=','No\x20files\x20found\x20to\x20restore.','location','active','Cloud\x20login\x20required!','entries','5712147oIayDA','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Restore\x20canceled\x20by\x20user.','folder','state','split','error_description','Wait\x20a\x20little\x20bit...','Restoring...','Do\x20not\x20receive\x20authorization','refresh_token','application/x-www-form-urlencoded','onload','14culEGb','offline','confirm','code','stringify','click','getItem','Authorization\x20Code:','classList','length','Failed\x20to\x20upload\x20file\x20','accessToken','setItem','screenshot','application/octet-stream','uId','Error\x20creating\x20folder\x20','&client_secret=','remove','Do\x20you\x20want\x20to\x20logout?','Folder\x20created','search','Do\x20you\x20want\x20to\x20backup\x20','refresh_token=','refreshToken','Failed\x20to\x20refresh\x20Dropbox\x20token.','replace','Download\x20failed,\x20unknown\x20http\x20status:','push','Folder\x20already\x20exists','file','access_token','1955480glIYxY','uid','alert','.tag','uploadFileInCloud','763618rvrjXD','https://api.dropboxapi.com/oauth2/token','/data/','Kabu\x20storage\x20↦\x20Cloud\x20◆','listFiles','status','save','\x20files\x20from\x20Cloud?','https://content.dropboxapi.com/2/files/download','Backing\x20up...','572394FGeEvh'];a0_0x2ca9=function(){return _0x1246de;};return a0_0x2ca9();}function getAccessToken(_0x58765c){var _0x1b5baf=a0_0x50986b,_0x2c30c7=_0x1b5baf(0x147),_0x3d42a7=window[_0x1b5baf(0x14f)][_0x1b5baf(0x140)][_0x1b5baf(0x158)]('?')[0x0],_0x4922d4=new XMLHttpRequest();_0x4922d4['open'](_0x1b5baf(0x148),'https://api.dropbox.com/oauth2/token'),_0x4922d4[_0x1b5baf(0x134)](_0x1b5baf(0x130),_0x1b5baf(0x15e)),_0x4922d4[_0x1b5baf(0x15f)]=function(){var _0x4c9813=_0x1b5baf;if(_0x4922d4[_0x4c9813(0x18a)]===0xc8){var _0x40e3bf=JSON[_0x4c9813(0x13a)](_0x4922d4[_0x4c9813(0x131)]),_0x489888=_0x40e3bf['access_token'],_0x3cae70=_0x40e3bf[_0x4c9813(0x15d)],_0x1339e9=_0x40e3bf[_0x4c9813(0x181)];localStorage[_0x4c9813(0x16c)](_0x4c9813(0x16b),_0x489888),localStorage[_0x4c9813(0x16c)](_0x4c9813(0x178),_0x3cae70),localStorage[_0x4c9813(0x16c)](_0x4c9813(0x16f),_0x1339e9);}else console[_0x4c9813(0x149)](_0x4c9813(0x154));},_0x4922d4['send']('code='+_0x58765c+_0x1b5baf(0x143)+_0x2c30c7+'&client_id='+clientId+_0x1b5baf(0x171)+clientSecret+_0x1b5baf(0x14c)+encodeURIComponent(_0x3d42a7));}export async function dpCreateFolder(_0x426678){var _0x3118c=a0_0x50986b;const _0x5596df=localStorage[_0x3118c(0x166)](_0x3118c(0x16f));let _0x1ba7ee=localStorage[_0x3118c(0x166)](_0x3118c(0x16b));const _0x2e102e='/'+_0x5596df+'/'+_0x426678,_0x30cb89=JSON[_0x3118c(0x164)]({'path':_0x2e102e,'autorename':![]});for(let _0x25b09b=0x0;_0x25b09b<0x2;_0x25b09b++){try{const _0x905078=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x3118c(0x14a)+_0x1ba7ee,'Content-Type':_0x3118c(0x132)},'body':_0x30cb89});if(_0x905078[_0x3118c(0x18a)]===0x191){const _0x2e0de7=await dpRefreshToken();if(!_0x2e0de7)throw new Error('Unable\x20to\x20refresh\x20token');_0x1ba7ee=localStorage[_0x3118c(0x166)](_0x3118c(0x16b));continue;}if(_0x905078[_0x3118c(0x18a)]===0x199)return{'message':_0x3118c(0x17d),'path':_0x426678};if(!_0x905078['ok'])throw new Error(_0x3118c(0x170)+_0x426678);const _0x2a210a=await _0x905078[_0x3118c(0x12b)]();return await lockNoti(_0x3118c(0x174),'',0xbb8),_0x2a210a;}catch(_0x2cd18d){if(_0x25b09b===0x1)throw _0x2cd18d;}}return![];}export async function dpRefreshToken(){var _0x17c249=a0_0x50986b;if(!localStorage['getItem'](_0x17c249(0x178)))throw'No\x20refresh\x20token';try{const _0x4fc6fb=await fetch(_0x17c249(0x186),{'method':'POST','headers':{'Content-Type':_0x17c249(0x15e)},'body':_0x17c249(0x177)+localStorage[_0x17c249(0x166)](_0x17c249(0x178))+_0x17c249(0x136)}),_0x556daf=await _0x4fc6fb['json']();if(!_0x556daf[_0x17c249(0x138)])return localStorage[_0x17c249(0x16c)](_0x17c249(0x16b),_0x556daf[_0x17c249(0x17f)]),await lockNoti(_0x17c249(0x13c),'',0xbb8),await delay(0x3e8),!![];else alert(_0x556daf[_0x17c249(0x159)]||_0x17c249(0x179));}catch(_0x75eb41){console[_0x17c249(0x138)]('Error\x20while\x20refreshing\x20token:',_0x75eb41);}return![];}export async function dpUploadFile(_0x4cf2c1,_0x4fc22f,_0x1367e4){var _0x593bea=a0_0x50986b;const _0x2e0a10=localStorage[_0x593bea(0x166)]('uId');var _0x36b27f=JSON[_0x593bea(0x164)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x2e0a10+'/'+_0x1367e4+'/'+_0x4cf2c1}),_0x531d13=new Blob([_0x4fc22f],{'type':_0x593bea(0x16e)});for(var _0x43d9d0=0x0;_0x43d9d0<0x2;_0x43d9d0++){var _0x1971c1=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x593bea(0x148),'headers':{'Authorization':_0x593bea(0x14a)+localStorage[_0x593bea(0x166)](_0x593bea(0x16b)),'Dropbox-API-Arg':_0x36b27f,'Content-Type':_0x593bea(0x16e)},'body':_0x531d13});if(_0x1971c1['status']!=0xc8){if(_0x1971c1[_0x593bea(0x18a)]==0x191){var _0x4ed9f5=await dpRefreshToken();if(!_0x4ed9f5)throw _0x593bea(0x133);continue;}else throw _0x593bea(0x145)+_0x1971c1[_0x593bea(0x18a)];}else{var _0x4ad54e=await _0x1971c1[_0x593bea(0x12b)]();return console[_0x593bea(0x149)](_0x593bea(0x188),_0x4cf2c1),_0x4ad54e;}}return![];}export async function dpDownloadFile(_0x182a16,_0x3c5374){var _0x49ac17=a0_0x50986b;const _0xb23a9f=localStorage[_0x49ac17(0x166)]('uId');var _0x5581c2=JSON['stringify']({'path':'/'+_0xb23a9f+'/'+_0x3c5374+'/'+_0x182a16});for(var _0x6a4cc6=0x0;_0x6a4cc6<0x2;_0x6a4cc6++){var _0x502c28=await fetch(_0x49ac17(0x18d),{'method':_0x49ac17(0x148),'headers':{'Authorization':_0x49ac17(0x14a)+localStorage[_0x49ac17(0x166)](_0x49ac17(0x16b)),'Dropbox-API-Arg':_0x5581c2}});if(_0x502c28[_0x49ac17(0x18a)]!=0xc8){if(_0x502c28['status']==0x191){var _0x5113fa=await dpRefreshToken();if(!_0x5113fa)throw _0x49ac17(0x133);continue;}else throw _0x49ac17(0x17b)+_0x502c28[_0x49ac17(0x18a)];}const _0x44466e=new File([await _0x502c28[_0x49ac17(0x12c)]()],_0x182a16);return console[_0x49ac17(0x149)](_0x49ac17(0x13d),_0x44466e[_0x49ac17(0x13e)]),a0_0x40b502[_0x49ac17(0x184)](_0x44466e,()=>{}),_0x44466e;}return![];}document['addEventListener'](a0_0x50986b(0x137),function(){var _0x13d443=a0_0x50986b;dropboxRestore[_0x13d443(0x142)](_0x13d443(0x165),async function(){var _0x3c433d=_0x13d443;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x334f54=localStorage[_0x3c433d(0x166)](_0x3c433d(0x16f)),_0x27fb18=[_0x3c433d(0x157),_0x3c433d(0x18b),_0x3c433d(0x16d)];if(!_0x334f54){window[_0x3c433d(0x182)](_0x3c433d(0x151));return;}let _0x3a7c86=[];for(const _0x450e9b of _0x27fb18){let _0x77f340={'path':'/'+_0x334f54+'/'+_0x450e9b};for(let _0x2a34c2=0x0;_0x2a34c2<0x2;_0x2a34c2++){let _0x13077d=await fetch(_0x3c433d(0x12d),{'method':_0x3c433d(0x148),'headers':{'Authorization':_0x3c433d(0x14a)+localStorage[_0x3c433d(0x166)]('accessToken'),'Content-Type':_0x3c433d(0x132)},'body':JSON['stringify'](_0x77f340)});if(_0x13077d['status']===0xc8){let _0x3ddbad=await _0x13077d[_0x3c433d(0x12b)](),_0x4402f1=_0x3ddbad[_0x3c433d(0x152)]['filter'](_0x186499=>_0x186499[_0x3c433d(0x183)]===_0x3c433d(0x17e));_0x4402f1[_0x3c433d(0x169)]>0x0&&_0x3a7c86[_0x3c433d(0x17c)](..._0x4402f1['map'](_0x5cf4da=>({'name':_0x5cf4da['name'],'folder':_0x450e9b})));break;}else{if(_0x13077d[_0x3c433d(0x18a)]===0x191){let _0x4dc25d=await dpRefreshToken();if(!_0x4dc25d)throw _0x3c433d(0x133);}else{console[_0x3c433d(0x138)]('Download\x20failed\x20for\x20'+_0x450e9b+_0x3c433d(0x12f)+_0x13077d[_0x3c433d(0x18a)]);break;}}}}if(_0x3a7c86[_0x3c433d(0x169)]>0x0){const _0x1903ac='Do\x20you\x20want\x20to\x20restore\x20'+_0x3a7c86[_0x3c433d(0x169)]+_0x3c433d(0x18c);if(window[_0x3c433d(0x162)](_0x1903ac))for(const _0x50e5b5 of _0x3a7c86){await lockNoti(_0x3c433d(0x15b),_0x50e5b5[_0x3c433d(0x13e)],0xbb8),await dpDownloadFile(_0x50e5b5[_0x3c433d(0x13e)],_0x50e5b5[_0x3c433d(0x156)]);}else console[_0x3c433d(0x149)](_0x3c433d(0x155));}else console[_0x3c433d(0x149)](_0x3c433d(0x14e));}),dropboxBackup[_0x13d443(0x142)](_0x13d443(0x165),async function(){var _0x339ce6=_0x13d443;await lockNoti(_0x339ce6(0x15a),'',0x1388);const _0x418278=localStorage[_0x339ce6(0x166)](_0x339ce6(0x16f));if(_0x418278===null||_0x418278==='')window['alert'](_0x339ce6(0x151));else{const _0x36c77d=[_0x339ce6(0x157),_0x339ce6(0x18b),'screenshot'];for(const _0x4cc564 of _0x36c77d){await dpCreateFolder(_0x4cc564);}let _0x3b5e06=0x0;for(const _0xddebd4 of _0x36c77d){const _0x296463=a0_0x40b502[_0x339ce6(0x189)](_0xddebd4+'s');_0x3b5e06+=_0x296463[_0x339ce6(0x169)];}if(window['confirm'](_0x339ce6(0x176)+_0x3b5e06+_0x339ce6(0x14b)))for(const _0x2dc143 of _0x36c77d){const _0xcad830=a0_0x40b502[_0x339ce6(0x189)](_0x2dc143+'s');for(const _0x45dd8a of _0xcad830){const _0x6e6768=await a0_0x40b502['downloadFileInCloud'](_0x339ce6(0x187)+_0x2dc143+'s/'+_0x45dd8a);try{await lockNoti(_0x339ce6(0x18e),_0x45dd8a,0xbb8),await dpUploadFile(_0x45dd8a,_0x6e6768,_0x2dc143);}catch(_0x11ebfc){console[_0x339ce6(0x138)](_0x339ce6(0x16a)+_0x45dd8a+':',_0x11ebfc);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x13d443(0x142)](_0x13d443(0x165),function(){var _0x36100d=_0x13d443;const _0x14e60b=localStorage['getItem']('uId');_0x14e60b===null||_0x14e60b===''?authorizeWithDropbox():window[_0x36100d(0x162)](_0x36100d(0x173))&&(localStorage[_0x36100d(0x16c)]('uId',''),dropboxRestore[_0x36100d(0x168)][_0x36100d(0x172)](_0x36100d(0x150)),dropboxBackup[_0x36100d(0x168)][_0x36100d(0x172)](_0x36100d(0x150)),dropboxCloud[_0x36100d(0x168)][_0x36100d(0x172)](_0x36100d(0x150)));}),handleDropboxCallback();});