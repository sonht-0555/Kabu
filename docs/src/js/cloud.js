function a0_0x2516(){var _0x41fb34=['open','https://api.dropbox.com/oauth2/token','5831675ipzhIQ','2743867cxWXmA','remove','752170VKJpFO','No\x20files\x20found\x20to\x20restore.','click','https://api.dropboxapi.com/oauth2/token','DOMContentLoaded','https://api.dropboxapi.com/2/files/list_folder','accessToken','POST','confirm','length','uId','&client_secret=','.tag',',\x20status:\x20','/data/','Download\x20failed\x20for\x20','file','knh3uz2mx2hp2eu','5180128BANzkf','Restore\x20canceled\x20by\x20user.','classList','save','overwrite','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','3aJGYuR','uid','Failed\x20to\x20upload\x20file\x20','3940924jMNjnt','No\x20refresh\x20token','Bearer\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','href','search','\x20files\x20from\x20Cloud?','offline','exec','access_token','Do\x20you\x20want\x20to\x20restore\x20','split','blob','12DDLcUR','list','log','Backing\x20up...','downloadFileInCloud','Upload\x20failed,\x20unknown\x20http\x20status:\x20','refresh_token','Restoring...','FSSync','Authorization\x20Code:','https://content.dropboxapi.com/2/files/download','Error\x20while\x20refreshing\x20token:','screenshot','Do\x20you\x20want\x20to\x20logout?','nwb3dnfh09rhs31','refreshToken','location','responseText','&redirect_uri=','error','addEventListener','charAt','stringify','Content-Type','application/octet-stream','parse','Do\x20not\x20receive\x20authorization','Refreshing\x20token...','Folder\x20created','code','Folder\x20already\x20exists','toUpperCase','Error\x20creating\x20folder\x20','status','setRequestHeader','slice','active','json','&client_id=','application/json','refresh_token=','name','Cloud\x20↦\x20Kabu\x20storage\x20◆','13572108hxdFop','Download\x20failed,\x20unknown\x20http\x20status:','authorization_code','error_description','https://content.dropboxapi.com/2/files/upload','Do\x20you\x20want\x20to\x20backup\x20','1618142ZLPYXH','replace','getItem','=([^&#]*)','folder','setItem','send','state','Cloud\x20login\x20required!','application/x-www-form-urlencoded','Unable\x20to\x20refresh\x20token'];a0_0x2516=function(){return _0x41fb34;};return a0_0x2516();}var a0_0x390ee0=a0_0x51d1;(function(_0x280ffc,_0xbc9baa){var _0x33f238=a0_0x51d1,_0x4666ec=_0x280ffc();while(!![]){try{var _0x18c0f3=parseInt(_0x33f238(0x128))/0x1+-parseInt(_0x33f238(0x118))/0x2+parseInt(_0x33f238(0x140))/0x3*(parseInt(_0x33f238(0x143))/0x4)+parseInt(_0x33f238(0x125))/0x5+parseInt(_0x33f238(0x150))/0x6*(parseInt(_0x33f238(0x126))/0x7)+-parseInt(_0x33f238(0x13a))/0x8+-parseInt(_0x33f238(0x112))/0x9;if(_0x18c0f3===_0xbc9baa)break;else _0x4666ec['push'](_0x4666ec['shift']());}catch(_0x21a384){_0x4666ec['push'](_0x4666ec['shift']());}}}(a0_0x2516,0xb089b));import*as a0_0x6b9853 from'./main.js';function a0_0x51d1(_0x354c38,_0x168694){var _0x2516f0=a0_0x2516();return a0_0x51d1=function(_0x51d1cf,_0x45fdfc){_0x51d1cf=_0x51d1cf-0xfd;var _0x102ed8=_0x2516f0[_0x51d1cf];return _0x102ed8;},a0_0x51d1(_0x354c38,_0x168694);}import{localStorageFile}from'./storage.js';var clientId=a0_0x390ee0(0x139),clientSecret=a0_0x390ee0(0x15e);function authorizeWithDropbox(){var _0x9cea29=a0_0x390ee0,_0x1e571d=window['location'][_0x9cea29(0x147)][_0x9cea29(0x14e)]('?')[0x0],_0x35297e='code',_0x17db40=_0x9cea29(0x14a),_0x1631d4='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x35297e+'&token_access_type='+_0x17db40+'&redirect_uri='+encodeURIComponent(_0x1e571d);window[_0x9cea29(0x160)][_0x9cea29(0x147)]=_0x1631d4;}function handleDropboxCallback(){var _0x4eaf73=a0_0x390ee0,_0x5cfdc0=getUrlParameter(_0x4eaf73(0x104));_0x5cfdc0?(getAccessToken(_0x5cfdc0),console[_0x4eaf73(0x152)](_0x4eaf73(0x159),_0x5cfdc0)):console[_0x4eaf73(0x152)](_0x4eaf73(0x101));}function getUrlParameter(_0x389524){var _0x26da41=a0_0x390ee0;_0x389524=_0x389524[_0x26da41(0x119)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x884ef1=new RegExp('[\x5c?&#]'+_0x389524+_0x26da41(0x11b)),_0x1de3ab=_0x884ef1[_0x26da41(0x14b)](location[_0x26da41(0x148)]);return _0x1de3ab===null?'':decodeURIComponent(_0x1de3ab[0x1][_0x26da41(0x119)](/\+/g,'\x20'));}function getAccessToken(_0x2287b6){var _0x58b679=a0_0x390ee0,_0x146b3e=_0x58b679(0x114),_0x57e1dd=window[_0x58b679(0x160)][_0x58b679(0x147)][_0x58b679(0x14e)]('?')[0x0],_0x336e92=new XMLHttpRequest();_0x336e92[_0x58b679(0x123)](_0x58b679(0x12f),_0x58b679(0x124)),_0x336e92[_0x58b679(0x109)](_0x58b679(0xfe),_0x58b679(0x121)),_0x336e92['onload']=function(){var _0x4c4473=_0x58b679;if(_0x336e92[_0x4c4473(0x108)]===0xc8){var _0x2aac26=JSON[_0x4c4473(0x100)](_0x336e92[_0x4c4473(0x161)]),_0x5e54dd=_0x2aac26['access_token'],_0x35652a=_0x2aac26[_0x4c4473(0x156)],_0x5c62f7=_0x2aac26[_0x4c4473(0x141)];localStorage[_0x4c4473(0x11d)](_0x4c4473(0x12e),_0x5e54dd),localStorage[_0x4c4473(0x11d)](_0x4c4473(0x15f),_0x35652a),localStorage[_0x4c4473(0x11d)](_0x4c4473(0x132),_0x5c62f7);}else console[_0x4c4473(0x152)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x336e92[_0x58b679(0x11e)]('code='+_0x2287b6+'&grant_type='+_0x146b3e+_0x58b679(0x10d)+clientId+_0x58b679(0x133)+clientSecret+_0x58b679(0x162)+encodeURIComponent(_0x57e1dd));}export async function dpCreateFolder(_0x15d909){var _0x1cb7da=a0_0x390ee0;const _0x88dac8=localStorage[_0x1cb7da(0x11a)](_0x1cb7da(0x132));let _0x4b8f1c=localStorage[_0x1cb7da(0x11a)]('accessToken');const _0x2d3530='/'+_0x88dac8+'/'+_0x15d909,_0x40caf8=JSON[_0x1cb7da(0xfd)]({'path':_0x2d3530,'autorename':![]});for(let _0x37d002=0x0;_0x37d002<0x2;_0x37d002++){try{const _0x2ba910=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x1cb7da(0x12f),'headers':{'Authorization':_0x1cb7da(0x145)+_0x4b8f1c,'Content-Type':_0x1cb7da(0x10e)},'body':_0x40caf8});if(_0x2ba910[_0x1cb7da(0x108)]===0x191){const _0x4f7dda=await dpRefreshToken();if(!_0x4f7dda)throw new Error(_0x1cb7da(0x122));_0x4b8f1c=localStorage[_0x1cb7da(0x11a)](_0x1cb7da(0x12e));continue;}if(_0x2ba910[_0x1cb7da(0x108)]===0x199)return{'message':_0x1cb7da(0x105),'path':_0x15d909};if(!_0x2ba910['ok'])throw new Error(_0x1cb7da(0x107)+_0x15d909);const _0x541289=await _0x2ba910[_0x1cb7da(0x10c)]();return await lockNoti(_0x1cb7da(0x103),'',0xbb8),_0x541289;}catch(_0xb6f403){if(_0x37d002===0x1)throw _0xb6f403;}}return![];}export async function dpRefreshToken(){var _0x3d9aed=a0_0x390ee0;if(!localStorage[_0x3d9aed(0x11a)](_0x3d9aed(0x15f)))throw _0x3d9aed(0x144);try{const _0x3e70d0=await fetch(_0x3d9aed(0x12b),{'method':'POST','headers':{'Content-Type':_0x3d9aed(0x121)},'body':_0x3d9aed(0x10f)+localStorage[_0x3d9aed(0x11a)](_0x3d9aed(0x15f))+_0x3d9aed(0x13f)}),_0x58ae6e=await _0x3e70d0[_0x3d9aed(0x10c)]();if(!_0x58ae6e['error'])return localStorage['setItem'](_0x3d9aed(0x12e),_0x58ae6e[_0x3d9aed(0x14c)]),await lockNoti(_0x3d9aed(0x102),'',0xbb8),await delay(0x3e8),!![];else alert(_0x58ae6e[_0x3d9aed(0x115)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x2e2824){console['error'](_0x3d9aed(0x15b),_0x2e2824);}return![];}export async function dpUploadFile(_0x2efea7,_0x3032f4,_0x538fce){var _0x44a6c4=a0_0x390ee0;const _0x98d6c8=localStorage['getItem'](_0x44a6c4(0x132));var _0x3397d5=JSON[_0x44a6c4(0xfd)]({'autorename':!![],'mode':_0x44a6c4(0x13e),'mute':!![],'strict_conflict':![],'path':'/'+_0x98d6c8+'/'+_0x538fce+'/'+_0x2efea7}),_0x27f160=new Blob([_0x3032f4],{'type':_0x44a6c4(0xff)});for(var _0x53bb5b=0x0;_0x53bb5b<0x2;_0x53bb5b++){var _0x2193d3=await fetch(_0x44a6c4(0x116),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x3397d5,'Content-Type':_0x44a6c4(0xff)},'body':_0x27f160});if(_0x2193d3[_0x44a6c4(0x108)]!=0xc8){if(_0x2193d3['status']==0x191){var _0x46488c=await dpRefreshToken();if(!_0x46488c)throw _0x44a6c4(0x122);continue;}else throw _0x44a6c4(0x155)+_0x2193d3[_0x44a6c4(0x108)];}else{var _0x4bda21=await _0x2193d3[_0x44a6c4(0x10c)]();return console['log'](_0x44a6c4(0x146),_0x2efea7),_0x4bda21;}}return![];}export async function dpDownloadFile(_0x2ed88c,_0x840c6e){var _0xfc114b=a0_0x390ee0;const _0x39e08b=localStorage[_0xfc114b(0x11a)]('uId');var _0x816322=JSON[_0xfc114b(0xfd)]({'path':'/'+_0x39e08b+'/'+_0x840c6e+'/'+_0x2ed88c});for(var _0x1ba032=0x0;_0x1ba032<0x2;_0x1ba032++){var _0x3af83c=await fetch(_0xfc114b(0x15a),{'method':_0xfc114b(0x12f),'headers':{'Authorization':_0xfc114b(0x145)+localStorage[_0xfc114b(0x11a)](_0xfc114b(0x12e)),'Dropbox-API-Arg':_0x816322}});if(_0x3af83c[_0xfc114b(0x108)]!=0xc8){if(_0x3af83c[_0xfc114b(0x108)]==0x191){var _0xe77697=await dpRefreshToken();if(!_0xe77697)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0xfc114b(0x113)+_0x3af83c[_0xfc114b(0x108)];}const _0x644ed5=new File([await _0x3af83c[_0xfc114b(0x14f)]()],_0x2ed88c);return console[_0xfc114b(0x152)](_0xfc114b(0x111),_0x644ed5['name']),a0_0x6b9853['uploadFileInCloud'](_0x644ed5,()=>{var _0x5247a0=_0xfc114b;localStorageFile(),Module[_0x5247a0(0x158)]();}),_0x644ed5;}return![];}document[a0_0x390ee0(0x164)](a0_0x390ee0(0x12c),function(){var _0x323f60=a0_0x390ee0;dropboxRestore[_0x323f60(0x164)](_0x323f60(0x12a),async function(){var _0x107046=_0x323f60;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0xc7b7cf=localStorage[_0x107046(0x11a)](_0x107046(0x132)),_0x17618f=['state',_0x107046(0x13d),'screenshot'];if(!_0xc7b7cf){window['alert'](_0x107046(0x120));return;}let _0x4690c7=[];for(const _0x8d9fa8 of _0x17618f){let _0x21fe95={'path':'/'+_0xc7b7cf+'/'+_0x8d9fa8};for(let _0x2a3c09=0x0;_0x2a3c09<0x2;_0x2a3c09++){let _0x15489a=await fetch(_0x107046(0x12d),{'method':'POST','headers':{'Authorization':_0x107046(0x145)+localStorage['getItem']('accessToken'),'Content-Type':'application/json'},'body':JSON[_0x107046(0xfd)](_0x21fe95)});if(_0x15489a[_0x107046(0x108)]===0xc8){let _0x371c27=await _0x15489a['json'](),_0x49f953=_0x371c27['entries']['filter'](_0x2614f7=>_0x2614f7[_0x107046(0x134)]===_0x107046(0x138));_0x49f953[_0x107046(0x131)]>0x0&&_0x4690c7['push'](..._0x49f953['map'](_0x511969=>({'name':_0x511969['name'],'folder':_0x8d9fa8})));break;}else{if(_0x15489a['status']===0x191){let _0x5f5ddc=await dpRefreshToken();if(!_0x5f5ddc)throw _0x107046(0x122);}else{console[_0x107046(0x163)](_0x107046(0x137)+_0x8d9fa8+_0x107046(0x135)+_0x15489a[_0x107046(0x108)]);break;}}}}if(_0x4690c7['length']>0x0){const _0x5b62a0=_0x107046(0x14d)+_0x4690c7[_0x107046(0x131)]+_0x107046(0x149);if(window[_0x107046(0x130)](_0x5b62a0))for(const _0x579e9d of _0x4690c7){await lockNoti(_0x107046(0x157),_0x579e9d[_0x107046(0x110)],0xbb8),await dpDownloadFile(_0x579e9d['name'],_0x579e9d[_0x107046(0x11c)]);}else console['log'](_0x107046(0x13b));}else console[_0x107046(0x152)](_0x107046(0x129));}),dropboxBackup['addEventListener'](_0x323f60(0x12a),async function(){var _0x43cb98=_0x323f60;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x2155f2=localStorage[_0x43cb98(0x11a)](_0x43cb98(0x132));if(_0x2155f2===null||_0x2155f2==='')window['alert'](_0x43cb98(0x120));else{const _0x48a40f=[_0x43cb98(0x11f),_0x43cb98(0x13d),_0x43cb98(0x15c)];for(const _0x366efe of _0x48a40f){await dpCreateFolder(_0x366efe);}let _0x3ac707=0x0;for(const _0x100d91 of _0x48a40f){const _0x1f2d23=a0_0x6b9853[_0x43cb98(0x151)+(_0x100d91[_0x43cb98(0x165)](0x0)[_0x43cb98(0x106)]()+_0x100d91['slice'](0x1))]();_0x3ac707+=_0x1f2d23[_0x43cb98(0x131)];}if(window[_0x43cb98(0x130)](_0x43cb98(0x117)+_0x3ac707+'\x20files\x20in\x20Kabu?'))for(const _0x24c115 of _0x48a40f){const _0x439275=a0_0x6b9853[_0x43cb98(0x151)+(_0x24c115[_0x43cb98(0x165)](0x0)[_0x43cb98(0x106)]()+_0x24c115[_0x43cb98(0x10a)](0x1))]();for(const _0x2f2379 of _0x439275){const _0x167818=await a0_0x6b9853[_0x43cb98(0x154)](_0x43cb98(0x136)+_0x24c115+'s/'+_0x2f2379);try{await lockNoti(_0x43cb98(0x153),_0x2f2379,0xbb8),await dpUploadFile(_0x2f2379,_0x167818,_0x24c115);}catch(_0x34a387){console[_0x43cb98(0x163)](_0x43cb98(0x142)+_0x2f2379+':',_0x34a387);}}}else console['log'](_0x43cb98(0x13b));}}),dropboxCloud[_0x323f60(0x164)](_0x323f60(0x12a),function(){var _0x278735=_0x323f60;const _0x1232a7=localStorage['getItem'](_0x278735(0x132));_0x1232a7===null||_0x1232a7===''?authorizeWithDropbox():window[_0x278735(0x130)](_0x278735(0x15d))&&(localStorage[_0x278735(0x11d)](_0x278735(0x132),''),dropboxRestore['classList'][_0x278735(0x127)](_0x278735(0x10b)),dropboxBackup['classList'][_0x278735(0x127)](_0x278735(0x10b)),dropboxCloud[_0x278735(0x13c)][_0x278735(0x127)]('active'));}),handleDropboxCallback();});