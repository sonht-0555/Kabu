function a0_0x2680(){var _0x14f92a=['open','refresh_token=','confirm','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','nwb3dnfh09rhs31','lastIndexOf','132298ZYfrLG','Kabu\x20storage\x20↦\x20Cloud\x20◆','error_description','active','_dateState','https://api.dropbox.com/oauth2/token','blob','5lewtYY','Refreshing\x20token...','file','exec','addEventListener','text','&client_secret=','uploadSaveOrSaveState','Error\x20while\x20refreshing\x20token:','=([^&#]*)','&response_type=','.txt','&client_id=','Content-Type','onload','438RGklMn','No\x20refresh\x20token','DOMContentLoaded','alert','Do\x20you\x20want\x20to\x20backup\x20','.ss0','FSSync','11TMIZox','status:\x20','11431RngNmt','accessToken','getItem','https://content.dropboxapi.com/2/files/download','text/plain','replace','refresh_token','Cloud\x20login\x20required!','status','responseText','Restore\x20canceled\x20by\x20user.','.ss6','447051LiAOyi','location','search','Bearer\x20','737204HMWbuu','Do\x20you\x20want\x20to\x20restore\x20','list','1590966EuOmcu','stringify','.ss5','length','setRequestHeader','refreshToken','filter','access_token','href','https://content.dropboxapi.com/2/files/upload','Failed\x20to\x20upload\x20file\x20','endsWith','5689690EIjdEG','.gba_imageState','offline','application/octet-stream','&grant_type=','parse','name','uId','Do\x20you\x20want\x20to\x20logout?','error','&token_access_type=','slice','_imageState','toUpperCase','POST','.tag','Backing\x20up...','.ss1','Failed\x20to\x20refresh\x20Dropbox\x20token.','charAt','Cloud\x20↦\x20Kabu\x20storage\x20◆','Do\x20not\x20receive\x20authorization','split','application/json','&redirect_uri=','Unable\x20to\x20refresh\x20token','Restoring...','Download\x20failed,\x20unknown\x20http\x20status:','code','authorization_code','.gba_slot','1vAFGNS','Upload\x20failed,\x20unknown\x20http\x20status:\x20','.ss4','/data/','classList','2306368aqNyWa','remove','log','Download\x20failed,\x20unknown\x20http\x20status:\x20','setItem','https://www.dropbox.com/oauth2/authorize?client_id=','json','entries','gba','application/x-www-form-urlencoded'];a0_0x2680=function(){return _0x14f92a;};return a0_0x2680();}var a0_0x2947ae=a0_0x4a7b;(function(_0x506d7d,_0x523bf0){var _0x139fda=a0_0x4a7b,_0x15a510=_0x506d7d();while(!![]){try{var _0x96e5e1=-parseInt(_0x139fda(0x133))/0x1*(-parseInt(_0x139fda(0xd6))/0x2)+parseInt(_0x139fda(0x101))/0x3+-parseInt(_0x139fda(0x105))/0x4*(parseInt(_0x139fda(0xdd))/0x5)+-parseInt(_0x139fda(0xec))/0x6*(-parseInt(_0x139fda(0xf5))/0x7)+-parseInt(_0x139fda(0x138))/0x8+-parseInt(_0x139fda(0x108))/0x9+parseInt(_0x139fda(0x114))/0xa*(parseInt(_0x139fda(0xf3))/0xb);if(_0x96e5e1===_0x523bf0)break;else _0x15a510['push'](_0x15a510['shift']());}catch(_0x4a2d86){_0x15a510['push'](_0x15a510['shift']());}}}(a0_0x2680,0x3e015));import*as a0_0x49e1d9 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x4a7b(_0x4a7683,_0x233837){var _0x26807d=a0_0x2680();return a0_0x4a7b=function(_0x4a7b39,_0x57c41f){_0x4a7b39=_0x4a7b39-0xca;var _0x2cdb4e=_0x26807d[_0x4a7b39];return _0x2cdb4e;},a0_0x4a7b(_0x4a7683,_0x233837);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x2947ae(0xd4);function authorizeWithDropbox(){var _0x22e424=a0_0x2947ae,_0xcf1eec=window[_0x22e424(0x102)][_0x22e424(0x110)]['split']('?')[0x0],_0x8a8aa8=_0x22e424(0x130),_0x2ba27f=_0x22e424(0x116),_0x1915aa=_0x22e424(0xcb)+clientId+_0x22e424(0xe7)+_0x8a8aa8+_0x22e424(0x11e)+_0x2ba27f+_0x22e424(0x12c)+encodeURIComponent(_0xcf1eec);window[_0x22e424(0x102)][_0x22e424(0x110)]=_0x1915aa;}function handleDropboxCallback(){var _0x4a1c4b=a0_0x2947ae,_0x46d955=getUrlParameter(_0x4a1c4b(0x130));_0x46d955?(getAccessToken(_0x46d955),console[_0x4a1c4b(0x13a)]('Authorization\x20Code:',_0x46d955)):console[_0x4a1c4b(0x13a)](_0x4a1c4b(0x129));}function getUrlParameter(_0x181c0b){var _0x15be3a=a0_0x2947ae;_0x181c0b=_0x181c0b[_0x15be3a(0xfa)](/[\[]/,'\x5c[')[_0x15be3a(0xfa)](/[\]]/,'\x5c]');var _0x35fa09=new RegExp('[\x5c?&#]'+_0x181c0b+_0x15be3a(0xe6)),_0x193d65=_0x35fa09[_0x15be3a(0xe0)](location[_0x15be3a(0x103)]);return _0x193d65===null?'':decodeURIComponent(_0x193d65[0x1][_0x15be3a(0xfa)](/\+/g,'\x20'));}function getAccessToken(_0x1c3fce){var _0x81ea96=a0_0x2947ae,_0x390257=_0x81ea96(0x131),_0x41f2f6=window[_0x81ea96(0x102)][_0x81ea96(0x110)][_0x81ea96(0x12a)]('?')[0x0],_0x14ab01=new XMLHttpRequest();_0x14ab01[_0x81ea96(0xd0)]('POST',_0x81ea96(0xdb)),_0x14ab01[_0x81ea96(0x10c)](_0x81ea96(0xea),'application/x-www-form-urlencoded'),_0x14ab01[_0x81ea96(0xeb)]=function(){var _0x525cc0=_0x81ea96;if(_0x14ab01[_0x525cc0(0xfd)]===0xc8){var _0x55ad82=JSON[_0x525cc0(0x119)](_0x14ab01[_0x525cc0(0xfe)]),_0x2a03cf=_0x55ad82[_0x525cc0(0x10f)],_0x59e0bb=_0x55ad82[_0x525cc0(0xfb)],_0x41eb00=_0x55ad82['uid'];localStorage[_0x525cc0(0xca)](_0x525cc0(0xf6),_0x2a03cf),localStorage['setItem'](_0x525cc0(0x10d),_0x59e0bb),localStorage[_0x525cc0(0xca)]('uId',_0x41eb00);}else console[_0x525cc0(0x13a)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x14ab01['send']('code='+_0x1c3fce+_0x81ea96(0x118)+_0x390257+_0x81ea96(0xe9)+clientId+_0x81ea96(0xe3)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x41f2f6));}export async function dpRefreshToken(){var _0x5e3da4=a0_0x2947ae;if(!localStorage[_0x5e3da4(0xf7)](_0x5e3da4(0x10d)))throw _0x5e3da4(0xed);try{const _0xe9d4ff=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':'POST','headers':{'Content-Type':_0x5e3da4(0xcf)},'body':_0x5e3da4(0xd1)+localStorage[_0x5e3da4(0xf7)](_0x5e3da4(0x10d))+_0x5e3da4(0xd3)}),_0x47c542=await _0xe9d4ff[_0x5e3da4(0xcc)]();if(!_0x47c542[_0x5e3da4(0x11d)])return localStorage[_0x5e3da4(0xca)]('accessToken',_0x47c542[_0x5e3da4(0x10f)]),await lockNoti('',_0x5e3da4(0xde),0xbb8),await delay(0x3e8),!![];else alert(_0x47c542[_0x5e3da4(0xd8)]||_0x5e3da4(0x126));}catch(_0x56211d){console[_0x5e3da4(0x11d)](_0x5e3da4(0xe5),_0x56211d);}return![];}export async function dpUploadFile(_0xd1d10e,_0x337fbe){var _0x2dbb60=a0_0x2947ae;const _0xc6c38=localStorage[_0x2dbb60(0xf7)](_0x2dbb60(0x11b));var _0x45c875=JSON[_0x2dbb60(0x109)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0xc6c38+'/'+_0xd1d10e}),_0x49f521=new Blob([_0x337fbe],{'type':_0x2dbb60(0x117)});for(var _0x539060=0x0;_0x539060<0x2;_0x539060++){var _0x5b5a6d=await fetch(_0x2dbb60(0x111),{'method':_0x2dbb60(0x122),'headers':{'Authorization':_0x2dbb60(0x104)+localStorage[_0x2dbb60(0xf7)](_0x2dbb60(0xf6)),'Dropbox-API-Arg':_0x45c875,'Content-Type':_0x2dbb60(0x117)},'body':_0x49f521});if(_0x5b5a6d['status']!=0xc8){if(_0x5b5a6d['status']==0x191){var _0x14504e=await dpRefreshToken();if(!_0x14504e)throw _0x2dbb60(0x12d);continue;}else throw _0x2dbb60(0x134)+_0x5b5a6d['status'];}else{var _0x2deeee=await _0x5b5a6d[_0x2dbb60(0xcc)]();return console[_0x2dbb60(0x13a)](_0x2dbb60(0xd7),_0xd1d10e),_0x2deeee;}}return![];}async function dpDownloadFile(_0x147f0a){var _0x4b7300=a0_0x2947ae;const _0x83ebee=localStorage[_0x4b7300(0xf7)]('uId');var _0x444921=JSON[_0x4b7300(0x109)]({'path':'/'+_0x83ebee+'/'+_0x147f0a});for(var _0x1597bf=0x0;_0x1597bf<0x2;_0x1597bf++){var _0x7bc8f5=await fetch(_0x4b7300(0xf8),{'method':'POST','headers':{'Authorization':_0x4b7300(0x104)+localStorage[_0x4b7300(0xf7)](_0x4b7300(0xf6)),'Dropbox-API-Arg':_0x444921}});if(_0x7bc8f5[_0x4b7300(0xfd)]!=0xc8){if(_0x7bc8f5['status']==0x191){var _0x1e5749=await dpRefreshToken();if(!_0x1e5749)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4b7300(0x12f)+_0x7bc8f5[_0x4b7300(0xfd)];}const _0x3945ed=new File([await _0x7bc8f5[_0x4b7300(0xdc)]()],_0x147f0a);console['log'](_0x4b7300(0x128),_0x3945ed['name']);if(_0x147f0a['endsWith'](_0x4b7300(0xe8))){const _0x11255e=await _0x3945ed[_0x4b7300(0xe2)](),[_0x3d65f3,_0x481ab7]=_0x11255e[_0x4b7300(0x12a)]('\x0a\x0a'),_0x42473c=_0x147f0a['substring'](0x0,_0x147f0a[_0x4b7300(0xd5)](_0x4b7300(0xce))+0x3),_0x4417c3=_0x147f0a['charAt'](_0x147f0a['length']-0x5);localStorage[_0x4b7300(0xca)](_0x42473c+_0x4b7300(0xda)+_0x4417c3,_0x481ab7),localStorage[_0x4b7300(0xca)](_0x42473c+_0x4b7300(0x120)+_0x4417c3,_0x3d65f3);}else a0_0x49e1d9[_0x4b7300(0xe4)](_0x3945ed,()=>{var _0x1fb426=_0x4b7300;localStorageFile(),Module[_0x1fb426(0xf2)]();});return _0x3945ed;}return![];}document[a0_0x2947ae(0xe1)](a0_0x2947ae(0xee),function(){var _0x235a2e=a0_0x2947ae;dropboxRestore[_0x235a2e(0xe1)]('click',async function(){var _0x515bc5=_0x235a2e;const _0x1cce9e=localStorage['getItem'](_0x515bc5(0x11b));if(_0x1cce9e===null||_0x1cce9e==='')window[_0x515bc5(0xef)](_0x515bc5(0xfc));else{var _0x3f54ed={'path':'/'+_0x1cce9e};for(var _0xe54373=0x0;_0xe54373<0x2;_0xe54373++){var _0x4ac2d6=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x515bc5(0x122),'headers':{'Authorization':_0x515bc5(0x104)+localStorage[_0x515bc5(0xf7)](_0x515bc5(0xf6)),'Content-Type':_0x515bc5(0x12b)},'body':JSON[_0x515bc5(0x109)](_0x3f54ed)});console[_0x515bc5(0x13a)](_0x515bc5(0xf4),_0x4ac2d6[_0x515bc5(0xfd)]);if(_0x4ac2d6['status']!=0xc8){if(_0x4ac2d6[_0x515bc5(0xfd)]==0x191){var _0xeccfdf=await dpRefreshToken();if(!_0xeccfdf)throw _0x515bc5(0x12d);continue;}else throw _0x515bc5(0x13b)+_0x4ac2d6['status'];}else{const _0x42b76d=await _0x4ac2d6[_0x515bc5(0xcc)](),_0x45b399=_0x42b76d[_0x515bc5(0xcd)][_0x515bc5(0x10e)](_0x15b281=>_0x15b281[_0x515bc5(0x123)]===_0x515bc5(0xdf))[_0x515bc5(0x10b)],_0x532f74=_0x515bc5(0x106)+_0x45b399+'\x20files\x20in\x20Cloud?';if(window['confirm'](_0x532f74))for(const _0x4d874a of _0x42b76d['entries']){_0x4d874a[_0x515bc5(0x123)]==='file'&&(await lockNoti(_0x515bc5(0x12e),_0x4d874a[_0x515bc5(0x11a)],0xbb8),await dpDownloadFile(_0x4d874a[_0x515bc5(0x11a)]));}else console[_0x515bc5(0x13a)](_0x515bc5(0xff));return!![];}}return![];}}),dropboxBackup[_0x235a2e(0xe1)]('click',async function(){var _0x182786=_0x235a2e;const _0x485114=localStorage[_0x182786(0xf7)](_0x182786(0x11b));if(_0x485114===null||_0x485114==='')window[_0x182786(0xef)](_0x182786(0xfc));else{const _0x11d7c7=['state','save'];let _0xdf60d4=0x0;for(const _0x329825 of _0x11d7c7){const _0xf2737e=a0_0x49e1d9['list'+(_0x329825['charAt'](0x0)[_0x182786(0x121)]()+_0x329825[_0x182786(0x11f)](0x1))]();_0xdf60d4+=_0xf2737e[_0x182786(0x10b)];}if(window[_0x182786(0xd2)](_0x182786(0xf0)+_0xdf60d4+'\x20files\x20in\x20Kabu?'))for(const _0x5094ed of _0x11d7c7){const _0x23a5a7=a0_0x49e1d9[_0x182786(0x107)+(_0x5094ed[_0x182786(0x127)](0x0)[_0x182786(0x121)]()+_0x5094ed['slice'](0x1))]();for(const _0x13725e of _0x23a5a7){const _0x2a48f0=await a0_0x49e1d9['downloadFileInCloud'](_0x182786(0x136)+_0x5094ed+'s/'+_0x13725e);try{await lockNoti(_0x182786(0x124),_0x13725e,0xbb8),await dpUploadFile(_0x13725e,_0x2a48f0);if(_0x13725e['endsWith'](_0x182786(0xf1))||_0x13725e[_0x182786(0x113)](_0x182786(0x125))||_0x13725e[_0x182786(0x113)]('.ss2')||_0x13725e[_0x182786(0x113)]('.ss3')||_0x13725e[_0x182786(0x113)](_0x182786(0x135))||_0x13725e[_0x182786(0x113)](_0x182786(0x10a))||_0x13725e['endsWith'](_0x182786(0x100))||_0x13725e[_0x182786(0x113)]('.ss7')){const _0x23a81d=_0x13725e['substring'](0x0,_0x13725e['lastIndexOf']('.')),_0x2d2c8e=_0x13725e['charAt'](_0x13725e[_0x182786(0x10b)]-0x1),_0x3c1a60=localStorage[_0x182786(0xf7)](_0x23a81d+_0x182786(0x115)+_0x2d2c8e),_0x454705=localStorage[_0x182786(0xf7)](_0x23a81d+'.gba_dateState'+_0x2d2c8e);if(_0x3c1a60!==null){const _0x7dd338=_0x3c1a60+'\x0a\x0a'+_0x454705,_0x2cebd7=new Blob([_0x7dd338],{'type':_0x182786(0xf9)});await lockNoti(_0x182786(0x124),_0x23a81d+_0x182786(0x132)+_0x2d2c8e+_0x182786(0xe8),0xbb8),await dpUploadFile(_0x23a81d+'.gba_slot'+_0x2d2c8e+_0x182786(0xe8),_0x2cebd7);}}}catch(_0x50b161){console[_0x182786(0x11d)](_0x182786(0x112)+_0x13725e+':',_0x50b161);}}}else console['log'](_0x182786(0xff));}}),dropboxCloud['addEventListener']('click',function(){var _0x2404b9=_0x235a2e;const _0x43c34b=localStorage['getItem']('uId');_0x43c34b===null||_0x43c34b===''?authorizeWithDropbox():window[_0x2404b9(0xd2)](_0x2404b9(0x11c))&&(localStorage['setItem'](_0x2404b9(0x11b),''),dropboxRestore[_0x2404b9(0x137)][_0x2404b9(0x139)](_0x2404b9(0xd9)),dropboxBackup[_0x2404b9(0x137)][_0x2404b9(0x139)](_0x2404b9(0xd9)),dropboxCloud[_0x2404b9(0x137)]['remove'](_0x2404b9(0xd9)));}),handleDropboxCallback();});