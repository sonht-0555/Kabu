var a0_0x3be54f=a0_0x3c30;(function(_0x4f486e,_0x29d300){var _0x10a459=a0_0x3c30,_0x322577=_0x4f486e();while(!![]){try{var _0x5a044c=parseInt(_0x10a459(0x184))/0x1+parseInt(_0x10a459(0x15a))/0x2*(-parseInt(_0x10a459(0x190))/0x3)+parseInt(_0x10a459(0x168))/0x4*(-parseInt(_0x10a459(0x140))/0x5)+parseInt(_0x10a459(0x133))/0x6*(-parseInt(_0x10a459(0x156))/0x7)+-parseInt(_0x10a459(0x17a))/0x8*(parseInt(_0x10a459(0x16e))/0x9)+-parseInt(_0x10a459(0x18b))/0xa+parseInt(_0x10a459(0x182))/0xb;if(_0x5a044c===_0x29d300)break;else _0x322577['push'](_0x322577['shift']());}catch(_0xbd571){_0x322577['push'](_0x322577['shift']());}}}(a0_0x28dd,0xe45e9));import*as a0_0x55d056 from'./main.js';function a0_0x3c30(_0x22795c,_0x52ad5f){var _0x28dd37=a0_0x28dd();return a0_0x3c30=function(_0x3c309c,_0x5c3bf2){_0x3c309c=_0x3c309c-0x12d;var _0x332680=_0x28dd37[_0x3c309c];return _0x332680;},a0_0x3c30(_0x22795c,_0x52ad5f);}import{localStorageFile}from'./storage.js';var clientId=a0_0x3be54f(0x16b),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x391d38=a0_0x3be54f,_0x45e140=window[_0x391d38(0x137)][_0x391d38(0x13e)][_0x391d38(0x18a)]('?')[0x0],_0x4b9efa=_0x391d38(0x158),_0x17d230=_0x391d38(0x147),_0x62eaeb='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x391d38(0x155)+_0x4b9efa+'&token_access_type='+_0x17d230+'&redirect_uri='+encodeURIComponent(_0x45e140);window[_0x391d38(0x137)][_0x391d38(0x13e)]=_0x62eaeb;}function handleDropboxCallback(){var _0x721e2b=a0_0x3be54f,_0x5413e7=getUrlParameter(_0x721e2b(0x158));_0x5413e7?(getAccessToken(_0x5413e7),console['log']('Authorization\x20Code:',_0x5413e7)):console[_0x721e2b(0x14c)](_0x721e2b(0x17c));}function a0_0x28dd(){var _0x431671=['Do\x20you\x20want\x20to\x20logout?','.tag','href','name','5vawraJ','exec','No\x20files\x20found\x20to\x20restore.','authorization_code','Unable\x20to\x20refresh\x20token','POST',',\x20status:\x20','offline','Restoring...','search','Wait\x20a\x20little\x20bit...','https://api.dropbox.com/oauth2/token','log','onload','Kabu\x20storage\x20↦\x20Cloud\x20◆','remove','&grant_type=','application/json','No\x20refresh\x20token','open','[\x5c?&#]','&response_type=','133RlsTaU','error_description','code','length','4wZkdPR','blob','classList','refreshToken','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','json','alert','click','uploadFileInCloud','map','overwrite','Error\x20creating\x20folder\x20','Bearer\x20','1814012UHanzI','Error\x20while\x20refreshing\x20token:','active','knh3uz2mx2hp2eu','state','https://api.dropboxapi.com/oauth2/token','1142487yiEpCw','Failed\x20to\x20upload\x20file\x20','entries','save','access_token','Refreshing\x20token...','Do\x20you\x20want\x20to\x20restore\x20','status','parse','=([^&#]*)','Do\x20you\x20want\x20to\x20backup\x20','DOMContentLoaded','88gfBYhw','\x20files\x20from\x20Cloud?','Do\x20not\x20receive\x20authorization','https://content.dropboxapi.com/2/files/download','Folder\x20already\x20exists','downloadFileInCloud','Backing\x20up...','setItem','47236442GHcUWD','accessToken','833071zmqbrO','code=','error','responseText','https://api.dropboxapi.com/2/files/create_folder_v2','Folder\x20created','split','3786190MlvuoR','folder','Failed\x20to\x20refresh\x20Dropbox\x20token.','uId','&client_secret=','1842972EohtWB','/data/','filter','replace','confirm','screenshot','Restore\x20canceled\x20by\x20user.','application/octet-stream','addEventListener','Download\x20failed,\x20unknown\x20http\x20status:','232026pZOrzH','getItem','https://api.dropboxapi.com/2/files/list_folder','&client_id=','location','uid','stringify','Cloud\x20login\x20required!','application/x-www-form-urlencoded'];a0_0x28dd=function(){return _0x431671;};return a0_0x28dd();}function getUrlParameter(_0x1c717c){var _0x4e0b6c=a0_0x3be54f;_0x1c717c=_0x1c717c[_0x4e0b6c(0x193)](/[\[]/,'\x5c[')[_0x4e0b6c(0x193)](/[\]]/,'\x5c]');var _0x40c186=new RegExp(_0x4e0b6c(0x154)+_0x1c717c+_0x4e0b6c(0x177)),_0x440d61=_0x40c186[_0x4e0b6c(0x141)](location[_0x4e0b6c(0x149)]);return _0x440d61===null?'':decodeURIComponent(_0x440d61[0x1][_0x4e0b6c(0x193)](/\+/g,'\x20'));}function getAccessToken(_0x24893f){var _0x2c3499=a0_0x3be54f,_0x3bdf44=_0x2c3499(0x143),_0x136d70=window['location'][_0x2c3499(0x13e)][_0x2c3499(0x18a)]('?')[0x0],_0x3394b9=new XMLHttpRequest();_0x3394b9[_0x2c3499(0x153)](_0x2c3499(0x145),_0x2c3499(0x14b)),_0x3394b9['setRequestHeader']('Content-Type',_0x2c3499(0x13b)),_0x3394b9[_0x2c3499(0x14d)]=function(){var _0x572c03=_0x2c3499;if(_0x3394b9[_0x572c03(0x175)]===0xc8){var _0x1bf0a1=JSON[_0x572c03(0x176)](_0x3394b9[_0x572c03(0x187)]),_0x17ed5e=_0x1bf0a1['access_token'],_0x55c0ad=_0x1bf0a1['refresh_token'],_0x33873c=_0x1bf0a1[_0x572c03(0x138)];localStorage[_0x572c03(0x181)](_0x572c03(0x183),_0x17ed5e),localStorage[_0x572c03(0x181)](_0x572c03(0x15d),_0x55c0ad),localStorage[_0x572c03(0x181)](_0x572c03(0x18e),_0x33873c);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x3394b9['send'](_0x2c3499(0x185)+_0x24893f+_0x2c3499(0x150)+_0x3bdf44+_0x2c3499(0x136)+clientId+_0x2c3499(0x18f)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x136d70));}export async function dpCreateFolder(_0x2f148){var _0x4f85a8=a0_0x3be54f;const _0x3a203f=localStorage[_0x4f85a8(0x134)]('uId');let _0xcf2481=localStorage['getItem'](_0x4f85a8(0x183));const _0x356035='/'+_0x3a203f+'/'+_0x2f148,_0x3aa2c9=JSON['stringify']({'path':_0x356035,'autorename':![]});for(let _0x4722d7=0x0;_0x4722d7<0x2;_0x4722d7++){try{const _0x4c94bd=await fetch(_0x4f85a8(0x188),{'method':_0x4f85a8(0x145),'headers':{'Authorization':_0x4f85a8(0x167)+_0xcf2481,'Content-Type':'application/json'},'body':_0x3aa2c9});if(_0x4c94bd[_0x4f85a8(0x175)]===0x191){const _0x556898=await dpRefreshToken();if(!_0x556898)throw new Error(_0x4f85a8(0x144));_0xcf2481=localStorage[_0x4f85a8(0x134)](_0x4f85a8(0x183));continue;}if(_0x4c94bd[_0x4f85a8(0x175)]===0x199)return{'message':_0x4f85a8(0x17e),'path':_0x2f148};if(!_0x4c94bd['ok'])throw new Error(_0x4f85a8(0x166)+_0x2f148);const _0x360aae=await _0x4c94bd[_0x4f85a8(0x160)]();return await lockNoti(_0x4f85a8(0x189),'',0xbb8),_0x360aae;}catch(_0x55e39e){if(_0x4722d7===0x1)throw _0x55e39e;}}return![];}export async function dpRefreshToken(){var _0xe9a445=a0_0x3be54f;if(!localStorage['getItem'](_0xe9a445(0x15d)))throw _0xe9a445(0x152);try{const _0x374ee6=await fetch(_0xe9a445(0x16d),{'method':_0xe9a445(0x145),'headers':{'Content-Type':_0xe9a445(0x13b)},'body':'refresh_token='+localStorage[_0xe9a445(0x134)](_0xe9a445(0x15d))+_0xe9a445(0x15f)}),_0x12c46d=await _0x374ee6[_0xe9a445(0x160)]();if(!_0x12c46d[_0xe9a445(0x186)])return localStorage[_0xe9a445(0x181)](_0xe9a445(0x183),_0x12c46d[_0xe9a445(0x172)]),await lockNoti(_0xe9a445(0x173),'',0xbb8),await delay(0x3e8),!![];else alert(_0x12c46d[_0xe9a445(0x157)]||_0xe9a445(0x18d));}catch(_0x6d6f74){console['error'](_0xe9a445(0x169),_0x6d6f74);}return![];}export async function dpUploadFile(_0x16ccf5,_0x4ba91d,_0x5d89e2){var _0x3d3a9c=a0_0x3be54f;const _0x1ec653=localStorage[_0x3d3a9c(0x134)]('uId');var _0x5c8c0b=JSON[_0x3d3a9c(0x139)]({'autorename':!![],'mode':_0x3d3a9c(0x165),'mute':!![],'strict_conflict':![],'path':'/'+_0x1ec653+'/'+_0x5d89e2+'/'+_0x16ccf5}),_0x38a510=new Blob([_0x4ba91d],{'type':_0x3d3a9c(0x130)});for(var _0x4211ad=0x0;_0x4211ad<0x2;_0x4211ad++){var _0x108d99=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x3d3a9c(0x145),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x3d3a9c(0x134)](_0x3d3a9c(0x183)),'Dropbox-API-Arg':_0x5c8c0b,'Content-Type':_0x3d3a9c(0x130)},'body':_0x38a510});if(_0x108d99[_0x3d3a9c(0x175)]!=0xc8){if(_0x108d99[_0x3d3a9c(0x175)]==0x191){var _0x11119f=await dpRefreshToken();if(!_0x11119f)throw _0x3d3a9c(0x144);continue;}else throw _0x3d3a9c(0x15e)+_0x108d99[_0x3d3a9c(0x175)];}else{var _0x3c9053=await _0x108d99[_0x3d3a9c(0x160)]();return console['log'](_0x3d3a9c(0x14e),_0x16ccf5),_0x3c9053;}}return![];}export async function dpDownloadFile(_0x41bdab,_0x4df627){var _0x4fc0a7=a0_0x3be54f;const _0x1ce6f3=localStorage[_0x4fc0a7(0x134)](_0x4fc0a7(0x18e));var _0x4fb86d=JSON[_0x4fc0a7(0x139)]({'path':'/'+_0x1ce6f3+'/'+_0x4df627+'/'+_0x41bdab});for(var _0x1c17ef=0x0;_0x1c17ef<0x2;_0x1c17ef++){var _0x15fdb7=await fetch(_0x4fc0a7(0x17d),{'method':_0x4fc0a7(0x145),'headers':{'Authorization':_0x4fc0a7(0x167)+localStorage[_0x4fc0a7(0x134)](_0x4fc0a7(0x183)),'Dropbox-API-Arg':_0x4fb86d}});if(_0x15fdb7['status']!=0xc8){if(_0x15fdb7['status']==0x191){var _0x26f43c=await dpRefreshToken();if(!_0x26f43c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x4fc0a7(0x132)+_0x15fdb7[_0x4fc0a7(0x175)];}const _0x458db9=new File([await _0x15fdb7[_0x4fc0a7(0x15b)]()],_0x41bdab);return console['log']('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x458db9[_0x4fc0a7(0x13f)]),a0_0x55d056[_0x4fc0a7(0x163)](_0x458db9,()=>{}),_0x458db9;}return![];}document['addEventListener'](a0_0x3be54f(0x179),function(){var _0x1bff2c=a0_0x3be54f;dropboxRestore[_0x1bff2c(0x131)]('click',async function(){var _0x29efd6=_0x1bff2c;await lockNoti(_0x29efd6(0x14a),'',0x1388);const _0x34db9f=localStorage[_0x29efd6(0x134)]('uId'),_0x2af3ff=[_0x29efd6(0x16c),_0x29efd6(0x171),_0x29efd6(0x12e)];if(!_0x34db9f){window[_0x29efd6(0x161)](_0x29efd6(0x13a));return;}let _0x6ad5f1=[];for(const _0x58f35e of _0x2af3ff){let _0x518287={'path':'/'+_0x34db9f+'/'+_0x58f35e};for(let _0x49915a=0x0;_0x49915a<0x2;_0x49915a++){let _0x6aa54c=await fetch(_0x29efd6(0x135),{'method':_0x29efd6(0x145),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x29efd6(0x134)]('accessToken'),'Content-Type':_0x29efd6(0x151)},'body':JSON[_0x29efd6(0x139)](_0x518287)});if(_0x6aa54c[_0x29efd6(0x175)]===0xc8){let _0x47922c=await _0x6aa54c['json'](),_0xd1fd5c=_0x47922c[_0x29efd6(0x170)][_0x29efd6(0x192)](_0x1482ad=>_0x1482ad[_0x29efd6(0x13d)]==='file');_0xd1fd5c[_0x29efd6(0x159)]>0x0&&_0x6ad5f1['push'](..._0xd1fd5c[_0x29efd6(0x164)](_0x1a1f2d=>({'name':_0x1a1f2d[_0x29efd6(0x13f)],'folder':_0x58f35e})));break;}else{if(_0x6aa54c[_0x29efd6(0x175)]===0x191){let _0x87015a=await dpRefreshToken();if(!_0x87015a)throw _0x29efd6(0x144);}else{console[_0x29efd6(0x186)]('Download\x20failed\x20for\x20'+_0x58f35e+_0x29efd6(0x146)+_0x6aa54c[_0x29efd6(0x175)]);break;}}}}if(_0x6ad5f1['length']>0x0){const _0x1a237a=_0x29efd6(0x174)+_0x6ad5f1[_0x29efd6(0x159)]+_0x29efd6(0x17b);if(window[_0x29efd6(0x12d)](_0x1a237a))for(const _0x4ce8de of _0x6ad5f1){await lockNoti(_0x29efd6(0x148),_0x4ce8de[_0x29efd6(0x13f)],0xbb8),await dpDownloadFile(_0x4ce8de[_0x29efd6(0x13f)],_0x4ce8de[_0x29efd6(0x18c)]);}else console[_0x29efd6(0x14c)]('Restore\x20canceled\x20by\x20user.');}else console[_0x29efd6(0x14c)](_0x29efd6(0x142));}),dropboxBackup[_0x1bff2c(0x131)](_0x1bff2c(0x162),async function(){var _0x23e5e9=_0x1bff2c;await lockNoti(_0x23e5e9(0x14a),'',0x1388);const _0xe10490=localStorage[_0x23e5e9(0x134)](_0x23e5e9(0x18e));if(_0xe10490===null||_0xe10490==='')window[_0x23e5e9(0x161)](_0x23e5e9(0x13a));else{const _0x10db7d=[_0x23e5e9(0x16c),_0x23e5e9(0x171),_0x23e5e9(0x12e)];for(const _0x45039e of _0x10db7d){await dpCreateFolder(_0x45039e);}let _0xc816a9=0x0;for(const _0x3c35e6 of _0x10db7d){const _0x5c5b1a=a0_0x55d056['listFiles'](_0x3c35e6+'s');_0xc816a9+=_0x5c5b1a['length'];}if(window['confirm'](_0x23e5e9(0x178)+_0xc816a9+'\x20files\x20in\x20Kabu?'))for(const _0x324e53 of _0x10db7d){const _0x41e5db=a0_0x55d056['listFiles'](_0x324e53+'s');for(const _0x3b758f of _0x41e5db){const _0x2430e2=await a0_0x55d056[_0x23e5e9(0x17f)](_0x23e5e9(0x191)+_0x324e53+'s/'+_0x3b758f);try{await lockNoti(_0x23e5e9(0x180),_0x3b758f,0xbb8),await dpUploadFile(_0x3b758f,_0x2430e2,_0x324e53);}catch(_0xfbebcd){console[_0x23e5e9(0x186)](_0x23e5e9(0x16f)+_0x3b758f+':',_0xfbebcd);}}}else console[_0x23e5e9(0x14c)](_0x23e5e9(0x12f));}}),dropboxCloud[_0x1bff2c(0x131)](_0x1bff2c(0x162),function(){var _0x11c83d=_0x1bff2c;const _0xfe733=localStorage[_0x11c83d(0x134)](_0x11c83d(0x18e));_0xfe733===null||_0xfe733===''?authorizeWithDropbox():window[_0x11c83d(0x12d)](_0x11c83d(0x13c))&&(localStorage['setItem'](_0x11c83d(0x18e),''),dropboxRestore[_0x11c83d(0x15c)][_0x11c83d(0x14f)](_0x11c83d(0x16a)),dropboxBackup['classList'][_0x11c83d(0x14f)](_0x11c83d(0x16a)),dropboxCloud[_0x11c83d(0x15c)][_0x11c83d(0x14f)](_0x11c83d(0x16a)));}),handleDropboxCallback();});