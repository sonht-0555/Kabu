var a0_0x4a9810=a0_0x1c18;(function(_0x25ef1c,_0x221cdb){var _0xd83e8d=a0_0x1c18,_0x3f9183=_0x25ef1c();while(!![]){try{var _0x730a14=parseInt(_0xd83e8d(0x1a0))/0x1+parseInt(_0xd83e8d(0x1ad))/0x2+parseInt(_0xd83e8d(0x1d3))/0x3+parseInt(_0xd83e8d(0x1e1))/0x4+parseInt(_0xd83e8d(0x1d1))/0x5*(parseInt(_0xd83e8d(0x1bc))/0x6)+-parseInt(_0xd83e8d(0x18a))/0x7*(-parseInt(_0xd83e8d(0x1ac))/0x8)+-parseInt(_0xd83e8d(0x1d9))/0x9*(parseInt(_0xd83e8d(0x18e))/0xa);if(_0x730a14===_0x221cdb)break;else _0x3f9183['push'](_0x3f9183['shift']());}catch(_0x417f68){_0x3f9183['push'](_0x3f9183['shift']());}}}(a0_0x5781,0x261ab));import*as a0_0x3c973a from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1c18(_0x3452ab,_0x24709){var _0x57813f=a0_0x5781();return a0_0x1c18=function(_0x1c183e,_0x3f8c34){_0x1c183e=_0x1c183e-0x182;var _0x5df894=_0x57813f[_0x1c183e];return _0x5df894;},a0_0x1c18(_0x3452ab,_0x24709);}var clientId=a0_0x4a9810(0x194),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x26814e=a0_0x4a9810,_0x40ad9b=window['location']['href'][_0x26814e(0x1af)]('?')[0x0],_0x5ddc05=_0x26814e(0x1a2),_0x1d5d3f='offline',_0x186a65='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x26814e(0x19d)+_0x5ddc05+_0x26814e(0x1d8)+_0x1d5d3f+_0x26814e(0x1b5)+encodeURIComponent(_0x40ad9b);window[_0x26814e(0x18c)][_0x26814e(0x1b3)]=_0x186a65;}function handleDropboxCallback(){var _0x43cf14=a0_0x4a9810,_0x4ca264=getUrlParameter(_0x43cf14(0x1a2));_0x4ca264?(getAccessToken(_0x4ca264),console[_0x43cf14(0x19b)]('Authorization\x20Code:',_0x4ca264)):console[_0x43cf14(0x19b)](_0x43cf14(0x1a7));}function getUrlParameter(_0x4a9643){var _0x346ab2=a0_0x4a9810;_0x4a9643=_0x4a9643[_0x346ab2(0x1bd)](/[\[]/,'\x5c[')[_0x346ab2(0x1bd)](/[\]]/,'\x5c]');var _0x326937=new RegExp(_0x346ab2(0x1a6)+_0x4a9643+_0x346ab2(0x184)),_0x5ce2d2=_0x326937['exec'](location[_0x346ab2(0x1c7)]);return _0x5ce2d2===null?'':decodeURIComponent(_0x5ce2d2[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x2ed5e7){var _0x1ce68e=a0_0x4a9810,_0x36c7b7='authorization_code',_0xd35c28=window[_0x1ce68e(0x18c)][_0x1ce68e(0x1b3)][_0x1ce68e(0x1af)]('?')[0x0],_0x4cde98=new XMLHttpRequest();_0x4cde98[_0x1ce68e(0x1b7)](_0x1ce68e(0x1d4),_0x1ce68e(0x1c5)),_0x4cde98['setRequestHeader'](_0x1ce68e(0x1b0),_0x1ce68e(0x199)),_0x4cde98[_0x1ce68e(0x1c8)]=function(){var _0x2b71ae=_0x1ce68e;if(_0x4cde98[_0x2b71ae(0x183)]===0xc8){var _0x1484b5=JSON[_0x2b71ae(0x1cb)](_0x4cde98['responseText']),_0x4e7f74=_0x1484b5[_0x2b71ae(0x1cf)],_0x40b6f0=_0x1484b5[_0x2b71ae(0x1ae)],_0x41b04e=_0x1484b5['uid'];localStorage['setItem'](_0x2b71ae(0x1e5),_0x4e7f74),localStorage[_0x2b71ae(0x198)](_0x2b71ae(0x189),_0x40b6f0),localStorage['setItem'](_0x2b71ae(0x196),_0x41b04e);}else console[_0x2b71ae(0x19b)](_0x2b71ae(0x1ab));},_0x4cde98['send'](_0x1ce68e(0x1b6)+_0x2ed5e7+'&grant_type='+_0x36c7b7+_0x1ce68e(0x191)+clientId+_0x1ce68e(0x1a5)+clientSecret+_0x1ce68e(0x1b5)+encodeURIComponent(_0xd35c28));}export async function dpCreateFolder(_0x15370b){var _0x4ac273=a0_0x4a9810;const _0x285b56=localStorage[_0x4ac273(0x19c)](_0x4ac273(0x196));let _0x492342=localStorage[_0x4ac273(0x19c)]('accessToken');const _0x57c0a3='/'+_0x285b56+'/'+_0x15370b,_0x15bb73=JSON[_0x4ac273(0x1dc)]({'path':_0x57c0a3,'autorename':![]});for(let _0x1e77d8=0x0;_0x1e77d8<0x2;_0x1e77d8++){try{const _0x2b1638=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':'POST','headers':{'Authorization':_0x4ac273(0x1ce)+_0x492342,'Content-Type':_0x4ac273(0x1e6)},'body':_0x15bb73});if(_0x2b1638[_0x4ac273(0x183)]===0x191){const _0x195ecd=await dpRefreshToken();if(!_0x195ecd)throw new Error(_0x4ac273(0x1a9));_0x492342=localStorage['getItem'](_0x4ac273(0x1e5));continue;}if(_0x2b1638[_0x4ac273(0x183)]===0x199)return{'message':_0x4ac273(0x188),'path':_0x15370b};if(!_0x2b1638['ok'])throw new Error(_0x4ac273(0x185)+_0x15370b);const _0x36646b=await _0x2b1638[_0x4ac273(0x1c0)]();return await lockNoti(_0x4ac273(0x1a3),'',0xbb8),_0x36646b;}catch(_0x300065){if(_0x1e77d8===0x1)throw _0x300065;}}return![];}export async function dpRefreshToken(){var _0x1d69d8=a0_0x4a9810;if(!localStorage[_0x1d69d8(0x19c)](_0x1d69d8(0x189)))throw'No\x20refresh\x20token';try{const _0x1e43b6=await fetch(_0x1d69d8(0x182),{'method':'POST','headers':{'Content-Type':_0x1d69d8(0x199)},'body':_0x1d69d8(0x1e3)+localStorage[_0x1d69d8(0x19c)](_0x1d69d8(0x189))+_0x1d69d8(0x1cd)}),_0x3dc416=await _0x1e43b6['json']();if(!_0x3dc416[_0x1d69d8(0x190)])return localStorage[_0x1d69d8(0x198)](_0x1d69d8(0x1e5),_0x3dc416[_0x1d69d8(0x1cf)]),await lockNoti(_0x1d69d8(0x1c2),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3dc416[_0x1d69d8(0x187)]||_0x1d69d8(0x1e2));}catch(_0x15a74e){console[_0x1d69d8(0x190)](_0x1d69d8(0x1e7),_0x15a74e);}return![];}export async function dpUploadFile(_0x103c93,_0x34d812,_0x34ed54){var _0x1a6a50=a0_0x4a9810;const _0x2d113c=localStorage[_0x1a6a50(0x19c)](_0x1a6a50(0x196));var _0x76a4a8=JSON[_0x1a6a50(0x1dc)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x2d113c+'/'+_0x34ed54+'/'+_0x103c93}),_0x58b7ac=new Blob([_0x34d812],{'type':_0x1a6a50(0x197)});for(var _0x756c8=0x0;_0x756c8<0x2;_0x756c8++){var _0x552f83=await fetch(_0x1a6a50(0x1e0),{'method':_0x1a6a50(0x1d4),'headers':{'Authorization':_0x1a6a50(0x1ce)+localStorage[_0x1a6a50(0x19c)](_0x1a6a50(0x1e5)),'Dropbox-API-Arg':_0x76a4a8,'Content-Type':_0x1a6a50(0x197)},'body':_0x58b7ac});if(_0x552f83[_0x1a6a50(0x183)]!=0xc8){if(_0x552f83[_0x1a6a50(0x183)]==0x191){var _0xc0dc82=await dpRefreshToken();if(!_0xc0dc82)throw _0x1a6a50(0x1a9);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x552f83[_0x1a6a50(0x183)];}else{var _0x21acce=await _0x552f83[_0x1a6a50(0x1c0)]();return console[_0x1a6a50(0x19b)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x103c93),_0x21acce;}}return![];}export async function dpDownloadFile(_0x1d0cf4,_0x281d28){var _0x34b6ae=a0_0x4a9810;const _0x47473=localStorage[_0x34b6ae(0x19c)](_0x34b6ae(0x196));var _0x4f0e02=JSON[_0x34b6ae(0x1dc)]({'path':'/'+_0x47473+'/'+_0x281d28+'/'+_0x1d0cf4});for(var _0x2981d3=0x0;_0x2981d3<0x2;_0x2981d3++){var _0x291193=await fetch(_0x34b6ae(0x1e4),{'method':_0x34b6ae(0x1d4),'headers':{'Authorization':_0x34b6ae(0x1ce)+localStorage[_0x34b6ae(0x19c)](_0x34b6ae(0x1e5)),'Dropbox-API-Arg':_0x4f0e02}});if(_0x291193[_0x34b6ae(0x183)]!=0xc8){if(_0x291193[_0x34b6ae(0x183)]==0x191){var _0x4e456b=await dpRefreshToken();if(!_0x4e456b)throw _0x34b6ae(0x1a9);continue;}else throw _0x34b6ae(0x1d0)+_0x291193['status'];}const _0x2e9ecb=new File([await _0x291193[_0x34b6ae(0x1bb)]()],_0x1d0cf4);return console[_0x34b6ae(0x19b)](_0x34b6ae(0x1dd),_0x2e9ecb[_0x34b6ae(0x1bf)]),a0_0x3c973a[_0x34b6ae(0x19e)](_0x2e9ecb,()=>{var _0xd8c82a=_0x34b6ae;localStorageFile(),Module[_0xd8c82a(0x1b1)]();}),_0x2e9ecb;}return![];}function a0_0x5781(){var _0x42c6b4=['Folder\x20already\x20exists','refreshToken','21OakwSZ','DOMContentLoaded','location','Do\x20you\x20want\x20to\x20restore\x20','30QlMtec','list','error','&client_id=','click','Do\x20you\x20want\x20to\x20backup\x20','knh3uz2mx2hp2eu','\x20files\x20in\x20Kabu?','uId','application/octet-stream','setItem','application/x-www-form-urlencoded','/data/','log','getItem','&response_type=','uploadFileInCloud','toUpperCase','82530nCILKX','Failed\x20to\x20upload\x20file\x20','code','Folder\x20created','addEventListener','&client_secret=','[\x5c?&#]','Do\x20not\x20receive\x20authorization','Cloud\x20login\x20required!','Unable\x20to\x20refresh\x20token','confirm','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','456888HWUGiW','580658RNyGBO','refresh_token','split','Content-Type','FSSync','.tag','href',',\x20status:\x20','&redirect_uri=','code=','open','screenshot','save','remove','blob','66JZOBwq','replace','map','name','json','Do\x20you\x20want\x20to\x20logout?','Refreshing\x20token...','length','Restoring...','https://api.dropbox.com/oauth2/token','classList','search','onload','entries','filter','parse','\x20files\x20from\x20Cloud?','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Bearer\x20','access_token','Download\x20failed,\x20unknown\x20http\x20status:','25130hkVaXC','alert','907749ioozMi','POST','Wait\x20a\x20little\x20bit...','active','folder','&token_access_type=','2727567XSpZtu','https://api.dropboxapi.com/2/files/list_folder','slice','stringify','Cloud\x20↦\x20Kabu\x20storage\x20◆','Restore\x20canceled\x20by\x20user.','No\x20files\x20found\x20to\x20restore.','https://content.dropboxapi.com/2/files/upload','652812LCVMph','Failed\x20to\x20refresh\x20Dropbox\x20token.','refresh_token=','https://content.dropboxapi.com/2/files/download','accessToken','application/json','Error\x20while\x20refreshing\x20token:','https://api.dropboxapi.com/oauth2/token','status','=([^&#]*)','Error\x20creating\x20folder\x20','charAt','error_description'];a0_0x5781=function(){return _0x42c6b4;};return a0_0x5781();}document[a0_0x4a9810(0x1a4)](a0_0x4a9810(0x18b),function(){var _0x48cf5b=a0_0x4a9810;dropboxRestore[_0x48cf5b(0x1a4)](_0x48cf5b(0x192),async function(){var _0x448549=_0x48cf5b;await lockNoti(_0x448549(0x1d5),'',0x1388);const _0x20b863=localStorage[_0x448549(0x19c)](_0x448549(0x196)),_0x472eaa=['state',_0x448549(0x1b9),_0x448549(0x1b8)];if(!_0x20b863){window[_0x448549(0x1d2)](_0x448549(0x1a8));return;}let _0x429a0a=[];for(const _0x3163d5 of _0x472eaa){let _0xb47253={'path':'/'+_0x20b863+'/'+_0x3163d5};for(let _0x5becca=0x0;_0x5becca<0x2;_0x5becca++){let _0x5032ee=await fetch(_0x448549(0x1da),{'method':_0x448549(0x1d4),'headers':{'Authorization':_0x448549(0x1ce)+localStorage[_0x448549(0x19c)](_0x448549(0x1e5)),'Content-Type':_0x448549(0x1e6)},'body':JSON[_0x448549(0x1dc)](_0xb47253)});if(_0x5032ee[_0x448549(0x183)]===0xc8){let _0x4702fc=await _0x5032ee[_0x448549(0x1c0)](),_0x3bfe0a=_0x4702fc[_0x448549(0x1c9)][_0x448549(0x1ca)](_0x1c06c7=>_0x1c06c7[_0x448549(0x1b2)]==='file');_0x3bfe0a['length']>0x0&&_0x429a0a['push'](..._0x3bfe0a[_0x448549(0x1be)](_0x3c46c8=>({'name':_0x3c46c8[_0x448549(0x1bf)],'folder':_0x3163d5})));break;}else{if(_0x5032ee[_0x448549(0x183)]===0x191){let _0x24ada5=await dpRefreshToken();if(!_0x24ada5)throw _0x448549(0x1a9);}else{console[_0x448549(0x190)]('Download\x20failed\x20for\x20'+_0x3163d5+_0x448549(0x1b4)+_0x5032ee[_0x448549(0x183)]);break;}}}}if(_0x429a0a[_0x448549(0x1c3)]>0x0){const _0x2e2c97=_0x448549(0x18d)+_0x429a0a[_0x448549(0x1c3)]+_0x448549(0x1cc);if(window[_0x448549(0x1aa)](_0x2e2c97))for(const _0x2554d5 of _0x429a0a){await lockNoti(_0x448549(0x1c4),_0x2554d5[_0x448549(0x1bf)],0xbb8),await dpDownloadFile(_0x2554d5['name'],_0x2554d5[_0x448549(0x1d7)]);}else console[_0x448549(0x19b)]('Restore\x20canceled\x20by\x20user.');}else console[_0x448549(0x19b)](_0x448549(0x1df));}),dropboxBackup[_0x48cf5b(0x1a4)](_0x48cf5b(0x192),async function(){var _0x3cb021=_0x48cf5b;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x20b6eb=localStorage['getItem'](_0x3cb021(0x196));if(_0x20b6eb===null||_0x20b6eb==='')window[_0x3cb021(0x1d2)]('Cloud\x20login\x20required!');else{const _0x3dfd8f=['state','save',_0x3cb021(0x1b8)];for(const _0x5f5c33 of _0x3dfd8f){await dpCreateFolder(_0x5f5c33);}let _0x4f08a4=0x0;for(const _0x1f7c72 of _0x3dfd8f){const _0x4532da=a0_0x3c973a[_0x3cb021(0x18f)+(_0x1f7c72[_0x3cb021(0x186)](0x0)[_0x3cb021(0x19f)]()+_0x1f7c72[_0x3cb021(0x1db)](0x1))]();_0x4f08a4+=_0x4532da[_0x3cb021(0x1c3)];}if(window['confirm'](_0x3cb021(0x193)+_0x4f08a4+_0x3cb021(0x195)))for(const _0x27f8df of _0x3dfd8f){const _0x2c7fa7=a0_0x3c973a[_0x3cb021(0x18f)+(_0x27f8df[_0x3cb021(0x186)](0x0)[_0x3cb021(0x19f)]()+_0x27f8df[_0x3cb021(0x1db)](0x1))]();for(const _0x1f1959 of _0x2c7fa7){const _0x55fa4d=await a0_0x3c973a['downloadFileInCloud'](_0x3cb021(0x19a)+_0x27f8df+'s/'+_0x1f1959);try{await lockNoti('Backing\x20up...',_0x1f1959,0xbb8),await dpUploadFile(_0x1f1959,_0x55fa4d,_0x27f8df);}catch(_0x489a70){console[_0x3cb021(0x190)](_0x3cb021(0x1a1)+_0x1f1959+':',_0x489a70);}}}else console[_0x3cb021(0x19b)](_0x3cb021(0x1de));}}),dropboxCloud[_0x48cf5b(0x1a4)](_0x48cf5b(0x192),function(){var _0xcab177=_0x48cf5b;const _0x1508ba=localStorage['getItem'](_0xcab177(0x196));_0x1508ba===null||_0x1508ba===''?authorizeWithDropbox():window['confirm'](_0xcab177(0x1c1))&&(localStorage['setItem'](_0xcab177(0x196),''),dropboxRestore[_0xcab177(0x1c6)][_0xcab177(0x1ba)](_0xcab177(0x1d6)),dropboxBackup[_0xcab177(0x1c6)]['remove'](_0xcab177(0x1d6)),dropboxCloud[_0xcab177(0x1c6)][_0xcab177(0x1ba)](_0xcab177(0x1d6)));}),handleDropboxCallback();});