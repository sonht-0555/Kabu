var a0_0x5cdbab=a0_0x33bc;(function(_0x167c40,_0x3c93d0){var _0x532cba=a0_0x33bc,_0x51c144=_0x167c40();while(!![]){try{var _0x4eadc2=-parseInt(_0x532cba(0x197))/0x1*(parseInt(_0x532cba(0x1c3))/0x2)+-parseInt(_0x532cba(0x1c9))/0x3*(parseInt(_0x532cba(0x1a4))/0x4)+-parseInt(_0x532cba(0x1d8))/0x5+parseInt(_0x532cba(0x1a9))/0x6*(parseInt(_0x532cba(0x1bf))/0x7)+parseInt(_0x532cba(0x1dd))/0x8*(parseInt(_0x532cba(0x1c1))/0x9)+parseInt(_0x532cba(0x1b8))/0xa+-parseInt(_0x532cba(0x1b2))/0xb*(parseInt(_0x532cba(0x1ad))/0xc);if(_0x4eadc2===_0x3c93d0)break;else _0x51c144['push'](_0x51c144['shift']());}catch(_0x2b6e2f){_0x51c144['push'](_0x51c144['shift']());}}}(a0_0x4e4b,0x2649a));function a0_0x4e4b(){var _0xbe148b=['status:\x20','Bearer\x20','uid','click','entries','nwb3dnfh09rhs31','text','_dateState','offline','text/plain','length','1283030miOaEL','Upload\x20failed,\x20unknown\x20http\x20status:\x20','.ss1','.ss2','=([^&#]*)','2020328ybDdqV','/data/','Restore\x20canceled\x20by\x20user.','Kabu\x20storage\x20↦\x20Cloud\x20◆','DOMContentLoaded','Authorization\x20Code:','https://www.dropbox.com/oauth2/authorize?client_id=','Do\x20you\x20want\x20to\x20logout?','uId','application/json','Content-Type','.ss7','.ss4','Refreshing\x20token...','&redirect_uri=','refreshToken','split','error','Failed\x20to\x20upload\x20file\x20','FSSync','toUpperCase','Cloud\x20↦\x20Kabu\x20storage\x20◆','href','substring','No\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','.gba_dateState','Unable\x20to\x20refresh\x20token','&client_id=','name','.ss5','_imageState','access_token','json','[\x5c?&#]','confirm','setItem','replace','.gba_slot','accessToken','.txt','https://api.dropboxapi.com/2/files/list_folder','setRequestHeader','alert','Do\x20not\x20receive\x20authorization','1KTwMmn','code=','.tag','file','active','status','blob','filter','code','location','POST','state','Do\x20you\x20want\x20to\x20restore\x20','8268pjctPf','.ss3','charAt','lastIndexOf','responseText','8682YYnsFT','stringify','Backing\x20up...','refresh_token=','48VPuuei','&client_secret=','knh3uz2mx2hp2eu','error_description','.ss0','634843UJnONA','application/octet-stream','downloadFileInCloud','Failed\x20to\x20refresh\x20Dropbox\x20token.','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&grant_type=','3081890UhdvXQ','authorization_code','uploadSaveOrSaveState','Do\x20you\x20want\x20to\x20backup\x20','gba','getItem','addEventListener','938tIbhoj','remove','9dqbFXt','classList','195884lEuDkR','Restoring...','log','https://content.dropboxapi.com/2/files/upload','list','slice','18qZGjPH','Cloud\x20login\x20required!','endsWith','save'];a0_0x4e4b=function(){return _0xbe148b;};return a0_0x4e4b();}import*as a0_0x3b7453 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5cdbab(0x1af),clientSecret=a0_0x5cdbab(0x1d2);function a0_0x33bc(_0x5699cb,_0x5ac017){var _0x4e4bbb=a0_0x4e4b();return a0_0x33bc=function(_0x33bc48,_0xcc9d44){_0x33bc48=_0x33bc48-0x18e;var _0x10e616=_0x4e4bbb[_0x33bc48];return _0x10e616;},a0_0x33bc(_0x5699cb,_0x5ac017);}function authorizeWithDropbox(){var _0x266386=a0_0x5cdbab,_0x56bd0a=window[_0x266386(0x1a0)][_0x266386(0x1f3)][_0x266386(0x1ed)]('?')[0x0],_0x22e71a=_0x266386(0x19f),_0x4ddc91=_0x266386(0x1d5),_0x1b10ab=_0x266386(0x1e3)+clientId+'&response_type='+_0x22e71a+'&token_access_type='+_0x4ddc91+'&redirect_uri='+encodeURIComponent(_0x56bd0a);window[_0x266386(0x1a0)][_0x266386(0x1f3)]=_0x1b10ab;}function handleDropboxCallback(){var _0x4d5b54=a0_0x5cdbab,_0x244699=getUrlParameter('code');_0x244699?(getAccessToken(_0x244699),console[_0x4d5b54(0x1c5)](_0x4d5b54(0x1e2),_0x244699)):console[_0x4d5b54(0x1c5)](_0x4d5b54(0x196));}function getUrlParameter(_0x26920f){var _0xb89512=a0_0x5cdbab;_0x26920f=_0x26920f[_0xb89512(0x18f)](/[\[]/,'\x5c[')[_0xb89512(0x18f)](/[\]]/,'\x5c]');var _0x40d281=new RegExp(_0xb89512(0x1ff)+_0x26920f+_0xb89512(0x1dc)),_0x22df77=_0x40d281['exec'](location['search']);return _0x22df77===null?'':decodeURIComponent(_0x22df77[0x1][_0xb89512(0x18f)](/\+/g,'\x20'));}function getAccessToken(_0x1bdd04){var _0x378aff=a0_0x5cdbab,_0x1b97ee=_0x378aff(0x1b9),_0x4ab1a6=window[_0x378aff(0x1a0)][_0x378aff(0x1f3)][_0x378aff(0x1ed)]('?')[0x0],_0x14629b=new XMLHttpRequest();_0x14629b['open'](_0x378aff(0x1a1),'https://api.dropbox.com/oauth2/token'),_0x14629b[_0x378aff(0x194)](_0x378aff(0x1e7),'application/x-www-form-urlencoded'),_0x14629b['onload']=function(){var _0x406498=_0x378aff;if(_0x14629b['status']===0xc8){var _0x15c340=JSON['parse'](_0x14629b[_0x406498(0x1a8)]),_0x396ff6=_0x15c340[_0x406498(0x1fd)],_0x37efba=_0x15c340['refresh_token'],_0x120f29=_0x15c340[_0x406498(0x1cf)];localStorage['setItem'](_0x406498(0x191),_0x396ff6),localStorage['setItem'](_0x406498(0x1ec),_0x37efba),localStorage['setItem'](_0x406498(0x1e5),_0x120f29);}else console[_0x406498(0x1c5)](_0x406498(0x1b6));},_0x14629b['send'](_0x378aff(0x198)+_0x1bdd04+_0x378aff(0x1b7)+_0x1b97ee+_0x378aff(0x1f9)+clientId+_0x378aff(0x1ae)+clientSecret+_0x378aff(0x1eb)+encodeURIComponent(_0x4ab1a6));}export async function dpRefreshToken(){var _0x5bd104=a0_0x5cdbab;if(!localStorage[_0x5bd104(0x1bd)]('refreshToken'))throw _0x5bd104(0x1f5);try{const _0x3b0a7b=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x5bd104(0x1a1),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x5bd104(0x1ac)+localStorage['getItem'](_0x5bd104(0x1ec))+_0x5bd104(0x1f6)}),_0xdef6d1=await _0x3b0a7b[_0x5bd104(0x1fe)]();if(!_0xdef6d1[_0x5bd104(0x1ee)])return localStorage[_0x5bd104(0x18e)](_0x5bd104(0x191),_0xdef6d1['access_token']),await lockNoti('',_0x5bd104(0x1ea),0xbb8),await delay(0x3e8),!![];else alert(_0xdef6d1[_0x5bd104(0x1b0)]||_0x5bd104(0x1b5));}catch(_0x10c6d0){console[_0x5bd104(0x1ee)]('Error\x20while\x20refreshing\x20token:',_0x10c6d0);}return![];}export async function dpUploadFile(_0x1f6046,_0x170f3e){var _0xc4da1c=a0_0x5cdbab;const _0x4051d1=localStorage[_0xc4da1c(0x1bd)](_0xc4da1c(0x1e5));var _0x50153e=JSON[_0xc4da1c(0x1aa)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x4051d1+'/'+_0x1f6046}),_0x412ecc=new Blob([_0x170f3e],{'type':_0xc4da1c(0x1b3)});for(var _0x338f16=0x0;_0x338f16<0x2;_0x338f16++){var _0x10b246=await fetch(_0xc4da1c(0x1c6),{'method':_0xc4da1c(0x1a1),'headers':{'Authorization':_0xc4da1c(0x1ce)+localStorage[_0xc4da1c(0x1bd)](_0xc4da1c(0x191)),'Dropbox-API-Arg':_0x50153e,'Content-Type':_0xc4da1c(0x1b3)},'body':_0x412ecc});if(_0x10b246[_0xc4da1c(0x19c)]!=0xc8){if(_0x10b246[_0xc4da1c(0x19c)]==0x191){var _0x1adc03=await dpRefreshToken();if(!_0x1adc03)throw _0xc4da1c(0x1f8);continue;}else throw _0xc4da1c(0x1d9)+_0x10b246[_0xc4da1c(0x19c)];}else{var _0x2b3935=await _0x10b246[_0xc4da1c(0x1fe)]();return console[_0xc4da1c(0x1c5)](_0xc4da1c(0x1e0),_0x1f6046),_0x2b3935;}}return![];}async function dpDownloadFile(_0x6d34c5){var _0x572572=a0_0x5cdbab;const _0xb599b5=localStorage[_0x572572(0x1bd)](_0x572572(0x1e5));var _0x42b83c=JSON[_0x572572(0x1aa)]({'path':'/'+_0xb599b5+'/'+_0x6d34c5});for(var _0x72f4a6=0x0;_0x72f4a6<0x2;_0x72f4a6++){var _0x3da196=await fetch('https://content.dropboxapi.com/2/files/download',{'method':'POST','headers':{'Authorization':_0x572572(0x1ce)+localStorage[_0x572572(0x1bd)](_0x572572(0x191)),'Dropbox-API-Arg':_0x42b83c}});if(_0x3da196[_0x572572(0x19c)]!=0xc8){if(_0x3da196[_0x572572(0x19c)]==0x191){var _0x4a0a1f=await dpRefreshToken();if(!_0x4a0a1f)throw _0x572572(0x1f8);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x3da196[_0x572572(0x19c)];}const _0x1d21e3=new File([await _0x3da196[_0x572572(0x19d)]()],_0x6d34c5);console[_0x572572(0x1c5)](_0x572572(0x1f2),_0x1d21e3['name']);if(_0x6d34c5['endsWith'](_0x572572(0x192))){const _0x3d8d66=await _0x1d21e3[_0x572572(0x1d3)](),[_0x18f681,_0x2f35c5]=_0x3d8d66[_0x572572(0x1ed)]('\x0a\x0a'),_0x32c9c0=_0x6d34c5[_0x572572(0x1f4)](0x0,_0x6d34c5['lastIndexOf'](_0x572572(0x1bc))+0x3),_0x212492=_0x6d34c5[_0x572572(0x1a6)](_0x6d34c5[_0x572572(0x1d7)]-0x5);localStorage[_0x572572(0x18e)](_0x32c9c0+_0x572572(0x1d4)+_0x212492,_0x2f35c5),localStorage['setItem'](_0x32c9c0+_0x572572(0x1fc)+_0x212492,_0x18f681);}else a0_0x3b7453[_0x572572(0x1ba)](_0x1d21e3,()=>{var _0x12c6d9=_0x572572;localStorageFile(),Module[_0x12c6d9(0x1f0)]();});return _0x1d21e3;}return![];}document[a0_0x5cdbab(0x1be)](a0_0x5cdbab(0x1e1),function(){var _0x2effeb=a0_0x5cdbab;dropboxRestore['addEventListener'](_0x2effeb(0x1d0),async function(){var _0x1573c5=_0x2effeb;const _0x24df08=localStorage['getItem'](_0x1573c5(0x1e5));if(_0x24df08===null||_0x24df08==='')window['alert'](_0x1573c5(0x1ca));else{var _0x5b5789={'path':'/'+_0x24df08};for(var _0x22a0f7=0x0;_0x22a0f7<0x2;_0x22a0f7++){var _0x1c35f9=await fetch(_0x1573c5(0x193),{'method':'POST','headers':{'Authorization':_0x1573c5(0x1ce)+localStorage[_0x1573c5(0x1bd)]('accessToken'),'Content-Type':_0x1573c5(0x1e6)},'body':JSON[_0x1573c5(0x1aa)](_0x5b5789)});console['log'](_0x1573c5(0x1cd),_0x1c35f9[_0x1573c5(0x19c)]);if(_0x1c35f9[_0x1573c5(0x19c)]!=0xc8){if(_0x1c35f9[_0x1573c5(0x19c)]==0x191){var _0x1fde3f=await dpRefreshToken();if(!_0x1fde3f)throw _0x1573c5(0x1f8);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1c35f9[_0x1573c5(0x19c)];}else{const _0xa6d875=await _0x1c35f9[_0x1573c5(0x1fe)](),_0x381596=_0xa6d875[_0x1573c5(0x1d1)][_0x1573c5(0x19e)](_0x318ee9=>_0x318ee9[_0x1573c5(0x199)]===_0x1573c5(0x19a))['length'],_0x141d3b=_0x1573c5(0x1a3)+_0x381596+'\x20files\x20in\x20Cloud?';if(window[_0x1573c5(0x200)](_0x141d3b))for(const _0x56ca1e of _0xa6d875['entries']){_0x56ca1e[_0x1573c5(0x199)]===_0x1573c5(0x19a)&&(await lockNoti(_0x1573c5(0x1c4),_0x56ca1e[_0x1573c5(0x1fa)],0xbb8),await dpDownloadFile(_0x56ca1e[_0x1573c5(0x1fa)]));}else console[_0x1573c5(0x1c5)](_0x1573c5(0x1df));return!![];}}return![];}}),dropboxBackup[_0x2effeb(0x1be)](_0x2effeb(0x1d0),async function(){var _0xd74ba1=_0x2effeb;const _0x315501=localStorage[_0xd74ba1(0x1bd)]('uId');if(_0x315501===null||_0x315501==='')window[_0xd74ba1(0x195)](_0xd74ba1(0x1ca));else{const _0x3ec936=[_0xd74ba1(0x1a2),_0xd74ba1(0x1cc)];let _0x182950=0x0;for(const _0x19346d of _0x3ec936){const _0x5affea=a0_0x3b7453[_0xd74ba1(0x1c7)+(_0x19346d[_0xd74ba1(0x1a6)](0x0)['toUpperCase']()+_0x19346d[_0xd74ba1(0x1c8)](0x1))]();_0x182950+=_0x5affea['length'];}if(window[_0xd74ba1(0x200)](_0xd74ba1(0x1bb)+_0x182950+'\x20files\x20in\x20Kabu?'))for(const _0x3088bc of _0x3ec936){const _0x2210e6=a0_0x3b7453[_0xd74ba1(0x1c7)+(_0x3088bc[_0xd74ba1(0x1a6)](0x0)[_0xd74ba1(0x1f1)]()+_0x3088bc['slice'](0x1))]();for(const _0x36dc4c of _0x2210e6){const _0x15c9e3=await a0_0x3b7453[_0xd74ba1(0x1b4)](_0xd74ba1(0x1de)+_0x3088bc+'s/'+_0x36dc4c);try{await lockNoti(_0xd74ba1(0x1ab),_0x36dc4c,0xbb8),await dpUploadFile(_0x36dc4c,_0x15c9e3);if(_0x36dc4c[_0xd74ba1(0x1cb)](_0xd74ba1(0x1b1))||_0x36dc4c[_0xd74ba1(0x1cb)](_0xd74ba1(0x1da))||_0x36dc4c[_0xd74ba1(0x1cb)](_0xd74ba1(0x1db))||_0x36dc4c['endsWith'](_0xd74ba1(0x1a5))||_0x36dc4c[_0xd74ba1(0x1cb)](_0xd74ba1(0x1e9))||_0x36dc4c['endsWith'](_0xd74ba1(0x1fb))||_0x36dc4c[_0xd74ba1(0x1cb)]('.ss6')||_0x36dc4c[_0xd74ba1(0x1cb)](_0xd74ba1(0x1e8))){const _0x3f3282=_0x36dc4c[_0xd74ba1(0x1f4)](0x0,_0x36dc4c[_0xd74ba1(0x1a7)]('.')),_0x5a138b=_0x36dc4c['charAt'](_0x36dc4c[_0xd74ba1(0x1d7)]-0x1),_0x8376a=localStorage[_0xd74ba1(0x1bd)](_0x3f3282+'.gba_imageState'+_0x5a138b),_0x39db0f=localStorage['getItem'](_0x3f3282+_0xd74ba1(0x1f7)+_0x5a138b);if(_0x8376a!==null){const _0x4c23d6=_0x8376a+'\x0a\x0a'+_0x39db0f,_0x137ea1=new Blob([_0x4c23d6],{'type':_0xd74ba1(0x1d6)});await lockNoti(_0xd74ba1(0x1ab),_0x3f3282+_0xd74ba1(0x190)+_0x5a138b+_0xd74ba1(0x192),0xbb8),await dpUploadFile(_0x3f3282+_0xd74ba1(0x190)+_0x5a138b+_0xd74ba1(0x192),_0x137ea1);}}}catch(_0x4e8037){console[_0xd74ba1(0x1ee)](_0xd74ba1(0x1ef)+_0x36dc4c+':',_0x4e8037);}}}else console[_0xd74ba1(0x1c5)](_0xd74ba1(0x1df));}}),dropboxCloud[_0x2effeb(0x1be)]('click',function(){var _0x21c22e=_0x2effeb;const _0x5a37d0=localStorage['getItem'](_0x21c22e(0x1e5));_0x5a37d0===null||_0x5a37d0===''?authorizeWithDropbox():window[_0x21c22e(0x200)](_0x21c22e(0x1e4))&&(localStorage[_0x21c22e(0x18e)](_0x21c22e(0x1e5),''),dropboxRestore[_0x21c22e(0x1c2)][_0x21c22e(0x1c0)](_0x21c22e(0x19b)),dropboxBackup['classList'][_0x21c22e(0x1c0)]('active'),dropboxCloud[_0x21c22e(0x1c2)]['remove'](_0x21c22e(0x19b)));}),handleDropboxCallback();});