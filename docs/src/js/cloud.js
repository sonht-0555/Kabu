var a0_0x537866=a0_0x2ab0;(function(_0x4acbba,_0x3ae847){var _0x5c6aad=a0_0x2ab0,_0x16177b=_0x4acbba();while(!![]){try{var _0x14b155=-parseInt(_0x5c6aad(0x1ad))/0x1*(parseInt(_0x5c6aad(0x16e))/0x2)+-parseInt(_0x5c6aad(0x16b))/0x3+parseInt(_0x5c6aad(0x17b))/0x4+-parseInt(_0x5c6aad(0x199))/0x5*(-parseInt(_0x5c6aad(0x146))/0x6)+-parseInt(_0x5c6aad(0x18f))/0x7+parseInt(_0x5c6aad(0x189))/0x8*(parseInt(_0x5c6aad(0x17f))/0x9)+parseInt(_0x5c6aad(0x1a1))/0xa*(parseInt(_0x5c6aad(0x170))/0xb);if(_0x14b155===_0x3ae847)break;else _0x16177b['push'](_0x16177b['shift']());}catch(_0x5d7892){_0x16177b['push'](_0x16177b['shift']());}}}(a0_0x3006,0xb4142));import*as a0_0x71cb96 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x537866(0x14e),clientSecret=a0_0x537866(0x192);function authorizeWithDropbox(){var _0x1c2b5d=a0_0x537866,_0x57f719=window[_0x1c2b5d(0x176)][_0x1c2b5d(0x177)][_0x1c2b5d(0x144)]('?')[0x0],_0x39ea85=_0x1c2b5d(0x18e),_0x211d5b='offline',_0x26c4d4='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x1c2b5d(0x14a)+_0x39ea85+_0x1c2b5d(0x180)+_0x211d5b+_0x1c2b5d(0x196)+encodeURIComponent(_0x57f719);window[_0x1c2b5d(0x176)][_0x1c2b5d(0x177)]=_0x26c4d4;}function handleDropboxCallback(){var _0x190eb3=a0_0x537866,_0x532bdb=getUrlParameter(_0x190eb3(0x18e));_0x532bdb?(getAccessToken(_0x532bdb),console[_0x190eb3(0x182)](_0x190eb3(0x179),_0x532bdb)):console[_0x190eb3(0x182)](_0x190eb3(0x186));}function getUrlParameter(_0x5d84db){var _0x5e556b=a0_0x537866;_0x5d84db=_0x5d84db['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x4bea34=new RegExp(_0x5e556b(0x15b)+_0x5d84db+'=([^&#]*)'),_0x59608b=_0x4bea34[_0x5e556b(0x17e)](location[_0x5e556b(0x15c)]);return _0x59608b===null?'':decodeURIComponent(_0x59608b[0x1][_0x5e556b(0x16c)](/\+/g,'\x20'));}function getAccessToken(_0x6d4eb1){var _0xb4643b=a0_0x537866,_0x183126=_0xb4643b(0x14b),_0x4f29f3=window[_0xb4643b(0x176)][_0xb4643b(0x177)]['split']('?')[0x0],_0x52ccbe=new XMLHttpRequest();_0x52ccbe[_0xb4643b(0x17d)](_0xb4643b(0x159),'https://api.dropbox.com/oauth2/token'),_0x52ccbe[_0xb4643b(0x15e)](_0xb4643b(0x195),_0xb4643b(0x160)),_0x52ccbe[_0xb4643b(0x191)]=function(){var _0x542de2=_0xb4643b;if(_0x52ccbe[_0x542de2(0x1ab)]===0xc8){var _0x3a34cb=JSON[_0x542de2(0x19b)](_0x52ccbe[_0x542de2(0x157)]),_0x1acd0d=_0x3a34cb['access_token'],_0x4fd3f6=_0x3a34cb[_0x542de2(0x18a)],_0x581450=_0x3a34cb[_0x542de2(0x181)];localStorage[_0x542de2(0x15f)](_0x542de2(0x19f),_0x1acd0d),localStorage[_0x542de2(0x15f)](_0x542de2(0x169),_0x4fd3f6),localStorage[_0x542de2(0x15f)](_0x542de2(0x147),_0x581450);}else console['log'](_0x542de2(0x187));},_0x52ccbe[_0xb4643b(0x153)]('code='+_0x6d4eb1+_0xb4643b(0x185)+_0x183126+_0xb4643b(0x19e)+clientId+_0xb4643b(0x1a6)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4f29f3));}function a0_0x3006(){var _0x1d99c4=['folder','[\x5c?&#]','search','https://api.dropboxapi.com/2/files/list_folder','setRequestHeader','setItem','application/x-www-form-urlencoded','Do\x20you\x20want\x20to\x20restore\x20','Bearer\x20','application/octet-stream','Cloud\x20↦\x20Kabu\x20storage\x20◆','\x20files\x20from\x20Cloud?','Wait\x20a\x20little\x20bit...','Refreshing\x20token...','addEventListener','refreshToken','blob','3783432sHZWgt','replace','/data/','886hmOXWL','map','11BmZxJb','https://content.dropboxapi.com/2/files/download','downloadFileInCloud','json','error','Cloud\x20login\x20required!','location','href','active','Authorization\x20Code:','\x20files\x20in\x20Kabu?','2474236CfSqqt','Restoring...','open','exec','7974GdhtTR','&token_access_type=','uid','log','remove','No\x20files\x20found\x20to\x20restore.','&grant_type=','Do\x20not\x20receive\x20authorization','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','getItem','10200lZyQnS','refresh_token','Do\x20you\x20want\x20to\x20logout?','state','DOMContentLoaded','code','6994085mwIRQj','click','onload','nwb3dnfh09rhs31','uploadFileInCloud','Error\x20while\x20refreshing\x20token:','Content-Type','&redirect_uri=','screenshot','Download\x20failed\x20for\x20','7170uOTvXX','Failed\x20to\x20refresh\x20Dropbox\x20token.','parse','Failed\x20to\x20upload\x20file\x20','length','&client_id=','accessToken','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','18665930emOHtz','refresh_token=','filter','Download\x20failed,\x20unknown\x20http\x20status:','Unable\x20to\x20refresh\x20token','&client_secret=','save','https://api.dropboxapi.com/oauth2/token','Backing\x20up...','No\x20refresh\x20token','status','Error\x20creating\x20folder\x20','2341bxMuOX','name','split','Kabu\x20storage\x20↦\x20Cloud\x20◆','1758TytgcL','uId','.tag','overwrite','&response_type=','authorization_code','file','confirm','knh3uz2mx2hp2eu','application/json','listFiles','Do\x20you\x20want\x20to\x20backup\x20','stringify','send','classList','https://api.dropboxapi.com/2/files/create_folder_v2','alert','responseText',',\x20status:\x20','POST'];a0_0x3006=function(){return _0x1d99c4;};return a0_0x3006();}export async function dpCreateFolder(_0x8f4a1d){var _0x3817d7=a0_0x537866;const _0x505f67=localStorage[_0x3817d7(0x188)](_0x3817d7(0x147));let _0x14e051=localStorage['getItem'](_0x3817d7(0x19f));const _0x382b23='/'+_0x505f67+'/'+_0x8f4a1d,_0x42a8ae=JSON['stringify']({'path':_0x382b23,'autorename':![]});for(let _0x34d8f4=0x0;_0x34d8f4<0x2;_0x34d8f4++){try{const _0x5ddf9f=await fetch(_0x3817d7(0x155),{'method':'POST','headers':{'Authorization':_0x3817d7(0x162)+_0x14e051,'Content-Type':_0x3817d7(0x14f)},'body':_0x42a8ae});if(_0x5ddf9f['status']===0x191){const _0x5f19d2=await dpRefreshToken();if(!_0x5f19d2)throw new Error('Unable\x20to\x20refresh\x20token');_0x14e051=localStorage[_0x3817d7(0x188)](_0x3817d7(0x19f));continue;}if(_0x5ddf9f[_0x3817d7(0x1ab)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x8f4a1d};if(!_0x5ddf9f['ok'])throw new Error(_0x3817d7(0x1ac)+_0x8f4a1d);const _0x4df9f6=await _0x5ddf9f[_0x3817d7(0x173)]();return await lockNoti('Folder\x20created','',0xbb8),_0x4df9f6;}catch(_0x42b1d4){if(_0x34d8f4===0x1)throw _0x42b1d4;}}return![];}function a0_0x2ab0(_0x500020,_0x40219f){var _0x30066c=a0_0x3006();return a0_0x2ab0=function(_0x2ab0b5,_0x2a58bb){_0x2ab0b5=_0x2ab0b5-0x143;var _0x1d8147=_0x30066c[_0x2ab0b5];return _0x1d8147;},a0_0x2ab0(_0x500020,_0x40219f);}export async function dpRefreshToken(){var _0x3f073b=a0_0x537866;if(!localStorage['getItem'](_0x3f073b(0x169)))throw _0x3f073b(0x1aa);try{const _0x58a4fa=await fetch(_0x3f073b(0x1a8),{'method':_0x3f073b(0x159),'headers':{'Content-Type':_0x3f073b(0x160)},'body':_0x3f073b(0x1a2)+localStorage[_0x3f073b(0x188)](_0x3f073b(0x169))+_0x3f073b(0x1a0)}),_0x34167e=await _0x58a4fa['json']();if(!_0x34167e[_0x3f073b(0x174)])return localStorage[_0x3f073b(0x15f)](_0x3f073b(0x19f),_0x34167e['access_token']),await lockNoti(_0x3f073b(0x167),'',0xbb8),await delay(0x3e8),!![];else alert(_0x34167e['error_description']||_0x3f073b(0x19a));}catch(_0xcab2c3){console[_0x3f073b(0x174)](_0x3f073b(0x194),_0xcab2c3);}return![];}export async function dpUploadFile(_0x59f926,_0x5174d9,_0x451c45){var _0x5816aa=a0_0x537866;const _0x3a3710=localStorage[_0x5816aa(0x188)](_0x5816aa(0x147));var _0x22564c=JSON[_0x5816aa(0x152)]({'autorename':!![],'mode':_0x5816aa(0x149),'mute':!![],'strict_conflict':![],'path':'/'+_0x3a3710+'/'+_0x451c45+'/'+_0x59f926}),_0x42ef98=new Blob([_0x5174d9],{'type':'application/octet-stream'});for(var _0x5edf91=0x0;_0x5edf91<0x2;_0x5edf91++){var _0x2b74ed=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x5816aa(0x159),'headers':{'Authorization':_0x5816aa(0x162)+localStorage[_0x5816aa(0x188)](_0x5816aa(0x19f)),'Dropbox-API-Arg':_0x22564c,'Content-Type':_0x5816aa(0x163)},'body':_0x42ef98});if(_0x2b74ed[_0x5816aa(0x1ab)]!=0xc8){if(_0x2b74ed[_0x5816aa(0x1ab)]==0x191){var _0x48319c=await dpRefreshToken();if(!_0x48319c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x2b74ed['status'];}else{var _0x2339fe=await _0x2b74ed[_0x5816aa(0x173)]();return console['log'](_0x5816aa(0x145),_0x59f926),_0x2339fe;}}return![];}export async function dpDownloadFile(_0x236681,_0x1a7060){var _0x5982a9=a0_0x537866;const _0x1172a4=localStorage[_0x5982a9(0x188)]('uId');var _0x4fb605=JSON[_0x5982a9(0x152)]({'path':'/'+_0x1172a4+'/'+_0x1a7060+'/'+_0x236681});for(var _0x2cc228=0x0;_0x2cc228<0x2;_0x2cc228++){var _0x2b887c=await fetch(_0x5982a9(0x171),{'method':_0x5982a9(0x159),'headers':{'Authorization':_0x5982a9(0x162)+localStorage[_0x5982a9(0x188)](_0x5982a9(0x19f)),'Dropbox-API-Arg':_0x4fb605}});if(_0x2b887c[_0x5982a9(0x1ab)]!=0xc8){if(_0x2b887c[_0x5982a9(0x1ab)]==0x191){var _0x25b28e=await dpRefreshToken();if(!_0x25b28e)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x5982a9(0x1a4)+_0x2b887c[_0x5982a9(0x1ab)];}const _0x274cb4=new File([await _0x2b887c[_0x5982a9(0x16a)]()],_0x236681);return console[_0x5982a9(0x182)](_0x5982a9(0x164),_0x274cb4[_0x5982a9(0x143)]),a0_0x71cb96[_0x5982a9(0x193)](_0x274cb4,()=>{}),_0x274cb4;}return![];}document[a0_0x537866(0x168)](a0_0x537866(0x18d),function(){var _0x395069=a0_0x537866;dropboxRestore[_0x395069(0x168)](_0x395069(0x190),async function(){var _0x5c5092=_0x395069;await lockNoti(_0x5c5092(0x166),'',0x1388);const _0x396dea=localStorage[_0x5c5092(0x188)](_0x5c5092(0x147)),_0x1eb0cc=['state',_0x5c5092(0x1a7),_0x5c5092(0x197)];if(!_0x396dea){window['alert']('Cloud\x20login\x20required!');return;}let _0x118267=[];for(const _0x4f0701 of _0x1eb0cc){let _0x17bbba={'path':'/'+_0x396dea+'/'+_0x4f0701};for(let _0x4ef48d=0x0;_0x4ef48d<0x2;_0x4ef48d++){let _0x27c5f7=await fetch(_0x5c5092(0x15d),{'method':_0x5c5092(0x159),'headers':{'Authorization':_0x5c5092(0x162)+localStorage[_0x5c5092(0x188)](_0x5c5092(0x19f)),'Content-Type':'application/json'},'body':JSON[_0x5c5092(0x152)](_0x17bbba)});if(_0x27c5f7['status']===0xc8){let _0x2224f1=await _0x27c5f7['json'](),_0x2e7cca=_0x2224f1['entries'][_0x5c5092(0x1a3)](_0x534138=>_0x534138[_0x5c5092(0x148)]===_0x5c5092(0x14c));_0x2e7cca[_0x5c5092(0x19d)]>0x0&&_0x118267['push'](..._0x2e7cca[_0x5c5092(0x16f)](_0x16e260=>({'name':_0x16e260['name'],'folder':_0x4f0701})));break;}else{if(_0x27c5f7[_0x5c5092(0x1ab)]===0x191){let _0x55c590=await dpRefreshToken();if(!_0x55c590)throw _0x5c5092(0x1a5);}else{console[_0x5c5092(0x174)](_0x5c5092(0x198)+_0x4f0701+_0x5c5092(0x158)+_0x27c5f7[_0x5c5092(0x1ab)]);break;}}}}if(_0x118267[_0x5c5092(0x19d)]>0x0){const _0x5e2633=_0x5c5092(0x161)+_0x118267[_0x5c5092(0x19d)]+_0x5c5092(0x165);if(window[_0x5c5092(0x14d)](_0x5e2633))for(const _0xb646df of _0x118267){await lockNoti(_0x5c5092(0x17c),_0xb646df['name'],0xbb8),await dpDownloadFile(_0xb646df['name'],_0xb646df[_0x5c5092(0x15a)]);}else console[_0x5c5092(0x182)]('Restore\x20canceled\x20by\x20user.');}else console[_0x5c5092(0x182)](_0x5c5092(0x184));}),dropboxBackup[_0x395069(0x168)](_0x395069(0x190),async function(){var _0x36d579=_0x395069;await lockNoti(_0x36d579(0x166),'',0x1388);const _0x40cf17=localStorage[_0x36d579(0x188)]('uId');if(_0x40cf17===null||_0x40cf17==='')window[_0x36d579(0x156)](_0x36d579(0x175));else{const _0x305a69=[_0x36d579(0x18c),_0x36d579(0x1a7),_0x36d579(0x197)];for(const _0x2db4fe of _0x305a69){await dpCreateFolder(_0x2db4fe);}let _0x30b3bd=0x0;for(const _0x2d8150 of _0x305a69){const _0x56f971=a0_0x71cb96[_0x36d579(0x150)](_0x2d8150+'s');_0x30b3bd+=_0x56f971[_0x36d579(0x19d)];}if(window[_0x36d579(0x14d)](_0x36d579(0x151)+_0x30b3bd+_0x36d579(0x17a)))for(const _0x2cefc3 of _0x305a69){const _0x193bb7=a0_0x71cb96[_0x36d579(0x150)](_0x2cefc3+'s');for(const _0x4351a1 of _0x193bb7){const _0x204731=await a0_0x71cb96[_0x36d579(0x172)](_0x36d579(0x16d)+_0x2cefc3+'s/'+_0x4351a1);try{await lockNoti(_0x36d579(0x1a9),_0x4351a1,0xbb8),await dpUploadFile(_0x4351a1,_0x204731,_0x2cefc3);}catch(_0x113c29){console[_0x36d579(0x174)](_0x36d579(0x19c)+_0x4351a1+':',_0x113c29);}}}else console[_0x36d579(0x182)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x395069(0x168)]('click',function(){var _0x2fa474=_0x395069;const _0x36aeef=localStorage[_0x2fa474(0x188)](_0x2fa474(0x147));_0x36aeef===null||_0x36aeef===''?authorizeWithDropbox():window[_0x2fa474(0x14d)](_0x2fa474(0x18b))&&(localStorage['setItem'](_0x2fa474(0x147),''),dropboxRestore[_0x2fa474(0x154)][_0x2fa474(0x183)](_0x2fa474(0x178)),dropboxBackup[_0x2fa474(0x154)][_0x2fa474(0x183)](_0x2fa474(0x178)),dropboxCloud['classList'][_0x2fa474(0x183)]('active'));}),handleDropboxCallback();});