var a0_0x4f726b=a0_0xe883;(function(_0x180c06,_0x4eb51c){var _0x4ebf37=a0_0xe883,_0x2b1461=_0x180c06();while(!![]){try{var _0x56d173=parseInt(_0x4ebf37(0x21b))/0x1+-parseInt(_0x4ebf37(0x205))/0x2*(-parseInt(_0x4ebf37(0x1ce))/0x3)+parseInt(_0x4ebf37(0x1d9))/0x4*(-parseInt(_0x4ebf37(0x233))/0x5)+-parseInt(_0x4ebf37(0x220))/0x6+-parseInt(_0x4ebf37(0x230))/0x7+-parseInt(_0x4ebf37(0x20c))/0x8*(-parseInt(_0x4ebf37(0x209))/0x9)+-parseInt(_0x4ebf37(0x208))/0xa*(-parseInt(_0x4ebf37(0x20f))/0xb);if(_0x56d173===_0x4eb51c)break;else _0x2b1461['push'](_0x2b1461['shift']());}catch(_0x254b4a){_0x2b1461['push'](_0x2b1461['shift']());}}}(a0_0x4716,0x8f4b1));import*as a0_0x3c8495 from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x4f726b(0x1fc);function a0_0x4716(){var _0x1192ff=['https://api.dropboxapi.com/oauth2/token','Unable\x20to\x20refresh\x20token','onload','log','Error\x20while\x20refreshing\x20token:','567985fGLbnk','active','Authorization\x20Code:','Failed\x20to\x20upload\x20file\x20','uId','5513406uOkGYZ','application/x-www-form-urlencoded','confirm','location','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Download\x20failed\x20for\x20','setRequestHeader','Cloud\x20login\x20required!','setItem','https://api.dropbox.com/oauth2/token','refresh_token=','https://api.dropboxapi.com/2/files/list_folder','\x20files\x20in\x20Kabu?','DOMContentLoaded','POST','application/octet-stream','6295079nxKuUW','Do\x20you\x20want\x20to\x20restore\x20','Folder\x20created','3611190XRRLAX','[\x5c?&#]','Wait\x20a\x20little\x20bit...','Refreshing\x20token...','href','&response_type=','https://api.dropboxapi.com/2/files/create_folder_v2','5118qZSziB','Bearer\x20','responseText','stringify','open','\x20files\x20from\x20Cloud?','Backing\x20up...','addEventListener','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','click','application/json','4yrdzXE','Content-Type','&client_secret=','error','parse','classList','https://content.dropboxapi.com/2/files/upload','send','=([^&#]*)','file','screenshot','push','&client_id=','replace','overwrite','Restoring...','authorization_code','exec','No\x20refresh\x20token','refreshToken','Folder\x20already\x20exists','status','length','Error\x20creating\x20folder\x20','code=','entries','uploadFileInCloud','accessToken','Do\x20not\x20receive\x20authorization',',\x20status:\x20','name','error_description','state','Kabu\x20storage\x20↦\x20Cloud\x20◆','/data/','nwb3dnfh09rhs31','search','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Failed\x20to\x20refresh\x20Dropbox\x20token.','remove','access_token','json','getItem','Restore\x20canceled\x20by\x20user.','634HREXcC','filter','alert','30TiXZHU','9ubnxPy','Cloud\x20↦\x20Kabu\x20storage\x20◆','save','6735944PIOCOm','uid','listFiles','4314145qDkHUQ','https://content.dropboxapi.com/2/files/download','Do\x20you\x20want\x20to\x20backup\x20','code','&token_access_type=','offline','split'];a0_0x4716=function(){return _0x1192ff;};return a0_0x4716();}function authorizeWithDropbox(){var _0x395244=a0_0x4f726b,_0x459a41=window[_0x395244(0x223)][_0x395244(0x1cb)][_0x395244(0x215)]('?')[0x0],_0x4c388f='code',_0x1bd1e6=_0x395244(0x214),_0x32d9f9='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x395244(0x1cc)+_0x4c388f+_0x395244(0x213)+_0x1bd1e6+'&redirect_uri='+encodeURIComponent(_0x459a41);window[_0x395244(0x223)][_0x395244(0x1cb)]=_0x32d9f9;}function handleDropboxCallback(){var _0x557728=a0_0x4f726b,_0x13477c=getUrlParameter(_0x557728(0x212));_0x13477c?(getAccessToken(_0x13477c),console['log'](_0x557728(0x21d),_0x13477c)):console['log'](_0x557728(0x1f5));}function getUrlParameter(_0x4a5be8){var _0x225fc6=a0_0x4f726b;_0x4a5be8=_0x4a5be8['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2f4529=new RegExp(_0x225fc6(0x234)+_0x4a5be8+_0x225fc6(0x1e1)),_0x1dcc54=_0x2f4529[_0x225fc6(0x1ea)](location[_0x225fc6(0x1fd)]);return _0x1dcc54===null?'':decodeURIComponent(_0x1dcc54[0x1][_0x225fc6(0x1e6)](/\+/g,'\x20'));}function getAccessToken(_0x58b774){var _0x3a4200=a0_0x4f726b,_0x269970=_0x3a4200(0x1e9),_0x43aed3=window[_0x3a4200(0x223)][_0x3a4200(0x1cb)]['split']('?')[0x0],_0xbd8521=new XMLHttpRequest();_0xbd8521[_0x3a4200(0x1d2)](_0x3a4200(0x22e),_0x3a4200(0x229)),_0xbd8521[_0x3a4200(0x226)](_0x3a4200(0x1da),_0x3a4200(0x221)),_0xbd8521[_0x3a4200(0x218)]=function(){var _0x5c1e34=_0x3a4200;if(_0xbd8521[_0x5c1e34(0x1ee)]===0xc8){var _0x5018ce=JSON[_0x5c1e34(0x1dd)](_0xbd8521[_0x5c1e34(0x1d0)]),_0x29a019=_0x5018ce[_0x5c1e34(0x201)],_0x2d4b81=_0x5018ce['refresh_token'],_0x2811a5=_0x5018ce[_0x5c1e34(0x20d)];localStorage[_0x5c1e34(0x228)](_0x5c1e34(0x1f4),_0x29a019),localStorage['setItem'](_0x5c1e34(0x1ec),_0x2d4b81),localStorage['setItem'](_0x5c1e34(0x21f),_0x2811a5);}else console['log'](_0x5c1e34(0x1d6));},_0xbd8521[_0x3a4200(0x1e0)](_0x3a4200(0x1f1)+_0x58b774+'&grant_type='+_0x269970+_0x3a4200(0x1e5)+clientId+_0x3a4200(0x1db)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x43aed3));}export async function dpCreateFolder(_0x1a19bf){var _0x11f462=a0_0x4f726b;const _0x573d4f=localStorage[_0x11f462(0x203)](_0x11f462(0x21f));let _0x2bd5cb=localStorage[_0x11f462(0x203)]('accessToken');const _0x5aa682='/'+_0x573d4f+'/'+_0x1a19bf,_0x4d5839=JSON[_0x11f462(0x1d1)]({'path':_0x5aa682,'autorename':![]});for(let _0x1d3df8=0x0;_0x1d3df8<0x2;_0x1d3df8++){try{const _0x24a40e=await fetch(_0x11f462(0x1cd),{'method':_0x11f462(0x22e),'headers':{'Authorization':_0x11f462(0x1cf)+_0x2bd5cb,'Content-Type':_0x11f462(0x1d8)},'body':_0x4d5839});if(_0x24a40e[_0x11f462(0x1ee)]===0x191){const _0x494414=await dpRefreshToken();if(!_0x494414)throw new Error('Unable\x20to\x20refresh\x20token');_0x2bd5cb=localStorage[_0x11f462(0x203)](_0x11f462(0x1f4));continue;}if(_0x24a40e[_0x11f462(0x1ee)]===0x199)return{'message':_0x11f462(0x1ed),'path':_0x1a19bf};if(!_0x24a40e['ok'])throw new Error(_0x11f462(0x1f0)+_0x1a19bf);const _0x66e5d=await _0x24a40e[_0x11f462(0x202)]();return await lockNoti(_0x11f462(0x232),'',0xbb8),_0x66e5d;}catch(_0x48f2a5){if(_0x1d3df8===0x1)throw _0x48f2a5;}}return![];}export async function dpRefreshToken(){var _0x103c5f=a0_0x4f726b;if(!localStorage[_0x103c5f(0x203)](_0x103c5f(0x1ec)))throw _0x103c5f(0x1eb);try{const _0x5c1863=await fetch(_0x103c5f(0x216),{'method':_0x103c5f(0x22e),'headers':{'Content-Type':_0x103c5f(0x221)},'body':_0x103c5f(0x22a)+localStorage[_0x103c5f(0x203)]('refreshToken')+_0x103c5f(0x1fe)}),_0x360eca=await _0x5c1863[_0x103c5f(0x202)]();if(!_0x360eca['error'])return localStorage[_0x103c5f(0x228)](_0x103c5f(0x1f4),_0x360eca['access_token']),await lockNoti(_0x103c5f(0x1ca),'',0xbb8),await delay(0x3e8),!![];else alert(_0x360eca[_0x103c5f(0x1f8)]||_0x103c5f(0x1ff));}catch(_0x15c46a){console[_0x103c5f(0x1dc)](_0x103c5f(0x21a),_0x15c46a);}return![];}export async function dpUploadFile(_0x4af902,_0x3636b8,_0x2255b1){var _0x2c4784=a0_0x4f726b;const _0x19a5c0=localStorage[_0x2c4784(0x203)](_0x2c4784(0x21f));var _0x38a403=JSON[_0x2c4784(0x1d1)]({'autorename':!![],'mode':_0x2c4784(0x1e7),'mute':!![],'strict_conflict':![],'path':'/'+_0x19a5c0+'/'+_0x2255b1+'/'+_0x4af902}),_0x28f7e0=new Blob([_0x3636b8],{'type':_0x2c4784(0x22f)});for(var _0x50e67a=0x0;_0x50e67a<0x2;_0x50e67a++){var _0x518c8b=await fetch(_0x2c4784(0x1df),{'method':_0x2c4784(0x22e),'headers':{'Authorization':_0x2c4784(0x1cf)+localStorage[_0x2c4784(0x203)](_0x2c4784(0x1f4)),'Dropbox-API-Arg':_0x38a403,'Content-Type':_0x2c4784(0x22f)},'body':_0x28f7e0});if(_0x518c8b[_0x2c4784(0x1ee)]!=0xc8){if(_0x518c8b[_0x2c4784(0x1ee)]==0x191){var _0x2f21b5=await dpRefreshToken();if(!_0x2f21b5)throw _0x2c4784(0x217);continue;}else throw _0x2c4784(0x224)+_0x518c8b[_0x2c4784(0x1ee)];}else{var _0x22ef7c=await _0x518c8b[_0x2c4784(0x202)]();return console['log'](_0x2c4784(0x1fa),_0x4af902),_0x22ef7c;}}return![];}export async function dpDownloadFile(_0x199572,_0x221dc6){var _0x31b6ff=a0_0x4f726b;const _0x2737c4=localStorage['getItem'](_0x31b6ff(0x21f));var _0x8e39ca=JSON[_0x31b6ff(0x1d1)]({'path':'/'+_0x2737c4+'/'+_0x221dc6+'/'+_0x199572});for(var _0x1d5936=0x0;_0x1d5936<0x2;_0x1d5936++){var _0x33806f=await fetch(_0x31b6ff(0x210),{'method':_0x31b6ff(0x22e),'headers':{'Authorization':_0x31b6ff(0x1cf)+localStorage[_0x31b6ff(0x203)](_0x31b6ff(0x1f4)),'Dropbox-API-Arg':_0x8e39ca}});if(_0x33806f[_0x31b6ff(0x1ee)]!=0xc8){if(_0x33806f[_0x31b6ff(0x1ee)]==0x191){var _0x10978c=await dpRefreshToken();if(!_0x10978c)throw _0x31b6ff(0x217);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x33806f[_0x31b6ff(0x1ee)];}const _0x26e066=new File([await _0x33806f['blob']()],_0x199572);return console[_0x31b6ff(0x219)](_0x31b6ff(0x20a),_0x26e066[_0x31b6ff(0x1f7)]),a0_0x3c8495[_0x31b6ff(0x1f3)](_0x26e066,()=>{}),_0x26e066;}return![];}function a0_0xe883(_0x338abf,_0x16a887){var _0x471627=a0_0x4716();return a0_0xe883=function(_0xe8838a,_0x41aaad){_0xe8838a=_0xe8838a-0x1ca;var _0x3a7964=_0x471627[_0xe8838a];return _0x3a7964;},a0_0xe883(_0x338abf,_0x16a887);}document[a0_0x4f726b(0x1d5)](a0_0x4f726b(0x22d),function(){var _0x25f563=a0_0x4f726b;dropboxRestore[_0x25f563(0x1d5)](_0x25f563(0x1d7),async function(){var _0x358480=_0x25f563;await lockNoti(_0x358480(0x235),'',0x1388);const _0x45091f=localStorage[_0x358480(0x203)](_0x358480(0x21f)),_0xa7b784=[_0x358480(0x1f9),_0x358480(0x20b),_0x358480(0x1e3)];if(!_0x45091f){window[_0x358480(0x207)](_0x358480(0x227));return;}let _0x26ff7f=[];for(const _0x1f4da3 of _0xa7b784){let _0x269ce0={'path':'/'+_0x45091f+'/'+_0x1f4da3};for(let _0x217c09=0x0;_0x217c09<0x2;_0x217c09++){let _0x7f9c8a=await fetch(_0x358480(0x22b),{'method':_0x358480(0x22e),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x358480(0x203)](_0x358480(0x1f4)),'Content-Type':_0x358480(0x1d8)},'body':JSON['stringify'](_0x269ce0)});if(_0x7f9c8a[_0x358480(0x1ee)]===0xc8){let _0x2698f0=await _0x7f9c8a[_0x358480(0x202)](),_0x3f835c=_0x2698f0[_0x358480(0x1f2)][_0x358480(0x206)](_0x58d359=>_0x58d359['.tag']===_0x358480(0x1e2));_0x3f835c[_0x358480(0x1ef)]>0x0&&_0x26ff7f[_0x358480(0x1e4)](..._0x3f835c['map'](_0x3accab=>({'name':_0x3accab['name'],'folder':_0x1f4da3})));break;}else{if(_0x7f9c8a[_0x358480(0x1ee)]===0x191){let _0x24a22a=await dpRefreshToken();if(!_0x24a22a)throw _0x358480(0x217);}else{console[_0x358480(0x1dc)](_0x358480(0x225)+_0x1f4da3+_0x358480(0x1f6)+_0x7f9c8a[_0x358480(0x1ee)]);break;}}}}if(_0x26ff7f[_0x358480(0x1ef)]>0x0){const _0x49cfdd=_0x358480(0x231)+_0x26ff7f[_0x358480(0x1ef)]+_0x358480(0x1d3);if(window['confirm'](_0x49cfdd))for(const _0xe8cec3 of _0x26ff7f){await lockNoti(_0x358480(0x1e8),_0xe8cec3[_0x358480(0x1f7)],0xbb8),await dpDownloadFile(_0xe8cec3[_0x358480(0x1f7)],_0xe8cec3['folder']);}else console['log'](_0x358480(0x204));}else console[_0x358480(0x219)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x25f563(0x1d5)](_0x25f563(0x1d7),async function(){var _0x2801dd=_0x25f563;await lockNoti(_0x2801dd(0x235),'',0x1388);const _0x3b8d05=localStorage['getItem'](_0x2801dd(0x21f));if(_0x3b8d05===null||_0x3b8d05==='')window[_0x2801dd(0x207)](_0x2801dd(0x227));else{const _0x295d15=[_0x2801dd(0x1f9),_0x2801dd(0x20b),'screenshot'];for(const _0x59c4c8 of _0x295d15){await dpCreateFolder(_0x59c4c8);}let _0x4fa49f=0x0;for(const _0x2b886a of _0x295d15){const _0xf5d42a=a0_0x3c8495['listFiles'](_0x2b886a+'s');_0x4fa49f+=_0xf5d42a['length'];}if(window[_0x2801dd(0x222)](_0x2801dd(0x211)+_0x4fa49f+_0x2801dd(0x22c)))for(const _0x49630f of _0x295d15){const _0x42e7a5=a0_0x3c8495[_0x2801dd(0x20e)](_0x49630f+'s');for(const _0x46751e of _0x42e7a5){const _0x570b2d=await a0_0x3c8495['downloadFileInCloud'](_0x2801dd(0x1fb)+_0x49630f+'s/'+_0x46751e);try{await lockNoti(_0x2801dd(0x1d4),_0x46751e,0xbb8),await dpUploadFile(_0x46751e,_0x570b2d,_0x49630f);}catch(_0xe066f9){console[_0x2801dd(0x1dc)](_0x2801dd(0x21e)+_0x46751e+':',_0xe066f9);}}}else console[_0x2801dd(0x219)](_0x2801dd(0x204));}}),dropboxCloud[_0x25f563(0x1d5)]('click',function(){var _0x2c9d08=_0x25f563;const _0x3e33f6=localStorage[_0x2c9d08(0x203)](_0x2c9d08(0x21f));_0x3e33f6===null||_0x3e33f6===''?authorizeWithDropbox():window[_0x2c9d08(0x222)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x2c9d08(0x228)](_0x2c9d08(0x21f),''),dropboxRestore[_0x2c9d08(0x1de)][_0x2c9d08(0x200)]('active'),dropboxBackup[_0x2c9d08(0x1de)][_0x2c9d08(0x200)](_0x2c9d08(0x21c)),dropboxCloud[_0x2c9d08(0x1de)][_0x2c9d08(0x200)](_0x2c9d08(0x21c)));}),handleDropboxCallback();});