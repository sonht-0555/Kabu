var a0_0x427970=a0_0x342f;(function(_0x261826,_0x1c3495){var _0x15d496=a0_0x342f,_0x19aeb7=_0x261826();while(!![]){try{var _0x49fd7f=-parseInt(_0x15d496(0x12f))/0x1*(parseInt(_0x15d496(0x120))/0x2)+parseInt(_0x15d496(0x162))/0x3*(-parseInt(_0x15d496(0x131))/0x4)+-parseInt(_0x15d496(0x147))/0x5+-parseInt(_0x15d496(0x12c))/0x6+parseInt(_0x15d496(0x155))/0x7+-parseInt(_0x15d496(0x140))/0x8+-parseInt(_0x15d496(0x15c))/0x9*(-parseInt(_0x15d496(0x16a))/0xa);if(_0x49fd7f===_0x1c3495)break;else _0x19aeb7['push'](_0x19aeb7['shift']());}catch(_0x13468e){_0x19aeb7['push'](_0x19aeb7['shift']());}}}(a0_0x7d5e,0x8b754));import*as a0_0x3dd819 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x342f(_0x536c60,_0x595012){var _0x7d5eaf=a0_0x7d5e();return a0_0x342f=function(_0x342f79,_0x1c87e1){_0x342f79=_0x342f79-0x10f;var _0x79e940=_0x7d5eaf[_0x342f79];return _0x79e940;},a0_0x342f(_0x536c60,_0x595012);}var clientId=a0_0x427970(0x16b),clientSecret=a0_0x427970(0x172);function authorizeWithDropbox(){var _0x4f9aba=a0_0x427970,_0x520ae2=window[_0x4f9aba(0x15a)]['href'][_0x4f9aba(0x169)]('?')[0x0],_0x18318b=_0x4f9aba(0x145),_0x157653='offline',_0x52a0ad=_0x4f9aba(0x15f)+clientId+_0x4f9aba(0x167)+_0x18318b+_0x4f9aba(0x133)+_0x157653+_0x4f9aba(0x10f)+encodeURIComponent(_0x520ae2);window['location'][_0x4f9aba(0x139)]=_0x52a0ad;}function handleDropboxCallback(){var _0x714a00=a0_0x427970,_0x582cec=getUrlParameter('code');_0x582cec?(getAccessToken(_0x582cec),console[_0x714a00(0x153)](_0x714a00(0x156),_0x582cec)):console[_0x714a00(0x153)](_0x714a00(0x171));}function getUrlParameter(_0x12151b){var _0x10b000=a0_0x427970;_0x12151b=_0x12151b[_0x10b000(0x144)](/[\[]/,'\x5c[')[_0x10b000(0x144)](/[\]]/,'\x5c]');var _0x362962=new RegExp(_0x10b000(0x12a)+_0x12151b+_0x10b000(0x142)),_0x4dcd0f=_0x362962['exec'](location[_0x10b000(0x129)]);return _0x4dcd0f===null?'':decodeURIComponent(_0x4dcd0f[0x1][_0x10b000(0x144)](/\+/g,'\x20'));}function getAccessToken(_0x3e0b73){var _0x2b21c6=a0_0x427970,_0x2692a9=_0x2b21c6(0x159),_0x1b5566=window[_0x2b21c6(0x15a)]['href'][_0x2b21c6(0x169)]('?')[0x0],_0x43a195=new XMLHttpRequest();_0x43a195[_0x2b21c6(0x116)](_0x2b21c6(0x115),_0x2b21c6(0x165)),_0x43a195[_0x2b21c6(0x174)](_0x2b21c6(0x12b),_0x2b21c6(0x143)),_0x43a195[_0x2b21c6(0x150)]=function(){var _0x3aeb7e=_0x2b21c6;if(_0x43a195[_0x3aeb7e(0x13f)]===0xc8){var _0x30d8d3=JSON['parse'](_0x43a195[_0x3aeb7e(0x154)]),_0x17a5c3=_0x30d8d3['access_token'],_0x3cf55e=_0x30d8d3['refresh_token'],_0x6ba18a=_0x30d8d3[_0x3aeb7e(0x136)];localStorage[_0x3aeb7e(0x17a)]('accessToken',_0x17a5c3),localStorage[_0x3aeb7e(0x17a)](_0x3aeb7e(0x163),_0x3cf55e),localStorage['setItem'](_0x3aeb7e(0x148),_0x6ba18a);}else console['log']('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x43a195[_0x2b21c6(0x111)](_0x2b21c6(0x173)+_0x3e0b73+_0x2b21c6(0x170)+_0x2692a9+_0x2b21c6(0x11b)+clientId+_0x2b21c6(0x164)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x1b5566));}export async function dpCreateFolder(_0x4dd8e6){var _0x37ea92=a0_0x427970;const _0x5d2156=localStorage[_0x37ea92(0x14c)]('uId');let _0x4ebfd8=localStorage['getItem'](_0x37ea92(0x14e));const _0x426aca='/'+_0x5d2156+'/'+_0x4dd8e6,_0x4ad25d=JSON[_0x37ea92(0x121)]({'path':_0x426aca,'autorename':![]});for(let _0x2f32d7=0x0;_0x2f32d7<0x2;_0x2f32d7++){try{const _0x1f35de=await fetch(_0x37ea92(0x124),{'method':_0x37ea92(0x115),'headers':{'Authorization':_0x37ea92(0x11f)+_0x4ebfd8,'Content-Type':_0x37ea92(0x168)},'body':_0x4ad25d});if(_0x1f35de[_0x37ea92(0x13f)]===0x191){const _0x1e3a02=await dpRefreshToken();if(!_0x1e3a02)throw new Error(_0x37ea92(0x13a));_0x4ebfd8=localStorage[_0x37ea92(0x14c)]('accessToken');continue;}if(_0x1f35de[_0x37ea92(0x13f)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x4dd8e6};if(!_0x1f35de['ok'])throw new Error(_0x37ea92(0x13b)+_0x4dd8e6);const _0x4bdef3=await _0x1f35de[_0x37ea92(0x176)]();return await lockNoti(_0x37ea92(0x138),'',0xbb8),_0x4bdef3;}catch(_0x5a0535){if(_0x2f32d7===0x1)throw _0x5a0535;}}return![];}export async function dpRefreshToken(){var _0x2e2f4b=a0_0x427970;if(!localStorage[_0x2e2f4b(0x14c)](_0x2e2f4b(0x163)))throw _0x2e2f4b(0x118);try{const _0x387269=await fetch(_0x2e2f4b(0x127),{'method':'POST','headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x2e2f4b(0x151)+localStorage[_0x2e2f4b(0x14c)](_0x2e2f4b(0x163))+_0x2e2f4b(0x123)}),_0x11f869=await _0x387269[_0x2e2f4b(0x176)]();if(!_0x11f869[_0x2e2f4b(0x126)])return localStorage[_0x2e2f4b(0x17a)]('accessToken',_0x11f869[_0x2e2f4b(0x125)]),await lockNoti(_0x2e2f4b(0x15b),'',0xbb8),await delay(0x3e8),!![];else alert(_0x11f869[_0x2e2f4b(0x16e)]||_0x2e2f4b(0x14d));}catch(_0x5a71e5){console['error']('Error\x20while\x20refreshing\x20token:',_0x5a71e5);}return![];}export async function dpUploadFile(_0x3b836a,_0x2d069d,_0xb0b65){var _0x344a3d=a0_0x427970;const _0x5cc39f=localStorage[_0x344a3d(0x14c)](_0x344a3d(0x148));var _0xd5d8d4=JSON[_0x344a3d(0x121)]({'autorename':!![],'mode':_0x344a3d(0x119),'mute':!![],'strict_conflict':![],'path':'/'+_0x5cc39f+'/'+_0xb0b65+'/'+_0x3b836a}),_0x250234=new Blob([_0x2d069d],{'type':_0x344a3d(0x117)});for(var _0x1d02a8=0x0;_0x1d02a8<0x2;_0x1d02a8++){var _0x185d59=await fetch(_0x344a3d(0x113),{'method':_0x344a3d(0x115),'headers':{'Authorization':_0x344a3d(0x11f)+localStorage['getItem'](_0x344a3d(0x14e)),'Dropbox-API-Arg':_0xd5d8d4,'Content-Type':_0x344a3d(0x117)},'body':_0x250234});if(_0x185d59[_0x344a3d(0x13f)]!=0xc8){if(_0x185d59[_0x344a3d(0x13f)]==0x191){var _0x2b4649=await dpRefreshToken();if(!_0x2b4649)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x344a3d(0x11c)+_0x185d59[_0x344a3d(0x13f)];}else{var _0x257aa4=await _0x185d59[_0x344a3d(0x176)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x3b836a),_0x257aa4;}}return![];}export async function dpDownloadFile(_0x181b2b,_0x48f87e){var _0x5647bf=a0_0x427970;const _0x237667=localStorage['getItem'](_0x5647bf(0x148));var _0x578df7=JSON[_0x5647bf(0x121)]({'path':'/'+_0x237667+'/'+_0x48f87e+'/'+_0x181b2b});for(var _0x219fab=0x0;_0x219fab<0x2;_0x219fab++){var _0x322c7b=await fetch(_0x5647bf(0x11e),{'method':'POST','headers':{'Authorization':_0x5647bf(0x11f)+localStorage[_0x5647bf(0x14c)](_0x5647bf(0x14e)),'Dropbox-API-Arg':_0x578df7}});if(_0x322c7b[_0x5647bf(0x13f)]!=0xc8){if(_0x322c7b[_0x5647bf(0x13f)]==0x191){var _0xaef7b7=await dpRefreshToken();if(!_0xaef7b7)throw _0x5647bf(0x13a);continue;}else throw _0x5647bf(0x177)+_0x322c7b[_0x5647bf(0x13f)];}const _0x1b6829=new File([await _0x322c7b['blob']()],_0x181b2b);return console[_0x5647bf(0x153)](_0x5647bf(0x160),_0x1b6829[_0x5647bf(0x132)]),a0_0x3dd819[_0x5647bf(0x16f)](_0x1b6829,()=>{}),_0x1b6829;}return![];}document[a0_0x427970(0x152)](a0_0x427970(0x13e),function(){var _0x5787d1=a0_0x427970;dropboxRestore[_0x5787d1(0x152)](_0x5787d1(0x178),async function(){var _0x4a14c3=_0x5787d1;await lockNoti(_0x4a14c3(0x11d),'',0x1388);const _0x2a3256=localStorage[_0x4a14c3(0x14c)](_0x4a14c3(0x148)),_0x440fec=[_0x4a14c3(0x157),_0x4a14c3(0x110),_0x4a14c3(0x137)];if(!_0x2a3256){window[_0x4a14c3(0x15e)]('Cloud\x20login\x20required!');return;}let _0x54bb55=[];for(const _0x2182d3 of _0x440fec){let _0x1c5262={'path':'/'+_0x2a3256+'/'+_0x2182d3};for(let _0x871d7c=0x0;_0x871d7c<0x2;_0x871d7c++){let _0x28ff6c=await fetch(_0x4a14c3(0x14a),{'method':_0x4a14c3(0x115),'headers':{'Authorization':_0x4a14c3(0x11f)+localStorage['getItem'](_0x4a14c3(0x14e)),'Content-Type':_0x4a14c3(0x168)},'body':JSON[_0x4a14c3(0x121)](_0x1c5262)});if(_0x28ff6c[_0x4a14c3(0x13f)]===0xc8){let _0x313485=await _0x28ff6c[_0x4a14c3(0x176)](),_0x52c953=_0x313485[_0x4a14c3(0x122)][_0x4a14c3(0x166)](_0x46f862=>_0x46f862[_0x4a14c3(0x14f)]===_0x4a14c3(0x112));_0x52c953[_0x4a14c3(0x14b)]>0x0&&_0x54bb55[_0x4a14c3(0x13c)](..._0x52c953[_0x4a14c3(0x146)](_0x16756f=>({'name':_0x16756f['name'],'folder':_0x2182d3})));break;}else{if(_0x28ff6c['status']===0x191){let _0x1b0df7=await dpRefreshToken();if(!_0x1b0df7)throw _0x4a14c3(0x13a);}else{console[_0x4a14c3(0x126)](_0x4a14c3(0x128)+_0x2182d3+',\x20status:\x20'+_0x28ff6c['status']);break;}}}}if(_0x54bb55['length']>0x0){const _0x28d1e3=_0x4a14c3(0x13d)+_0x54bb55[_0x4a14c3(0x14b)]+_0x4a14c3(0x149);if(window['confirm'](_0x28d1e3))for(const _0xcdc6af of _0x54bb55){await lockNoti(_0x4a14c3(0x11a),_0xcdc6af[_0x4a14c3(0x132)],0xbb8),await dpDownloadFile(_0xcdc6af[_0x4a14c3(0x132)],_0xcdc6af[_0x4a14c3(0x134)]);}else console[_0x4a14c3(0x153)]('Restore\x20canceled\x20by\x20user.');}else console[_0x4a14c3(0x153)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x5787d1(0x152)]('click',async function(){var _0x32ef35=_0x5787d1;await lockNoti(_0x32ef35(0x11d),'',0x1388);const _0x2c1954=localStorage[_0x32ef35(0x14c)](_0x32ef35(0x148));if(_0x2c1954===null||_0x2c1954==='')window['alert'](_0x32ef35(0x114));else{const _0x1fe797=[_0x32ef35(0x157),_0x32ef35(0x110),_0x32ef35(0x137)];for(const _0x49f756 of _0x1fe797){await dpCreateFolder(_0x49f756);}let _0x5c1fb3=0x0;for(const _0x4da71c of _0x1fe797){const _0x27e2bc=a0_0x3dd819['list'+(_0x4da71c[_0x32ef35(0x12d)](0x0)[_0x32ef35(0x141)]()+_0x4da71c[_0x32ef35(0x158)](0x1))]();_0x5c1fb3+=_0x27e2bc[_0x32ef35(0x14b)];}if(window[_0x32ef35(0x135)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x5c1fb3+_0x32ef35(0x15d)))for(const _0x344bfb of _0x1fe797){const _0x4063dc=a0_0x3dd819[_0x32ef35(0x12e)+(_0x344bfb[_0x32ef35(0x12d)](0x0)[_0x32ef35(0x141)]()+_0x344bfb['slice'](0x1))]();for(const _0x54c983 of _0x4063dc){const _0x170a8a=await a0_0x3dd819['downloadFileInCloud'](_0x32ef35(0x161)+_0x344bfb+'s/'+_0x54c983);try{await lockNoti('Backing\x20up...',_0x54c983,0xbb8),await dpUploadFile(_0x54c983,_0x170a8a,_0x344bfb);}catch(_0x5e25aa){console[_0x32ef35(0x126)](_0x32ef35(0x16d)+_0x54c983+':',_0x5e25aa);}}}else console[_0x32ef35(0x153)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x5787d1(0x152)](_0x5787d1(0x178),function(){var _0xe728c7=_0x5787d1;const _0x4cc5dc=localStorage[_0xe728c7(0x14c)](_0xe728c7(0x148));_0x4cc5dc===null||_0x4cc5dc===''?authorizeWithDropbox():window[_0xe728c7(0x135)](_0xe728c7(0x179))&&(localStorage[_0xe728c7(0x17a)]('uId',''),dropboxRestore[_0xe728c7(0x16c)][_0xe728c7(0x175)](_0xe728c7(0x130)),dropboxBackup['classList']['remove'](_0xe728c7(0x130)),dropboxCloud[_0xe728c7(0x16c)][_0xe728c7(0x175)](_0xe728c7(0x130)));}),handleDropboxCallback();});function a0_0x7d5e(){var _0x1554dd=['getItem','Failed\x20to\x20refresh\x20Dropbox\x20token.','accessToken','.tag','onload','refresh_token=','addEventListener','log','responseText','4857440xQpDqS','Authorization\x20Code:','state','slice','authorization_code','location','Refreshing\x20token...','80361ceVLyI','\x20files\x20in\x20Kabu?','alert','https://www.dropbox.com/oauth2/authorize?client_id=','Cloud\x20↦\x20Kabu\x20storage\x20◆','/data/','3bUqCeV','refreshToken','&client_secret=','https://api.dropbox.com/oauth2/token','filter','&response_type=','application/json','split','2530guIsOu','knh3uz2mx2hp2eu','classList','Failed\x20to\x20upload\x20file\x20','error_description','uploadFileInCloud','&grant_type=','Do\x20not\x20receive\x20authorization','nwb3dnfh09rhs31','code=','setRequestHeader','remove','json','Download\x20failed,\x20unknown\x20http\x20status:','click','Do\x20you\x20want\x20to\x20logout?','setItem','&redirect_uri=','save','send','file','https://content.dropboxapi.com/2/files/upload','Cloud\x20login\x20required!','POST','open','application/octet-stream','No\x20refresh\x20token','overwrite','Restoring...','&client_id=','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Wait\x20a\x20little\x20bit...','https://content.dropboxapi.com/2/files/download','Bearer\x20','26jsfJMa','stringify','entries','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','https://api.dropboxapi.com/2/files/create_folder_v2','access_token','error','https://api.dropboxapi.com/oauth2/token','Download\x20failed\x20for\x20','search','[\x5c?&#]','Content-Type','2842956ckelBH','charAt','list','66662PGdqHN','active','2226780vKPETY','name','&token_access_type=','folder','confirm','uid','screenshot','Folder\x20created','href','Unable\x20to\x20refresh\x20token','Error\x20creating\x20folder\x20','push','Do\x20you\x20want\x20to\x20restore\x20','DOMContentLoaded','status','2857920rxjCIA','toUpperCase','=([^&#]*)','application/x-www-form-urlencoded','replace','code','map','636850QSvAhq','uId','\x20files\x20from\x20Cloud?','https://api.dropboxapi.com/2/files/list_folder','length'];a0_0x7d5e=function(){return _0x1554dd;};return a0_0x7d5e();}