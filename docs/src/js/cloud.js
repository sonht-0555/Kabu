var a0_0x4f4c97=a0_0x6a65;(function(_0x352262,_0x351186){var _0x16d807=a0_0x6a65,_0x489131=_0x352262();while(!![]){try{var _0x120016=parseInt(_0x16d807(0xa0))/0x1*(parseInt(_0x16d807(0x9b))/0x2)+-parseInt(_0x16d807(0xac))/0x3*(parseInt(_0x16d807(0xb2))/0x4)+parseInt(_0x16d807(0xd8))/0x5*(-parseInt(_0x16d807(0xd7))/0x6)+parseInt(_0x16d807(0xe7))/0x7*(parseInt(_0x16d807(0x9f))/0x8)+parseInt(_0x16d807(0xaa))/0x9+parseInt(_0x16d807(0xa5))/0xa*(parseInt(_0x16d807(0xd0))/0xb)+-parseInt(_0x16d807(0x94))/0xc;if(_0x120016===_0x351186)break;else _0x489131['push'](_0x489131['shift']());}catch(_0x52626d){_0x489131['push'](_0x489131['shift']());}}}(a0_0x5238,0x6284f));import*as a0_0x33bf52 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x4f4c97(0x98),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x262467=a0_0x4f4c97,_0x16b8c4=window[_0x262467(0xe0)]['href'][_0x262467(0xdc)]('?')[0x0],_0x51100d=_0x262467(0xec),_0x39ceef=_0x262467(0xaf),_0x8eec47=_0x262467(0xc2)+clientId+_0x262467(0xab)+_0x51100d+'&token_access_type='+_0x39ceef+_0x262467(0x96)+encodeURIComponent(_0x16b8c4);window[_0x262467(0xe0)][_0x262467(0xf7)]=_0x8eec47;}function handleDropboxCallback(){var _0x33c74e=a0_0x4f4c97,_0x90340b=getUrlParameter(_0x33c74e(0xec));_0x90340b?(getAccessToken(_0x90340b),console[_0x33c74e(0xe5)](_0x33c74e(0xba),_0x90340b)):console[_0x33c74e(0xe5)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x5210e7){var _0x1b8acc=a0_0x4f4c97;_0x5210e7=_0x5210e7['replace'](/[\[]/,'\x5c[')[_0x1b8acc(0xa8)](/[\]]/,'\x5c]');var _0x197f3f=new RegExp('[\x5c?&#]'+_0x5210e7+_0x1b8acc(0xcb)),_0x129f53=_0x197f3f[_0x1b8acc(0xdf)](location[_0x1b8acc(0xc5)]);return _0x129f53===null?'':decodeURIComponent(_0x129f53[0x1][_0x1b8acc(0xa8)](/\+/g,'\x20'));}function a0_0x5238(){var _0x17d6d5=['stringify','name','responseText','toUpperCase','code=','1112910rpfniQ','5mArGgt','Kabu\x20storage\x20↦\x20Cloud\x20◆','Content-Type','Do\x20you\x20want\x20to\x20restore\x20','split','confirm','Cloud\x20login\x20required!','exec','location','No\x20refresh\x20token','file','entries','filter','log','Refreshing\x20token...','49KeefYC','https://api.dropboxapi.com/2/files/list_folder','click','folder','Upload\x20failed,\x20unknown\x20http\x20status:\x20','code','send','Do\x20you\x20want\x20to\x20backup\x20','state','length','https://api.dropboxapi.com/oauth2/token','Do\x20you\x20want\x20to\x20logout?','error','uId','alert','charAt','href','status','\x20files\x20from\x20Cloud?','onload','Download\x20failed\x20for\x20','setRequestHeader','Download\x20failed,\x20unknown\x20http\x20status:','Restore\x20canceled\x20by\x20user.','1277592MTkPCC','Error\x20while\x20refreshing\x20token:','&redirect_uri=','application/x-www-form-urlencoded','knh3uz2mx2hp2eu','overwrite','Failed\x20to\x20refresh\x20Dropbox\x20token.','1212eAyDth','save','error_description','list','49512jbJzNe','1129VmsfOk','Error\x20creating\x20folder\x20','addEventListener','application/json','refreshToken','2388670UozyEc','application/octet-stream','Wait\x20a\x20little\x20bit...','replace','remove','102411hAcVPS','&response_type=','4989XZRxfH','classList','active','offline','slice','Unable\x20to\x20refresh\x20token','1828kXChuM','screenshot','blob','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://content.dropboxapi.com/2/files/upload','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','setItem','Backing\x20up...','Authorization\x20Code:','refresh_token','map','https://content.dropboxapi.com/2/files/download','accessToken','/data/','uploadFileInCloud','json','https://www.dropbox.com/oauth2/authorize?client_id=','https://api.dropboxapi.com/2/files/create_folder_v2','https://api.dropbox.com/oauth2/token','search','\x20files\x20in\x20Kabu?','Bearer\x20','Cloud\x20↦\x20Kabu\x20storage\x20◆','open','push','=([^&#]*)','downloadFileInCloud','DOMContentLoaded','getItem','refresh_token=','33OnXqLO','POST'];a0_0x5238=function(){return _0x17d6d5;};return a0_0x5238();}function getAccessToken(_0x4e6674){var _0x28317f=a0_0x4f4c97,_0x4e8b3c='authorization_code',_0x404695=window[_0x28317f(0xe0)][_0x28317f(0xf7)][_0x28317f(0xdc)]('?')[0x0],_0x146c2b=new XMLHttpRequest();_0x146c2b[_0x28317f(0xc9)]('POST',_0x28317f(0xc4)),_0x146c2b[_0x28317f(0xfc)](_0x28317f(0xda),_0x28317f(0x97)),_0x146c2b[_0x28317f(0xfa)]=function(){var _0x2acd9f=_0x28317f;if(_0x146c2b['status']===0xc8){var _0x53e933=JSON['parse'](_0x146c2b[_0x2acd9f(0xd4)]),_0x34ea37=_0x53e933['access_token'],_0x2d5d32=_0x53e933[_0x2acd9f(0xbb)],_0x57e525=_0x53e933['uid'];localStorage[_0x2acd9f(0xb8)]('accessToken',_0x34ea37),localStorage[_0x2acd9f(0xb8)](_0x2acd9f(0xa4),_0x2d5d32),localStorage['setItem'](_0x2acd9f(0xf4),_0x57e525);}else console[_0x2acd9f(0xe5)](_0x2acd9f(0xb5));},_0x146c2b[_0x28317f(0xed)](_0x28317f(0xd6)+_0x4e6674+'&grant_type='+_0x4e8b3c+'&client_id='+clientId+'&client_secret='+clientSecret+_0x28317f(0x96)+encodeURIComponent(_0x404695));}export async function dpCreateFolder(_0x1a6258){var _0x79d67d=a0_0x4f4c97;const _0x2c980c=localStorage[_0x79d67d(0xce)](_0x79d67d(0xf4));let _0x1d2cb4=localStorage['getItem'](_0x79d67d(0xbe));const _0x3f1a49='/'+_0x2c980c+'/'+_0x1a6258,_0x2ec61b=JSON['stringify']({'path':_0x3f1a49,'autorename':![]});for(let _0x13b5ad=0x0;_0x13b5ad<0x2;_0x13b5ad++){try{const _0x664fe3=await fetch(_0x79d67d(0xc3),{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x1d2cb4,'Content-Type':_0x79d67d(0xa3)},'body':_0x2ec61b});if(_0x664fe3['status']===0x191){const _0x49ec43=await dpRefreshToken();if(!_0x49ec43)throw new Error('Unable\x20to\x20refresh\x20token');_0x1d2cb4=localStorage[_0x79d67d(0xce)](_0x79d67d(0xbe));continue;}if(_0x664fe3[_0x79d67d(0xf8)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x1a6258};if(!_0x664fe3['ok'])throw new Error(_0x79d67d(0xa1)+_0x1a6258);const _0x2a8fde=await _0x664fe3[_0x79d67d(0xc1)]();return await lockNoti('Folder\x20created','',0xbb8),_0x2a8fde;}catch(_0x14eedf){if(_0x13b5ad===0x1)throw _0x14eedf;}}return![];}export async function dpRefreshToken(){var _0x1f20e5=a0_0x4f4c97;if(!localStorage[_0x1f20e5(0xce)](_0x1f20e5(0xa4)))throw _0x1f20e5(0xe1);try{const _0x440310=await fetch(_0x1f20e5(0xf1),{'method':_0x1f20e5(0xd1),'headers':{'Content-Type':_0x1f20e5(0x97)},'body':_0x1f20e5(0xcf)+localStorage[_0x1f20e5(0xce)](_0x1f20e5(0xa4))+_0x1f20e5(0xb7)}),_0x5101e0=await _0x440310[_0x1f20e5(0xc1)]();if(!_0x5101e0[_0x1f20e5(0xf3)])return localStorage['setItem']('accessToken',_0x5101e0['access_token']),await lockNoti(_0x1f20e5(0xe6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x5101e0[_0x1f20e5(0x9d)]||_0x1f20e5(0x9a));}catch(_0x4f0a07){console[_0x1f20e5(0xf3)](_0x1f20e5(0x95),_0x4f0a07);}return![];}function a0_0x6a65(_0xa947ab,_0x236dd4){var _0x52381c=a0_0x5238();return a0_0x6a65=function(_0x6a6557,_0x218c24){_0x6a6557=_0x6a6557-0x94;var _0xfd23fc=_0x52381c[_0x6a6557];return _0xfd23fc;},a0_0x6a65(_0xa947ab,_0x236dd4);}export async function dpUploadFile(_0x49a60a,_0x3b2104,_0x1376e0){var _0x384216=a0_0x4f4c97;const _0x2b9ed5=localStorage[_0x384216(0xce)](_0x384216(0xf4));var _0x5aa2df=JSON[_0x384216(0xd2)]({'autorename':!![],'mode':_0x384216(0x99),'mute':!![],'strict_conflict':![],'path':'/'+_0x2b9ed5+'/'+_0x1376e0+'/'+_0x49a60a}),_0x2ac087=new Blob([_0x3b2104],{'type':_0x384216(0xa6)});for(var _0x159a45=0x0;_0x159a45<0x2;_0x159a45++){var _0x393b40=await fetch(_0x384216(0xb6),{'method':_0x384216(0xd1),'headers':{'Authorization':_0x384216(0xc7)+localStorage['getItem'](_0x384216(0xbe)),'Dropbox-API-Arg':_0x5aa2df,'Content-Type':_0x384216(0xa6)},'body':_0x2ac087});if(_0x393b40[_0x384216(0xf8)]!=0xc8){if(_0x393b40['status']==0x191){var _0x26f8a8=await dpRefreshToken();if(!_0x26f8a8)throw _0x384216(0xb1);continue;}else throw _0x384216(0xeb)+_0x393b40[_0x384216(0xf8)];}else{var _0x46ec5b=await _0x393b40[_0x384216(0xc1)]();return console['log'](_0x384216(0xd9),_0x49a60a),_0x46ec5b;}}return![];}export async function dpDownloadFile(_0x56663f,_0x45cd7e){var _0x486236=a0_0x4f4c97;const _0x4915c2=localStorage[_0x486236(0xce)](_0x486236(0xf4));var _0x18bf67=JSON[_0x486236(0xd2)]({'path':'/'+_0x4915c2+'/'+_0x45cd7e+'/'+_0x56663f});for(var _0x403d00=0x0;_0x403d00<0x2;_0x403d00++){var _0x5c7ebb=await fetch(_0x486236(0xbd),{'method':_0x486236(0xd1),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x486236(0xce)](_0x486236(0xbe)),'Dropbox-API-Arg':_0x18bf67}});if(_0x5c7ebb['status']!=0xc8){if(_0x5c7ebb[_0x486236(0xf8)]==0x191){var _0x31c647=await dpRefreshToken();if(!_0x31c647)throw _0x486236(0xb1);continue;}else throw _0x486236(0xfd)+_0x5c7ebb[_0x486236(0xf8)];}const _0x1803b=new File([await _0x5c7ebb[_0x486236(0xb4)]()],_0x56663f);return console['log'](_0x486236(0xc8),_0x1803b[_0x486236(0xd3)]),a0_0x33bf52[_0x486236(0xc0)](_0x1803b,()=>{}),_0x1803b;}return![];}document['addEventListener'](a0_0x4f4c97(0xcd),function(){var _0x44cee6=a0_0x4f4c97;dropboxRestore[_0x44cee6(0xa2)](_0x44cee6(0xe9),async function(){var _0x3e219d=_0x44cee6;await lockNoti(_0x3e219d(0xa7),'',0x1388);const _0x19a76e=localStorage[_0x3e219d(0xce)]('uId'),_0x1996bd=[_0x3e219d(0xef),'save',_0x3e219d(0xb3)];if(!_0x19a76e){window[_0x3e219d(0xf5)]('Cloud\x20login\x20required!');return;}let _0x1759da=[];for(const _0x4e2168 of _0x1996bd){let _0x450303={'path':'/'+_0x19a76e+'/'+_0x4e2168};for(let _0x4415ea=0x0;_0x4415ea<0x2;_0x4415ea++){let _0x34090b=await fetch(_0x3e219d(0xe8),{'method':_0x3e219d(0xd1),'headers':{'Authorization':_0x3e219d(0xc7)+localStorage[_0x3e219d(0xce)](_0x3e219d(0xbe)),'Content-Type':_0x3e219d(0xa3)},'body':JSON['stringify'](_0x450303)});if(_0x34090b[_0x3e219d(0xf8)]===0xc8){let _0x1c7b7f=await _0x34090b[_0x3e219d(0xc1)](),_0x50fc1a=_0x1c7b7f[_0x3e219d(0xe3)][_0x3e219d(0xe4)](_0x3b3a47=>_0x3b3a47['.tag']===_0x3e219d(0xe2));_0x50fc1a[_0x3e219d(0xf0)]>0x0&&_0x1759da[_0x3e219d(0xca)](..._0x50fc1a[_0x3e219d(0xbc)](_0x1e2ce1=>({'name':_0x1e2ce1[_0x3e219d(0xd3)],'folder':_0x4e2168})));break;}else{if(_0x34090b[_0x3e219d(0xf8)]===0x191){let _0x27e451=await dpRefreshToken();if(!_0x27e451)throw _0x3e219d(0xb1);}else{console[_0x3e219d(0xf3)](_0x3e219d(0xfb)+_0x4e2168+',\x20status:\x20'+_0x34090b['status']);break;}}}}if(_0x1759da[_0x3e219d(0xf0)]>0x0){const _0x4179f0=_0x3e219d(0xdb)+_0x1759da[_0x3e219d(0xf0)]+_0x3e219d(0xf9);if(window[_0x3e219d(0xdd)](_0x4179f0))for(const _0x577810 of _0x1759da){await lockNoti('Restoring...',_0x577810[_0x3e219d(0xd3)],0xbb8),await dpDownloadFile(_0x577810['name'],_0x577810[_0x3e219d(0xea)]);}else console[_0x3e219d(0xe5)]('Restore\x20canceled\x20by\x20user.');}else console[_0x3e219d(0xe5)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x44cee6(0xa2)](_0x44cee6(0xe9),async function(){var _0x3fb9d5=_0x44cee6;await lockNoti(_0x3fb9d5(0xa7),'',0x1388);const _0x331dbd=localStorage[_0x3fb9d5(0xce)](_0x3fb9d5(0xf4));if(_0x331dbd===null||_0x331dbd==='')window[_0x3fb9d5(0xf5)](_0x3fb9d5(0xde));else{const _0x15d098=[_0x3fb9d5(0xef),_0x3fb9d5(0x9c),_0x3fb9d5(0xb3)];for(const _0x56765f of _0x15d098){await dpCreateFolder(_0x56765f);}let _0x1566ca=0x0;for(const _0x2fe811 of _0x15d098){const _0x390607=a0_0x33bf52[_0x3fb9d5(0x9e)+(_0x2fe811[_0x3fb9d5(0xf6)](0x0)[_0x3fb9d5(0xd5)]()+_0x2fe811[_0x3fb9d5(0xb0)](0x1))]();_0x1566ca+=_0x390607[_0x3fb9d5(0xf0)];}if(window['confirm'](_0x3fb9d5(0xee)+_0x1566ca+_0x3fb9d5(0xc6)))for(const _0x381a99 of _0x15d098){const _0x7f9392=a0_0x33bf52[_0x3fb9d5(0x9e)+(_0x381a99['charAt'](0x0)[_0x3fb9d5(0xd5)]()+_0x381a99[_0x3fb9d5(0xb0)](0x1))]();for(const _0x50055c of _0x7f9392){const _0x389a5f=await a0_0x33bf52[_0x3fb9d5(0xcc)](_0x3fb9d5(0xbf)+_0x381a99+'s/'+_0x50055c);try{await lockNoti(_0x3fb9d5(0xb9),_0x50055c,0xbb8),await dpUploadFile(_0x50055c,_0x389a5f,_0x381a99);}catch(_0x55a284){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x50055c+':',_0x55a284);}}}else console['log'](_0x3fb9d5(0xfe));}}),dropboxCloud[_0x44cee6(0xa2)](_0x44cee6(0xe9),function(){var _0x3a2635=_0x44cee6;const _0x2dc976=localStorage[_0x3a2635(0xce)](_0x3a2635(0xf4));_0x2dc976===null||_0x2dc976===''?authorizeWithDropbox():window[_0x3a2635(0xdd)](_0x3a2635(0xf2))&&(localStorage[_0x3a2635(0xb8)](_0x3a2635(0xf4),''),dropboxRestore[_0x3a2635(0xad)][_0x3a2635(0xa9)](_0x3a2635(0xae)),dropboxBackup[_0x3a2635(0xad)][_0x3a2635(0xa9)](_0x3a2635(0xae)),dropboxCloud['classList'][_0x3a2635(0xa9)](_0x3a2635(0xae)));}),handleDropboxCallback();});