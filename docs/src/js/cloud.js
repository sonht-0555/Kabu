var a0_0x5af7bf=a0_0x5513;(function(_0xb6982e,_0x4709ab){var _0xab3de5=a0_0x5513,_0x6f01ca=_0xb6982e();while(!![]){try{var _0x532b6e=parseInt(_0xab3de5(0x106))/0x1*(parseInt(_0xab3de5(0x10e))/0x2)+parseInt(_0xab3de5(0x11f))/0x3*(parseInt(_0xab3de5(0xf1))/0x4)+parseInt(_0xab3de5(0x125))/0x5+parseInt(_0xab3de5(0x12f))/0x6+-parseInt(_0xab3de5(0xea))/0x7+-parseInt(_0xab3de5(0x137))/0x8*(-parseInt(_0xab3de5(0x10d))/0x9)+-parseInt(_0xab3de5(0xfb))/0xa*(parseInt(_0xab3de5(0xf5))/0xb);if(_0x532b6e===_0x4709ab)break;else _0x6f01ca['push'](_0x6f01ca['shift']());}catch(_0x57454a){_0x6f01ca['push'](_0x6f01ca['shift']());}}}(a0_0x25df,0x845df));import*as a0_0x4c2f8c from'./main.js';import{localStorageFile}from'./storage.js';var clientId='knh3uz2mx2hp2eu',clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x7e4da0=a0_0x5513,_0x1cbfcb=window[_0x7e4da0(0x10c)]['href'][_0x7e4da0(0x118)]('?')[0x0],_0x1fd973=_0x7e4da0(0x122),_0x19e96c=_0x7e4da0(0xf0),_0x51ddc1='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x1fd973+'&token_access_type='+_0x19e96c+_0x7e4da0(0x133)+encodeURIComponent(_0x1cbfcb);window[_0x7e4da0(0x10c)]['href']=_0x51ddc1;}function handleDropboxCallback(){var _0x2e36fd=a0_0x5513,_0xa017d=getUrlParameter(_0x2e36fd(0x122));_0xa017d?(getAccessToken(_0xa017d),console[_0x2e36fd(0x135)]('Authorization\x20Code:',_0xa017d)):console[_0x2e36fd(0x135)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x2f1382){var _0x15b854=a0_0x5513;_0x2f1382=_0x2f1382[_0x15b854(0x111)](/[\[]/,'\x5c[')[_0x15b854(0x111)](/[\]]/,'\x5c]');var _0x17c7ab=new RegExp(_0x15b854(0xec)+_0x2f1382+_0x15b854(0xe7)),_0x26492d=_0x17c7ab[_0x15b854(0xf7)](location[_0x15b854(0x139)]);return _0x26492d===null?'':decodeURIComponent(_0x26492d[0x1][_0x15b854(0x111)](/\+/g,'\x20'));}function getAccessToken(_0x278357){var _0x4fc1e9=a0_0x5513,_0x3fc635='authorization_code',_0x28cf25=window[_0x4fc1e9(0x10c)][_0x4fc1e9(0xf4)][_0x4fc1e9(0x118)]('?')[0x0],_0x5964dd=new XMLHttpRequest();_0x5964dd['open']('POST',_0x4fc1e9(0x101)),_0x5964dd[_0x4fc1e9(0xe5)](_0x4fc1e9(0x12a),'application/x-www-form-urlencoded'),_0x5964dd[_0x4fc1e9(0xe0)]=function(){var _0x5989a1=_0x4fc1e9;if(_0x5964dd['status']===0xc8){var _0x15c402=JSON[_0x5989a1(0xfe)](_0x5964dd[_0x5989a1(0x121)]),_0x398bb8=_0x15c402[_0x5989a1(0x11c)],_0x5b010c=_0x15c402[_0x5989a1(0x12e)],_0x455a6d=_0x15c402[_0x5989a1(0x11a)];localStorage[_0x5989a1(0xf8)](_0x5989a1(0x120),_0x398bb8),localStorage['setItem'](_0x5989a1(0x117),_0x5b010c),localStorage['setItem'](_0x5989a1(0xfa),_0x455a6d);}else console[_0x5989a1(0x135)](_0x5989a1(0xe1));},_0x5964dd['send'](_0x4fc1e9(0xe4)+_0x278357+_0x4fc1e9(0x12c)+_0x3fc635+_0x4fc1e9(0xfd)+clientId+_0x4fc1e9(0x104)+clientSecret+_0x4fc1e9(0x133)+encodeURIComponent(_0x28cf25));}export async function dpCreateFolder(_0xd160bd){var _0x5eb177=a0_0x5513;const _0x10146c=localStorage[_0x5eb177(0xfc)](_0x5eb177(0xfa));let _0x37637f=localStorage[_0x5eb177(0xfc)](_0x5eb177(0x120));const _0x3ab2ef='/'+_0x10146c+'/'+_0xd160bd,_0x5d026f=JSON[_0x5eb177(0x136)]({'path':_0x3ab2ef,'autorename':![]});for(let _0xf3df3=0x0;_0xf3df3<0x2;_0xf3df3++){try{const _0x2898c3=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x5eb177(0x134),'headers':{'Authorization':'Bearer\x20'+_0x37637f,'Content-Type':_0x5eb177(0x123)},'body':_0x5d026f});if(_0x2898c3[_0x5eb177(0x107)]===0x191){const _0x3d9564=await dpRefreshToken();if(!_0x3d9564)throw new Error('Unable\x20to\x20refresh\x20token');_0x37637f=localStorage[_0x5eb177(0xfc)](_0x5eb177(0x120));continue;}if(_0x2898c3[_0x5eb177(0x107)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0xd160bd};if(!_0x2898c3['ok'])throw new Error(_0x5eb177(0xff)+_0xd160bd);const _0x12c5da=await _0x2898c3[_0x5eb177(0xe8)]();return await lockNoti(_0x5eb177(0xe9),'',0xbb8),_0x12c5da;}catch(_0x43d53e){if(_0xf3df3===0x1)throw _0x43d53e;}}return![];}export async function dpRefreshToken(){var _0xcf8086=a0_0x5513;if(!localStorage[_0xcf8086(0xfc)](_0xcf8086(0x117)))throw'No\x20refresh\x20token';try{const _0x12dbf5=await fetch(_0xcf8086(0xeb),{'method':_0xcf8086(0x134),'headers':{'Content-Type':_0xcf8086(0xde)},'body':_0xcf8086(0x13a)+localStorage[_0xcf8086(0xfc)](_0xcf8086(0x117))+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x2a42d0=await _0x12dbf5[_0xcf8086(0xe8)]();if(!_0x2a42d0['error'])return localStorage[_0xcf8086(0xf8)](_0xcf8086(0x120),_0x2a42d0[_0xcf8086(0x11c)]),await lockNoti(_0xcf8086(0xe6),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2a42d0[_0xcf8086(0x11b)]||_0xcf8086(0xe2));}catch(_0x3d2c0a){console[_0xcf8086(0x131)]('Error\x20while\x20refreshing\x20token:',_0x3d2c0a);}return![];}export async function dpUploadFile(_0x44f408,_0x3f3abc,_0x3e33e1){var _0x5d13c5=a0_0x5513;const _0x1a7c97=localStorage[_0x5d13c5(0xfc)](_0x5d13c5(0xfa));var _0x3f24ea=JSON[_0x5d13c5(0x136)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x1a7c97+'/'+_0x3e33e1+'/'+_0x44f408}),_0x2ad420=new Blob([_0x3f3abc],{'type':'application/octet-stream'});for(var _0x2cc783=0x0;_0x2cc783<0x2;_0x2cc783++){var _0x3c9a6c=await fetch(_0x5d13c5(0x11d),{'method':_0x5d13c5(0x134),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x5d13c5(0xfc)](_0x5d13c5(0x120)),'Dropbox-API-Arg':_0x3f24ea,'Content-Type':_0x5d13c5(0xed)},'body':_0x2ad420});if(_0x3c9a6c[_0x5d13c5(0x107)]!=0xc8){if(_0x3c9a6c['status']==0x191){var _0x3e74be=await dpRefreshToken();if(!_0x3e74be)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3c9a6c[_0x5d13c5(0x107)];}else{var _0x54fde9=await _0x3c9a6c[_0x5d13c5(0xe8)]();return console[_0x5d13c5(0x135)](_0x5d13c5(0x12d),_0x44f408),_0x54fde9;}}return![];}function a0_0x25df(){var _0x4fd299=['error','Do\x20you\x20want\x20to\x20restore\x20','&redirect_uri=','POST','log','stringify','6152JtIqcW','click','search','refresh_token=','confirm','application/x-www-form-urlencoded','Unable\x20to\x20refresh\x20token','onload','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Failed\x20to\x20refresh\x20Dropbox\x20token.','uploadFileInCloud','code=','setRequestHeader','Refreshing\x20token...','=([^&#]*)','json','Folder\x20created','327243XwChWK','https://api.dropboxapi.com/oauth2/token','[\x5c?&#]','application/octet-stream','length','Backing\x20up...','offline','1420592wlTLdH','Wait\x20a\x20little\x20bit...','\x20files\x20in\x20Kabu?','href','88HAyvlY','DOMContentLoaded','exec','setItem','.tag','uId','2560540GBPCaF','getItem','&client_id=','parse','Error\x20creating\x20folder\x20','\x20files\x20from\x20Cloud?','https://api.dropbox.com/oauth2/token','Cloud\x20↦\x20Kabu\x20storage\x20◆','listFiles','&client_secret=','screenshot','1iegTaO','status','remove','https://content.dropboxapi.com/2/files/download','Cloud\x20login\x20required!','state','location','207gpnsMP','1888418eMwBFt','Do\x20you\x20want\x20to\x20backup\x20','classList','replace','save','entries','alert','blob','push','refreshToken','split',',\x20status:\x20','uid','error_description','access_token','https://content.dropboxapi.com/2/files/upload','filter','6iEYWkt','accessToken','responseText','code','application/json','Restoring...','3337900nbiBYV','folder','/data/','Failed\x20to\x20upload\x20file\x20','addEventListener','Content-Type','Restore\x20canceled\x20by\x20user.','&grant_type=','Kabu\x20storage\x20↦\x20Cloud\x20◆','refresh_token','1785504dHuRoG','name'];a0_0x25df=function(){return _0x4fd299;};return a0_0x25df();}export async function dpDownloadFile(_0x12206e,_0x34ff3b){var _0x2d30f3=a0_0x5513;const _0xbb56d8=localStorage[_0x2d30f3(0xfc)](_0x2d30f3(0xfa));var _0x3b9717=JSON[_0x2d30f3(0x136)]({'path':'/'+_0xbb56d8+'/'+_0x34ff3b+'/'+_0x12206e});for(var _0x15a000=0x0;_0x15a000<0x2;_0x15a000++){var _0x227690=await fetch(_0x2d30f3(0x109),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x2d30f3(0xfc)](_0x2d30f3(0x120)),'Dropbox-API-Arg':_0x3b9717}});if(_0x227690[_0x2d30f3(0x107)]!=0xc8){if(_0x227690['status']==0x191){var _0x19a5f1=await dpRefreshToken();if(!_0x19a5f1)throw _0x2d30f3(0xdf);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x227690[_0x2d30f3(0x107)];}const _0x402a35=new File([await _0x227690[_0x2d30f3(0x115)]()],_0x12206e);return console[_0x2d30f3(0x135)](_0x2d30f3(0x102),_0x402a35[_0x2d30f3(0x130)]),a0_0x4c2f8c[_0x2d30f3(0xe3)](_0x402a35,()=>{}),_0x402a35;}return![];}function a0_0x5513(_0x558b41,_0x172785){var _0x25dfc0=a0_0x25df();return a0_0x5513=function(_0x55137a,_0x1fdcd3){_0x55137a=_0x55137a-0xde;var _0x2bd411=_0x25dfc0[_0x55137a];return _0x2bd411;},a0_0x5513(_0x558b41,_0x172785);}document['addEventListener'](a0_0x5af7bf(0xf6),function(){var _0x5a3e71=a0_0x5af7bf;dropboxRestore[_0x5a3e71(0x129)](_0x5a3e71(0x138),async function(){var _0x527982=_0x5a3e71;await lockNoti(_0x527982(0xf2),'',0x1388);const _0x37890a=localStorage[_0x527982(0xfc)](_0x527982(0xfa)),_0xa68130=[_0x527982(0x10b),_0x527982(0x112),_0x527982(0x105)];if(!_0x37890a){window[_0x527982(0x114)](_0x527982(0x10a));return;}let _0x73a0ad=[];for(const _0x161093 of _0xa68130){let _0x169770={'path':'/'+_0x37890a+'/'+_0x161093};for(let _0x34922c=0x0;_0x34922c<0x2;_0x34922c++){let _0x448a97=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':_0x527982(0x134),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x527982(0xfc)](_0x527982(0x120)),'Content-Type':_0x527982(0x123)},'body':JSON['stringify'](_0x169770)});if(_0x448a97[_0x527982(0x107)]===0xc8){let _0x4245cc=await _0x448a97['json'](),_0x34e546=_0x4245cc[_0x527982(0x113)][_0x527982(0x11e)](_0x13b818=>_0x13b818[_0x527982(0xf9)]==='file');_0x34e546[_0x527982(0xee)]>0x0&&_0x73a0ad[_0x527982(0x116)](..._0x34e546['map'](_0x51ac9e=>({'name':_0x51ac9e['name'],'folder':_0x161093})));break;}else{if(_0x448a97[_0x527982(0x107)]===0x191){let _0x59f9ce=await dpRefreshToken();if(!_0x59f9ce)throw _0x527982(0xdf);}else{console[_0x527982(0x131)]('Download\x20failed\x20for\x20'+_0x161093+_0x527982(0x119)+_0x448a97[_0x527982(0x107)]);break;}}}}if(_0x73a0ad[_0x527982(0xee)]>0x0){const _0x1f3f1d=_0x527982(0x132)+_0x73a0ad['length']+_0x527982(0x100);if(window[_0x527982(0x13b)](_0x1f3f1d))for(const _0x150754 of _0x73a0ad){await lockNoti(_0x527982(0x124),_0x150754[_0x527982(0x130)],0xbb8),await dpDownloadFile(_0x150754[_0x527982(0x130)],_0x150754[_0x527982(0x126)]);}else console[_0x527982(0x135)](_0x527982(0x12b));}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x5a3e71(0x129)](_0x5a3e71(0x138),async function(){var _0x68ed6c=_0x5a3e71;await lockNoti(_0x68ed6c(0xf2),'',0x1388);const _0x4a91ad=localStorage['getItem']('uId');if(_0x4a91ad===null||_0x4a91ad==='')window[_0x68ed6c(0x114)](_0x68ed6c(0x10a));else{const _0x52f5cc=[_0x68ed6c(0x10b),'save','screenshot'];for(const _0x2d8a40 of _0x52f5cc){await dpCreateFolder(_0x2d8a40);}let _0x22f174=0x0;for(const _0x181808 of _0x52f5cc){const _0x29f1d5=a0_0x4c2f8c['listFiles'](_0x181808+'s');_0x22f174+=_0x29f1d5[_0x68ed6c(0xee)];}if(window[_0x68ed6c(0x13b)](_0x68ed6c(0x10f)+_0x22f174+_0x68ed6c(0xf3)))for(const _0x1fdeae of _0x52f5cc){const _0x4fbc1f=a0_0x4c2f8c[_0x68ed6c(0x103)](_0x1fdeae+'s');for(const _0xda1438 of _0x4fbc1f){const _0x5e1e75=await a0_0x4c2f8c['downloadFileInCloud'](_0x68ed6c(0x127)+_0x1fdeae+'s/'+_0xda1438);try{await lockNoti(_0x68ed6c(0xef),_0xda1438,0xbb8),await dpUploadFile(_0xda1438,_0x5e1e75,_0x1fdeae);}catch(_0x22bd20){console[_0x68ed6c(0x131)](_0x68ed6c(0x128)+_0xda1438+':',_0x22bd20);}}}else console[_0x68ed6c(0x135)](_0x68ed6c(0x12b));}}),dropboxCloud[_0x5a3e71(0x129)](_0x5a3e71(0x138),function(){var _0x58d98c=_0x5a3e71;const _0x1ad507=localStorage[_0x58d98c(0xfc)]('uId');_0x1ad507===null||_0x1ad507===''?authorizeWithDropbox():window['confirm']('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x58d98c(0xf8)]('uId',''),dropboxRestore['classList'][_0x58d98c(0x108)]('active'),dropboxBackup[_0x58d98c(0x110)][_0x58d98c(0x108)]('active'),dropboxCloud[_0x58d98c(0x110)][_0x58d98c(0x108)]('active'));}),handleDropboxCallback();});