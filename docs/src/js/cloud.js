var a0_0x138c6a=a0_0x3c05;(function(_0x4de8a9,_0x40b7b1){var _0x4eef38=a0_0x3c05,_0x8411d0=_0x4de8a9();while(!![]){try{var _0x36960e=parseInt(_0x4eef38(0x1fb))/0x1+parseInt(_0x4eef38(0x201))/0x2+parseInt(_0x4eef38(0x1f8))/0x3*(-parseInt(_0x4eef38(0x217))/0x4)+-parseInt(_0x4eef38(0x213))/0x5+-parseInt(_0x4eef38(0x1ed))/0x6+-parseInt(_0x4eef38(0x230))/0x7*(parseInt(_0x4eef38(0x231))/0x8)+parseInt(_0x4eef38(0x209))/0x9;if(_0x36960e===_0x40b7b1)break;else _0x8411d0['push'](_0x8411d0['shift']());}catch(_0xe578ff){_0x8411d0['push'](_0x8411d0['shift']());}}}(a0_0x3e9d,0x9e135));import*as a0_0x4a4808 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x3e9d(){var _0x525dc1=['status','active','accessToken','href','Folder\x20already\x20exists','open','3633498ZwFcoB','Wait\x20a\x20little\x20bit...','split','[\x5c?&#]','Authorization\x20Code:','state','&token_access_type=','entries','offline','=([^&#]*)','screenshot','687aEznnA','send','nwb3dnfh09rhs31','355430JRwHnu','application/x-www-form-urlencoded','refreshToken','alert','uId','https://api.dropbox.com/oauth2/token','2380556xRIamP','Kabu\x20storage\x20↦\x20Cloud\x20◆','file',',\x20status:\x20','application/octet-stream','Upload\x20failed,\x20unknown\x20http\x20status:\x20','length','Content-Type','16838064RADCan','refresh_token','push','POST','parse','downloadFileInCloud','Cloud\x20↦\x20Kabu\x20storage\x20◆','location','stringify','https://content.dropboxapi.com/2/files/download','6367105cGvBpv','Do\x20you\x20want\x20to\x20logout?','blob','refresh_token=','2012SNDqGP','Failed\x20to\x20refresh\x20Dropbox\x20token.','listFiles','Download\x20failed,\x20unknown\x20http\x20status:','code','Do\x20you\x20want\x20to\x20backup\x20','https://api.dropboxapi.com/2/files/list_folder','No\x20files\x20found\x20to\x20restore.','Folder\x20created','addEventListener','folder','Do\x20not\x20receive\x20authorization','remove','Restoring...','.tag','&grant_type=','setItem','name','Unable\x20to\x20refresh\x20token','log','confirm','json','&client_id=','knh3uz2mx2hp2eu','&client_secret=','63DLPerz','688832AnfWQY','filter','/data/','Error\x20while\x20refreshing\x20token:','error','https://api.dropboxapi.com/2/files/create_folder_v2','Download\x20failed\x20for\x20','error_description','Cloud\x20login\x20required!','click','Error\x20creating\x20folder\x20','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Bearer\x20','save','access_token','map','Do\x20you\x20want\x20to\x20restore\x20','Restore\x20canceled\x20by\x20user.','exec','https://content.dropboxapi.com/2/files/upload','getItem','search','replace','responseText'];a0_0x3e9d=function(){return _0x525dc1;};return a0_0x3e9d();}var clientId=a0_0x138c6a(0x22e),clientSecret=a0_0x138c6a(0x1fa);function authorizeWithDropbox(){var _0x44ff37=a0_0x138c6a,_0x3793e0=window[_0x44ff37(0x210)][_0x44ff37(0x1ea)][_0x44ff37(0x1ef)]('?')[0x0],_0x5aa5be=_0x44ff37(0x21b),_0x2016b3=_0x44ff37(0x1f5),_0x76999a='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x5aa5be+_0x44ff37(0x1f3)+_0x2016b3+'&redirect_uri='+encodeURIComponent(_0x3793e0);window['location'][_0x44ff37(0x1ea)]=_0x76999a;}function handleDropboxCallback(){var _0x1b9edc=a0_0x138c6a,_0xe8eb74=getUrlParameter('code');_0xe8eb74?(getAccessToken(_0xe8eb74),console['log'](_0x1b9edc(0x1f1),_0xe8eb74)):console[_0x1b9edc(0x22a)](_0x1b9edc(0x222));}function getUrlParameter(_0x3ba8e0){var _0x4bc2af=a0_0x138c6a;_0x3ba8e0=_0x3ba8e0[_0x4bc2af(0x1e5)](/[\[]/,'\x5c[')[_0x4bc2af(0x1e5)](/[\]]/,'\x5c]');var _0xc55fa8=new RegExp(_0x4bc2af(0x1f0)+_0x3ba8e0+_0x4bc2af(0x1f6)),_0x22ca37=_0xc55fa8[_0x4bc2af(0x1e1)](location[_0x4bc2af(0x1e4)]);return _0x22ca37===null?'':decodeURIComponent(_0x22ca37[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0xfd7fd1){var _0x164010=a0_0x138c6a,_0x4338ca='authorization_code',_0x4976bb=window[_0x164010(0x210)]['href'][_0x164010(0x1ef)]('?')[0x0],_0x30ff72=new XMLHttpRequest();_0x30ff72[_0x164010(0x1ec)](_0x164010(0x20c),_0x164010(0x200)),_0x30ff72['setRequestHeader'](_0x164010(0x208),_0x164010(0x1fc)),_0x30ff72['onload']=function(){var _0x2cfa83=_0x164010;if(_0x30ff72['status']===0xc8){var _0x34f73f=JSON[_0x2cfa83(0x20d)](_0x30ff72[_0x2cfa83(0x1e6)]),_0x42ce42=_0x34f73f[_0x2cfa83(0x1dd)],_0x761031=_0x34f73f[_0x2cfa83(0x20a)],_0x3fdb1c=_0x34f73f['uid'];localStorage[_0x2cfa83(0x227)]('accessToken',_0x42ce42),localStorage[_0x2cfa83(0x227)]('refreshToken',_0x761031),localStorage['setItem']('uId',_0x3fdb1c);}else console[_0x2cfa83(0x22a)](_0x2cfa83(0x1da));},_0x30ff72[_0x164010(0x1f9)]('code='+_0xfd7fd1+_0x164010(0x226)+_0x4338ca+_0x164010(0x22d)+clientId+_0x164010(0x22f)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x4976bb));}export async function dpCreateFolder(_0x283ae4){var _0x2107d2=a0_0x138c6a;const _0x302eb1=localStorage[_0x2107d2(0x1e3)](_0x2107d2(0x1ff));let _0x4b13dd=localStorage[_0x2107d2(0x1e3)](_0x2107d2(0x1e9));const _0x3a92a8='/'+_0x302eb1+'/'+_0x283ae4,_0x5d340d=JSON['stringify']({'path':_0x3a92a8,'autorename':![]});for(let _0x4dee56=0x0;_0x4dee56<0x2;_0x4dee56++){try{const _0xcbe9a1=await fetch(_0x2107d2(0x236),{'method':_0x2107d2(0x20c),'headers':{'Authorization':'Bearer\x20'+_0x4b13dd,'Content-Type':'application/json'},'body':_0x5d340d});if(_0xcbe9a1[_0x2107d2(0x1e7)]===0x191){const _0x105d92=await dpRefreshToken();if(!_0x105d92)throw new Error('Unable\x20to\x20refresh\x20token');_0x4b13dd=localStorage[_0x2107d2(0x1e3)](_0x2107d2(0x1e9));continue;}if(_0xcbe9a1[_0x2107d2(0x1e7)]===0x199)return{'message':_0x2107d2(0x1eb),'path':_0x283ae4};if(!_0xcbe9a1['ok'])throw new Error(_0x2107d2(0x1d9)+_0x283ae4);const _0x538955=await _0xcbe9a1[_0x2107d2(0x22c)]();return await lockNoti(_0x2107d2(0x21f),'',0xbb8),_0x538955;}catch(_0x370099){if(_0x4dee56===0x1)throw _0x370099;}}return![];}export async function dpRefreshToken(){var _0x4e0230=a0_0x138c6a;if(!localStorage[_0x4e0230(0x1e3)](_0x4e0230(0x1fd)))throw'No\x20refresh\x20token';try{const _0x100dec=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x4e0230(0x20c),'headers':{'Content-Type':_0x4e0230(0x1fc)},'body':_0x4e0230(0x216)+localStorage['getItem']('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x5258c6=await _0x100dec[_0x4e0230(0x22c)]();if(!_0x5258c6[_0x4e0230(0x235)])return localStorage[_0x4e0230(0x227)](_0x4e0230(0x1e9),_0x5258c6[_0x4e0230(0x1dd)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x5258c6[_0x4e0230(0x238)]||_0x4e0230(0x218));}catch(_0x30f97d){console[_0x4e0230(0x235)](_0x4e0230(0x234),_0x30f97d);}return![];}function a0_0x3c05(_0x3feb00,_0x5e0397){var _0x3e9dc8=a0_0x3e9d();return a0_0x3c05=function(_0x3c057b,_0x13144b){_0x3c057b=_0x3c057b-0x1d9;var _0x1e13ba=_0x3e9dc8[_0x3c057b];return _0x1e13ba;},a0_0x3c05(_0x3feb00,_0x5e0397);}export async function dpUploadFile(_0x34aaeb,_0x143e16,_0x1c26e8){var _0x41cee7=a0_0x138c6a;const _0x1df7ca=localStorage[_0x41cee7(0x1e3)](_0x41cee7(0x1ff));var _0x41d009=JSON[_0x41cee7(0x211)]({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x1df7ca+'/'+_0x1c26e8+'/'+_0x34aaeb}),_0x1f8ec0=new Blob([_0x143e16],{'type':_0x41cee7(0x205)});for(var _0x570bf9=0x0;_0x570bf9<0x2;_0x570bf9++){var _0x59bb4c=await fetch(_0x41cee7(0x1e2),{'method':'POST','headers':{'Authorization':_0x41cee7(0x1db)+localStorage['getItem'](_0x41cee7(0x1e9)),'Dropbox-API-Arg':_0x41d009,'Content-Type':_0x41cee7(0x205)},'body':_0x1f8ec0});if(_0x59bb4c[_0x41cee7(0x1e7)]!=0xc8){if(_0x59bb4c[_0x41cee7(0x1e7)]==0x191){var _0x526bda=await dpRefreshToken();if(!_0x526bda)throw _0x41cee7(0x229);continue;}else throw _0x41cee7(0x206)+_0x59bb4c[_0x41cee7(0x1e7)];}else{var _0x26920d=await _0x59bb4c[_0x41cee7(0x22c)]();return console[_0x41cee7(0x22a)](_0x41cee7(0x202),_0x34aaeb),_0x26920d;}}return![];}export async function dpDownloadFile(_0x315ed1,_0x38b1c0){var _0xa44607=a0_0x138c6a;const _0x4ca5ac=localStorage[_0xa44607(0x1e3)](_0xa44607(0x1ff));var _0x41091f=JSON['stringify']({'path':'/'+_0x4ca5ac+'/'+_0x38b1c0+'/'+_0x315ed1});for(var _0x366790=0x0;_0x366790<0x2;_0x366790++){var _0x50465b=await fetch(_0xa44607(0x212),{'method':_0xa44607(0x20c),'headers':{'Authorization':'Bearer\x20'+localStorage[_0xa44607(0x1e3)]('accessToken'),'Dropbox-API-Arg':_0x41091f}});if(_0x50465b['status']!=0xc8){if(_0x50465b['status']==0x191){var _0x3f0141=await dpRefreshToken();if(!_0x3f0141)throw _0xa44607(0x229);continue;}else throw _0xa44607(0x21a)+_0x50465b[_0xa44607(0x1e7)];}const _0x3a3128=new File([await _0x50465b[_0xa44607(0x215)]()],_0x315ed1);return console[_0xa44607(0x22a)](_0xa44607(0x20f),_0x3a3128[_0xa44607(0x228)]),a0_0x4a4808['uploadFileInCloud'](_0x3a3128,()=>{}),_0x3a3128;}return![];}document[a0_0x138c6a(0x220)]('DOMContentLoaded',function(){var _0x32f697=a0_0x138c6a;dropboxRestore[_0x32f697(0x220)](_0x32f697(0x23a),async function(){var _0x56f388=_0x32f697;await lockNoti(_0x56f388(0x1ee),'',0x1388);const _0x4a3ce9=localStorage['getItem'](_0x56f388(0x1ff)),_0x29196c=[_0x56f388(0x1f2),_0x56f388(0x1dc),_0x56f388(0x1f7)];if(!_0x4a3ce9){window['alert'](_0x56f388(0x239));return;}let _0x42e7f3=[];for(const _0x527885 of _0x29196c){let _0x210ea5={'path':'/'+_0x4a3ce9+'/'+_0x527885};for(let _0x5e3b27=0x0;_0x5e3b27<0x2;_0x5e3b27++){let _0x30a701=await fetch(_0x56f388(0x21d),{'method':_0x56f388(0x20c),'headers':{'Authorization':_0x56f388(0x1db)+localStorage[_0x56f388(0x1e3)](_0x56f388(0x1e9)),'Content-Type':'application/json'},'body':JSON[_0x56f388(0x211)](_0x210ea5)});if(_0x30a701['status']===0xc8){let _0x5ccdc4=await _0x30a701['json'](),_0xce4e7a=_0x5ccdc4[_0x56f388(0x1f4)][_0x56f388(0x232)](_0xa98814=>_0xa98814[_0x56f388(0x225)]===_0x56f388(0x203));_0xce4e7a[_0x56f388(0x207)]>0x0&&_0x42e7f3[_0x56f388(0x20b)](..._0xce4e7a[_0x56f388(0x1de)](_0x1f1a6c=>({'name':_0x1f1a6c[_0x56f388(0x228)],'folder':_0x527885})));break;}else{if(_0x30a701['status']===0x191){let _0xca692d=await dpRefreshToken();if(!_0xca692d)throw _0x56f388(0x229);}else{console[_0x56f388(0x235)](_0x56f388(0x237)+_0x527885+_0x56f388(0x204)+_0x30a701[_0x56f388(0x1e7)]);break;}}}}if(_0x42e7f3[_0x56f388(0x207)]>0x0){const _0x2d0d55=_0x56f388(0x1df)+_0x42e7f3[_0x56f388(0x207)]+'\x20files\x20from\x20Cloud?';if(window[_0x56f388(0x22b)](_0x2d0d55))for(const _0xaee578 of _0x42e7f3){await lockNoti(_0x56f388(0x224),_0xaee578[_0x56f388(0x228)],0xbb8),await dpDownloadFile(_0xaee578['name'],_0xaee578[_0x56f388(0x221)]);}else console['log'](_0x56f388(0x1e0));}else console[_0x56f388(0x22a)](_0x56f388(0x21e));}),dropboxBackup[_0x32f697(0x220)](_0x32f697(0x23a),async function(){var _0x1d8abe=_0x32f697;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x1d42ac=localStorage[_0x1d8abe(0x1e3)]('uId');if(_0x1d42ac===null||_0x1d42ac==='')window[_0x1d8abe(0x1fe)](_0x1d8abe(0x239));else{const _0x3303cc=[_0x1d8abe(0x1f2),_0x1d8abe(0x1dc),_0x1d8abe(0x1f7)];for(const _0x111ef2 of _0x3303cc){await dpCreateFolder(_0x111ef2);}let _0x25e054=0x0;for(const _0x15a516 of _0x3303cc){const _0x40e4d0=a0_0x4a4808[_0x1d8abe(0x219)](_0x15a516+'s');_0x25e054+=_0x40e4d0[_0x1d8abe(0x207)];}if(window[_0x1d8abe(0x22b)](_0x1d8abe(0x21c)+_0x25e054+'\x20files\x20in\x20Kabu?'))for(const _0x12e340 of _0x3303cc){const _0x319c9b=a0_0x4a4808[_0x1d8abe(0x219)](_0x12e340+'s');for(const _0x58fe34 of _0x319c9b){const _0x2453b1=await a0_0x4a4808[_0x1d8abe(0x20e)](_0x1d8abe(0x233)+_0x12e340+'s/'+_0x58fe34);try{await lockNoti('Backing\x20up...',_0x58fe34,0xbb8),await dpUploadFile(_0x58fe34,_0x2453b1,_0x12e340);}catch(_0x57ccc8){console[_0x1d8abe(0x235)]('Failed\x20to\x20upload\x20file\x20'+_0x58fe34+':',_0x57ccc8);}}}else console[_0x1d8abe(0x22a)](_0x1d8abe(0x1e0));}}),dropboxCloud['addEventListener'](_0x32f697(0x23a),function(){var _0x52be2b=_0x32f697;const _0x5722a3=localStorage[_0x52be2b(0x1e3)]('uId');_0x5722a3===null||_0x5722a3===''?authorizeWithDropbox():window[_0x52be2b(0x22b)](_0x52be2b(0x214))&&(localStorage['setItem'](_0x52be2b(0x1ff),''),dropboxRestore['classList'][_0x52be2b(0x223)]('active'),dropboxBackup['classList']['remove'](_0x52be2b(0x1e8)),dropboxCloud['classList']['remove'](_0x52be2b(0x1e8)));}),handleDropboxCallback();});