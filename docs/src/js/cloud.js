var a0_0x5ab2df=a0_0xde6f;function a0_0xde6f(_0x49cf93,_0x54b146){var _0x3c1919=a0_0x3c19();return a0_0xde6f=function(_0xde6f1b,_0x3314cc){_0xde6f1b=_0xde6f1b-0x98;var _0x42ba2e=_0x3c1919[_0xde6f1b];return _0x42ba2e;},a0_0xde6f(_0x49cf93,_0x54b146);}(function(_0x2ebe07,_0x12d17e){var _0x426871=a0_0xde6f,_0x17366e=_0x2ebe07();while(!![]){try{var _0x5a404f=-parseInt(_0x426871(0xec))/0x1+-parseInt(_0x426871(0xde))/0x2+-parseInt(_0x426871(0xe4))/0x3+-parseInt(_0x426871(0xc4))/0x4+-parseInt(_0x426871(0xbc))/0x5*(parseInt(_0x426871(0xd4))/0x6)+parseInt(_0x426871(0xa4))/0x7+-parseInt(_0x426871(0xe6))/0x8*(-parseInt(_0x426871(0xa6))/0x9);if(_0x5a404f===_0x12d17e)break;else _0x17366e['push'](_0x17366e['shift']());}catch(_0x1c9681){_0x17366e['push'](_0x17366e['shift']());}}}(a0_0x3c19,0xdee95));import*as a0_0x148dcf from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x5ab2df(0xa9),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x4672a3=a0_0x5ab2df,_0xcc8f98=window['location'][_0x4672a3(0xe2)]['split']('?')[0x0],_0x1ecec5='code',_0x157421=_0x4672a3(0xd2),_0x2e214d=_0x4672a3(0xba)+clientId+_0x4672a3(0xee)+_0x1ecec5+_0x4672a3(0xca)+_0x157421+_0x4672a3(0xcd)+encodeURIComponent(_0xcc8f98);window[_0x4672a3(0xae)][_0x4672a3(0xe2)]=_0x2e214d;}function handleDropboxCallback(){var _0xe55010=a0_0x5ab2df,_0x40e208=getUrlParameter('code');_0x40e208?(getAccessToken(_0x40e208),console[_0xe55010(0xf9)](_0xe55010(0xbe),_0x40e208)):console[_0xe55010(0xf9)](_0xe55010(0xf8));}function getUrlParameter(_0x170aae){var _0x412f23=a0_0x5ab2df;_0x170aae=_0x170aae[_0x412f23(0xe7)](/[\[]/,'\x5c[')[_0x412f23(0xe7)](/[\]]/,'\x5c]');var _0x5d5ef5=new RegExp(_0x412f23(0xc9)+_0x170aae+_0x412f23(0xbb)),_0x3d69a9=_0x5d5ef5[_0x412f23(0xf5)](location[_0x412f23(0xf7)]);return _0x3d69a9===null?'':decodeURIComponent(_0x3d69a9[0x1][_0x412f23(0xe7)](/\+/g,'\x20'));}function a0_0x3c19(){var _0x428140=['error','click','remove','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','application/octet-stream','push','Cloud\x20↦\x20Kabu\x20storage\x20◆','send','downloadFileInCloud','https://www.dropbox.com/oauth2/authorize?client_id=','=([^&#]*)','1285rmtjcn','&client_id=','Authorization\x20Code:','Cloud\x20login\x20required!','accessToken','https://api.dropboxapi.com/oauth2/token','addEventListener','parse','5435984FANRIv','access_token','https://content.dropboxapi.com/2/files/download','refreshToken','setRequestHeader','[\x5c?&#]','&token_access_type=','Wait\x20a\x20little\x20bit...','Do\x20you\x20want\x20to\x20restore\x20','&redirect_uri=','Do\x20you\x20want\x20to\x20logout?','No\x20files\x20found\x20to\x20restore.','blob','Download\x20failed,\x20unknown\x20http\x20status:','offline','Unable\x20to\x20refresh\x20token','2712gyMZNu','Failed\x20to\x20upload\x20file\x20','/data/','name','json','getItem','No\x20refresh\x20token','https://api.dropboxapi.com/2/files/list_folder','length','https://api.dropbox.com/oauth2/token','3536906VhbRxO','file','confirm','uId','href','listFiles','1670958AfpcEO','overwrite','349504eqjQkx','replace','save','application/x-www-form-urlencoded','status','Refreshing\x20token...','578741EkjUpQ','Folder\x20already\x20exists','&response_type=','stringify','Do\x20you\x20want\x20to\x20backup\x20','refresh_token=','filter','active','Bearer\x20','exec','split','search','Do\x20not\x20receive\x20authorization','log','entries','folder','https://api.dropboxapi.com/2/files/create_folder_v2','setItem','Kabu\x20storage\x20↦\x20Cloud\x20◆','classList','screenshot','responseText','Restoring...','POST','alert','application/json','Folder\x20created','Upload\x20failed,\x20unknown\x20http\x20status:\x20','\x20files\x20from\x20Cloud?','8299991rMRqZB','Restore\x20canceled\x20by\x20user.','846PwXUbD','onload','authorization_code','knh3uz2mx2hp2eu',',\x20status:\x20','uid','code=','DOMContentLoaded','location','state','Download\x20failed\x20for\x20'];a0_0x3c19=function(){return _0x428140;};return a0_0x3c19();}function getAccessToken(_0x2fe6aa){var _0x1e840b=a0_0x5ab2df,_0x48c024=_0x1e840b(0xa8),_0x447407=window[_0x1e840b(0xae)][_0x1e840b(0xe2)][_0x1e840b(0xf6)]('?')[0x0],_0x2765a5=new XMLHttpRequest();_0x2765a5['open']('POST',_0x1e840b(0xdd)),_0x2765a5[_0x1e840b(0xc8)]('Content-Type',_0x1e840b(0xe9)),_0x2765a5[_0x1e840b(0xa7)]=function(){var _0x5b3992=_0x1e840b;if(_0x2765a5['status']===0xc8){var _0x1343b3=JSON[_0x5b3992(0xc3)](_0x2765a5[_0x5b3992(0x9c)]),_0x4af01b=_0x1343b3[_0x5b3992(0xc5)],_0x1f7a65=_0x1343b3['refresh_token'],_0xfcfae2=_0x1343b3[_0x5b3992(0xab)];localStorage[_0x5b3992(0x98)](_0x5b3992(0xc0),_0x4af01b),localStorage['setItem'](_0x5b3992(0xc7),_0x1f7a65),localStorage[_0x5b3992(0x98)](_0x5b3992(0xe1),_0xfcfae2);}else console[_0x5b3992(0xf9)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x2765a5[_0x1e840b(0xb8)](_0x1e840b(0xac)+_0x2fe6aa+'&grant_type='+_0x48c024+_0x1e840b(0xbd)+clientId+'&client_secret='+clientSecret+_0x1e840b(0xcd)+encodeURIComponent(_0x447407));}export async function dpCreateFolder(_0x266aa2){var _0x78d18e=a0_0x5ab2df;const _0x144fd8=localStorage[_0x78d18e(0xd9)]('uId');let _0x5ac797=localStorage[_0x78d18e(0xd9)](_0x78d18e(0xc0));const _0x38705c='/'+_0x144fd8+'/'+_0x266aa2,_0x458fd3=JSON[_0x78d18e(0xef)]({'path':_0x38705c,'autorename':![]});for(let _0x5d9b18=0x0;_0x5d9b18<0x2;_0x5d9b18++){try{const _0x251687=await fetch(_0x78d18e(0xfc),{'method':'POST','headers':{'Authorization':_0x78d18e(0xf4)+_0x5ac797,'Content-Type':'application/json'},'body':_0x458fd3});if(_0x251687[_0x78d18e(0xea)]===0x191){const _0x4508a2=await dpRefreshToken();if(!_0x4508a2)throw new Error(_0x78d18e(0xd3));_0x5ac797=localStorage[_0x78d18e(0xd9)](_0x78d18e(0xc0));continue;}if(_0x251687[_0x78d18e(0xea)]===0x199)return{'message':_0x78d18e(0xed),'path':_0x266aa2};if(!_0x251687['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x266aa2);const _0x14774c=await _0x251687['json']();return await lockNoti(_0x78d18e(0xa1),'',0xbb8),_0x14774c;}catch(_0x31c604){if(_0x5d9b18===0x1)throw _0x31c604;}}return![];}export async function dpRefreshToken(){var _0x953883=a0_0x5ab2df;if(!localStorage['getItem'](_0x953883(0xc7)))throw _0x953883(0xda);try{const _0x329059=await fetch(_0x953883(0xc1),{'method':'POST','headers':{'Content-Type':_0x953883(0xe9)},'body':_0x953883(0xf1)+localStorage[_0x953883(0xd9)](_0x953883(0xc7))+_0x953883(0xb4)}),_0x512c71=await _0x329059[_0x953883(0xd8)]();if(!_0x512c71['error'])return localStorage[_0x953883(0x98)](_0x953883(0xc0),_0x512c71[_0x953883(0xc5)]),await lockNoti(_0x953883(0xeb),'',0xbb8),await delay(0x3e8),!![];else alert(_0x512c71['error_description']||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0xad1a89){console[_0x953883(0xb1)]('Error\x20while\x20refreshing\x20token:',_0xad1a89);}return![];}export async function dpUploadFile(_0x2d670d,_0x239709,_0x2abd04){var _0x4c2cb8=a0_0x5ab2df;const _0x2a6aad=localStorage[_0x4c2cb8(0xd9)]('uId');var _0x47e04b=JSON[_0x4c2cb8(0xef)]({'autorename':!![],'mode':_0x4c2cb8(0xe5),'mute':!![],'strict_conflict':![],'path':'/'+_0x2a6aad+'/'+_0x2abd04+'/'+_0x2d670d}),_0x3cc913=new Blob([_0x239709],{'type':_0x4c2cb8(0xb5)});for(var _0x5ada08=0x0;_0x5ada08<0x2;_0x5ada08++){var _0x49bb02=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x4c2cb8(0xf4)+localStorage[_0x4c2cb8(0xd9)](_0x4c2cb8(0xc0)),'Dropbox-API-Arg':_0x47e04b,'Content-Type':_0x4c2cb8(0xb5)},'body':_0x3cc913});if(_0x49bb02[_0x4c2cb8(0xea)]!=0xc8){if(_0x49bb02[_0x4c2cb8(0xea)]==0x191){var _0x26edd2=await dpRefreshToken();if(!_0x26edd2)throw _0x4c2cb8(0xd3);continue;}else throw _0x4c2cb8(0xa2)+_0x49bb02[_0x4c2cb8(0xea)];}else{var _0x1dd8cd=await _0x49bb02[_0x4c2cb8(0xd8)]();return console[_0x4c2cb8(0xf9)](_0x4c2cb8(0x99),_0x2d670d),_0x1dd8cd;}}return![];}export async function dpDownloadFile(_0x185b46,_0x15c318){var _0x462ce0=a0_0x5ab2df;const _0x348a22=localStorage[_0x462ce0(0xd9)](_0x462ce0(0xe1));var _0xc9652a=JSON[_0x462ce0(0xef)]({'path':'/'+_0x348a22+'/'+_0x15c318+'/'+_0x185b46});for(var _0x2d18ec=0x0;_0x2d18ec<0x2;_0x2d18ec++){var _0x5eeb50=await fetch(_0x462ce0(0xc6),{'method':_0x462ce0(0x9e),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x462ce0(0xd9)](_0x462ce0(0xc0)),'Dropbox-API-Arg':_0xc9652a}});if(_0x5eeb50[_0x462ce0(0xea)]!=0xc8){if(_0x5eeb50[_0x462ce0(0xea)]==0x191){var _0x3cdc44=await dpRefreshToken();if(!_0x3cdc44)throw _0x462ce0(0xd3);continue;}else throw _0x462ce0(0xd1)+_0x5eeb50[_0x462ce0(0xea)];}const _0x2f4f76=new File([await _0x5eeb50[_0x462ce0(0xd0)]()],_0x185b46);return console['log'](_0x462ce0(0xb7),_0x2f4f76[_0x462ce0(0xd7)]),a0_0x148dcf['uploadFileInCloud'](_0x2f4f76,()=>{}),_0x2f4f76;}return![];}document[a0_0x5ab2df(0xc2)](a0_0x5ab2df(0xad),function(){var _0x433996=a0_0x5ab2df;dropboxRestore['addEventListener']('click',async function(){var _0x262e3c=a0_0xde6f;await lockNoti(_0x262e3c(0xcb),'',0x1388);const _0x3a230f=localStorage[_0x262e3c(0xd9)]('uId'),_0x5999e4=[_0x262e3c(0xaf),_0x262e3c(0xe8),_0x262e3c(0x9b)];if(!_0x3a230f){window[_0x262e3c(0x9f)](_0x262e3c(0xbf));return;}let _0x4efd35=[];for(const _0x7c0097 of _0x5999e4){let _0x4505e1={'path':'/'+_0x3a230f+'/'+_0x7c0097};for(let _0x50aacb=0x0;_0x50aacb<0x2;_0x50aacb++){let _0x29c0c4=await fetch(_0x262e3c(0xdb),{'method':'POST','headers':{'Authorization':_0x262e3c(0xf4)+localStorage[_0x262e3c(0xd9)]('accessToken'),'Content-Type':_0x262e3c(0xa0)},'body':JSON[_0x262e3c(0xef)](_0x4505e1)});if(_0x29c0c4['status']===0xc8){let _0x19f102=await _0x29c0c4[_0x262e3c(0xd8)](),_0x560eb6=_0x19f102[_0x262e3c(0xfa)][_0x262e3c(0xf2)](_0x2e1561=>_0x2e1561['.tag']===_0x262e3c(0xdf));_0x560eb6[_0x262e3c(0xdc)]>0x0&&_0x4efd35[_0x262e3c(0xb6)](..._0x560eb6['map'](_0x2d7704=>({'name':_0x2d7704[_0x262e3c(0xd7)],'folder':_0x7c0097})));break;}else{if(_0x29c0c4['status']===0x191){let _0x3a3484=await dpRefreshToken();if(!_0x3a3484)throw _0x262e3c(0xd3);}else{console[_0x262e3c(0xb1)](_0x262e3c(0xb0)+_0x7c0097+_0x262e3c(0xaa)+_0x29c0c4[_0x262e3c(0xea)]);break;}}}}if(_0x4efd35[_0x262e3c(0xdc)]>0x0){const _0x2c3fd2=_0x262e3c(0xcc)+_0x4efd35['length']+_0x262e3c(0xa3);if(window[_0x262e3c(0xe0)](_0x2c3fd2))for(const _0x225c90 of _0x4efd35){await lockNoti(_0x262e3c(0x9d),_0x225c90['name'],0xbb8),await dpDownloadFile(_0x225c90[_0x262e3c(0xd7)],_0x225c90[_0x262e3c(0xfb)]);}else console[_0x262e3c(0xf9)](_0x262e3c(0xa5));}else console[_0x262e3c(0xf9)](_0x262e3c(0xcf));}),dropboxBackup[_0x433996(0xc2)]('click',async function(){var _0x5a4c3d=_0x433996;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x282e94=localStorage[_0x5a4c3d(0xd9)]('uId');if(_0x282e94===null||_0x282e94==='')window[_0x5a4c3d(0x9f)](_0x5a4c3d(0xbf));else{const _0x541c32=['state',_0x5a4c3d(0xe8),_0x5a4c3d(0x9b)];for(const _0x440e74 of _0x541c32){await dpCreateFolder(_0x440e74);}let _0x514617=0x0;for(const _0x2603e1 of _0x541c32){const _0x3a41a4=a0_0x148dcf[_0x5a4c3d(0xe3)](_0x2603e1+'s');_0x514617+=_0x3a41a4[_0x5a4c3d(0xdc)];}if(window['confirm'](_0x5a4c3d(0xf0)+_0x514617+'\x20files\x20in\x20Kabu?'))for(const _0x5edf68 of _0x541c32){const _0x2f1483=a0_0x148dcf['listFiles'](_0x5edf68+'s');for(const _0x46c57e of _0x2f1483){const _0x9c97b1=await a0_0x148dcf[_0x5a4c3d(0xb9)](_0x5a4c3d(0xd6)+_0x5edf68+'s/'+_0x46c57e);try{await lockNoti('Backing\x20up...',_0x46c57e,0xbb8),await dpUploadFile(_0x46c57e,_0x9c97b1,_0x5edf68);}catch(_0x4a02ca){console['error'](_0x5a4c3d(0xd5)+_0x46c57e+':',_0x4a02ca);}}}else console[_0x5a4c3d(0xf9)](_0x5a4c3d(0xa5));}}),dropboxCloud[_0x433996(0xc2)](_0x433996(0xb2),function(){var _0x4b5e1f=_0x433996;const _0x21805c=localStorage[_0x4b5e1f(0xd9)]('uId');_0x21805c===null||_0x21805c===''?authorizeWithDropbox():window[_0x4b5e1f(0xe0)](_0x4b5e1f(0xce))&&(localStorage['setItem'](_0x4b5e1f(0xe1),''),dropboxRestore[_0x4b5e1f(0x9a)][_0x4b5e1f(0xb3)](_0x4b5e1f(0xf3)),dropboxBackup[_0x4b5e1f(0x9a)][_0x4b5e1f(0xb3)](_0x4b5e1f(0xf3)),dropboxCloud[_0x4b5e1f(0x9a)][_0x4b5e1f(0xb3)](_0x4b5e1f(0xf3)));}),handleDropboxCallback();});