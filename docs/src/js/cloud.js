var a0_0x366abf=a0_0x5415;function a0_0x5415(_0x509247,_0x112a56){var _0x2a94c8=a0_0x2a94();return a0_0x5415=function(_0x541586,_0x50e908){_0x541586=_0x541586-0x183;var _0x1aa294=_0x2a94c8[_0x541586];return _0x1aa294;},a0_0x5415(_0x509247,_0x112a56);}(function(_0xeb4b55,_0x136c3f){var _0x18ce15=a0_0x5415,_0x561239=_0xeb4b55();while(!![]){try{var _0x23efb7=-parseInt(_0x18ce15(0x18f))/0x1+-parseInt(_0x18ce15(0x1dc))/0x2*(parseInt(_0x18ce15(0x1e2))/0x3)+-parseInt(_0x18ce15(0x1aa))/0x4*(-parseInt(_0x18ce15(0x1b1))/0x5)+-parseInt(_0x18ce15(0x1e1))/0x6+-parseInt(_0x18ce15(0x1d2))/0x7*(parseInt(_0x18ce15(0x194))/0x8)+parseInt(_0x18ce15(0x1b8))/0x9+parseInt(_0x18ce15(0x1ca))/0xa;if(_0x23efb7===_0x136c3f)break;else _0x561239['push'](_0x561239['shift']());}catch(_0x45b081){_0x561239['push'](_0x561239['shift']());}}}(a0_0x2a94,0x47dc2));import*as a0_0x1dcb6f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x366abf(0x18d),clientSecret='nwb3dnfh09rhs31';function a0_0x2a94(){var _0x5683f6=['application/octet-stream','2380668GuqiSh','3pphjQn','screenshot','status','remove','https://content.dropboxapi.com/2/files/upload','Do\x20you\x20want\x20to\x20logout?','Upload\x20failed,\x20unknown\x20http\x20status:\x20','POST','&grant_type=','Unable\x20to\x20refresh\x20token','listFiles','knh3uz2mx2hp2eu','error_description','127173fEvRnD','filter','application/x-www-form-urlencoded','blob','\x20files\x20from\x20Cloud?','24cMrocg','name','refresh_token','https://api.dropboxapi.com/2/files/create_folder_v2','click','[\x5c?&#]','onload','exec','log','Download\x20failed\x20for\x20','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','classList','refresh_token=','Download\x20failed,\x20unknown\x20http\x20status:','getItem','href','Refreshing\x20token...','save','access_token','Bearer\x20','split','location','2408mjatIo','Wait\x20a\x20little\x20bit...','&redirect_uri=','stringify','&response_type=','accessToken','No\x20files\x20found\x20to\x20restore.','4685SeAxWE','Content-Type','uId','alert','file','addEventListener','parse','1179162FmvzEe','code=','responseText','Folder\x20already\x20exists','application/json','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','state','Folder\x20created','Do\x20you\x20want\x20to\x20restore\x20','downloadFileInCloud','refreshToken','&client_id=','active','setRequestHeader','Do\x20not\x20receive\x20authorization','send','replace','&token_access_type=','7996300VTvLyw','Restoring...','overwrite','https://www.dropbox.com/oauth2/authorize?client_id=','setItem','=([^&#]*)','confirm','Backing\x20up...','1223390pbJxtb','length','&client_secret=','json','uid','Do\x20you\x20want\x20to\x20backup\x20','https://api.dropboxapi.com/oauth2/token','Error\x20creating\x20folder\x20','Cloud\x20login\x20required!','entries','304246pjfKgq','Kabu\x20storage\x20↦\x20Cloud\x20◆','code','error'];a0_0x2a94=function(){return _0x5683f6;};return a0_0x2a94();}function authorizeWithDropbox(){var _0x3bd8d8=a0_0x366abf,_0x14d1c8=window[_0x3bd8d8(0x1a9)][_0x3bd8d8(0x1a3)][_0x3bd8d8(0x1a8)]('?')[0x0],_0xa54f07=_0x3bd8d8(0x1de),_0x1473b3='offline',_0xa6332c=_0x3bd8d8(0x1cd)+clientId+_0x3bd8d8(0x1ae)+_0xa54f07+_0x3bd8d8(0x1c9)+_0x1473b3+_0x3bd8d8(0x1ac)+encodeURIComponent(_0x14d1c8);window[_0x3bd8d8(0x1a9)][_0x3bd8d8(0x1a3)]=_0xa6332c;}function handleDropboxCallback(){var _0xdbf28d=a0_0x366abf,_0x345abc=getUrlParameter(_0xdbf28d(0x1de));_0x345abc?(getAccessToken(_0x345abc),console['log']('Authorization\x20Code:',_0x345abc)):console[_0xdbf28d(0x19c)](_0xdbf28d(0x1c6));}function getUrlParameter(_0x4d0bbd){var _0x5c0281=a0_0x366abf;_0x4d0bbd=_0x4d0bbd['replace'](/[\[]/,'\x5c[')[_0x5c0281(0x1c8)](/[\]]/,'\x5c]');var _0x12d2ac=new RegExp(_0x5c0281(0x199)+_0x4d0bbd+_0x5c0281(0x1cf)),_0x435b25=_0x12d2ac[_0x5c0281(0x19b)](location['search']);return _0x435b25===null?'':decodeURIComponent(_0x435b25[0x1][_0x5c0281(0x1c8)](/\+/g,'\x20'));}function getAccessToken(_0x32782d){var _0x1d036b=a0_0x366abf,_0x2e8bc3='authorization_code',_0x3caf05=window[_0x1d036b(0x1a9)][_0x1d036b(0x1a3)][_0x1d036b(0x1a8)]('?')[0x0],_0x1fbf82=new XMLHttpRequest();_0x1fbf82['open']('POST','https://api.dropbox.com/oauth2/token'),_0x1fbf82[_0x1d036b(0x1c5)](_0x1d036b(0x1b2),_0x1d036b(0x191)),_0x1fbf82[_0x1d036b(0x19a)]=function(){var _0x2ec366=_0x1d036b;if(_0x1fbf82['status']===0xc8){var _0x8a9ea8=JSON[_0x2ec366(0x1b7)](_0x1fbf82[_0x2ec366(0x1ba)]),_0x22a96c=_0x8a9ea8['access_token'],_0xb0ed1f=_0x8a9ea8[_0x2ec366(0x196)],_0xfaeb48=_0x8a9ea8[_0x2ec366(0x1d6)];localStorage[_0x2ec366(0x1ce)](_0x2ec366(0x1af),_0x22a96c),localStorage[_0x2ec366(0x1ce)](_0x2ec366(0x1c2),_0xb0ed1f),localStorage[_0x2ec366(0x1ce)](_0x2ec366(0x1b3),_0xfaeb48);}else console[_0x2ec366(0x19c)](_0x2ec366(0x1bd));},_0x1fbf82[_0x1d036b(0x1c7)](_0x1d036b(0x1b9)+_0x32782d+_0x1d036b(0x18a)+_0x2e8bc3+_0x1d036b(0x1c3)+clientId+_0x1d036b(0x1d4)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x3caf05));}export async function dpCreateFolder(_0x41cb48){var _0x313481=a0_0x366abf;const _0x417de1=localStorage[_0x313481(0x1a2)](_0x313481(0x1b3));let _0x23821c=localStorage['getItem'](_0x313481(0x1af));const _0x596c13='/'+_0x417de1+'/'+_0x41cb48,_0x18467a=JSON[_0x313481(0x1ad)]({'path':_0x596c13,'autorename':![]});for(let _0x189048=0x0;_0x189048<0x2;_0x189048++){try{const _0x1b6b91=await fetch(_0x313481(0x197),{'method':_0x313481(0x189),'headers':{'Authorization':_0x313481(0x1a7)+_0x23821c,'Content-Type':'application/json'},'body':_0x18467a});if(_0x1b6b91[_0x313481(0x184)]===0x191){const _0x4a65f1=await dpRefreshToken();if(!_0x4a65f1)throw new Error('Unable\x20to\x20refresh\x20token');_0x23821c=localStorage[_0x313481(0x1a2)](_0x313481(0x1af));continue;}if(_0x1b6b91['status']===0x199)return{'message':_0x313481(0x1bb),'path':_0x41cb48};if(!_0x1b6b91['ok'])throw new Error(_0x313481(0x1d9)+_0x41cb48);const _0x10e775=await _0x1b6b91[_0x313481(0x1d5)]();return await lockNoti(_0x313481(0x1bf),'',0xbb8),_0x10e775;}catch(_0x239031){if(_0x189048===0x1)throw _0x239031;}}return![];}export async function dpRefreshToken(){var _0xfc3320=a0_0x366abf;if(!localStorage['getItem'](_0xfc3320(0x1c2)))throw'No\x20refresh\x20token';try{const _0x1ce70f=await fetch(_0xfc3320(0x1d8),{'method':_0xfc3320(0x189),'headers':{'Content-Type':_0xfc3320(0x191)},'body':_0xfc3320(0x1a0)+localStorage[_0xfc3320(0x1a2)]('refreshToken')+_0xfc3320(0x19e)}),_0x220e14=await _0x1ce70f[_0xfc3320(0x1d5)]();if(!_0x220e14['error'])return localStorage[_0xfc3320(0x1ce)](_0xfc3320(0x1af),_0x220e14[_0xfc3320(0x1a6)]),await lockNoti(_0xfc3320(0x1a4),'',0xbb8),await delay(0x3e8),!![];else alert(_0x220e14[_0xfc3320(0x18e)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x38c2eb){console[_0xfc3320(0x1df)]('Error\x20while\x20refreshing\x20token:',_0x38c2eb);}return![];}export async function dpUploadFile(_0x405f5f,_0x28e18d,_0x34613){var _0x3341d5=a0_0x366abf;const _0x3c7a8c=localStorage[_0x3341d5(0x1a2)](_0x3341d5(0x1b3));var _0x4d5660=JSON[_0x3341d5(0x1ad)]({'autorename':!![],'mode':_0x3341d5(0x1cc),'mute':!![],'strict_conflict':![],'path':'/'+_0x3c7a8c+'/'+_0x34613+'/'+_0x405f5f}),_0x51b41e=new Blob([_0x28e18d],{'type':_0x3341d5(0x1e0)});for(var _0xef7ae=0x0;_0xef7ae<0x2;_0xef7ae++){var _0x1e18a0=await fetch(_0x3341d5(0x186),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x3341d5(0x1a2)](_0x3341d5(0x1af)),'Dropbox-API-Arg':_0x4d5660,'Content-Type':_0x3341d5(0x1e0)},'body':_0x51b41e});if(_0x1e18a0['status']!=0xc8){if(_0x1e18a0['status']==0x191){var _0x87b251=await dpRefreshToken();if(!_0x87b251)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x3341d5(0x188)+_0x1e18a0[_0x3341d5(0x184)];}else{var _0x26f30d=await _0x1e18a0[_0x3341d5(0x1d5)]();return console[_0x3341d5(0x19c)](_0x3341d5(0x1dd),_0x405f5f),_0x26f30d;}}return![];}export async function dpDownloadFile(_0x59b636,_0x555a2d){var _0x316a1e=a0_0x366abf;const _0x36e182=localStorage[_0x316a1e(0x1a2)]('uId');var _0x3e207f=JSON['stringify']({'path':'/'+_0x36e182+'/'+_0x555a2d+'/'+_0x59b636});for(var _0x19d85c=0x0;_0x19d85c<0x2;_0x19d85c++){var _0x3291f7=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x316a1e(0x189),'headers':{'Authorization':_0x316a1e(0x1a7)+localStorage[_0x316a1e(0x1a2)](_0x316a1e(0x1af)),'Dropbox-API-Arg':_0x3e207f}});if(_0x3291f7[_0x316a1e(0x184)]!=0xc8){if(_0x3291f7[_0x316a1e(0x184)]==0x191){var _0x177dbb=await dpRefreshToken();if(!_0x177dbb)throw _0x316a1e(0x18b);continue;}else throw _0x316a1e(0x1a1)+_0x3291f7['status'];}const _0x576eef=new File([await _0x3291f7[_0x316a1e(0x192)]()],_0x59b636);return console[_0x316a1e(0x19c)]('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x576eef[_0x316a1e(0x195)]),a0_0x1dcb6f['uploadFileInCloud'](_0x576eef,()=>{}),_0x576eef;}return![];}document[a0_0x366abf(0x1b6)]('DOMContentLoaded',function(){var _0x78c0c3=a0_0x366abf;dropboxRestore[_0x78c0c3(0x1b6)]('click',async function(){var _0xafe5d2=_0x78c0c3;await lockNoti(_0xafe5d2(0x1ab),'',0x1388);const _0x3244dd=localStorage[_0xafe5d2(0x1a2)]('uId'),_0x13d946=[_0xafe5d2(0x1be),_0xafe5d2(0x1a5),_0xafe5d2(0x183)];if(!_0x3244dd){window['alert'](_0xafe5d2(0x1da));return;}let _0x295a38=[];for(const _0x57045b of _0x13d946){let _0x5738a1={'path':'/'+_0x3244dd+'/'+_0x57045b};for(let _0x3c1f8f=0x0;_0x3c1f8f<0x2;_0x3c1f8f++){let _0x138d30=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0xafe5d2(0x1a7)+localStorage[_0xafe5d2(0x1a2)](_0xafe5d2(0x1af)),'Content-Type':_0xafe5d2(0x1bc)},'body':JSON['stringify'](_0x5738a1)});if(_0x138d30[_0xafe5d2(0x184)]===0xc8){let _0x2ef44d=await _0x138d30['json'](),_0x462716=_0x2ef44d[_0xafe5d2(0x1db)][_0xafe5d2(0x190)](_0x61f46c=>_0x61f46c['.tag']===_0xafe5d2(0x1b5));_0x462716[_0xafe5d2(0x1d3)]>0x0&&_0x295a38['push'](..._0x462716['map'](_0x323b3c=>({'name':_0x323b3c[_0xafe5d2(0x195)],'folder':_0x57045b})));break;}else{if(_0x138d30[_0xafe5d2(0x184)]===0x191){let _0x3c0e05=await dpRefreshToken();if(!_0x3c0e05)throw'Unable\x20to\x20refresh\x20token';}else{console[_0xafe5d2(0x1df)](_0xafe5d2(0x19d)+_0x57045b+',\x20status:\x20'+_0x138d30[_0xafe5d2(0x184)]);break;}}}}if(_0x295a38[_0xafe5d2(0x1d3)]>0x0){const _0x4055da=_0xafe5d2(0x1c0)+_0x295a38['length']+_0xafe5d2(0x193);if(window[_0xafe5d2(0x1d0)](_0x4055da))for(const _0x47d7df of _0x295a38){await lockNoti(_0xafe5d2(0x1cb),_0x47d7df['name'],0xbb8),await dpDownloadFile(_0x47d7df['name'],_0x47d7df['folder']);}else console[_0xafe5d2(0x19c)]('Restore\x20canceled\x20by\x20user.');}else console[_0xafe5d2(0x19c)](_0xafe5d2(0x1b0));}),dropboxBackup['addEventListener']('click',async function(){var _0x163042=_0x78c0c3;await lockNoti(_0x163042(0x1ab),'',0x1388);const _0x4e7463=localStorage['getItem']('uId');if(_0x4e7463===null||_0x4e7463==='')window[_0x163042(0x1b4)](_0x163042(0x1da));else{const _0x24c080=['state',_0x163042(0x1a5),'screenshot'];for(const _0x304b45 of _0x24c080){await dpCreateFolder(_0x304b45);}let _0x5deef8=0x0;for(const _0x364020 of _0x24c080){const _0x2eb3a4=a0_0x1dcb6f[_0x163042(0x18c)](_0x364020+'s');_0x5deef8+=_0x2eb3a4[_0x163042(0x1d3)];}if(window[_0x163042(0x1d0)](_0x163042(0x1d7)+_0x5deef8+'\x20files\x20in\x20Kabu?'))for(const _0x631d88 of _0x24c080){const _0x164517=a0_0x1dcb6f[_0x163042(0x18c)](_0x631d88+'s');for(const _0x537883 of _0x164517){const _0x44a886=await a0_0x1dcb6f[_0x163042(0x1c1)]('/data/'+_0x631d88+'s/'+_0x537883);try{await lockNoti(_0x163042(0x1d1),_0x537883,0xbb8),await dpUploadFile(_0x537883,_0x44a886,_0x631d88);}catch(_0xfd198c){console[_0x163042(0x1df)]('Failed\x20to\x20upload\x20file\x20'+_0x537883+':',_0xfd198c);}}}else console[_0x163042(0x19c)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener'](_0x78c0c3(0x198),function(){var _0x3defb4=_0x78c0c3;const _0x3c5258=localStorage['getItem'](_0x3defb4(0x1b3));_0x3c5258===null||_0x3c5258===''?authorizeWithDropbox():window['confirm'](_0x3defb4(0x187))&&(localStorage['setItem'](_0x3defb4(0x1b3),''),dropboxRestore['classList'][_0x3defb4(0x185)]('active'),dropboxBackup[_0x3defb4(0x19f)][_0x3defb4(0x185)](_0x3defb4(0x1c4)),dropboxCloud['classList'][_0x3defb4(0x185)](_0x3defb4(0x1c4)));}),handleDropboxCallback();});