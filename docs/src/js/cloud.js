var a0_0x1c0c4f=a0_0x5823;function a0_0x5e61(){var _0x2bb21f=['access_token','location','Content-Type','map',',\x20status:\x20','error','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','[\x5c?&#]','6581576MaJJrD','Refreshing\x20token...','knh3uz2mx2hp2eu','href','send','Do\x20you\x20want\x20to\x20backup\x20','Error\x20while\x20refreshing\x20token:','application/octet-stream','&client_id=','No\x20files\x20found\x20to\x20restore.','refreshToken','Failed\x20to\x20upload\x20file\x20','Restore\x20canceled\x20by\x20user.','alert','save','entries','state','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Failed\x20to\x20refresh\x20Dropbox\x20token.','562269rmCvDr','Cloud\x20login\x20required!','Authorization\x20Code:','name','https://content.dropboxapi.com/2/files/download','Folder\x20created','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/2/files/create_folder_v2','active','split','https://api.dropboxapi.com/2/files/list_folder','nwb3dnfh09rhs31','refresh_token=','Backing\x20up...','357635fFvNXv','setItem','12TehXmv','confirm','&grant_type=','blob','toUpperCase','responseText','downloadFileInCloud','json','5146830EcvOGg','application/json','&client_secret=','log','Error\x20creating\x20folder\x20','DOMContentLoaded','Folder\x20already\x20exists','uid','&response_type=','uId','addEventListener','Kabu\x20storage\x20↦\x20Cloud\x20◆','charAt','Bearer\x20','slice','https://api.dropboxapi.com/oauth2/token','status','&redirect_uri=','length','stringify','uploadFileInCloud','Unable\x20to\x20refresh\x20token','authorization_code','Wait\x20a\x20little\x20bit...','/data/','Restoring...','code','13249917FMAoPm','accessToken','error_description','POST','click','refresh_token','replace','classList','setRequestHeader','Do\x20you\x20want\x20to\x20logout?','list','21323ckecvE','overwrite','open','getItem','Upload\x20failed,\x20unknown\x20http\x20status:\x20','1714811rYzZlZ','remove','application/x-www-form-urlencoded','2atAyCi','Do\x20you\x20want\x20to\x20restore\x20'];a0_0x5e61=function(){return _0x2bb21f;};return a0_0x5e61();}(function(_0x33f7f7,_0x138038){var _0x646b71=a0_0x5823,_0x2b5407=_0x33f7f7();while(!![]){try{var _0x459323=parseInt(_0x646b71(0x14e))/0x1+parseInt(_0x646b71(0x156))/0x2*(parseInt(_0x646b71(0x110))/0x3)+-parseInt(_0x646b71(0x120))/0x4*(-parseInt(_0x646b71(0x11e))/0x5)+-parseInt(_0x646b71(0x128))/0x6+parseInt(_0x646b71(0x153))/0x7+-parseInt(_0x646b71(0x160))/0x8+parseInt(_0x646b71(0x143))/0x9;if(_0x459323===_0x138038)break;else _0x2b5407['push'](_0x2b5407['shift']());}catch(_0x5a901e){_0x2b5407['push'](_0x2b5407['shift']());}}}(a0_0x5e61,0x704eb));import*as a0_0x3526c9 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x1c0c4f(0x162),clientSecret=a0_0x1c0c4f(0x11b);function authorizeWithDropbox(){var _0x13f161=a0_0x1c0c4f,_0x142ba3=window[_0x13f161(0x159)]['href'][_0x13f161(0x119)]('?')[0x0],_0x1995a4=_0x13f161(0x142),_0x45e4ca='offline',_0x4aa510='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x13f161(0x130)+_0x1995a4+'&token_access_type='+_0x45e4ca+_0x13f161(0x139)+encodeURIComponent(_0x142ba3);window[_0x13f161(0x159)][_0x13f161(0x163)]=_0x4aa510;}function handleDropboxCallback(){var _0x4242c5=a0_0x1c0c4f,_0x3c11b3=getUrlParameter(_0x4242c5(0x142));_0x3c11b3?(getAccessToken(_0x3c11b3),console[_0x4242c5(0x12b)](_0x4242c5(0x112),_0x3c11b3)):console['log']('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x309a09){var _0x20c5df=a0_0x1c0c4f;_0x309a09=_0x309a09['replace'](/[\[]/,'\x5c[')[_0x20c5df(0x149)](/[\]]/,'\x5c]');var _0x4b2b2f=new RegExp(_0x20c5df(0x15f)+_0x309a09+'=([^&#]*)'),_0x315ddd=_0x4b2b2f['exec'](location['search']);return _0x315ddd===null?'':decodeURIComponent(_0x315ddd[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x58fbcb){var _0x24c20e=a0_0x1c0c4f,_0x3d07b5=_0x24c20e(0x13e),_0x544a50=window['location'][_0x24c20e(0x163)]['split']('?')[0x0],_0x32be8f=new XMLHttpRequest();_0x32be8f[_0x24c20e(0x150)]('POST','https://api.dropbox.com/oauth2/token'),_0x32be8f[_0x24c20e(0x14b)](_0x24c20e(0x15a),_0x24c20e(0x155)),_0x32be8f['onload']=function(){var _0xaf1638=_0x24c20e;if(_0x32be8f[_0xaf1638(0x138)]===0xc8){var _0xd2fe6a=JSON['parse'](_0x32be8f[_0xaf1638(0x125)]),_0x12f3cb=_0xd2fe6a['access_token'],_0x28616a=_0xd2fe6a[_0xaf1638(0x148)],_0x1a31ef=_0xd2fe6a[_0xaf1638(0x12f)];localStorage[_0xaf1638(0x11f)](_0xaf1638(0x144),_0x12f3cb),localStorage[_0xaf1638(0x11f)](_0xaf1638(0x16a),_0x28616a),localStorage['setItem'](_0xaf1638(0x131),_0x1a31ef);}else console['log'](_0xaf1638(0x10e));},_0x32be8f[_0x24c20e(0x164)]('code='+_0x58fbcb+_0x24c20e(0x122)+_0x3d07b5+_0x24c20e(0x168)+clientId+_0x24c20e(0x12a)+clientSecret+_0x24c20e(0x139)+encodeURIComponent(_0x544a50));}function a0_0x5823(_0x2b2423,_0xda7c26){var _0x5e61ef=a0_0x5e61();return a0_0x5823=function(_0x5823b3,_0x243d0a){_0x5823b3=_0x5823b3-0x10c;var _0x44eef5=_0x5e61ef[_0x5823b3];return _0x44eef5;},a0_0x5823(_0x2b2423,_0xda7c26);}export async function dpCreateFolder(_0x29fd36){var _0x101dd3=a0_0x1c0c4f;const _0x15d428=localStorage['getItem']('uId');let _0x50dae3=localStorage[_0x101dd3(0x151)](_0x101dd3(0x144));const _0x288af9='/'+_0x15d428+'/'+_0x29fd36,_0x3e8076=JSON[_0x101dd3(0x13b)]({'path':_0x288af9,'autorename':![]});for(let _0x386208=0x0;_0x386208<0x2;_0x386208++){try{const _0x2ecd9f=await fetch(_0x101dd3(0x117),{'method':_0x101dd3(0x146),'headers':{'Authorization':_0x101dd3(0x135)+_0x50dae3,'Content-Type':_0x101dd3(0x129)},'body':_0x3e8076});if(_0x2ecd9f['status']===0x191){const _0x5d95b0=await dpRefreshToken();if(!_0x5d95b0)throw new Error(_0x101dd3(0x13d));_0x50dae3=localStorage[_0x101dd3(0x151)](_0x101dd3(0x144));continue;}if(_0x2ecd9f[_0x101dd3(0x138)]===0x199)return{'message':_0x101dd3(0x12e),'path':_0x29fd36};if(!_0x2ecd9f['ok'])throw new Error(_0x101dd3(0x12c)+_0x29fd36);const _0x349d66=await _0x2ecd9f[_0x101dd3(0x127)]();return await lockNoti(_0x101dd3(0x115),'',0xbb8),_0x349d66;}catch(_0x4cdd60){if(_0x386208===0x1)throw _0x4cdd60;}}return![];}export async function dpRefreshToken(){var _0x40cdb0=a0_0x1c0c4f;if(!localStorage[_0x40cdb0(0x151)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x52fa60=await fetch(_0x40cdb0(0x137),{'method':_0x40cdb0(0x146),'headers':{'Content-Type':_0x40cdb0(0x155)},'body':_0x40cdb0(0x11c)+localStorage[_0x40cdb0(0x151)](_0x40cdb0(0x16a))+_0x40cdb0(0x15e)}),_0x446057=await _0x52fa60[_0x40cdb0(0x127)]();if(!_0x446057[_0x40cdb0(0x15d)])return localStorage[_0x40cdb0(0x11f)]('accessToken',_0x446057[_0x40cdb0(0x158)]),await lockNoti(_0x40cdb0(0x161),'',0xbb8),await delay(0x3e8),!![];else alert(_0x446057[_0x40cdb0(0x145)]||_0x40cdb0(0x10f));}catch(_0xc7e1e5){console[_0x40cdb0(0x15d)](_0x40cdb0(0x166),_0xc7e1e5);}return![];}export async function dpUploadFile(_0x416b81,_0x2ba38f,_0xcf0548){var _0x357348=a0_0x1c0c4f;const _0x4c145b=localStorage[_0x357348(0x151)](_0x357348(0x131));var _0x1a1b1d=JSON[_0x357348(0x13b)]({'autorename':!![],'mode':_0x357348(0x14f),'mute':!![],'strict_conflict':![],'path':'/'+_0x4c145b+'/'+_0xcf0548+'/'+_0x416b81}),_0x1b6a45=new Blob([_0x2ba38f],{'type':'application/octet-stream'});for(var _0x1f65c8=0x0;_0x1f65c8<0x2;_0x1f65c8++){var _0xed66ff=await fetch(_0x357348(0x116),{'method':_0x357348(0x146),'headers':{'Authorization':_0x357348(0x135)+localStorage['getItem'](_0x357348(0x144)),'Dropbox-API-Arg':_0x1a1b1d,'Content-Type':_0x357348(0x167)},'body':_0x1b6a45});if(_0xed66ff['status']!=0xc8){if(_0xed66ff['status']==0x191){var _0x27c6fb=await dpRefreshToken();if(!_0x27c6fb)throw _0x357348(0x13d);continue;}else throw _0x357348(0x152)+_0xed66ff['status'];}else{var _0x409ff1=await _0xed66ff['json']();return console['log'](_0x357348(0x133),_0x416b81),_0x409ff1;}}return![];}export async function dpDownloadFile(_0x3c8475,_0x29cd97){var _0x32adf9=a0_0x1c0c4f;const _0x578202=localStorage[_0x32adf9(0x151)](_0x32adf9(0x131));var _0x2311f8=JSON[_0x32adf9(0x13b)]({'path':'/'+_0x578202+'/'+_0x29cd97+'/'+_0x3c8475});for(var _0x5e65fb=0x0;_0x5e65fb<0x2;_0x5e65fb++){var _0xe0a37b=await fetch(_0x32adf9(0x114),{'method':_0x32adf9(0x146),'headers':{'Authorization':_0x32adf9(0x135)+localStorage[_0x32adf9(0x151)](_0x32adf9(0x144)),'Dropbox-API-Arg':_0x2311f8}});if(_0xe0a37b[_0x32adf9(0x138)]!=0xc8){if(_0xe0a37b['status']==0x191){var _0x1ead29=await dpRefreshToken();if(!_0x1ead29)throw _0x32adf9(0x13d);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0xe0a37b[_0x32adf9(0x138)];}const _0x4abea8=new File([await _0xe0a37b[_0x32adf9(0x123)]()],_0x3c8475);return console['log']('Cloud\x20↦\x20Kabu\x20storage\x20◆',_0x4abea8['name']),a0_0x3526c9[_0x32adf9(0x13c)](_0x4abea8,()=>{}),_0x4abea8;}return![];}document[a0_0x1c0c4f(0x132)](a0_0x1c0c4f(0x12d),function(){var _0x25e9ca=a0_0x1c0c4f;dropboxRestore[_0x25e9ca(0x132)](_0x25e9ca(0x147),async function(){var _0x4ad11e=_0x25e9ca;await lockNoti(_0x4ad11e(0x13f),'',0x1388);const _0x3cafc8=localStorage[_0x4ad11e(0x151)](_0x4ad11e(0x131)),_0x4f95fa=[_0x4ad11e(0x10d),'save','screenshot'];if(!_0x3cafc8){window[_0x4ad11e(0x16d)](_0x4ad11e(0x111));return;}let _0x48c8a5=[];for(const _0x5de460 of _0x4f95fa){let _0x157c51={'path':'/'+_0x3cafc8+'/'+_0x5de460};for(let _0x31d4ab=0x0;_0x31d4ab<0x2;_0x31d4ab++){let _0x33d09b=await fetch(_0x4ad11e(0x11a),{'method':_0x4ad11e(0x146),'headers':{'Authorization':_0x4ad11e(0x135)+localStorage[_0x4ad11e(0x151)](_0x4ad11e(0x144)),'Content-Type':'application/json'},'body':JSON[_0x4ad11e(0x13b)](_0x157c51)});if(_0x33d09b[_0x4ad11e(0x138)]===0xc8){let _0x105d10=await _0x33d09b[_0x4ad11e(0x127)](),_0x10ebfb=_0x105d10[_0x4ad11e(0x10c)]['filter'](_0x402761=>_0x402761['.tag']==='file');_0x10ebfb[_0x4ad11e(0x13a)]>0x0&&_0x48c8a5['push'](..._0x10ebfb[_0x4ad11e(0x15b)](_0x587c6f=>({'name':_0x587c6f['name'],'folder':_0x5de460})));break;}else{if(_0x33d09b[_0x4ad11e(0x138)]===0x191){let _0x527d27=await dpRefreshToken();if(!_0x527d27)throw _0x4ad11e(0x13d);}else{console[_0x4ad11e(0x15d)]('Download\x20failed\x20for\x20'+_0x5de460+_0x4ad11e(0x15c)+_0x33d09b[_0x4ad11e(0x138)]);break;}}}}if(_0x48c8a5[_0x4ad11e(0x13a)]>0x0){const _0x5233b0=_0x4ad11e(0x157)+_0x48c8a5[_0x4ad11e(0x13a)]+'\x20files\x20from\x20Cloud?';if(window[_0x4ad11e(0x121)](_0x5233b0))for(const _0x335d7e of _0x48c8a5){await lockNoti(_0x4ad11e(0x141),_0x335d7e[_0x4ad11e(0x113)],0xbb8),await dpDownloadFile(_0x335d7e['name'],_0x335d7e['folder']);}else console[_0x4ad11e(0x12b)](_0x4ad11e(0x16c));}else console[_0x4ad11e(0x12b)](_0x4ad11e(0x169));}),dropboxBackup[_0x25e9ca(0x132)](_0x25e9ca(0x147),async function(){var _0x549faa=_0x25e9ca;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x35a5d0=localStorage[_0x549faa(0x151)](_0x549faa(0x131));if(_0x35a5d0===null||_0x35a5d0==='')window['alert'](_0x549faa(0x111));else{const _0x5c2768=['state',_0x549faa(0x16e),'screenshot'];for(const _0x47ab26 of _0x5c2768){await dpCreateFolder(_0x47ab26);}let _0x5c1852=0x0;for(const _0x5c067e of _0x5c2768){const _0x42e8e2=a0_0x3526c9['list'+(_0x5c067e['charAt'](0x0)[_0x549faa(0x124)]()+_0x5c067e[_0x549faa(0x136)](0x1))]();_0x5c1852+=_0x42e8e2[_0x549faa(0x13a)];}if(window[_0x549faa(0x121)](_0x549faa(0x165)+_0x5c1852+'\x20files\x20in\x20Kabu?'))for(const _0x45cfdc of _0x5c2768){const _0xb31736=a0_0x3526c9[_0x549faa(0x14d)+(_0x45cfdc[_0x549faa(0x134)](0x0)['toUpperCase']()+_0x45cfdc[_0x549faa(0x136)](0x1))]();for(const _0x15913a of _0xb31736){const _0x4f4466=await a0_0x3526c9[_0x549faa(0x126)](_0x549faa(0x140)+_0x45cfdc+'s/'+_0x15913a);try{await lockNoti(_0x549faa(0x11d),_0x15913a,0xbb8),await dpUploadFile(_0x15913a,_0x4f4466,_0x45cfdc);}catch(_0x8f01c4){console[_0x549faa(0x15d)](_0x549faa(0x16b)+_0x15913a+':',_0x8f01c4);}}}else console[_0x549faa(0x12b)](_0x549faa(0x16c));}}),dropboxCloud[_0x25e9ca(0x132)](_0x25e9ca(0x147),function(){var _0x29c4e7=_0x25e9ca;const _0x46371e=localStorage['getItem'](_0x29c4e7(0x131));_0x46371e===null||_0x46371e===''?authorizeWithDropbox():window[_0x29c4e7(0x121)](_0x29c4e7(0x14c))&&(localStorage['setItem']('uId',''),dropboxRestore['classList'][_0x29c4e7(0x154)](_0x29c4e7(0x118)),dropboxBackup[_0x29c4e7(0x14a)][_0x29c4e7(0x154)](_0x29c4e7(0x118)),dropboxCloud[_0x29c4e7(0x14a)][_0x29c4e7(0x154)](_0x29c4e7(0x118)));}),handleDropboxCallback();});