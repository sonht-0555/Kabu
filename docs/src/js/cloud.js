var a0_0x50a308=a0_0x2bda;(function(_0x5dea56,_0x490899){var _0x1558f6=a0_0x2bda,_0xf33d01=_0x5dea56();while(!![]){try{var _0x24ac54=parseInt(_0x1558f6(0x1b1))/0x1*(-parseInt(_0x1558f6(0x204))/0x2)+-parseInt(_0x1558f6(0x1db))/0x3+-parseInt(_0x1558f6(0x1b2))/0x4+-parseInt(_0x1558f6(0x200))/0x5*(-parseInt(_0x1558f6(0x1af))/0x6)+-parseInt(_0x1558f6(0x1b3))/0x7*(parseInt(_0x1558f6(0x1e8))/0x8)+-parseInt(_0x1558f6(0x1dc))/0x9+parseInt(_0x1558f6(0x1fe))/0xa;if(_0x24ac54===_0x490899)break;else _0xf33d01['push'](_0xf33d01['shift']());}catch(_0x514ac0){_0xf33d01['push'](_0xf33d01['shift']());}}}(a0_0x2581,0x5aad5));function a0_0x2bda(_0x3957af,_0x96f0b7){var _0x258118=a0_0x2581();return a0_0x2bda=function(_0x2bdaa5,_0x55d65d){_0x2bdaa5=_0x2bdaa5-0x1a3;var _0x2559c0=_0x258118[_0x2bdaa5];return _0x2559c0;},a0_0x2bda(_0x3957af,_0x96f0b7);}import*as a0_0xc20e7c from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x50a308(0x20b),clientSecret=a0_0x50a308(0x206);function authorizeWithDropbox(){var _0x1f15f9=a0_0x50a308,_0x13616c=window[_0x1f15f9(0x20c)]['href'][_0x1f15f9(0x1e4)]('?')[0x0],_0x2c2c0e=_0x1f15f9(0x1c8),_0x37359a=_0x1f15f9(0x1f8),_0x861c89=_0x1f15f9(0x1c9)+clientId+_0x1f15f9(0x1df)+_0x2c2c0e+'&token_access_type='+_0x37359a+_0x1f15f9(0x1fa)+encodeURIComponent(_0x13616c);window[_0x1f15f9(0x20c)][_0x1f15f9(0x1a9)]=_0x861c89;}function handleDropboxCallback(){var _0xf3ea80=a0_0x50a308,_0xfc35c8=getUrlParameter('code');_0xfc35c8?(getAccessToken(_0xfc35c8),console['log']('Authorization\x20Code:',_0xfc35c8)):console[_0xf3ea80(0x209)](_0xf3ea80(0x1b6));}function getUrlParameter(_0x218650){var _0x30b504=a0_0x50a308;_0x218650=_0x218650[_0x30b504(0x1f6)](/[\[]/,'\x5c[')[_0x30b504(0x1f6)](/[\]]/,'\x5c]');var _0x18c2ad=new RegExp(_0x30b504(0x1c3)+_0x218650+_0x30b504(0x1b8)),_0xb7490=_0x18c2ad[_0x30b504(0x1cf)](location['search']);return _0xb7490===null?'':decodeURIComponent(_0xb7490[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x5f5d1a){var _0x225ee5=a0_0x50a308,_0x155b7a='authorization_code',_0x53c032=window[_0x225ee5(0x20c)][_0x225ee5(0x1a9)][_0x225ee5(0x1e4)]('?')[0x0],_0x21a60f=new XMLHttpRequest();_0x21a60f['open']('POST',_0x225ee5(0x1ab)),_0x21a60f[_0x225ee5(0x20a)](_0x225ee5(0x1d9),'application/x-www-form-urlencoded'),_0x21a60f[_0x225ee5(0x1d7)]=function(){var _0x2aba08=_0x225ee5;if(_0x21a60f[_0x2aba08(0x1c0)]===0xc8){var _0x4cd572=JSON[_0x2aba08(0x1eb)](_0x21a60f[_0x2aba08(0x1dd)]),_0x335e2b=_0x4cd572['access_token'],_0x198d9b=_0x4cd572['refresh_token'],_0x49c0fd=_0x4cd572[_0x2aba08(0x1a5)];localStorage[_0x2aba08(0x203)](_0x2aba08(0x1e9),_0x335e2b),localStorage[_0x2aba08(0x203)](_0x2aba08(0x1de),_0x198d9b),localStorage[_0x2aba08(0x203)](_0x2aba08(0x1b7),_0x49c0fd);}else console['log'](_0x2aba08(0x1aa));},_0x21a60f[_0x225ee5(0x202)]('code='+_0x5f5d1a+_0x225ee5(0x205)+_0x155b7a+_0x225ee5(0x1ae)+clientId+'&client_secret='+clientSecret+_0x225ee5(0x1fa)+encodeURIComponent(_0x53c032));}export async function dpCreateFolder(_0x49888){var _0x200e7d=a0_0x50a308;const _0xa5e5c2=localStorage[_0x200e7d(0x1cd)](_0x200e7d(0x1b7));let _0x535a3e=localStorage[_0x200e7d(0x1cd)](_0x200e7d(0x1e9));const _0x2b0359='/'+_0xa5e5c2+'/'+_0x49888,_0x54bfcf=JSON[_0x200e7d(0x1ed)]({'path':_0x2b0359,'autorename':![]});for(let _0x342504=0x0;_0x342504<0x2;_0x342504++){try{const _0x3bcb5f=await fetch(_0x200e7d(0x1c7),{'method':'POST','headers':{'Authorization':_0x200e7d(0x1d6)+_0x535a3e,'Content-Type':_0x200e7d(0x1f0)},'body':_0x54bfcf});if(_0x3bcb5f[_0x200e7d(0x1c0)]===0x191){const _0x5bb7ab=await dpRefreshToken();if(!_0x5bb7ab)throw new Error(_0x200e7d(0x1ad));_0x535a3e=localStorage[_0x200e7d(0x1cd)](_0x200e7d(0x1e9));continue;}if(_0x3bcb5f[_0x200e7d(0x1c0)]===0x199)return{'message':_0x200e7d(0x1d5),'path':_0x49888};if(!_0x3bcb5f['ok'])throw new Error(_0x200e7d(0x1bc)+_0x49888);const _0x47fa02=await _0x3bcb5f[_0x200e7d(0x208)]();return await lockNoti(_0x200e7d(0x207),'',0xbb8),_0x47fa02;}catch(_0x588ccc){if(_0x342504===0x1)throw _0x588ccc;}}return![];}export async function dpRefreshToken(){var _0x1eb91e=a0_0x50a308;if(!localStorage[_0x1eb91e(0x1cd)]('refreshToken'))throw _0x1eb91e(0x1ce);try{const _0x5c7f3e=await fetch(_0x1eb91e(0x1a4),{'method':_0x1eb91e(0x1a7),'headers':{'Content-Type':_0x1eb91e(0x1ef)},'body':_0x1eb91e(0x1c2)+localStorage['getItem'](_0x1eb91e(0x1de))+_0x1eb91e(0x201)}),_0x53b5d7=await _0x5c7f3e[_0x1eb91e(0x208)]();if(!_0x53b5d7[_0x1eb91e(0x1c1)])return localStorage['setItem']('accessToken',_0x53b5d7[_0x1eb91e(0x1f4)]),await lockNoti(_0x1eb91e(0x1ac),'',0xbb8),await delay(0x3e8),!![];else alert(_0x53b5d7[_0x1eb91e(0x1c6)]||_0x1eb91e(0x1f7));}catch(_0x18a39d){console[_0x1eb91e(0x1c1)]('Error\x20while\x20refreshing\x20token:',_0x18a39d);}return![];}function a0_0x2581(){var _0x5e2ffc=['push','addEventListener','entries','Folder\x20already\x20exists','Bearer\x20','onload','\x20files\x20in\x20Kabu?','Content-Type','Backing\x20up...','1011231cfFLSn','1369008pjgGHd','responseText','refreshToken','&response_type=','No\x20files\x20found\x20to\x20restore.','remove','screenshot','\x20files\x20from\x20Cloud?','split','Kabu\x20storage\x20↦\x20Cloud\x20◆','application/octet-stream','Failed\x20to\x20upload\x20file\x20','17992QYWQRc','accessToken','Restoring...','parse','confirm','stringify','active','application/x-www-form-urlencoded','application/json','/data/','click','https://content.dropboxapi.com/2/files/download','access_token','folder','replace','Failed\x20to\x20refresh\x20Dropbox\x20token.','offline','Restore\x20canceled\x20by\x20user.','&redirect_uri=','length','overwrite','Cloud\x20↦\x20Kabu\x20storage\x20◆','11605360HHLMQt','Download\x20failed\x20for\x20','5gXiiSQ','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','send','setItem','776278uBxJlA','&grant_type=','nwb3dnfh09rhs31','Folder\x20created','json','log','setRequestHeader','knh3uz2mx2hp2eu','location','alert','https://api.dropboxapi.com/oauth2/token','uid','listFiles','POST','downloadFileInCloud','href','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','https://api.dropbox.com/oauth2/token','Refreshing\x20token...','Unable\x20to\x20refresh\x20token','&client_id=','3437142aWpfUI','Do\x20you\x20want\x20to\x20restore\x20','1qYepEv','769128MtlPrr','910GzCgXD','classList','https://content.dropboxapi.com/2/files/upload','Do\x20not\x20receive\x20authorization','uId','=([^&#]*)','Do\x20you\x20want\x20to\x20backup\x20','file','map','Error\x20creating\x20folder\x20','.tag','uploadFileInCloud','Cloud\x20login\x20required!','status','error','refresh_token=','[\x5c?&#]','Wait\x20a\x20little\x20bit...','Upload\x20failed,\x20unknown\x20http\x20status:\x20','error_description','https://api.dropboxapi.com/2/files/create_folder_v2','code','https://www.dropbox.com/oauth2/authorize?client_id=','filter','name','state','getItem','No\x20refresh\x20token','exec','https://api.dropboxapi.com/2/files/list_folder','DOMContentLoaded'];a0_0x2581=function(){return _0x5e2ffc;};return a0_0x2581();}export async function dpUploadFile(_0x366ad3,_0x2da6de,_0x2633a5){var _0x5231d0=a0_0x50a308;const _0x1bee03=localStorage['getItem'](_0x5231d0(0x1b7));var _0x5b5c07=JSON[_0x5231d0(0x1ed)]({'autorename':!![],'mode':_0x5231d0(0x1fc),'mute':!![],'strict_conflict':![],'path':'/'+_0x1bee03+'/'+_0x2633a5+'/'+_0x366ad3}),_0x5370bb=new Blob([_0x2da6de],{'type':_0x5231d0(0x1e6)});for(var _0x45df92=0x0;_0x45df92<0x2;_0x45df92++){var _0x3833de=await fetch(_0x5231d0(0x1b5),{'method':'POST','headers':{'Authorization':_0x5231d0(0x1d6)+localStorage[_0x5231d0(0x1cd)]('accessToken'),'Dropbox-API-Arg':_0x5b5c07,'Content-Type':_0x5231d0(0x1e6)},'body':_0x5370bb});if(_0x3833de[_0x5231d0(0x1c0)]!=0xc8){if(_0x3833de[_0x5231d0(0x1c0)]==0x191){var _0x16ec72=await dpRefreshToken();if(!_0x16ec72)throw _0x5231d0(0x1ad);continue;}else throw _0x5231d0(0x1c5)+_0x3833de[_0x5231d0(0x1c0)];}else{var _0x22cf2b=await _0x3833de[_0x5231d0(0x208)]();return console[_0x5231d0(0x209)](_0x5231d0(0x1e5),_0x366ad3),_0x22cf2b;}}return![];}export async function dpDownloadFile(_0x42c943,_0x36b8f6){var _0x11be2d=a0_0x50a308;const _0xdc2eb0=localStorage[_0x11be2d(0x1cd)](_0x11be2d(0x1b7));var _0x3d7534=JSON[_0x11be2d(0x1ed)]({'path':'/'+_0xdc2eb0+'/'+_0x36b8f6+'/'+_0x42c943});for(var _0x2352d0=0x0;_0x2352d0<0x2;_0x2352d0++){var _0x155da0=await fetch(_0x11be2d(0x1f3),{'method':_0x11be2d(0x1a7),'headers':{'Authorization':_0x11be2d(0x1d6)+localStorage[_0x11be2d(0x1cd)](_0x11be2d(0x1e9)),'Dropbox-API-Arg':_0x3d7534}});if(_0x155da0[_0x11be2d(0x1c0)]!=0xc8){if(_0x155da0[_0x11be2d(0x1c0)]==0x191){var _0x35ffb3=await dpRefreshToken();if(!_0x35ffb3)throw'Unable\x20to\x20refresh\x20token';continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:'+_0x155da0[_0x11be2d(0x1c0)];}const _0x38c514=new File([await _0x155da0['blob']()],_0x42c943);return console[_0x11be2d(0x209)](_0x11be2d(0x1fd),_0x38c514[_0x11be2d(0x1cb)]),a0_0xc20e7c[_0x11be2d(0x1be)](_0x38c514,()=>{}),_0x38c514;}return![];}document[a0_0x50a308(0x1d3)](a0_0x50a308(0x1d1),function(){var _0x28d6e8=a0_0x50a308;dropboxRestore[_0x28d6e8(0x1d3)]('click',async function(){var _0x4722db=_0x28d6e8;await lockNoti(_0x4722db(0x1c4),'',0x1388);const _0x2856e8=localStorage['getItem'](_0x4722db(0x1b7)),_0x1e2a87=['state','save',_0x4722db(0x1e2)];if(!_0x2856e8){window[_0x4722db(0x1a3)]('Cloud\x20login\x20required!');return;}let _0x14a39f=[];for(const _0x24ab1f of _0x1e2a87){let _0x2749d2={'path':'/'+_0x2856e8+'/'+_0x24ab1f};for(let _0x3d947b=0x0;_0x3d947b<0x2;_0x3d947b++){let _0xffa8e8=await fetch(_0x4722db(0x1d0),{'method':_0x4722db(0x1a7),'headers':{'Authorization':_0x4722db(0x1d6)+localStorage[_0x4722db(0x1cd)](_0x4722db(0x1e9)),'Content-Type':_0x4722db(0x1f0)},'body':JSON[_0x4722db(0x1ed)](_0x2749d2)});if(_0xffa8e8[_0x4722db(0x1c0)]===0xc8){let _0x300e53=await _0xffa8e8['json'](),_0x4dabf6=_0x300e53[_0x4722db(0x1d4)][_0x4722db(0x1ca)](_0xfe0f1b=>_0xfe0f1b[_0x4722db(0x1bd)]===_0x4722db(0x1ba));_0x4dabf6[_0x4722db(0x1fb)]>0x0&&_0x14a39f[_0x4722db(0x1d2)](..._0x4dabf6[_0x4722db(0x1bb)](_0x553dc1=>({'name':_0x553dc1[_0x4722db(0x1cb)],'folder':_0x24ab1f})));break;}else{if(_0xffa8e8[_0x4722db(0x1c0)]===0x191){let _0x1b3993=await dpRefreshToken();if(!_0x1b3993)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x4722db(0x1c1)](_0x4722db(0x1ff)+_0x24ab1f+',\x20status:\x20'+_0xffa8e8['status']);break;}}}}if(_0x14a39f[_0x4722db(0x1fb)]>0x0){const _0x1954de=_0x4722db(0x1b0)+_0x14a39f[_0x4722db(0x1fb)]+_0x4722db(0x1e3);if(window[_0x4722db(0x1ec)](_0x1954de))for(const _0x5b9c44 of _0x14a39f){await lockNoti(_0x4722db(0x1ea),_0x5b9c44[_0x4722db(0x1cb)],0xbb8),await dpDownloadFile(_0x5b9c44[_0x4722db(0x1cb)],_0x5b9c44[_0x4722db(0x1f5)]);}else console['log'](_0x4722db(0x1f9));}else console[_0x4722db(0x209)](_0x4722db(0x1e0));}),dropboxBackup[_0x28d6e8(0x1d3)](_0x28d6e8(0x1f2),async function(){var _0x3b5ebc=_0x28d6e8;await lockNoti(_0x3b5ebc(0x1c4),'',0x1388);const _0x53e6c1=localStorage[_0x3b5ebc(0x1cd)](_0x3b5ebc(0x1b7));if(_0x53e6c1===null||_0x53e6c1==='')window[_0x3b5ebc(0x1a3)](_0x3b5ebc(0x1bf));else{const _0x34d5dd=[_0x3b5ebc(0x1cc),'save',_0x3b5ebc(0x1e2)];for(const _0x30d1d0 of _0x34d5dd){await dpCreateFolder(_0x30d1d0);}let _0x29def1=0x0;for(const _0x3c6757 of _0x34d5dd){const _0x3b2ead=a0_0xc20e7c[_0x3b5ebc(0x1a6)](_0x3c6757+'s');_0x29def1+=_0x3b2ead[_0x3b5ebc(0x1fb)];}if(window[_0x3b5ebc(0x1ec)](_0x3b5ebc(0x1b9)+_0x29def1+_0x3b5ebc(0x1d8)))for(const _0x47c1f3 of _0x34d5dd){const _0x4c05e1=a0_0xc20e7c[_0x3b5ebc(0x1a6)](_0x47c1f3+'s');for(const _0x1cd6eb of _0x4c05e1){const _0x489496=await a0_0xc20e7c[_0x3b5ebc(0x1a8)](_0x3b5ebc(0x1f1)+_0x47c1f3+'s/'+_0x1cd6eb);try{await lockNoti(_0x3b5ebc(0x1da),_0x1cd6eb,0xbb8),await dpUploadFile(_0x1cd6eb,_0x489496,_0x47c1f3);}catch(_0x5e73e3){console[_0x3b5ebc(0x1c1)](_0x3b5ebc(0x1e7)+_0x1cd6eb+':',_0x5e73e3);}}}else console[_0x3b5ebc(0x209)](_0x3b5ebc(0x1f9));}}),dropboxCloud[_0x28d6e8(0x1d3)](_0x28d6e8(0x1f2),function(){var _0x2c0c1a=_0x28d6e8;const _0x58889c=localStorage['getItem'](_0x2c0c1a(0x1b7));_0x58889c===null||_0x58889c===''?authorizeWithDropbox():window[_0x2c0c1a(0x1ec)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage['setItem'](_0x2c0c1a(0x1b7),''),dropboxRestore[_0x2c0c1a(0x1b4)][_0x2c0c1a(0x1e1)](_0x2c0c1a(0x1ee)),dropboxBackup[_0x2c0c1a(0x1b4)][_0x2c0c1a(0x1e1)](_0x2c0c1a(0x1ee)),dropboxCloud['classList'][_0x2c0c1a(0x1e1)]('active'));}),handleDropboxCallback();});