function a0_0x5726(){var _0x10a115=['alert','\x20files\x20in\x20Cloud?','.ss6','access_token','href','.ss7','active','status:\x20','https://api.dropboxapi.com/oauth2/token','charAt','&client_id=','nwb3dnfh09rhs31','.tag','No\x20refresh\x20token','application/json','setRequestHeader','name','_imageState','Restore\x20canceled\x20by\x20user.','entries','.gba_dateState','log','&token_access_type=','.gba_imageState','setItem','state','text/plain','[\x5c?&#]','uid','code=','https://www.dropbox.com/oauth2/authorize?client_id=','Do\x20you\x20want\x20to\x20backup\x20','offline','10580880xhPQfw','.ss1','status','.ss5','&grant_type=','POST','blob','responseText','https://content.dropboxapi.com/2/files/download','9099132Pbmlyr','957498CUGcOw','open','endsWith','click','155fTzMRL','https://api.dropboxapi.com/2/files/list_folder','remove','_dateState','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','json','uId','11682XqpXlA','send','Unable\x20to\x20refresh\x20token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','error_description','search','getItem','DOMContentLoaded','Kabu\x20storage\x20↦\x20Cloud\x20◆','stringify','classList','application/octet-stream','replace','filter','Error\x20while\x20refreshing\x20token:','split','3616200leapgx','knh3uz2mx2hp2eu','uploadSaveOrSaveState','Upload\x20failed,\x20unknown\x20http\x20status:\x20','&response_type=','save','Cloud\x20↦\x20Kabu\x20storage\x20◆','100uAkZkP','.txt','refresh_token=','2034mVmCHR','.ss2','/data/','.ss3','Authorization\x20Code:','exec','Download\x20failed,\x20unknown\x20http\x20status:','toUpperCase','FSSync','file','slice','length','location','Failed\x20to\x20refresh\x20Dropbox\x20token.','addEventListener','authorization_code','refresh_token','Backing\x20up...','substring','Bearer\x20','.gba_slot','12264bManvp','confirm','accessToken','text','parse','application/x-www-form-urlencoded','Refreshing\x20token...','list','refreshToken','code','45416WGVydH','Restoring...','Do\x20you\x20want\x20to\x20restore\x20'];a0_0x5726=function(){return _0x10a115;};return a0_0x5726();}function a0_0x44fb(_0x2e9e0c,_0x3eace7){var _0x572684=a0_0x5726();return a0_0x44fb=function(_0x44fbb7,_0x48491f){_0x44fbb7=_0x44fbb7-0x13f;var _0x28d871=_0x572684[_0x44fbb7];return _0x28d871;},a0_0x44fb(_0x2e9e0c,_0x3eace7);}var a0_0x58244b=a0_0x44fb;(function(_0x1d3d5e,_0x5abe64){var _0x334266=a0_0x44fb,_0x3a1e71=_0x1d3d5e();while(!![]){try{var _0x18c0d5=-parseInt(_0x334266(0x178))/0x1+parseInt(_0x334266(0x19a))/0x2*(-parseInt(_0x334266(0x183))/0x3)+parseInt(_0x334266(0x193))/0x4+parseInt(_0x334266(0x17c))/0x5*(-parseInt(_0x334266(0x140))/0x6)+-parseInt(_0x334266(0x177))/0x7+-parseInt(_0x334266(0x14a))/0x8*(-parseInt(_0x334266(0x19d))/0x9)+parseInt(_0x334266(0x16e))/0xa;if(_0x18c0d5===_0x5abe64)break;else _0x3a1e71['push'](_0x3a1e71['shift']());}catch(_0x1b7c2e){_0x3a1e71['push'](_0x3a1e71['shift']());}}}(a0_0x5726,0xb2266));import*as a0_0x4c72f2 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x58244b(0x194),clientSecret=a0_0x58244b(0x158);function authorizeWithDropbox(){var _0x215ae6=a0_0x58244b,_0xd5e97a=window['location'][_0x215ae6(0x151)][_0x215ae6(0x192)]('?')[0x0],_0x2c1518=_0x215ae6(0x149),_0x5bbf9c=_0x215ae6(0x16d),_0x9ca99b=_0x215ae6(0x16b)+clientId+_0x215ae6(0x197)+_0x2c1518+_0x215ae6(0x163)+_0x5bbf9c+'&redirect_uri='+encodeURIComponent(_0xd5e97a);window[_0x215ae6(0x1a9)][_0x215ae6(0x151)]=_0x9ca99b;}function handleDropboxCallback(){var _0x55e654=a0_0x58244b,_0x4129a6=getUrlParameter(_0x55e654(0x149));_0x4129a6?(getAccessToken(_0x4129a6),console['log'](_0x55e654(0x1a1),_0x4129a6)):console[_0x55e654(0x162)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x1f06cc){var _0x1d208b=a0_0x58244b;_0x1f06cc=_0x1f06cc[_0x1d208b(0x18f)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x27e86c=new RegExp(_0x1d208b(0x168)+_0x1f06cc+'=([^&#]*)'),_0x942dbf=_0x27e86c[_0x1d208b(0x1a2)](location[_0x1d208b(0x188)]);return _0x942dbf===null?'':decodeURIComponent(_0x942dbf[0x1][_0x1d208b(0x18f)](/\+/g,'\x20'));}function getAccessToken(_0x3edc10){var _0x1fad59=a0_0x58244b,_0xe28f73=_0x1fad59(0x1ac),_0x37d41d=window[_0x1fad59(0x1a9)][_0x1fad59(0x151)]['split']('?')[0x0],_0x57e65e=new XMLHttpRequest();_0x57e65e[_0x1fad59(0x179)](_0x1fad59(0x173),'https://api.dropbox.com/oauth2/token'),_0x57e65e[_0x1fad59(0x15c)]('Content-Type','application/x-www-form-urlencoded'),_0x57e65e['onload']=function(){var _0x133274=_0x1fad59;if(_0x57e65e[_0x133274(0x170)]===0xc8){var _0x1a66ba=JSON[_0x133274(0x144)](_0x57e65e[_0x133274(0x175)]),_0x5d1340=_0x1a66ba[_0x133274(0x150)],_0x60e924=_0x1a66ba[_0x133274(0x1ad)],_0x19986c=_0x1a66ba[_0x133274(0x169)];localStorage[_0x133274(0x165)](_0x133274(0x142),_0x5d1340),localStorage[_0x133274(0x165)](_0x133274(0x148),_0x60e924),localStorage['setItem'](_0x133274(0x182),_0x19986c);}else console[_0x133274(0x162)](_0x133274(0x180));},_0x57e65e[_0x1fad59(0x184)](_0x1fad59(0x16a)+_0x3edc10+_0x1fad59(0x172)+_0xe28f73+_0x1fad59(0x157)+clientId+'&client_secret='+clientSecret+'&redirect_uri='+encodeURIComponent(_0x37d41d));}export async function dpRefreshToken(){var _0xf583a2=a0_0x58244b;if(!localStorage[_0xf583a2(0x189)]('refreshToken'))throw _0xf583a2(0x15a);try{const _0x3b1d0e=await fetch(_0xf583a2(0x155),{'method':_0xf583a2(0x173),'headers':{'Content-Type':_0xf583a2(0x145)},'body':_0xf583a2(0x19c)+localStorage[_0xf583a2(0x189)](_0xf583a2(0x148))+_0xf583a2(0x186)}),_0x8ae0b9=await _0x3b1d0e['json']();if(!_0x8ae0b9['error'])return localStorage[_0xf583a2(0x165)](_0xf583a2(0x142),_0x8ae0b9['access_token']),await lockNoti('',_0xf583a2(0x146),0xbb8),await delay(0x3e8),!![];else alert(_0x8ae0b9[_0xf583a2(0x187)]||_0xf583a2(0x1aa));}catch(_0x4caf09){console['error'](_0xf583a2(0x191),_0x4caf09);}return![];}export async function dpUploadFile(_0x8887ea,_0x31f169){var _0x402723=a0_0x58244b;const _0x5dc756=localStorage[_0x402723(0x189)](_0x402723(0x182));var _0x31648f=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x5dc756+'/'+_0x8887ea}),_0x3a5874=new Blob([_0x31f169],{'type':_0x402723(0x18e)});for(var _0x496d20=0x0;_0x496d20<0x2;_0x496d20++){var _0x3cc6f5=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':'POST','headers':{'Authorization':_0x402723(0x1b0)+localStorage[_0x402723(0x189)]('accessToken'),'Dropbox-API-Arg':_0x31648f,'Content-Type':'application/octet-stream'},'body':_0x3a5874});if(_0x3cc6f5[_0x402723(0x170)]!=0xc8){if(_0x3cc6f5[_0x402723(0x170)]==0x191){var _0x13583c=await dpRefreshToken();if(!_0x13583c)throw _0x402723(0x185);continue;}else throw _0x402723(0x196)+_0x3cc6f5['status'];}else{var _0xa6fc1=await _0x3cc6f5[_0x402723(0x181)]();return console[_0x402723(0x162)](_0x402723(0x18b),_0x8887ea),_0xa6fc1;}}return![];}async function dpDownloadFile(_0xd9f56b){var _0x3700d9=a0_0x58244b;const _0x2058ff=localStorage['getItem']('uId');var _0x2b88f1=JSON['stringify']({'path':'/'+_0x2058ff+'/'+_0xd9f56b});for(var _0xbf0f39=0x0;_0xbf0f39<0x2;_0xbf0f39++){var _0x5edd90=await fetch(_0x3700d9(0x176),{'method':_0x3700d9(0x173),'headers':{'Authorization':_0x3700d9(0x1b0)+localStorage['getItem'](_0x3700d9(0x142)),'Dropbox-API-Arg':_0x2b88f1}});if(_0x5edd90[_0x3700d9(0x170)]!=0xc8){if(_0x5edd90[_0x3700d9(0x170)]==0x191){var _0x1ecce0=await dpRefreshToken();if(!_0x1ecce0)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x3700d9(0x1a3)+_0x5edd90[_0x3700d9(0x170)];}const _0x244b62=new File([await _0x5edd90[_0x3700d9(0x174)]()],_0xd9f56b);console[_0x3700d9(0x162)](_0x3700d9(0x199),_0x244b62[_0x3700d9(0x15d)]);if(_0xd9f56b[_0x3700d9(0x17a)](_0x3700d9(0x19b))){const _0x2609aa=await _0x244b62[_0x3700d9(0x143)](),[_0x3015bd,_0x4d4ee6]=_0x2609aa[_0x3700d9(0x192)]('\x0a\x0a'),_0x27464a=_0xd9f56b[_0x3700d9(0x1af)](0x0,_0xd9f56b['lastIndexOf']('gba')+0x3),_0x4393e5=_0xd9f56b[_0x3700d9(0x156)](_0xd9f56b[_0x3700d9(0x1a8)]-0x5);localStorage[_0x3700d9(0x165)](_0x27464a+_0x3700d9(0x17f)+_0x4393e5,_0x4d4ee6),localStorage['setItem'](_0x27464a+_0x3700d9(0x15e)+_0x4393e5,_0x3015bd);}else a0_0x4c72f2[_0x3700d9(0x195)](_0x244b62,()=>{var _0x50e097=_0x3700d9;localStorageFile(),Module[_0x50e097(0x1a5)]();});return _0x244b62;}return![];}document['addEventListener'](a0_0x58244b(0x18a),function(){var _0x49e717=a0_0x58244b;dropboxRestore[_0x49e717(0x1ab)](_0x49e717(0x17b),async function(){var _0xb0b084=_0x49e717;const _0x197c29=localStorage[_0xb0b084(0x189)](_0xb0b084(0x182));if(_0x197c29===null||_0x197c29==='')window[_0xb0b084(0x14d)]('Cloud\x20login\x20required!');else{var _0x1b56ca={'path':'/'+_0x197c29};for(var _0x3c96c0=0x0;_0x3c96c0<0x2;_0x3c96c0++){var _0x171ec3=await fetch(_0xb0b084(0x17d),{'method':_0xb0b084(0x173),'headers':{'Authorization':_0xb0b084(0x1b0)+localStorage['getItem'](_0xb0b084(0x142)),'Content-Type':_0xb0b084(0x15b)},'body':JSON[_0xb0b084(0x18c)](_0x1b56ca)});console[_0xb0b084(0x162)](_0xb0b084(0x154),_0x171ec3['status']);if(_0x171ec3[_0xb0b084(0x170)]!=0xc8){if(_0x171ec3['status']==0x191){var _0x514e77=await dpRefreshToken();if(!_0x514e77)throw _0xb0b084(0x185);continue;}else throw'Download\x20failed,\x20unknown\x20http\x20status:\x20'+_0x171ec3[_0xb0b084(0x170)];}else{const _0x511ad9=await _0x171ec3[_0xb0b084(0x181)](),_0x26c347=_0x511ad9[_0xb0b084(0x160)][_0xb0b084(0x190)](_0x10ea74=>_0x10ea74['.tag']==='file')[_0xb0b084(0x1a8)],_0x5e7e9a=_0xb0b084(0x14c)+_0x26c347+_0xb0b084(0x14e);if(window[_0xb0b084(0x141)](_0x5e7e9a))for(const _0x304a93 of _0x511ad9[_0xb0b084(0x160)]){_0x304a93[_0xb0b084(0x159)]===_0xb0b084(0x1a6)&&(await lockNoti(_0xb0b084(0x14b),_0x304a93[_0xb0b084(0x15d)],0xbb8),await dpDownloadFile(_0x304a93['name']));}else console[_0xb0b084(0x162)](_0xb0b084(0x15f));return!![];}}return![];}}),dropboxBackup['addEventListener']('click',async function(){var _0x282a68=_0x49e717;const _0x560848=localStorage[_0x282a68(0x189)](_0x282a68(0x182));if(_0x560848===null||_0x560848==='')window[_0x282a68(0x14d)]('Cloud\x20login\x20required!');else{const _0x425746=[_0x282a68(0x166),_0x282a68(0x198)];let _0x199469=0x0;for(const _0x2b4332 of _0x425746){const _0x1e184c=a0_0x4c72f2[_0x282a68(0x147)+(_0x2b4332[_0x282a68(0x156)](0x0)[_0x282a68(0x1a4)]()+_0x2b4332[_0x282a68(0x1a7)](0x1))]();_0x199469+=_0x1e184c['length'];}if(window['confirm'](_0x282a68(0x16c)+_0x199469+'\x20files\x20in\x20Kabu?'))for(const _0x7696ff of _0x425746){const _0x198177=a0_0x4c72f2[_0x282a68(0x147)+(_0x7696ff['charAt'](0x0)[_0x282a68(0x1a4)]()+_0x7696ff[_0x282a68(0x1a7)](0x1))]();for(const _0x4b6c45 of _0x198177){const _0x5e3406=await a0_0x4c72f2['downloadFileInCloud'](_0x282a68(0x19f)+_0x7696ff+'s/'+_0x4b6c45);try{await lockNoti(_0x282a68(0x1ae),_0x4b6c45,0xbb8),await dpUploadFile(_0x4b6c45,_0x5e3406);if(_0x4b6c45['endsWith']('.ss0')||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x16f))||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x19e))||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x1a0))||_0x4b6c45[_0x282a68(0x17a)]('.ss4')||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x171))||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x14f))||_0x4b6c45[_0x282a68(0x17a)](_0x282a68(0x152))){const _0x1e07ef=_0x4b6c45[_0x282a68(0x1af)](0x0,_0x4b6c45['lastIndexOf']('.')),_0x3acfe2=_0x4b6c45[_0x282a68(0x156)](_0x4b6c45['length']-0x1),_0x1617d9=localStorage[_0x282a68(0x189)](_0x1e07ef+_0x282a68(0x164)+_0x3acfe2),_0x2404df=localStorage[_0x282a68(0x189)](_0x1e07ef+_0x282a68(0x161)+_0x3acfe2);if(_0x1617d9!==null){const _0x46243b=_0x1617d9+'\x0a\x0a'+_0x2404df,_0x467d73=new Blob([_0x46243b],{'type':_0x282a68(0x167)});await lockNoti(_0x282a68(0x1ae),_0x1e07ef+_0x282a68(0x13f)+_0x3acfe2+'.txt',0xbb8),await dpUploadFile(_0x1e07ef+_0x282a68(0x13f)+_0x3acfe2+'.txt',_0x467d73);}}}catch(_0x48a77a){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x4b6c45+':',_0x48a77a);}}}else console[_0x282a68(0x162)](_0x282a68(0x15f));}}),dropboxCloud[_0x49e717(0x1ab)](_0x49e717(0x17b),function(){var _0x1cff3b=_0x49e717;const _0x482489=localStorage['getItem'](_0x1cff3b(0x182));_0x482489===null||_0x482489===''?authorizeWithDropbox():window[_0x1cff3b(0x141)]('Do\x20you\x20want\x20to\x20logout?')&&(localStorage[_0x1cff3b(0x165)](_0x1cff3b(0x182),''),dropboxRestore[_0x1cff3b(0x18d)][_0x1cff3b(0x17e)](_0x1cff3b(0x153)),dropboxBackup[_0x1cff3b(0x18d)][_0x1cff3b(0x17e)](_0x1cff3b(0x153)),dropboxCloud[_0x1cff3b(0x18d)][_0x1cff3b(0x17e)]('active'));}),handleDropboxCallback();});