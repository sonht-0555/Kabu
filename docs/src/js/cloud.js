var a0_0x51bedc=a0_0x3ae4;(function(_0x2d507e,_0x1b4aca){var _0x2cffad=a0_0x3ae4,_0x33f189=_0x2d507e();while(!![]){try{var _0x4f3ab5=parseInt(_0x2cffad(0x195))/0x1+parseInt(_0x2cffad(0x194))/0x2+parseInt(_0x2cffad(0x1e2))/0x3+-parseInt(_0x2cffad(0x1cf))/0x4+-parseInt(_0x2cffad(0x1a5))/0x5*(parseInt(_0x2cffad(0x1ad))/0x6)+-parseInt(_0x2cffad(0x190))/0x7+parseInt(_0x2cffad(0x199))/0x8*(parseInt(_0x2cffad(0x1a3))/0x9);if(_0x4f3ab5===_0x1b4aca)break;else _0x33f189['push'](_0x33f189['shift']());}catch(_0x585ee7){_0x33f189['push'](_0x33f189['shift']());}}}(a0_0x45b4,0xbc8f5));import*as a0_0x78d87d from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x51bedc(0x1c8),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x1d5241=a0_0x51bedc,_0x1a4231=window['location'][_0x1d5241(0x1c6)][_0x1d5241(0x1be)]('?')[0x0],_0x1aff1c=_0x1d5241(0x1b6),_0x591b79=_0x1d5241(0x19b),_0xadaf72='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+'&response_type='+_0x1aff1c+'&token_access_type='+_0x591b79+_0x1d5241(0x1b2)+encodeURIComponent(_0x1a4231);window['location']['href']=_0xadaf72;}function handleDropboxCallback(){var _0x38ba4e=a0_0x51bedc,_0x776cad=getUrlParameter(_0x38ba4e(0x1b6));_0x776cad?(getAccessToken(_0x776cad),console[_0x38ba4e(0x1c7)](_0x38ba4e(0x1ae),_0x776cad)):console['log'](_0x38ba4e(0x1d1));}function getUrlParameter(_0x4fdfa9){var _0x5d8d5d=a0_0x51bedc;_0x4fdfa9=_0x4fdfa9[_0x5d8d5d(0x1da)](/[\[]/,'\x5c[')[_0x5d8d5d(0x1da)](/[\]]/,'\x5c]');var _0x21d516=new RegExp(_0x5d8d5d(0x18c)+_0x4fdfa9+'=([^&#]*)'),_0x5ac961=_0x21d516['exec'](location[_0x5d8d5d(0x1e4)]);return _0x5ac961===null?'':decodeURIComponent(_0x5ac961[0x1]['replace'](/\+/g,'\x20'));}function getAccessToken(_0x34ed08){var _0x5604fe=a0_0x51bedc,_0x59fbec=_0x5604fe(0x192),_0xe34ca5=window[_0x5604fe(0x1b9)][_0x5604fe(0x1c6)][_0x5604fe(0x1be)]('?')[0x0],_0x4423d0=new XMLHttpRequest();_0x4423d0['open']('POST','https://api.dropbox.com/oauth2/token'),_0x4423d0[_0x5604fe(0x193)]('Content-Type',_0x5604fe(0x1af)),_0x4423d0[_0x5604fe(0x1b5)]=function(){var _0x1b82ed=_0x5604fe;if(_0x4423d0[_0x1b82ed(0x1a1)]===0xc8){var _0x5c2653=JSON[_0x1b82ed(0x1ca)](_0x4423d0['responseText']),_0x4539a7=_0x5c2653['access_token'],_0x5960da=_0x5c2653[_0x1b82ed(0x1a4)],_0x285367=_0x5c2653[_0x1b82ed(0x191)];localStorage[_0x1b82ed(0x1bf)](_0x1b82ed(0x19a),_0x4539a7),localStorage[_0x1b82ed(0x1bf)]('refreshToken',_0x5960da),localStorage[_0x1b82ed(0x1bf)](_0x1b82ed(0x197),_0x285367);}else console['log'](_0x1b82ed(0x1d0));},_0x4423d0[_0x5604fe(0x1d7)](_0x5604fe(0x1f1)+_0x34ed08+_0x5604fe(0x1db)+_0x59fbec+'&client_id='+clientId+_0x5604fe(0x1c4)+clientSecret+_0x5604fe(0x1b2)+encodeURIComponent(_0xe34ca5));}export async function dpCreateFolder(_0x4d9644){var _0x91f6dd=a0_0x51bedc;const _0x2c4a38=localStorage[_0x91f6dd(0x1c3)](_0x91f6dd(0x197));let _0x79743=localStorage['getItem'](_0x91f6dd(0x19a));const _0x25e993='/'+_0x2c4a38+'/'+_0x4d9644,_0x3ce722=JSON[_0x91f6dd(0x1d9)]({'path':_0x25e993,'autorename':![]});for(let _0x3356b3=0x0;_0x3356b3<0x2;_0x3356b3++){try{const _0x421ae9=await fetch(_0x91f6dd(0x1a6),{'method':'POST','headers':{'Authorization':_0x91f6dd(0x1c2)+_0x79743,'Content-Type':_0x91f6dd(0x1e5)},'body':_0x3ce722});if(_0x421ae9[_0x91f6dd(0x1a1)]===0x191){const _0x32b6be=await dpRefreshToken();if(!_0x32b6be)throw new Error(_0x91f6dd(0x196));_0x79743=localStorage[_0x91f6dd(0x1c3)](_0x91f6dd(0x19a));continue;}if(_0x421ae9[_0x91f6dd(0x1a1)]===0x199)return{'message':_0x91f6dd(0x1b7),'path':_0x4d9644};if(!_0x421ae9['ok'])throw new Error(_0x91f6dd(0x1b1)+_0x4d9644);const _0x11a06c=await _0x421ae9[_0x91f6dd(0x1b3)]();return await lockNoti(_0x91f6dd(0x1f0),'',0xbb8),_0x11a06c;}catch(_0xa55393){if(_0x3356b3===0x1)throw _0xa55393;}}return![];}export async function dpRefreshToken(){var _0x25c390=a0_0x51bedc;if(!localStorage[_0x25c390(0x1c3)](_0x25c390(0x198)))throw _0x25c390(0x1b8);try{const _0x98e9b1=await fetch(_0x25c390(0x1cd),{'method':_0x25c390(0x1d8),'headers':{'Content-Type':_0x25c390(0x1af)},'body':'refresh_token='+localStorage[_0x25c390(0x1c3)]('refreshToken')+_0x25c390(0x1ce)}),_0x3a7f32=await _0x98e9b1['json']();if(!_0x3a7f32['error'])return localStorage[_0x25c390(0x1bf)](_0x25c390(0x19a),_0x3a7f32[_0x25c390(0x19d)]),await lockNoti(_0x25c390(0x1f5),'',0xbb8),await delay(0x3e8),!![];else alert(_0x3a7f32[_0x25c390(0x1dd)]||_0x25c390(0x1f2));}catch(_0x2901bd){console[_0x25c390(0x1c0)]('Error\x20while\x20refreshing\x20token:',_0x2901bd);}return![];}export async function dpUploadFile(_0x38d6d1,_0x31babf,_0x2c6eef){var _0x2f05b2=a0_0x51bedc;const _0x296890=localStorage[_0x2f05b2(0x1c3)]('uId');var _0x33a35e=JSON[_0x2f05b2(0x1d9)]({'autorename':!![],'mode':_0x2f05b2(0x1e7),'mute':!![],'strict_conflict':![],'path':'/'+_0x296890+'/'+_0x2c6eef+'/'+_0x38d6d1}),_0x2cc675=new Blob([_0x31babf],{'type':_0x2f05b2(0x1ac)});for(var _0x4bbab9=0x0;_0x4bbab9<0x2;_0x4bbab9++){var _0x3d6056=await fetch('https://content.dropboxapi.com/2/files/upload',{'method':_0x2f05b2(0x1d8),'headers':{'Authorization':_0x2f05b2(0x1c2)+localStorage[_0x2f05b2(0x1c3)](_0x2f05b2(0x19a)),'Dropbox-API-Arg':_0x33a35e,'Content-Type':_0x2f05b2(0x1ac)},'body':_0x2cc675});if(_0x3d6056['status']!=0xc8){if(_0x3d6056[_0x2f05b2(0x1a1)]==0x191){var _0x1f90ab=await dpRefreshToken();if(!_0x1f90ab)throw _0x2f05b2(0x196);continue;}else throw _0x2f05b2(0x1d2)+_0x3d6056[_0x2f05b2(0x1a1)];}else{var _0x33a59e=await _0x3d6056[_0x2f05b2(0x1b3)]();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x38d6d1),_0x33a59e;}}return![];}export async function dpDownloadFile(_0x2cfd0a,_0x157bd6){var _0x5e748f=a0_0x51bedc;const _0x46fc06=localStorage[_0x5e748f(0x1c3)](_0x5e748f(0x197));var _0x268e9f=JSON['stringify']({'path':'/'+_0x46fc06+'/'+_0x157bd6+'/'+_0x2cfd0a});for(var _0x5c1312=0x0;_0x5c1312<0x2;_0x5c1312++){var _0x115469=await fetch(_0x5e748f(0x1de),{'method':_0x5e748f(0x1d8),'headers':{'Authorization':_0x5e748f(0x1c2)+localStorage[_0x5e748f(0x1c3)](_0x5e748f(0x19a)),'Dropbox-API-Arg':_0x268e9f}});if(_0x115469[_0x5e748f(0x1a1)]!=0xc8){if(_0x115469[_0x5e748f(0x1a1)]==0x191){var _0x28e5d3=await dpRefreshToken();if(!_0x28e5d3)throw _0x5e748f(0x196);continue;}else throw _0x5e748f(0x1ea)+_0x115469[_0x5e748f(0x1a1)];}const _0x300f3a=new File([await _0x115469[_0x5e748f(0x1c1)]()],_0x2cfd0a);return console['log'](_0x5e748f(0x1cc),_0x300f3a['name']),a0_0x78d87d[_0x5e748f(0x19f)](_0x300f3a,()=>{var _0x1f4c86=_0x5e748f;localStorageFile(),Module[_0x1f4c86(0x1bb)]();}),_0x300f3a;}return![];}function a0_0x45b4(){var _0x493f69=['access_token','\x20files\x20from\x20Cloud?','uploadFileInCloud','list','status','Do\x20you\x20want\x20to\x20backup\x20','234HgVDnO','refresh_token','154045vByXPp','https://api.dropboxapi.com/2/files/create_folder_v2','state','active','classList','folder','Restore\x20canceled\x20by\x20user.','application/octet-stream','108KWxfsY','Authorization\x20Code:','application/x-www-form-urlencoded',',\x20status:\x20','Error\x20creating\x20folder\x20','&redirect_uri=','json','Do\x20you\x20want\x20to\x20logout?','onload','code','Folder\x20already\x20exists','No\x20refresh\x20token','location','confirm','FSSync','Download\x20failed\x20for\x20','Restoring...','split','setItem','error','blob','Bearer\x20','getItem','&client_secret=','Backing\x20up...','href','log','knh3uz2mx2hp2eu','\x20files\x20in\x20Kabu?','parse','Wait\x20a\x20little\x20bit...','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://api.dropboxapi.com/oauth2/token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','3131728wFJsRk','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20not\x20receive\x20authorization','Upload\x20failed,\x20unknown\x20http\x20status:\x20','entries','alert','click','remove','send','POST','stringify','replace','&grant_type=','name','error_description','https://content.dropboxapi.com/2/files/download','DOMContentLoaded','filter','.tag','589095YMUwVA','length','search','application/json','file','overwrite','save','/data/','Download\x20failed,\x20unknown\x20http\x20status:','push','map','charAt','slice','addEventListener','Folder\x20created','code=','Failed\x20to\x20refresh\x20Dropbox\x20token.','Failed\x20to\x20upload\x20file\x20','Cloud\x20login\x20required!','Refreshing\x20token...','[\x5c?&#]','toUpperCase','https://api.dropboxapi.com/2/files/list_folder','No\x20files\x20found\x20to\x20restore.','7489881rGonhW','uid','authorization_code','setRequestHeader','2703716FYlCmG','1462491NKosAq','Unable\x20to\x20refresh\x20token','uId','refreshToken','52032fHbfiN','accessToken','offline','screenshot'];a0_0x45b4=function(){return _0x493f69;};return a0_0x45b4();}function a0_0x3ae4(_0x4c3e68,_0x285ff6){var _0x45b494=a0_0x45b4();return a0_0x3ae4=function(_0x3ae47f,_0x379a54){_0x3ae47f=_0x3ae47f-0x18c;var _0x215608=_0x45b494[_0x3ae47f];return _0x215608;},a0_0x3ae4(_0x4c3e68,_0x285ff6);}document[a0_0x51bedc(0x1ef)](a0_0x51bedc(0x1df),function(){var _0x419eaf=a0_0x51bedc;dropboxRestore[_0x419eaf(0x1ef)](_0x419eaf(0x1d5),async function(){var _0x49b895=_0x419eaf;await lockNoti(_0x49b895(0x1cb),'',0x1388);const _0x44cbee=localStorage[_0x49b895(0x1c3)](_0x49b895(0x197)),_0x323f46=[_0x49b895(0x1a7),_0x49b895(0x1e8),_0x49b895(0x19c)];if(!_0x44cbee){window[_0x49b895(0x1d4)]('Cloud\x20login\x20required!');return;}let _0x57d3f9=[];for(const _0x9a3909 of _0x323f46){let _0x5a599b={'path':'/'+_0x44cbee+'/'+_0x9a3909};for(let _0x449ca2=0x0;_0x449ca2<0x2;_0x449ca2++){let _0x39477a=await fetch(_0x49b895(0x18e),{'method':_0x49b895(0x1d8),'headers':{'Authorization':_0x49b895(0x1c2)+localStorage[_0x49b895(0x1c3)](_0x49b895(0x19a)),'Content-Type':_0x49b895(0x1e5)},'body':JSON[_0x49b895(0x1d9)](_0x5a599b)});if(_0x39477a[_0x49b895(0x1a1)]===0xc8){let _0x28114e=await _0x39477a[_0x49b895(0x1b3)](),_0x31f4ca=_0x28114e[_0x49b895(0x1d3)][_0x49b895(0x1e0)](_0x210443=>_0x210443[_0x49b895(0x1e1)]===_0x49b895(0x1e6));_0x31f4ca['length']>0x0&&_0x57d3f9[_0x49b895(0x1eb)](..._0x31f4ca[_0x49b895(0x1ec)](_0x428c51=>({'name':_0x428c51[_0x49b895(0x1dc)],'folder':_0x9a3909})));break;}else{if(_0x39477a[_0x49b895(0x1a1)]===0x191){let _0x5b7b86=await dpRefreshToken();if(!_0x5b7b86)throw _0x49b895(0x196);}else{console[_0x49b895(0x1c0)](_0x49b895(0x1bc)+_0x9a3909+_0x49b895(0x1b0)+_0x39477a['status']);break;}}}}if(_0x57d3f9[_0x49b895(0x1e3)]>0x0){const _0x5d88a2='Do\x20you\x20want\x20to\x20restore\x20'+_0x57d3f9[_0x49b895(0x1e3)]+_0x49b895(0x19e);if(window['confirm'](_0x5d88a2))for(const _0x4141e7 of _0x57d3f9){await lockNoti(_0x49b895(0x1bd),_0x4141e7[_0x49b895(0x1dc)],0xbb8),await dpDownloadFile(_0x4141e7[_0x49b895(0x1dc)],_0x4141e7[_0x49b895(0x1aa)]);}else console[_0x49b895(0x1c7)]('Restore\x20canceled\x20by\x20user.');}else console['log'](_0x49b895(0x18f));}),dropboxBackup[_0x419eaf(0x1ef)](_0x419eaf(0x1d5),async function(){var _0x1adfc1=_0x419eaf;await lockNoti(_0x1adfc1(0x1cb),'',0x1388);const _0x2b05f9=localStorage[_0x1adfc1(0x1c3)](_0x1adfc1(0x197));if(_0x2b05f9===null||_0x2b05f9==='')window[_0x1adfc1(0x1d4)](_0x1adfc1(0x1f4));else{const _0x23829d=[_0x1adfc1(0x1a7),_0x1adfc1(0x1e8),_0x1adfc1(0x19c)];for(const _0x2cbc40 of _0x23829d){await dpCreateFolder(_0x2cbc40);}let _0x559326=0x0;for(const _0x3905d4 of _0x23829d){const _0x18ce3b=a0_0x78d87d[_0x1adfc1(0x1a0)+(_0x3905d4[_0x1adfc1(0x1ed)](0x0)[_0x1adfc1(0x18d)]()+_0x3905d4[_0x1adfc1(0x1ee)](0x1))]();_0x559326+=_0x18ce3b[_0x1adfc1(0x1e3)];}if(window[_0x1adfc1(0x1ba)](_0x1adfc1(0x1a2)+_0x559326+_0x1adfc1(0x1c9)))for(const _0x35b162 of _0x23829d){const _0x345bfe=a0_0x78d87d['list'+(_0x35b162[_0x1adfc1(0x1ed)](0x0)['toUpperCase']()+_0x35b162['slice'](0x1))]();for(const _0x40cf1d of _0x345bfe){const _0x406042=await a0_0x78d87d['downloadFileInCloud'](_0x1adfc1(0x1e9)+_0x35b162+'s/'+_0x40cf1d);try{await lockNoti(_0x1adfc1(0x1c5),_0x40cf1d,0xbb8),await dpUploadFile(_0x40cf1d,_0x406042,_0x35b162);}catch(_0x44d801){console['error'](_0x1adfc1(0x1f3)+_0x40cf1d+':',_0x44d801);}}}else console[_0x1adfc1(0x1c7)](_0x1adfc1(0x1ab));}}),dropboxCloud[_0x419eaf(0x1ef)](_0x419eaf(0x1d5),function(){var _0x155f84=_0x419eaf;const _0x3c88fb=localStorage[_0x155f84(0x1c3)](_0x155f84(0x197));_0x3c88fb===null||_0x3c88fb===''?authorizeWithDropbox():window[_0x155f84(0x1ba)](_0x155f84(0x1b4))&&(localStorage[_0x155f84(0x1bf)](_0x155f84(0x197),''),dropboxRestore[_0x155f84(0x1a9)][_0x155f84(0x1d6)](_0x155f84(0x1a8)),dropboxBackup[_0x155f84(0x1a9)]['remove'](_0x155f84(0x1a8)),dropboxCloud[_0x155f84(0x1a9)][_0x155f84(0x1d6)]('active'));}),handleDropboxCallback();});