var a0_0x137f9e=a0_0x4ee9;(function(_0xec137d,_0x2dfb55){var _0x11047b=a0_0x4ee9,_0x4cb9df=_0xec137d();while(!![]){try{var _0x1a47d5=parseInt(_0x11047b(0x1ee))/0x1*(parseInt(_0x11047b(0x1ce))/0x2)+-parseInt(_0x11047b(0x210))/0x3+parseInt(_0x11047b(0x1df))/0x4*(-parseInt(_0x11047b(0x1b4))/0x5)+parseInt(_0x11047b(0x1ad))/0x6+-parseInt(_0x11047b(0x1bf))/0x7+-parseInt(_0x11047b(0x1fa))/0x8*(parseInt(_0x11047b(0x20d))/0x9)+parseInt(_0x11047b(0x1f8))/0xa*(parseInt(_0x11047b(0x1c5))/0xb);if(_0x1a47d5===_0x2dfb55)break;else _0x4cb9df['push'](_0x4cb9df['shift']());}catch(_0x58c08e){_0x4cb9df['push'](_0x4cb9df['shift']());}}}(a0_0x4d12,0x8782d));import*as a0_0x1fddd5 from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x137f9e(0x1ed),clientSecret=a0_0x137f9e(0x211);function authorizeWithDropbox(){var _0x2990be=a0_0x137f9e,_0x151c9e=window[_0x2990be(0x1e8)]['href']['split']('?')[0x0],_0x41f1d2=_0x2990be(0x204),_0x4b2279=_0x2990be(0x1ba),_0x350f13='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2990be(0x1bc)+_0x41f1d2+_0x2990be(0x1cf)+_0x4b2279+_0x2990be(0x20f)+encodeURIComponent(_0x151c9e);window[_0x2990be(0x1e8)][_0x2990be(0x1e5)]=_0x350f13;}function handleDropboxCallback(){var _0x1cc2e8=a0_0x137f9e,_0x59fb32=getUrlParameter(_0x1cc2e8(0x204));_0x59fb32?(getAccessToken(_0x59fb32),console['log'](_0x1cc2e8(0x1b0),_0x59fb32)):console[_0x1cc2e8(0x20c)](_0x1cc2e8(0x1b5));}function getUrlParameter(_0x5d3969){var _0x3d84b3=a0_0x137f9e;_0x5d3969=_0x5d3969['replace'](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x17d1be=new RegExp(_0x3d84b3(0x1bd)+_0x5d3969+'=([^&#]*)'),_0xfa7ba2=_0x17d1be[_0x3d84b3(0x20a)](location[_0x3d84b3(0x1cd)]);return _0xfa7ba2===null?'':decodeURIComponent(_0xfa7ba2[0x1][_0x3d84b3(0x1f0)](/\+/g,'\x20'));}function getAccessToken(_0x3baa2a){var _0x249308=a0_0x137f9e,_0x1da9fb=_0x249308(0x1d1),_0x4cfbe0=window[_0x249308(0x1e8)][_0x249308(0x1e5)][_0x249308(0x1dc)]('?')[0x0],_0x2dac2e=new XMLHttpRequest();_0x2dac2e[_0x249308(0x1d9)](_0x249308(0x1f3),_0x249308(0x1fb)),_0x2dac2e['setRequestHeader'](_0x249308(0x1b1),_0x249308(0x1d5)),_0x2dac2e['onload']=function(){var _0x42b96f=_0x249308;if(_0x2dac2e[_0x42b96f(0x1cc)]===0xc8){var _0x22f12b=JSON[_0x42b96f(0x1db)](_0x2dac2e[_0x42b96f(0x209)]),_0xb8d6c1=_0x22f12b[_0x42b96f(0x20e)],_0x784d5a=_0x22f12b[_0x42b96f(0x1fc)],_0x148516=_0x22f12b['uid'];localStorage[_0x42b96f(0x1da)](_0x42b96f(0x212),_0xb8d6c1),localStorage['setItem'](_0x42b96f(0x1c9),_0x784d5a),localStorage['setItem'](_0x42b96f(0x1bb),_0x148516);}else console['log'](_0x42b96f(0x1ac));},_0x2dac2e[_0x249308(0x1d7)]('code='+_0x3baa2a+_0x249308(0x1e4)+_0x1da9fb+_0x249308(0x1dd)+clientId+_0x249308(0x1c6)+clientSecret+_0x249308(0x20f)+encodeURIComponent(_0x4cfbe0));}export async function dpCreateFolder(_0x132efd){var _0x2b583c=a0_0x137f9e;const _0x186290=localStorage[_0x2b583c(0x1c7)](_0x2b583c(0x1bb));let _0x52e37c=localStorage[_0x2b583c(0x1c7)](_0x2b583c(0x212));const _0xa826e6='/'+_0x186290+'/'+_0x132efd,_0x5ea94f=JSON['stringify']({'path':_0xa826e6,'autorename':![]});for(let _0x229f3f=0x0;_0x229f3f<0x2;_0x229f3f++){try{const _0x33a37b=await fetch(_0x2b583c(0x207),{'method':'POST','headers':{'Authorization':_0x2b583c(0x1e0)+_0x52e37c,'Content-Type':_0x2b583c(0x200)},'body':_0x5ea94f});if(_0x33a37b[_0x2b583c(0x1cc)]===0x191){const _0x3fdd7a=await dpRefreshToken();if(!_0x3fdd7a)throw new Error(_0x2b583c(0x206));_0x52e37c=localStorage[_0x2b583c(0x1c7)](_0x2b583c(0x212));continue;}if(_0x33a37b[_0x2b583c(0x1cc)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x132efd};if(!_0x33a37b['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x132efd);const _0x656eeb=await _0x33a37b['json']();return await lockNoti('Folder\x20created','',0xbb8),_0x656eeb;}catch(_0x1d702a){if(_0x229f3f===0x1)throw _0x1d702a;}}return![];}function a0_0x4ee9(_0x2fd521,_0x1b7b3a){var _0x4d12ad=a0_0x4d12();return a0_0x4ee9=function(_0x4ee948,_0x2c8b4c){_0x4ee948=_0x4ee948-0x1ac;var _0x2408bc=_0x4d12ad[_0x4ee948];return _0x2408bc;},a0_0x4ee9(_0x2fd521,_0x1b7b3a);}function a0_0x4d12(){var _0x274d6a=['responseText','exec','DOMContentLoaded','log','3683979gXgQMQ','access_token','&redirect_uri=','2217471lZIqQa','nwb3dnfh09rhs31','accessToken','error','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','4091172yZQgsZ','No\x20files\x20found\x20to\x20restore.','blob','Authorization\x20Code:','Content-Type','folder','Do\x20you\x20want\x20to\x20backup\x20','1835jJKyeL','Do\x20not\x20receive\x20authorization','error_description','Download\x20failed\x20for\x20','click','stringify','offline','uId','&response_type=','[\x5c?&#]','length','7763637hDYPwy','Cloud\x20↦\x20Kabu\x20storage\x20◆','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','entries','https://content.dropboxapi.com/2/files/download','refresh_token=','22jqLHvz','&client_secret=','getItem','Wait\x20a\x20little\x20bit...','refreshToken','addEventListener','Do\x20you\x20want\x20to\x20restore\x20','status','search','882tZeIql','&token_access_type=','Failed\x20to\x20refresh\x20Dropbox\x20token.','authorization_code','https://content.dropboxapi.com/2/files/upload','https://api.dropboxapi.com/2/files/list_folder','\x20files\x20from\x20Cloud?','application/x-www-form-urlencoded','\x20files\x20in\x20Kabu?','send','remove','open','setItem','parse','split','&client_id=','push','600NsBiic','Bearer\x20','confirm','screenshot','downloadFileInCloud','&grant_type=','href','Do\x20you\x20want\x20to\x20logout?','state','location','active','json','Backing\x20up...','save','knh3uz2mx2hp2eu','1149elzIWw','Cloud\x20login\x20required!','replace','name','Restore\x20canceled\x20by\x20user.','POST','listFiles','/data/','application/octet-stream','Download\x20failed,\x20unknown\x20http\x20status:','10442210XERBbh','overwrite','16kLQDFz','https://api.dropbox.com/oauth2/token','refresh_token','file','uploadFileInCloud','classList','application/json','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Kabu\x20storage\x20↦\x20Cloud\x20◆','https://api.dropboxapi.com/oauth2/token','code','alert','Unable\x20to\x20refresh\x20token','https://api.dropboxapi.com/2/files/create_folder_v2','Failed\x20to\x20upload\x20file\x20'];a0_0x4d12=function(){return _0x274d6a;};return a0_0x4d12();}export async function dpRefreshToken(){var _0x468add=a0_0x137f9e;if(!localStorage[_0x468add(0x1c7)](_0x468add(0x1c9)))throw'No\x20refresh\x20token';try{const _0x210dad=await fetch(_0x468add(0x203),{'method':_0x468add(0x1f3),'headers':{'Content-Type':_0x468add(0x1d5)},'body':_0x468add(0x1c4)+localStorage[_0x468add(0x1c7)](_0x468add(0x1c9))+_0x468add(0x1c1)}),_0x52f65b=await _0x210dad['json']();if(!_0x52f65b['error'])return localStorage[_0x468add(0x1da)](_0x468add(0x212),_0x52f65b[_0x468add(0x20e)]),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x52f65b[_0x468add(0x1b6)]||_0x468add(0x1d0));}catch(_0xa81d48){console['error']('Error\x20while\x20refreshing\x20token:',_0xa81d48);}return![];}export async function dpUploadFile(_0x59c59b,_0x556cba,_0x15ef6a){var _0x24607d=a0_0x137f9e;const _0x5da64c=localStorage[_0x24607d(0x1c7)](_0x24607d(0x1bb));var _0x8477fa=JSON[_0x24607d(0x1b9)]({'autorename':!![],'mode':_0x24607d(0x1f9),'mute':!![],'strict_conflict':![],'path':'/'+_0x5da64c+'/'+_0x15ef6a+'/'+_0x59c59b}),_0xce36bb=new Blob([_0x556cba],{'type':_0x24607d(0x1f6)});for(var _0x379601=0x0;_0x379601<0x2;_0x379601++){var _0x4869a8=await fetch(_0x24607d(0x1d2),{'method':_0x24607d(0x1f3),'headers':{'Authorization':_0x24607d(0x1e0)+localStorage[_0x24607d(0x1c7)](_0x24607d(0x212)),'Dropbox-API-Arg':_0x8477fa,'Content-Type':_0x24607d(0x1f6)},'body':_0xce36bb});if(_0x4869a8[_0x24607d(0x1cc)]!=0xc8){if(_0x4869a8[_0x24607d(0x1cc)]==0x191){var _0x48c4d1=await dpRefreshToken();if(!_0x48c4d1)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x24607d(0x201)+_0x4869a8['status'];}else{var _0x4ff0c0=await _0x4869a8[_0x24607d(0x1ea)]();return console[_0x24607d(0x20c)](_0x24607d(0x202),_0x59c59b),_0x4ff0c0;}}return![];}export async function dpDownloadFile(_0x2decb7,_0x219cd3){var _0x25705c=a0_0x137f9e;const _0x5e3726=localStorage['getItem'](_0x25705c(0x1bb));var _0x454dd9=JSON['stringify']({'path':'/'+_0x5e3726+'/'+_0x219cd3+'/'+_0x2decb7});for(var _0x3e27cf=0x0;_0x3e27cf<0x2;_0x3e27cf++){var _0x15eb73=await fetch(_0x25705c(0x1c3),{'method':_0x25705c(0x1f3),'headers':{'Authorization':_0x25705c(0x1e0)+localStorage[_0x25705c(0x1c7)]('accessToken'),'Dropbox-API-Arg':_0x454dd9}});if(_0x15eb73[_0x25705c(0x1cc)]!=0xc8){if(_0x15eb73[_0x25705c(0x1cc)]==0x191){var _0x1099c0=await dpRefreshToken();if(!_0x1099c0)throw _0x25705c(0x206);continue;}else throw _0x25705c(0x1f7)+_0x15eb73[_0x25705c(0x1cc)];}const _0x166229=new File([await _0x15eb73[_0x25705c(0x1af)]()],_0x2decb7);return console[_0x25705c(0x20c)](_0x25705c(0x1c0),_0x166229[_0x25705c(0x1f1)]),a0_0x1fddd5[_0x25705c(0x1fe)](_0x166229,()=>{}),_0x166229;}return![];}document[a0_0x137f9e(0x1ca)](a0_0x137f9e(0x20b),function(){var _0x4a1a49=a0_0x137f9e;dropboxRestore['addEventListener'](_0x4a1a49(0x1b8),async function(){var _0x30a5f7=_0x4a1a49;await lockNoti(_0x30a5f7(0x1c8),'',0x1388);const _0x32b660=localStorage[_0x30a5f7(0x1c7)](_0x30a5f7(0x1bb)),_0x5de103=[_0x30a5f7(0x1e7),_0x30a5f7(0x1ec),_0x30a5f7(0x1e2)];if(!_0x32b660){window[_0x30a5f7(0x205)](_0x30a5f7(0x1ef));return;}let _0x2c0c3c=[];for(const _0x22c215 of _0x5de103){let _0x166ca1={'path':'/'+_0x32b660+'/'+_0x22c215};for(let _0x29fd5e=0x0;_0x29fd5e<0x2;_0x29fd5e++){let _0x58ef5f=await fetch(_0x30a5f7(0x1d3),{'method':_0x30a5f7(0x1f3),'headers':{'Authorization':_0x30a5f7(0x1e0)+localStorage[_0x30a5f7(0x1c7)]('accessToken'),'Content-Type':_0x30a5f7(0x200)},'body':JSON['stringify'](_0x166ca1)});if(_0x58ef5f['status']===0xc8){let _0x2d33ae=await _0x58ef5f[_0x30a5f7(0x1ea)](),_0x21b228=_0x2d33ae[_0x30a5f7(0x1c2)]['filter'](_0x25bbc3=>_0x25bbc3['.tag']===_0x30a5f7(0x1fd));_0x21b228[_0x30a5f7(0x1be)]>0x0&&_0x2c0c3c[_0x30a5f7(0x1de)](..._0x21b228['map'](_0x49e760=>({'name':_0x49e760[_0x30a5f7(0x1f1)],'folder':_0x22c215})));break;}else{if(_0x58ef5f['status']===0x191){let _0xeb0f2=await dpRefreshToken();if(!_0xeb0f2)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x30a5f7(0x213)](_0x30a5f7(0x1b7)+_0x22c215+',\x20status:\x20'+_0x58ef5f['status']);break;}}}}if(_0x2c0c3c[_0x30a5f7(0x1be)]>0x0){const _0x34ec80=_0x30a5f7(0x1cb)+_0x2c0c3c['length']+_0x30a5f7(0x1d4);if(window[_0x30a5f7(0x1e1)](_0x34ec80))for(const _0x332b9e of _0x2c0c3c){await lockNoti('Restoring...',_0x332b9e[_0x30a5f7(0x1f1)],0xbb8),await dpDownloadFile(_0x332b9e[_0x30a5f7(0x1f1)],_0x332b9e[_0x30a5f7(0x1b2)]);}else console[_0x30a5f7(0x20c)](_0x30a5f7(0x1f2));}else console[_0x30a5f7(0x20c)](_0x30a5f7(0x1ae));}),dropboxBackup[_0x4a1a49(0x1ca)](_0x4a1a49(0x1b8),async function(){var _0x21e67d=_0x4a1a49;await lockNoti(_0x21e67d(0x1c8),'',0x1388);const _0x21cf65=localStorage['getItem'](_0x21e67d(0x1bb));if(_0x21cf65===null||_0x21cf65==='')window[_0x21e67d(0x205)](_0x21e67d(0x1ef));else{const _0x3e837d=[_0x21e67d(0x1e7),'save','screenshot'];for(const _0x5bf0b5 of _0x3e837d){await dpCreateFolder(_0x5bf0b5);}let _0x5cd9fd=0x0;for(const _0x13a167 of _0x3e837d){const _0x396111=a0_0x1fddd5[_0x21e67d(0x1f4)](_0x13a167+'s');_0x5cd9fd+=_0x396111[_0x21e67d(0x1be)];}if(window[_0x21e67d(0x1e1)](_0x21e67d(0x1b3)+_0x5cd9fd+_0x21e67d(0x1d6)))for(const _0x34cbb0 of _0x3e837d){const _0x185a80=a0_0x1fddd5['listFiles'](_0x34cbb0+'s');for(const _0x37faa6 of _0x185a80){const _0xc5ced8=await a0_0x1fddd5[_0x21e67d(0x1e3)](_0x21e67d(0x1f5)+_0x34cbb0+'s/'+_0x37faa6);try{await lockNoti(_0x21e67d(0x1eb),_0x37faa6,0xbb8),await dpUploadFile(_0x37faa6,_0xc5ced8,_0x34cbb0);}catch(_0x306aaa){console[_0x21e67d(0x213)](_0x21e67d(0x208)+_0x37faa6+':',_0x306aaa);}}}else console[_0x21e67d(0x20c)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x4a1a49(0x1ca)](_0x4a1a49(0x1b8),function(){var _0x15b230=_0x4a1a49;const _0x53b6ed=localStorage[_0x15b230(0x1c7)](_0x15b230(0x1bb));_0x53b6ed===null||_0x53b6ed===''?authorizeWithDropbox():window[_0x15b230(0x1e1)](_0x15b230(0x1e6))&&(localStorage['setItem'](_0x15b230(0x1bb),''),dropboxRestore[_0x15b230(0x1ff)][_0x15b230(0x1d8)](_0x15b230(0x1e9)),dropboxBackup['classList'][_0x15b230(0x1d8)]('active'),dropboxCloud[_0x15b230(0x1ff)]['remove'](_0x15b230(0x1e9)));}),handleDropboxCallback();});