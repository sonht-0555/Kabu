var a0_0x300100=a0_0x4f37;(function(_0xfe3a58,_0x32296b){var _0x537fc7=a0_0x4f37,_0x4c6629=_0xfe3a58();while(!![]){try{var _0x2d5d4a=-parseInt(_0x537fc7(0xe1))/0x1*(-parseInt(_0x537fc7(0xb7))/0x2)+parseInt(_0x537fc7(0xbd))/0x3*(parseInt(_0x537fc7(0xe9))/0x4)+parseInt(_0x537fc7(0xab))/0x5*(-parseInt(_0x537fc7(0xc4))/0x6)+-parseInt(_0x537fc7(0xf3))/0x7*(parseInt(_0x537fc7(0xfc))/0x8)+parseInt(_0x537fc7(0xd8))/0x9*(-parseInt(_0x537fc7(0xd6))/0xa)+parseInt(_0x537fc7(0xf1))/0xb*(parseInt(_0x537fc7(0xbb))/0xc)+parseInt(_0x537fc7(0xb3))/0xd*(-parseInt(_0x537fc7(0x10d))/0xe);if(_0x2d5d4a===_0x32296b)break;else _0x4c6629['push'](_0x4c6629['shift']());}catch(_0x4375df){_0x4c6629['push'](_0x4c6629['shift']());}}}(a0_0x3ad1,0x32bed));import*as a0_0x3d728d from'./main.js';function a0_0x4f37(_0x4e0c67,_0xa09116){var _0x3ad122=a0_0x3ad1();return a0_0x4f37=function(_0x4f3747,_0x3f5eed){_0x4f3747=_0x4f3747-0x9e;var _0x277233=_0x3ad122[_0x4f3747];return _0x277233;},a0_0x4f37(_0x4e0c67,_0xa09116);}import{localStorageFile}from'./storage.js';var clientId=a0_0x300100(0x105),clientSecret=a0_0x300100(0xd1);function authorizeWithDropbox(){var _0x27f0a2=a0_0x300100,_0xa05143=window[_0x27f0a2(0xac)]['href'][_0x27f0a2(0xa0)]('?')[0x0],_0x4a30e4='code',_0x261076=_0x27f0a2(0xfa),_0x49067c=_0x27f0a2(0xcb)+clientId+_0x27f0a2(0xdd)+_0x4a30e4+_0x27f0a2(0xb8)+_0x261076+'&redirect_uri='+encodeURIComponent(_0xa05143);window[_0x27f0a2(0xac)][_0x27f0a2(0xb6)]=_0x49067c;}function handleDropboxCallback(){var _0x8b6598=a0_0x300100,_0x117c9c=getUrlParameter(_0x8b6598(0x102));_0x117c9c?(getAccessToken(_0x117c9c),console[_0x8b6598(0x103)](_0x8b6598(0xbe),_0x117c9c)):console[_0x8b6598(0x103)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x355cf1){var _0x35323c=a0_0x300100;_0x355cf1=_0x355cf1[_0x35323c(0xba)](/[\[]/,'\x5c[')[_0x35323c(0xba)](/[\]]/,'\x5c]');var _0x33df2c=new RegExp(_0x35323c(0xa8)+_0x355cf1+_0x35323c(0xe5)),_0x3f9531=_0x33df2c['exec'](location['search']);return _0x3f9531===null?'':decodeURIComponent(_0x3f9531[0x1][_0x35323c(0xba)](/\+/g,'\x20'));}function getAccessToken(_0x3b4b07){var _0x158c75=a0_0x300100,_0x542a9c=_0x158c75(0xe0),_0x86e027=window[_0x158c75(0xac)][_0x158c75(0xb6)][_0x158c75(0xa0)]('?')[0x0],_0x12093b=new XMLHttpRequest();_0x12093b[_0x158c75(0xc1)](_0x158c75(0xa1),_0x158c75(0xf4)),_0x12093b[_0x158c75(0xad)](_0x158c75(0x10f),_0x158c75(0x104)),_0x12093b[_0x158c75(0x101)]=function(){var _0x17a756=_0x158c75;if(_0x12093b['status']===0xc8){var _0x2fa368=JSON[_0x17a756(0xc5)](_0x12093b['responseText']),_0x409cf2=_0x2fa368[_0x17a756(0xee)],_0x15c061=_0x2fa368[_0x17a756(0x10a)],_0x4b93ae=_0x2fa368[_0x17a756(0xe4)];localStorage[_0x17a756(0xb2)](_0x17a756(0xe3),_0x409cf2),localStorage[_0x17a756(0xb2)](_0x17a756(0xcd),_0x15c061),localStorage[_0x17a756(0xb2)](_0x17a756(0xfb),_0x4b93ae);}else console['log'](_0x17a756(0xc9));},_0x12093b[_0x158c75(0xa2)](_0x158c75(0xed)+_0x3b4b07+_0x158c75(0xa3)+_0x542a9c+_0x158c75(0xd4)+clientId+_0x158c75(0xd7)+clientSecret+_0x158c75(0xc7)+encodeURIComponent(_0x86e027));}export async function dpCreateFolder(_0x47af7e){var _0x463cbf=a0_0x300100;const _0x335ff3=localStorage[_0x463cbf(0xf5)]('uId');let _0x2602e1=localStorage[_0x463cbf(0xf5)](_0x463cbf(0xe3));const _0x333d0a='/'+_0x335ff3+'/'+_0x47af7e,_0x14d9c4=JSON[_0x463cbf(0x100)]({'path':_0x333d0a,'autorename':![]});for(let _0x1c3609=0x0;_0x1c3609<0x2;_0x1c3609++){try{const _0x3a736a=await fetch(_0x463cbf(0xf0),{'method':_0x463cbf(0xa1),'headers':{'Authorization':'Bearer\x20'+_0x2602e1,'Content-Type':_0x463cbf(0xb4)},'body':_0x14d9c4});if(_0x3a736a[_0x463cbf(0xa9)]===0x191){const _0x1a7757=await dpRefreshToken();if(!_0x1a7757)throw new Error(_0x463cbf(0xf8));_0x2602e1=localStorage['getItem'](_0x463cbf(0xe3));continue;}if(_0x3a736a['status']===0x199)return{'message':_0x463cbf(0x10c),'path':_0x47af7e};if(!_0x3a736a['ok'])throw new Error(_0x463cbf(0xec)+_0x47af7e);const _0x2d99f3=await _0x3a736a[_0x463cbf(0xdc)]();return await lockNoti(_0x463cbf(0xca),'',0xbb8),_0x2d99f3;}catch(_0x5ccba9){if(_0x1c3609===0x1)throw _0x5ccba9;}}return![];}function a0_0x3ad1(){var _0x578aee=['POST','send','&grant_type=','Cloud\x20login\x20required!','charAt','https://api.dropboxapi.com/oauth2/token','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','[\x5c?&#]','status','DOMContentLoaded','17045dPthed','location','setRequestHeader','\x20files\x20from\x20Cloud?','No\x20files\x20found\x20to\x20restore.','map','\x20files\x20in\x20Kabu?','setItem','637BPxNTU','application/json','error','href','10934FmYMjM','&token_access_type=','Do\x20you\x20want\x20to\x20backup\x20','replace','63432tmhJSh','downloadFileInCloud','6EVOfcm','Authorization\x20Code:','uploadFileInCloud','Restoring...','open','push','Bearer\x20','276sNuvCw','parse','screenshot','&redirect_uri=','addEventListener','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Folder\x20created','https://www.dropbox.com/oauth2/authorize?client_id=','Error\x20while\x20refreshing\x20token:','refreshToken','click','https://api.dropboxapi.com/2/files/list_folder','state','nwb3dnfh09rhs31','active','overwrite','&client_id=','.tag','157370VEQnrQ','&client_secret=','135tdAkiJ','blob','Upload\x20failed,\x20unknown\x20http\x20status:\x20','filter','json','&response_type=','alert','error_description','authorization_code','74IphOpe','Failed\x20to\x20upload\x20file\x20','accessToken','uid','=([^&#]*)','list','toUpperCase','entries','545372NgAurK','Restore\x20canceled\x20by\x20user.','Do\x20you\x20want\x20to\x20logout?','Error\x20creating\x20folder\x20','code=','access_token','FSSync','https://api.dropboxapi.com/2/files/create_folder_v2','121BJddlB','remove','189HJVmDa','https://api.dropbox.com/oauth2/token','getItem','Download\x20failed,\x20unknown\x20http\x20status:','name','Unable\x20to\x20refresh\x20token','slice','offline','uId','2952yJAoAr','confirm','length','Do\x20you\x20want\x20to\x20restore\x20','stringify','onload','code','log','application/x-www-form-urlencoded','knh3uz2mx2hp2eu','application/octet-stream','Download\x20failed\x20for\x20','https://content.dropboxapi.com/2/files/upload','classList','refresh_token','/data/','Folder\x20already\x20exists','35630XosSpm','Failed\x20to\x20refresh\x20Dropbox\x20token.','Content-Type','No\x20refresh\x20token','save','Cloud\x20↦\x20Kabu\x20storage\x20◆','Wait\x20a\x20little\x20bit...','split'];a0_0x3ad1=function(){return _0x578aee;};return a0_0x3ad1();}export async function dpRefreshToken(){var _0x56144c=a0_0x300100;if(!localStorage['getItem'](_0x56144c(0xcd)))throw _0x56144c(0x110);try{const _0x5364ad=await fetch(_0x56144c(0xa6),{'method':'POST','headers':{'Content-Type':_0x56144c(0x104)},'body':'refresh_token='+localStorage['getItem'](_0x56144c(0xcd))+_0x56144c(0xa7)}),_0x22e882=await _0x5364ad[_0x56144c(0xdc)]();if(!_0x22e882['error'])return localStorage[_0x56144c(0xb2)](_0x56144c(0xe3),_0x22e882['access_token']),await lockNoti('Refreshing\x20token...','',0xbb8),await delay(0x3e8),!![];else alert(_0x22e882[_0x56144c(0xdf)]||_0x56144c(0x10e));}catch(_0xfad12e){console[_0x56144c(0xb5)](_0x56144c(0xcc),_0xfad12e);}return![];}export async function dpUploadFile(_0x512147,_0x2b9ece,_0x50062b){var _0x51c174=a0_0x300100;const _0x5abac0=localStorage[_0x51c174(0xf5)](_0x51c174(0xfb));var _0x1f7e2a=JSON['stringify']({'autorename':!![],'mode':_0x51c174(0xd3),'mute':!![],'strict_conflict':![],'path':'/'+_0x5abac0+'/'+_0x50062b+'/'+_0x512147}),_0x41da24=new Blob([_0x2b9ece],{'type':_0x51c174(0x106)});for(var _0x30df64=0x0;_0x30df64<0x2;_0x30df64++){var _0x4f1dfc=await fetch(_0x51c174(0x108),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x51c174(0xe3)),'Dropbox-API-Arg':_0x1f7e2a,'Content-Type':_0x51c174(0x106)},'body':_0x41da24});if(_0x4f1dfc[_0x51c174(0xa9)]!=0xc8){if(_0x4f1dfc[_0x51c174(0xa9)]==0x191){var _0x32500b=await dpRefreshToken();if(!_0x32500b)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x51c174(0xda)+_0x4f1dfc[_0x51c174(0xa9)];}else{var _0x513b24=await _0x4f1dfc['json']();return console['log']('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x512147),_0x513b24;}}return![];}export async function dpDownloadFile(_0x3723f6,_0x2e71dd){var _0x2ab808=a0_0x300100;const _0x1be095=localStorage[_0x2ab808(0xf5)](_0x2ab808(0xfb));var _0x56a529=JSON['stringify']({'path':'/'+_0x1be095+'/'+_0x2e71dd+'/'+_0x3723f6});for(var _0x22baf4=0x0;_0x22baf4<0x2;_0x22baf4++){var _0x5af37b=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x2ab808(0xa1),'headers':{'Authorization':'Bearer\x20'+localStorage['getItem'](_0x2ab808(0xe3)),'Dropbox-API-Arg':_0x56a529}});if(_0x5af37b['status']!=0xc8){if(_0x5af37b['status']==0x191){var _0x4b949d=await dpRefreshToken();if(!_0x4b949d)throw _0x2ab808(0xf8);continue;}else throw _0x2ab808(0xf6)+_0x5af37b[_0x2ab808(0xa9)];}const _0x4af29b=new File([await _0x5af37b[_0x2ab808(0xd9)]()],_0x3723f6);return console[_0x2ab808(0x103)](_0x2ab808(0x9e),_0x4af29b[_0x2ab808(0xf7)]),a0_0x3d728d[_0x2ab808(0xbf)](_0x4af29b,()=>{var _0x1eebe2=_0x2ab808;localStorageFile(),Module[_0x1eebe2(0xef)]();}),_0x4af29b;}return![];}document[a0_0x300100(0xc8)](a0_0x300100(0xaa),function(){var _0x41c134=a0_0x300100;dropboxRestore[_0x41c134(0xc8)](_0x41c134(0xce),async function(){var _0x2015b6=_0x41c134;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0xbd18d4=localStorage['getItem']('uId'),_0x467ce4=[_0x2015b6(0xd0),'save',_0x2015b6(0xc6)];if(!_0xbd18d4){window[_0x2015b6(0xde)](_0x2015b6(0xa4));return;}let _0x325d0c=[];for(const _0x267b7f of _0x467ce4){let _0x34ebf5={'path':'/'+_0xbd18d4+'/'+_0x267b7f};for(let _0x207c84=0x0;_0x207c84<0x2;_0x207c84++){let _0x31e528=await fetch(_0x2015b6(0xcf),{'method':'POST','headers':{'Authorization':_0x2015b6(0xc3)+localStorage[_0x2015b6(0xf5)](_0x2015b6(0xe3)),'Content-Type':_0x2015b6(0xb4)},'body':JSON['stringify'](_0x34ebf5)});if(_0x31e528[_0x2015b6(0xa9)]===0xc8){let _0x4bfa19=await _0x31e528['json'](),_0x289225=_0x4bfa19[_0x2015b6(0xe8)][_0x2015b6(0xdb)](_0x1c1fc3=>_0x1c1fc3[_0x2015b6(0xd5)]==='file');_0x289225[_0x2015b6(0xfe)]>0x0&&_0x325d0c[_0x2015b6(0xc2)](..._0x289225[_0x2015b6(0xb0)](_0x71899c=>({'name':_0x71899c[_0x2015b6(0xf7)],'folder':_0x267b7f})));break;}else{if(_0x31e528['status']===0x191){let _0x4ebf22=await dpRefreshToken();if(!_0x4ebf22)throw _0x2015b6(0xf8);}else{console[_0x2015b6(0xb5)](_0x2015b6(0x107)+_0x267b7f+',\x20status:\x20'+_0x31e528[_0x2015b6(0xa9)]);break;}}}}if(_0x325d0c[_0x2015b6(0xfe)]>0x0){const _0x43fa13=_0x2015b6(0xff)+_0x325d0c[_0x2015b6(0xfe)]+_0x2015b6(0xae);if(window[_0x2015b6(0xfd)](_0x43fa13))for(const _0x4f6801 of _0x325d0c){await lockNoti(_0x2015b6(0xc0),_0x4f6801[_0x2015b6(0xf7)],0xbb8),await dpDownloadFile(_0x4f6801[_0x2015b6(0xf7)],_0x4f6801['folder']);}else console['log'](_0x2015b6(0xea));}else console[_0x2015b6(0x103)](_0x2015b6(0xaf));}),dropboxBackup['addEventListener']('click',async function(){var _0x5eb05c=_0x41c134;await lockNoti(_0x5eb05c(0x9f),'',0x1388);const _0x2e2ef3=localStorage[_0x5eb05c(0xf5)](_0x5eb05c(0xfb));if(_0x2e2ef3===null||_0x2e2ef3==='')window[_0x5eb05c(0xde)](_0x5eb05c(0xa4));else{const _0x28eb4e=[_0x5eb05c(0xd0),_0x5eb05c(0x111),'screenshot'];for(const _0x247255 of _0x28eb4e){await dpCreateFolder(_0x247255);}let _0x12fab2=0x0;for(const _0x597e97 of _0x28eb4e){const _0x2b3ff6=a0_0x3d728d[_0x5eb05c(0xe6)+(_0x597e97[_0x5eb05c(0xa5)](0x0)[_0x5eb05c(0xe7)]()+_0x597e97[_0x5eb05c(0xf9)](0x1))]();_0x12fab2+=_0x2b3ff6['length'];}if(window[_0x5eb05c(0xfd)](_0x5eb05c(0xb9)+_0x12fab2+_0x5eb05c(0xb1)))for(const _0x5f0a61 of _0x28eb4e){const _0x586ef4=a0_0x3d728d[_0x5eb05c(0xe6)+(_0x5f0a61['charAt'](0x0)[_0x5eb05c(0xe7)]()+_0x5f0a61[_0x5eb05c(0xf9)](0x1))]();for(const _0x286ee0 of _0x586ef4){const _0x3aca09=await a0_0x3d728d[_0x5eb05c(0xbc)](_0x5eb05c(0x10b)+_0x5f0a61+'s/'+_0x286ee0);try{await lockNoti('Backing\x20up...',_0x286ee0,0xbb8),await dpUploadFile(_0x286ee0,_0x3aca09,_0x5f0a61);}catch(_0x522dbc){console[_0x5eb05c(0xb5)](_0x5eb05c(0xe2)+_0x286ee0+':',_0x522dbc);}}}else console[_0x5eb05c(0x103)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud['addEventListener'](_0x41c134(0xce),function(){var _0x2122dd=_0x41c134;const _0x360261=localStorage[_0x2122dd(0xf5)](_0x2122dd(0xfb));_0x360261===null||_0x360261===''?authorizeWithDropbox():window['confirm'](_0x2122dd(0xeb))&&(localStorage[_0x2122dd(0xb2)]('uId',''),dropboxRestore[_0x2122dd(0x109)][_0x2122dd(0xf2)](_0x2122dd(0xd2)),dropboxBackup[_0x2122dd(0x109)][_0x2122dd(0xf2)]('active'),dropboxCloud[_0x2122dd(0x109)][_0x2122dd(0xf2)](_0x2122dd(0xd2)));}),handleDropboxCallback();});