var a0_0x35508e=a0_0x3b04;(function(_0x2599a5,_0x232bbb){var _0x4f2f88=a0_0x3b04,_0xb42365=_0x2599a5();while(!![]){try{var _0x5b8b2a=-parseInt(_0x4f2f88(0x19b))/0x1*(parseInt(_0x4f2f88(0x194))/0x2)+parseInt(_0x4f2f88(0x1ce))/0x3+-parseInt(_0x4f2f88(0x1b2))/0x4*(parseInt(_0x4f2f88(0x1ac))/0x5)+-parseInt(_0x4f2f88(0x1e5))/0x6*(-parseInt(_0x4f2f88(0x1c1))/0x7)+-parseInt(_0x4f2f88(0x18b))/0x8*(parseInt(_0x4f2f88(0x1c5))/0x9)+parseInt(_0x4f2f88(0x1e9))/0xa+parseInt(_0x4f2f88(0x1da))/0xb;if(_0x5b8b2a===_0x232bbb)break;else _0xb42365['push'](_0xb42365['shift']());}catch(_0x483f6c){_0xb42365['push'](_0xb42365['shift']());}}}(a0_0x5c3f,0xded44));import*as a0_0x299c84 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x5c3f(){var _0x30d8f9=['DOMContentLoaded','replace','open','Error\x20while\x20refreshing\x20token:','application/x-www-form-urlencoded','20917039BBVlPG','accessToken','https://content.dropboxapi.com/2/files/upload','classList','Bearer\x20','\x20files\x20in\x20Kabu?','code=','POST','responseText','getItem','click','167166HGaTBc','file','Error\x20creating\x20folder\x20','length','15041420thvana','Do\x20you\x20want\x20to\x20logout?','https://www.dropbox.com/oauth2/authorize?client_id=','stringify','Content-Type','setItem','&response_type=','refreshToken','6104tZmPDe','error_description','Cloud\x20↦\x20Kabu\x20storage\x20◆','\x20files\x20from\x20Cloud?','alert','application/json','[\x5c?&#]','filter','confirm','3510118POrSCR','json','Backing\x20up...','https://api.dropbox.com/oauth2/token','remove','state','offline','1OUedAZ','Refreshing\x20token...','name','addEventListener','error','access_token','/data/','log','blob','application/octet-stream','nwb3dnfh09rhs31','&client_id=','listFiles','=([^&#]*)','map','Folder\x20already\x20exists','https://api.dropboxapi.com/oauth2/token','1408270xDpnJQ','code','status','location','href','search','12vlqnSG','Do\x20you\x20want\x20to\x20restore\x20','Failed\x20to\x20upload\x20file\x20','Do\x20not\x20receive\x20authorization','Restore\x20canceled\x20by\x20user.','Download\x20failed,\x20unknown\x20http\x20status:','&redirect_uri=','uploadFileInCloud','active','Folder\x20created','split','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','screenshot','&grant_type=','&client_secret=','112ymVCws','https://api.dropboxapi.com/2/files/create_folder_v2','setRequestHeader','push','14913gwdnkc','Cloud\x20login\x20required!','https://content.dropboxapi.com/2/files/download','authorization_code','&token_access_type=','Unable\x20to\x20refresh\x20token','save','onload','exec','2776659laDUlA','Download\x20failed\x20for\x20','uid','refresh_token=','uId','Wait\x20a\x20little\x20bit...','overwrite'];a0_0x5c3f=function(){return _0x30d8f9;};return a0_0x5c3f();}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x35508e(0x1a5);function authorizeWithDropbox(){var _0x376d81=a0_0x35508e,_0x53f264=window[_0x376d81(0x1af)][_0x376d81(0x1b0)][_0x376d81(0x1bc)]('?')[0x0],_0x4936fa=_0x376d81(0x1ad),_0x3b165e=_0x376d81(0x19a),_0xab9aa4=_0x376d81(0x1eb)+clientId+_0x376d81(0x189)+_0x4936fa+_0x376d81(0x1c9)+_0x3b165e+_0x376d81(0x1b8)+encodeURIComponent(_0x53f264);window[_0x376d81(0x1af)][_0x376d81(0x1b0)]=_0xab9aa4;}function handleDropboxCallback(){var _0x31000c=a0_0x35508e,_0x339f57=getUrlParameter(_0x31000c(0x1ad));_0x339f57?(getAccessToken(_0x339f57),console[_0x31000c(0x1a2)]('Authorization\x20Code:',_0x339f57)):console[_0x31000c(0x1a2)](_0x31000c(0x1b5));}function getUrlParameter(_0x4dc69c){var _0x1406a7=a0_0x35508e;_0x4dc69c=_0x4dc69c[_0x1406a7(0x1d6)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2113cb=new RegExp(_0x1406a7(0x191)+_0x4dc69c+_0x1406a7(0x1a8)),_0x3a7aad=_0x2113cb[_0x1406a7(0x1cd)](location[_0x1406a7(0x1b1)]);return _0x3a7aad===null?'':decodeURIComponent(_0x3a7aad[0x1][_0x1406a7(0x1d6)](/\+/g,'\x20'));}function getAccessToken(_0x52bdf6){var _0x3f7aac=a0_0x35508e,_0x17793a=_0x3f7aac(0x1c8),_0x473acd=window[_0x3f7aac(0x1af)][_0x3f7aac(0x1b0)][_0x3f7aac(0x1bc)]('?')[0x0],_0x27031f=new XMLHttpRequest();_0x27031f[_0x3f7aac(0x1d7)](_0x3f7aac(0x1e1),_0x3f7aac(0x197)),_0x27031f[_0x3f7aac(0x1c3)](_0x3f7aac(0x187),'application/x-www-form-urlencoded'),_0x27031f[_0x3f7aac(0x1cc)]=function(){var _0x4f5a53=_0x3f7aac;if(_0x27031f[_0x4f5a53(0x1ae)]===0xc8){var _0x1f2d7d=JSON['parse'](_0x27031f[_0x4f5a53(0x1e2)]),_0x2340b5=_0x1f2d7d[_0x4f5a53(0x1a0)],_0x2c9e98=_0x1f2d7d['refresh_token'],_0x42af37=_0x1f2d7d[_0x4f5a53(0x1d0)];localStorage[_0x4f5a53(0x188)](_0x4f5a53(0x1db),_0x2340b5),localStorage['setItem'](_0x4f5a53(0x18a),_0x2c9e98),localStorage[_0x4f5a53(0x188)](_0x4f5a53(0x1d2),_0x42af37);}else console[_0x4f5a53(0x1a2)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x27031f['send'](_0x3f7aac(0x1e0)+_0x52bdf6+_0x3f7aac(0x1bf)+_0x17793a+_0x3f7aac(0x1a6)+clientId+_0x3f7aac(0x1c0)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x473acd));}function a0_0x3b04(_0x28462c,_0x80b375){var _0x5c3fdc=a0_0x5c3f();return a0_0x3b04=function(_0x3b0466,_0x5cb7e4){_0x3b0466=_0x3b0466-0x186;var _0xabd6a7=_0x5c3fdc[_0x3b0466];return _0xabd6a7;},a0_0x3b04(_0x28462c,_0x80b375);}export async function dpCreateFolder(_0x1e47a4){var _0x4a1cca=a0_0x35508e;const _0x46b0b8=localStorage[_0x4a1cca(0x1e3)]('uId');let _0x3c37e6=localStorage[_0x4a1cca(0x1e3)](_0x4a1cca(0x1db));const _0x5ad0a6='/'+_0x46b0b8+'/'+_0x1e47a4,_0x39910d=JSON['stringify']({'path':_0x5ad0a6,'autorename':![]});for(let _0x38afd1=0x0;_0x38afd1<0x2;_0x38afd1++){try{const _0x554263=await fetch(_0x4a1cca(0x1c2),{'method':'POST','headers':{'Authorization':_0x4a1cca(0x1de)+_0x3c37e6,'Content-Type':_0x4a1cca(0x190)},'body':_0x39910d});if(_0x554263[_0x4a1cca(0x1ae)]===0x191){const _0x11c1c5=await dpRefreshToken();if(!_0x11c1c5)throw new Error(_0x4a1cca(0x1ca));_0x3c37e6=localStorage['getItem'](_0x4a1cca(0x1db));continue;}if(_0x554263[_0x4a1cca(0x1ae)]===0x199)return{'message':_0x4a1cca(0x1aa),'path':_0x1e47a4};if(!_0x554263['ok'])throw new Error(_0x4a1cca(0x1e7)+_0x1e47a4);const _0x3b97d6=await _0x554263[_0x4a1cca(0x195)]();return await lockNoti(_0x4a1cca(0x1bb),'',0xbb8),_0x3b97d6;}catch(_0xd06e84){if(_0x38afd1===0x1)throw _0xd06e84;}}return![];}export async function dpRefreshToken(){var _0x48b7f7=a0_0x35508e;if(!localStorage[_0x48b7f7(0x1e3)](_0x48b7f7(0x18a)))throw'No\x20refresh\x20token';try{const _0x2d39a4=await fetch(_0x48b7f7(0x1ab),{'method':_0x48b7f7(0x1e1),'headers':{'Content-Type':_0x48b7f7(0x1d9)},'body':_0x48b7f7(0x1d1)+localStorage[_0x48b7f7(0x1e3)]('refreshToken')+_0x48b7f7(0x1bd)}),_0x2e7171=await _0x2d39a4[_0x48b7f7(0x195)]();if(!_0x2e7171['error'])return localStorage[_0x48b7f7(0x188)](_0x48b7f7(0x1db),_0x2e7171[_0x48b7f7(0x1a0)]),await lockNoti(_0x48b7f7(0x19c),'',0xbb8),await delay(0x3e8),!![];else alert(_0x2e7171[_0x48b7f7(0x18c)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x130f84){console[_0x48b7f7(0x19f)](_0x48b7f7(0x1d8),_0x130f84);}return![];}export async function dpUploadFile(_0x5e9f76,_0x1ecb7d,_0x2268ec){var _0x428782=a0_0x35508e;const _0x304cb0=localStorage[_0x428782(0x1e3)](_0x428782(0x1d2));var _0x366787=JSON[_0x428782(0x186)]({'autorename':!![],'mode':_0x428782(0x1d4),'mute':!![],'strict_conflict':![],'path':'/'+_0x304cb0+'/'+_0x2268ec+'/'+_0x5e9f76}),_0x5ecca8=new Blob([_0x1ecb7d],{'type':_0x428782(0x1a4)});for(var _0x6b1465=0x0;_0x6b1465<0x2;_0x6b1465++){var _0x4a2f87=await fetch(_0x428782(0x1dc),{'method':'POST','headers':{'Authorization':_0x428782(0x1de)+localStorage[_0x428782(0x1e3)]('accessToken'),'Dropbox-API-Arg':_0x366787,'Content-Type':_0x428782(0x1a4)},'body':_0x5ecca8});if(_0x4a2f87[_0x428782(0x1ae)]!=0xc8){if(_0x4a2f87[_0x428782(0x1ae)]==0x191){var _0x5237c0=await dpRefreshToken();if(!_0x5237c0)throw _0x428782(0x1ca);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x4a2f87[_0x428782(0x1ae)];}else{var _0x3e2828=await _0x4a2f87[_0x428782(0x195)]();return console[_0x428782(0x1a2)]('Kabu\x20storage\x20↦\x20Cloud\x20◆',_0x5e9f76),_0x3e2828;}}return![];}export async function dpDownloadFile(_0x568f63,_0x1ed97d){var _0x32f8d2=a0_0x35508e;const _0x14ee38=localStorage[_0x32f8d2(0x1e3)](_0x32f8d2(0x1d2));var _0x467119=JSON[_0x32f8d2(0x186)]({'path':'/'+_0x14ee38+'/'+_0x1ed97d+'/'+_0x568f63});for(var _0x4ca142=0x0;_0x4ca142<0x2;_0x4ca142++){var _0x238d1d=await fetch(_0x32f8d2(0x1c7),{'method':'POST','headers':{'Authorization':_0x32f8d2(0x1de)+localStorage['getItem'](_0x32f8d2(0x1db)),'Dropbox-API-Arg':_0x467119}});if(_0x238d1d[_0x32f8d2(0x1ae)]!=0xc8){if(_0x238d1d[_0x32f8d2(0x1ae)]==0x191){var _0x1efe74=await dpRefreshToken();if(!_0x1efe74)throw _0x32f8d2(0x1ca);continue;}else throw _0x32f8d2(0x1b7)+_0x238d1d[_0x32f8d2(0x1ae)];}const _0x294012=new File([await _0x238d1d[_0x32f8d2(0x1a3)]()],_0x568f63);return console[_0x32f8d2(0x1a2)](_0x32f8d2(0x18d),_0x294012[_0x32f8d2(0x19d)]),a0_0x299c84[_0x32f8d2(0x1b9)](_0x294012,()=>{}),_0x294012;}return![];}document[a0_0x35508e(0x19e)](a0_0x35508e(0x1d5),function(){var _0x29fa74=a0_0x35508e;dropboxRestore[_0x29fa74(0x19e)](_0x29fa74(0x1e4),async function(){var _0x113095=_0x29fa74;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x56eec7=localStorage[_0x113095(0x1e3)](_0x113095(0x1d2)),_0x2096ea=['state',_0x113095(0x1cb),_0x113095(0x1be)];if(!_0x56eec7){window[_0x113095(0x18f)](_0x113095(0x1c6));return;}let _0x36cab8=[];for(const _0x483854 of _0x2096ea){let _0x3e6c42={'path':'/'+_0x56eec7+'/'+_0x483854};for(let _0x585b93=0x0;_0x585b93<0x2;_0x585b93++){let _0x2815b0=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x113095(0x1de)+localStorage[_0x113095(0x1e3)]('accessToken'),'Content-Type':_0x113095(0x190)},'body':JSON[_0x113095(0x186)](_0x3e6c42)});if(_0x2815b0['status']===0xc8){let _0xe58f41=await _0x2815b0[_0x113095(0x195)](),_0x4af654=_0xe58f41['entries'][_0x113095(0x192)](_0x5748f6=>_0x5748f6['.tag']===_0x113095(0x1e6));_0x4af654[_0x113095(0x1e8)]>0x0&&_0x36cab8[_0x113095(0x1c4)](..._0x4af654[_0x113095(0x1a9)](_0x190db5=>({'name':_0x190db5['name'],'folder':_0x483854})));break;}else{if(_0x2815b0['status']===0x191){let _0x96c084=await dpRefreshToken();if(!_0x96c084)throw _0x113095(0x1ca);}else{console['error'](_0x113095(0x1cf)+_0x483854+',\x20status:\x20'+_0x2815b0['status']);break;}}}}if(_0x36cab8[_0x113095(0x1e8)]>0x0){const _0x493de6=_0x113095(0x1b3)+_0x36cab8['length']+_0x113095(0x18e);if(window[_0x113095(0x193)](_0x493de6))for(const _0xc5a208 of _0x36cab8){await lockNoti('Restoring...',_0xc5a208['name'],0xbb8),await dpDownloadFile(_0xc5a208['name'],_0xc5a208['folder']);}else console[_0x113095(0x1a2)](_0x113095(0x1b6));}else console[_0x113095(0x1a2)]('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup[_0x29fa74(0x19e)]('click',async function(){var _0x4d44ae=_0x29fa74;await lockNoti(_0x4d44ae(0x1d3),'',0x1388);const _0x54a790=localStorage[_0x4d44ae(0x1e3)](_0x4d44ae(0x1d2));if(_0x54a790===null||_0x54a790==='')window[_0x4d44ae(0x18f)](_0x4d44ae(0x1c6));else{const _0x2ac678=[_0x4d44ae(0x199),_0x4d44ae(0x1cb),'screenshot'];for(const _0x385269 of _0x2ac678){await dpCreateFolder(_0x385269);}let _0x4acd6d=0x0;for(const _0x25ebc6 of _0x2ac678){const _0x37f12c=a0_0x299c84[_0x4d44ae(0x1a7)](_0x25ebc6+'s');_0x4acd6d+=_0x37f12c[_0x4d44ae(0x1e8)];}if(window[_0x4d44ae(0x193)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x4acd6d+_0x4d44ae(0x1df)))for(const _0x3e1cc3 of _0x2ac678){const _0x29228f=a0_0x299c84['listFiles'](_0x3e1cc3+'s');for(const _0xcfb846 of _0x29228f){const _0x55d2e3=await a0_0x299c84['downloadFileInCloud'](_0x4d44ae(0x1a1)+_0x3e1cc3+'s/'+_0xcfb846);try{await lockNoti(_0x4d44ae(0x196),_0xcfb846,0xbb8),await dpUploadFile(_0xcfb846,_0x55d2e3,_0x3e1cc3);}catch(_0x5377c1){console['error'](_0x4d44ae(0x1b4)+_0xcfb846+':',_0x5377c1);}}}else console[_0x4d44ae(0x1a2)](_0x4d44ae(0x1b6));}}),dropboxCloud[_0x29fa74(0x19e)](_0x29fa74(0x1e4),function(){var _0x561213=_0x29fa74;const _0x4f4dd3=localStorage[_0x561213(0x1e3)]('uId');_0x4f4dd3===null||_0x4f4dd3===''?authorizeWithDropbox():window['confirm'](_0x561213(0x1ea))&&(localStorage[_0x561213(0x188)]('uId',''),dropboxRestore['classList']['remove'](_0x561213(0x1ba)),dropboxBackup[_0x561213(0x1dd)][_0x561213(0x198)](_0x561213(0x1ba)),dropboxCloud['classList'][_0x561213(0x198)](_0x561213(0x1ba)));}),handleDropboxCallback();});