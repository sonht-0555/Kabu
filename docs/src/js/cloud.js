var a0_0x552809=a0_0x53f9;(function(_0x154d83,_0x9c4f4c){var _0x119632=a0_0x53f9,_0xcede45=_0x154d83();while(!![]){try{var _0x43d68e=parseInt(_0x119632(0x163))/0x1+parseInt(_0x119632(0x188))/0x2*(parseInt(_0x119632(0x1a7))/0x3)+-parseInt(_0x119632(0x1b0))/0x4*(-parseInt(_0x119632(0x19e))/0x5)+parseInt(_0x119632(0x18f))/0x6+-parseInt(_0x119632(0x171))/0x7*(-parseInt(_0x119632(0x15e))/0x8)+-parseInt(_0x119632(0x179))/0x9+-parseInt(_0x119632(0x19f))/0xa;if(_0x43d68e===_0x9c4f4c)break;else _0xcede45['push'](_0xcede45['shift']());}catch(_0x4519c6){_0xcede45['push'](_0xcede45['shift']());}}}(a0_0x552e,0x42e25));function a0_0x552e(){var _0x5ae1ef=['name','code','classList','log','Cloud\x20login\x20required!','refresh_token','32406iIdzrW','addEventListener','Unable\x20to\x20refresh\x20token','Refreshing\x20token...','https://content.dropboxapi.com/2/files/upload','state','application/octet-stream','Restore\x20canceled\x20by\x20user.','uid','responseText','json','application/x-www-form-urlencoded','confirm','refresh_token=','push','5IOdllL','296430zZtfUm','Folder\x20created','nwb3dnfh09rhs31','https://api.dropboxapi.com/2/files/create_folder_v2','uId','Error\x20creating\x20folder\x20','Do\x20you\x20want\x20to\x20logout?','Folder\x20already\x20exists','3zQxNqu','Do\x20you\x20want\x20to\x20restore\x20','blob','open','https://content.dropboxapi.com/2/files/download','getItem','length','Cloud\x20↦\x20Kabu\x20storage\x20◆','setItem','47956CbDYMW','DOMContentLoaded','onload','folder','search','downloadFileInCloud','overwrite','Wait\x20a\x20little\x20bit...','remove','Content-Type','replace','https://api.dropboxapi.com/2/files/list_folder','save','&client_id=','knh3uz2mx2hp2eu','screenshot','Failed\x20to\x20refresh\x20Dropbox\x20token.','status','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Error\x20while\x20refreshing\x20token:','8FNabDH','Backing\x20up...','Download\x20failed,\x20unknown\x20http\x20status:','authorization_code','access_token','33241mUqNnP','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Restoring...','.tag','Bearer\x20',',\x20status:\x20','&client_secret=','code=','location','No\x20refresh\x20token','\x20files\x20in\x20Kabu?','Kabu\x20storage\x20↦\x20Cloud\x20◆','error_description','No\x20files\x20found\x20to\x20restore.','2035187tdZxDP','send','https://api.dropbox.com/oauth2/token','Do\x20not\x20receive\x20authorization','refreshToken','https://api.dropboxapi.com/oauth2/token','&grant_type=','Do\x20you\x20want\x20to\x20backup\x20','4057191ylBXBT','[\x5c?&#]','&redirect_uri=','entries','click','accessToken','href','stringify','application/json','error','POST','active','split','parse','&response_type=','826054TZpgWo'];a0_0x552e=function(){return _0x5ae1ef;};return a0_0x552e();}import*as a0_0x18a02f from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x552809(0x158),clientSecret=a0_0x552809(0x1a1);function a0_0x53f9(_0x4d860c,_0x525347){var _0x552e4c=a0_0x552e();return a0_0x53f9=function(_0x53f9b5,_0x4c39cf){_0x53f9b5=_0x53f9b5-0x154;var _0x4f1881=_0x552e4c[_0x53f9b5];return _0x4f1881;},a0_0x53f9(_0x4d860c,_0x525347);}function authorizeWithDropbox(){var _0x2674f5=a0_0x552809,_0x456889=window['location'][_0x2674f5(0x17f)][_0x2674f5(0x185)]('?')[0x0],_0x5c9743='code',_0x2d964e='offline',_0xcfd2fd='https://www.dropbox.com/oauth2/authorize?client_id='+clientId+_0x2674f5(0x187)+_0x5c9743+'&token_access_type='+_0x2d964e+_0x2674f5(0x17b)+encodeURIComponent(_0x456889);window[_0x2674f5(0x16b)][_0x2674f5(0x17f)]=_0xcfd2fd;}function handleDropboxCallback(){var _0x5d50eb=a0_0x552809,_0xca6054=getUrlParameter(_0x5d50eb(0x18a));_0xca6054?(getAccessToken(_0xca6054),console[_0x5d50eb(0x18c)]('Authorization\x20Code:',_0xca6054)):console[_0x5d50eb(0x18c)](_0x5d50eb(0x174));}function getUrlParameter(_0x5438b0){var _0x2c0c65=a0_0x552809;_0x5438b0=_0x5438b0[_0x2c0c65(0x154)](/[\[]/,'\x5c[')[_0x2c0c65(0x154)](/[\]]/,'\x5c]');var _0x136312=new RegExp(_0x2c0c65(0x17a)+_0x5438b0+'=([^&#]*)'),_0x4b5c9f=_0x136312['exec'](location[_0x2c0c65(0x1b4)]);return _0x4b5c9f===null?'':decodeURIComponent(_0x4b5c9f[0x1][_0x2c0c65(0x154)](/\+/g,'\x20'));}function getAccessToken(_0x534ff1){var _0x21a4a4=a0_0x552809,_0x5dc441=_0x21a4a4(0x161),_0x38da28=window[_0x21a4a4(0x16b)][_0x21a4a4(0x17f)][_0x21a4a4(0x185)]('?')[0x0],_0x1d08e1=new XMLHttpRequest();_0x1d08e1[_0x21a4a4(0x1aa)]('POST',_0x21a4a4(0x173)),_0x1d08e1['setRequestHeader'](_0x21a4a4(0x1b9),_0x21a4a4(0x19a)),_0x1d08e1[_0x21a4a4(0x1b2)]=function(){var _0x3c4bec=_0x21a4a4;if(_0x1d08e1[_0x3c4bec(0x15b)]===0xc8){var _0x376d9f=JSON[_0x3c4bec(0x186)](_0x1d08e1[_0x3c4bec(0x198)]),_0x436571=_0x376d9f[_0x3c4bec(0x162)],_0x49fb37=_0x376d9f[_0x3c4bec(0x18e)],_0x2a036f=_0x376d9f[_0x3c4bec(0x197)];localStorage[_0x3c4bec(0x1af)](_0x3c4bec(0x17e),_0x436571),localStorage['setItem'](_0x3c4bec(0x175),_0x49fb37),localStorage[_0x3c4bec(0x1af)](_0x3c4bec(0x1a3),_0x2a036f);}else console[_0x3c4bec(0x18c)](_0x3c4bec(0x15c));},_0x1d08e1[_0x21a4a4(0x172)](_0x21a4a4(0x16a)+_0x534ff1+_0x21a4a4(0x177)+_0x5dc441+_0x21a4a4(0x157)+clientId+_0x21a4a4(0x169)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x38da28));}export async function dpCreateFolder(_0x2b3e09){var _0x508ebc=a0_0x552809;const _0xdd442c=localStorage[_0x508ebc(0x1ac)](_0x508ebc(0x1a3));let _0x3377da=localStorage[_0x508ebc(0x1ac)]('accessToken');const _0x2de924='/'+_0xdd442c+'/'+_0x2b3e09,_0x468255=JSON[_0x508ebc(0x180)]({'path':_0x2de924,'autorename':![]});for(let _0x45651=0x0;_0x45651<0x2;_0x45651++){try{const _0x3866a2=await fetch(_0x508ebc(0x1a2),{'method':_0x508ebc(0x183),'headers':{'Authorization':_0x508ebc(0x167)+_0x3377da,'Content-Type':_0x508ebc(0x181)},'body':_0x468255});if(_0x3866a2[_0x508ebc(0x15b)]===0x191){const _0x5a5175=await dpRefreshToken();if(!_0x5a5175)throw new Error(_0x508ebc(0x191));_0x3377da=localStorage[_0x508ebc(0x1ac)]('accessToken');continue;}if(_0x3866a2[_0x508ebc(0x15b)]===0x199)return{'message':_0x508ebc(0x1a6),'path':_0x2b3e09};if(!_0x3866a2['ok'])throw new Error(_0x508ebc(0x1a4)+_0x2b3e09);const _0x16ce8a=await _0x3866a2[_0x508ebc(0x199)]();return await lockNoti(_0x508ebc(0x1a0),'',0xbb8),_0x16ce8a;}catch(_0x2ec9c8){if(_0x45651===0x1)throw _0x2ec9c8;}}return![];}export async function dpRefreshToken(){var _0x52b694=a0_0x552809;if(!localStorage[_0x52b694(0x1ac)]('refreshToken'))throw _0x52b694(0x16c);try{const _0x2bcf2a=await fetch(_0x52b694(0x176),{'method':_0x52b694(0x183),'headers':{'Content-Type':'application/x-www-form-urlencoded'},'body':_0x52b694(0x19c)+localStorage[_0x52b694(0x1ac)](_0x52b694(0x175))+_0x52b694(0x164)}),_0x22f39a=await _0x2bcf2a[_0x52b694(0x199)]();if(!_0x22f39a[_0x52b694(0x182)])return localStorage[_0x52b694(0x1af)](_0x52b694(0x17e),_0x22f39a['access_token']),await lockNoti(_0x52b694(0x192),'',0xbb8),await delay(0x3e8),!![];else alert(_0x22f39a[_0x52b694(0x16f)]||_0x52b694(0x15a));}catch(_0x2bde09){console[_0x52b694(0x182)](_0x52b694(0x15d),_0x2bde09);}return![];}export async function dpUploadFile(_0x2571eb,_0xfd82c3,_0x3b838a){var _0x2fb11d=a0_0x552809;const _0x496259=localStorage[_0x2fb11d(0x1ac)]('uId');var _0x505733=JSON[_0x2fb11d(0x180)]({'autorename':!![],'mode':_0x2fb11d(0x1b6),'mute':!![],'strict_conflict':![],'path':'/'+_0x496259+'/'+_0x3b838a+'/'+_0x2571eb}),_0x13ba2c=new Blob([_0xfd82c3],{'type':'application/octet-stream'});for(var _0xa20ba3=0x0;_0xa20ba3<0x2;_0xa20ba3++){var _0x3cdf60=await fetch(_0x2fb11d(0x193),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x505733,'Content-Type':_0x2fb11d(0x195)},'body':_0x13ba2c});if(_0x3cdf60[_0x2fb11d(0x15b)]!=0xc8){if(_0x3cdf60[_0x2fb11d(0x15b)]==0x191){var _0x284595=await dpRefreshToken();if(!_0x284595)throw _0x2fb11d(0x191);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x3cdf60[_0x2fb11d(0x15b)];}else{var _0x159703=await _0x3cdf60[_0x2fb11d(0x199)]();return console[_0x2fb11d(0x18c)](_0x2fb11d(0x16e),_0x2571eb),_0x159703;}}return![];}export async function dpDownloadFile(_0x3bdd97,_0x522137){var _0x5eeb02=a0_0x552809;const _0x48f7c1=localStorage['getItem'](_0x5eeb02(0x1a3));var _0x32ca58=JSON[_0x5eeb02(0x180)]({'path':'/'+_0x48f7c1+'/'+_0x522137+'/'+_0x3bdd97});for(var _0x411de0=0x0;_0x411de0<0x2;_0x411de0++){var _0x554bf2=await fetch(_0x5eeb02(0x1ab),{'method':_0x5eeb02(0x183),'headers':{'Authorization':_0x5eeb02(0x167)+localStorage[_0x5eeb02(0x1ac)](_0x5eeb02(0x17e)),'Dropbox-API-Arg':_0x32ca58}});if(_0x554bf2[_0x5eeb02(0x15b)]!=0xc8){if(_0x554bf2[_0x5eeb02(0x15b)]==0x191){var _0x4e8df9=await dpRefreshToken();if(!_0x4e8df9)throw _0x5eeb02(0x191);continue;}else throw _0x5eeb02(0x160)+_0x554bf2[_0x5eeb02(0x15b)];}const _0x4448c1=new File([await _0x554bf2[_0x5eeb02(0x1a9)]()],_0x3bdd97);return console[_0x5eeb02(0x18c)](_0x5eeb02(0x1ae),_0x4448c1[_0x5eeb02(0x189)]),a0_0x18a02f['uploadFileInCloud'](_0x4448c1,()=>{}),_0x4448c1;}return![];}document[a0_0x552809(0x190)](a0_0x552809(0x1b1),function(){var _0xe9007e=a0_0x552809;dropboxRestore[_0xe9007e(0x190)](_0xe9007e(0x17d),async function(){var _0x246637=_0xe9007e;await lockNoti(_0x246637(0x1b7),'',0x1388);const _0x28c537=localStorage[_0x246637(0x1ac)](_0x246637(0x1a3)),_0x472af3=['state',_0x246637(0x156),'screenshot'];if(!_0x28c537){window['alert']('Cloud\x20login\x20required!');return;}let _0x2aacbf=[];for(const _0x1dc602 of _0x472af3){let _0x3da0c3={'path':'/'+_0x28c537+'/'+_0x1dc602};for(let _0x3ac613=0x0;_0x3ac613<0x2;_0x3ac613++){let _0x12fe6c=await fetch(_0x246637(0x155),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x246637(0x1ac)](_0x246637(0x17e)),'Content-Type':_0x246637(0x181)},'body':JSON[_0x246637(0x180)](_0x3da0c3)});if(_0x12fe6c[_0x246637(0x15b)]===0xc8){let _0x1f7dc0=await _0x12fe6c[_0x246637(0x199)](),_0x2e5695=_0x1f7dc0[_0x246637(0x17c)]['filter'](_0x55f480=>_0x55f480[_0x246637(0x166)]==='file');_0x2e5695['length']>0x0&&_0x2aacbf[_0x246637(0x19d)](..._0x2e5695['map'](_0x5b669d=>({'name':_0x5b669d[_0x246637(0x189)],'folder':_0x1dc602})));break;}else{if(_0x12fe6c[_0x246637(0x15b)]===0x191){let _0x48ae6c=await dpRefreshToken();if(!_0x48ae6c)throw _0x246637(0x191);}else{console[_0x246637(0x182)]('Download\x20failed\x20for\x20'+_0x1dc602+_0x246637(0x168)+_0x12fe6c[_0x246637(0x15b)]);break;}}}}if(_0x2aacbf['length']>0x0){const _0x399da9=_0x246637(0x1a8)+_0x2aacbf[_0x246637(0x1ad)]+'\x20files\x20from\x20Cloud?';if(window[_0x246637(0x19b)](_0x399da9))for(const _0x17ffc4 of _0x2aacbf){await lockNoti(_0x246637(0x165),_0x17ffc4[_0x246637(0x189)],0xbb8),await dpDownloadFile(_0x17ffc4[_0x246637(0x189)],_0x17ffc4[_0x246637(0x1b3)]);}else console['log'](_0x246637(0x196));}else console[_0x246637(0x18c)](_0x246637(0x170));}),dropboxBackup['addEventListener'](_0xe9007e(0x17d),async function(){var _0x183778=_0xe9007e;await lockNoti(_0x183778(0x1b7),'',0x1388);const _0x49459f=localStorage[_0x183778(0x1ac)](_0x183778(0x1a3));if(_0x49459f===null||_0x49459f==='')window['alert'](_0x183778(0x18d));else{const _0xb5f60c=[_0x183778(0x194),'save',_0x183778(0x159)];for(const _0x1cecda of _0xb5f60c){await dpCreateFolder(_0x1cecda);}let _0x24499c=0x0;for(const _0x27507e of _0xb5f60c){const _0x41b2a0=a0_0x18a02f['listFiles'](_0x27507e+'s');_0x24499c+=_0x41b2a0['length'];}if(window[_0x183778(0x19b)](_0x183778(0x178)+_0x24499c+_0x183778(0x16d)))for(const _0xa418c6 of _0xb5f60c){const _0x453fa5=a0_0x18a02f['listFiles'](_0xa418c6+'s');for(const _0x27d5d6 of _0x453fa5){const _0x5d63ca=await a0_0x18a02f[_0x183778(0x1b5)]('/data/'+_0xa418c6+'s/'+_0x27d5d6);try{await lockNoti(_0x183778(0x15f),_0x27d5d6,0xbb8),await dpUploadFile(_0x27d5d6,_0x5d63ca,_0xa418c6);}catch(_0x16eaed){console['error']('Failed\x20to\x20upload\x20file\x20'+_0x27d5d6+':',_0x16eaed);}}}else console['log'](_0x183778(0x196));}}),dropboxCloud[_0xe9007e(0x190)](_0xe9007e(0x17d),function(){var _0x721340=_0xe9007e;const _0x4d5f4c=localStorage[_0x721340(0x1ac)](_0x721340(0x1a3));_0x4d5f4c===null||_0x4d5f4c===''?authorizeWithDropbox():window['confirm'](_0x721340(0x1a5))&&(localStorage[_0x721340(0x1af)](_0x721340(0x1a3),''),dropboxRestore[_0x721340(0x18b)][_0x721340(0x1b8)](_0x721340(0x184)),dropboxBackup[_0x721340(0x18b)][_0x721340(0x1b8)](_0x721340(0x184)),dropboxCloud['classList'][_0x721340(0x1b8)](_0x721340(0x184)));}),handleDropboxCallback();});