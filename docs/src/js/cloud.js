var a0_0x5010dc=a0_0x1009;(function(_0x86427c,_0x29f140){var _0x4458e1=a0_0x1009,_0x23fde6=_0x86427c();while(!![]){try{var _0x582394=-parseInt(_0x4458e1(0x144))/0x1+-parseInt(_0x4458e1(0x13a))/0x2*(parseInt(_0x4458e1(0x145))/0x3)+-parseInt(_0x4458e1(0x185))/0x4*(parseInt(_0x4458e1(0x12c))/0x5)+parseInt(_0x4458e1(0x155))/0x6+-parseInt(_0x4458e1(0x17d))/0x7*(-parseInt(_0x4458e1(0x174))/0x8)+-parseInt(_0x4458e1(0x17e))/0x9+parseInt(_0x4458e1(0x127))/0xa*(parseInt(_0x4458e1(0x120))/0xb);if(_0x582394===_0x29f140)break;else _0x23fde6['push'](_0x23fde6['shift']());}catch(_0x3d24b0){_0x23fde6['push'](_0x23fde6['shift']());}}}(a0_0x230d,0x43241));import*as a0_0x210e40 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x1009(_0x3a884e,_0x22339d){var _0x230dcb=a0_0x230d();return a0_0x1009=function(_0x1009e2,_0xfbe97){_0x1009e2=_0x1009e2-0x120;var _0x11ecb5=_0x230dcb[_0x1009e2];return _0x11ecb5;},a0_0x1009(_0x3a884e,_0x22339d);}var clientId=a0_0x5010dc(0x132),clientSecret=a0_0x5010dc(0x15c);function authorizeWithDropbox(){var _0xc0b684=a0_0x5010dc,_0x755258=window[_0xc0b684(0x172)][_0xc0b684(0x168)]['split']('?')[0x0],_0x26f222='code',_0x72610f=_0xc0b684(0x161),_0x138747=_0xc0b684(0x136)+clientId+_0xc0b684(0x12e)+_0x26f222+'&token_access_type='+_0x72610f+_0xc0b684(0x152)+encodeURIComponent(_0x755258);window['location'][_0xc0b684(0x168)]=_0x138747;}function handleDropboxCallback(){var _0x3f519f=a0_0x5010dc,_0x1e7c79=getUrlParameter(_0x3f519f(0x17f));_0x1e7c79?(getAccessToken(_0x1e7c79),console[_0x3f519f(0x151)](_0x3f519f(0x167),_0x1e7c79)):console['log'](_0x3f519f(0x13c));}function getUrlParameter(_0xd365f7){var _0x85c564=a0_0x5010dc;_0xd365f7=_0xd365f7[_0x85c564(0x153)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x44d964=new RegExp(_0x85c564(0x184)+_0xd365f7+_0x85c564(0x13d)),_0x493cda=_0x44d964[_0x85c564(0x157)](location[_0x85c564(0x187)]);return _0x493cda===null?'':decodeURIComponent(_0x493cda[0x1][_0x85c564(0x153)](/\+/g,'\x20'));}function getAccessToken(_0x54d85e){var _0x1925d3=a0_0x5010dc,_0x450e4b=_0x1925d3(0x138),_0x26bdb6=window[_0x1925d3(0x172)][_0x1925d3(0x168)][_0x1925d3(0x134)]('?')[0x0],_0x45831b=new XMLHttpRequest();_0x45831b[_0x1925d3(0x15f)](_0x1925d3(0x181),_0x1925d3(0x123)),_0x45831b[_0x1925d3(0x126)](_0x1925d3(0x160),'application/x-www-form-urlencoded'),_0x45831b[_0x1925d3(0x129)]=function(){var _0x2c38b7=_0x1925d3;if(_0x45831b[_0x2c38b7(0x18c)]===0xc8){var _0x1cb2f3=JSON['parse'](_0x45831b[_0x2c38b7(0x175)]),_0x295ead=_0x1cb2f3['access_token'],_0x9a21a6=_0x1cb2f3[_0x2c38b7(0x189)],_0x599331=_0x1cb2f3['uid'];localStorage[_0x2c38b7(0x188)](_0x2c38b7(0x147),_0x295ead),localStorage[_0x2c38b7(0x188)](_0x2c38b7(0x16b),_0x9a21a6),localStorage['setItem']('uId',_0x599331);}else console[_0x2c38b7(0x151)](_0x2c38b7(0x15a));},_0x45831b[_0x1925d3(0x179)](_0x1925d3(0x14c)+_0x54d85e+_0x1925d3(0x16f)+_0x450e4b+'&client_id='+clientId+_0x1925d3(0x13f)+clientSecret+_0x1925d3(0x152)+encodeURIComponent(_0x26bdb6));}function a0_0x230d(){var _0x140be0=['106020MRvQAI','filter','exec','map','https://api.dropboxapi.com/2/files/list_folder','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Error\x20while\x20refreshing\x20token:','nwb3dnfh09rhs31','Cloud\x20login\x20required!','classList','open','Content-Type','offline','active','Download\x20failed,\x20unknown\x20http\x20status:','Do\x20you\x20want\x20to\x20restore\x20','Cloud\x20↦\x20Kabu\x20storage\x20◆','remove','Authorization\x20Code:','href','Restore\x20canceled\x20by\x20user.','stringify','refreshToken','No\x20files\x20found\x20to\x20restore.','Kabu\x20storage\x20↦\x20Cloud\x20◆','getItem','&grant_type=','state','uId','location','Folder\x20created','8UXCbaF','responseText','file','Failed\x20to\x20upload\x20file\x20','Backing\x20up...','send','folder','No\x20refresh\x20token','uploadFileInCloud','3222723SCmWPm','1582038sSFDbC','code','application/x-www-form-urlencoded','POST','https://content.dropboxapi.com/2/files/download','Wait\x20a\x20little\x20bit...','[\x5c?&#]','37852bFceHL','blob','search','setItem','refresh_token','Upload\x20failed,\x20unknown\x20http\x20status:\x20','entries','status','22WTIMnE','Do\x20you\x20want\x20to\x20logout?','\x20files\x20from\x20Cloud?','https://api.dropbox.com/oauth2/token','downloadFileInCloud','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','setRequestHeader','4786330KyQdTl','save','onload','json','.tag','80LcAgaS','Bearer\x20','&response_type=','https://api.dropboxapi.com/2/files/create_folder_v2','confirm','Unable\x20to\x20refresh\x20token','knh3uz2mx2hp2eu','refresh_token=','split','https://content.dropboxapi.com/2/files/upload','https://www.dropbox.com/oauth2/authorize?client_id=','click','authorization_code','listFiles','314438wGmDUZ','/data/','Do\x20not\x20receive\x20authorization','=([^&#]*)','application/octet-stream','&client_secret=','Refreshing\x20token...','Do\x20you\x20want\x20to\x20backup\x20','access_token','\x20files\x20in\x20Kabu?','518688dmXIYr','6mTtdkI','error','accessToken','addEventListener','error_description','screenshot','alert','code=','name','Failed\x20to\x20refresh\x20Dropbox\x20token.','application/json','length','log','&redirect_uri=','replace','DOMContentLoaded'];a0_0x230d=function(){return _0x140be0;};return a0_0x230d();}export async function dpCreateFolder(_0x50afaa){var _0x188ac6=a0_0x5010dc;const _0x4d8e27=localStorage[_0x188ac6(0x16e)](_0x188ac6(0x171));let _0x1db47a=localStorage[_0x188ac6(0x16e)](_0x188ac6(0x147));const _0x4aadd2='/'+_0x4d8e27+'/'+_0x50afaa,_0x45cdb8=JSON[_0x188ac6(0x16a)]({'path':_0x4aadd2,'autorename':![]});for(let _0x3ff418=0x0;_0x3ff418<0x2;_0x3ff418++){try{const _0x5ad31e=await fetch(_0x188ac6(0x12f),{'method':'POST','headers':{'Authorization':_0x188ac6(0x12d)+_0x1db47a,'Content-Type':_0x188ac6(0x14f)},'body':_0x45cdb8});if(_0x5ad31e['status']===0x191){const _0x5a6358=await dpRefreshToken();if(!_0x5a6358)throw new Error('Unable\x20to\x20refresh\x20token');_0x1db47a=localStorage['getItem'](_0x188ac6(0x147));continue;}if(_0x5ad31e[_0x188ac6(0x18c)]===0x199)return{'message':'Folder\x20already\x20exists','path':_0x50afaa};if(!_0x5ad31e['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x50afaa);const _0x4c9c67=await _0x5ad31e[_0x188ac6(0x12a)]();return await lockNoti(_0x188ac6(0x173),'',0xbb8),_0x4c9c67;}catch(_0x1a471c){if(_0x3ff418===0x1)throw _0x1a471c;}}return![];}export async function dpRefreshToken(){var _0x1ef012=a0_0x5010dc;if(!localStorage['getItem'](_0x1ef012(0x16b)))throw _0x1ef012(0x17b);try{const _0x57bece=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x1ef012(0x181),'headers':{'Content-Type':_0x1ef012(0x180)},'body':_0x1ef012(0x133)+localStorage['getItem'](_0x1ef012(0x16b))+_0x1ef012(0x125)}),_0x1cc360=await _0x57bece[_0x1ef012(0x12a)]();if(!_0x1cc360[_0x1ef012(0x146)])return localStorage[_0x1ef012(0x188)](_0x1ef012(0x147),_0x1cc360[_0x1ef012(0x142)]),await lockNoti(_0x1ef012(0x140),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1cc360[_0x1ef012(0x149)]||_0x1ef012(0x14e));}catch(_0x543689){console[_0x1ef012(0x146)](_0x1ef012(0x15b),_0x543689);}return![];}export async function dpUploadFile(_0x22ed00,_0x4d23bf,_0x313528){var _0x55893c=a0_0x5010dc;const _0x18f727=localStorage[_0x55893c(0x16e)](_0x55893c(0x171));var _0xf8d5eb=JSON['stringify']({'autorename':!![],'mode':'overwrite','mute':!![],'strict_conflict':![],'path':'/'+_0x18f727+'/'+_0x313528+'/'+_0x22ed00}),_0x48608b=new Blob([_0x4d23bf],{'type':_0x55893c(0x13e)});for(var _0x57b074=0x0;_0x57b074<0x2;_0x57b074++){var _0x3c2762=await fetch(_0x55893c(0x135),{'method':_0x55893c(0x181),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x55893c(0x16e)](_0x55893c(0x147)),'Dropbox-API-Arg':_0xf8d5eb,'Content-Type':'application/octet-stream'},'body':_0x48608b});if(_0x3c2762[_0x55893c(0x18c)]!=0xc8){if(_0x3c2762[_0x55893c(0x18c)]==0x191){var _0xe62bd2=await dpRefreshToken();if(!_0xe62bd2)throw _0x55893c(0x131);continue;}else throw _0x55893c(0x18a)+_0x3c2762[_0x55893c(0x18c)];}else{var _0x49fcd5=await _0x3c2762[_0x55893c(0x12a)]();return console[_0x55893c(0x151)](_0x55893c(0x16d),_0x22ed00),_0x49fcd5;}}return![];}export async function dpDownloadFile(_0x5527c6,_0x2468a7){var _0x4e4322=a0_0x5010dc;const _0x57d817=localStorage[_0x4e4322(0x16e)]('uId');var _0x23cff9=JSON[_0x4e4322(0x16a)]({'path':'/'+_0x57d817+'/'+_0x2468a7+'/'+_0x5527c6});for(var _0x4a3e0e=0x0;_0x4a3e0e<0x2;_0x4a3e0e++){var _0x482038=await fetch(_0x4e4322(0x182),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x4e4322(0x16e)]('accessToken'),'Dropbox-API-Arg':_0x23cff9}});if(_0x482038['status']!=0xc8){if(_0x482038[_0x4e4322(0x18c)]==0x191){var _0x2ee5b7=await dpRefreshToken();if(!_0x2ee5b7)throw _0x4e4322(0x131);continue;}else throw _0x4e4322(0x163)+_0x482038[_0x4e4322(0x18c)];}const _0x38c24d=new File([await _0x482038[_0x4e4322(0x186)]()],_0x5527c6);return console[_0x4e4322(0x151)](_0x4e4322(0x165),_0x38c24d[_0x4e4322(0x14d)]),a0_0x210e40[_0x4e4322(0x17c)](_0x38c24d,()=>{}),_0x38c24d;}return![];}document['addEventListener'](a0_0x5010dc(0x154),function(){var _0x4afdfa=a0_0x5010dc;dropboxRestore[_0x4afdfa(0x148)](_0x4afdfa(0x137),async function(){var _0xfe3f7c=_0x4afdfa;await lockNoti('Wait\x20a\x20little\x20bit...','',0x1388);const _0x5ca186=localStorage[_0xfe3f7c(0x16e)](_0xfe3f7c(0x171)),_0x1ef1c9=[_0xfe3f7c(0x170),_0xfe3f7c(0x128),_0xfe3f7c(0x14a)];if(!_0x5ca186){window[_0xfe3f7c(0x14b)](_0xfe3f7c(0x15d));return;}let _0x2aa435=[];for(const _0x4239b3 of _0x1ef1c9){let _0x4ac795={'path':'/'+_0x5ca186+'/'+_0x4239b3};for(let _0x193c0d=0x0;_0x193c0d<0x2;_0x193c0d++){let _0x4e6d84=await fetch(_0xfe3f7c(0x159),{'method':_0xfe3f7c(0x181),'headers':{'Authorization':_0xfe3f7c(0x12d)+localStorage[_0xfe3f7c(0x16e)]('accessToken'),'Content-Type':_0xfe3f7c(0x14f)},'body':JSON[_0xfe3f7c(0x16a)](_0x4ac795)});if(_0x4e6d84['status']===0xc8){let _0x1072a7=await _0x4e6d84[_0xfe3f7c(0x12a)](),_0x2914b7=_0x1072a7[_0xfe3f7c(0x18b)][_0xfe3f7c(0x156)](_0x251663=>_0x251663[_0xfe3f7c(0x12b)]===_0xfe3f7c(0x176));_0x2914b7[_0xfe3f7c(0x150)]>0x0&&_0x2aa435['push'](..._0x2914b7[_0xfe3f7c(0x158)](_0x4a2569=>({'name':_0x4a2569[_0xfe3f7c(0x14d)],'folder':_0x4239b3})));break;}else{if(_0x4e6d84['status']===0x191){let _0x493c97=await dpRefreshToken();if(!_0x493c97)throw _0xfe3f7c(0x131);}else{console['error']('Download\x20failed\x20for\x20'+_0x4239b3+',\x20status:\x20'+_0x4e6d84[_0xfe3f7c(0x18c)]);break;}}}}if(_0x2aa435[_0xfe3f7c(0x150)]>0x0){const _0x32b8f7=_0xfe3f7c(0x164)+_0x2aa435['length']+_0xfe3f7c(0x122);if(window[_0xfe3f7c(0x130)](_0x32b8f7))for(const _0x27e799 of _0x2aa435){await lockNoti('Restoring...',_0x27e799[_0xfe3f7c(0x14d)],0xbb8),await dpDownloadFile(_0x27e799['name'],_0x27e799[_0xfe3f7c(0x17a)]);}else console[_0xfe3f7c(0x151)](_0xfe3f7c(0x169));}else console['log'](_0xfe3f7c(0x16c));}),dropboxBackup[_0x4afdfa(0x148)](_0x4afdfa(0x137),async function(){var _0x280c19=_0x4afdfa;await lockNoti(_0x280c19(0x183),'',0x1388);const _0x570490=localStorage[_0x280c19(0x16e)](_0x280c19(0x171));if(_0x570490===null||_0x570490==='')window[_0x280c19(0x14b)](_0x280c19(0x15d));else{const _0x315fea=[_0x280c19(0x170),_0x280c19(0x128),'screenshot'];for(const _0x32fc06 of _0x315fea){await dpCreateFolder(_0x32fc06);}let _0x24d23e=0x0;for(const _0x321d43 of _0x315fea){const _0xa5e3dd=a0_0x210e40[_0x280c19(0x139)](_0x321d43+'s');_0x24d23e+=_0xa5e3dd[_0x280c19(0x150)];}if(window['confirm'](_0x280c19(0x141)+_0x24d23e+_0x280c19(0x143)))for(const _0x17badb of _0x315fea){const _0x28dc54=a0_0x210e40[_0x280c19(0x139)](_0x17badb+'s');for(const _0x1c3678 of _0x28dc54){const _0x58cc54=await a0_0x210e40[_0x280c19(0x124)](_0x280c19(0x13b)+_0x17badb+'s/'+_0x1c3678);try{await lockNoti(_0x280c19(0x178),_0x1c3678,0xbb8),await dpUploadFile(_0x1c3678,_0x58cc54,_0x17badb);}catch(_0x2ac380){console['error'](_0x280c19(0x177)+_0x1c3678+':',_0x2ac380);}}}else console[_0x280c19(0x151)]('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x4afdfa(0x148)]('click',function(){var _0x364ac3=_0x4afdfa;const _0x33cb5e=localStorage[_0x364ac3(0x16e)](_0x364ac3(0x171));_0x33cb5e===null||_0x33cb5e===''?authorizeWithDropbox():window['confirm'](_0x364ac3(0x121))&&(localStorage[_0x364ac3(0x188)]('uId',''),dropboxRestore[_0x364ac3(0x15e)]['remove'](_0x364ac3(0x162)),dropboxBackup['classList'][_0x364ac3(0x166)](_0x364ac3(0x162)),dropboxCloud['classList'][_0x364ac3(0x166)](_0x364ac3(0x162)));}),handleDropboxCallback();});