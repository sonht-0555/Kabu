var a0_0x398703=a0_0x3b98;(function(_0x47bad2,_0x1eed90){var _0xffe272=a0_0x3b98,_0x5b1a6d=_0x47bad2();while(!![]){try{var _0x125789=parseInt(_0xffe272(0xb3))/0x1+-parseInt(_0xffe272(0x79))/0x2+parseInt(_0xffe272(0xb6))/0x3*(parseInt(_0xffe272(0x7a))/0x4)+parseInt(_0xffe272(0xb4))/0x5*(parseInt(_0xffe272(0x9f))/0x6)+parseInt(_0xffe272(0xaf))/0x7*(-parseInt(_0xffe272(0x89))/0x8)+-parseInt(_0xffe272(0x80))/0x9*(parseInt(_0xffe272(0xbb))/0xa)+parseInt(_0xffe272(0x87))/0xb*(parseInt(_0xffe272(0x74))/0xc);if(_0x125789===_0x1eed90)break;else _0x5b1a6d['push'](_0x5b1a6d['shift']());}catch(_0x3df40e){_0x5b1a6d['push'](_0x5b1a6d['shift']());}}}(a0_0x1ac9,0x4e337));import*as a0_0x48be2c from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0x398703(0x70),clientSecret='nwb3dnfh09rhs31';function authorizeWithDropbox(){var _0x2836a1=a0_0x398703,_0x565033=window[_0x2836a1(0x91)]['href'][_0x2836a1(0xa1)]('?')[0x0],_0x500aca=_0x2836a1(0x7b),_0x3c930c=_0x2836a1(0x96),_0x4417ff=_0x2836a1(0x8c)+clientId+'&response_type='+_0x500aca+_0x2836a1(0xba)+_0x3c930c+'&redirect_uri='+encodeURIComponent(_0x565033);window[_0x2836a1(0x91)][_0x2836a1(0xd5)]=_0x4417ff;}function handleDropboxCallback(){var _0x468891=a0_0x398703,_0x497012=getUrlParameter(_0x468891(0x7b));_0x497012?(getAccessToken(_0x497012),console['log'](_0x468891(0xc5),_0x497012)):console[_0x468891(0xbf)](_0x468891(0x95));}function getUrlParameter(_0x422c08){var _0x3c6e34=a0_0x398703;_0x422c08=_0x422c08[_0x3c6e34(0x8f)](/[\[]/,'\x5c[')[_0x3c6e34(0x8f)](/[\]]/,'\x5c]');var _0x1a85c0=new RegExp('[\x5c?&#]'+_0x422c08+_0x3c6e34(0x8a)),_0x4ba7da=_0x1a85c0['exec'](location[_0x3c6e34(0xbe)]);return _0x4ba7da===null?'':decodeURIComponent(_0x4ba7da[0x1][_0x3c6e34(0x8f)](/\+/g,'\x20'));}function getAccessToken(_0x4381b3){var _0x2432fe=a0_0x398703,_0x5ed3e6='authorization_code',_0x341ef7=window[_0x2432fe(0x91)][_0x2432fe(0xd5)][_0x2432fe(0xa1)]('?')[0x0],_0x3d0a04=new XMLHttpRequest();_0x3d0a04[_0x2432fe(0x90)]('POST',_0x2432fe(0x99)),_0x3d0a04[_0x2432fe(0xd7)]('Content-Type',_0x2432fe(0xa9)),_0x3d0a04[_0x2432fe(0xc3)]=function(){var _0x1e9ec0=_0x2432fe;if(_0x3d0a04[_0x1e9ec0(0xcc)]===0xc8){var _0x82d0df=JSON[_0x1e9ec0(0x9c)](_0x3d0a04[_0x1e9ec0(0x7f)]),_0x3bc918=_0x82d0df[_0x1e9ec0(0x8e)],_0xbfa4cd=_0x82d0df['refresh_token'],_0x4accfe=_0x82d0df[_0x1e9ec0(0x84)];localStorage[_0x1e9ec0(0xad)](_0x1e9ec0(0xd6),_0x3bc918),localStorage['setItem'](_0x1e9ec0(0xc1),_0xbfa4cd),localStorage[_0x1e9ec0(0xad)]('uId',_0x4accfe);}else console[_0x1e9ec0(0xbf)](_0x1e9ec0(0x94));},_0x3d0a04[_0x2432fe(0x8b)](_0x2432fe(0xc4)+_0x4381b3+_0x2432fe(0xb1)+_0x5ed3e6+_0x2432fe(0xd4)+clientId+'&client_secret='+clientSecret+_0x2432fe(0xc9)+encodeURIComponent(_0x341ef7));}function a0_0x1ac9(){var _0x8eb3e5=['uploadFileInCloud','Folder\x20already\x20exists','Bearer\x20','knh3uz2mx2hp2eu','Error\x20creating\x20folder\x20','toUpperCase','\x20files\x20from\x20Cloud?','7428rSBzUm','refresh_token=','error_description','save','application/octet-stream','1229436nWmGLS','38004sKwewx','code','Restore\x20canceled\x20by\x20user.','click','https://content.dropboxapi.com/2/files/upload','responseText','252hVqzLU','getItem','active','file','uid','classList','Cloud\x20login\x20required!','25377jORAUq','Cloud\x20↦\x20Kabu\x20storage\x20◆','16JclAAc','=([^&#]*)','send','https://www.dropbox.com/oauth2/authorize?client_id=','screenshot','access_token','replace','open','location','Download\x20failed,\x20unknown\x20http\x20status:','\x20files\x20in\x20Kabu?','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','Do\x20not\x20receive\x20authorization','offline','filter','DOMContentLoaded','https://api.dropbox.com/oauth2/token','folder','stringify','parse','Upload\x20failed,\x20unknown\x20http\x20status:\x20','Download\x20failed\x20for\x20','330znbyaF','https://content.dropboxapi.com/2/files/download','split','Wait\x20a\x20little\x20bit...','POST','slice','Unable\x20to\x20refresh\x20token','list','json','charAt','application/x-www-form-urlencoded','error','state','Do\x20you\x20want\x20to\x20logout?','setItem','/data/','2066162rgdWYM','Folder\x20created','&grant_type=','length','78935VHSLrK','1250uindeU','addEventListener','45udvSRR','name','https://api.dropboxapi.com/2/files/create_folder_v2','application/json','&token_access_type=','49240sLmXVD','remove','blob','search','log','Failed\x20to\x20refresh\x20Dropbox\x20token.','refreshToken','uId','onload','code=','Authorization\x20Code:','FSSync','Failed\x20to\x20upload\x20file\x20','Error\x20while\x20refreshing\x20token:','&redirect_uri=','Kabu\x20storage\x20↦\x20Cloud\x20◆','overwrite','status','Do\x20you\x20want\x20to\x20restore\x20','Refreshing\x20token...','No\x20refresh\x20token','https://api.dropboxapi.com/oauth2/token','Backing\x20up...','Restoring...','entries','&client_id=','href','accessToken','setRequestHeader'];a0_0x1ac9=function(){return _0x8eb3e5;};return a0_0x1ac9();}export async function dpCreateFolder(_0x216308){var _0x50a3f2=a0_0x398703;const _0x26e1c0=localStorage[_0x50a3f2(0x81)](_0x50a3f2(0xc2));let _0x53391d=localStorage[_0x50a3f2(0x81)](_0x50a3f2(0xd6));const _0x51d7c8='/'+_0x26e1c0+'/'+_0x216308,_0x44fe4c=JSON['stringify']({'path':_0x51d7c8,'autorename':![]});for(let _0x3a02e2=0x0;_0x3a02e2<0x2;_0x3a02e2++){try{const _0x26416d=await fetch(_0x50a3f2(0xb8),{'method':_0x50a3f2(0xa3),'headers':{'Authorization':_0x50a3f2(0x6f)+_0x53391d,'Content-Type':'application/json'},'body':_0x44fe4c});if(_0x26416d[_0x50a3f2(0xcc)]===0x191){const _0x582391=await dpRefreshToken();if(!_0x582391)throw new Error(_0x50a3f2(0xa5));_0x53391d=localStorage['getItem'](_0x50a3f2(0xd6));continue;}if(_0x26416d['status']===0x199)return{'message':_0x50a3f2(0x6e),'path':_0x216308};if(!_0x26416d['ok'])throw new Error(_0x50a3f2(0x71)+_0x216308);const _0x21f5e9=await _0x26416d[_0x50a3f2(0xa7)]();return await lockNoti(_0x50a3f2(0xb0),'',0xbb8),_0x21f5e9;}catch(_0x570f2f){if(_0x3a02e2===0x1)throw _0x570f2f;}}return![];}export async function dpRefreshToken(){var _0x1ff923=a0_0x398703;if(!localStorage[_0x1ff923(0x81)](_0x1ff923(0xc1)))throw _0x1ff923(0xcf);try{const _0x61f898=await fetch(_0x1ff923(0xd0),{'method':'POST','headers':{'Content-Type':_0x1ff923(0xa9)},'body':_0x1ff923(0x75)+localStorage['getItem']('refreshToken')+'&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31'}),_0x1d68bb=await _0x61f898[_0x1ff923(0xa7)]();if(!_0x1d68bb[_0x1ff923(0xaa)])return localStorage[_0x1ff923(0xad)]('accessToken',_0x1d68bb['access_token']),await lockNoti(_0x1ff923(0xce),'',0xbb8),await delay(0x3e8),!![];else alert(_0x1d68bb[_0x1ff923(0x76)]||_0x1ff923(0xc0));}catch(_0x4c5053){console['error'](_0x1ff923(0xc8),_0x4c5053);}return![];}function a0_0x3b98(_0x44d06f,_0x5896d9){var _0x1ac953=a0_0x1ac9();return a0_0x3b98=function(_0x3b9840,_0x51a252){_0x3b9840=_0x3b9840-0x6e;var _0x239fb0=_0x1ac953[_0x3b9840];return _0x239fb0;},a0_0x3b98(_0x44d06f,_0x5896d9);}export async function dpUploadFile(_0x5822f1,_0x3e7857,_0x1e054c){var _0x464719=a0_0x398703;const _0x4b6a07=localStorage[_0x464719(0x81)](_0x464719(0xc2));var _0x3921f6=JSON[_0x464719(0x9b)]({'autorename':!![],'mode':_0x464719(0xcb),'mute':!![],'strict_conflict':![],'path':'/'+_0x4b6a07+'/'+_0x1e054c+'/'+_0x5822f1}),_0x138494=new Blob([_0x3e7857],{'type':_0x464719(0x78)});for(var _0x3a4a51=0x0;_0x3a4a51<0x2;_0x3a4a51++){var _0x58d803=await fetch(_0x464719(0x7e),{'method':_0x464719(0xa3),'headers':{'Authorization':_0x464719(0x6f)+localStorage[_0x464719(0x81)](_0x464719(0xd6)),'Dropbox-API-Arg':_0x3921f6,'Content-Type':_0x464719(0x78)},'body':_0x138494});if(_0x58d803[_0x464719(0xcc)]!=0xc8){if(_0x58d803[_0x464719(0xcc)]==0x191){var _0x1ee034=await dpRefreshToken();if(!_0x1ee034)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x464719(0x9d)+_0x58d803[_0x464719(0xcc)];}else{var _0x14b817=await _0x58d803[_0x464719(0xa7)]();return console['log'](_0x464719(0xca),_0x5822f1),_0x14b817;}}return![];}export async function dpDownloadFile(_0x41ddbf,_0x3e4dda){var _0x39f644=a0_0x398703;const _0x218af4=localStorage[_0x39f644(0x81)](_0x39f644(0xc2));var _0x21e070=JSON[_0x39f644(0x9b)]({'path':'/'+_0x218af4+'/'+_0x3e4dda+'/'+_0x41ddbf});for(var _0x1e45cd=0x0;_0x1e45cd<0x2;_0x1e45cd++){var _0x3f5cc0=await fetch(_0x39f644(0xa0),{'method':'POST','headers':{'Authorization':_0x39f644(0x6f)+localStorage[_0x39f644(0x81)]('accessToken'),'Dropbox-API-Arg':_0x21e070}});if(_0x3f5cc0[_0x39f644(0xcc)]!=0xc8){if(_0x3f5cc0['status']==0x191){var _0x374e7f=await dpRefreshToken();if(!_0x374e7f)throw _0x39f644(0xa5);continue;}else throw _0x39f644(0x92)+_0x3f5cc0[_0x39f644(0xcc)];}const _0x5cda44=new File([await _0x3f5cc0[_0x39f644(0xbd)]()],_0x41ddbf);return console[_0x39f644(0xbf)](_0x39f644(0x88),_0x5cda44[_0x39f644(0xb7)]),a0_0x48be2c[_0x39f644(0xd8)](_0x5cda44,()=>{var _0x27279b=_0x39f644;localStorageFile(),Module[_0x27279b(0xc6)]();}),_0x5cda44;}return![];}document[a0_0x398703(0xb5)](a0_0x398703(0x98),function(){var _0x35d0d5=a0_0x398703;dropboxRestore[_0x35d0d5(0xb5)]('click',async function(){var _0x1e97f3=_0x35d0d5;await lockNoti(_0x1e97f3(0xa2),'',0x1388);const _0x3766da=localStorage[_0x1e97f3(0x81)]('uId'),_0x447bf6=[_0x1e97f3(0xab),_0x1e97f3(0x77),_0x1e97f3(0x8d)];if(!_0x3766da){window['alert'](_0x1e97f3(0x86));return;}let _0x5f0a97=[];for(const _0x5d6e76 of _0x447bf6){let _0x3304a5={'path':'/'+_0x3766da+'/'+_0x5d6e76};for(let _0x20c063=0x0;_0x20c063<0x2;_0x20c063++){let _0x26495a=await fetch('https://api.dropboxapi.com/2/files/list_folder',{'method':'POST','headers':{'Authorization':_0x1e97f3(0x6f)+localStorage['getItem'](_0x1e97f3(0xd6)),'Content-Type':_0x1e97f3(0xb9)},'body':JSON[_0x1e97f3(0x9b)](_0x3304a5)});if(_0x26495a[_0x1e97f3(0xcc)]===0xc8){let _0x5b1cbc=await _0x26495a[_0x1e97f3(0xa7)](),_0x511142=_0x5b1cbc[_0x1e97f3(0xd3)][_0x1e97f3(0x97)](_0x47c26f=>_0x47c26f['.tag']===_0x1e97f3(0x83));_0x511142[_0x1e97f3(0xb2)]>0x0&&_0x5f0a97['push'](..._0x511142['map'](_0x16f814=>({'name':_0x16f814[_0x1e97f3(0xb7)],'folder':_0x5d6e76})));break;}else{if(_0x26495a[_0x1e97f3(0xcc)]===0x191){let _0x2cbaf2=await dpRefreshToken();if(!_0x2cbaf2)throw'Unable\x20to\x20refresh\x20token';}else{console[_0x1e97f3(0xaa)](_0x1e97f3(0x9e)+_0x5d6e76+',\x20status:\x20'+_0x26495a[_0x1e97f3(0xcc)]);break;}}}}if(_0x5f0a97[_0x1e97f3(0xb2)]>0x0){const _0x42ca31=_0x1e97f3(0xcd)+_0x5f0a97[_0x1e97f3(0xb2)]+_0x1e97f3(0x73);if(window['confirm'](_0x42ca31))for(const _0x12e284 of _0x5f0a97){await lockNoti(_0x1e97f3(0xd2),_0x12e284['name'],0xbb8),await dpDownloadFile(_0x12e284['name'],_0x12e284[_0x1e97f3(0x9a)]);}else console[_0x1e97f3(0xbf)]('Restore\x20canceled\x20by\x20user.');}else console['log']('No\x20files\x20found\x20to\x20restore.');}),dropboxBackup['addEventListener'](_0x35d0d5(0x7d),async function(){var _0x138622=_0x35d0d5;await lockNoti(_0x138622(0xa2),'',0x1388);const _0x2f32be=localStorage[_0x138622(0x81)](_0x138622(0xc2));if(_0x2f32be===null||_0x2f32be==='')window['alert'](_0x138622(0x86));else{const _0x3e10ee=[_0x138622(0xab),'save','screenshot'];for(const _0x240843 of _0x3e10ee){await dpCreateFolder(_0x240843);}let _0x320bdd=0x0;for(const _0x39c1f4 of _0x3e10ee){const _0x5790d3=a0_0x48be2c[_0x138622(0xa6)+(_0x39c1f4[_0x138622(0xa8)](0x0)[_0x138622(0x72)]()+_0x39c1f4['slice'](0x1))]();_0x320bdd+=_0x5790d3['length'];}if(window['confirm']('Do\x20you\x20want\x20to\x20backup\x20'+_0x320bdd+_0x138622(0x93)))for(const _0x4bae0e of _0x3e10ee){const _0xed8fe7=a0_0x48be2c['list'+(_0x4bae0e[_0x138622(0xa8)](0x0)[_0x138622(0x72)]()+_0x4bae0e[_0x138622(0xa4)](0x1))]();for(const _0x32e352 of _0xed8fe7){const _0x54ba3a=await a0_0x48be2c['downloadFileInCloud'](_0x138622(0xae)+_0x4bae0e+'s/'+_0x32e352);try{await lockNoti(_0x138622(0xd1),_0x32e352,0xbb8),await dpUploadFile(_0x32e352,_0x54ba3a,_0x4bae0e);}catch(_0x3ee8ad){console[_0x138622(0xaa)](_0x138622(0xc7)+_0x32e352+':',_0x3ee8ad);}}}else console[_0x138622(0xbf)](_0x138622(0x7c));}}),dropboxCloud[_0x35d0d5(0xb5)](_0x35d0d5(0x7d),function(){var _0x4d191a=_0x35d0d5;const _0x522bd6=localStorage['getItem'](_0x4d191a(0xc2));_0x522bd6===null||_0x522bd6===''?authorizeWithDropbox():window['confirm'](_0x4d191a(0xac))&&(localStorage[_0x4d191a(0xad)](_0x4d191a(0xc2),''),dropboxRestore[_0x4d191a(0x85)][_0x4d191a(0xbc)](_0x4d191a(0x82)),dropboxBackup[_0x4d191a(0x85)][_0x4d191a(0xbc)](_0x4d191a(0x82)),dropboxCloud[_0x4d191a(0x85)][_0x4d191a(0xbc)](_0x4d191a(0x82)));}),handleDropboxCallback();});