var a0_0xa7b00=a0_0x10a3;(function(_0x200e6a,_0x2a3bbe){var _0x15ec5a=a0_0x10a3,_0x1b4fba=_0x200e6a();while(!![]){try{var _0x4d3b36=parseInt(_0x15ec5a(0x216))/0x1*(-parseInt(_0x15ec5a(0x22c))/0x2)+parseInt(_0x15ec5a(0x21f))/0x3+-parseInt(_0x15ec5a(0x1ee))/0x4+parseInt(_0x15ec5a(0x1dd))/0x5+-parseInt(_0x15ec5a(0x1fe))/0x6*(-parseInt(_0x15ec5a(0x227))/0x7)+-parseInt(_0x15ec5a(0x221))/0x8*(parseInt(_0x15ec5a(0x214))/0x9)+parseInt(_0x15ec5a(0x202))/0xa;if(_0x4d3b36===_0x2a3bbe)break;else _0x1b4fba['push'](_0x1b4fba['shift']());}catch(_0x4daf37){_0x1b4fba['push'](_0x1b4fba['shift']());}}}(a0_0x3cd1,0x594ec));import*as a0_0x3f824c from'./main.js';import{localStorageFile}from'./storage.js';var clientId=a0_0xa7b00(0x1fb),clientSecret=a0_0xa7b00(0x204);function authorizeWithDropbox(){var _0x4f0352=a0_0xa7b00,_0x60c8fe=window['location'][_0x4f0352(0x235)][_0x4f0352(0x22d)]('?')[0x0],_0xf3db=_0x4f0352(0x1d5),_0x2964a4=_0x4f0352(0x239),_0x24da84=_0x4f0352(0x1dc)+clientId+_0x4f0352(0x1f7)+_0xf3db+_0x4f0352(0x1d4)+_0x2964a4+_0x4f0352(0x1f5)+encodeURIComponent(_0x60c8fe);window[_0x4f0352(0x231)][_0x4f0352(0x235)]=_0x24da84;}function handleDropboxCallback(){var _0x5dc1e8=a0_0xa7b00,_0x2e3515=getUrlParameter('code');_0x2e3515?(getAccessToken(_0x2e3515),console[_0x5dc1e8(0x1d9)]('Authorization\x20Code:',_0x2e3515)):console[_0x5dc1e8(0x1d9)]('Do\x20not\x20receive\x20authorization');}function getUrlParameter(_0x50f085){var _0x3dc27e=a0_0xa7b00;_0x50f085=_0x50f085[_0x3dc27e(0x20a)](/[\[]/,'\x5c[')[_0x3dc27e(0x20a)](/[\]]/,'\x5c]');var _0x32c36a=new RegExp(_0x3dc27e(0x1e0)+_0x50f085+'=([^&#]*)'),_0x3f1652=_0x32c36a[_0x3dc27e(0x1ff)](location[_0x3dc27e(0x209)]);return _0x3f1652===null?'':decodeURIComponent(_0x3f1652[0x1][_0x3dc27e(0x20a)](/\+/g,'\x20'));}function getAccessToken(_0x491e00){var _0x5faa8=a0_0xa7b00,_0x34f35f=_0x5faa8(0x201),_0x241feb=window[_0x5faa8(0x231)]['href']['split']('?')[0x0],_0x29eb1f=new XMLHttpRequest();_0x29eb1f[_0x5faa8(0x1e5)](_0x5faa8(0x1ec),_0x5faa8(0x21e)),_0x29eb1f[_0x5faa8(0x20f)](_0x5faa8(0x1e9),_0x5faa8(0x1d8)),_0x29eb1f['onload']=function(){var _0x20b7e5=_0x5faa8;if(_0x29eb1f[_0x20b7e5(0x23a)]===0xc8){var _0x440c62=JSON['parse'](_0x29eb1f['responseText']),_0x43798b=_0x440c62['access_token'],_0x4a3b4a=_0x440c62[_0x20b7e5(0x233)],_0x2ad5a3=_0x440c62[_0x20b7e5(0x1fd)];localStorage['setItem'](_0x20b7e5(0x232),_0x43798b),localStorage[_0x20b7e5(0x237)](_0x20b7e5(0x1d3),_0x4a3b4a),localStorage['setItem'](_0x20b7e5(0x1ea),_0x2ad5a3);}else console[_0x20b7e5(0x1d9)](_0x20b7e5(0x1f6));},_0x29eb1f['send'](_0x5faa8(0x1e6)+_0x491e00+_0x5faa8(0x22e)+_0x34f35f+'&client_id='+clientId+_0x5faa8(0x1ef)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x241feb));}export async function dpCreateFolder(_0x55058a){var _0x1b583a=a0_0xa7b00;const _0x96b050=localStorage['getItem'](_0x1b583a(0x1ea));let _0x5c2539=localStorage[_0x1b583a(0x219)](_0x1b583a(0x232));const _0xbd00fb='/'+_0x96b050+'/'+_0x55058a,_0x16784a=JSON[_0x1b583a(0x1fc)]({'path':_0xbd00fb,'autorename':![]});for(let _0x1e3f6f=0x0;_0x1e3f6f<0x2;_0x1e3f6f++){try{const _0x11223a=await fetch('https://api.dropboxapi.com/2/files/create_folder_v2',{'method':_0x1b583a(0x1ec),'headers':{'Authorization':'Bearer\x20'+_0x5c2539,'Content-Type':'application/json'},'body':_0x16784a});if(_0x11223a[_0x1b583a(0x23a)]===0x191){const _0x15ea3e=await dpRefreshToken();if(!_0x15ea3e)throw new Error(_0x1b583a(0x1df));_0x5c2539=localStorage[_0x1b583a(0x219)]('accessToken');continue;}if(_0x11223a[_0x1b583a(0x23a)]===0x199)return{'message':_0x1b583a(0x224),'path':_0x55058a};if(!_0x11223a['ok'])throw new Error(_0x1b583a(0x1f4)+_0x55058a);const _0x151ed4=await _0x11223a[_0x1b583a(0x207)]();return await lockNoti('Folder\x20created','',0xbb8),_0x151ed4;}catch(_0x57fa33){if(_0x1e3f6f===0x1)throw _0x57fa33;}}return![];}function a0_0x10a3(_0x2bdecc,_0x5011df){var _0x3cd19b=a0_0x3cd1();return a0_0x10a3=function(_0x10a3b8,_0xbf2b21){_0x10a3b8=_0x10a3b8-0x1d3;var _0xdf4d2=_0x3cd19b[_0x10a3b8];return _0xdf4d2;},a0_0x10a3(_0x2bdecc,_0x5011df);}export async function dpRefreshToken(){var _0x3e330d=a0_0xa7b00;if(!localStorage['getItem'](_0x3e330d(0x1d3)))throw _0x3e330d(0x210);try{const _0xbcf228=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x3e330d(0x1ec),'headers':{'Content-Type':_0x3e330d(0x1d8)},'body':_0x3e330d(0x225)+localStorage[_0x3e330d(0x219)](_0x3e330d(0x1d3))+_0x3e330d(0x20c)}),_0x405b74=await _0xbcf228[_0x3e330d(0x207)]();if(!_0x405b74['error'])return localStorage[_0x3e330d(0x237)]('accessToken',_0x405b74[_0x3e330d(0x208)]),await lockNoti(_0x3e330d(0x20d),'',0xbb8),await delay(0x3e8),!![];else alert(_0x405b74[_0x3e330d(0x212)]||_0x3e330d(0x1e3));}catch(_0x436632){console['error'](_0x3e330d(0x20b),_0x436632);}return![];}export async function dpUploadFile(_0x301729,_0x114a3c,_0x5a4ca1){var _0x53c989=a0_0xa7b00;const _0x41e7ba=localStorage[_0x53c989(0x219)](_0x53c989(0x1ea));var _0x37c778=JSON[_0x53c989(0x1fc)]({'autorename':!![],'mode':_0x53c989(0x1fa),'mute':!![],'strict_conflict':![],'path':'/'+_0x41e7ba+'/'+_0x5a4ca1+'/'+_0x301729}),_0x4d917d=new Blob([_0x114a3c],{'type':_0x53c989(0x206)});for(var _0x3bddf5=0x0;_0x3bddf5<0x2;_0x3bddf5++){var _0x177de0=await fetch(_0x53c989(0x228),{'method':_0x53c989(0x1ec),'headers':{'Authorization':_0x53c989(0x236)+localStorage[_0x53c989(0x219)](_0x53c989(0x232)),'Dropbox-API-Arg':_0x37c778,'Content-Type':_0x53c989(0x206)},'body':_0x4d917d});if(_0x177de0[_0x53c989(0x23a)]!=0xc8){if(_0x177de0['status']==0x191){var _0x5f0c2a=await dpRefreshToken();if(!_0x5f0c2a)throw _0x53c989(0x1df);continue;}else throw _0x53c989(0x200)+_0x177de0[_0x53c989(0x23a)];}else{var _0x5ca041=await _0x177de0['json']();return console[_0x53c989(0x1d9)](_0x53c989(0x229),_0x301729),_0x5ca041;}}return![];}function a0_0x3cd1(){var _0xc9e2bb=['Cloud\x20↦\x20Kabu\x20storage\x20◆','overwrite','knh3uz2mx2hp2eu','stringify','uid','134016THFrHZ','exec','Upload\x20failed,\x20unknown\x20http\x20status:\x20','authorization_code','2935690trwQBY','push','nwb3dnfh09rhs31','\x20files\x20in\x20Kabu?','application/octet-stream','json','access_token','search','replace','Error\x20while\x20refreshing\x20token:','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Refreshing\x20token...','Do\x20you\x20want\x20to\x20logout?','setRequestHeader','No\x20refresh\x20token','save','error_description','confirm','15912PuUAZV','DOMContentLoaded','19246ojegLw','/data/','application/json','getItem','length','click','active','remove','https://api.dropbox.com/oauth2/token','157335GTGVPl','error','848UAEzpi','Backing\x20up...','No\x20files\x20found\x20to\x20restore.','Folder\x20already\x20exists','refresh_token=','entries','42zRqbnz','https://content.dropboxapi.com/2/files/upload','Kabu\x20storage\x20↦\x20Cloud\x20◆','blob','map','62vIwvfd','split','&grant_type=','Wait\x20a\x20little\x20bit...','folder','location','accessToken','refresh_token','Cloud\x20login\x20required!','href','Bearer\x20','setItem','Download\x20failed,\x20unknown\x20http\x20status:','offline','status','file','refreshToken','&token_access_type=','code','Do\x20you\x20want\x20to\x20restore\x20','Download\x20failed\x20for\x20','application/x-www-form-urlencoded','log','Failed\x20to\x20upload\x20file\x20','addEventListener','https://www.dropbox.com/oauth2/authorize?client_id=','3566610kJDBpT','alert','Unable\x20to\x20refresh\x20token','[\x5c?&#]','listFiles','state','Failed\x20to\x20refresh\x20Dropbox\x20token.','https://content.dropboxapi.com/2/files/download','open','code=','Do\x20you\x20want\x20to\x20backup\x20','screenshot','Content-Type','uId','https://api.dropboxapi.com/2/files/list_folder','POST','Restoring...','174056eYuNjv','&client_secret=','.tag','classList','Restore\x20canceled\x20by\x20user.','name','Error\x20creating\x20folder\x20','&redirect_uri=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','&response_type=','uploadFileInCloud'];a0_0x3cd1=function(){return _0xc9e2bb;};return a0_0x3cd1();}export async function dpDownloadFile(_0x1cfe86,_0x1d8eb6){var _0x25d52e=a0_0xa7b00;const _0x2ba6d7=localStorage[_0x25d52e(0x219)]('uId');var _0x25f421=JSON[_0x25d52e(0x1fc)]({'path':'/'+_0x2ba6d7+'/'+_0x1d8eb6+'/'+_0x1cfe86});for(var _0x5aaa=0x0;_0x5aaa<0x2;_0x5aaa++){var _0x4fcd3c=await fetch(_0x25d52e(0x1e4),{'method':_0x25d52e(0x1ec),'headers':{'Authorization':_0x25d52e(0x236)+localStorage['getItem']('accessToken'),'Dropbox-API-Arg':_0x25f421}});if(_0x4fcd3c[_0x25d52e(0x23a)]!=0xc8){if(_0x4fcd3c[_0x25d52e(0x23a)]==0x191){var _0x425857=await dpRefreshToken();if(!_0x425857)throw _0x25d52e(0x1df);continue;}else throw _0x25d52e(0x238)+_0x4fcd3c['status'];}const _0x269cb2=new File([await _0x4fcd3c[_0x25d52e(0x22a)]()],_0x1cfe86);return console['log'](_0x25d52e(0x1f9),_0x269cb2[_0x25d52e(0x1f3)]),a0_0x3f824c[_0x25d52e(0x1f8)](_0x269cb2,()=>{}),_0x269cb2;}return![];}document[a0_0xa7b00(0x1db)](a0_0xa7b00(0x215),function(){var _0xa927e=a0_0xa7b00;dropboxRestore[_0xa927e(0x1db)](_0xa927e(0x21b),async function(){var _0x468933=_0xa927e;await lockNoti(_0x468933(0x22f),'',0x1388);const _0x3da76b=localStorage[_0x468933(0x219)](_0x468933(0x1ea)),_0x2b3eb3=[_0x468933(0x1e2),'save',_0x468933(0x1e8)];if(!_0x3da76b){window[_0x468933(0x1de)](_0x468933(0x234));return;}let _0x4ec499=[];for(const _0x5014a4 of _0x2b3eb3){let _0x22bb30={'path':'/'+_0x3da76b+'/'+_0x5014a4};for(let _0x7847c4=0x0;_0x7847c4<0x2;_0x7847c4++){let _0xd32f90=await fetch(_0x468933(0x1eb),{'method':_0x468933(0x1ec),'headers':{'Authorization':_0x468933(0x236)+localStorage[_0x468933(0x219)]('accessToken'),'Content-Type':_0x468933(0x218)},'body':JSON[_0x468933(0x1fc)](_0x22bb30)});if(_0xd32f90[_0x468933(0x23a)]===0xc8){let _0x412be5=await _0xd32f90[_0x468933(0x207)](),_0x8a0295=_0x412be5[_0x468933(0x226)]['filter'](_0x32815e=>_0x32815e[_0x468933(0x1f0)]===_0x468933(0x23b));_0x8a0295['length']>0x0&&_0x4ec499[_0x468933(0x203)](..._0x8a0295[_0x468933(0x22b)](_0x5f0785=>({'name':_0x5f0785[_0x468933(0x1f3)],'folder':_0x5014a4})));break;}else{if(_0xd32f90['status']===0x191){let _0x9441ff=await dpRefreshToken();if(!_0x9441ff)throw _0x468933(0x1df);}else{console[_0x468933(0x220)](_0x468933(0x1d7)+_0x5014a4+',\x20status:\x20'+_0xd32f90[_0x468933(0x23a)]);break;}}}}if(_0x4ec499[_0x468933(0x21a)]>0x0){const _0x30972f=_0x468933(0x1d6)+_0x4ec499[_0x468933(0x21a)]+'\x20files\x20from\x20Cloud?';if(window[_0x468933(0x213)](_0x30972f))for(const _0x482a38 of _0x4ec499){await lockNoti(_0x468933(0x1ed),_0x482a38[_0x468933(0x1f3)],0xbb8),await dpDownloadFile(_0x482a38[_0x468933(0x1f3)],_0x482a38[_0x468933(0x230)]);}else console[_0x468933(0x1d9)]('Restore\x20canceled\x20by\x20user.');}else console[_0x468933(0x1d9)](_0x468933(0x223));}),dropboxBackup[_0xa927e(0x1db)]('click',async function(){var _0x5cf444=_0xa927e;await lockNoti(_0x5cf444(0x22f),'',0x1388);const _0xdfdeb0=localStorage['getItem'](_0x5cf444(0x1ea));if(_0xdfdeb0===null||_0xdfdeb0==='')window[_0x5cf444(0x1de)](_0x5cf444(0x234));else{const _0x9c608d=[_0x5cf444(0x1e2),_0x5cf444(0x211),_0x5cf444(0x1e8)];for(const _0x1c058f of _0x9c608d){await dpCreateFolder(_0x1c058f);}let _0x374847=0x0;for(const _0x4513b3 of _0x9c608d){const _0x168b1a=a0_0x3f824c['listFiles'](_0x4513b3+'s');_0x374847+=_0x168b1a[_0x5cf444(0x21a)];}if(window[_0x5cf444(0x213)](_0x5cf444(0x1e7)+_0x374847+_0x5cf444(0x205)))for(const _0x2568a3 of _0x9c608d){const _0x29a8bb=a0_0x3f824c[_0x5cf444(0x1e1)](_0x2568a3+'s');for(const _0x58a26b of _0x29a8bb){const _0x555f61=await a0_0x3f824c['downloadFileInCloud'](_0x5cf444(0x217)+_0x2568a3+'s/'+_0x58a26b);try{await lockNoti(_0x5cf444(0x222),_0x58a26b,0xbb8),await dpUploadFile(_0x58a26b,_0x555f61,_0x2568a3);}catch(_0x21e13c){console[_0x5cf444(0x220)](_0x5cf444(0x1da)+_0x58a26b+':',_0x21e13c);}}}else console[_0x5cf444(0x1d9)](_0x5cf444(0x1f2));}}),dropboxCloud[_0xa927e(0x1db)](_0xa927e(0x21b),function(){var _0x572eed=_0xa927e;const _0x40c238=localStorage[_0x572eed(0x219)](_0x572eed(0x1ea));_0x40c238===null||_0x40c238===''?authorizeWithDropbox():window[_0x572eed(0x213)](_0x572eed(0x20e))&&(localStorage['setItem'](_0x572eed(0x1ea),''),dropboxRestore[_0x572eed(0x1f1)]['remove']('active'),dropboxBackup[_0x572eed(0x1f1)]['remove']('active'),dropboxCloud[_0x572eed(0x1f1)][_0x572eed(0x21d)](_0x572eed(0x21c)));}),handleDropboxCallback();});