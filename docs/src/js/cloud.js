var a0_0x10ed70=a0_0x5de4;(function(_0x153d0f,_0x5a6d2d){var _0x76098c=a0_0x5de4,_0xfb242c=_0x153d0f();while(!![]){try{var _0x2d89f4=-parseInt(_0x76098c(0xd4))/0x1*(-parseInt(_0x76098c(0xbd))/0x2)+-parseInt(_0x76098c(0xe1))/0x3+parseInt(_0x76098c(0xe7))/0x4*(parseInt(_0x76098c(0x111))/0x5)+-parseInt(_0x76098c(0xe9))/0x6*(parseInt(_0x76098c(0xbc))/0x7)+parseInt(_0x76098c(0x107))/0x8+-parseInt(_0x76098c(0xeb))/0x9+-parseInt(_0x76098c(0xe6))/0xa*(parseInt(_0x76098c(0xb9))/0xb);if(_0x2d89f4===_0x5a6d2d)break;else _0xfb242c['push'](_0xfb242c['shift']());}catch(_0x1f2779){_0xfb242c['push'](_0xfb242c['shift']());}}}(a0_0x4c01,0x9dcd2));import*as a0_0x1c7563 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x5de4(_0x29ef57,_0x477ce2){var _0x4c016a=a0_0x4c01();return a0_0x5de4=function(_0x5de44d,_0x505576){_0x5de44d=_0x5de44d-0xb6;var _0x4bff35=_0x4c016a[_0x5de44d];return _0x4bff35;},a0_0x5de4(_0x29ef57,_0x477ce2);}var clientId='knh3uz2mx2hp2eu',clientSecret=a0_0x10ed70(0xd8);function authorizeWithDropbox(){var _0x58821b=a0_0x10ed70,_0x25646a=window['location'][_0x58821b(0xb8)][_0x58821b(0x101)]('?')[0x0],_0x5b8417=_0x58821b(0xcd),_0x3c5669=_0x58821b(0x108),_0x18e06e=_0x58821b(0xea)+clientId+_0x58821b(0xcb)+_0x5b8417+_0x58821b(0xf5)+_0x3c5669+_0x58821b(0xe3)+encodeURIComponent(_0x25646a);window[_0x58821b(0xdd)][_0x58821b(0xb8)]=_0x18e06e;}function handleDropboxCallback(){var _0x302cfd=a0_0x10ed70,_0x53577e=getUrlParameter(_0x302cfd(0xcd));_0x53577e?(getAccessToken(_0x53577e),console['log'](_0x302cfd(0xe5),_0x53577e)):console['log']('Do\x20not\x20receive\x20authorization');}function a0_0x4c01(){var _0x44e390=['Do\x20you\x20want\x20to\x20logout?','application/x-www-form-urlencoded','Cloud\x20login\x20required!','classList','Do\x20you\x20want\x20to\x20restore\x20','Restore\x20canceled\x20by\x20user.','Unable\x20to\x20refresh\x20token','&response_type=','application/json','code','error','Error\x20while\x20refreshing\x20token:','https://api.dropboxapi.com/2/files/list_folder','confirm','\x20files\x20from\x20Cloud?','Folder\x20already\x20exists','13VwISjb','click','Folder\x20created','getItem','nwb3dnfh09rhs31','filter','folder','length','POST','location','stringify','log','.tag','612432cwnudL','refreshToken','&redirect_uri=','error_description','Authorization\x20Code:','663790xcruJx','4YWlRcP','remove','6WNTbbW','https://www.dropbox.com/oauth2/authorize?client_id=','4552407fZAUyQ','exec','&client_secret=','https://api.dropboxapi.com/2/files/create_folder_v2',',\x20status:\x20','file','authorization_code','/data/','alert','Backing\x20up...','&token_access_type=','send','refresh_token=','responseText','Upload\x20failed,\x20unknown\x20http\x20status:\x20','entries','application/octet-stream','[\x5c?&#]','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Restoring...','No\x20files\x20found\x20to\x20restore.','blob','split','accessToken','setItem','json','parse','uId','6446000yCHxWV','offline','overwrite','search','setRequestHeader','push','status','screenshot','replace','Download\x20failed,\x20unknown\x20http\x20status:','5112575VBCgrI','listFiles','Cloud\x20↦\x20Kabu\x20storage\x20◆','https://content.dropboxapi.com/2/files/upload','=([^&#]*)','Wait\x20a\x20little\x20bit...','refresh_token','\x20files\x20in\x20Kabu?','Download\x20failed\x20for\x20','href','88oIyira','Bearer\x20','active','7110901dNNvbr','165374IDfjPD','Refreshing\x20token...','access_token','name','addEventListener','state','Kabu\x20storage\x20↦\x20Cloud\x20◆'];a0_0x4c01=function(){return _0x44e390;};return a0_0x4c01();}function getUrlParameter(_0x35d931){var _0x2c6337=a0_0x10ed70;_0x35d931=_0x35d931[_0x2c6337(0x10f)](/[\[]/,'\x5c[')[_0x2c6337(0x10f)](/[\]]/,'\x5c]');var _0x3ad0b1=new RegExp(_0x2c6337(0xfc)+_0x35d931+_0x2c6337(0x115)),_0x54300f=_0x3ad0b1[_0x2c6337(0xec)](location[_0x2c6337(0x10a)]);return _0x54300f===null?'':decodeURIComponent(_0x54300f[0x1][_0x2c6337(0x10f)](/\+/g,'\x20'));}function getAccessToken(_0xe58de4){var _0x4d47f3=a0_0x10ed70,_0x2590c8=_0x4d47f3(0xf1),_0x907aa3=window['location']['href']['split']('?')[0x0],_0x36399a=new XMLHttpRequest();_0x36399a['open'](_0x4d47f3(0xdc),'https://api.dropbox.com/oauth2/token'),_0x36399a[_0x4d47f3(0x10b)]('Content-Type',_0x4d47f3(0xc5)),_0x36399a['onload']=function(){var _0x160cb3=_0x4d47f3;if(_0x36399a[_0x160cb3(0x10d)]===0xc8){var _0x50dc88=JSON[_0x160cb3(0x105)](_0x36399a[_0x160cb3(0xf8)]),_0x58e2e5=_0x50dc88[_0x160cb3(0xbf)],_0x1ab4a5=_0x50dc88[_0x160cb3(0x117)],_0x3154b3=_0x50dc88['uid'];localStorage[_0x160cb3(0x103)](_0x160cb3(0x102),_0x58e2e5),localStorage[_0x160cb3(0x103)](_0x160cb3(0xe2),_0x1ab4a5),localStorage[_0x160cb3(0x103)](_0x160cb3(0x106),_0x3154b3);}else console[_0x160cb3(0xdf)]('Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token');},_0x36399a[_0x4d47f3(0xf6)]('code='+_0xe58de4+'&grant_type='+_0x2590c8+'&client_id='+clientId+_0x4d47f3(0xed)+clientSecret+'&redirect_uri='+encodeURIComponent(_0x907aa3));}export async function dpCreateFolder(_0x4a0023){var _0x55e949=a0_0x10ed70;const _0x3510b1=localStorage['getItem'](_0x55e949(0x106));let _0x4f4f50=localStorage[_0x55e949(0xd7)](_0x55e949(0x102));const _0x1f97a5='/'+_0x3510b1+'/'+_0x4a0023,_0x11a8b8=JSON[_0x55e949(0xde)]({'path':_0x1f97a5,'autorename':![]});for(let _0x5d019d=0x0;_0x5d019d<0x2;_0x5d019d++){try{const _0x31c37e=await fetch(_0x55e949(0xee),{'method':_0x55e949(0xdc),'headers':{'Authorization':'Bearer\x20'+_0x4f4f50,'Content-Type':'application/json'},'body':_0x11a8b8});if(_0x31c37e[_0x55e949(0x10d)]===0x191){const _0x183f93=await dpRefreshToken();if(!_0x183f93)throw new Error('Unable\x20to\x20refresh\x20token');_0x4f4f50=localStorage[_0x55e949(0xd7)](_0x55e949(0x102));continue;}if(_0x31c37e['status']===0x199)return{'message':_0x55e949(0xd3),'path':_0x4a0023};if(!_0x31c37e['ok'])throw new Error('Error\x20creating\x20folder\x20'+_0x4a0023);const _0x92ae18=await _0x31c37e[_0x55e949(0x104)]();return await lockNoti(_0x55e949(0xd6),'',0xbb8),_0x92ae18;}catch(_0x537cad){if(_0x5d019d===0x1)throw _0x537cad;}}return![];}export async function dpRefreshToken(){var _0x1860ab=a0_0x10ed70;if(!localStorage[_0x1860ab(0xd7)]('refreshToken'))throw'No\x20refresh\x20token';try{const _0x5d1ddb=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x1860ab(0xdc),'headers':{'Content-Type':_0x1860ab(0xc5)},'body':_0x1860ab(0xf7)+localStorage[_0x1860ab(0xd7)]('refreshToken')+_0x1860ab(0xfd)}),_0x21e1c3=await _0x5d1ddb['json']();if(!_0x21e1c3[_0x1860ab(0xce)])return localStorage[_0x1860ab(0x103)](_0x1860ab(0x102),_0x21e1c3[_0x1860ab(0xbf)]),await lockNoti(_0x1860ab(0xbe),'',0xbb8),await delay(0x3e8),!![];else alert(_0x21e1c3[_0x1860ab(0xe4)]||'Failed\x20to\x20refresh\x20Dropbox\x20token.');}catch(_0x157d56){console[_0x1860ab(0xce)](_0x1860ab(0xcf),_0x157d56);}return![];}export async function dpUploadFile(_0x28e4b3,_0x3e0de2,_0x19ad7b){var _0x7a25c4=a0_0x10ed70;const _0x4a82c4=localStorage[_0x7a25c4(0xd7)](_0x7a25c4(0x106));var _0x20a48d=JSON['stringify']({'autorename':!![],'mode':_0x7a25c4(0x109),'mute':!![],'strict_conflict':![],'path':'/'+_0x4a82c4+'/'+_0x19ad7b+'/'+_0x28e4b3}),_0x5dc8c8=new Blob([_0x3e0de2],{'type':'application/octet-stream'});for(var _0x1e0f7b=0x0;_0x1e0f7b<0x2;_0x1e0f7b++){var _0x5798af=await fetch(_0x7a25c4(0x114),{'method':_0x7a25c4(0xdc),'headers':{'Authorization':'Bearer\x20'+localStorage[_0x7a25c4(0xd7)]('accessToken'),'Dropbox-API-Arg':_0x20a48d,'Content-Type':_0x7a25c4(0xfb)},'body':_0x5dc8c8});if(_0x5798af['status']!=0xc8){if(_0x5798af[_0x7a25c4(0x10d)]==0x191){var _0x2f8a7c=await dpRefreshToken();if(!_0x2f8a7c)throw'Unable\x20to\x20refresh\x20token';continue;}else throw _0x7a25c4(0xf9)+_0x5798af[_0x7a25c4(0x10d)];}else{var _0x3ec292=await _0x5798af[_0x7a25c4(0x104)]();return console['log'](_0x7a25c4(0xc3),_0x28e4b3),_0x3ec292;}}return![];}export async function dpDownloadFile(_0x237872,_0x155834){var _0x1bf414=a0_0x10ed70;const _0x20c415=localStorage[_0x1bf414(0xd7)]('uId');var _0x4c5e00=JSON[_0x1bf414(0xde)]({'path':'/'+_0x20c415+'/'+_0x155834+'/'+_0x237872});for(var _0x3b86a6=0x0;_0x3b86a6<0x2;_0x3b86a6++){var _0x42dd99=await fetch('https://content.dropboxapi.com/2/files/download',{'method':_0x1bf414(0xdc),'headers':{'Authorization':_0x1bf414(0xba)+localStorage[_0x1bf414(0xd7)](_0x1bf414(0x102)),'Dropbox-API-Arg':_0x4c5e00}});if(_0x42dd99[_0x1bf414(0x10d)]!=0xc8){if(_0x42dd99['status']==0x191){var _0x4f7f6a=await dpRefreshToken();if(!_0x4f7f6a)throw _0x1bf414(0xca);continue;}else throw _0x1bf414(0x110)+_0x42dd99[_0x1bf414(0x10d)];}const _0x50455b=new File([await _0x42dd99[_0x1bf414(0x100)]()],_0x237872);return console['log'](_0x1bf414(0x113),_0x50455b[_0x1bf414(0xc0)]),a0_0x1c7563['uploadFileInCloud'](_0x50455b,()=>{}),_0x50455b;}return![];}document[a0_0x10ed70(0xc1)]('DOMContentLoaded',function(){var _0x4f3744=a0_0x10ed70;dropboxRestore[_0x4f3744(0xc1)](_0x4f3744(0xd5),async function(){var _0x376898=_0x4f3744;await lockNoti(_0x376898(0x116),'',0x1388);const _0x1ce457=localStorage[_0x376898(0xd7)](_0x376898(0x106)),_0xab43c7=[_0x376898(0xc2),'save',_0x376898(0x10e)];if(!_0x1ce457){window[_0x376898(0xf3)](_0x376898(0xc6));return;}let _0x26453e=[];for(const _0x34e212 of _0xab43c7){let _0x21ebe0={'path':'/'+_0x1ce457+'/'+_0x34e212};for(let _0x31f75c=0x0;_0x31f75c<0x2;_0x31f75c++){let _0x17a37f=await fetch(_0x376898(0xd0),{'method':_0x376898(0xdc),'headers':{'Authorization':_0x376898(0xba)+localStorage[_0x376898(0xd7)](_0x376898(0x102)),'Content-Type':_0x376898(0xcc)},'body':JSON[_0x376898(0xde)](_0x21ebe0)});if(_0x17a37f[_0x376898(0x10d)]===0xc8){let _0x1ad3e4=await _0x17a37f[_0x376898(0x104)](),_0x4faac4=_0x1ad3e4[_0x376898(0xfa)][_0x376898(0xd9)](_0x6e3da6=>_0x6e3da6[_0x376898(0xe0)]===_0x376898(0xf0));_0x4faac4['length']>0x0&&_0x26453e[_0x376898(0x10c)](..._0x4faac4['map'](_0x551120=>({'name':_0x551120[_0x376898(0xc0)],'folder':_0x34e212})));break;}else{if(_0x17a37f[_0x376898(0x10d)]===0x191){let _0x3b335c=await dpRefreshToken();if(!_0x3b335c)throw _0x376898(0xca);}else{console[_0x376898(0xce)](_0x376898(0xb7)+_0x34e212+_0x376898(0xef)+_0x17a37f[_0x376898(0x10d)]);break;}}}}if(_0x26453e[_0x376898(0xdb)]>0x0){const _0x579c06=_0x376898(0xc8)+_0x26453e[_0x376898(0xdb)]+_0x376898(0xd2);if(window[_0x376898(0xd1)](_0x579c06))for(const _0x41a1ad of _0x26453e){await lockNoti(_0x376898(0xfe),_0x41a1ad[_0x376898(0xc0)],0xbb8),await dpDownloadFile(_0x41a1ad['name'],_0x41a1ad[_0x376898(0xda)]);}else console[_0x376898(0xdf)](_0x376898(0xc9));}else console[_0x376898(0xdf)](_0x376898(0xff));}),dropboxBackup[_0x4f3744(0xc1)]('click',async function(){var _0x27f93a=_0x4f3744;await lockNoti(_0x27f93a(0x116),'',0x1388);const _0x2d653a=localStorage['getItem'](_0x27f93a(0x106));if(_0x2d653a===null||_0x2d653a==='')window[_0x27f93a(0xf3)](_0x27f93a(0xc6));else{const _0x1784b2=[_0x27f93a(0xc2),'save',_0x27f93a(0x10e)];for(const _0x4dc7f3 of _0x1784b2){await dpCreateFolder(_0x4dc7f3);}let _0x53c66b=0x0;for(const _0x47f471 of _0x1784b2){const _0x115795=a0_0x1c7563[_0x27f93a(0x112)](_0x47f471+'s');_0x53c66b+=_0x115795['length'];}if(window[_0x27f93a(0xd1)]('Do\x20you\x20want\x20to\x20backup\x20'+_0x53c66b+_0x27f93a(0xb6)))for(const _0x409274 of _0x1784b2){const _0x29ed32=a0_0x1c7563[_0x27f93a(0x112)](_0x409274+'s');for(const _0x424881 of _0x29ed32){const _0x4dac48=await a0_0x1c7563['downloadFileInCloud'](_0x27f93a(0xf2)+_0x409274+'s/'+_0x424881);try{await lockNoti(_0x27f93a(0xf4),_0x424881,0xbb8),await dpUploadFile(_0x424881,_0x4dac48,_0x409274);}catch(_0x43e5d3){console[_0x27f93a(0xce)]('Failed\x20to\x20upload\x20file\x20'+_0x424881+':',_0x43e5d3);}}}else console['log']('Restore\x20canceled\x20by\x20user.');}}),dropboxCloud[_0x4f3744(0xc1)]('click',function(){var _0x257872=_0x4f3744;const _0x5ed51a=localStorage[_0x257872(0xd7)](_0x257872(0x106));_0x5ed51a===null||_0x5ed51a===''?authorizeWithDropbox():window['confirm'](_0x257872(0xc4))&&(localStorage[_0x257872(0x103)](_0x257872(0x106),''),dropboxRestore[_0x257872(0xc7)][_0x257872(0xe8)](_0x257872(0xbb)),dropboxBackup[_0x257872(0xc7)]['remove'](_0x257872(0xbb)),dropboxCloud[_0x257872(0xc7)][_0x257872(0xe8)]('active'));}),handleDropboxCallback();});