var a0_0x41c615=a0_0x46b8;(function(_0x4b6805,_0x424bac){var _0x4ceeba=a0_0x46b8,_0x87e5da=_0x4b6805();while(!![]){try{var _0x334d8b=-parseInt(_0x4ceeba(0x199))/0x1+parseInt(_0x4ceeba(0x1dd))/0x2+-parseInt(_0x4ceeba(0x1f9))/0x3+parseInt(_0x4ceeba(0x1d8))/0x4+-parseInt(_0x4ceeba(0x1df))/0x5*(-parseInt(_0x4ceeba(0x1ad))/0x6)+parseInt(_0x4ceeba(0x1c0))/0x7+-parseInt(_0x4ceeba(0x1e1))/0x8*(parseInt(_0x4ceeba(0x1b6))/0x9);if(_0x334d8b===_0x424bac)break;else _0x87e5da['push'](_0x87e5da['shift']());}catch(_0x57cfad){_0x87e5da['push'](_0x87e5da['shift']());}}}(a0_0xbdbb,0x5af6b));import*as a0_0x40aa55 from'./main.js';import{localStorageFile}from'./storage.js';function a0_0x46b8(_0x5997fe,_0x421790){var _0xbdbbe4=a0_0xbdbb();return a0_0x46b8=function(_0x46b82d,_0x39dcda){_0x46b82d=_0x46b82d-0x184;var _0x230b91=_0xbdbbe4[_0x46b82d];return _0x230b91;},a0_0x46b8(_0x5997fe,_0x421790);}var clientId=a0_0x41c615(0x189),clientSecret=a0_0x41c615(0x1ac);function authorizeWithDropbox(){var _0x59e7a8=a0_0x41c615,_0x477f61=window['location'][_0x59e7a8(0x188)][_0x59e7a8(0x1d3)]('?')[0x0],_0x452e5=_0x59e7a8(0x1c4),_0x5337ad='offline',_0x44d0e0=_0x59e7a8(0x1c9)+clientId+_0x59e7a8(0x1db)+_0x452e5+_0x59e7a8(0x1a0)+_0x5337ad+_0x59e7a8(0x1bb)+encodeURIComponent(_0x477f61);window[_0x59e7a8(0x190)][_0x59e7a8(0x188)]=_0x44d0e0;}function handleDropboxCallback(){var _0x3e658f=a0_0x41c615,_0x4f055f=getUrlParameter(_0x3e658f(0x1c4));_0x4f055f?(getAccessToken(_0x4f055f),console[_0x3e658f(0x1e8)](_0x3e658f(0x18d),_0x4f055f)):console[_0x3e658f(0x1e8)](_0x3e658f(0x198));}function getUrlParameter(_0x22161e){var _0x218804=a0_0x41c615;_0x22161e=_0x22161e[_0x218804(0x1eb)](/[\[]/,'\x5c[')['replace'](/[\]]/,'\x5c]');var _0x2a3d95=new RegExp(_0x218804(0x1c7)+_0x22161e+'=([^&#]*)'),_0xef634f=_0x2a3d95[_0x218804(0x1ae)](location[_0x218804(0x197)]);return _0xef634f===null?'':decodeURIComponent(_0xef634f[0x1][_0x218804(0x1eb)](/\+/g,'\x20'));}function getAccessToken(_0xf6d048){var _0x1d902c=a0_0x41c615,_0x5504b7='authorization_code',_0x3a4b9e=window[_0x1d902c(0x190)][_0x1d902c(0x188)][_0x1d902c(0x1d3)]('?')[0x0],_0x1d0b0a=new XMLHttpRequest();_0x1d0b0a[_0x1d902c(0x1a4)]('POST','https://api.dropbox.com/oauth2/token'),_0x1d0b0a['setRequestHeader']('Content-Type','application/x-www-form-urlencoded'),_0x1d0b0a[_0x1d902c(0x1e5)]=function(){var _0x1492b9=_0x1d902c;if(_0x1d0b0a[_0x1492b9(0x18b)]===0xc8){var _0x5a4721=JSON[_0x1492b9(0x1ba)](_0x1d0b0a['responseText']),_0x5a6f31=_0x5a4721[_0x1492b9(0x19e)],_0x5098cb=_0x5a4721[_0x1492b9(0x18f)],_0x28208f=_0x5a4721['uid'];localStorage[_0x1492b9(0x1d9)](_0x1492b9(0x1d0),_0x5a6f31),localStorage[_0x1492b9(0x1d9)]('refreshToken',_0x5098cb),localStorage['setItem'](_0x1492b9(0x19d),_0x28208f);}else console[_0x1492b9(0x1e8)](_0x1492b9(0x1ca));},_0x1d0b0a[_0x1d902c(0x193)](_0x1d902c(0x1be)+_0xf6d048+_0x1d902c(0x1b8)+_0x5504b7+_0x1d902c(0x1a9)+clientId+_0x1d902c(0x19a)+clientSecret+_0x1d902c(0x1bb)+encodeURIComponent(_0x3a4b9e));}export async function dpRefreshToken(){var _0x51e027=a0_0x41c615;if(!localStorage[_0x51e027(0x1ed)](_0x51e027(0x1f8)))throw _0x51e027(0x1cd);try{const _0x19c965=await fetch('https://api.dropboxapi.com/oauth2/token',{'method':_0x51e027(0x191),'headers':{'Content-Type':_0x51e027(0x1a2)},'body':_0x51e027(0x19b)+localStorage[_0x51e027(0x1ed)](_0x51e027(0x1f8))+_0x51e027(0x18c)}),_0x3f8c1c=await _0x19c965[_0x51e027(0x1e3)]();if(!_0x3f8c1c['error'])return localStorage['setItem'](_0x51e027(0x1d0),_0x3f8c1c[_0x51e027(0x19e)]),await lockNoti('',_0x51e027(0x187),0xbb8),await delay(0x3e8),!![];else alert(_0x3f8c1c[_0x51e027(0x1cc)]||_0x51e027(0x1e9));}catch(_0x5cdf56){console['error'](_0x51e027(0x1a7),_0x5cdf56);}return![];}export async function dpUploadFile(_0x403b28,_0x163580){var _0xb4c6cb=a0_0x41c615;const _0x149eca=localStorage[_0xb4c6cb(0x1ed)](_0xb4c6cb(0x19d));var _0x3a2c04=JSON[_0xb4c6cb(0x1a5)]({'autorename':!![],'mode':_0xb4c6cb(0x1d2),'mute':!![],'strict_conflict':![],'path':'/'+_0x149eca+'/'+_0x403b28}),_0x270b58=new Blob([_0x163580],{'type':_0xb4c6cb(0x1e2)});for(var _0x22c7a0=0x0;_0x22c7a0<0x2;_0x22c7a0++){var _0x1d977f=await fetch(_0xb4c6cb(0x1c2),{'method':_0xb4c6cb(0x191),'headers':{'Authorization':_0xb4c6cb(0x1b1)+localStorage[_0xb4c6cb(0x1ed)](_0xb4c6cb(0x1d0)),'Dropbox-API-Arg':_0x3a2c04,'Content-Type':_0xb4c6cb(0x1e2)},'body':_0x270b58});if(_0x1d977f[_0xb4c6cb(0x18b)]!=0xc8){if(_0x1d977f['status']==0x191){var _0x3978b1=await dpRefreshToken();if(!_0x3978b1)throw _0xb4c6cb(0x1c6);continue;}else throw'Upload\x20failed,\x20unknown\x20http\x20status:\x20'+_0x1d977f[_0xb4c6cb(0x18b)];}else{var _0x3c2384=await _0x1d977f[_0xb4c6cb(0x1e3)]();return console[_0xb4c6cb(0x1e8)](_0xb4c6cb(0x1f0),_0x403b28),_0x3c2384;}}return![];}async function dpDownloadFile(_0x51a4d8){var _0x40e333=a0_0x41c615;const _0x492aa5=localStorage['getItem'](_0x40e333(0x19d));var _0x5cde45=JSON[_0x40e333(0x1a5)]({'path':'/'+_0x492aa5+'/'+_0x51a4d8});for(var _0x2b4724=0x0;_0x2b4724<0x2;_0x2b4724++){var _0x1a92dd=await fetch(_0x40e333(0x1c5),{'method':_0x40e333(0x191),'headers':{'Authorization':_0x40e333(0x1b1)+localStorage[_0x40e333(0x1ed)](_0x40e333(0x1d0)),'Dropbox-API-Arg':_0x5cde45}});if(_0x1a92dd[_0x40e333(0x18b)]!=0xc8){if(_0x1a92dd[_0x40e333(0x18b)]==0x191){var _0x5a7744=await dpRefreshToken();if(!_0x5a7744)throw _0x40e333(0x1c6);continue;}else throw _0x40e333(0x19f)+_0x1a92dd['status'];}const _0x451d1d=new File([await _0x1a92dd[_0x40e333(0x184)]()],_0x51a4d8);console[_0x40e333(0x1e8)](_0x40e333(0x1e0),_0x451d1d[_0x40e333(0x1a8)]);if(_0x51a4d8[_0x40e333(0x1f4)](_0x40e333(0x1cb))){const _0x50194b=await _0x451d1d[_0x40e333(0x1ef)](),[_0x3cdcf4,_0x32ce88]=_0x50194b['split']('\x0a\x0a'),_0x5d1793=_0x51a4d8[_0x40e333(0x1de)](0x0,_0x51a4d8[_0x40e333(0x1b2)](_0x40e333(0x1b3))+0x3),_0x1eca0d=_0x51a4d8['charAt'](_0x51a4d8['length']-0x5);localStorage[_0x40e333(0x1d9)](_0x5d1793+_0x40e333(0x1f6)+_0x1eca0d,_0x32ce88),localStorage[_0x40e333(0x1d9)](_0x5d1793+_0x40e333(0x192)+_0x1eca0d,_0x3cdcf4);}else a0_0x40aa55[_0x40e333(0x1f1)](_0x451d1d,()=>{var _0x214188=_0x40e333;localStorageFile(),Module[_0x214188(0x1b4)]();});return _0x451d1d;}return![];}document['addEventListener']('DOMContentLoaded',function(){var _0x25ce02=a0_0x41c615;dropboxRestore[_0x25ce02(0x1ce)](_0x25ce02(0x1af),async function(){var _0x210ccc=_0x25ce02;const _0x5da76b=localStorage[_0x210ccc(0x1ed)]('uId');if(_0x5da76b===null||_0x5da76b==='')window[_0x210ccc(0x1da)](_0x210ccc(0x185));else{var _0x5ec0b9={'path':'/'+_0x5da76b};for(var _0x48991b=0x0;_0x48991b<0x2;_0x48991b++){var _0xa84b7=await fetch(_0x210ccc(0x1e7),{'method':'POST','headers':{'Authorization':'Bearer\x20'+localStorage[_0x210ccc(0x1ed)](_0x210ccc(0x1d0)),'Content-Type':_0x210ccc(0x1b7)},'body':JSON[_0x210ccc(0x1a5)](_0x5ec0b9)});console[_0x210ccc(0x1e8)]('status:\x20',_0xa84b7[_0x210ccc(0x18b)]);if(_0xa84b7['status']!=0xc8){if(_0xa84b7[_0x210ccc(0x18b)]==0x191){var _0x479dc3=await dpRefreshToken();if(!_0x479dc3)throw _0x210ccc(0x1c6);continue;}else throw _0x210ccc(0x1cf)+_0xa84b7['status'];}else{const _0x19dfdd=await _0xa84b7[_0x210ccc(0x1e3)](),_0x51bd1a=_0x19dfdd['entries'][_0x210ccc(0x1ee)](_0x571ca7=>_0x571ca7[_0x210ccc(0x1bd)]===_0x210ccc(0x186))['length'],_0x444348=_0x210ccc(0x196)+_0x51bd1a+_0x210ccc(0x1d6);if(window[_0x210ccc(0x1b5)](_0x444348))for(const _0x46e12c of _0x19dfdd[_0x210ccc(0x1c1)]){_0x46e12c['.tag']===_0x210ccc(0x186)&&(await lockNoti('Restoring...',_0x46e12c[_0x210ccc(0x1a8)],0xbb8),await dpDownloadFile(_0x46e12c[_0x210ccc(0x1a8)]));}else console[_0x210ccc(0x1e8)](_0x210ccc(0x1d7));return!![];}}return![];}}),dropboxBackup[_0x25ce02(0x1ce)](_0x25ce02(0x1af),async function(){var _0x39b303=_0x25ce02;const _0x4c57ea=localStorage[_0x39b303(0x1ed)]('uId');if(_0x4c57ea===null||_0x4c57ea==='')window[_0x39b303(0x1da)](_0x39b303(0x185));else{const _0x5bdedb=[_0x39b303(0x1dc),_0x39b303(0x1aa)];let _0x3a6605=0x0;for(const _0x2d9ab0 of _0x5bdedb){const _0x51530e=a0_0x40aa55[_0x39b303(0x1e6)+(_0x2d9ab0[_0x39b303(0x1a1)](0x0)['toUpperCase']()+_0x2d9ab0[_0x39b303(0x1f2)](0x1))]();_0x3a6605+=_0x51530e[_0x39b303(0x1bf)];}if(window[_0x39b303(0x1b5)](_0x39b303(0x1a6)+_0x3a6605+_0x39b303(0x1e4)))for(const _0xd7fbdc of _0x5bdedb){const _0x2f7813=a0_0x40aa55[_0x39b303(0x1e6)+(_0xd7fbdc[_0x39b303(0x1a1)](0x0)[_0x39b303(0x1d4)]()+_0xd7fbdc[_0x39b303(0x1f2)](0x1))]();for(const _0x42d59a of _0x2f7813){const _0x3ffabe=await a0_0x40aa55[_0x39b303(0x1ab)](_0x39b303(0x1b0)+_0xd7fbdc+'s/'+_0x42d59a);try{await lockNoti('Backing\x20up...',_0x42d59a,0xbb8),await dpUploadFile(_0x42d59a,_0x3ffabe);if(_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x1ea))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x194))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x18e))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x19c))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x18a))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x1a3))||_0x42d59a['endsWith'](_0x39b303(0x1bc))||_0x42d59a[_0x39b303(0x1f4)](_0x39b303(0x1d1))){const _0x1b6de9=_0x42d59a[_0x39b303(0x1de)](0x0,_0x42d59a['lastIndexOf']('.')),_0xb8ad85=_0x42d59a['charAt'](_0x42d59a[_0x39b303(0x1bf)]-0x1),_0x1527d4=localStorage[_0x39b303(0x1ed)](_0x1b6de9+_0x39b303(0x1f7)+_0xb8ad85),_0xf4482e=localStorage[_0x39b303(0x1ed)](_0x1b6de9+_0x39b303(0x1ec)+_0xb8ad85);if(_0x1527d4!==null){const _0xf5a9b7=_0x1527d4+'\x0a\x0a'+_0xf4482e,_0x46bb4e=new Blob([_0xf5a9b7],{'type':_0x39b303(0x1f5)});await lockNoti('Backing\x20up...',_0x1b6de9+_0x39b303(0x1d5)+_0xb8ad85+_0x39b303(0x1cb),0xbb8),await dpUploadFile(_0x1b6de9+_0x39b303(0x1d5)+_0xb8ad85+_0x39b303(0x1cb),_0x46bb4e);}}}catch(_0x8a8a22){console['error'](_0x39b303(0x1f3)+_0x42d59a+':',_0x8a8a22);}}}else console[_0x39b303(0x1e8)](_0x39b303(0x1d7));}}),dropboxCloud[_0x25ce02(0x1ce)]('click',function(){var _0x385eb9=_0x25ce02;const _0x415d1b=localStorage[_0x385eb9(0x1ed)](_0x385eb9(0x19d));_0x415d1b===null||_0x415d1b===''?authorizeWithDropbox():window[_0x385eb9(0x1b5)](_0x385eb9(0x1b9))&&(localStorage['setItem']('uId',''),dropboxRestore[_0x385eb9(0x195)][_0x385eb9(0x1c3)](_0x385eb9(0x1c8)),dropboxBackup['classList'][_0x385eb9(0x1c3)]('active'),dropboxCloud[_0x385eb9(0x195)]['remove'](_0x385eb9(0x1c8)));}),handleDropboxCallback();});function a0_0xbdbb(){var _0xef41b1=['Do\x20you\x20want\x20to\x20restore\x20','search','Do\x20not\x20receive\x20authorization','262391TfjZNi','&client_secret=','refresh_token=','.ss3','uId','access_token','Download\x20failed,\x20unknown\x20http\x20status:','&token_access_type=','charAt','application/x-www-form-urlencoded','.ss5','open','stringify','Do\x20you\x20want\x20to\x20backup\x20','Error\x20while\x20refreshing\x20token:','name','&client_id=','save','downloadFileInCloud','nwb3dnfh09rhs31','66vdSJDA','exec','click','/data/','Bearer\x20','lastIndexOf','gba','FSSync','confirm','3113874lCHyyM','application/json','&grant_type=','Do\x20you\x20want\x20to\x20logout?','parse','&redirect_uri=','.ss6','.tag','code=','length','3609725PnCNsE','entries','https://content.dropboxapi.com/2/files/upload','remove','code','https://content.dropboxapi.com/2/files/download','Unable\x20to\x20refresh\x20token','[\x5c?&#]','active','https://www.dropbox.com/oauth2/authorize?client_id=','Do\x20not\x20receive\x20access\x20token\x20&\x20refresh\x20token','.txt','error_description','No\x20refresh\x20token','addEventListener','Download\x20failed,\x20unknown\x20http\x20status:\x20','accessToken','.ss7','overwrite','split','toUpperCase','.gba_slot','\x20files\x20in\x20Cloud?','Restore\x20canceled\x20by\x20user.','492644scIrId','setItem','alert','&response_type=','state','741514lISmba','substring','275875yGOmkC','Cloud\x20↦\x20Kabu\x20storage\x20◆','8BbdjFj','application/octet-stream','json','\x20files\x20in\x20Kabu?','onload','list','https://api.dropboxapi.com/2/files/list_folder','log','Failed\x20to\x20refresh\x20Dropbox\x20token.','.ss0','replace','.gba_dateState','getItem','filter','text','Kabu\x20storage\x20↦\x20Cloud\x20◆','uploadSaveOrSaveState','slice','Failed\x20to\x20upload\x20file\x20','endsWith','text/plain','_dateState','.gba_imageState','refreshToken','1906662xjyCvg','blob','Cloud\x20login\x20required!','file','Refreshing\x20token...','href','knh3uz2mx2hp2eu','.ss4','status','&grant_type=refresh_token&client_id=knh3uz2mx2hp2eu&client_secret=nwb3dnfh09rhs31','Authorization\x20Code:','.ss2','refresh_token','location','POST','_imageState','send','.ss1','classList'];a0_0xbdbb=function(){return _0xef41b1;};return a0_0xbdbb();}