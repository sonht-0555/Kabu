const a0_0x35b581=a0_0x28c8;(function(_0xc0e62f,_0x8d5844){const _0x56885d=a0_0x28c8,_0x2d30ad=_0xc0e62f();while(!![]){try{const _0x4927ed=parseInt(_0x56885d(0x192))/0x1*(-parseInt(_0x56885d(0x1ab))/0x2)+-parseInt(_0x56885d(0x1b1))/0x3+-parseInt(_0x56885d(0x173))/0x4+-parseInt(_0x56885d(0x181))/0x5*(-parseInt(_0x56885d(0x18b))/0x6)+parseInt(_0x56885d(0x16d))/0x7+-parseInt(_0x56885d(0x156))/0x8+parseInt(_0x56885d(0x16b))/0x9;if(_0x4927ed===_0x8d5844)break;else _0x2d30ad['push'](_0x2d30ad['shift']());}catch(_0x458c25){_0x2d30ad['push'](_0x2d30ad['shift']());}}}(a0_0x4e0b,0xbd23d));import a0_0x2c4f67 from'../core/mgba.js';import*as a0_0x10fa80 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0x35b581(0x165))};function initializeCore(_0x3c8e76,_0x3ef1ba){_0x3c8e76(_0x3ef1ba)['then'](function(_0xfb4eef){const _0x57595b=a0_0x28c8;_0xfb4eef[_0x57595b(0x177)]();});}initializeCore(a0_0x2c4f67,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x35b581(0x188)](a0_0x35b581(0x165)),savedTurboState=localStorage[a0_0x35b581(0x163)]('turboState'),controlSetting=document[a0_0x35b581(0x188)](a0_0x35b581(0x1b0));function handleVisibilityChange(_0x5243de){const _0x2b6098=a0_0x35b581;document[_0x2b6098(0x17f)]===_0x2b6098(0x18c)||_0x5243de?.[_0x2b6098(0x14f)]===_0x2b6098(0x1a3)||_0x5243de?.[_0x2b6098(0x1a8)]?(pauseGame(),canvas[_0x2b6098(0x15f)][_0x2b6098(0x1a5)](_0x2b6098(0x15d))):(setTimeout(()=>{canvas['classList']['remove']('visible');},0x258),controlSetting[_0x2b6098(0x15f)][_0x2b6098(0x193)]('visible')&&resumeGame());}async function statusShow(){const _0x518dd3=a0_0x35b581;document[_0x518dd3(0x151)](_0x518dd3(0x159),handleVisibilityChange),document[_0x518dd3(0x151)](_0x518dd3(0x1a0),handleVisibilityChange),window[_0x518dd3(0x151)](_0x518dd3(0x1a3),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x10fa80[_0x518dd3(0x194)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x518dd3(0x163)](_0x518dd3(0x17c)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x36569d=a0_0x35b581;await ledSave(_0x36569d(0x19a)),await Module[_0x36569d(0x15e)](0x0),await Module['FSSync'](),await screenShot(0x0),console[_0x36569d(0x15b)](_0x36569d(0x187)+ ++countAutoSave+_0x36569d(0x1aa));}async function saveStateInCloud(){const _0x7696d6=a0_0x35b581,_0x594f76=localStorage[_0x7696d6(0x163)](_0x7696d6(0x162)),_0x3f4711=_0x594f76[_0x7696d6(0x189)](_0x7696d6(0x1a6),_0x7696d6(0x175)),_0x45ee48=localStorage['getItem'](_0x7696d6(0x168)),_0x3998ab=localStorage[_0x7696d6(0x163)](_0x594f76+'_imageState0'),_0x54ae8c=localStorage['getItem'](_0x594f76+_0x7696d6(0x1a9));if(navigator[_0x7696d6(0x1a7)]){if(_0x45ee48){await ledSave(_0x7696d6(0x184)),await delay(0x3e8),await dpUploadFile(_0x3f4711,Module['downloadFile'](_0x7696d6(0x16f)+_0x3f4711));if(_0x3998ab!==null){const _0x492751=_0x3998ab+'\x0a\x0a'+_0x54ae8c,_0x141480=new Blob([_0x492751],{'type':'text/plain'});await dpUploadFile(_0x594f76+_0x7696d6(0x152),_0x141480);}else console[_0x7696d6(0x15b)](_0x7696d6(0x17d));await lockNoti('',_0x7696d6(0x161)+ ++countUpload+_0x7696d6(0x1aa),0x7d0);}else console[_0x7696d6(0x15b)](_0x7696d6(0x170));}else console[_0x7696d6(0x15b)](_0x7696d6(0x196));}function startTimer(){let [_0x5a879b,_0x4ec8f7,_0x5593c7,_0x1ebd04,_0x526f3d]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x4237c3=a0_0x28c8;_0x5593c7++,_0x1ebd04++,_0x526f3d++;if(_0x5593c7===0x3c)[_0x5593c7,_0x4ec8f7]=[0x0,_0x4ec8f7+0x1];if(_0x4ec8f7===0x3c)[_0x4ec8f7,_0x5a879b]=[0x0,_0x5a879b+0x1];document[_0x4237c3(0x188)]('timer')[_0x4237c3(0x19d)]=_0x5a879b+'h'+_0x4ec8f7[_0x4237c3(0x185)]()[_0x4237c3(0x191)](0x2,'0')+'.'+_0x5593c7[_0x4237c3(0x185)]()['padStart'](0x2,'0');_0x1ebd04===0x3c&&(saveStatePeriodically(),_0x1ebd04=0x0);;_0x1ebd04===0xe10&&(saveStateInCloud(),_0x526f3d=0x0);;},0x3e8);}export async function uploadGame(_0xbf95d){const _0x544749=a0_0x35b581,_0xce1690=_0xbf95d[_0x544749(0x17e)][0x0];Module[_0x544749(0x1a1)](_0xce1690,()=>{const _0x57b9c3=_0x544749;Module[_0x57b9c3(0x166)]();});}export async function loadGame(_0x3074ea){const _0x43b45d=a0_0x35b581,_0x24e43f=_0x3074ea[_0x43b45d(0x189)](/\.(gba|gbc|gb|zip)$/,_0x43b45d(0x175)),_0x7840a3=Module[_0x43b45d(0x18e)]();intro['classList'][_0x43b45d(0x1a5)](_0x43b45d(0x171)),errorLogElements[0x0]['style'][_0x43b45d(0x14d)]='0',ingame[_0x43b45d(0x15f)]['remove'](_0x43b45d(0x171)),_0x3074ea[_0x43b45d(0x164)](_0x43b45d(0x19c))||_0x3074ea[_0x43b45d(0x164)](_0x43b45d(0x16c))?(canvas['classList'][_0x43b45d(0x1a5)]('gbc'),areaTrans[_0x43b45d(0x15f)][_0x43b45d(0x1a5)](_0x43b45d(0x18d)),localStorage[_0x43b45d(0x157)](_0x43b45d(0x15c),'0,0,'+(window['innerWidth']-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x43b45d(0x157)]('screenSize',_0x43b45d(0x198)+(window[_0x43b45d(0x16e)]-0x96)+','+(window[_0x43b45d(0x16e)]-0x96)*0x2/0x3),_0x7840a3[_0x43b45d(0x1ac)](_0x24e43f)?(await Module[_0x43b45d(0x17a)](_0x43b45d(0x178)+_0x3074ea),confirm(_0x43b45d(0x19e))&&(await Module['loadState'](0x0),localStorage[_0x43b45d(0x157)](_0x43b45d(0x162),_0x3074ea),console[_0x43b45d(0x15b)](_0x3074ea))):(await Module['loadGame'](_0x43b45d(0x178)+_0x3074ea),localStorage[_0x43b45d(0x157)](_0x43b45d(0x162),_0x3074ea)),await statusShow();}export async function saveState(_0xdec7a8){const _0x5a10=a0_0x35b581;await Module['saveState'](_0xdec7a8),await Module[_0x5a10(0x166)]();}export async function loadState(_0x12fb1c){const _0x366e3d=a0_0x35b581;await Module[_0x366e3d(0x180)](_0x12fb1c);}export async function downloadFile(_0x56917f,_0x4f8568){const _0x5265e7=a0_0x35b581,_0x2eb153=Module[_0x5265e7(0x1af)](_0x56917f),_0x4b039c=document[_0x5265e7(0x158)]('a');document[_0x5265e7(0x1ae)]['appendChild'](_0x4b039c),_0x4b039c['download']=_0x4f8568;const _0x3f0b6d=new Blob([_0x2eb153],{'type':_0x5265e7(0x172)});_0x4b039c[_0x5265e7(0x190)]=URL[_0x5265e7(0x1b2)](_0x3f0b6d),_0x4b039c[_0x5265e7(0x195)](),URL[_0x5265e7(0x1a2)](_0x3f0b6d),_0x4b039c[_0x5265e7(0x150)]();}export function downloadFileInCloud(_0x9205a){const _0x582b44=a0_0x35b581,_0xb7c46c=Module[_0x582b44(0x1af)](_0x9205a);return _0xb7c46c;}export async function uploadFile(_0x178555){const _0x416c01=a0_0x35b581,_0x30fb75=_0x178555[_0x416c01(0x17e)][0x0];Module['uploadSaveOrSaveState'](_0x30fb75,()=>{const _0xa8d2fa=_0x416c01;Module[_0xa8d2fa(0x166)]();});}export async function editFile(_0x595d3d,_0x4b935a,_0x1491e2){await Module['editFileName'](_0x595d3d,_0x4b935a,_0x1491e2),await Module['FSSync']();}export async function deleteFile(_0x2a06ee){const _0x278c96=a0_0x35b581;await Module['deleteFile'](_0x2a06ee),await Module[_0x278c96(0x166)]();}function a0_0x28c8(_0xf380e2,_0x12922e){const _0x4e0bf3=a0_0x4e0b();return a0_0x28c8=function(_0x28c84e,_0x25d578){_0x28c84e=_0x28c84e-0x14c;let _0x1a9f5f=_0x4e0bf3[_0x28c84e];return _0x1a9f5f;},a0_0x28c8(_0xf380e2,_0x12922e);}export function listGame(){const _0x44e227=a0_0x35b581,_0x12b1de=Module[_0x44e227(0x199)]();return _0x12b1de;}export function listSave(){const _0x48e885=a0_0x35b581,_0x451151=Module[_0x48e885(0x169)]();return _0x451151;}export function listState(){const _0x24d666=a0_0x35b581,_0x21d11f=Module[_0x24d666(0x18e)]();return _0x21d11f;}export function listCheat(){const _0x4880f9=a0_0x35b581,_0x300fe5=Module[_0x4880f9(0x154)]();return _0x300fe5;}export function listScreenshot(){const _0x1f8897=a0_0x35b581,_0x25fa33=Module[_0x1f8897(0x19b)]();return _0x25fa33;}export function fileSize(_0x1efa90){const _0x31abb4=a0_0x35b581,_0x391a18=Module[_0x31abb4(0x160)](_0x1efa90);return _0x391a18;}export async function uploadCheat(_0x376e4f){const _0x3ac3d1=a0_0x35b581;try{const _0x34d2ee=_0x376e4f[_0x3ac3d1(0x17e)][0x0];await Module[_0x3ac3d1(0x167)](_0x34d2ee,()=>{const _0x5b84a0=_0x3ac3d1;console[_0x5b84a0(0x15b)](_0x5b84a0(0x14e),_0x34d2ee[_0x5b84a0(0x1a4)]),localStorageFile(),Module[_0x5b84a0(0x166)]();});}catch(_0x1af8b1){console[_0x3ac3d1(0x197)](_0x3ac3d1(0x179),_0x1af8b1);}}export async function uploadSavSta(_0x4576c5){const _0x2db9cd=a0_0x35b581;try{const _0x19fcb5=_0x4576c5[_0x2db9cd(0x17e)][0x0];await Module[_0x2db9cd(0x153)](_0x19fcb5,()=>{const _0x5b8999=_0x2db9cd;console[_0x5b8999(0x15b)]('Save/State\x20uploaded\x20successfully:',_0x19fcb5[_0x5b8999(0x1a4)]),localStorageFile(),Module[_0x5b8999(0x166)]();});}catch(_0x21c4a0){console[_0x2db9cd(0x197)]('Error\x20uploadSavSta:',_0x21c4a0);}}export async function uploadSaveOrSaveState(_0x458fe7){const _0x481f30=a0_0x35b581;Module[_0x481f30(0x153)](_0x458fe7,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0x2ac6ff=a0_0x35b581;Module[_0x2ac6ff(0x186)](),Module['SDL2'](),notiMessage(_0x2ac6ff(0x18f),0x7d0);}export async function pauseGame(){const _0x2932ea=a0_0x35b581;Module[_0x2932ea(0x183)](),Module[_0x2932ea(0x19f)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x57008b){Module['buttonPress'](_0x57008b);}export async function buttonUnpress(_0xc5e174){const _0x2f30fc=a0_0x35b581;Module[_0x2f30fc(0x15a)](_0xc5e174);}export async function screenShot(_0x1cf5ef){const _0x2fa00d=a0_0x35b581,_0xebc6c8=localStorage[_0x2fa00d(0x163)](_0x2fa00d(0x162)),_0x41fe92=_0xebc6c8['replace'](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x2fa00d(0x155)](''+_0x41fe92+_0x1cf5ef+_0x2fa00d(0x14c)),await Module['FSSync']();const _0x45ee4a=await fileToBase64(Module[_0x2fa00d(0x1af)](_0x2fa00d(0x182)+_0x41fe92+_0x1cf5ef+'.png')),_0x13eb16=Date[_0x2fa00d(0x18a)](),_0x163e2c=formatDateTime(_0x13eb16);localStorage[_0x2fa00d(0x157)](_0xebc6c8+_0x2fa00d(0x17b)+_0x1cf5ef,_0x163e2c),localStorage['setItem'](_0xebc6c8+_0x2fa00d(0x1ad)+_0x1cf5ef,_0x45ee4a);}function a0_0x4e0b(){const _0x5c908c=['href','padStart','1WbjwMK','contains','turboF','click','Online!','error','0,0,','listGames','#20A5A6','listScreenshots','.gbc','textContent','Do\x20you\x20want\x20to\x20load\x20save\x20state?','SDL2','visibilitychange','uploadRom','revokeObjectURL','beforeunload','name','add','.gba','onLine','persisted','_dateState0','\x20time(s)','859120iWTNmm','includes','_imageState','body','downloadFile','control-setting','4276095dAzqCq','createObjectURL','.png','bottom','Cheat\x20uploaded\x20successfully:','type','remove','addEventListener','_slot0.txt','uploadSaveOrSaveState','listCheats','screenshot','8027448SZKAhT','setItem','createElement','pagehide','buttonUnpress','log','screenSize','visible','saveState','classList','fileSize','Cloud\x20upload\x20','gameName','getItem','endsWith','canvas','FSSync','uploadCheats','uId','listSaves','Cheat\x20Enabled!','26560089nMQEhN','.gb','2364495FPoBqq','innerWidth','/data/states/','Unable\x20to\x20upload\x20to\x20Cloud!','disable','application/octet-stream','4065892ynEyUh','Off','.ss0','autoLoadCheats','FSInit','/data/games/','Error\x20uploadCheat:','loadGame','_dateState','slotStateSaved','No\x20screenshot!','files','visibilityState','loadState','106300mLdruj','/data/screenshots/','pauseGame','#E0C068','toString','resumeGame','Auto\x20save\x20','getElementById','replace','now','384riXJHT','hidden','gbc1','listStates','Resumed!'];a0_0x4e0b=function(){return _0x5c908c;};return a0_0x4e0b();}export async function captureOCR(_0x3c83e9){const _0x5cc724=a0_0x35b581;Module[_0x5cc724(0x155)](_0x3c83e9);const _0x16aaaf=Module[_0x5cc724(0x1af)](_0x5cc724(0x182)+_0x3c83e9);return _0x16aaaf;}export async function setFastForwardMultiplier(_0x4e6e5d){Module['setFastForwardMultiplier'](_0x4e6e5d);}export function uploadCheats(_0x83f2b4,_0x56ec08,_0x2563c2,_0x2a5f1a,_0x12ddcc){const _0x4dd999=a0_0x35b581;Module[_0x4dd999(0x167)](_0x83f2b4,()=>{const _0x97b825=_0x4dd999;Module[_0x97b825(0x176)](),setTimeout(()=>{const _0x305bf7=_0x97b825;Module[_0x305bf7(0x166)]();},0x1f4),_0x2a5f1a&&(localStorage['setItem'](_0x56ec08+'_savedCheats',_0x2563c2),notiMessage(_0x97b825(0x16a),0x5dc)),_0x12ddcc[_0x97b825(0x19d)]=localStorage['getItem'](_0x56ec08+'_savedCheats'||_0x97b825(0x174));});}