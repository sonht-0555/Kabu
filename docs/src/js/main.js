const a0_0x136b3a=a0_0x194f;(function(_0x20e432,_0x50c38c){const _0x6647b8=a0_0x194f,_0xc52d9b=_0x20e432();while(!![]){try{const _0x5dddba=-parseInt(_0x6647b8(0x1f2))/0x1*(parseInt(_0x6647b8(0x20a))/0x2)+-parseInt(_0x6647b8(0x1ff))/0x3+-parseInt(_0x6647b8(0x1d5))/0x4+parseInt(_0x6647b8(0x1f3))/0x5+parseInt(_0x6647b8(0x1cd))/0x6+parseInt(_0x6647b8(0x216))/0x7*(parseInt(_0x6647b8(0x203))/0x8)+parseInt(_0x6647b8(0x21a))/0x9*(parseInt(_0x6647b8(0x21d))/0xa);if(_0x5dddba===_0x50c38c)break;else _0xc52d9b['push'](_0xc52d9b['shift']());}catch(_0x3bc488){_0xc52d9b['push'](_0xc52d9b['shift']());}}}(a0_0xb0af,0x24b93));import a0_0xb22bde from'../core/mgba.js';import*as a0_0x568422 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x136b3a(0x20d)]('canvas')};function initializeCore(_0x5b7bae,_0x214583){const _0x58090d=a0_0x136b3a;_0x5b7bae(_0x214583)[_0x58090d(0x1f0)](function(_0xf79680){const _0x43be0a=_0x58090d;_0xf79680[_0x43be0a(0x1ec)]();});}initializeCore(a0_0xb22bde,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document['getElementById']('canvas'),savedTurboState=localStorage['getItem'](a0_0x136b3a(0x1e6)),controlSetting=document[a0_0x136b3a(0x20d)](a0_0x136b3a(0x219));function handleVisibilityChange(_0x1992c7){const _0x4dc701=a0_0x136b3a;document['visibilityState']===_0x4dc701(0x221)||_0x1992c7?.[_0x4dc701(0x1f5)]===_0x4dc701(0x201)||_0x1992c7?.[_0x4dc701(0x20f)]?(pauseGame(),canvas[_0x4dc701(0x21c)]['add'](_0x4dc701(0x1df))):(setTimeout(()=>{const _0x3e980c=_0x4dc701;canvas[_0x3e980c(0x21c)][_0x3e980c(0x1d1)]('visible');},0x258),controlSetting[_0x4dc701(0x21c)][_0x4dc701(0x1f6)](_0x4dc701(0x1df))&&resumeGame());}async function statusShow(){const _0x926004=a0_0x136b3a;document[_0x926004(0x1f9)](_0x926004(0x1c8),handleVisibilityChange),document[_0x926004(0x1f9)]('visibilitychange',handleVisibilityChange),window[_0x926004(0x1f9)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x568422[_0x926004(0x206)](turboState)),await delay(0xc8),await Module['SDL2'](),await delay(0x320),await led(parseInt(localStorage[_0x926004(0x202)](_0x926004(0x21f)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x4035dd=a0_0x136b3a;await ledSave(_0x4035dd(0x1ed)),await Module[_0x4035dd(0x217)](0x0),await Module[_0x4035dd(0x1de)](),await screenShot(0x0),console['log']('Auto\x20save\x20'+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x4edf63=a0_0x136b3a,_0x25de43=localStorage[_0x4edf63(0x202)](_0x4edf63(0x1d0)),_0x4f6000=_0x25de43[_0x4edf63(0x1d4)](/\.(zip|gb|gbc|gba)$/,'.ss0'),_0x1ae834=localStorage['getItem']('uId');navigator['onLine']&&(_0x1ae834&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x4f6000,Module['downloadFile'](_0x4edf63(0x1eb)+_0x4f6000),'state'),await lockNoti('',_0x4edf63(0x1d8)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0xacc01c,_0x4a4ccb,_0x4f6ad,_0x476e15,_0x2a4238]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x4f6b84=a0_0x194f;_0x4f6ad++,_0x476e15++,_0x2a4238++;if(_0x4f6ad===0x3c)[_0x4f6ad,_0x4a4ccb]=[0x0,_0x4a4ccb+0x1];if(_0x4a4ccb===0x3c)[_0x4a4ccb,_0xacc01c]=[0x0,_0xacc01c+0x1];document[_0x4f6b84(0x20d)](_0x4f6b84(0x1dc))[_0x4f6b84(0x1e7)]=_0xacc01c+'h'+_0x4a4ccb['toString']()['padStart'](0x2,'0')+'.'+_0x4f6ad['toString']()[_0x4f6b84(0x223)](0x2,'0');_0x476e15===0x3c&&(saveStatePeriodically(),_0x476e15=0x0);;_0x2a4238===0x708&&(saveStateInCloud(),_0x2a4238=0x0);;},0x3e8);}export async function uploadGame(_0x2def60){const _0x1f22a8=a0_0x136b3a,_0x3a5f63=_0x2def60[_0x1f22a8(0x1e3)][0x0];Module[_0x1f22a8(0x205)](_0x3a5f63,()=>{const _0x3d2cfc=_0x1f22a8;Module[_0x3d2cfc(0x1de)]();});}function a0_0x194f(_0x83ede4,_0x196b88){const _0xb0af57=a0_0xb0af();return a0_0x194f=function(_0x194fa3,_0xbf920a){_0x194fa3=_0x194fa3-0x1c5;let _0x4072e9=_0xb0af57[_0x194fa3];return _0x4072e9;},a0_0x194f(_0x83ede4,_0x196b88);}export async function loadGame(_0x29ae7a){const _0x1ab7c0=a0_0x136b3a,_0x23cf4b=_0x29ae7a['replace'](/\.(gba|gbc|gb|zip)$/,_0x1ab7c0(0x1fb)),_0x2b79b2=Module[_0x1ab7c0(0x212)]()['filter'](_0x68081c=>_0x68081c!=='.'&&_0x68081c!=='..');intro['classList'][_0x1ab7c0(0x207)](_0x1ab7c0(0x220)),errorLogElements[0x0][_0x1ab7c0(0x1d6)][_0x1ab7c0(0x1d9)]='0',ingame[_0x1ab7c0(0x21c)]['remove'](_0x1ab7c0(0x220)),_0x29ae7a[_0x1ab7c0(0x1fc)](_0x1ab7c0(0x215))||_0x29ae7a['endsWith'](_0x1ab7c0(0x1ea))?(canvas[_0x1ab7c0(0x21c)][_0x1ab7c0(0x207)](_0x1ab7c0(0x218)),areaTrans[_0x1ab7c0(0x21c)][_0x1ab7c0(0x207)]('gbc1'),localStorage[_0x1ab7c0(0x1fa)](_0x1ab7c0(0x1f7),_0x1ab7c0(0x21e)+(window[_0x1ab7c0(0x1ee)]-0xe6)+','+(window[_0x1ab7c0(0x1ee)]-0xe6)*0x9/0xa)):localStorage[_0x1ab7c0(0x1fa)]('screenSize','0,0,'+(window['innerWidth']-0x96)+','+(window[_0x1ab7c0(0x1ee)]-0x96)*0x2/0x3),_0x2b79b2[_0x1ab7c0(0x1fe)](_0x23cf4b)?(await Module[_0x1ab7c0(0x211)](_0x1ab7c0(0x1c9)+_0x29ae7a),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x1ab7c0(0x1cc)](0x0),localStorage['setItem']('gameName',_0x29ae7a),console[_0x1ab7c0(0x214)](_0x29ae7a))):(await Module[_0x1ab7c0(0x211)](_0x1ab7c0(0x1c9)+_0x29ae7a),localStorage[_0x1ab7c0(0x1fa)]('gameName',_0x29ae7a),console[_0x1ab7c0(0x214)](_0x29ae7a)),await statusShow();}export async function saveState(_0x56f665){const _0x2762e9=a0_0x136b3a;await Module[_0x2762e9(0x217)](_0x56f665),await Module[_0x2762e9(0x1de)]();}export async function loadState(_0x5ed0fa){const _0x46e21a=a0_0x136b3a;await Module[_0x46e21a(0x1cc)](_0x5ed0fa);}export async function downloadFile(_0x1fb5c8,_0x102760){const _0x4c3fb4=a0_0x136b3a,_0x273b93=Module[_0x4c3fb4(0x209)](_0x1fb5c8),_0x221824=document[_0x4c3fb4(0x222)]('a');document[_0x4c3fb4(0x1ef)][_0x4c3fb4(0x20e)](_0x221824),_0x221824[_0x4c3fb4(0x1e2)]=_0x102760;const _0x4ea1c9=new Blob([_0x273b93],{'type':_0x4c3fb4(0x1d3)});_0x221824[_0x4c3fb4(0x210)]=URL[_0x4c3fb4(0x1f1)](_0x4ea1c9),_0x221824[_0x4c3fb4(0x21b)](),URL['revokeObjectURL'](_0x4ea1c9),_0x221824['remove']();}export function downloadFileInCloud(_0x4b7163){const _0x112c1b=a0_0x136b3a,_0x236587=Module[_0x112c1b(0x209)](_0x4b7163);return _0x236587;}export async function uploadFileInCloud(_0x289ab3){const _0x2819d0=a0_0x136b3a;Module[_0x2819d0(0x20c)](_0x289ab3,()=>{localStorageFile(),Module['FSSync']();});}export async function uploadFile(_0x52cbf7){const _0x5a0486=a0_0x136b3a,_0x2f05b7=_0x52cbf7[_0x5a0486(0x1e3)][0x0];Module[_0x5a0486(0x20c)](_0x2f05b7,()=>{const _0x27ad43=_0x5a0486;localStorageFile(),Module[_0x27ad43(0x1de)]();});}export async function editFile(_0x3bf571,_0x217443,_0x4f6a93){const _0x3dec8c=a0_0x136b3a;await Module[_0x3dec8c(0x1fd)](_0x3bf571,_0x217443,_0x4f6a93),await Module['FSSync']();}export async function deleteFile(_0x29dcca){const _0x4557aa=a0_0x136b3a;await Module[_0x4557aa(0x1da)](_0x29dcca),await Module[_0x4557aa(0x1de)]();}export function listGame(){const _0x2605f0=a0_0x136b3a,_0x5a43ac=Module[_0x2605f0(0x213)]()[_0x2605f0(0x1c6)](_0x1d7e39=>_0x1d7e39!=='.'&&_0x1d7e39!=='..');return _0x5a43ac;}export function listSave(){const _0x12f345=a0_0x136b3a,_0x50ccbb=Module[_0x12f345(0x1cb)]()[_0x12f345(0x1c6)](_0x37cc82=>_0x37cc82!=='.'&&_0x37cc82!=='..');return _0x50ccbb;}export function listState(){const _0x39eea5=a0_0x136b3a,_0x438c38=Module[_0x39eea5(0x212)]()[_0x39eea5(0x1c6)](_0xf3bc76=>_0xf3bc76!=='.'&&_0xf3bc76!=='..');return _0x438c38;}export function listCheat(){const _0x558681=a0_0x136b3a,_0x29e0a2=Module[_0x558681(0x1d7)]()[_0x558681(0x1c6)](_0x1ef4a5=>_0x1ef4a5!=='.'&&_0x1ef4a5!=='..');return _0x29e0a2;}export function listScreenshot(){const _0x1ff095=a0_0x136b3a,_0x57f56b=Module[_0x1ff095(0x1e5)]()[_0x1ff095(0x1c6)](_0xf6f9ff=>_0xf6f9ff!=='.'&&_0xf6f9ff!=='..');return _0x57f56b;}export function embedTextInPngFile(_0x1e0b47,_0x37b45a,_0x44e311){const _0x905393=a0_0x136b3a;let _0x4f1e85=atob(_0x1e0b47['split'](',')[0x1]),_0x270912=new Uint8Array(_0x4f1e85['length']);for(let _0x1e7c3c=0x0;_0x1e7c3c<_0x4f1e85[_0x905393(0x1f4)];_0x1e7c3c++){_0x270912[_0x1e7c3c]=_0x4f1e85['charCodeAt'](_0x1e7c3c);}let _0x1ebd2a=new TextEncoder()['encode']('tEXtComment\x00'+_0x37b45a),_0xf24ebd=new Uint8Array(_0x270912[_0x905393(0x1f4)]+_0x1ebd2a[_0x905393(0x1f4)]);_0xf24ebd[_0x905393(0x208)](_0x270912,0x0),_0xf24ebd[_0x905393(0x208)](_0x1ebd2a,_0x270912['length']);let _0x43dc92=new Blob([_0xf24ebd],{'type':_0x905393(0x1f8)}),_0x1c8968=new File([_0x43dc92],_0x44e311,{'type':_0x905393(0x1f8)});return _0x1c8968;}function a0_0xb0af(){const _0x599e6d=['fileSize','listSaves','loadState','1376214BjCxhU','split','Cheat\x20Enabled!','gameName','remove','Off','application/octet-stream','replace','1192336tnTOYt','style','listCheats','Cloud\x20upload\x20','bottom','deleteFile','screenshot','timer','Resumed!','FSSync','visible','substring','_savedCheats','download','files','indexOf','listScreenshots','turboState','textContent','setFastForwardMultiplier','setVolume','.gb','/data/states/','FSInit','#20A5A6','innerWidth','body','then','createObjectURL','1AiRzta','1256460MLfwAd','length','type','contains','screenSize','image/png','addEventListener','setItem','.ss0','endsWith','editFileName','includes','524799wIBucd','/data/screenshots/','beforeunload','getItem','1536nIQQHo','autoLoadCheats','uploadRom','turboF','add','set','downloadFile','115858MenLcR','SDL2','uploadAll','getElementById','appendChild','persisted','href','loadGame','listStates','listRoms','log','.gbc','1456FAGNVs','saveState','gbc','control-setting','4608DSQrne','click','classList','3140hljHYx','0,0,','slotStateSaved','disable','hidden','createElement','padStart','now','filter','resumeGame','pagehide','/data/games/'];a0_0xb0af=function(){return _0x599e6d;};return a0_0xb0af();}export function extractTextFromPngBase64(_0x1e2dd4){const _0x34fc7f=a0_0x136b3a;let _0x31f64f=atob(_0x1e2dd4[_0x34fc7f(0x1ce)](',')[0x1]),_0x478075='tEXtComment\x00',_0x311a60=_0x31f64f[_0x34fc7f(0x1e4)](_0x478075);if(_0x311a60!==-0x1)return _0x31f64f[_0x34fc7f(0x1e0)](_0x311a60+_0x478075[_0x34fc7f(0x1f4)]);return null;}export function fileSize(_0x369837){const _0x42f577=a0_0x136b3a,_0x15ccc7=Module[_0x42f577(0x1ca)](_0x369837);return _0x15ccc7;}export async function resumeGame(){const _0x26ebd9=a0_0x136b3a;Module[_0x26ebd9(0x1c7)](),Module[_0x26ebd9(0x20b)](),notiMessage(_0x26ebd9(0x1dd),0x7d0);}export async function pauseGame(){const _0x1dbc53=a0_0x136b3a;Module['pauseGame'](),Module[_0x1dbc53(0x20b)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x5d26cb){Module['buttonPress'](_0x5d26cb);}export async function buttonUnpress(_0x41df97){Module['buttonUnpress'](_0x41df97);}export async function screenShot(_0x28e674){const _0x4cbad6=a0_0x136b3a,_0x27c0fd=localStorage[_0x4cbad6(0x202)](_0x4cbad6(0x1d0))[_0x4cbad6(0x1d4)](/\.(gba|gbc|gb|zip)$/,''),_0x56cb86=_0x27c0fd+'_'+_0x28e674+'.png';await Module[_0x4cbad6(0x1db)](_0x56cb86),await Module[_0x4cbad6(0x1de)]();const _0xc87c54=await fileToBase64(Module['downloadFile'](_0x4cbad6(0x200)+_0x56cb86)),_0x31d31a=embedTextInPngFile(_0xc87c54,formatDateTime(Date[_0x4cbad6(0x1c5)]()),_0x56cb86);Module['uploadAll'](_0x31d31a,()=>{const _0x49bab4=_0x4cbad6;localStorageFile(),Module[_0x49bab4(0x1de)]();});}export async function dowloadScreenShot(_0x319546){const _0xbfd5b6=a0_0x136b3a;try{const _0x1730d1=await fileToBase64(Module[_0xbfd5b6(0x209)](_0x319546));return _0x1730d1;}catch{}}export async function captureOCR(_0x494293){const _0x5e09a0=a0_0x136b3a;Module['screenshot'](_0x494293);const _0x4c0edb=Module['downloadFile'](_0x5e09a0(0x200)+_0x494293);return _0x4c0edb;}export async function setFastForwardMultiplier(_0x1243c6){const _0x2b7c9c=a0_0x136b3a;Module[_0x2b7c9c(0x1e8)](_0x1243c6);}export function uploadCheats(_0x2bb73b,_0x3e004d,_0x2a9880,_0x3988ca,_0x5923bd){const _0x522c99=a0_0x136b3a;Module[_0x522c99(0x20c)](_0x2bb73b,()=>{const _0xa8a159=_0x522c99;Module[_0xa8a159(0x204)](),setTimeout(()=>{Module['FSSync']();},0x1f4),_0x3988ca&&(localStorage[_0xa8a159(0x1fa)](_0x3e004d+_0xa8a159(0x1e1),_0x2a9880),notiMessage(_0xa8a159(0x1cf),0x5dc)),_0x5923bd[_0xa8a159(0x1e7)]=localStorage['getItem'](_0x3e004d+'_savedCheats'||_0xa8a159(0x1d2));});}export function setVolume(_0x3a81be){const _0x50dd66=a0_0x136b3a;Module[_0x50dd66(0x1e9)](_0x3a81be);}