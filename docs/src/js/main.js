const a0_0x3d2788=a0_0x3f41;(function(_0xc3e89a,_0x4ea196){const _0x10c754=a0_0x3f41,_0x23a7b5=_0xc3e89a();while(!![]){try{const _0x5de141=parseInt(_0x10c754(0x84))/0x1+parseInt(_0x10c754(0xe5))/0x2+-parseInt(_0x10c754(0xcf))/0x3*(-parseInt(_0x10c754(0x94))/0x4)+-parseInt(_0x10c754(0xdc))/0x5+parseInt(_0x10c754(0x87))/0x6+-parseInt(_0x10c754(0x8b))/0x7+parseInt(_0x10c754(0xb2))/0x8*(parseInt(_0x10c754(0xce))/0x9);if(_0x5de141===_0x4ea196)break;else _0x23a7b5['push'](_0x23a7b5['shift']());}catch(_0x1802d4){_0x23a7b5['push'](_0x23a7b5['shift']());}}}(a0_0x4a06,0x7cf1c));import a0_0x3adc8b from'../core/mgba.js';import*as a0_0x1f9e1c from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';const Module={'canvas':document[a0_0x3d2788(0x85)]('canvas')};function initializeCore(_0x55143e,_0x57c10a){const _0x5e9397=a0_0x3d2788;_0x55143e(_0x57c10a)[_0x5e9397(0xbd)](function(_0x1d8fc5){_0x1d8fc5['FSInit']();});}initializeCore(a0_0x3adc8b,Module);function a0_0x3f41(_0x4ecd45,_0xa0599a){const _0x4a064d=a0_0x4a06();return a0_0x3f41=function(_0x3f410a,_0x199ec1){_0x3f410a=_0x3f410a-0x7a;let _0x111440=_0x4a064d[_0x3f410a];return _0x111440;},a0_0x3f41(_0x4ecd45,_0xa0599a);}let countAutoSave=0x0,countUpload=0x0;const canvas=document['getElementById'](a0_0x3d2788(0xcd)),controlSetting=document[a0_0x3d2788(0x85)]('control-setting');function handleVisibilityChange(_0x373466){const _0x56b686=a0_0x3d2788;document[_0x56b686(0xab)]===_0x56b686(0x7f)||_0x373466?.[_0x56b686(0xac)]===_0x56b686(0xa5)||_0x373466?.['persisted']?(pauseGame(),canvas[_0x56b686(0x92)][_0x56b686(0x99)](_0x56b686(0xdd))):(setTimeout(()=>{const _0x34faef=_0x56b686;canvas['classList'][_0x34faef(0x8e)](_0x34faef(0xdd));},0x258),controlSetting[_0x56b686(0x92)][_0x56b686(0x7a)]('visible')&&resumeGame());}async function statusShow(){const _0x8cf7a8=a0_0x3d2788;document[_0x8cf7a8(0xa2)](_0x8cf7a8(0x91),handleVisibilityChange),document[_0x8cf7a8(0xa2)]('visibilitychange',handleVisibilityChange),window[_0x8cf7a8(0xa2)](_0x8cf7a8(0xa5),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x1f9e1c[_0x8cf7a8(0x7e)](parseInt(await getData(gameName,'0',_0x8cf7a8(0xbb)))),await delay(0xc8),await Module[_0x8cf7a8(0xc4)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x8cf7a8(0xb1)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3cb96e=a0_0x3d2788;await ledSave(_0x3cb96e(0xe6)),await Module['saveState'](0x0),await Module[_0x3cb96e(0xd9)](),await screenShot(0x0),console[_0x3cb96e(0xd2)]('Auto\x20save\x20'+ ++countAutoSave+_0x3cb96e(0x7c));}async function saveStateInCloud(){const _0x35660f=a0_0x3d2788,_0xd886e7=gameName[_0x35660f(0xe2)](/\.(zip|gb|gbc|gba)$/,_0x35660f(0xba)),_0x49f44e=localStorage[_0x35660f(0x83)](_0x35660f(0xc1));navigator[_0x35660f(0xe3)]&&(_0x49f44e&&(await ledSave(_0x35660f(0xb0)),await delay(0x3e8),await dpUploadFile(_0xd886e7,Module[_0x35660f(0xde)](_0x35660f(0xbf)+_0xd886e7),'state'),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x35660f(0x7c),0x7d0)));}function startTimer(){let [_0x599f4a,_0x1582cd,_0x5802f9,_0x229591,_0x1100ff]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x575582=a0_0x3f41;_0x5802f9++,_0x229591++,_0x1100ff++;if(_0x5802f9===0x3c)[_0x5802f9,_0x1582cd]=[0x0,_0x1582cd+0x1];if(_0x1582cd===0x3c)[_0x1582cd,_0x599f4a]=[0x0,_0x599f4a+0x1];document['getElementById'](_0x575582(0xc9))['textContent']=_0x599f4a+'h'+_0x1582cd[_0x575582(0xc5)]()['padStart'](0x2,'0')+'.'+_0x5802f9[_0x575582(0xc5)]()[_0x575582(0xcb)](0x2,'0');_0x229591===0x3c&&(saveStatePeriodically(),_0x229591=0x0);;_0x1100ff===0x708&&(saveStateInCloud(),_0x1100ff=0x0);;},0x3e8);}export async function uploadGame(_0x1985f1){const _0x2c186c=a0_0x3d2788,_0x43f06e=_0x1985f1[_0x2c186c(0x89)][0x0];Module[_0x2c186c(0xb7)](_0x43f06e,()=>{const _0x3ec03e=_0x2c186c;Module[_0x3ec03e(0xd9)]();});}export async function loadGame(_0x47d524){const _0x4909c4=a0_0x3d2788,_0x755292=_0x47d524[_0x4909c4(0xe2)](/\.(gba|gbc|gb|zip)$/,_0x4909c4(0xba)),_0x32232b=Module['listStates']()[_0x4909c4(0xd1)](_0x525eaf=>_0x525eaf!=='.'&&_0x525eaf!=='..');intro[_0x4909c4(0x92)][_0x4909c4(0x99)](_0x4909c4(0xe4)),errorLogElements[0x0][_0x4909c4(0x82)]['bottom']='0',ingame[_0x4909c4(0x92)]['remove'](_0x4909c4(0xe4)),_0x47d524['endsWith']('.gbc')||_0x47d524[_0x4909c4(0xd4)](_0x4909c4(0xb5))?(canvas[_0x4909c4(0x92)]['add'](_0x4909c4(0xe0)),areaTrans[_0x4909c4(0x92)][_0x4909c4(0x99)](_0x4909c4(0x9c)),localStorage[_0x4909c4(0xa0)](_0x4909c4(0x93),'0,0,'+(window[_0x4909c4(0xdf)]-0xe6)+','+(window[_0x4909c4(0xdf)]-0xe6)*0x9/0xa)):localStorage[_0x4909c4(0xa0)]('screenSize',_0x4909c4(0x88)+(window['innerWidth']-0x96)+','+(window[_0x4909c4(0xdf)]-0x96)*0x2/0x3),_0x32232b[_0x4909c4(0x8a)](_0x755292)?(await Module['loadGame'](_0x4909c4(0xb6)+_0x47d524),confirm(_0x4909c4(0xb9))&&(await Module[_0x4909c4(0x97)](0x0),await shaderData())):(await Module['loadGame'](_0x4909c4(0xb6)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x247d29){const _0x2738cd=a0_0x3d2788;await Module[_0x2738cd(0x9a)](_0x247d29),await Module[_0x2738cd(0xd9)]();}export async function loadState(_0x1ab40c){const _0x15ecd7=a0_0x3d2788;await Module[_0x15ecd7(0x97)](_0x1ab40c);}export async function downloadFile(_0x4579f1,_0x16a8d7){const _0x75a1e0=a0_0x3d2788,_0x351b59=Module[_0x75a1e0(0xde)](_0x4579f1),_0x31a1ab=document['createElement']('a');document[_0x75a1e0(0xe7)][_0x75a1e0(0x9f)](_0x31a1ab),_0x31a1ab[_0x75a1e0(0x80)]=_0x16a8d7;const _0x283916=new Blob([_0x351b59],{'type':'application/octet-stream'});_0x31a1ab[_0x75a1e0(0x8f)]=URL['createObjectURL'](_0x283916),_0x31a1ab[_0x75a1e0(0x9d)](),URL['revokeObjectURL'](_0x283916),_0x31a1ab['remove']();}export function downloadFileInCloud(_0x545daf){const _0x275043=a0_0x3d2788;try{const _0x5433c8=Module[_0x275043(0xde)](_0x545daf);return _0x5433c8;}catch(_0x343c61){return null;}}export async function uploadFileInCloud(_0x1f84e8){const _0xa86d8f=a0_0x3d2788;Module[_0xa86d8f(0xd0)](_0x1f84e8,async()=>{const _0x3a1bb0=_0xa86d8f;localStorageFile(),await Module[_0x3a1bb0(0xd9)]();});}export async function uploadFile(_0x4e203c){const _0x4c41c5=a0_0x3d2788,_0xe273ca=_0x4e203c[_0x4c41c5(0x89)][0x0];Module[_0x4c41c5(0xd0)](_0xe273ca,async()=>{const _0x51adcc=_0x4c41c5;localStorageFile(),await Module[_0x51adcc(0xd9)]();});}function a0_0x4a06(){const _0x54bb0c=['trim','endsWith','listSaves','All','deleteFile','fill','FSSync','rgba(245,\x20232,\x20209,\x200.4)','split','5114485zlsJFv','visible','downloadFile','innerWidth','gbc','map','replace','onLine','disable','513786QUunXm','#20A5A6','body','led07','indexOf','contains','Resumed!','\x20time(s)','screenshot','turboF','hidden','download','listScreenshots','style','getItem','636350lINpAV','getElementById','setVolume','1978404KOnMev','0,0,','files','includes','1832691QypZbZ','listCheats','error','remove','href','image/png','pagehide','classList','screenSize','612YlCxGL','saveTime','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','loadState','\x20:\x20','add','saveState','now','gbc1','click','charCodeAt','appendChild','setItem','set','addEventListener','pauseGame','exec','beforeunload','length','buttonUnpress','substring','.png','listRoms','visibilityState','type','textContent','0.4','opacity','#E0C068','slotStateSaved','8ElLwvW','led05','match','.gb','/data/games/','uploadRom','led04','Do\x20you\x20want\x20to\x20load\x20save\x20state?','.ss0','turboState','led0','then','listStates','/data/states/','led06','uId','Paused!','led01','SDL2','toString','led00','led03','setFastForwardMultiplier','timer','/data/screenshots/','padStart','tEXtComment\x00','canvas','2844054QLDqXI','5049wLDUdI','uploadAll','filter','log'];a0_0x4a06=function(){return _0x54bb0c;};return a0_0x4a06();}export async function editFile(_0x51217e,_0x735a6d,_0x22f8e5){await Module['editFileName'](_0x51217e,_0x735a6d,_0x22f8e5),await Module['FSSync']();}export async function deleteFile(_0x445cfb){const _0x3694c7=a0_0x3d2788;await Module[_0x3694c7(0xd7)](_0x445cfb),await Module['FSSync']();}export function listGame(){const _0x535e7f=a0_0x3d2788,_0x3d1e9c=Module[_0x535e7f(0xaa)]()[_0x535e7f(0xd1)](_0x51a915=>_0x51a915!=='.'&&_0x51a915!=='..');return _0x3d1e9c;}export function listSave(){const _0x2041c7=a0_0x3d2788,_0x2d6578=Module[_0x2041c7(0xd5)]()[_0x2041c7(0xd1)](_0x281b0c=>_0x281b0c!=='.'&&_0x281b0c!=='..');return _0x2d6578;}export function listState(){const _0x518bde=a0_0x3d2788,_0x38a929=Module[_0x518bde(0xbe)]()[_0x518bde(0xd1)](_0x598335=>_0x598335!=='.'&&_0x598335!=='..');return _0x38a929;}export function listCheat(){const _0x5130b7=a0_0x3d2788,_0x3e8156=Module[_0x5130b7(0x8c)]()[_0x5130b7(0xd1)](_0x5c14b8=>_0x5c14b8!=='.'&&_0x5c14b8!=='..');return _0x3e8156;}export function listScreenshot(){const _0x4842f6=a0_0x3d2788,_0x5d5b63=Module[_0x4842f6(0x81)]()['filter'](_0x5818d1=>_0x5818d1!=='.'&&_0x5818d1!=='..');return _0x5d5b63;}export function embedTextInPngFile(_0x398d76,_0x355846,_0x275c09){const _0xf6574e=a0_0x3d2788;let _0x74d41b=atob(_0x398d76[_0xf6574e(0xdb)](',')[0x1]),_0x2c3e52=new Uint8Array(_0x74d41b[_0xf6574e(0xa6)]);for(let _0x2a9db2=0x0;_0x2a9db2<_0x74d41b[_0xf6574e(0xa6)];_0x2a9db2++){_0x2c3e52[_0x2a9db2]=_0x74d41b[_0xf6574e(0x9e)](_0x2a9db2);}let _0x453588=new TextEncoder()['encode'](_0xf6574e(0xcc)+_0x355846),_0x14a61d=new Uint8Array(_0x2c3e52[_0xf6574e(0xa6)]+_0x453588['length']);_0x14a61d['set'](_0x2c3e52,0x0),_0x14a61d[_0xf6574e(0xa1)](_0x453588,_0x2c3e52[_0xf6574e(0xa6)]);let _0x2d3df3=new Blob([_0x14a61d],{'type':_0xf6574e(0x90)}),_0x41430f=new File([_0x2d3df3],_0x275c09,{'type':_0xf6574e(0x90)});return _0x41430f;}export function extractTextFromPngBase64(_0x548b3e){const _0x2d3f1f=a0_0x3d2788;let _0x41db86=atob(_0x548b3e[_0x2d3f1f(0xdb)](',')[0x1]),_0x8e5894=_0x2d3f1f(0xcc),_0x3a711e=_0x41db86['indexOf'](_0x8e5894);if(_0x3a711e!==-0x1)return _0x41db86[_0x2d3f1f(0xa8)](_0x3a711e+_0x8e5894[_0x2d3f1f(0xa6)]);return null;}export function fileSize(_0x50d3f0){const _0x4920cf=Module['fileSize'](_0x50d3f0);return _0x4920cf;}export async function resumeGame(){const _0x24e843=a0_0x3d2788;Module['resumeGame'](),Module[_0x24e843(0xc4)](),notiMessage(_0x24e843(0x7b),0x7d0);}export async function pauseGame(){const _0x48bc18=a0_0x3d2788;Module[_0x48bc18(0xa3)](),Module[_0x48bc18(0xc4)](),notiMessage(_0x48bc18(0xc2),0x7d0);}export async function buttonPress(_0x4e0508){Module['buttonPress'](_0x4e0508);}export async function buttonUnpress(_0x1eb479){const _0x455622=a0_0x3d2788;Module[_0x455622(0xa7)](_0x1eb479);}export async function screenShot(_0x5cef6a){const _0x5e2294=a0_0x3d2788,_0x29ae42=gameName[_0x5e2294(0xe2)](/\.(gba|gbc|gb|zip)$/,'_'+_0x5cef6a+_0x5e2294(0xa9)),_0x4054d0=await getData(gameName,_0x5cef6a,_0x5e2294(0xd6))||'';console[_0x5e2294(0xd2)](_0x4054d0),await Module[_0x5e2294(0x7d)](_0x29ae42),await setData(gameName,_0x5cef6a,_0x5e2294(0x95),formatDateTime(Date[_0x5e2294(0x9b)]()),_0x4054d0);}export async function dowloadScreenShot(_0x5ccb91){const _0x2f6a3e=a0_0x3d2788;try{const _0x2a7035=await fileToBase64(Module[_0x2f6a3e(0xde)](_0x5ccb91));return _0x2a7035;}catch{}}export async function captureOCR(_0x1829c6){const _0x5d814b=a0_0x3d2788;Module[_0x5d814b(0x7d)](_0x1829c6);const _0x1eae9b=Module[_0x5d814b(0xde)](_0x5d814b(0xca)+_0x1829c6);return _0x1eae9b;}export async function setFastForwardMultiplier(_0x356785){const _0x533254=a0_0x3d2788;Module[_0x533254(0xc8)](_0x356785);}export async function uploadCheats(_0x16df7f){const _0x5b0a20=a0_0x3d2788;Module['autoLoadCheats'](async),Module[_0x5b0a20(0xd0)](_0x16df7f,async()=>{const _0x3d8e36=_0x5b0a20;await Module[_0x3d8e36(0xd9)]();});}export function setVolume(_0x415e19){const _0x5cac7c=a0_0x3d2788;Module[_0x5cac7c(0x86)](_0x415e19);}export async function setData(_0x24e5f8,_0x36ad92,_0xb6c1da,_0x5b6705,_0x1700c8=''){const _0x3bed30=a0_0x3d2788,_0x360366=_0x24e5f8[_0x3bed30(0xe2)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x49fdc1=_0x3bed30(0xca)+_0x360366+'_'+_0x36ad92+_0x3bed30(0xa9);let _0x9f1409;try{_0x9f1409=await fileToBase64(Module[_0x3bed30(0xde)](_0x49fdc1));}catch(_0xd6aa21){await Module[_0x3bed30(0x7d)](_0x360366+'_'+_0x36ad92+_0x3bed30(0xa9)),await delay(0xc8),_0x9f1409=await fileToBase64(Module[_0x3bed30(0xde)](_0x49fdc1));}let _0x3295f0=atob(_0x9f1409['split'](',')[0x1]),_0x4f5f28=_0x3bed30(0xcc),_0x502694=_0x3295f0['indexOf'](_0x4f5f28),_0x36c877={};if(_0x502694!==-0x1||_0x1700c8[_0x3bed30(0xd3)]()!==''){let _0x4110cb=_0x502694!==-0x1?_0x3295f0[_0x3bed30(0xa8)](_0x502694+_0x4f5f28[_0x3bed30(0xa6)]):_0x1700c8,_0x1e891b=/(\w+)\s*:\s*([^|]*)/g,_0x26f2fd;while((_0x26f2fd=_0x1e891b[_0x3bed30(0xa4)](_0x4110cb))!==null){_0x36c877[_0x26f2fd[0x1][_0x3bed30(0xd3)]()]=_0x26f2fd[0x2][_0x3bed30(0xd3)]();}_0x502694!==-0x1&&(_0x3295f0=_0x3295f0[_0x3bed30(0xa8)](0x0,_0x502694));}_0x36c877[_0xb6c1da]=_0x5b6705;let _0x518449=Object['entries'](_0x36c877)[_0x3bed30(0xe1)](([_0x4a3d0e,_0x4b1e3f])=>_0x4a3d0e+_0x3bed30(0x98)+_0x4b1e3f)['join']('\x20|\x20'),_0x2a4200=new TextEncoder()['encode'](_0x4f5f28+'\x20'+_0x518449),_0xd6fcbe=new Uint8Array([..._0x3295f0]['map'](_0x466dab=>_0x466dab[_0x3bed30(0x9e)](0x0))['concat']([..._0x2a4200])),_0x390932=new File([new Blob([_0xd6fcbe],{'type':_0x3bed30(0x90)})],_0x360366+'_'+_0x36ad92+_0x3bed30(0xa9),{'type':'image/png'});Module['uploadAll'](_0x390932,()=>{});}export async function getData(_0x5199eb,_0x544da4,_0x2b26a7){const _0x26854b=a0_0x3d2788;try{const _0x347bd7=_0x5199eb[_0x26854b(0xe2)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x1a9c32=_0x26854b(0xca)+_0x347bd7+'_'+_0x544da4+_0x26854b(0xa9);let _0x3ec3b5;try{_0x3ec3b5=await fileToBase64(Module[_0x26854b(0xde)](_0x1a9c32));}catch(_0x32b879){return null;}let _0x1c47d9=atob(_0x3ec3b5['split'](',')[0x1]),_0x283316=_0x26854b(0xcc),_0x5b09ac=_0x1c47d9[_0x26854b(0xe9)](_0x283316);if(_0x5b09ac!==-0x1){let _0x49d3a1=_0x1c47d9[_0x26854b(0xa8)](_0x5b09ac+_0x283316[_0x26854b(0xa6)]);if(_0x2b26a7===_0x26854b(0xd6))return _0x49d3a1['trim']();let _0xd554f5=new RegExp(_0x2b26a7+_0x26854b(0x96)),_0x139055=_0x49d3a1[_0x26854b(0xb4)](_0xd554f5);if(_0x139055)return _0x139055[0x1][_0x26854b(0xd3)]();}}catch(_0x43c4d1){return console[_0x26854b(0x8d)]({'romName':_0x5199eb,'slot':_0x544da4,'type':_0x2b26a7}),null;}}export async function ledSave(_0x1304ed){const _0x5eb2ac=a0_0x3d2788,_0x2c3022=parseInt(await getData(gameName,'0',_0x5eb2ac(0xb1))),_0x3872e1=_0x2c3022===0x1?_0x5eb2ac(0xc3):_0x2c3022===0x2?'led02':_0x2c3022===0x3?_0x5eb2ac(0xc7):_0x2c3022===0x4?_0x5eb2ac(0xb8):_0x2c3022===0x5?_0x5eb2ac(0xb3):_0x2c3022===0x6?_0x5eb2ac(0xc0):_0x2c3022===0x7?_0x5eb2ac(0xe8):_0x5eb2ac(0xc6);try{for(let _0x21d7d7=0x0;_0x21d7d7<=0x7;_0x21d7d7++){document[_0x5eb2ac(0x85)](_0x5eb2ac(0xbc)+_0x21d7d7)[_0x5eb2ac(0x82)][_0x5eb2ac(0xd8)]=_0x5eb2ac(0xda);}await delay(0x3e8);for(let _0x5e2de0=0x0;_0x5e2de0<=0x7;_0x5e2de0++){document[_0x5eb2ac(0x85)](_0x5eb2ac(0xbc)+_0x5e2de0)[_0x5eb2ac(0x82)][_0x5eb2ac(0xd8)]=_0x5eb2ac(0xda);}document['getElementById'](_0x3872e1)[_0x5eb2ac(0x82)]['fill']=_0x1304ed;}catch(_0x4f8276){console[_0x5eb2ac(0x8d)]('Error\x20ledSave:',_0x4f8276);}};export async function notiMessage(_0x818b18,_0xac216d,_0x547357=![]){const _0x2c1db6=a0_0x3d2788;var _0x40baf3=document[_0x2c1db6(0x85)]('noti-mess');const _0x76a832=parseInt(await getData(gameName,'0',_0x2c1db6(0xb1)))||0x0;_0x40baf3['style']['opacity']==='0.4'&&(clearTimeout(messageTimeout),_0x40baf3[_0x2c1db6(0x82)]['opacity']='0'),_0x40baf3[_0x2c1db6(0xad)]=_0x818b18,_0x40baf3[_0x2c1db6(0x82)][_0x2c1db6(0xaf)]=_0x2c1db6(0xae),messageTimeout=setTimeout(()=>{const _0x1e00c4=_0x2c1db6;_0x40baf3[_0x1e00c4(0xad)]='['+_0x76a832+']\x20'+gameName[_0x1e00c4(0xa8)](0x0,gameName['lastIndexOf']('.')),_0x40baf3['style']['opacity']='0.4';},_0xac216d),_0x547357&&(canvas['classList'][_0x2c1db6(0x99)](_0x2c1db6(0xdd)),setTimeout(()=>{const _0x10e066=_0x2c1db6;canvas['classList']['remove'](_0x10e066(0xdd));},0x258));}