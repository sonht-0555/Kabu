const a0_0x2e57e1=a0_0x2087;(function(_0x2d0b51,_0x1c6c81){const _0x199a2c=a0_0x2087,_0x3fac91=_0x2d0b51();while(!![]){try{const _0x5b3e75=-parseInt(_0x199a2c(0x78))/0x1+parseInt(_0x199a2c(0xb3))/0x2+-parseInt(_0x199a2c(0x76))/0x3+parseInt(_0x199a2c(0x7a))/0x4+parseInt(_0x199a2c(0xb0))/0x5+parseInt(_0x199a2c(0x6f))/0x6+parseInt(_0x199a2c(0x70))/0x7*(-parseInt(_0x199a2c(0xbd))/0x8);if(_0x5b3e75===_0x1c6c81)break;else _0x3fac91['push'](_0x3fac91['shift']());}catch(_0x26a9b0){_0x3fac91['push'](_0x3fac91['shift']());}}}(a0_0x24a7,0x39455));import a0_0x581b3c from'../core/mgba.js';import*as a0_0xad7e5 from'./gamepad.js';function a0_0x24a7(){const _0x2956cc=['visibilityState','substring','\x20time(s)','text/plain','listRoms','click','buttonUnpress','gbc1','listScreenshots','add','#20A5A6','.png','loadState','listSaves','href','setFastForwardMultiplier','createObjectURL','/data/games/','gameName','resumeGame','59655FhFhTN','gbc','_imageState0','759546ruClQR','download','type','Resumed!','tEXtComment\x00','classList','indexOf','_slot0.txt','listCheats','setVolume','632sqkZyQ','visible','persisted','endsWith','bottom','createElement','Off','turboF','control-setting','fileSize','application/octet-stream','beforeunload','length','disable','files','textContent','addEventListener','SDL2','Do\x20you\x20want\x20to\x20load\x20save\x20state?','deleteFile','padStart','canvas','set','Cheat\x20Enabled!','.ss0','buttonPress','Online!','saveState','/data/states/','2464410uCYRMD','31283XEZCYH','revokeObjectURL','pauseGame','autoLoadCheats','timer','image/png','1199130Xgqyil','split','45032eopXpT','.gb','919740lzJWLT','includes','visibilitychange','replace','uId','setItem','listStates','getItem','loadGame','now','uploadAll','filter','/data/screenshots/','Auto\x20save\x20','FSSync','log','remove','_savedCheats','toString','0,0,','screenSize','encode','screenshot','downloadFile','.gbc','#E0C068','body','Paused!','No\x20screenshot!','innerWidth','then','slotStateSaved','pagehide','getElementById'];a0_0x24a7=function(){return _0x2956cc;};return a0_0x24a7();}import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0x2e57e1(0x67))};function initializeCore(_0x2d07f3,_0x440517){const _0x363ba5=a0_0x2e57e1;_0x2d07f3(_0x440517)[_0x363ba5(0x98)](function(_0xbe5bd1){_0xbe5bd1['FSInit']();});}function a0_0x2087(_0x30bd15,_0x3911b1){const _0x24a799=a0_0x24a7();return a0_0x2087=function(_0x2087ef,_0x5e6ee7){_0x2087ef=_0x2087ef-0x66;let _0x580278=_0x24a799[_0x2087ef];return _0x580278;},a0_0x2087(_0x30bd15,_0x3911b1);}initializeCore(a0_0x581b3c,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x2e57e1(0x9b)](a0_0x2e57e1(0x67)),savedTurboState=localStorage[a0_0x2e57e1(0x81)]('turboState'),controlSetting=document[a0_0x2e57e1(0x9b)](a0_0x2e57e1(0xc5));function handleVisibilityChange(_0x240926){const _0x389d9d=a0_0x2e57e1;document[_0x389d9d(0x9c)]==='hidden'||_0x240926?.[_0x389d9d(0xb5)]==='beforeunload'||_0x240926?.[_0x389d9d(0xbf)]?(pauseGame(),canvas[_0x389d9d(0xb8)][_0x389d9d(0xa5)](_0x389d9d(0xbe))):(setTimeout(()=>{const _0x49c521=_0x389d9d;canvas[_0x49c521(0xb8)][_0x49c521(0x8a)](_0x49c521(0xbe));},0x258),controlSetting['classList']['contains'](_0x389d9d(0xbe))&&resumeGame());}async function statusShow(){const _0x33747b=a0_0x2e57e1;document['addEventListener'](_0x33747b(0x9a),handleVisibilityChange),document['addEventListener'](_0x33747b(0x7c),handleVisibilityChange),window[_0x33747b(0xcd)](_0x33747b(0xc8),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0xad7e5[_0x33747b(0xc4)](turboState)),await delay(0xc8),await Module[_0x33747b(0xce)](),await delay(0x320),await led(parseInt(localStorage['getItem'](_0x33747b(0x99)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3cc74e=a0_0x2e57e1;await ledSave(_0x3cc74e(0xa6)),await Module[_0x3cc74e(0x6d)](0x0),await Module[_0x3cc74e(0x88)](),await screenShot(0x0),console[_0x3cc74e(0x89)](_0x3cc74e(0x87)+ ++countAutoSave+_0x3cc74e(0x9e));}async function saveStateInCloud(){const _0x1a01f1=a0_0x2e57e1,_0x387e7a=localStorage[_0x1a01f1(0x81)](_0x1a01f1(0xae)),_0x5b430b=_0x387e7a[_0x1a01f1(0x7d)](/\.(zip|gb|gbc|gba)$/,_0x1a01f1(0x6a)),_0x2ecb2b=localStorage[_0x1a01f1(0x81)](_0x1a01f1(0x7e)),_0x1f31ac=localStorage[_0x1a01f1(0x81)](_0x387e7a+_0x1a01f1(0xb2)),_0x1ca151=localStorage[_0x1a01f1(0x81)](_0x387e7a+'_dateState0');if(navigator['onLine']){if(_0x2ecb2b){await ledSave(_0x1a01f1(0x93)),await delay(0x3e8),await dpUploadFile(_0x5b430b,Module[_0x1a01f1(0x91)](_0x1a01f1(0x6e)+_0x5b430b));if(_0x1f31ac!==null){const _0x25b659=_0x1f31ac+'\x0a\x0a'+_0x1ca151,_0x14146c=new Blob([_0x25b659],{'type':_0x1a01f1(0x9f)});await dpUploadFile(_0x387e7a+_0x1a01f1(0xba),_0x14146c);}else console['log'](_0x1a01f1(0x96));await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x1a01f1(0x9e),0x7d0);}else console[_0x1a01f1(0x89)]('Unable\x20to\x20upload\x20to\x20Cloud!');}else console[_0x1a01f1(0x89)](_0x1a01f1(0x6c));}function startTimer(){let [_0x5db0ce,_0x2d627b,_0x613c47,_0x2fb6d1,_0x3e6b05]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x3c187c=a0_0x2087;_0x613c47++,_0x2fb6d1++,_0x3e6b05++;if(_0x613c47===0x3c)[_0x613c47,_0x2d627b]=[0x0,_0x2d627b+0x1];if(_0x2d627b===0x3c)[_0x2d627b,_0x5db0ce]=[0x0,_0x5db0ce+0x1];document[_0x3c187c(0x9b)](_0x3c187c(0x74))[_0x3c187c(0xcc)]=_0x5db0ce+'h'+_0x2d627b[_0x3c187c(0x8c)]()[_0x3c187c(0x66)](0x2,'0')+'.'+_0x613c47[_0x3c187c(0x8c)]()['padStart'](0x2,'0');_0x2fb6d1===0x3c&&(saveStatePeriodically(),_0x2fb6d1=0x0);;_0x3e6b05===0xe10&&(saveStateInCloud(),_0x3e6b05=0x0);;},0x3e8);}export async function uploadGame(_0x46e20e){const _0x29ab06=a0_0x2e57e1,_0x1820ac=_0x46e20e[_0x29ab06(0xcb)][0x0];Module['uploadRom'](_0x1820ac,()=>{Module['FSSync']();});}export async function loadGame(_0x3c573e){const _0x22f3b6=a0_0x2e57e1,_0x3c1341=_0x3c573e[_0x22f3b6(0x7d)](/\.(gba|gbc|gb|zip)$/,_0x22f3b6(0x6a)),_0x350e79=Module[_0x22f3b6(0x80)]()['filter'](_0x377639=>_0x377639!=='.'&&_0x377639!=='..');intro[_0x22f3b6(0xb8)][_0x22f3b6(0xa5)](_0x22f3b6(0xca)),errorLogElements[0x0]['style'][_0x22f3b6(0xc1)]='0',ingame[_0x22f3b6(0xb8)]['remove'](_0x22f3b6(0xca)),_0x3c573e[_0x22f3b6(0xc0)](_0x22f3b6(0x92))||_0x3c573e[_0x22f3b6(0xc0)](_0x22f3b6(0x79))?(canvas[_0x22f3b6(0xb8)][_0x22f3b6(0xa5)](_0x22f3b6(0xb1)),areaTrans['classList'][_0x22f3b6(0xa5)](_0x22f3b6(0xa3)),localStorage[_0x22f3b6(0x7f)](_0x22f3b6(0x8e),_0x22f3b6(0x8d)+(window['innerWidth']-0xe6)+','+(window[_0x22f3b6(0x97)]-0xe6)*0x9/0xa)):localStorage[_0x22f3b6(0x7f)]('screenSize',_0x22f3b6(0x8d)+(window['innerWidth']-0x96)+','+(window[_0x22f3b6(0x97)]-0x96)*0x2/0x3),_0x350e79[_0x22f3b6(0x7b)](_0x3c1341)?(await Module[_0x22f3b6(0x82)]('/data/games/'+_0x3c573e),confirm(_0x22f3b6(0xcf))&&(await Module[_0x22f3b6(0xa8)](0x0),localStorage['setItem']('gameName',_0x3c573e),console['log'](_0x3c573e))):(await Module[_0x22f3b6(0x82)](_0x22f3b6(0xad)+_0x3c573e),localStorage[_0x22f3b6(0x7f)](_0x22f3b6(0xae),_0x3c573e),console[_0x22f3b6(0x89)](_0x3c573e)),await statusShow();}export async function saveState(_0x1c0ac2){const _0x52ca7c=a0_0x2e57e1;await Module['saveState'](_0x1c0ac2),await Module[_0x52ca7c(0x88)]();}export async function loadState(_0x3c3cca){const _0x5f55ea=a0_0x2e57e1;await Module[_0x5f55ea(0xa8)](_0x3c3cca);}export async function downloadFile(_0x1efe9b,_0x401a83){const _0x5a7cbf=a0_0x2e57e1,_0x5c3b52=Module[_0x5a7cbf(0x91)](_0x1efe9b),_0x643503=document[_0x5a7cbf(0xc2)]('a');document[_0x5a7cbf(0x94)]['appendChild'](_0x643503),_0x643503[_0x5a7cbf(0xb4)]=_0x401a83;const _0x36f825=new Blob([_0x5c3b52],{'type':_0x5a7cbf(0xc7)});_0x643503[_0x5a7cbf(0xaa)]=URL[_0x5a7cbf(0xac)](_0x36f825),_0x643503[_0x5a7cbf(0xa1)](),URL[_0x5a7cbf(0x71)](_0x36f825),_0x643503[_0x5a7cbf(0x8a)]();}export function downloadFileInCloud(_0x1ec46d){const _0x1abcd8=Module['downloadFile'](_0x1ec46d);return _0x1abcd8;}export async function uploadFile(_0x28cd23){const _0x5795a8=_0x28cd23['files'][0x0];Module['uploadAll'](_0x5795a8,()=>{const _0x43b297=a0_0x2087;localStorageFile(),Module[_0x43b297(0x88)]();});}export async function editFile(_0x4e6868,_0x2e396b,_0x5d9203){const _0x4b11e5=a0_0x2e57e1;await Module['editFileName'](_0x4e6868,_0x2e396b,_0x5d9203),await Module[_0x4b11e5(0x88)]();}export async function deleteFile(_0x49fff2){const _0x53e281=a0_0x2e57e1;await Module[_0x53e281(0xd0)](_0x49fff2),await Module[_0x53e281(0x88)]();}export function listGame(){const _0x1def03=a0_0x2e57e1,_0x235b70=Module[_0x1def03(0xa0)]()[_0x1def03(0x85)](_0x43e4d1=>_0x43e4d1!=='.'&&_0x43e4d1!=='..');return _0x235b70;}export function listSave(){const _0x40106e=a0_0x2e57e1,_0x538d50=Module[_0x40106e(0xa9)]()['filter'](_0x139edb=>_0x139edb!=='.'&&_0x139edb!=='..');return _0x538d50;}export function listState(){const _0x21a61b=Module['listStates']()['filter'](_0x2cff8d=>_0x2cff8d!=='.'&&_0x2cff8d!=='..');return _0x21a61b;}export function listCheat(){const _0x3ef0fc=a0_0x2e57e1,_0x2ad2e5=Module[_0x3ef0fc(0xbb)]()['filter'](_0x35b6c2=>_0x35b6c2!=='.'&&_0x35b6c2!=='..');return _0x2ad2e5;}export function listScreenshot(){const _0x21a210=a0_0x2e57e1,_0x1566e9=Module[_0x21a210(0xa4)]()[_0x21a210(0x85)](_0x10adc6=>_0x10adc6!=='.'&&_0x10adc6!=='..');return _0x1566e9;}export function embedTextInPngFile(_0x4e0e79,_0x3e7f69,_0x3bee50){const _0x3db724=a0_0x2e57e1;let _0x583df7=atob(_0x4e0e79[_0x3db724(0x77)](',')[0x1]),_0x5d8b8d=new Uint8Array(_0x583df7[_0x3db724(0xc9)]);for(let _0x4dcafc=0x0;_0x4dcafc<_0x583df7[_0x3db724(0xc9)];_0x4dcafc++){_0x5d8b8d[_0x4dcafc]=_0x583df7['charCodeAt'](_0x4dcafc);}let _0x3674be=new TextEncoder()[_0x3db724(0x8f)](_0x3db724(0xb7)+_0x3e7f69),_0x5482b8=new Uint8Array(_0x5d8b8d[_0x3db724(0xc9)]+_0x3674be['length']);_0x5482b8['set'](_0x5d8b8d,0x0),_0x5482b8[_0x3db724(0x68)](_0x3674be,_0x5d8b8d[_0x3db724(0xc9)]);let _0x4498cc=new Blob([_0x5482b8],{'type':'image/png'}),_0x1a85f6=new File([_0x4498cc],_0x3bee50,{'type':_0x3db724(0x75)});return _0x1a85f6;}export function extractTextFromPngBase64(_0x292d00){const _0x42391c=a0_0x2e57e1;let _0xce676c=atob(_0x292d00['split'](',')[0x1]),_0x53fada='tEXtComment\x00',_0x466f1c=_0xce676c[_0x42391c(0xb9)](_0x53fada);if(_0x466f1c!==-0x1)return _0xce676c[_0x42391c(0x9d)](_0x466f1c+_0x53fada[_0x42391c(0xc9)]);return null;}export function fileSize(_0x3d723f){const _0x21183f=a0_0x2e57e1,_0x11bdb9=Module[_0x21183f(0xc6)](_0x3d723f);return _0x11bdb9;}export async function resumeGame(){const _0x4fcaac=a0_0x2e57e1;Module[_0x4fcaac(0xaf)](),Module['SDL2'](),notiMessage(_0x4fcaac(0xb6),0x7d0);}export async function pauseGame(){const _0x12e95c=a0_0x2e57e1;Module[_0x12e95c(0x72)](),Module[_0x12e95c(0xce)](),notiMessage(_0x12e95c(0x95),0x7d0);}export async function buttonPress(_0x23f971){const _0x2c286b=a0_0x2e57e1;Module[_0x2c286b(0x6b)](_0x23f971);}export async function buttonUnpress(_0xa9cc4a){const _0x2b26b4=a0_0x2e57e1;Module[_0x2b26b4(0xa2)](_0xa9cc4a);}export async function screenShot(_0x4533d5){const _0x5a5e8b=a0_0x2e57e1,_0x32d9ef=localStorage[_0x5a5e8b(0x81)](_0x5a5e8b(0xae))[_0x5a5e8b(0x7d)](/\.(gba|gbc|gb|zip)$/,''),_0x5d9c9a=_0x32d9ef+'_'+_0x4533d5+_0x5a5e8b(0xa7);await Module[_0x5a5e8b(0x90)](_0x5d9c9a),await Module[_0x5a5e8b(0x88)]();const _0x1d08a8=await fileToBase64(Module['downloadFile'](_0x5a5e8b(0x86)+_0x5d9c9a)),_0x590cd4=embedTextInPngFile(_0x1d08a8,formatDateTime(Date[_0x5a5e8b(0x83)]()),_0x5d9c9a);Module['uploadAll'](_0x590cd4,()=>{localStorageFile(),Module['FSSync']();});}export async function dowloadScreenShot(_0x3b7441){const _0x1730fe=a0_0x2e57e1;try{const _0x1304aa=await fileToBase64(Module[_0x1730fe(0x91)](_0x3b7441));return _0x1304aa;}catch{}}export async function captureOCR(_0xb52ad4){const _0x42a82c=a0_0x2e57e1;Module['screenshot'](_0xb52ad4);const _0x48590e=Module[_0x42a82c(0x91)](_0x42a82c(0x86)+_0xb52ad4);return _0x48590e;}export async function setFastForwardMultiplier(_0x6bb53f){const _0x5d4d02=a0_0x2e57e1;Module[_0x5d4d02(0xab)](_0x6bb53f);}export function uploadCheats(_0x41864c,_0xef92a0,_0x4c6533,_0x3e54b4,_0x304162){const _0x4657f6=a0_0x2e57e1;Module[_0x4657f6(0x84)](_0x41864c,()=>{const _0x191219=_0x4657f6;Module[_0x191219(0x73)](),setTimeout(()=>{const _0x554a12=_0x191219;Module[_0x554a12(0x88)]();},0x1f4),_0x3e54b4&&(localStorage[_0x191219(0x7f)](_0xef92a0+_0x191219(0x8b),_0x4c6533),notiMessage(_0x191219(0x69),0x5dc)),_0x304162[_0x191219(0xcc)]=localStorage['getItem'](_0xef92a0+'_savedCheats'||_0x191219(0xc3));});}export function setVolume(_0xc64966){const _0x3645a5=a0_0x2e57e1;Module[_0x3645a5(0xbc)](_0xc64966);}