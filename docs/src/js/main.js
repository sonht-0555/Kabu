const a0_0x54da36=a0_0x143e;(function(_0x39ef27,_0x55c529){const _0x509b4c=a0_0x143e,_0xf14222=_0x39ef27();while(!![]){try{const _0x587ce4=parseInt(_0x509b4c(0xea))/0x1+-parseInt(_0x509b4c(0x123))/0x2+parseInt(_0x509b4c(0x12f))/0x3*(parseInt(_0x509b4c(0x112))/0x4)+-parseInt(_0x509b4c(0xfb))/0x5+parseInt(_0x509b4c(0x154))/0x6*(parseInt(_0x509b4c(0x15b))/0x7)+parseInt(_0x509b4c(0x14a))/0x8*(-parseInt(_0x509b4c(0xed))/0x9)+-parseInt(_0x509b4c(0x121))/0xa*(parseInt(_0x509b4c(0x106))/0xb);if(_0x587ce4===_0x55c529)break;else _0xf14222['push'](_0xf14222['shift']());}catch(_0x2b5a3d){_0xf14222['push'](_0xf14222['shift']());}}}(a0_0x5c9c,0xd5e62));import a0_0x4e46f0 from'../core/mgba.js';import*as a0_0x1053cf from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document['getElementById'](a0_0x54da36(0x111))};function initializeCore(_0x4f01b3,_0x3ffe11){_0x4f01b3(_0x3ffe11)['then'](function(_0x3a9b08){const _0x936980=a0_0x143e;_0x3a9b08[_0x936980(0x108)]();});}initializeCore(a0_0x4e46f0,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document['getElementById']('canvas'),controlSetting=document[a0_0x54da36(0x13d)](a0_0x54da36(0xf8));function handleVisibilityChange(_0x5e7e0c){const _0x1b9890=a0_0x54da36;document[_0x1b9890(0x11e)]===_0x1b9890(0x132)||_0x5e7e0c?.[_0x1b9890(0x13c)]===_0x1b9890(0x15f)||_0x5e7e0c?.[_0x1b9890(0x124)]?(Module[_0x1b9890(0x15d)](),pauseGame(),canvas[_0x1b9890(0x107)]['add'](_0x1b9890(0x118))):(setTimeout(()=>{const _0x53aea2=_0x1b9890;canvas[_0x53aea2(0x107)][_0x53aea2(0x138)](_0x53aea2(0x118));},0x258),controlSetting[_0x1b9890(0x107)][_0x1b9890(0x133)](_0x1b9890(0x118))&&resumeGame());}async function statusShow(){const _0xd6f54f=a0_0x54da36;document[_0xd6f54f(0x126)](_0xd6f54f(0x137),handleVisibilityChange),document['addEventListener'](_0xd6f54f(0x127),handleVisibilityChange),window[_0xd6f54f(0x126)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),await a0_0x1053cf[_0xd6f54f(0x135)](parseInt(await getData(gameName,'0',_0xd6f54f(0x14c)))),await delay(0xc8),await Module[_0xd6f54f(0x12d)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0xd6f54f(0x12a)))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x5db1db=a0_0x54da36;await ledSave(_0x5db1db(0xf9)),await Module[_0x5db1db(0x12c)](0x0),await Module[_0x5db1db(0x15d)](),await screenShot(0x0),console['log'](_0x5db1db(0x142)+ ++countAutoSave+'\x20time(s)');}function a0_0x143e(_0x123649,_0x3a0692){const _0x5c9c97=a0_0x5c9c();return a0_0x143e=function(_0x143e58,_0x2036d0){_0x143e58=_0x143e58-0xe7;let _0x1b3858=_0x5c9c97[_0x143e58];return _0x1b3858;},a0_0x143e(_0x123649,_0x3a0692);}async function saveStateInCloud(){const _0x380ac3=a0_0x54da36,_0x509c43=gameName['replace'](/\.(zip|gb|gbc|gba)$/,_0x380ac3(0x14d)),_0x1a62c4=localStorage[_0x380ac3(0x110)](_0x380ac3(0xf0));navigator[_0x380ac3(0x15c)]&&(_0x1a62c4&&(await ledSave(_0x380ac3(0xff)),await delay(0x3e8),await dpUploadFile(_0x509c43,Module[_0x380ac3(0x148)](_0x380ac3(0x143)+_0x509c43),_0x380ac3(0x122)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x380ac3(0x15a),0x7d0)));}function startTimer(){let [_0x152bf7,_0x53cc15,_0x9d6471,_0x65d1a0,_0x1138a7]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x2c608a=a0_0x143e;_0x9d6471++,_0x65d1a0++,_0x1138a7++;if(_0x9d6471===0x3c)[_0x9d6471,_0x53cc15]=[0x0,_0x53cc15+0x1];if(_0x53cc15===0x3c)[_0x53cc15,_0x152bf7]=[0x0,_0x152bf7+0x1];document[_0x2c608a(0x13d)]('timer')[_0x2c608a(0x14b)]=_0x152bf7+'h'+_0x53cc15[_0x2c608a(0x10a)]()[_0x2c608a(0xf2)](0x2,'0')+'.'+_0x9d6471[_0x2c608a(0x10a)]()[_0x2c608a(0xf2)](0x2,'0');_0x65d1a0===0x3c&&(saveStatePeriodically(),_0x65d1a0=0x0);;_0x1138a7===0x708&&(saveStateInCloud(),_0x1138a7=0x0);;},0x3e8);}export async function uploadGame(_0x34bd50){const _0x15aa8e=a0_0x54da36,_0x1248e8=_0x34bd50[_0x15aa8e(0xf5)][0x0];Module[_0x15aa8e(0x109)](_0x1248e8,()=>{Module['FSSync']();});}export async function loadGame(_0xe7dc11){const _0x34ab82=a0_0x54da36,_0x524012=_0xe7dc11[_0x34ab82(0x105)](/\.(gba|gbc|gb|zip)$/,_0x34ab82(0x14d)),_0x55fd38=Module[_0x34ab82(0x153)]()[_0x34ab82(0xe7)](_0x34e717=>_0x34e717!=='.'&&_0x34e717!=='..');intro[_0x34ab82(0x107)]['add'](_0x34ab82(0x11c)),errorLogElements[0x0][_0x34ab82(0x158)][_0x34ab82(0x119)]='0',ingame[_0x34ab82(0x107)]['remove']('disable'),_0xe7dc11[_0x34ab82(0x12e)](_0x34ab82(0x120))||_0xe7dc11[_0x34ab82(0x12e)]('.gb')?(canvas['classList'][_0x34ab82(0x129)]('gbc'),areaTrans[_0x34ab82(0x107)]['add'](_0x34ab82(0x13b)),localStorage['setItem'](_0x34ab82(0x155),_0x34ab82(0x10e)+(window['innerWidth']-0xe6)+','+(window[_0x34ab82(0x140)]-0xe6)*0x9/0xa)):localStorage[_0x34ab82(0x14e)](_0x34ab82(0x155),_0x34ab82(0x10e)+(window['innerWidth']-0x96)+','+(window[_0x34ab82(0x140)]-0x96)*0x2/0x3),_0x55fd38['includes'](_0x524012)?(await Module[_0x34ab82(0x125)](_0x34ab82(0x10b)+_0xe7dc11),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x34ab82(0x130)](0x0),await shaderData())):(await Module['loadGame'](_0x34ab82(0x10b)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x2e7e5e){await Module['saveState'](_0x2e7e5e);}export async function loadState(_0x4707d7){const _0x4c6ca6=a0_0x54da36;await Module[_0x4c6ca6(0x130)](_0x4707d7);}export async function downloadFile(_0x564567,_0x9e5fd9){const _0x1ab829=a0_0x54da36,_0x43bc0f=Module[_0x1ab829(0x148)](_0x564567),_0x177fca=document[_0x1ab829(0xf1)]('a');document[_0x1ab829(0x102)][_0x1ab829(0x11d)](_0x177fca),_0x177fca[_0x1ab829(0x131)]=_0x9e5fd9;const _0x41d200=new Blob([_0x43bc0f],{'type':_0x1ab829(0x103)});_0x177fca['href']=URL[_0x1ab829(0xfa)](_0x41d200),_0x177fca[_0x1ab829(0xe8)](),URL[_0x1ab829(0x10c)](_0x41d200),_0x177fca[_0x1ab829(0x138)]();}export function downloadFileInCloud(_0x419c96){try{const _0x28a194=Module['downloadFile'](_0x419c96);return _0x28a194;}catch(_0x39c732){return null;}}export async function uploadFileInCloud(_0x29e759){const _0xa95f22=a0_0x54da36;Module[_0xa95f22(0x146)](_0x29e759,async()=>{const _0x226dc2=_0xa95f22;localStorageFile(),await Module[_0x226dc2(0x15d)]();});}export async function uploadFile(_0x51cf5b){const _0x5d733d=a0_0x54da36,_0x265702=_0x51cf5b[_0x5d733d(0xf5)][0x0];Module[_0x5d733d(0x146)](_0x265702,async()=>{const _0x45e3d2=_0x5d733d;localStorageFile(),await Module[_0x45e3d2(0x15d)]();});}export async function editFile(_0x3bdfe6,_0x1b76d1,_0xab05a4){const _0x7bb4d7=a0_0x54da36;await Module[_0x7bb4d7(0xef)](_0x3bdfe6,_0x1b76d1,_0xab05a4);}export async function deleteFile(_0x33461f){const _0x1257a9=a0_0x54da36;try{return await Module[_0x1257a9(0x115)](_0x33461f),!![];}catch(_0x43da0a){return console[_0x1257a9(0x128)](_0x33461f),null;}}export function listGame(){const _0x453fa3=a0_0x54da36,_0x1d530b=Module[_0x453fa3(0x161)]()[_0x453fa3(0xe7)](_0x1aa2c3=>_0x1aa2c3!=='.'&&_0x1aa2c3!=='..');return _0x1d530b;}export function listSave(){const _0x549635=a0_0x54da36,_0xa52376=Module[_0x549635(0x11f)]()[_0x549635(0xe7)](_0x37eec9=>_0x37eec9!=='.'&&_0x37eec9!=='..');return _0xa52376;}export function listState(){const _0x476e71=a0_0x54da36,_0x53147e=Module[_0x476e71(0x153)]()['filter'](_0x5ddb93=>_0x5ddb93!=='.'&&_0x5ddb93!=='..');return _0x53147e;}export function listCheat(){const _0x19753b=a0_0x54da36,_0x1574eb=Module[_0x19753b(0x13f)]()[_0x19753b(0xe7)](_0x2161f6=>_0x2161f6!=='.'&&_0x2161f6!=='..');return _0x1574eb;}export function listScreenshot(){const _0x146c0c=a0_0x54da36,_0x38c9f6=Module[_0x146c0c(0x159)]()[_0x146c0c(0xe7)](_0x17bbc6=>_0x17bbc6!=='.'&&_0x17bbc6!=='..');return _0x38c9f6;}export function embedTextInPngFile(_0x24e3bb,_0x595a3a,_0x5cdc7f){const _0x150732=a0_0x54da36;let _0x75cd22=atob(_0x24e3bb[_0x150732(0x139)](',')[0x1]),_0x5125b5=new Uint8Array(_0x75cd22[_0x150732(0x113)]);for(let _0x2635dc=0x0;_0x2635dc<_0x75cd22[_0x150732(0x113)];_0x2635dc++){_0x5125b5[_0x2635dc]=_0x75cd22[_0x150732(0x11a)](_0x2635dc);}let _0x94c55b=new TextEncoder()[_0x150732(0xf7)]('tEXtComment\x00'+_0x595a3a),_0x495f00=new Uint8Array(_0x5125b5['length']+_0x94c55b[_0x150732(0x113)]);_0x495f00[_0x150732(0x141)](_0x5125b5,0x0),_0x495f00[_0x150732(0x141)](_0x94c55b,_0x5125b5['length']);let _0x5caa6b=new Blob([_0x495f00],{'type':_0x150732(0x14f)}),_0x3d59ae=new File([_0x5caa6b],_0x5cdc7f,{'type':_0x150732(0x14f)});return _0x3d59ae;}export function extractTextFromPngBase64(_0x2735d8){const _0x5a64fe=a0_0x54da36;let _0x41bf52=atob(_0x2735d8['split'](',')[0x1]),_0x35cea8=_0x5a64fe(0x10d),_0x57263f=_0x41bf52[_0x5a64fe(0x117)](_0x35cea8);if(_0x57263f!==-0x1)return _0x41bf52['substring'](_0x57263f+_0x35cea8['length']);return null;}export function fileSize(_0x17a74a){const _0x108e9f=a0_0x54da36,_0x19c0d0=Module[_0x108e9f(0x144)](_0x17a74a);return _0x19c0d0;}export async function resumeGame(){const _0x33eae2=a0_0x54da36;Module['resumeGame'](),Module[_0x33eae2(0x12d)](),notiMessage(_0x33eae2(0x10f),0x7d0);}export async function pauseGame(){const _0x4944e8=a0_0x54da36;Module[_0x4944e8(0x15e)](),Module[_0x4944e8(0x12d)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x40a295){Module['buttonPress'](_0x40a295);}export async function buttonUnpress(_0x4df92b){const _0x75b61d=a0_0x54da36;Module[_0x75b61d(0x157)](_0x4df92b);}export async function screenShot(_0x1c6afe){const _0x128624=a0_0x54da36,_0x45c317=gameName[_0x128624(0x105)](/\.(gba|gbc|gb|zip)$/,'_'+_0x1c6afe+_0x128624(0xeb)),_0x2611e0=await getData(gameName,_0x1c6afe,'All')||'';console['log'](_0x2611e0),await Module[_0x128624(0x104)](_0x45c317),await setData(gameName,_0x1c6afe,_0x128624(0xe9),formatDateTime(Date[_0x128624(0x152)]()),_0x2611e0);}export async function dowloadScreenShot(_0x4527da){const _0x265255=a0_0x54da36;try{const _0x2fdc0a=await fileToBase64(Module[_0x265255(0x148)](_0x4527da));return _0x2fdc0a;}catch{}}function a0_0x5c9c(){const _0x3f7de6=['deleteFile','fill','indexOf','visible','bottom','charCodeAt','exec','disable','appendChild','visibilityState','listSaves','.gbc','20gUERsJ','state','203732OxTHBB','persisted','loadGame','addEventListener','visibilitychange','error','add','slotStateSaved','substring','saveState','SDL2','endsWith','7401gtobjl','loadState','download','hidden','contains','concat','turboF','join','pagehide','remove','split','led0','gbc1','type','getElementById','led00','listCheats','innerWidth','set','Auto\x20save\x20','/data/states/','fileSize','led07','uploadAll','0.4','downloadFile','match','72DxhvzO','textContent','turboState','.ss0','setItem','image/png','noti-mess','/data/screenshots/','now','listStates','1960122AxjRRr','screenSize','led05','buttonUnpress','style','listScreenshots','\x20time(s)','28nbCvfL','onLine','FSSync','pauseGame','beforeunload','\x20|\x20','listRoms','autoLoadCheats','filter','click','saveTime','482314dvwnRw','.png','led01','1181637qnydpl','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','editFileName','uId','createElement','padStart','led02','map','files','trim','encode','control-setting','#20A5A6','createObjectURL','3518440vJqfLf','rgba(245,\x20232,\x20209,\x200.4)','setFastForwardMultiplier','setVolume','#E0C068','lastIndexOf','Error\x20ledSave:','body','application/octet-stream','screenshot','replace','1839189uPWwoJ','classList','FSInit','uploadRom','toString','/data/games/','revokeObjectURL','tEXtComment\x00','0,0,','Resumed!','getItem','canvas','2284joiIXJ','length','opacity'];a0_0x5c9c=function(){return _0x3f7de6;};return a0_0x5c9c();}export async function captureOCR(_0x3aeed3){const _0x26dc23=a0_0x54da36;Module[_0x26dc23(0x104)](_0x3aeed3);const _0x3181b8=Module[_0x26dc23(0x148)](_0x26dc23(0x151)+_0x3aeed3);return _0x3181b8;}export async function setFastForwardMultiplier(_0x2d7473){const _0x4c3b17=a0_0x54da36;Module[_0x4c3b17(0xfd)](_0x2d7473);}export async function uploadCheats(_0x123c98){const _0x2b5c22=a0_0x54da36;Module[_0x2b5c22(0x162)](),Module['uploadAll'](_0x123c98,async()=>{});}export function setVolume(_0x2af9cf){const _0x169a0e=a0_0x54da36;Module[_0x169a0e(0xfe)](_0x2af9cf);}export async function setData(_0x32babb,_0x41324e,_0x47b8b6,_0x37dc7b,_0x3b355c=''){const _0x276469=a0_0x54da36,_0x3fea5a=_0x32babb[_0x276469(0x105)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x4499c8=_0x276469(0x151)+_0x3fea5a+'_'+_0x41324e+_0x276469(0xeb);let _0x5b5ddf;try{_0x5b5ddf=await fileToBase64(Module[_0x276469(0x148)](_0x4499c8));}catch(_0x4a19d4){await Module[_0x276469(0x104)](_0x3fea5a+'_'+_0x41324e+_0x276469(0xeb)),await delay(0xc8),_0x5b5ddf=await fileToBase64(Module['downloadFile'](_0x4499c8));}let _0x46ef83=atob(_0x5b5ddf[_0x276469(0x139)](',')[0x1]),_0x3af993=_0x276469(0x10d),_0x187ca=_0x46ef83[_0x276469(0x117)](_0x3af993),_0x41fbee={};if(_0x187ca!==-0x1||_0x3b355c[_0x276469(0xf6)]()!==''){let _0x1053d9=_0x187ca!==-0x1?_0x46ef83[_0x276469(0x12b)](_0x187ca+_0x3af993['length']):_0x3b355c,_0x381b43=/(\w+)\s*:\s*([^|]*)/g,_0x449106;while((_0x449106=_0x381b43[_0x276469(0x11b)](_0x1053d9))!==null){_0x41fbee[_0x449106[0x1][_0x276469(0xf6)]()]=_0x449106[0x2][_0x276469(0xf6)]();}_0x187ca!==-0x1&&(_0x46ef83=_0x46ef83[_0x276469(0x12b)](0x0,_0x187ca));}_0x41fbee[_0x47b8b6]=_0x37dc7b;let _0x23df9d=Object['entries'](_0x41fbee)[_0x276469(0xf4)](([_0x83bbd9,_0x514bb3])=>_0x83bbd9+'\x20:\x20'+_0x514bb3)[_0x276469(0x136)](_0x276469(0x160)),_0x522a63=new TextEncoder()[_0x276469(0xf7)](_0x3af993+'\x20'+_0x23df9d),_0x335129=new Uint8Array([..._0x46ef83][_0x276469(0xf4)](_0x4e78bf=>_0x4e78bf[_0x276469(0x11a)](0x0))[_0x276469(0x134)]([..._0x522a63])),_0x3a8712=new File([new Blob([_0x335129],{'type':_0x276469(0x14f)})],_0x3fea5a+'_'+_0x41324e+_0x276469(0xeb),{'type':'image/png'});Module[_0x276469(0x146)](_0x3a8712,async()=>{});}export async function getData(_0x4c7dd0,_0x1333fa,_0xdf24ed){const _0x503c92=a0_0x54da36;try{const _0x43f02f=_0x4c7dd0[_0x503c92(0x105)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x1ac933='/data/screenshots/'+_0x43f02f+'_'+_0x1333fa+'.png';let _0x30b001;try{_0x30b001=await fileToBase64(Module['downloadFile'](_0x1ac933));}catch(_0x4ee650){return null;}let _0x145ea6=atob(_0x30b001[_0x503c92(0x139)](',')[0x1]),_0x1eabec=_0x503c92(0x10d),_0x188568=_0x145ea6[_0x503c92(0x117)](_0x1eabec);if(_0x188568!==-0x1){let _0x437e14=_0x145ea6[_0x503c92(0x12b)](_0x188568+_0x1eabec[_0x503c92(0x113)]);if(_0xdf24ed==='All')return _0x437e14['trim']();let _0x2318de=new RegExp(_0xdf24ed+_0x503c92(0xee)),_0x298b0c=_0x437e14[_0x503c92(0x149)](_0x2318de);if(_0x298b0c)return _0x298b0c[0x1][_0x503c92(0xf6)]();}}catch(_0x1e506f){return console['error']({'romName':_0x4c7dd0,'slot':_0x1333fa,'type':_0xdf24ed}),null;}}export async function ledSave(_0x27eca2){const _0x38e51d=a0_0x54da36,_0x37a726=parseInt(await getData(gameName,'0',_0x38e51d(0x12a))),_0x4d5c12=_0x37a726===0x1?_0x38e51d(0xec):_0x37a726===0x2?_0x38e51d(0xf3):_0x37a726===0x3?'led03':_0x37a726===0x4?'led04':_0x37a726===0x5?_0x38e51d(0x156):_0x37a726===0x6?'led06':_0x37a726===0x7?_0x38e51d(0x145):_0x38e51d(0x13e);try{for(let _0xf9af7a=0x0;_0xf9af7a<=0x7;_0xf9af7a++){document['getElementById'](_0x38e51d(0x13a)+_0xf9af7a)[_0x38e51d(0x158)][_0x38e51d(0x116)]='rgba(245,\x20232,\x20209,\x200.4)';}await delay(0x3e8);for(let _0x4339c0=0x0;_0x4339c0<=0x7;_0x4339c0++){document[_0x38e51d(0x13d)](_0x38e51d(0x13a)+_0x4339c0)[_0x38e51d(0x158)]['fill']=_0x38e51d(0xfc);}document[_0x38e51d(0x13d)](_0x4d5c12)['style'][_0x38e51d(0x116)]=_0x27eca2;}catch(_0x499c95){console[_0x38e51d(0x128)](_0x38e51d(0x101),_0x499c95);}};export async function notiMessage(_0x49088f,_0xe1f40d,_0x2cfe2c=![]){const _0x4e868f=a0_0x54da36;var _0x5de08f=document[_0x4e868f(0x13d)](_0x4e868f(0x150));const _0x23c7a8=parseInt(await getData(gameName,'0',_0x4e868f(0x12a)))||0x0;_0x5de08f[_0x4e868f(0x158)][_0x4e868f(0x114)]===_0x4e868f(0x147)&&(clearTimeout(messageTimeout),_0x5de08f[_0x4e868f(0x158)][_0x4e868f(0x114)]='0'),_0x5de08f['textContent']=_0x49088f,_0x5de08f[_0x4e868f(0x158)][_0x4e868f(0x114)]=_0x4e868f(0x147),messageTimeout=setTimeout(()=>{const _0x54ca11=_0x4e868f;_0x5de08f[_0x54ca11(0x14b)]='['+_0x23c7a8+']\x20'+gameName['substring'](0x0,gameName[_0x54ca11(0x100)]('.')),_0x5de08f[_0x54ca11(0x158)][_0x54ca11(0x114)]=_0x54ca11(0x147);},_0xe1f40d),_0x2cfe2c&&(canvas[_0x4e868f(0x107)][_0x4e868f(0x129)]('visible'),setTimeout(()=>{const _0x4db100=_0x4e868f;canvas[_0x4db100(0x107)]['remove'](_0x4db100(0x118));},0x258));}export async function FSSync(){const _0x23bc0b=a0_0x54da36;Module[_0x23bc0b(0x15d)]();}