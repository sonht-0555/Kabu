const a0_0x3a26c5=a0_0x3dbd;(function(_0x2b2f4c,_0x408520){const _0x482053=a0_0x3dbd,_0x1fe248=_0x2b2f4c();while(!![]){try{const _0x594ebc=parseInt(_0x482053(0x19c))/0x1+-parseInt(_0x482053(0x182))/0x2+-parseInt(_0x482053(0x167))/0x3+-parseInt(_0x482053(0x19a))/0x4*(parseInt(_0x482053(0x186))/0x5)+-parseInt(_0x482053(0x1b7))/0x6*(parseInt(_0x482053(0x193))/0x7)+parseInt(_0x482053(0x170))/0x8+-parseInt(_0x482053(0x1ba))/0x9*(-parseInt(_0x482053(0x1c6))/0xa);if(_0x594ebc===_0x408520)break;else _0x1fe248['push'](_0x1fe248['shift']());}catch(_0x109a1c){_0x1fe248['push'](_0x1fe248['shift']());}}}(a0_0x13e2,0x1a612));import a0_0xdcf657 from'../core/mgba.js';import*as a0_0x5c1a2a from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0x3a26c5(0x1a7)](a0_0x3a26c5(0x1c7))};function initializeCore(_0x248d32,_0x493fcf){const _0x584dba=a0_0x3a26c5;_0x248d32(_0x493fcf)[_0x584dba(0x183)](function(_0x387d59){const _0x57513d=_0x584dba;_0x387d59[_0x57513d(0x1ce)]();});}initializeCore(a0_0xdcf657,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x3a26c5(0x1a7)](a0_0x3a26c5(0x1c7)),controlSetting=document[a0_0x3a26c5(0x1a7)]('control-setting');function handleVisibilityChange(_0x551e03){const _0x1d0b96=a0_0x3a26c5;document[_0x1d0b96(0x1bc)]===_0x1d0b96(0x19b)||_0x551e03?.[_0x1d0b96(0x16b)]===_0x1d0b96(0x199)||_0x551e03?.[_0x1d0b96(0x185)]?(Module['FSSync'](),pauseGame(),canvas[_0x1d0b96(0x1d2)][_0x1d0b96(0x1c4)](_0x1d0b96(0x1c9))):(setTimeout(()=>{const _0x3507b5=_0x1d0b96;canvas[_0x3507b5(0x1d2)]['remove'](_0x3507b5(0x1c9));},0x258),controlSetting[_0x1d0b96(0x1d2)][_0x1d0b96(0x184)](_0x1d0b96(0x1c9))&&resumeGame());}async function statusShow(){const _0x5cc51a=a0_0x3a26c5;document[_0x5cc51a(0x174)]('pagehide',handleVisibilityChange),document['addEventListener'](_0x5cc51a(0x173),handleVisibilityChange),window[_0x5cc51a(0x174)](_0x5cc51a(0x199),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x5c1a2a['turboF'](parseInt(await getData(gameName,'0',_0x5cc51a(0x197)))),await delay(0xc8),await Module[_0x5cc51a(0x1d1)](),await delay(0x320),await led(parseInt(await getData(gameName,'0','slotStateSaved'))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x45640f=a0_0x3a26c5;await ledSave('#20A5A6'),await Module[_0x45640f(0x17b)](0x0),await Module[_0x45640f(0x16d)](),await screenShot(0x0),console[_0x45640f(0x18c)]('Auto\x20save\x20'+ ++countAutoSave+_0x45640f(0x17d));}async function saveStateInCloud(){const _0x5a2613=a0_0x3a26c5,_0x4ca972=gameName[_0x5a2613(0x1aa)](/\.(zip|gb|gbc|gba)$/,_0x5a2613(0x1d3)),_0x5c03af=localStorage['getItem'](_0x5a2613(0x1d4));navigator[_0x5a2613(0x1b0)]&&(_0x5c03af&&(await ledSave(_0x5a2613(0x1d8)),await delay(0x3e8),await dpUploadFile(_0x4ca972,Module['downloadFile']('/data/states/'+_0x4ca972),'state'),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x5a2613(0x17d),0x7d0)));}function startTimer(){let [_0x2ac87b,_0x20fd70,_0x4eb2ec,_0x5ee7e6,_0x3356d5]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x2fcb3c=a0_0x3dbd;_0x4eb2ec++,_0x5ee7e6++,_0x3356d5++;if(_0x4eb2ec===0x3c)[_0x4eb2ec,_0x20fd70]=[0x0,_0x20fd70+0x1];if(_0x20fd70===0x3c)[_0x20fd70,_0x2ac87b]=[0x0,_0x2ac87b+0x1];document[_0x2fcb3c(0x1a7)](_0x2fcb3c(0x1a0))['textContent']=_0x2ac87b+'h'+_0x20fd70[_0x2fcb3c(0x18a)]()[_0x2fcb3c(0x19e)](0x2,'0')+'.'+_0x4eb2ec[_0x2fcb3c(0x18a)]()[_0x2fcb3c(0x19e)](0x2,'0');_0x5ee7e6===0x3c&&(saveStatePeriodically(),_0x5ee7e6=0x0);;_0x3356d5===0x708&&(saveStateInCloud(),_0x3356d5=0x0);;},0x3e8);}export async function uploadGame(_0x512ba1){const _0x2462e5=a0_0x3a26c5,_0x499550=_0x512ba1['files'][0x0];Module[_0x2462e5(0x1c5)](_0x499550,()=>{const _0xd0a3e2=_0x2462e5;Module[_0xd0a3e2(0x16d)]();});}export async function loadGame(_0xb89e2f){const _0x368450=a0_0x3a26c5,_0x25d470=_0xb89e2f['replace'](/\.(gba|gbc|gb|zip)$/,_0x368450(0x1d3)),_0x4da5ec=Module[_0x368450(0x1a9)]('states')[_0x368450(0x1d5)](_0xc064af=>_0xc064af!=='.'&&_0xc064af!=='..');intro[_0x368450(0x1d2)]['add'](_0x368450(0x1bb)),errorLogElements[0x0][_0x368450(0x1d6)]['bottom']='0',ingame[_0x368450(0x1d2)][_0x368450(0x194)](_0x368450(0x1bb)),_0xb89e2f[_0x368450(0x1c0)](_0x368450(0x1a8))||_0xb89e2f[_0x368450(0x1c0)](_0x368450(0x169))?(canvas[_0x368450(0x1d2)][_0x368450(0x1c4)](_0x368450(0x1ab)),areaTrans['classList']['add']('gbc1'),localStorage['setItem']('screenSize','0,0,'+(window[_0x368450(0x1be)]-0xe6)+','+(window[_0x368450(0x1be)]-0xe6)*0x9/0xa)):localStorage[_0x368450(0x196)]('screenSize',_0x368450(0x178)+(window[_0x368450(0x1be)]-0x96)+','+(window[_0x368450(0x1be)]-0x96)*0x2/0x3),_0x4da5ec[_0x368450(0x19f)](_0x25d470)?(await Module[_0x368450(0x1c8)](_0x368450(0x1bd)+_0xb89e2f),confirm(_0x368450(0x1ad))&&(await Module[_0x368450(0x1ac)](0x0),await shaderData())):(await Module[_0x368450(0x1c8)](_0x368450(0x1bd)+gameName),await shaderData()),await statusShow();}function a0_0x3dbd(_0x1bfbae,_0x596670){const _0x13e2c4=a0_0x13e2();return a0_0x3dbd=function(_0x3dbd83,_0x8729b8){_0x3dbd83=_0x3dbd83-0x166;let _0x335c96=_0x13e2c4[_0x3dbd83];return _0x335c96;},a0_0x3dbd(_0x1bfbae,_0x596670);}export async function saveState(_0x3fa10e){const _0xa933db=a0_0x3a26c5;await Module[_0xa933db(0x17b)](_0x3fa10e);}export async function loadState(_0x34effa){const _0x41de58=a0_0x3a26c5;await Module[_0x41de58(0x1ac)](_0x34effa);}function a0_0x13e2(){const _0x426bd8=['Paused!','\x20time(s)','led01','saveTime','appendChild','trim','77116WYKhxh','then','contains','persisted','435685UwnAfQ','tEXtComment\x00','exec','join','toString','now','log','encode','screenshot','length','textContent','setVolume','charCodeAt','14uhxqoC','remove','noti-mess','setItem','turboState','pauseGame','beforeunload','4JvaPkE','hidden','198027hziqXY','fileSize','padStart','includes','timer','fill','map','listRoms','substring','buttonUnpress','led03','getElementById','.gbc','listFiles','replace','gbc','loadState','Do\x20you\x20want\x20to\x20load\x20save\x20state?','indexOf','listStates','onLine','createObjectURL','split','autoLoadCheats','led05','slotStateSaved','led04','245568JijPql','files','deleteFile','472869bqNGAg','disable','visibilityState','/data/games/','innerWidth','editFileName','endsWith','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','/data/screenshots/','match','add','uploadRom','20EvJVQR','canvas','loadGame','visible','All','.png','image/png','click','FSInit','download','led0','SDL2','classList','.ss0','uId','filter','style','listCheats','#E0C068','error','566019gBbYoQ','concat','.gb','listSaves','type','Error\x20ledSave:','FSSync','uploadAll','setFastForwardMultiplier','1609320hseMEu','opacity','href','visibilitychange','addEventListener','listScreenshots','0.4','\x20|\x20','0,0,','body','downloadFile','saveState'];a0_0x13e2=function(){return _0x426bd8;};return a0_0x13e2();}export async function downloadFile(_0x109f3c,_0x206a74){const _0x210eab=a0_0x3a26c5,_0x18d081=Module['downloadFile'](_0x109f3c),_0x4fa00a=document['createElement']('a');document[_0x210eab(0x179)][_0x210eab(0x180)](_0x4fa00a),_0x4fa00a[_0x210eab(0x1cf)]=_0x206a74;const _0x1d03b6=new Blob([_0x18d081],{'type':'application/octet-stream'});_0x4fa00a[_0x210eab(0x172)]=URL[_0x210eab(0x1b1)](_0x1d03b6),_0x4fa00a[_0x210eab(0x1cd)](),URL['revokeObjectURL'](_0x1d03b6),_0x4fa00a['remove']();}export function downloadFileInCloud(_0x1c6aaa){const _0x51ec64=a0_0x3a26c5;try{const _0x463ec6=Module[_0x51ec64(0x17a)](_0x1c6aaa);return _0x463ec6;}catch(_0x22041e){return null;}}export async function uploadFileInCloud(_0x2d9ed8){const _0x29139c=a0_0x3a26c5;Module[_0x29139c(0x16e)](_0x2d9ed8,async()=>{const _0x4c0628=_0x29139c;localStorageFile(),await Module[_0x4c0628(0x16d)]();});}export async function uploadFile(_0x49aa0a){const _0x145d3b=a0_0x3a26c5,_0x3fb7f3=_0x49aa0a[_0x145d3b(0x1b8)][0x0];Module[_0x145d3b(0x16e)](_0x3fb7f3,async()=>{const _0x56d3ad=_0x145d3b;localStorageFile(),await Module[_0x56d3ad(0x16d)]();});}export async function editFile(_0x12b0b3,_0x2d77ed,_0x111f11){const _0x3151ce=a0_0x3a26c5;await Module[_0x3151ce(0x1bf)](_0x12b0b3,_0x2d77ed,_0x111f11);}export async function deleteFile(_0xfa7b21){const _0x44223c=a0_0x3a26c5;try{return await Module[_0x44223c(0x1b9)](_0xfa7b21),!![];}catch(_0x410864){return console[_0x44223c(0x166)](_0xfa7b21),null;}}export function listFiles(_0x4224e4){const _0x13f147=a0_0x3a26c5,_0x50e002=Module[_0x13f147(0x1a9)](_0x4224e4)[_0x13f147(0x1d5)](_0x174c07=>_0x174c07!=='.'&&_0x174c07!=='..');return _0x50e002;}export function listGame(){const _0x256fe8=a0_0x3a26c5,_0x24847c=Module[_0x256fe8(0x1a3)]()[_0x256fe8(0x1d5)](_0x44513d=>_0x44513d!=='.'&&_0x44513d!=='..');return _0x24847c;}export function listSave(){const _0x4690f6=a0_0x3a26c5,_0x18121e=Module[_0x4690f6(0x16a)]()['filter'](_0x53b92e=>_0x53b92e!=='.'&&_0x53b92e!=='..');return _0x18121e;}export function listState(){const _0x5577ee=a0_0x3a26c5,_0x39ea91=Module[_0x5577ee(0x1af)]()[_0x5577ee(0x1d5)](_0x16d4bd=>_0x16d4bd!=='.'&&_0x16d4bd!=='..');return _0x39ea91;}export function listCheat(){const _0x276a5b=a0_0x3a26c5,_0x49b449=Module[_0x276a5b(0x1d7)]()['filter'](_0x37cc13=>_0x37cc13!=='.'&&_0x37cc13!=='..');return _0x49b449;}export function listScreenshot(){const _0x100a9a=a0_0x3a26c5,_0x1f4982=Module[_0x100a9a(0x175)]()[_0x100a9a(0x1d5)](_0x1fdf82=>_0x1fdf82!=='.'&&_0x1fdf82!=='..');return _0x1f4982;}export function fileSize(_0x653995){const _0x5f53c8=a0_0x3a26c5,_0x5d6814=Module[_0x5f53c8(0x19d)](_0x653995);return _0x5d6814;}export async function resumeGame(){Module['resumeGame'](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x50b2ca=a0_0x3a26c5;Module[_0x50b2ca(0x198)](),Module[_0x50b2ca(0x1d1)](),notiMessage(_0x50b2ca(0x17c),0x7d0);}export async function buttonPress(_0x512dbf){Module['buttonPress'](_0x512dbf);}export async function buttonUnpress(_0x1474b1){const _0x2cf418=a0_0x3a26c5;Module[_0x2cf418(0x1a5)](_0x1474b1);}export async function screenShot(_0xaa5c24){const _0x5de43a=a0_0x3a26c5,_0x10f7a9=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0xaa5c24+_0x5de43a(0x1cb)),_0x1fcc3d=await getData(gameName,_0xaa5c24,'All')||'';console[_0x5de43a(0x18c)](_0x1fcc3d),await Module[_0x5de43a(0x18e)](_0x10f7a9),await setData(gameName,_0xaa5c24,_0x5de43a(0x17f),formatDateTime(Date[_0x5de43a(0x18b)]()),_0x1fcc3d);}export async function dowloadScreenShot(_0x529c79){const _0x2cef17=a0_0x3a26c5;try{const _0x532632=await fileToBase64(Module[_0x2cef17(0x17a)](_0x529c79));return _0x532632;}catch{}}export async function captureOCR(_0x26fcb6){const _0x3161f2=a0_0x3a26c5;Module['screenshot'](_0x26fcb6);const _0x51a2a3=Module['downloadFile'](_0x3161f2(0x1c2)+_0x26fcb6);return _0x51a2a3;}export async function setFastForwardMultiplier(_0x45eaa7){const _0x19ec85=a0_0x3a26c5;Module[_0x19ec85(0x16f)](_0x45eaa7);}export async function uploadCheats(_0x3003ff){const _0x556ea7=a0_0x3a26c5;Module[_0x556ea7(0x1b3)](),Module[_0x556ea7(0x16e)](_0x3003ff,async()=>{});}export function setVolume(_0xccda64){const _0x4fadaf=a0_0x3a26c5;Module[_0x4fadaf(0x191)](_0xccda64);}export async function setData(_0x214f76,_0x30180f,_0x50a7ad,_0x195755,_0x3a1a8c=''){const _0x463220=a0_0x3a26c5,_0x55b7fb=_0x214f76[_0x463220(0x1aa)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x2b9974=_0x463220(0x1c2)+_0x55b7fb+'_'+_0x30180f+'.png';let _0x390b38;try{_0x390b38=await fileToBase64(Module['downloadFile'](_0x2b9974));}catch(_0x394fca){await Module['screenshot'](_0x55b7fb+'_'+_0x30180f+_0x463220(0x1cb)),await delay(0xc8),_0x390b38=await fileToBase64(Module['downloadFile'](_0x2b9974));}let _0x276fb0=atob(_0x390b38[_0x463220(0x1b2)](',')[0x1]),_0xb54355=_0x463220(0x187),_0x90f105=_0x276fb0[_0x463220(0x1ae)](_0xb54355),_0x256a23={};if(_0x90f105!==-0x1||_0x3a1a8c['trim']()!==''){let _0x25b4a7=_0x90f105!==-0x1?_0x276fb0[_0x463220(0x1a4)](_0x90f105+_0xb54355[_0x463220(0x18f)]):_0x3a1a8c,_0x1687eb=/(\w+)\s*:\s*([^|]*)/g,_0x32d1c5;while((_0x32d1c5=_0x1687eb[_0x463220(0x188)](_0x25b4a7))!==null){_0x256a23[_0x32d1c5[0x1][_0x463220(0x181)]()]=_0x32d1c5[0x2][_0x463220(0x181)]();}_0x90f105!==-0x1&&(_0x276fb0=_0x276fb0[_0x463220(0x1a4)](0x0,_0x90f105));}_0x256a23[_0x50a7ad]=_0x195755;let _0x5bc478=Object['entries'](_0x256a23)[_0x463220(0x1a2)](([_0x14b682,_0xe29401])=>_0x14b682+'\x20:\x20'+_0xe29401)[_0x463220(0x189)](_0x463220(0x177)),_0x51998a=new TextEncoder()[_0x463220(0x18d)](_0xb54355+'\x20'+_0x5bc478),_0x3350cc=new Uint8Array([..._0x276fb0][_0x463220(0x1a2)](_0x1d470a=>_0x1d470a[_0x463220(0x192)](0x0))[_0x463220(0x168)]([..._0x51998a])),_0x235efd=new File([new Blob([_0x3350cc],{'type':'image/png'})],_0x55b7fb+'_'+_0x30180f+_0x463220(0x1cb),{'type':_0x463220(0x1cc)});Module[_0x463220(0x16e)](_0x235efd,async()=>{});}export async function getData(_0x9e6239,_0x12763c,_0x30d083){const _0x4bf53e=a0_0x3a26c5;try{const _0x500d9e=_0x9e6239[_0x4bf53e(0x1aa)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x400161=_0x4bf53e(0x1c2)+_0x500d9e+'_'+_0x12763c+_0x4bf53e(0x1cb);let _0x52c3a5;try{_0x52c3a5=await fileToBase64(Module[_0x4bf53e(0x17a)](_0x400161));}catch(_0x41f8f5){return null;}let _0x305632=atob(_0x52c3a5[_0x4bf53e(0x1b2)](',')[0x1]),_0x46ff5b=_0x4bf53e(0x187),_0x3ac5ad=_0x305632['indexOf'](_0x46ff5b);if(_0x3ac5ad!==-0x1){let _0x241c79=_0x305632[_0x4bf53e(0x1a4)](_0x3ac5ad+_0x46ff5b[_0x4bf53e(0x18f)]);if(_0x30d083===_0x4bf53e(0x1ca))return _0x241c79['trim']();let _0x59f63e=new RegExp(_0x30d083+_0x4bf53e(0x1c1)),_0x5ba81a=_0x241c79[_0x4bf53e(0x1c3)](_0x59f63e);if(_0x5ba81a)return _0x5ba81a[0x1][_0x4bf53e(0x181)]();}}catch(_0x2ede30){return console[_0x4bf53e(0x166)]({'romName':_0x9e6239,'slot':_0x12763c,'type':_0x30d083}),null;}}export async function ledSave(_0x11ba58){const _0x5ddb32=a0_0x3a26c5,_0x4f54f9=parseInt(await getData(gameName,'0','slotStateSaved')),_0x3c0bb9=_0x4f54f9===0x1?_0x5ddb32(0x17e):_0x4f54f9===0x2?'led02':_0x4f54f9===0x3?_0x5ddb32(0x1a6):_0x4f54f9===0x4?_0x5ddb32(0x1b6):_0x4f54f9===0x5?_0x5ddb32(0x1b4):_0x4f54f9===0x6?'led06':_0x4f54f9===0x7?'led07':'led00';try{for(let _0x38bb40=0x0;_0x38bb40<=0x7;_0x38bb40++){document[_0x5ddb32(0x1a7)](_0x5ddb32(0x1d0)+_0x38bb40)[_0x5ddb32(0x1d6)][_0x5ddb32(0x1a1)]='rgba(245,\x20232,\x20209,\x200.4)';}await delay(0x3e8);for(let _0x1578f3=0x0;_0x1578f3<=0x7;_0x1578f3++){document['getElementById']('led0'+_0x1578f3)[_0x5ddb32(0x1d6)][_0x5ddb32(0x1a1)]='rgba(245,\x20232,\x20209,\x200.4)';}document['getElementById'](_0x3c0bb9)['style'][_0x5ddb32(0x1a1)]=_0x11ba58;}catch(_0x3228fd){console[_0x5ddb32(0x166)](_0x5ddb32(0x16c),_0x3228fd);}};export async function notiMessage(_0x9fefb9,_0x3d1d6e,_0x56351a=![]){const _0x17a653=a0_0x3a26c5;var _0x44fb7e=document[_0x17a653(0x1a7)](_0x17a653(0x195));const _0x2a7c63=parseInt(await getData(gameName,'0',_0x17a653(0x1b5)))||0x0;_0x44fb7e[_0x17a653(0x1d6)]['opacity']===_0x17a653(0x176)&&(clearTimeout(messageTimeout),_0x44fb7e['style']['opacity']='0'),_0x44fb7e[_0x17a653(0x190)]=_0x9fefb9,_0x44fb7e['style'][_0x17a653(0x171)]=_0x17a653(0x176),messageTimeout=setTimeout(()=>{const _0x56b5da=_0x17a653;_0x44fb7e[_0x56b5da(0x190)]='['+_0x2a7c63+']\x20'+gameName[_0x56b5da(0x1a4)](0x0,gameName['lastIndexOf']('.')),_0x44fb7e[_0x56b5da(0x1d6)][_0x56b5da(0x171)]=_0x56b5da(0x176);},_0x3d1d6e),_0x56351a&&(canvas[_0x17a653(0x1d2)][_0x17a653(0x1c4)](_0x17a653(0x1c9)),setTimeout(()=>{const _0x3d5533=_0x17a653;canvas[_0x3d5533(0x1d2)][_0x3d5533(0x194)](_0x3d5533(0x1c9));},0x258));}export async function FSSync(){const _0x338aa6=a0_0x3a26c5;Module[_0x338aa6(0x16d)]();}