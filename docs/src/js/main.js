const a0_0x39c5e9=a0_0x4fa5;(function(_0x46be7f,_0x51aebd){const _0x45d886=a0_0x4fa5,_0x36166e=_0x46be7f();while(!![]){try{const _0x378f92=-parseInt(_0x45d886(0x180))/0x1*(parseInt(_0x45d886(0x196))/0x2)+-parseInt(_0x45d886(0x1bd))/0x3*(parseInt(_0x45d886(0x16d))/0x4)+-parseInt(_0x45d886(0x19e))/0x5*(-parseInt(_0x45d886(0x1c3))/0x6)+-parseInt(_0x45d886(0x1a7))/0x7*(parseInt(_0x45d886(0x193))/0x8)+-parseInt(_0x45d886(0x179))/0x9+parseInt(_0x45d886(0x1ab))/0xa*(-parseInt(_0x45d886(0x19d))/0xb)+-parseInt(_0x45d886(0x1c0))/0xc*(-parseInt(_0x45d886(0x18e))/0xd);if(_0x378f92===_0x51aebd)break;else _0x36166e['push'](_0x36166e['shift']());}catch(_0x13f2ff){_0x36166e['push'](_0x36166e['shift']());}}}(a0_0x2b3a,0xe8e4c));import a0_0x3c9a8f from'../core/mgba.js';import*as a0_0x4d6068 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x39c5e9(0x17c)](a0_0x39c5e9(0x190))};function initializeCore(_0x3a0b78,_0x44cebf){const _0xa332c3=a0_0x39c5e9;_0x3a0b78(_0x44cebf)[_0xa332c3(0x1b3)](function(_0x1bef78){const _0x19d092=_0xa332c3;_0x1bef78[_0x19d092(0x1a2)]();});}initializeCore(a0_0x3c9a8f,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x39c5e9(0x17c)]('canvas'),savedTurboState=localStorage['getItem'](a0_0x39c5e9(0x19a)),controlSetting=document[a0_0x39c5e9(0x17c)]('control-setting');function handleVisibilityChange(_0x54c411){const _0x76dcbf=a0_0x39c5e9;document[_0x76dcbf(0x171)]==='hidden'||_0x54c411?.[_0x76dcbf(0x1d5)]===_0x76dcbf(0x1bc)||_0x54c411?.[_0x76dcbf(0x1c8)]?(pauseGame(),canvas[_0x76dcbf(0x175)][_0x76dcbf(0x1c4)](_0x76dcbf(0x177))):(setTimeout(()=>{const _0x1424d6=_0x76dcbf;canvas[_0x1424d6(0x175)][_0x1424d6(0x18f)](_0x1424d6(0x177));},0x258),controlSetting[_0x76dcbf(0x175)][_0x76dcbf(0x1ac)](_0x76dcbf(0x177))&&resumeGame());}async function statusShow(){const _0x5bbce0=a0_0x39c5e9;document['addEventListener'](_0x5bbce0(0x1cf),handleVisibilityChange),document[_0x5bbce0(0x174)](_0x5bbce0(0x1ad),handleVisibilityChange),window[_0x5bbce0(0x174)](_0x5bbce0(0x1bc),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x4d6068[_0x5bbce0(0x1b4)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x5bbce0(0x1c7)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3a9537=a0_0x39c5e9;await ledSave('#20A5A6'),await Module[_0x3a9537(0x16b)](0x0),await Module[_0x3a9537(0x1b5)](),await screenShot(0x0),console[_0x3a9537(0x1c1)](_0x3a9537(0x198)+ ++countAutoSave+_0x3a9537(0x16f));}async function saveStateInCloud(){const _0x1f2549=a0_0x39c5e9,_0x25d120=localStorage[_0x1f2549(0x1c7)](_0x1f2549(0x1a1)),_0x5ecaa6=_0x25d120[_0x1f2549(0x1a9)](_0x1f2549(0x1b0),_0x1f2549(0x1c2)),_0x40da38=localStorage[_0x1f2549(0x1c7)]('uId'),_0x45c8fd=localStorage[_0x1f2549(0x1c7)](_0x25d120+'_imageState0'),_0xb947eb=localStorage[_0x1f2549(0x1c7)](_0x25d120+_0x1f2549(0x184));if(navigator[_0x1f2549(0x1ae)]){if(_0x40da38){await ledSave(_0x1f2549(0x1a0)),await delay(0x3e8),await dpUploadFile(_0x5ecaa6,Module[_0x1f2549(0x186)](_0x1f2549(0x17a)+_0x5ecaa6));if(_0x45c8fd!==null){const _0x3fd065=_0x45c8fd+'\x0a\x0a'+_0xb947eb,_0x28b6c2=new Blob([_0x3fd065],{'type':_0x1f2549(0x189)});await dpUploadFile(_0x25d120+_0x1f2549(0x183),_0x28b6c2);}else console[_0x1f2549(0x1c1)](_0x1f2549(0x1b1));await lockNoti('',_0x1f2549(0x1d4)+ ++countUpload+_0x1f2549(0x16f),0x7d0);}else console[_0x1f2549(0x1c1)](_0x1f2549(0x17f));}else console[_0x1f2549(0x1c1)](_0x1f2549(0x19c));}function startTimer(){let [_0x30ce5a,_0x3608da,_0x1229d8,_0x29cd7f,_0x2cd170]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x45e26d=a0_0x4fa5;_0x1229d8++,_0x29cd7f++,_0x2cd170++;if(_0x1229d8===0x3c)[_0x1229d8,_0x3608da]=[0x0,_0x3608da+0x1];if(_0x3608da===0x3c)[_0x3608da,_0x30ce5a]=[0x0,_0x30ce5a+0x1];document[_0x45e26d(0x17c)](_0x45e26d(0x1a4))['textContent']=_0x30ce5a+'h'+_0x3608da[_0x45e26d(0x178)]()[_0x45e26d(0x18b)](0x2,'0')+'.'+_0x1229d8[_0x45e26d(0x178)]()['padStart'](0x2,'0');_0x29cd7f===0x3c&&(saveStatePeriodically(),_0x29cd7f=0x0);;_0x29cd7f===0xe10&&(saveStateInCloud(),_0x2cd170=0x0);;},0x3e8);}export async function uploadGame(_0x406b64){const _0x1a5b32=a0_0x39c5e9,_0xf591b0=_0x406b64['files'][0x0];Module[_0x1a5b32(0x176)](_0xf591b0,()=>{const _0x2d425a=_0x1a5b32;Module[_0x2d425a(0x1b5)]();});}export async function loadGame(_0x54c2ff){const _0x52a5fb=a0_0x39c5e9,_0x3da0f3=_0x54c2ff[_0x52a5fb(0x1a9)](/\.(gba|gbc|gb|zip)$/,_0x52a5fb(0x1c2)),_0x47f08f=Module[_0x52a5fb(0x194)]();intro[_0x52a5fb(0x175)][_0x52a5fb(0x1c4)](_0x52a5fb(0x1a6)),errorLogElements[0x0]['style'][_0x52a5fb(0x197)]='0',ingame['classList'][_0x52a5fb(0x18f)](_0x52a5fb(0x1a6)),_0x54c2ff[_0x52a5fb(0x173)]('.gbc')||_0x54c2ff['endsWith'](_0x52a5fb(0x1b6))?(canvas[_0x52a5fb(0x175)][_0x52a5fb(0x1c4)]('gbc'),areaTrans[_0x52a5fb(0x175)][_0x52a5fb(0x1c4)](_0x52a5fb(0x1af)),localStorage['setItem']('screenSize',_0x52a5fb(0x18c)+(window['innerWidth']-0xe6)+','+(window[_0x52a5fb(0x16e)]-0xe6)*0x9/0xa)):localStorage[_0x52a5fb(0x181)](_0x52a5fb(0x1cb),_0x52a5fb(0x18c)+(window[_0x52a5fb(0x16e)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x47f08f[_0x52a5fb(0x1c5)](_0x3da0f3)?(await Module[_0x52a5fb(0x1bf)](_0x52a5fb(0x1a8)+_0x54c2ff),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module['loadState'](0x0),localStorage[_0x52a5fb(0x181)](_0x52a5fb(0x1a1),_0x54c2ff),console[_0x52a5fb(0x1c1)](_0x54c2ff))):(await Module[_0x52a5fb(0x1bf)](_0x52a5fb(0x1a8)+_0x54c2ff),localStorage[_0x52a5fb(0x181)]('gameName',_0x54c2ff)),await statusShow();}export async function saveState(_0x5da3d5){const _0x25a930=a0_0x39c5e9;await Module[_0x25a930(0x16b)](_0x5da3d5),await Module['FSSync']();}export async function loadState(_0xe152cd){const _0xe16c16=a0_0x39c5e9;await Module[_0xe16c16(0x1d3)](_0xe152cd);}export async function downloadFile(_0x5e801e,_0x1b00df){const _0x153119=a0_0x39c5e9,_0x4ff637=Module[_0x153119(0x186)](_0x5e801e),_0x139848=document[_0x153119(0x1c9)]('a');document['body'][_0x153119(0x1cc)](_0x139848),_0x139848[_0x153119(0x19b)]=_0x1b00df;const _0x574af5=new Blob([_0x4ff637],{'type':_0x153119(0x16a)});_0x139848[_0x153119(0x1c6)]=URL[_0x153119(0x1be)](_0x574af5),_0x139848['click'](),URL[_0x153119(0x1b7)](_0x574af5),_0x139848[_0x153119(0x18f)]();}export function downloadFileInCloud(_0x376c5d){const _0x876b70=Module['downloadFile'](_0x376c5d);return _0x876b70;}export async function uploadFile(_0xe67906){const _0x373cb0=a0_0x39c5e9,_0x17a80f=_0xe67906[_0x373cb0(0x16c)][0x0];Module[_0x373cb0(0x1d1)](_0x17a80f,()=>{Module['FSSync']();});}export async function editFile(_0x55aeae,_0x2374d3,_0x127262){const _0x2405ca=a0_0x39c5e9;await Module[_0x2405ca(0x187)](_0x55aeae,_0x2374d3,_0x127262),await Module['FSSync']();}export async function deleteFile(_0x137d9f){const _0x91ab9b=a0_0x39c5e9;await Module[_0x91ab9b(0x19f)](_0x137d9f),await Module[_0x91ab9b(0x1b5)]();}export function listGame(){const _0x1e9608=a0_0x39c5e9,_0x58997d=Module[_0x1e9608(0x1d2)]();return _0x58997d;}export function listSave(){const _0x26ddcd=a0_0x39c5e9,_0x5b8968=Module[_0x26ddcd(0x17b)]();return _0x5b8968;}export function listState(){const _0x27ec4b=a0_0x39c5e9,_0x1b0be8=Module[_0x27ec4b(0x194)]();return _0x1b0be8;}export function listCheat(){const _0x523c75=a0_0x39c5e9,_0x2414bb=Module[_0x523c75(0x1a5)]();return _0x2414bb;}function a0_0x4fa5(_0xd58e04,_0x380407){const _0x2b3ad4=a0_0x2b3a();return a0_0x4fa5=function(_0x4fa583,_0x5391de){_0x4fa583=_0x4fa583-0x16a;let _0x4183e2=_0x2b3ad4[_0x4fa583];return _0x4183e2;},a0_0x4fa5(_0xd58e04,_0x380407);}export function listScreenshot(){const _0x196f46=a0_0x39c5e9,_0x330039=Module[_0x196f46(0x172)]();return _0x330039;}export function fileSize(_0x81423b){const _0x25b0eb=a0_0x39c5e9,_0x4e6136=Module[_0x25b0eb(0x1bb)](_0x81423b);return _0x4e6136;}export async function uploadCheat(_0x1e9677){const _0x3bd6c7=a0_0x39c5e9;try{const _0x37f054=_0x1e9677[_0x3bd6c7(0x16c)][0x0];await Module[_0x3bd6c7(0x182)](_0x37f054,()=>{const _0x10cc74=_0x3bd6c7;console['log'](_0x10cc74(0x191),_0x37f054[_0x10cc74(0x1ce)]),localStorageFile(),Module['FSSync']();});}catch(_0x47b8ef){console['error'](_0x3bd6c7(0x188),_0x47b8ef);}}function a0_0x2b3a(){const _0x299c0f=['Error\x20uploadSavSta:','screenSize','appendChild','_savedCheats','name','pagehide','textContent','uploadSaveOrSaveState','listGames','loadState','Cloud\x20upload\x20','type','application/octet-stream','saveState','files','4vjtVQw','innerWidth','\x20time(s)','_dateState','visibilityState','listScreenshots','endsWith','addEventListener','classList','uploadRom','visible','toString','10332981bRioar','/data/states/','listSaves','getElementById','Resumed!','now','Unable\x20to\x20upload\x20to\x20Cloud!','1358521hUGTrb','setItem','uploadCheats','_slot0.txt','_dateState0','screenshot','downloadFile','editFileName','Error\x20uploadCheat:','text/plain','Save/State\x20uploaded\x20successfully:','padStart','0,0,','error','422890gwViSD','remove','canvas','Cheat\x20uploaded\x20successfully:','setFastForwardMultiplier','8HXFvMG','listStates','Paused!','2XWtAvK','bottom','Auto\x20save\x20','/data/screenshots/','turboState','download','Online!','11811019WLYGsj','15DOKkaz','deleteFile','#E0C068','gameName','FSInit','.png','timer','listCheats','disable','6527458hFlCSK','/data/games/','replace','autoLoadCheats','10wWyGtM','contains','visibilitychange','onLine','gbc1','.gba','No\x20screenshot!','SDL2','then','turboF','FSSync','.gb','revokeObjectURL','pauseGame','_imageState','Cheat\x20Enabled!','fileSize','beforeunload','232863zJTPMZ','createObjectURL','loadGame','1956ZnZljg','log','.ss0','484032VJeygq','add','includes','href','getItem','persisted','createElement'];a0_0x2b3a=function(){return _0x299c0f;};return a0_0x2b3a();}export async function uploadSavSta(_0x4510d4){const _0x3c4c30=a0_0x39c5e9;try{const _0x5866d3=_0x4510d4[_0x3c4c30(0x16c)][0x0];await Module['uploadSaveOrSaveState'](_0x5866d3,()=>{const _0x4f0258=_0x3c4c30;console[_0x4f0258(0x1c1)](_0x4f0258(0x18a),_0x5866d3['name']),localStorageFile(),Module[_0x4f0258(0x1b5)]();});}catch(_0x972402){console[_0x3c4c30(0x18d)](_0x3c4c30(0x1ca),_0x972402);}}export async function uploadSaveOrSaveState(_0x499594){const _0x17ddd4=a0_0x39c5e9;Module[_0x17ddd4(0x1d1)](_0x499594,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0x5ce175=a0_0x39c5e9;Module['resumeGame'](),Module['SDL2'](),notiMessage(_0x5ce175(0x17d),0x7d0);}export async function pauseGame(){const _0xcb5250=a0_0x39c5e9;Module[_0xcb5250(0x1b8)](),Module[_0xcb5250(0x1b2)](),notiMessage(_0xcb5250(0x195),0x7d0);}export async function buttonPress(_0x29cd19){Module['buttonPress'](_0x29cd19);}export async function buttonUnpress(_0xa83f96){Module['buttonUnpress'](_0xa83f96);}export async function screenShot(_0x3cce8b){const _0x58cdcb=a0_0x39c5e9,_0x9746c6=localStorage[_0x58cdcb(0x1c7)](_0x58cdcb(0x1a1)),_0x2abfc0=_0x9746c6[_0x58cdcb(0x1a9)](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x58cdcb(0x185)](''+_0x2abfc0+_0x3cce8b+_0x58cdcb(0x1a3)),await Module['FSSync']();const _0x2c162b=await fileToBase64(Module[_0x58cdcb(0x186)]('/data/screenshots/'+_0x2abfc0+_0x3cce8b+_0x58cdcb(0x1a3))),_0x6ea1cd=Date[_0x58cdcb(0x17e)](),_0x4a945c=formatDateTime(_0x6ea1cd);localStorage[_0x58cdcb(0x181)](_0x9746c6+_0x58cdcb(0x170)+_0x3cce8b,_0x4a945c),localStorage[_0x58cdcb(0x181)](_0x9746c6+_0x58cdcb(0x1b9)+_0x3cce8b,_0x2c162b);}export async function captureOCR(_0x3ceb3a){const _0x2716ad=a0_0x39c5e9;Module[_0x2716ad(0x185)](_0x3ceb3a);const _0x3b63bf=Module['downloadFile'](_0x2716ad(0x199)+_0x3ceb3a);return _0x3b63bf;}export async function setFastForwardMultiplier(_0x7a2a2b){const _0xedbb55=a0_0x39c5e9;Module[_0xedbb55(0x192)](_0x7a2a2b);}export function uploadCheats(_0x1c4ae8,_0x45bdae,_0x2a3936,_0x5af205,_0x3e5e82){const _0x14bff8=a0_0x39c5e9;Module[_0x14bff8(0x182)](_0x1c4ae8,()=>{const _0x1e32e0=_0x14bff8;Module[_0x1e32e0(0x1aa)](),setTimeout(()=>{const _0x5863c0=_0x1e32e0;Module[_0x5863c0(0x1b5)]();},0x1f4),_0x5af205&&(localStorage[_0x1e32e0(0x181)](_0x45bdae+_0x1e32e0(0x1cd),_0x2a3936),notiMessage(_0x1e32e0(0x1ba),0x5dc)),_0x3e5e82[_0x1e32e0(0x1d0)]=localStorage[_0x1e32e0(0x1c7)](_0x45bdae+_0x1e32e0(0x1cd)||'Off');});}