const a0_0x3ec284=a0_0xaa06;(function(_0x10277d,_0x5ed156){const _0xf68bdd=a0_0xaa06,_0x3176f7=_0x10277d();while(!![]){try{const _0x14ceed=parseInt(_0xf68bdd(0x216))/0x1*(-parseInt(_0xf68bdd(0x21c))/0x2)+-parseInt(_0xf68bdd(0x217))/0x3*(parseInt(_0xf68bdd(0x1f4))/0x4)+-parseInt(_0xf68bdd(0x225))/0x5*(parseInt(_0xf68bdd(0x20e))/0x6)+-parseInt(_0xf68bdd(0x242))/0x7*(parseInt(_0xf68bdd(0x1f5))/0x8)+parseInt(_0xf68bdd(0x24e))/0x9*(-parseInt(_0xf68bdd(0x1f8))/0xa)+parseInt(_0xf68bdd(0x203))/0xb+parseInt(_0xf68bdd(0x1dd))/0xc;if(_0x14ceed===_0x5ed156)break;else _0x3176f7['push'](_0x3176f7['shift']());}catch(_0x3adc71){_0x3176f7['push'](_0x3176f7['shift']());}}}(a0_0x5911,0xf2930));import a0_0x31379f from'../core/mgba.js';import*as a0_0x3211c9 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';const Module={'canvas':document[a0_0x3ec284(0x204)](a0_0x3ec284(0x1e0))};function initializeCore(_0x475059,_0x3846f1){_0x475059(_0x3846f1)['then'](function(_0x2d0390){const _0x5d6e05=a0_0xaa06;_0x2d0390[_0x5d6e05(0x1de)]();});}initializeCore(a0_0x31379f,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document['getElementById']('canvas'),controlSetting=document['getElementById']('control-setting');function handleVisibilityChange(_0x373331){const _0x377e29=a0_0x3ec284;document['visibilityState']===_0x377e29(0x23a)||_0x373331?.[_0x377e29(0x221)]==='beforeunload'||_0x373331?.['persisted']?(pauseGame(),canvas[_0x377e29(0x24a)][_0x377e29(0x223)]('visible')):(setTimeout(()=>{const _0x4fbeec=_0x377e29;canvas[_0x4fbeec(0x24a)]['remove']('visible');},0x258),controlSetting[_0x377e29(0x24a)][_0x377e29(0x20f)](_0x377e29(0x231))&&resumeGame());}async function statusShow(){const _0x316a74=a0_0x3ec284;document[_0x316a74(0x1e5)](_0x316a74(0x1f0),handleVisibilityChange),document[_0x316a74(0x1e5)](_0x316a74(0x253),handleVisibilityChange),window['addEventListener'](_0x316a74(0x22c),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x3211c9[_0x316a74(0x1e6)](parseInt(await getData(gameName,'0',_0x316a74(0x214)))),await delay(0xc8),await Module[_0x316a74(0x220)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x316a74(0x239)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x7ea190=a0_0x3ec284;await ledSave(_0x7ea190(0x1ef)),await Module[_0x7ea190(0x236)](0x0),await Module[_0x7ea190(0x1f1)](),await screenShot(0x0),console['log'](_0x7ea190(0x243)+ ++countAutoSave+_0x7ea190(0x23f));}async function saveStateInCloud(){const _0x13dd76=a0_0x3ec284,_0x5ea655=gameName[_0x13dd76(0x235)](/\.(zip|gb|gbc|gba)$/,_0x13dd76(0x21a)),_0x5d5012=localStorage[_0x13dd76(0x22e)](_0x13dd76(0x238));navigator[_0x13dd76(0x23b)]&&(_0x5d5012&&(await ledSave(_0x13dd76(0x234)),await delay(0x3e8),await dpUploadFile(_0x5ea655,Module[_0x13dd76(0x1f9)](_0x13dd76(0x21e)+_0x5ea655),_0x13dd76(0x24b)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x13dd76(0x23f),0x7d0)));}function startTimer(){let [_0x58707a,_0x355e22,_0x26cfeb,_0x3bc4aa,_0x46d3d5]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x32c80c=a0_0xaa06;_0x26cfeb++,_0x3bc4aa++,_0x46d3d5++;if(_0x26cfeb===0x3c)[_0x26cfeb,_0x355e22]=[0x0,_0x355e22+0x1];if(_0x355e22===0x3c)[_0x355e22,_0x58707a]=[0x0,_0x58707a+0x1];document[_0x32c80c(0x204)]('timer')[_0x32c80c(0x241)]=_0x58707a+'h'+_0x355e22[_0x32c80c(0x1ff)]()[_0x32c80c(0x20a)](0x2,'0')+'.'+_0x26cfeb[_0x32c80c(0x1ff)]()[_0x32c80c(0x20a)](0x2,'0');_0x3bc4aa===0x3c&&(saveStatePeriodically(),_0x3bc4aa=0x0);;_0x46d3d5===0x708&&(saveStateInCloud(),_0x46d3d5=0x0);;},0x3e8);}function a0_0xaa06(_0x6782c7,_0x318bd3){const _0x5911bd=a0_0x5911();return a0_0xaa06=function(_0xaa06b5,_0x4f446c){_0xaa06b5=_0xaa06b5-0x1dc;let _0x297381=_0x5911bd[_0xaa06b5];return _0x297381;},a0_0xaa06(_0x6782c7,_0x318bd3);}export async function uploadGame(_0xfada5f){const _0x1e0a05=a0_0x3ec284,_0x5c1760=_0xfada5f[_0x1e0a05(0x1ed)][0x0];Module['uploadRom'](_0x5c1760,()=>{const _0x2cd02b=_0x1e0a05;Module[_0x2cd02b(0x1f1)]();});}export async function loadGame(_0x49c65e){const _0x48a181=a0_0x3ec284,_0x2eddc7=_0x49c65e['replace'](/\.(gba|gbc|gb|zip)$/,_0x48a181(0x21a)),_0x423034=Module[_0x48a181(0x1e8)]()['filter'](_0x34eafe=>_0x34eafe!=='.'&&_0x34eafe!=='..');intro[_0x48a181(0x24a)][_0x48a181(0x223)](_0x48a181(0x22d)),errorLogElements[0x0][_0x48a181(0x218)][_0x48a181(0x200)]='0',ingame[_0x48a181(0x24a)]['remove'](_0x48a181(0x22d)),_0x49c65e[_0x48a181(0x213)]('.gbc')||_0x49c65e['endsWith'](_0x48a181(0x250))?(canvas['classList']['add'](_0x48a181(0x247)),areaTrans[_0x48a181(0x24a)][_0x48a181(0x223)](_0x48a181(0x206)),localStorage[_0x48a181(0x1ea)]('screenSize','0,0,'+(window[_0x48a181(0x227)]-0xe6)+','+(window[_0x48a181(0x227)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x48a181(0x252),'0,0,'+(window[_0x48a181(0x227)]-0x96)+','+(window[_0x48a181(0x227)]-0x96)*0x2/0x3),_0x423034[_0x48a181(0x224)](_0x2eddc7)?(await Module['loadGame'](_0x48a181(0x210)+_0x49c65e),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x48a181(0x1f6)](0x0),await shaderData())):(await Module[_0x48a181(0x202)](_0x48a181(0x210)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x441dc9){const _0x4e6015=a0_0x3ec284;await Module[_0x4e6015(0x236)](_0x441dc9),await Module[_0x4e6015(0x1f1)]();}export async function loadState(_0x53deb9){await Module['loadState'](_0x53deb9);}export async function downloadFile(_0x2184e4,_0x126ff9){const _0x4bfb80=a0_0x3ec284,_0x218835=Module[_0x4bfb80(0x1f9)](_0x2184e4),_0x15bcf1=document[_0x4bfb80(0x1ec)]('a');document[_0x4bfb80(0x237)][_0x4bfb80(0x212)](_0x15bcf1),_0x15bcf1[_0x4bfb80(0x23c)]=_0x126ff9;const _0x295138=new Blob([_0x218835],{'type':_0x4bfb80(0x24d)});_0x15bcf1[_0x4bfb80(0x23e)]=URL[_0x4bfb80(0x1e2)](_0x295138),_0x15bcf1[_0x4bfb80(0x1dc)](),URL[_0x4bfb80(0x246)](_0x295138),_0x15bcf1[_0x4bfb80(0x211)]();}export function downloadFileInCloud(_0x21b496){const _0xa30865=a0_0x3ec284;try{const _0xb1201=Module[_0xa30865(0x1f9)](_0x21b496);return _0xb1201;}catch(_0x5921c4){return null;}}export async function uploadFileInCloud(_0x3ebda2){const _0x1470d7=a0_0x3ec284;Module[_0x1470d7(0x207)](_0x3ebda2,async()=>{const _0x2b5820=_0x1470d7;localStorageFile(),await Module[_0x2b5820(0x1f1)]();});}export async function uploadFile(_0x56fbb0){const _0x523641=a0_0x3ec284,_0x1242a0=_0x56fbb0[_0x523641(0x1ed)][0x0];Module['uploadAll'](_0x1242a0,async()=>{const _0x5a9154=_0x523641;localStorageFile(),await Module[_0x5a9154(0x1f1)]();});}export async function editFile(_0x286776,_0x37d4d1,_0x5a2128){const _0x65bbbf=a0_0x3ec284;await Module[_0x65bbbf(0x1fa)](_0x286776,_0x37d4d1,_0x5a2128),await Module['FSSync']();}export async function deleteFile(_0x2fbf07){const _0x46d97a=a0_0x3ec284;try{return await Module[_0x46d97a(0x1fb)](_0x2fbf07),await delay(0x64),await Module[_0x46d97a(0x1f1)](),!![];}catch(_0xa45b){return null;}}export function listGame(){const _0x77cb5e=a0_0x3ec284,_0x1debc9=Module[_0x77cb5e(0x229)]()[_0x77cb5e(0x233)](_0x3d3fff=>_0x3d3fff!=='.'&&_0x3d3fff!=='..');return _0x1debc9;}export function listSave(){const _0x996e93=a0_0x3ec284,_0x3942b8=Module[_0x996e93(0x232)]()[_0x996e93(0x233)](_0x32502b=>_0x32502b!=='.'&&_0x32502b!=='..');return _0x3942b8;}export function listState(){const _0x2bf9c5=a0_0x3ec284,_0x43a3dd=Module[_0x2bf9c5(0x1e8)]()[_0x2bf9c5(0x233)](_0x5b46e3=>_0x5b46e3!=='.'&&_0x5b46e3!=='..');return _0x43a3dd;}export function listCheat(){const _0x55ea9b=a0_0x3ec284,_0x4901dc=Module[_0x55ea9b(0x1fc)]()[_0x55ea9b(0x233)](_0x1c3076=>_0x1c3076!=='.'&&_0x1c3076!=='..');return _0x4901dc;}export function listScreenshot(){const _0x1823f8=a0_0x3ec284,_0x50eeb9=Module[_0x1823f8(0x1e1)]()['filter'](_0x29ac04=>_0x29ac04!=='.'&&_0x29ac04!=='..');return _0x50eeb9;}export function embedTextInPngFile(_0x527377,_0x16e113,_0x2acb11){const _0x4599f7=a0_0x3ec284;let _0x27243a=atob(_0x527377[_0x4599f7(0x1f7)](',')[0x1]),_0x3c6626=new Uint8Array(_0x27243a[_0x4599f7(0x256)]);for(let _0x4df1a8=0x0;_0x4df1a8<_0x27243a[_0x4599f7(0x256)];_0x4df1a8++){_0x3c6626[_0x4df1a8]=_0x27243a['charCodeAt'](_0x4df1a8);}let _0x13dad3=new TextEncoder()[_0x4599f7(0x201)](_0x4599f7(0x24f)+_0x16e113),_0x42d535=new Uint8Array(_0x3c6626[_0x4599f7(0x256)]+_0x13dad3['length']);_0x42d535[_0x4599f7(0x1fd)](_0x3c6626,0x0),_0x42d535[_0x4599f7(0x1fd)](_0x13dad3,_0x3c6626[_0x4599f7(0x256)]);let _0x54fd65=new Blob([_0x42d535],{'type':_0x4599f7(0x254)}),_0x465152=new File([_0x54fd65],_0x2acb11,{'type':_0x4599f7(0x254)});return _0x465152;}export function extractTextFromPngBase64(_0xb5c743){const _0x1d77dc=a0_0x3ec284;let _0x4257e2=atob(_0xb5c743[_0x1d77dc(0x1f7)](',')[0x1]),_0x391f5a=_0x1d77dc(0x24f),_0x18f6f7=_0x4257e2[_0x1d77dc(0x24c)](_0x391f5a);if(_0x18f6f7!==-0x1)return _0x4257e2['substring'](_0x18f6f7+_0x391f5a[_0x1d77dc(0x256)]);return null;}export function fileSize(_0x10ba83){const _0x205d22=a0_0x3ec284,_0x1b7e51=Module[_0x205d22(0x1df)](_0x10ba83);return _0x1b7e51;}export async function resumeGame(){const _0x140fed=a0_0x3ec284;Module[_0x140fed(0x22f)](),Module[_0x140fed(0x220)](),notiMessage(_0x140fed(0x1e3),0x7d0);}export async function pauseGame(){const _0x2f5394=a0_0x3ec284;Module[_0x2f5394(0x230)](),Module[_0x2f5394(0x220)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x1c207b){Module['buttonPress'](_0x1c207b);}export async function buttonUnpress(_0x6a95b0){const _0x2864f7=a0_0x3ec284;Module[_0x2864f7(0x209)](_0x6a95b0);}export async function screenShot(_0x22efb2){const _0xcfab7=a0_0x3ec284,_0x39f5b2=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0x22efb2+_0xcfab7(0x1fe)),_0x3ff2ac=await getData(gameName,_0x22efb2,_0xcfab7(0x1e9))||'';console[_0xcfab7(0x255)](_0x3ff2ac),await Module['screenshot'](_0x39f5b2),await setData(gameName,_0x22efb2,'saveTime',formatDateTime(Date[_0xcfab7(0x21d)]()),_0x3ff2ac);}export async function dowloadScreenShot(_0x5998a1){const _0x37e733=a0_0x3ec284;try{const _0x176301=await fileToBase64(Module[_0x37e733(0x1f9)](_0x5998a1));return _0x176301;}catch{}}export async function captureOCR(_0x6c1c38){const _0x1d7e21=a0_0x3ec284;Module['screenshot'](_0x6c1c38);const _0x7ac248=Module[_0x1d7e21(0x1f9)](_0x1d7e21(0x226)+_0x6c1c38);return _0x7ac248;}export async function setFastForwardMultiplier(_0x1a2c20){const _0xdf77fd=a0_0x3ec284;Module[_0xdf77fd(0x1ee)](_0x1a2c20);}function a0_0x5911(){const _0x143f93=['createObjectURL','Resumed!','match','addEventListener','turboF','join','listStates','All','setItem','entries','createElement','files','setFastForwardMultiplier','#20A5A6','pagehide','FSSync','led0','led07','8OmcTJs','8UCYKJh','loadState','split','230VWdDWT','downloadFile','editFileName','deleteFile','listCheats','set','.png','toString','bottom','encode','loadGame','16300460gErSLT','getElementById','led01','gbc1','uploadAll','error','buttonUnpress','padStart','fill','led04','setVolume','237432kNiUgE','contains','/data/games/','remove','appendChild','endsWith','turboState','lastIndexOf','1991vDNlWx','1259178GhLKjt','style','\x20|\x20','.ss0','opacity','1928ChhYkS','now','/data/states/','concat','SDL2','type','screenshot','add','includes','200rbiqMv','/data/screenshots/','innerWidth','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','listRoms','led03','rgba(245,\x20232,\x20209,\x200.4)','beforeunload','disable','getItem','resumeGame','pauseGame','visible','listSaves','filter','#E0C068','replace','saveState','body','uId','slotStateSaved','hidden','onLine','download','led06','href','\x20time(s)','led05','textContent','3426311OtCOsg','Auto\x20save\x20','trim','map','revokeObjectURL','gbc','exec','charCodeAt','classList','state','indexOf','application/octet-stream','328725IlcfiT','tEXtComment\x00','.gb','led00','screenSize','visibilitychange','image/png','log','length','substring','click','62195136UdEmHM','FSInit','fileSize','canvas','listScreenshots'];a0_0x5911=function(){return _0x143f93;};return a0_0x5911();}export async function uploadCheats(_0xeb9bda){Module['autoLoadCheats'](async),Module['uploadAll'](_0xeb9bda,async()=>{const _0x4b97ee=a0_0xaa06;await Module[_0x4b97ee(0x1f1)]();});}export function setVolume(_0x41f20b){const _0x2814ac=a0_0x3ec284;Module[_0x2814ac(0x20d)](_0x41f20b);}export async function setData(_0x1108e7,_0x5801f1,_0x46c778,_0x16cc8e,_0x39e68e=''){const _0x5dbd62=a0_0x3ec284,_0x52daac=_0x1108e7[_0x5dbd62(0x235)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x154b3b=_0x5dbd62(0x226)+_0x52daac+'_'+_0x5801f1+_0x5dbd62(0x1fe);let _0x1518a2;try{_0x1518a2=await fileToBase64(Module['downloadFile'](_0x154b3b));}catch(_0x339ee3){await Module[_0x5dbd62(0x222)](_0x52daac+'_'+_0x5801f1+_0x5dbd62(0x1fe)),await delay(0xc8),_0x1518a2=await fileToBase64(Module['downloadFile'](_0x154b3b));}let _0x3d1e75=atob(_0x1518a2[_0x5dbd62(0x1f7)](',')[0x1]),_0x1174dc=_0x5dbd62(0x24f),_0x2cbeca=_0x3d1e75[_0x5dbd62(0x24c)](_0x1174dc),_0x3543b7={};if(_0x2cbeca!==-0x1||_0x39e68e[_0x5dbd62(0x244)]()!==''){let _0x49acc8=_0x2cbeca!==-0x1?_0x3d1e75[_0x5dbd62(0x257)](_0x2cbeca+_0x1174dc[_0x5dbd62(0x256)]):_0x39e68e,_0x4d9a34=/(\w+)\s*:\s*([^|]*)/g,_0x426e77;while((_0x426e77=_0x4d9a34[_0x5dbd62(0x248)](_0x49acc8))!==null){_0x3543b7[_0x426e77[0x1]['trim']()]=_0x426e77[0x2][_0x5dbd62(0x244)]();}_0x2cbeca!==-0x1&&(_0x3d1e75=_0x3d1e75['substring'](0x0,_0x2cbeca));}_0x3543b7[_0x46c778]=_0x16cc8e;let _0x160506=Object[_0x5dbd62(0x1eb)](_0x3543b7)[_0x5dbd62(0x245)](([_0x4414d4,_0x708eb9])=>_0x4414d4+'\x20:\x20'+_0x708eb9)[_0x5dbd62(0x1e7)](_0x5dbd62(0x219)),_0x31ebde=new TextEncoder()[_0x5dbd62(0x201)](_0x1174dc+'\x20'+_0x160506),_0xf3d1c4=new Uint8Array([..._0x3d1e75][_0x5dbd62(0x245)](_0x5fd22d=>_0x5fd22d[_0x5dbd62(0x249)](0x0))[_0x5dbd62(0x21f)]([..._0x31ebde])),_0x1324fd=new File([new Blob([_0xf3d1c4],{'type':'image/png'})],_0x52daac+'_'+_0x5801f1+_0x5dbd62(0x1fe),{'type':'image/png'});Module['uploadAll'](_0x1324fd,()=>{});}export async function getData(_0x452272,_0x59e19b,_0x2707b1){const _0x52511b=a0_0x3ec284;try{const _0x3bb408=_0x452272[_0x52511b(0x235)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x349c10=_0x52511b(0x226)+_0x3bb408+'_'+_0x59e19b+_0x52511b(0x1fe);let _0x5a6228;try{_0x5a6228=await fileToBase64(Module['downloadFile'](_0x349c10));}catch(_0x279885){return null;}let _0x3137a9=atob(_0x5a6228[_0x52511b(0x1f7)](',')[0x1]),_0x249d4c=_0x52511b(0x24f),_0x2d83d5=_0x3137a9[_0x52511b(0x24c)](_0x249d4c);if(_0x2d83d5!==-0x1){let _0x2494da=_0x3137a9[_0x52511b(0x257)](_0x2d83d5+_0x249d4c[_0x52511b(0x256)]);if(_0x2707b1===_0x52511b(0x1e9))return _0x2494da[_0x52511b(0x244)]();let _0x2b676d=new RegExp(_0x2707b1+_0x52511b(0x228)),_0x4c37bb=_0x2494da[_0x52511b(0x1e4)](_0x2b676d);if(_0x4c37bb)return _0x4c37bb[0x1]['trim']();}}catch(_0x2bb5bf){return console[_0x52511b(0x208)]({'romName':_0x452272,'slot':_0x59e19b,'type':_0x2707b1}),null;}}export async function ledSave(_0x5dce22){const _0x382dba=a0_0x3ec284,_0x8b7d53=parseInt(await getData(gameName,'0',_0x382dba(0x239))),_0xbecd4e=_0x8b7d53===0x1?_0x382dba(0x205):_0x8b7d53===0x2?'led02':_0x8b7d53===0x3?_0x382dba(0x22a):_0x8b7d53===0x4?_0x382dba(0x20c):_0x8b7d53===0x5?_0x382dba(0x240):_0x8b7d53===0x6?_0x382dba(0x23d):_0x8b7d53===0x7?_0x382dba(0x1f3):_0x382dba(0x251);try{for(let _0x145de9=0x0;_0x145de9<=0x7;_0x145de9++){document[_0x382dba(0x204)](_0x382dba(0x1f2)+_0x145de9)[_0x382dba(0x218)][_0x382dba(0x20b)]=_0x382dba(0x22b);}await delay(0x3e8);for(let _0x249598=0x0;_0x249598<=0x7;_0x249598++){document[_0x382dba(0x204)]('led0'+_0x249598)[_0x382dba(0x218)][_0x382dba(0x20b)]='rgba(245,\x20232,\x20209,\x200.4)';}document[_0x382dba(0x204)](_0xbecd4e)[_0x382dba(0x218)]['fill']=_0x5dce22;}catch(_0x8aae28){console[_0x382dba(0x208)]('Error\x20ledSave:',_0x8aae28);}};export async function notiMessage(_0x9a6a76,_0x50b7aa,_0x517b71=![]){const _0x4628a2=a0_0x3ec284;var _0x296e54=document[_0x4628a2(0x204)]('noti-mess');const _0x3b4265=parseInt(await getData(gameName,'0',_0x4628a2(0x239)))||0x0;_0x296e54['style'][_0x4628a2(0x21b)]==='0.4'&&(clearTimeout(messageTimeout),_0x296e54[_0x4628a2(0x218)][_0x4628a2(0x21b)]='0'),_0x296e54[_0x4628a2(0x241)]=_0x9a6a76,_0x296e54[_0x4628a2(0x218)]['opacity']='0.4',messageTimeout=setTimeout(()=>{const _0x44617e=_0x4628a2;_0x296e54['textContent']='['+_0x3b4265+']\x20'+gameName[_0x44617e(0x257)](0x0,gameName[_0x44617e(0x215)]('.')),_0x296e54[_0x44617e(0x218)][_0x44617e(0x21b)]='0.4';},_0x50b7aa),_0x517b71&&(canvas[_0x4628a2(0x24a)][_0x4628a2(0x223)](_0x4628a2(0x231)),setTimeout(()=>{const _0x26e93f=_0x4628a2;canvas[_0x26e93f(0x24a)][_0x26e93f(0x211)]('visible');},0x258));}