const a0_0x17e3b5=a0_0x487d;function a0_0x2f0d(){const _0x5c39dc=['replace','getElementById','76705lyxhUF','listScreenshots','deleteFile','add','click','timer','charCodeAt','textContent','setVolume','remove','contains','/data/screenshots/','fileSize','screenshot','turboF','.ss0','visible','now','loadState','state','classList','Resumed!','Cheat\x20Enabled!','6547680BjzqZD','includes','loadGame','buttonPress','listCheats','SDL2','.png','uId','image/png','downloadFile','1554150PclKNU','body','uploadRom','endsWith','set','beforeunload','12276ZwSMuj','slotStateSaved','onLine','length','Cloud\x20upload\x20','.gb','resumeGame','autoLoadCheats','type','padStart','addEventListener','download','createObjectURL','Paused!','screenSize','visibilityState','_savedCheats','2wOKCDm','hidden','15BeanHn','/data/states/','filter','473557pRMGbh','visibilitychange','getItem','FSSync','setItem','split','buttonUnpress','.gbc','saveState','tEXtComment\x00','indexOf','setFastForwardMultiplier','href','\x20time(s)','style','153omWulT','gbc1','control-setting','gameName','innerWidth','uploadAll','log','500770BczBQf','FSInit','#20A5A6','pagehide','createElement','canvas','Do\x20you\x20want\x20to\x20load\x20save\x20state?','1030182imOedd','disable','substring','listRoms','listSaves'];a0_0x2f0d=function(){return _0x5c39dc;};return a0_0x2f0d();}(function(_0x89fc92,_0x15661b){const _0x12abf8=a0_0x487d,_0x4a5509=_0x89fc92();while(!![]){try{const _0x56b319=-parseInt(_0x12abf8(0xe8))/0x1*(parseInt(_0x12abf8(0x120))/0x2)+-parseInt(_0x12abf8(0x109))/0x3+parseInt(_0x12abf8(0x10f))/0x4+parseInt(_0x12abf8(0x122))/0x5*(-parseInt(_0x12abf8(0x142))/0x6)+-parseInt(_0x12abf8(0x125))/0x7+parseInt(_0x12abf8(0xff))/0x8+-parseInt(_0x12abf8(0x134))/0x9*(-parseInt(_0x12abf8(0x13b))/0xa);if(_0x56b319===_0x15661b)break;else _0x4a5509['push'](_0x4a5509['shift']());}catch(_0x9299a9){_0x4a5509['push'](_0x4a5509['shift']());}}}(a0_0x2f0d,0x78eed));import a0_0x6e55c4 from'../core/mgba.js';import*as a0_0x45f1c0 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x17e3b5(0xe7)](a0_0x17e3b5(0x140))};function initializeCore(_0x481cbd,_0x43c3ae){_0x481cbd(_0x43c3ae)['then'](function(_0x4d6e82){const _0x29b5d=a0_0x487d;_0x4d6e82[_0x29b5d(0x13c)]();});}initializeCore(a0_0x6e55c4,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x17e3b5(0xe7)]('canvas'),savedTurboState=localStorage['getItem']('turboState'),controlSetting=document[a0_0x17e3b5(0xe7)](a0_0x17e3b5(0x136));function handleVisibilityChange(_0x47250c){const _0x7c09e9=a0_0x17e3b5;document[_0x7c09e9(0x11e)]===_0x7c09e9(0x121)||_0x47250c?.[_0x7c09e9(0x117)]===_0x7c09e9(0x10e)||_0x47250c?.['persisted']?(pauseGame(),canvas[_0x7c09e9(0xfc)]['add'](_0x7c09e9(0xf8))):(setTimeout(()=>{const _0x576b82=_0x7c09e9;canvas[_0x576b82(0xfc)]['remove'](_0x576b82(0xf8));},0x258),controlSetting[_0x7c09e9(0xfc)][_0x7c09e9(0xf2)](_0x7c09e9(0xf8))&&resumeGame());}async function statusShow(){const _0x4505de=a0_0x17e3b5;document[_0x4505de(0x119)](_0x4505de(0x13e),handleVisibilityChange),document['addEventListener'](_0x4505de(0x126),handleVisibilityChange),window[_0x4505de(0x119)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x45f1c0[_0x4505de(0xf6)](turboState)),await delay(0xc8),await Module[_0x4505de(0x104)](),await delay(0x320),await led(parseInt(localStorage[_0x4505de(0x127)](_0x4505de(0x110)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3325d3=a0_0x17e3b5;await ledSave(_0x3325d3(0x13d)),await Module[_0x3325d3(0x12d)](0x0),await Module[_0x3325d3(0x128)](),await screenShot(0x0),console[_0x3325d3(0x13a)]('Auto\x20save\x20'+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x3927eb=a0_0x17e3b5,_0x585606=localStorage[_0x3927eb(0x127)](_0x3927eb(0x137)),_0x5dcb39=_0x585606['replace'](/\.(zip|gb|gbc|gba)$/,_0x3927eb(0xf7)),_0x42bed3=localStorage[_0x3927eb(0x127)](_0x3927eb(0x106));navigator[_0x3927eb(0x111)]&&(_0x42bed3&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x5dcb39,Module['downloadFile'](_0x3927eb(0x123)+_0x5dcb39),_0x3927eb(0xfb)),await lockNoti('',_0x3927eb(0x113)+ ++countUpload+_0x3927eb(0x132),0x7d0)));}function startTimer(){let [_0x114065,_0x3f3387,_0x2d6e83,_0x29aad6,_0xc3bb71]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x302d80=a0_0x487d;_0x2d6e83++,_0x29aad6++,_0xc3bb71++;if(_0x2d6e83===0x3c)[_0x2d6e83,_0x3f3387]=[0x0,_0x3f3387+0x1];if(_0x3f3387===0x3c)[_0x3f3387,_0x114065]=[0x0,_0x114065+0x1];document[_0x302d80(0xe7)](_0x302d80(0xed))[_0x302d80(0xef)]=_0x114065+'h'+_0x3f3387['toString']()[_0x302d80(0x118)](0x2,'0')+'.'+_0x2d6e83['toString']()[_0x302d80(0x118)](0x2,'0');_0x29aad6===0x3c&&(saveStatePeriodically(),_0x29aad6=0x0);;_0xc3bb71===0x708&&(saveStateInCloud(),_0xc3bb71=0x0);;},0x3e8);}export async function uploadGame(_0x2d9d66){const _0x3afe84=a0_0x17e3b5,_0x1fcb11=_0x2d9d66['files'][0x0];Module[_0x3afe84(0x10b)](_0x1fcb11,()=>{Module['FSSync']();});}export async function loadGame(_0x3a277d){const _0x50742d=a0_0x17e3b5,_0x7973aa=_0x3a277d[_0x50742d(0xe6)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x30dd80=Module['listStates']()['filter'](_0x4394e0=>_0x4394e0!=='.'&&_0x4394e0!=='..');intro[_0x50742d(0xfc)][_0x50742d(0xeb)](_0x50742d(0xe2)),errorLogElements[0x0][_0x50742d(0x133)]['bottom']='0',ingame[_0x50742d(0xfc)][_0x50742d(0xf1)](_0x50742d(0xe2)),_0x3a277d[_0x50742d(0x10c)](_0x50742d(0x12c))||_0x3a277d['endsWith'](_0x50742d(0x114))?(canvas['classList'][_0x50742d(0xeb)]('gbc'),areaTrans['classList'][_0x50742d(0xeb)](_0x50742d(0x135)),localStorage[_0x50742d(0x129)](_0x50742d(0x11d),'0,0,'+(window[_0x50742d(0x138)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x50742d(0x129)](_0x50742d(0x11d),'0,0,'+(window[_0x50742d(0x138)]-0x96)+','+(window[_0x50742d(0x138)]-0x96)*0x2/0x3),_0x30dd80[_0x50742d(0x100)](_0x7973aa)?(await Module[_0x50742d(0x101)]('/data/games/'+_0x3a277d),confirm(_0x50742d(0x141))&&(await Module['loadState'](0x0),localStorage['setItem'](_0x50742d(0x137),_0x3a277d),console[_0x50742d(0x13a)](_0x3a277d))):(await Module[_0x50742d(0x101)]('/data/games/'+_0x3a277d),localStorage['setItem']('gameName',_0x3a277d),console[_0x50742d(0x13a)](_0x3a277d)),await statusShow();}export async function saveState(_0x525db2){const _0x5e4627=a0_0x17e3b5;await Module[_0x5e4627(0x12d)](_0x525db2),await Module[_0x5e4627(0x128)]();}export async function loadState(_0x2edc56){const _0x142f14=a0_0x17e3b5;await Module[_0x142f14(0xfa)](_0x2edc56);}export async function downloadFile(_0x1e134b,_0x168e81){const _0x5b6eca=a0_0x17e3b5,_0x1bbbaa=Module[_0x5b6eca(0x108)](_0x1e134b),_0x30457a=document[_0x5b6eca(0x13f)]('a');document[_0x5b6eca(0x10a)]['appendChild'](_0x30457a),_0x30457a[_0x5b6eca(0x11a)]=_0x168e81;const _0x56ee6a=new Blob([_0x1bbbaa],{'type':'application/octet-stream'});_0x30457a[_0x5b6eca(0x131)]=URL[_0x5b6eca(0x11b)](_0x56ee6a),_0x30457a[_0x5b6eca(0xec)](),URL['revokeObjectURL'](_0x56ee6a),_0x30457a['remove']();}export function downloadFileInCloud(_0x12a794){const _0x5f0bbe=a0_0x17e3b5,_0x547ef4=Module[_0x5f0bbe(0x108)](_0x12a794);return _0x547ef4;}export async function uploadFileInCloud(_0x3a8f97){const _0x686dbb=a0_0x17e3b5;Module[_0x686dbb(0x139)](_0x3a8f97,()=>{localStorageFile(),Module['FSSync']();});}export async function uploadFile(_0x1c418f){const _0x5f0f1c=_0x1c418f['files'][0x0];Module['uploadAll'](_0x5f0f1c,()=>{localStorageFile(),Module['FSSync']();});}export async function editFile(_0x473ca0,_0x512b85,_0xe2c1a2){const _0x257ac6=a0_0x17e3b5;await Module['editFileName'](_0x473ca0,_0x512b85,_0xe2c1a2),await Module[_0x257ac6(0x128)]();}export async function deleteFile(_0x4fd77a){const _0x31651e=a0_0x17e3b5;await Module[_0x31651e(0xea)](_0x4fd77a),await Module[_0x31651e(0x128)]();}export function listGame(){const _0xa5d84f=a0_0x17e3b5,_0x46ccb2=Module[_0xa5d84f(0xe4)]()[_0xa5d84f(0x124)](_0x44b1ad=>_0x44b1ad!=='.'&&_0x44b1ad!=='..');return _0x46ccb2;}export function listSave(){const _0x110d5b=a0_0x17e3b5,_0x3fd6ba=Module[_0x110d5b(0xe5)]()[_0x110d5b(0x124)](_0x3308d6=>_0x3308d6!=='.'&&_0x3308d6!=='..');return _0x3fd6ba;}export function listState(){const _0x14ecb1=Module['listStates']()['filter'](_0x382959=>_0x382959!=='.'&&_0x382959!=='..');return _0x14ecb1;}export function listCheat(){const _0x468aa0=a0_0x17e3b5,_0x1cbad9=Module[_0x468aa0(0x103)]()[_0x468aa0(0x124)](_0x5b8898=>_0x5b8898!=='.'&&_0x5b8898!=='..');return _0x1cbad9;}export function listScreenshot(){const _0x3d783f=a0_0x17e3b5,_0x3ed6e0=Module[_0x3d783f(0xe9)]()[_0x3d783f(0x124)](_0x35c9e2=>_0x35c9e2!=='.'&&_0x35c9e2!=='..');return _0x3ed6e0;}export function embedTextInPngFile(_0x424173,_0x381a61,_0x47c813){const _0x311901=a0_0x17e3b5;let _0x7a4b17=atob(_0x424173[_0x311901(0x12a)](',')[0x1]),_0x3ff524=new Uint8Array(_0x7a4b17['length']);for(let _0x5e4af7=0x0;_0x5e4af7<_0x7a4b17[_0x311901(0x112)];_0x5e4af7++){_0x3ff524[_0x5e4af7]=_0x7a4b17[_0x311901(0xee)](_0x5e4af7);}let _0x16d8e2=new TextEncoder()['encode']('tEXtComment\x00'+_0x381a61),_0x129b38=new Uint8Array(_0x3ff524[_0x311901(0x112)]+_0x16d8e2[_0x311901(0x112)]);_0x129b38[_0x311901(0x10d)](_0x3ff524,0x0),_0x129b38[_0x311901(0x10d)](_0x16d8e2,_0x3ff524['length']);let _0x46c39a=new Blob([_0x129b38],{'type':_0x311901(0x107)}),_0x35c14c=new File([_0x46c39a],_0x47c813,{'type':_0x311901(0x107)});return _0x35c14c;}export function extractTextFromPngBase64(_0x3044b7){const _0x35d261=a0_0x17e3b5;let _0x3ce573=atob(_0x3044b7[_0x35d261(0x12a)](',')[0x1]),_0x96f765=_0x35d261(0x12e),_0x1f09f7=_0x3ce573[_0x35d261(0x12f)](_0x96f765);if(_0x1f09f7!==-0x1)return _0x3ce573[_0x35d261(0xe3)](_0x1f09f7+_0x96f765[_0x35d261(0x112)]);return null;}export function fileSize(_0x4652c6){const _0x457025=a0_0x17e3b5,_0x509677=Module[_0x457025(0xf4)](_0x4652c6);return _0x509677;}export async function resumeGame(){const _0x31bbdd=a0_0x17e3b5;Module[_0x31bbdd(0x115)](),Module[_0x31bbdd(0x104)](),notiMessage(_0x31bbdd(0xfd),0x7d0);}export async function pauseGame(){const _0x51aeea=a0_0x17e3b5;Module['pauseGame'](),Module[_0x51aeea(0x104)](),notiMessage(_0x51aeea(0x11c),0x7d0);}export async function buttonPress(_0x3e0fa5){const _0x4ae248=a0_0x17e3b5;Module[_0x4ae248(0x102)](_0x3e0fa5);}export async function buttonUnpress(_0x180cd1){const _0x410903=a0_0x17e3b5;Module[_0x410903(0x12b)](_0x180cd1);}function a0_0x487d(_0x543c28,_0x2a9065){const _0x2f0d5a=a0_0x2f0d();return a0_0x487d=function(_0x487d76,_0x4a1fe9){_0x487d76=_0x487d76-0xe2;let _0x10f1c8=_0x2f0d5a[_0x487d76];return _0x10f1c8;},a0_0x487d(_0x543c28,_0x2a9065);}export async function screenShot(_0x27de0a){const _0x1d35b6=a0_0x17e3b5,_0x4647e7=localStorage['getItem']('gameName')[_0x1d35b6(0xe6)](/\.(gba|gbc|gb|zip)$/,''),_0x4b1888=_0x4647e7+'_'+_0x27de0a+_0x1d35b6(0x105);await Module[_0x1d35b6(0xf5)](_0x4b1888),await Module['FSSync']();const _0x51ab56=await fileToBase64(Module[_0x1d35b6(0x108)](_0x1d35b6(0xf3)+_0x4b1888)),_0x159fdc=embedTextInPngFile(_0x51ab56,formatDateTime(Date[_0x1d35b6(0xf9)]()),_0x4b1888);Module['uploadAll'](_0x159fdc,()=>{const _0x2a5964=_0x1d35b6;localStorageFile(),Module[_0x2a5964(0x128)]();});}export async function dowloadScreenShot(_0x37fc19){try{const _0x3671f8=await fileToBase64(Module['downloadFile'](_0x37fc19));return _0x3671f8;}catch{}}export async function captureOCR(_0x19c5be){const _0x136aec=a0_0x17e3b5;Module[_0x136aec(0xf5)](_0x19c5be);const _0x51eb44=Module[_0x136aec(0x108)](_0x136aec(0xf3)+_0x19c5be);return _0x51eb44;}export async function setFastForwardMultiplier(_0x345e6f){const _0x15c744=a0_0x17e3b5;Module[_0x15c744(0x130)](_0x345e6f);}export function uploadCheats(_0x450c25,_0x4fb73a,_0x335342,_0x7f1ff7,_0x484f8e){const _0x29fdd1=a0_0x17e3b5;Module[_0x29fdd1(0x139)](_0x450c25,()=>{const _0x27d93d=_0x29fdd1;Module[_0x27d93d(0x116)](),setTimeout(()=>{const _0x41b25d=_0x27d93d;Module[_0x41b25d(0x128)]();},0x1f4),_0x7f1ff7&&(localStorage[_0x27d93d(0x129)](_0x4fb73a+_0x27d93d(0x11f),_0x335342),notiMessage(_0x27d93d(0xfe),0x5dc)),_0x484f8e[_0x27d93d(0xef)]=localStorage[_0x27d93d(0x127)](_0x4fb73a+_0x27d93d(0x11f)||'Off');});}export function setVolume(_0x341e0a){const _0x11a9c4=a0_0x17e3b5;Module[_0x11a9c4(0xf0)](_0x341e0a);}