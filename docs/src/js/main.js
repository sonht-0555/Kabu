const a0_0x46c64a=a0_0x6356;(function(_0x3d3a8e,_0x1227d4){const _0x11ad20=a0_0x6356,_0x161a22=_0x3d3a8e();while(!![]){try{const _0x212889=-parseInt(_0x11ad20(0x12e))/0x1+parseInt(_0x11ad20(0x12a))/0x2*(parseInt(_0x11ad20(0x106))/0x3)+parseInt(_0x11ad20(0xdd))/0x4*(parseInt(_0x11ad20(0xf5))/0x5)+parseInt(_0x11ad20(0x111))/0x6*(-parseInt(_0x11ad20(0x10b))/0x7)+-parseInt(_0x11ad20(0xf0))/0x8*(parseInt(_0x11ad20(0x10e))/0x9)+-parseInt(_0x11ad20(0x11a))/0xa*(-parseInt(_0x11ad20(0xe5))/0xb)+parseInt(_0x11ad20(0xd3))/0xc*(parseInt(_0x11ad20(0x12d))/0xd);if(_0x212889===_0x1227d4)break;else _0x161a22['push'](_0x161a22['shift']());}catch(_0x34f7e5){_0x161a22['push'](_0x161a22['shift']());}}}(a0_0x18fb,0xeeef2));import a0_0x58f350 from'../core/mgba.js';import*as a0_0x48550c from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x46c64a(0x107)](a0_0x46c64a(0xe6))};function initializeCore(_0x46af27,_0x1b5c82){_0x46af27(_0x1b5c82)['then'](function(_0x72b295){const _0x515551=a0_0x6356;_0x72b295[_0x515551(0xd7)]();});}initializeCore(a0_0x58f350,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x46c64a(0x107)](a0_0x46c64a(0xe6)),savedTurboState=localStorage[a0_0x46c64a(0xdf)]('turboState'),controlSetting=document[a0_0x46c64a(0x107)]('control-setting');function handleVisibilityChange(_0x12945f){const _0x318ead=a0_0x46c64a;document[_0x318ead(0xdc)]===_0x318ead(0x128)||_0x12945f?.[_0x318ead(0xfa)]==='beforeunload'||_0x12945f?.['persisted']?(pauseGame(),canvas['classList'][_0x318ead(0xed)](_0x318ead(0x109))):(setTimeout(()=>{const _0x54b3bc=_0x318ead;canvas[_0x54b3bc(0x105)][_0x54b3bc(0x12c)](_0x54b3bc(0x109));},0x258),controlSetting[_0x318ead(0x105)][_0x318ead(0xf2)](_0x318ead(0x109))&&resumeGame());}async function statusShow(){const _0x404fb0=a0_0x46c64a;document[_0x404fb0(0x120)](_0x404fb0(0x110),handleVisibilityChange),document['addEventListener'](_0x404fb0(0x11e),handleVisibilityChange),window[_0x404fb0(0x120)](_0x404fb0(0xd8),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x48550c[_0x404fb0(0xd5)](turboState)),await delay(0xc8),await Module[_0x404fb0(0x112)](),await delay(0x320),await led(parseInt(localStorage[_0x404fb0(0xdf)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x502bb5=a0_0x46c64a;await ledSave('#20A5A6'),await Module[_0x502bb5(0xd6)](0x0),await Module[_0x502bb5(0xec)](),await screenShot(0x0),console['log']('Auto\x20save\x20'+ ++countAutoSave+_0x502bb5(0x10f));}async function saveStateInCloud(){const _0xc64605=a0_0x46c64a,_0x49d2c3=localStorage[_0xc64605(0xdf)](_0xc64605(0x101)),_0x3e1e25=_0x49d2c3[_0xc64605(0xde)](/\.(zip|gb|gbc|gba)$/,_0xc64605(0xeb)),_0x2f0dc9=localStorage[_0xc64605(0xdf)]('uId');navigator['onLine']&&(_0x2f0dc9&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x3e1e25,Module[_0xc64605(0xea)](_0xc64605(0x119)+_0x3e1e25),'state'),await lockNoti('',_0xc64605(0x114)+ ++countUpload+_0xc64605(0x10f),0x7d0)));}function startTimer(){let [_0xef8e6,_0x35ddc1,_0x34fc6e,_0x410cd7,_0x11daad]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x564f52=a0_0x6356;_0x34fc6e++,_0x410cd7++,_0x11daad++;if(_0x34fc6e===0x3c)[_0x34fc6e,_0x35ddc1]=[0x0,_0x35ddc1+0x1];if(_0x35ddc1===0x3c)[_0x35ddc1,_0xef8e6]=[0x0,_0xef8e6+0x1];document[_0x564f52(0x107)](_0x564f52(0x10a))[_0x564f52(0x124)]=_0xef8e6+'h'+_0x35ddc1[_0x564f52(0xe7)]()[_0x564f52(0xf6)](0x2,'0')+'.'+_0x34fc6e['toString']()['padStart'](0x2,'0');_0x410cd7===0x3c&&(saveStatePeriodically(),_0x410cd7=0x0);;_0x11daad===0x708&&(saveStateInCloud(),_0x11daad=0x0);;},0x3e8);}export async function uploadGame(_0xe20f7a){const _0x5d007d=a0_0x46c64a,_0x40d0cd=_0xe20f7a[_0x5d007d(0x10c)][0x0];Module['uploadRom'](_0x40d0cd,()=>{const _0x5bb38f=_0x5d007d;Module[_0x5bb38f(0xec)]();});}export async function loadGame(_0x416ab0){const _0x3d8902=a0_0x46c64a,_0x351c8a=_0x416ab0[_0x3d8902(0xde)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x585107=Module[_0x3d8902(0xda)]()[_0x3d8902(0x103)](_0x3562ff=>_0x3562ff!=='.'&&_0x3562ff!=='..');intro['classList']['add'](_0x3d8902(0x129)),errorLogElements[0x0][_0x3d8902(0xe0)]['bottom']='0',ingame[_0x3d8902(0x105)][_0x3d8902(0x12c)]('disable'),_0x416ab0['endsWith']('.gbc')||_0x416ab0['endsWith'](_0x3d8902(0x118))?(canvas['classList'][_0x3d8902(0xed)](_0x3d8902(0xe8)),areaTrans['classList']['add'](_0x3d8902(0xf8)),localStorage[_0x3d8902(0xd4)]('screenSize',_0x3d8902(0x11d)+(window[_0x3d8902(0xf7)]-0xe6)+','+(window[_0x3d8902(0xf7)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x3d8902(0x108),_0x3d8902(0x11d)+(window[_0x3d8902(0xf7)]-0x96)+','+(window[_0x3d8902(0xf7)]-0x96)*0x2/0x3),_0x585107[_0x3d8902(0xfd)](_0x351c8a)?(await Module['loadGame'](_0x3d8902(0xfb)+_0x416ab0),confirm(_0x3d8902(0xef))&&(await Module[_0x3d8902(0x121)](0x0),localStorage[_0x3d8902(0xd4)](_0x3d8902(0x101),_0x416ab0),console[_0x3d8902(0xe3)](_0x416ab0))):(await Module['loadGame'](_0x3d8902(0xfb)+_0x416ab0),localStorage[_0x3d8902(0xd4)](_0x3d8902(0x101),_0x416ab0),console[_0x3d8902(0xe3)](_0x416ab0)),await statusShow();}export async function saveState(_0x5c1c6f){const _0x5cf9fc=a0_0x46c64a;await Module[_0x5cf9fc(0xd6)](_0x5c1c6f),await Module[_0x5cf9fc(0xec)]();}export async function loadState(_0x1111dc){const _0x31e7f2=a0_0x46c64a;await Module[_0x31e7f2(0x121)](_0x1111dc);}export async function downloadFile(_0xd0633b,_0x3d835c){const _0x40bc13=a0_0x46c64a,_0x3fe6c4=Module['downloadFile'](_0xd0633b),_0x355eb3=document[_0x40bc13(0xe9)]('a');document[_0x40bc13(0xf3)][_0x40bc13(0xf4)](_0x355eb3),_0x355eb3[_0x40bc13(0x102)]=_0x3d835c;const _0x3993ed=new Blob([_0x3fe6c4],{'type':_0x40bc13(0x127)});_0x355eb3['href']=URL['createObjectURL'](_0x3993ed),_0x355eb3['click'](),URL[_0x40bc13(0xe4)](_0x3993ed),_0x355eb3[_0x40bc13(0x12c)]();}export function downloadFileInCloud(_0x3f6bca){const _0xd57868=a0_0x46c64a,_0x87c146=Module[_0xd57868(0xea)](_0x3f6bca);return _0x87c146;}export async function uploadFileInCloud(_0x2d748e){const _0x293bf8=a0_0x46c64a;Module[_0x293bf8(0x11f)](_0x2d748e,()=>{const _0x270b6d=_0x293bf8;localStorageFile(),Module[_0x270b6d(0xec)]();});}export async function uploadFile(_0x407368){const _0x158ec3=a0_0x46c64a,_0x54f062=_0x407368[_0x158ec3(0x10c)][0x0];Module['uploadAll'](_0x54f062,()=>{const _0x52c3db=_0x158ec3;localStorageFile(),Module[_0x52c3db(0xec)]();});}export async function editFile(_0x875aa6,_0xcf1946,_0x40267f){const _0x26e166=a0_0x46c64a;await Module[_0x26e166(0x117)](_0x875aa6,_0xcf1946,_0x40267f),await Module[_0x26e166(0xec)]();}export async function deleteFile(_0x29c721){const _0x28aa38=a0_0x46c64a;await Module[_0x28aa38(0x116)](_0x29c721),await Module[_0x28aa38(0xec)]();}export function listGame(){const _0x34f3d6=a0_0x46c64a,_0x25ed60=Module[_0x34f3d6(0x11b)]()[_0x34f3d6(0x103)](_0x3db75c=>_0x3db75c!=='.'&&_0x3db75c!=='..');return _0x25ed60;}export function listSave(){const _0x157cac=Module['listSaves']()['filter'](_0x514841=>_0x514841!=='.'&&_0x514841!=='..');return _0x157cac;}export function listState(){const _0x23873b=a0_0x46c64a,_0x585890=Module['listStates']()[_0x23873b(0x103)](_0x53173d=>_0x53173d!=='.'&&_0x53173d!=='..');return _0x585890;}export function listCheat(){const _0x2af5c6=a0_0x46c64a,_0x6da98a=Module[_0x2af5c6(0xff)]()[_0x2af5c6(0x103)](_0x311c62=>_0x311c62!=='.'&&_0x311c62!=='..');return _0x6da98a;}function a0_0x18fb(){const _0x5402d2=['toString','gbc','createElement','downloadFile','.ss0','FSSync','add','buttonUnpress','Do\x20you\x20want\x20to\x20load\x20save\x20state?','232GOjTtl','split','contains','body','appendChild','85085dFOjXX','padStart','innerWidth','gbc1','_savedCheats','type','/data/games/','autoLoadCheats','includes','substring','listCheats','set','gameName','download','filter','Resumed!','classList','1370871FxfmmB','getElementById','screenSize','visible','timer','2611SQiCOB','files','setVolume','423387aOLHNp','\x20time(s)','pagehide','9606ZmMAah','SDL2','length','Cloud\x20upload\x20','resumeGame','deleteFile','editFileName','.gb','/data/states/','6680EpRbIX','listRoms','encode','0,0,','visibilitychange','uploadAll','addEventListener','loadState','image/png','indexOf','textContent','charCodeAt','Paused!','application/octet-stream','hidden','disable','6bXQwoQ','screenshot','remove','71123SEdmBQ','1117695qJBroT','480tlOBcz','setItem','turboF','saveState','FSInit','beforeunload','Cheat\x20Enabled!','listStates','/data/screenshots/','visibilityState','200bGYIcW','replace','getItem','style','pauseGame','setFastForwardMultiplier','log','revokeObjectURL','26631klocps','canvas'];a0_0x18fb=function(){return _0x5402d2;};return a0_0x18fb();}export function listScreenshot(){const _0xf52f5a=a0_0x46c64a,_0x1b3370=Module['listScreenshots']()[_0xf52f5a(0x103)](_0x272784=>_0x272784!=='.'&&_0x272784!=='..');return _0x1b3370;}export function embedTextInPngFile(_0x521d33,_0x37709,_0x2d7af5){const _0x239e0a=a0_0x46c64a;let _0x3dac88=atob(_0x521d33['split'](',')[0x1]),_0x117fb7=new Uint8Array(_0x3dac88['length']);for(let _0x34e999=0x0;_0x34e999<_0x3dac88['length'];_0x34e999++){_0x117fb7[_0x34e999]=_0x3dac88[_0x239e0a(0x125)](_0x34e999);}let _0x435f37=new TextEncoder()[_0x239e0a(0x11c)]('tEXtComment\x00'+_0x37709),_0x3d4b40=new Uint8Array(_0x117fb7['length']+_0x435f37[_0x239e0a(0x113)]);_0x3d4b40[_0x239e0a(0x100)](_0x117fb7,0x0),_0x3d4b40[_0x239e0a(0x100)](_0x435f37,_0x117fb7[_0x239e0a(0x113)]);let _0x5e9a24=new Blob([_0x3d4b40],{'type':_0x239e0a(0x122)}),_0x4b2424=new File([_0x5e9a24],_0x2d7af5,{'type':_0x239e0a(0x122)});return _0x4b2424;}export function extractTextFromPngBase64(_0xb01264){const _0x4db42f=a0_0x46c64a;let _0x3f7a99=atob(_0xb01264[_0x4db42f(0xf1)](',')[0x1]),_0x390712='tEXtComment\x00',_0x2feb1a=_0x3f7a99[_0x4db42f(0x123)](_0x390712);if(_0x2feb1a!==-0x1)return _0x3f7a99[_0x4db42f(0xfe)](_0x2feb1a+_0x390712[_0x4db42f(0x113)]);return null;}export function fileSize(_0x151bca){const _0x56a4ee=Module['fileSize'](_0x151bca);return _0x56a4ee;}export async function resumeGame(){const _0x101e5f=a0_0x46c64a;Module[_0x101e5f(0x115)](),Module[_0x101e5f(0x112)](),notiMessage(_0x101e5f(0x104),0x7d0);}export async function pauseGame(){const _0x308ed6=a0_0x46c64a;Module[_0x308ed6(0xe1)](),Module['SDL2'](),notiMessage(_0x308ed6(0x126),0x7d0);}export async function buttonPress(_0x85eb89){Module['buttonPress'](_0x85eb89);}export async function buttonUnpress(_0x361be3){const _0x42f343=a0_0x46c64a;Module[_0x42f343(0xee)](_0x361be3);}export async function screenShot(_0x4c5fbc){const _0x37bcca=a0_0x46c64a,_0x11e8b6=localStorage['getItem'](_0x37bcca(0x101))[_0x37bcca(0xde)](/\.(gba|gbc|gb|zip)$/,''),_0x5b68c1=_0x11e8b6+'_'+_0x4c5fbc+'.png';await Module[_0x37bcca(0x12b)](_0x5b68c1),await Module[_0x37bcca(0xec)]();const _0xa9b98c=await fileToBase64(Module[_0x37bcca(0xea)]('/data/screenshots/'+_0x5b68c1)),_0xb40bd5=embedTextInPngFile(_0xa9b98c,formatDateTime(Date['now']()),_0x5b68c1);Module[_0x37bcca(0x11f)](_0xb40bd5,()=>{const _0x3348ac=_0x37bcca;localStorageFile(),Module[_0x3348ac(0xec)]();});}function a0_0x6356(_0x12378f,_0x543556){const _0x18fbd0=a0_0x18fb();return a0_0x6356=function(_0x635639,_0x3cc815){_0x635639=_0x635639-0xd3;let _0x3a947e=_0x18fbd0[_0x635639];return _0x3a947e;},a0_0x6356(_0x12378f,_0x543556);}export async function dowloadScreenShot(_0x5bb4ba){const _0x376870=a0_0x46c64a;try{const _0x2cf219=await fileToBase64(Module[_0x376870(0xea)](_0x5bb4ba));return _0x2cf219;}catch{}}export async function captureOCR(_0x1f5837){const _0x500d3b=a0_0x46c64a;Module[_0x500d3b(0x12b)](_0x1f5837);const _0x1b6643=Module[_0x500d3b(0xea)](_0x500d3b(0xdb)+_0x1f5837);return _0x1b6643;}export async function setFastForwardMultiplier(_0x1da2e7){const _0x1ed35a=a0_0x46c64a;Module[_0x1ed35a(0xe2)](_0x1da2e7);}export function uploadCheats(_0x571e5f,_0x581a1a,_0x1eaa75,_0x31dfa8,_0x37eb62){const _0x58ce2b=a0_0x46c64a;Module[_0x58ce2b(0x11f)](_0x571e5f,()=>{const _0x4312ae=_0x58ce2b;Module[_0x4312ae(0xfc)](),setTimeout(()=>{const _0x18d37f=_0x4312ae;Module[_0x18d37f(0xec)]();},0x1f4),_0x31dfa8&&(localStorage[_0x4312ae(0xd4)](_0x581a1a+_0x4312ae(0xf9),_0x1eaa75),notiMessage(_0x4312ae(0xd9),0x5dc)),_0x37eb62['textContent']=localStorage[_0x4312ae(0xdf)](_0x581a1a+'_savedCheats'||'Off');});}export function setVolume(_0x4cac1f){const _0x2d4b8c=a0_0x46c64a;Module[_0x2d4b8c(0x10d)](_0x4cac1f);}