const a0_0x598c9c=a0_0x44d2;(function(_0x79b864,_0x46d41f){const _0x2e67f3=a0_0x44d2,_0x5a1032=_0x79b864();while(!![]){try{const _0x2c6b9c=-parseInt(_0x2e67f3(0xb0))/0x1*(parseInt(_0x2e67f3(0x87))/0x2)+-parseInt(_0x2e67f3(0xad))/0x3*(parseInt(_0x2e67f3(0xbe))/0x4)+-parseInt(_0x2e67f3(0x83))/0x5*(parseInt(_0x2e67f3(0xd2))/0x6)+parseInt(_0x2e67f3(0xce))/0x7*(parseInt(_0x2e67f3(0xc2))/0x8)+parseInt(_0x2e67f3(0xb1))/0x9+-parseInt(_0x2e67f3(0x91))/0xa+-parseInt(_0x2e67f3(0xa9))/0xb*(-parseInt(_0x2e67f3(0xb3))/0xc);if(_0x2c6b9c===_0x46d41f)break;else _0x5a1032['push'](_0x5a1032['shift']());}catch(_0x47e3b5){_0x5a1032['push'](_0x5a1032['shift']());}}}(a0_0x8b21,0xe9c74));import a0_0x47cfdd from'../core/mgba.js';import*as a0_0x4756bb from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x598c9c(0x9a)](a0_0x598c9c(0xb5))};function initializeCore(_0x5f385c,_0x58b163){_0x5f385c(_0x58b163)['then'](function(_0x129075){const _0x3991e3=a0_0x44d2;_0x129075[_0x3991e3(0x8f)]();});}initializeCore(a0_0x47cfdd,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document['getElementById'](a0_0x598c9c(0xb5)),savedTurboState=localStorage[a0_0x598c9c(0xc6)]('turboState'),controlSetting=document['getElementById'](a0_0x598c9c(0x8c));function handleVisibilityChange(_0x2de729){const _0x35d2a5=a0_0x598c9c;document['visibilityState']===_0x35d2a5(0x8b)||_0x2de729?.['type']===_0x35d2a5(0xae)||_0x2de729?.['persisted']?(pauseGame(),canvas[_0x35d2a5(0xd7)][_0x35d2a5(0x90)](_0x35d2a5(0x98))):(setTimeout(()=>{const _0x59f381=_0x35d2a5;canvas[_0x59f381(0xd7)]['remove'](_0x59f381(0x98));},0x258),controlSetting[_0x35d2a5(0xd7)]['contains'](_0x35d2a5(0x98))&&resumeGame());}async function statusShow(){const _0x450baa=a0_0x598c9c;document[_0x450baa(0x7d)](_0x450baa(0xab),handleVisibilityChange),document[_0x450baa(0x7d)](_0x450baa(0xc1),handleVisibilityChange),window['addEventListener'](_0x450baa(0xae),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x4756bb[_0x450baa(0x78)](turboState)),await delay(0xc8),await Module[_0x450baa(0xc5)](),await delay(0x320),await led(parseInt(localStorage[_0x450baa(0xc6)](_0x450baa(0xd9)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x55602d=a0_0x598c9c;await ledSave('#20A5A6'),await Module[_0x55602d(0x9e)](0x0),await Module[_0x55602d(0x94)](),await screenShot(0x0),console[_0x55602d(0x92)](_0x55602d(0x9c)+ ++countAutoSave+_0x55602d(0x7b));}async function saveStateInCloud(){const _0x24dc5f=a0_0x598c9c,_0x46f5c8=localStorage[_0x24dc5f(0xc6)](_0x24dc5f(0xbb)),_0x4a15cf=_0x46f5c8[_0x24dc5f(0x99)](/\.(zip|gb|gbc|gba)$/,_0x24dc5f(0xb4)),_0x4508d8=localStorage[_0x24dc5f(0xc6)]('uId');navigator[_0x24dc5f(0xb6)]&&(_0x4508d8&&(await ledSave(_0x24dc5f(0xda)),await delay(0x3e8),await dpUploadFile(_0x4a15cf,Module[_0x24dc5f(0x85)](_0x24dc5f(0xd0)+_0x4a15cf),_0x24dc5f(0x97)),await lockNoti('',_0x24dc5f(0xc9)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0x1c909d,_0x489b6c,_0x125cfd,_0x3492fd,_0x48c1be]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x5602b6=a0_0x44d2;_0x125cfd++,_0x3492fd++,_0x48c1be++;if(_0x125cfd===0x3c)[_0x125cfd,_0x489b6c]=[0x0,_0x489b6c+0x1];if(_0x489b6c===0x3c)[_0x489b6c,_0x1c909d]=[0x0,_0x1c909d+0x1];document[_0x5602b6(0x9a)](_0x5602b6(0xc0))[_0x5602b6(0xa6)]=_0x1c909d+'h'+_0x489b6c[_0x5602b6(0x9d)]()[_0x5602b6(0x96)](0x2,'0')+'.'+_0x125cfd[_0x5602b6(0x9d)]()[_0x5602b6(0x96)](0x2,'0');_0x3492fd===0x3c&&(saveStatePeriodically(),_0x3492fd=0x0);;_0x48c1be===0x708&&(saveStateInCloud(),_0x48c1be=0x0);;},0x3e8);}export async function uploadGame(_0x35234e){const _0x3ce9dd=a0_0x598c9c,_0x473c07=_0x35234e[_0x3ce9dd(0xaa)][0x0];Module[_0x3ce9dd(0x88)](_0x473c07,()=>{const _0x2c6168=_0x3ce9dd;Module[_0x2c6168(0x94)]();});}export async function loadGame(_0x53a4f4){const _0x5c1095=a0_0x598c9c,_0x3bdead=_0x53a4f4[_0x5c1095(0x99)](/\.(gba|gbc|gb|zip)$/,_0x5c1095(0xb4)),_0x2ac0fa=Module['listStates']()['filter'](_0x296804=>_0x296804!=='.'&&_0x296804!=='..');intro['classList'][_0x5c1095(0x90)]('disable'),errorLogElements[0x0]['style']['bottom']='0',ingame['classList'][_0x5c1095(0x77)](_0x5c1095(0xbc)),_0x53a4f4[_0x5c1095(0x86)](_0x5c1095(0x82))||_0x53a4f4[_0x5c1095(0x86)](_0x5c1095(0xb8))?(canvas[_0x5c1095(0xd7)][_0x5c1095(0x90)]('gbc'),areaTrans[_0x5c1095(0xd7)][_0x5c1095(0x90)](_0x5c1095(0x89)),localStorage[_0x5c1095(0xaf)](_0x5c1095(0xbf),_0x5c1095(0x80)+(window[_0x5c1095(0xca)]-0xe6)+','+(window[_0x5c1095(0xca)]-0xe6)*0x9/0xa)):localStorage[_0x5c1095(0xaf)](_0x5c1095(0xbf),_0x5c1095(0x80)+(window[_0x5c1095(0xca)]-0x96)+','+(window[_0x5c1095(0xca)]-0x96)*0x2/0x3),_0x2ac0fa['includes'](_0x3bdead)?(await Module['loadGame'](_0x5c1095(0xba)+_0x53a4f4),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x5c1095(0x84)](0x0),localStorage[_0x5c1095(0xaf)](_0x5c1095(0xbb),_0x53a4f4),console['log'](_0x53a4f4))):(await Module['loadGame'](_0x5c1095(0xba)+_0x53a4f4),localStorage[_0x5c1095(0xaf)](_0x5c1095(0xbb),_0x53a4f4),console[_0x5c1095(0x92)](_0x53a4f4)),await statusShow();}export async function saveState(_0x47d76d){const _0x16a77b=a0_0x598c9c;await Module[_0x16a77b(0x9e)](_0x47d76d),await Module[_0x16a77b(0x94)]();}export async function loadState(_0x30b162){const _0x44cdfe=a0_0x598c9c;await Module[_0x44cdfe(0x84)](_0x30b162);}export async function downloadFile(_0x2d6cce,_0x2f62f2){const _0x3d3960=a0_0x598c9c,_0x46c745=Module[_0x3d3960(0x85)](_0x2d6cce),_0x1e218b=document[_0x3d3960(0xac)]('a');document[_0x3d3960(0xd5)]['appendChild'](_0x1e218b),_0x1e218b[_0x3d3960(0xd4)]=_0x2f62f2;const _0x161579=new Blob([_0x46c745],{'type':_0x3d3960(0xcd)});_0x1e218b[_0x3d3960(0xd8)]=URL[_0x3d3960(0xc4)](_0x161579),_0x1e218b[_0x3d3960(0xa8)](),URL[_0x3d3960(0xd3)](_0x161579),_0x1e218b['remove']();}function a0_0x8b21(){const _0x4f826b=['FSInit','add','18886340wSazYy','log','setVolume','FSSync','listStates','padStart','state','visible','replace','getElementById','/data/screenshots/','Auto\x20save\x20','toString','saveState','setFastForwardMultiplier','buttonPress','substring','set','fileSize','now','.png','textContent','listRoms','click','11wfkiNI','files','pagehide','createElement','1468878pakrAJ','beforeunload','setItem','22ULRScy','1785996KRVagA','pauseGame','85932708vTkKCV','.ss0','canvas','onLine','listCheats','.gb','indexOf','/data/games/','gameName','disable','Resumed!','12RwSthm','screenSize','timer','visibilitychange','24mIlbmt','Cheat\x20Enabled!','createObjectURL','SDL2','getItem','Off','length','Cloud\x20upload\x20','innerWidth','listScreenshots','split','application/octet-stream','1382626IgtTst','tEXtComment\x00','/data/states/','_savedCheats','294ajYkDk','revokeObjectURL','download','body','resumeGame','classList','href','slotStateSaved','#E0C068','remove','turboF','charCodeAt','image/png','\x20time(s)','buttonUnpress','addEventListener','editFileName','Paused!','0,0,','uploadAll','.gbc','180525mJiDfh','loadState','downloadFile','endsWith','169804rFKGLR','uploadRom','gbc1','filter','hidden','control-setting','deleteFile','screenshot'];a0_0x8b21=function(){return _0x4f826b;};return a0_0x8b21();}export function downloadFileInCloud(_0x9388d4){const _0x565879=a0_0x598c9c,_0x369475=Module[_0x565879(0x85)](_0x9388d4);return _0x369475;}export async function uploadFileInCloud(_0x504ea8){const _0x193b39=a0_0x598c9c;Module[_0x193b39(0x81)](_0x504ea8,()=>{const _0x5bb2e3=_0x193b39;localStorageFile(),Module[_0x5bb2e3(0x94)]();});}export async function uploadFile(_0x2f63e4){const _0x53461b=a0_0x598c9c,_0x236c60=_0x2f63e4['files'][0x0];Module[_0x53461b(0x81)](_0x236c60,()=>{const _0x553667=_0x53461b;localStorageFile(),Module[_0x553667(0x94)]();});}export async function editFile(_0x500715,_0x995bc6,_0x224138){const _0xaf694a=a0_0x598c9c;await Module[_0xaf694a(0x7e)](_0x500715,_0x995bc6,_0x224138),await Module[_0xaf694a(0x94)]();}export async function deleteFile(_0x115051){const _0x5f269e=a0_0x598c9c;await Module[_0x5f269e(0x8d)](_0x115051),await Module[_0x5f269e(0x94)]();}export function listGame(){const _0x1adebe=a0_0x598c9c,_0xc98a12=Module[_0x1adebe(0xa7)]()[_0x1adebe(0x8a)](_0x327596=>_0x327596!=='.'&&_0x327596!=='..');return _0xc98a12;}export function listSave(){const _0x2dc820=a0_0x598c9c,_0x3d613d=Module['listSaves']()[_0x2dc820(0x8a)](_0x51c780=>_0x51c780!=='.'&&_0x51c780!=='..');return _0x3d613d;}export function listState(){const _0x56920d=a0_0x598c9c,_0xc0ab19=Module[_0x56920d(0x95)]()[_0x56920d(0x8a)](_0x263f73=>_0x263f73!=='.'&&_0x263f73!=='..');return _0xc0ab19;}export function listCheat(){const _0x429839=a0_0x598c9c,_0x4ade32=Module[_0x429839(0xb7)]()['filter'](_0x45eeb0=>_0x45eeb0!=='.'&&_0x45eeb0!=='..');return _0x4ade32;}export function listScreenshot(){const _0x520cd5=a0_0x598c9c,_0x1fe13f=Module[_0x520cd5(0xcb)]()[_0x520cd5(0x8a)](_0xc8743c=>_0xc8743c!=='.'&&_0xc8743c!=='..');return _0x1fe13f;}function a0_0x44d2(_0x34721a,_0x4516e4){const _0x8b2146=a0_0x8b21();return a0_0x44d2=function(_0x44d261,_0x31ba16){_0x44d261=_0x44d261-0x77;let _0x1e712a=_0x8b2146[_0x44d261];return _0x1e712a;},a0_0x44d2(_0x34721a,_0x4516e4);}export function embedTextInPngFile(_0x13b293,_0x104521,_0x4e2387){const _0x5b3b27=a0_0x598c9c;let _0x50f9d2=atob(_0x13b293[_0x5b3b27(0xcc)](',')[0x1]),_0x102496=new Uint8Array(_0x50f9d2[_0x5b3b27(0xc8)]);for(let _0x373aec=0x0;_0x373aec<_0x50f9d2[_0x5b3b27(0xc8)];_0x373aec++){_0x102496[_0x373aec]=_0x50f9d2[_0x5b3b27(0x79)](_0x373aec);}let _0x2ee95c=new TextEncoder()['encode'](_0x5b3b27(0xcf)+_0x104521),_0x1a2c75=new Uint8Array(_0x102496[_0x5b3b27(0xc8)]+_0x2ee95c[_0x5b3b27(0xc8)]);_0x1a2c75['set'](_0x102496,0x0),_0x1a2c75[_0x5b3b27(0xa2)](_0x2ee95c,_0x102496[_0x5b3b27(0xc8)]);let _0x34edc1=new Blob([_0x1a2c75],{'type':_0x5b3b27(0x7a)}),_0x4443a8=new File([_0x34edc1],_0x4e2387,{'type':_0x5b3b27(0x7a)});return _0x4443a8;}export function extractTextFromPngBase64(_0x4cf45c){const _0x309f12=a0_0x598c9c;let _0x48709d=atob(_0x4cf45c[_0x309f12(0xcc)](',')[0x1]),_0x2623a8=_0x309f12(0xcf),_0x52d1a9=_0x48709d[_0x309f12(0xb9)](_0x2623a8);if(_0x52d1a9!==-0x1)return _0x48709d[_0x309f12(0xa1)](_0x52d1a9+_0x2623a8[_0x309f12(0xc8)]);return null;}export function fileSize(_0x115005){const _0x184193=a0_0x598c9c,_0x2bc7ca=Module[_0x184193(0xa3)](_0x115005);return _0x2bc7ca;}export async function resumeGame(){const _0x88894=a0_0x598c9c;Module[_0x88894(0xd6)](),Module['SDL2'](),notiMessage(_0x88894(0xbd),0x7d0);}export async function pauseGame(){const _0x282e48=a0_0x598c9c;Module[_0x282e48(0xb2)](),Module[_0x282e48(0xc5)](),notiMessage(_0x282e48(0x7f),0x7d0);}export async function buttonPress(_0x3cc2ec){const _0x633635=a0_0x598c9c;Module[_0x633635(0xa0)](_0x3cc2ec);}export async function buttonUnpress(_0xc742ef){const _0x562a90=a0_0x598c9c;Module[_0x562a90(0x7c)](_0xc742ef);}export async function screenShot(_0x126687){const _0x515dc4=a0_0x598c9c,_0x26d6c5=localStorage['getItem'](_0x515dc4(0xbb))['replace'](/\.(gba|gbc|gb|zip)$/,''),_0x1e3b7e=_0x26d6c5+'_'+_0x126687+_0x515dc4(0xa5);await Module[_0x515dc4(0x8e)](_0x1e3b7e),await Module[_0x515dc4(0x94)]();const _0x1fbfac=await fileToBase64(Module[_0x515dc4(0x85)](_0x515dc4(0x9b)+_0x1e3b7e)),_0x5eb6cb=embedTextInPngFile(_0x1fbfac,formatDateTime(Date[_0x515dc4(0xa4)]()),_0x1e3b7e);Module[_0x515dc4(0x81)](_0x5eb6cb,()=>{const _0x7f6234=_0x515dc4;localStorageFile(),Module[_0x7f6234(0x94)]();});}export async function dowloadScreenShot(_0x3f52da){try{const _0xba3f50=await fileToBase64(Module['downloadFile'](_0x3f52da));return _0xba3f50;}catch{}}export async function captureOCR(_0x3db9e6){const _0x4c50b1=a0_0x598c9c;Module['screenshot'](_0x3db9e6);const _0x4b7ff2=Module['downloadFile'](_0x4c50b1(0x9b)+_0x3db9e6);return _0x4b7ff2;}export async function setFastForwardMultiplier(_0x265a40){const _0x5191e4=a0_0x598c9c;Module[_0x5191e4(0x9f)](_0x265a40);}export function uploadCheats(_0x480370,_0xc7986a,_0x37f4b8,_0x578747,_0x9fb01e){const _0xb50f50=a0_0x598c9c;Module[_0xb50f50(0x81)](_0x480370,()=>{const _0x3d2a5a=_0xb50f50;Module['autoLoadCheats'](),setTimeout(()=>{const _0x117f57=a0_0x44d2;Module[_0x117f57(0x94)]();},0x1f4),_0x578747&&(localStorage['setItem'](_0xc7986a+_0x3d2a5a(0xd1),_0x37f4b8),notiMessage(_0x3d2a5a(0xc3),0x5dc)),_0x9fb01e[_0x3d2a5a(0xa6)]=localStorage[_0x3d2a5a(0xc6)](_0xc7986a+_0x3d2a5a(0xd1)||_0x3d2a5a(0xc7));});}export function setVolume(_0x443799){const _0x1c11bb=a0_0x598c9c;Module[_0x1c11bb(0x93)](_0x443799);}