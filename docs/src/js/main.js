const a0_0x3a78a6=a0_0x571b;(function(_0x5334d4,_0x5b34b2){const _0x3cfa07=a0_0x571b,_0x626f78=_0x5334d4();while(!![]){try{const _0x426456=-parseInt(_0x3cfa07(0x1ae))/0x1+-parseInt(_0x3cfa07(0x1ca))/0x2*(-parseInt(_0x3cfa07(0x1e4))/0x3)+-parseInt(_0x3cfa07(0x1f1))/0x4*(parseInt(_0x3cfa07(0x1d6))/0x5)+parseInt(_0x3cfa07(0x1ee))/0x6*(parseInt(_0x3cfa07(0x1d3))/0x7)+-parseInt(_0x3cfa07(0x205))/0x8*(parseInt(_0x3cfa07(0x1e0))/0x9)+parseInt(_0x3cfa07(0x1d4))/0xa+-parseInt(_0x3cfa07(0x1b1))/0xb*(-parseInt(_0x3cfa07(0x1f7))/0xc);if(_0x426456===_0x5b34b2)break;else _0x626f78['push'](_0x626f78['shift']());}catch(_0x539cd5){_0x626f78['push'](_0x626f78['shift']());}}}(a0_0x3c1a,0x8b6e6));import a0_0x226722 from'../core/mgba.js';import*as a0_0x6bafd3 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x3a78a6(0x1b8)](a0_0x3a78a6(0x20b))};function initializeCore(_0x11ad83,_0x56be81){const _0x31223b=a0_0x3a78a6;_0x11ad83(_0x56be81)[_0x31223b(0x1cb)](function(_0x4ef04f){const _0x5ee7e8=_0x31223b;_0x4ef04f[_0x5ee7e8(0x1aa)]();});}function a0_0x3c1a(){const _0x6d0e2c=['createElement','254904QYUrDh','encode','Cloud\x20upload\x20','.gbc','loadState','contains','uploadAll','loadGame','visible','setItem','27204ILegxc','turboF','control-setting','18764sEhBJF','text/plain','disable','Cheat\x20Enabled!','Off','gbc1','12ToCIXk','replace','style','indexOf','tEXtComment\x00','getItem','body','SDL2','onLine','toString','charCodeAt','#E0C068','No\x20screenshot!','files','3113744MkZVAH','\x20time(s)','setFastForwardMultiplier','download','persisted','remove','canvas','visibilitychange','_dateState0','/data/games/','image/png','set','autoLoadCheats','pagehide','FSInit','beforeunload','Online!','.png','965732vRKcmF','Unable\x20to\x20upload\x20to\x20Cloud!','log','11143099zjwgXa','add','endsWith','screenSize','substring','appendChild','FSSync','getElementById','listRoms','revokeObjectURL','downloadFile','listSaves','editFileName','textContent','innerWidth','classList','length','_savedCheats','gameName','turboState','now','uploadRom','slotStateSaved','deleteFile','/data/states/','20GgtCkO','then','gbc','split','screenshot','padStart','listCheats','uId','fileSize','301UgZLxE','3656550CDKbJS','.ss0','530IFLJtT','listScreenshots','#20A5A6','_slot0.txt','Auto\x20save\x20','timer','addEventListener','Do\x20you\x20want\x20to\x20load\x20save\x20state?','createObjectURL','filter','9vmnmnj','listStates','0,0,'];a0_0x3c1a=function(){return _0x6d0e2c;};return a0_0x3c1a();}initializeCore(a0_0x226722,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x3a78a6(0x1b8)](a0_0x3a78a6(0x20b)),savedTurboState=localStorage[a0_0x3a78a6(0x1fc)](a0_0x3a78a6(0x1c4)),controlSetting=document[a0_0x3a78a6(0x1b8)](a0_0x3a78a6(0x1f0));function handleVisibilityChange(_0x463896){const _0x1372d6=a0_0x3a78a6;document['visibilityState']==='hidden'||_0x463896?.['type']===_0x1372d6(0x1ab)||_0x463896?.[_0x1372d6(0x209)]?(pauseGame(),canvas[_0x1372d6(0x1c0)]['add'](_0x1372d6(0x1ec))):(setTimeout(()=>{const _0x48dd29=_0x1372d6;canvas[_0x48dd29(0x1c0)][_0x48dd29(0x20a)](_0x48dd29(0x1ec));},0x258),controlSetting[_0x1372d6(0x1c0)][_0x1372d6(0x1e9)](_0x1372d6(0x1ec))&&resumeGame());}async function statusShow(){const _0x9076f1=a0_0x3a78a6;document[_0x9076f1(0x1dc)](_0x9076f1(0x212),handleVisibilityChange),document['addEventListener'](_0x9076f1(0x20c),handleVisibilityChange),window[_0x9076f1(0x1dc)](_0x9076f1(0x1ab),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x6bafd3[_0x9076f1(0x1ef)](turboState)),await delay(0xc8),await Module[_0x9076f1(0x1fe)](),await delay(0x320),await led(parseInt(localStorage[_0x9076f1(0x1fc)](_0x9076f1(0x1c7)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x1469d7=a0_0x3a78a6;await ledSave(_0x1469d7(0x1d8)),await Module['saveState'](0x0),await Module['FSSync'](),await screenShot(0x0),console[_0x1469d7(0x1b0)](_0x1469d7(0x1da)+ ++countAutoSave+_0x1469d7(0x206));}async function saveStateInCloud(){const _0x1cd104=a0_0x3a78a6,_0xe8391=localStorage[_0x1cd104(0x1fc)]('gameName'),_0x3a2f33=_0xe8391[_0x1cd104(0x1f8)](/\.(zip|gb|gbc|gba)$/,_0x1cd104(0x1d5)),_0x4db69b=localStorage[_0x1cd104(0x1fc)](_0x1cd104(0x1d1)),_0x1e1cba=localStorage[_0x1cd104(0x1fc)](_0xe8391+'_imageState0'),_0x45c686=localStorage[_0x1cd104(0x1fc)](_0xe8391+_0x1cd104(0x20d));if(navigator[_0x1cd104(0x1ff)]){if(_0x4db69b){await ledSave(_0x1cd104(0x202)),await delay(0x3e8),await dpUploadFile(_0x3a2f33,Module[_0x1cd104(0x1bb)](_0x1cd104(0x1c9)+_0x3a2f33));if(_0x1e1cba!==null){const _0x2bc03e=_0x1e1cba+'\x0a\x0a'+_0x45c686,_0x4a8070=new Blob([_0x2bc03e],{'type':_0x1cd104(0x1f2)});await dpUploadFile(_0xe8391+_0x1cd104(0x1d9),_0x4a8070);}else console[_0x1cd104(0x1b0)](_0x1cd104(0x203));await lockNoti('',_0x1cd104(0x1e6)+ ++countUpload+'\x20time(s)',0x7d0);}else console[_0x1cd104(0x1b0)](_0x1cd104(0x1af));}else console['log'](_0x1cd104(0x1ac));}function startTimer(){let [_0x4199ec,_0x3f1839,_0x2bd26a,_0x3f2634,_0x367e63]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x5a3ca8=a0_0x571b;_0x2bd26a++,_0x3f2634++,_0x367e63++;if(_0x2bd26a===0x3c)[_0x2bd26a,_0x3f1839]=[0x0,_0x3f1839+0x1];if(_0x3f1839===0x3c)[_0x3f1839,_0x4199ec]=[0x0,_0x4199ec+0x1];document[_0x5a3ca8(0x1b8)](_0x5a3ca8(0x1db))[_0x5a3ca8(0x1be)]=_0x4199ec+'h'+_0x3f1839[_0x5a3ca8(0x200)]()['padStart'](0x2,'0')+'.'+_0x2bd26a[_0x5a3ca8(0x200)]()[_0x5a3ca8(0x1cf)](0x2,'0');_0x3f2634===0x3c&&(saveStatePeriodically(),_0x3f2634=0x0);;_0x367e63===0xe10&&(saveStateInCloud(),_0x367e63=0x0);;},0x3e8);}export async function uploadGame(_0x320b59){const _0x226228=a0_0x3a78a6,_0x4e0b0c=_0x320b59[_0x226228(0x204)][0x0];Module[_0x226228(0x1c6)](_0x4e0b0c,()=>{const _0x3dd51d=_0x226228;Module[_0x3dd51d(0x1b7)]();});}export async function loadGame(_0x4d7d66){const _0x4ff8b0=a0_0x3a78a6,_0x2d6d8d=_0x4d7d66[_0x4ff8b0(0x1f8)](/\.(gba|gbc|gb|zip)$/,_0x4ff8b0(0x1d5)),_0x3daf0a=Module[_0x4ff8b0(0x1e1)]()[_0x4ff8b0(0x1df)](_0x18bbfa=>_0x18bbfa!=='.'&&_0x18bbfa!=='..');intro[_0x4ff8b0(0x1c0)][_0x4ff8b0(0x1b2)](_0x4ff8b0(0x1f3)),errorLogElements[0x0][_0x4ff8b0(0x1f9)]['bottom']='0',ingame[_0x4ff8b0(0x1c0)][_0x4ff8b0(0x20a)](_0x4ff8b0(0x1f3)),_0x4d7d66[_0x4ff8b0(0x1b3)](_0x4ff8b0(0x1e7))||_0x4d7d66[_0x4ff8b0(0x1b3)]('.gb')?(canvas[_0x4ff8b0(0x1c0)]['add'](_0x4ff8b0(0x1cc)),areaTrans[_0x4ff8b0(0x1c0)][_0x4ff8b0(0x1b2)](_0x4ff8b0(0x1f6)),localStorage[_0x4ff8b0(0x1ed)](_0x4ff8b0(0x1b4),_0x4ff8b0(0x1e2)+(window[_0x4ff8b0(0x1bf)]-0xe6)+','+(window[_0x4ff8b0(0x1bf)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x4ff8b0(0x1b4),_0x4ff8b0(0x1e2)+(window[_0x4ff8b0(0x1bf)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x3daf0a['includes'](_0x2d6d8d)?(await Module[_0x4ff8b0(0x1eb)](_0x4ff8b0(0x20e)+_0x4d7d66),confirm(_0x4ff8b0(0x1dd))&&(await Module[_0x4ff8b0(0x1e8)](0x0),localStorage[_0x4ff8b0(0x1ed)]('gameName',_0x4d7d66),console[_0x4ff8b0(0x1b0)](_0x4d7d66))):(await Module['loadGame']('/data/games/'+_0x4d7d66),localStorage['setItem'](_0x4ff8b0(0x1c3),_0x4d7d66),console[_0x4ff8b0(0x1b0)](_0x4d7d66)),await statusShow();}export async function saveState(_0x555a65){await Module['saveState'](_0x555a65),await Module['FSSync']();}export async function loadState(_0x571593){const _0x348072=a0_0x3a78a6;await Module[_0x348072(0x1e8)](_0x571593);}export async function downloadFile(_0x34a509,_0x529f41){const _0x34e3ff=a0_0x3a78a6,_0x154c8b=Module[_0x34e3ff(0x1bb)](_0x34a509),_0x29551f=document[_0x34e3ff(0x1e3)]('a');document[_0x34e3ff(0x1fd)][_0x34e3ff(0x1b6)](_0x29551f),_0x29551f[_0x34e3ff(0x208)]=_0x529f41;const _0x29c0dc=new Blob([_0x154c8b],{'type':'application/octet-stream'});_0x29551f['href']=URL[_0x34e3ff(0x1de)](_0x29c0dc),_0x29551f['click'](),URL[_0x34e3ff(0x1ba)](_0x29c0dc),_0x29551f[_0x34e3ff(0x20a)]();}export function downloadFileInCloud(_0x1caa15){const _0xf1f2f2=a0_0x3a78a6,_0x2b11c3=Module[_0xf1f2f2(0x1bb)](_0x1caa15);return _0x2b11c3;}export async function uploadFile(_0x47551e){const _0x5dfafb=a0_0x3a78a6,_0x4950a4=_0x47551e[_0x5dfafb(0x204)][0x0];Module[_0x5dfafb(0x1ea)](_0x4950a4,()=>{localStorageFile(),Module['FSSync']();});}export async function editFile(_0x43feb9,_0x5b46b8,_0x387b66){const _0x55a053=a0_0x3a78a6;await Module[_0x55a053(0x1bd)](_0x43feb9,_0x5b46b8,_0x387b66),await Module[_0x55a053(0x1b7)]();}export async function deleteFile(_0x100edb){const _0x488276=a0_0x3a78a6;await Module[_0x488276(0x1c8)](_0x100edb),await Module[_0x488276(0x1b7)]();}export function listGame(){const _0x480829=a0_0x3a78a6,_0x25af99=Module[_0x480829(0x1b9)]()[_0x480829(0x1df)](_0x2a5d6d=>_0x2a5d6d!=='.'&&_0x2a5d6d!=='..');return _0x25af99;}export function listSave(){const _0x227317=a0_0x3a78a6,_0x5c3c2f=Module[_0x227317(0x1bc)]()[_0x227317(0x1df)](_0x1ce519=>_0x1ce519!=='.'&&_0x1ce519!=='..');return _0x5c3c2f;}export function listState(){const _0x15635b=a0_0x3a78a6,_0x42633f=Module[_0x15635b(0x1e1)]()[_0x15635b(0x1df)](_0x5d4e00=>_0x5d4e00!=='.'&&_0x5d4e00!=='..');return _0x42633f;}export function listCheat(){const _0x153068=a0_0x3a78a6,_0x558bbe=Module[_0x153068(0x1d0)]()['filter'](_0x558fa7=>_0x558fa7!=='.'&&_0x558fa7!=='..');return _0x558bbe;}export function listScreenshot(){const _0x356c17=a0_0x3a78a6,_0x5c2f95=Module[_0x356c17(0x1d7)]()[_0x356c17(0x1df)](_0x224330=>_0x224330!=='.'&&_0x224330!=='..');return _0x5c2f95;}export function embedTextInPngFile(_0x4f93d3,_0x8b94b4,_0x3b8801){const _0xb2d4c3=a0_0x3a78a6;let _0x496ac6=atob(_0x4f93d3[_0xb2d4c3(0x1cd)](',')[0x1]),_0xd0428=new Uint8Array(_0x496ac6[_0xb2d4c3(0x1c1)]);for(let _0x571924=0x0;_0x571924<_0x496ac6[_0xb2d4c3(0x1c1)];_0x571924++){_0xd0428[_0x571924]=_0x496ac6[_0xb2d4c3(0x201)](_0x571924);}let _0x36326b=new TextEncoder()[_0xb2d4c3(0x1e5)](_0xb2d4c3(0x1fb)+_0x8b94b4),_0x16eca5=new Uint8Array(_0xd0428[_0xb2d4c3(0x1c1)]+_0x36326b[_0xb2d4c3(0x1c1)]);_0x16eca5[_0xb2d4c3(0x210)](_0xd0428,0x0),_0x16eca5[_0xb2d4c3(0x210)](_0x36326b,_0xd0428['length']);let _0x5bd01e=new Blob([_0x16eca5],{'type':_0xb2d4c3(0x20f)}),_0x266618=new File([_0x5bd01e],_0x3b8801,{'type':_0xb2d4c3(0x20f)});return _0x266618;}function a0_0x571b(_0x262e83,_0x567fce){const _0x3c1a45=a0_0x3c1a();return a0_0x571b=function(_0x571bf9,_0x22882b){_0x571bf9=_0x571bf9-0x1aa;let _0x1c7fa7=_0x3c1a45[_0x571bf9];return _0x1c7fa7;},a0_0x571b(_0x262e83,_0x567fce);}export function extractTextFromPngBase64(_0x1458d9){const _0x62dd33=a0_0x3a78a6;let _0x5186ee=atob(_0x1458d9[_0x62dd33(0x1cd)](',')[0x1]),_0x325e45='tEXtComment\x00',_0x499098=_0x5186ee[_0x62dd33(0x1fa)](_0x325e45);if(_0x499098!==-0x1)return _0x5186ee[_0x62dd33(0x1b5)](_0x499098+_0x325e45[_0x62dd33(0x1c1)]);return null;}export function fileSize(_0x416f6e){const _0x42b308=a0_0x3a78a6,_0x337a9f=Module[_0x42b308(0x1d2)](_0x416f6e);return _0x337a9f;}export async function resumeGame(){const _0x411752=a0_0x3a78a6;Module['resumeGame'](),Module[_0x411752(0x1fe)](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){Module['pauseGame'](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x988d98){Module['buttonPress'](_0x988d98);}export async function buttonUnpress(_0x419822){Module['buttonUnpress'](_0x419822);}export async function screenShot(_0x22f642){const _0x438c16=a0_0x3a78a6,_0xc13050=localStorage['getItem'](_0x438c16(0x1c3))[_0x438c16(0x1f8)](/\.(gba|gbc|gb|zip)$/,''),_0x8d0e70=_0xc13050+'_'+_0x22f642+_0x438c16(0x1ad);await Module[_0x438c16(0x1ce)](_0x8d0e70),await Module['FSSync']();const _0x17b130=await fileToBase64(Module[_0x438c16(0x1bb)]('/data/screenshots/'+_0x8d0e70)),_0x53df5a=embedTextInPngFile(_0x17b130,formatDateTime(Date[_0x438c16(0x1c5)]()),_0x8d0e70);await uploadSaveOrSaveState(_0x53df5a);}export async function dowloadScreenShot(_0x370c26){const _0xed1e35=a0_0x3a78a6;try{const _0x507364=await fileToBase64(Module[_0xed1e35(0x1bb)](_0x370c26));return _0x507364;}catch{}}export async function captureOCR(_0x53a041){const _0x3c6391=a0_0x3a78a6;Module[_0x3c6391(0x1ce)](_0x53a041);const _0x1c1668=Module[_0x3c6391(0x1bb)]('/data/screenshots/'+_0x53a041);return _0x1c1668;}export async function setFastForwardMultiplier(_0x5bc9ef){const _0x1927a=a0_0x3a78a6;Module[_0x1927a(0x207)](_0x5bc9ef);}export function uploadCheats(_0x16ce3f,_0x592a07,_0x58f490,_0x31e8cd,_0xb91afb){const _0x1210f0=a0_0x3a78a6;Module[_0x1210f0(0x1ea)](_0x16ce3f,()=>{const _0x194784=_0x1210f0;Module[_0x194784(0x211)](),setTimeout(()=>{const _0x7f27d9=_0x194784;Module[_0x7f27d9(0x1b7)]();},0x1f4),_0x31e8cd&&(localStorage['setItem'](_0x592a07+_0x194784(0x1c2),_0x58f490),notiMessage(_0x194784(0x1f4),0x5dc)),_0xb91afb[_0x194784(0x1be)]=localStorage[_0x194784(0x1fc)](_0x592a07+'_savedCheats'||_0x194784(0x1f5));});}