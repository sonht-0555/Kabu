const a0_0x26324c=a0_0x4936;(function(_0x290463,_0x326ce3){const _0x512f3b=a0_0x4936,_0x379fe3=_0x290463();while(!![]){try{const _0x539cb6=parseInt(_0x512f3b(0x20b))/0x1+parseInt(_0x512f3b(0x22b))/0x2+-parseInt(_0x512f3b(0x259))/0x3+-parseInt(_0x512f3b(0x262))/0x4*(parseInt(_0x512f3b(0x25e))/0x5)+-parseInt(_0x512f3b(0x23b))/0x6+-parseInt(_0x512f3b(0x25a))/0x7*(parseInt(_0x512f3b(0x248))/0x8)+parseInt(_0x512f3b(0x233))/0x9;if(_0x539cb6===_0x326ce3)break;else _0x379fe3['push'](_0x379fe3['shift']());}catch(_0x3a813c){_0x379fe3['push'](_0x379fe3['shift']());}}}(a0_0x32ae,0x8be8d));import a0_0x2c1720 from'../core/mgba.js';import*as a0_0x19ac42 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';const Module={'canvas':document[a0_0x26324c(0x21c)](a0_0x26324c(0x20d))};function initializeCore(_0x4206a0,_0xce1b3e){const _0x5c31b2=a0_0x26324c;_0x4206a0(_0xce1b3e)[_0x5c31b2(0x1f5)](function(_0x12ca96){const _0x95301a=_0x5c31b2;_0x12ca96[_0x95301a(0x243)]();});}initializeCore(a0_0x2c1720,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document['getElementById']('canvas'),controlSetting=document['getElementById'](a0_0x26324c(0x253));function handleVisibilityChange(_0x286230){const _0x4e2922=a0_0x26324c;document['visibilityState']===_0x4e2922(0x215)||_0x286230?.[_0x4e2922(0x1ef)]===_0x4e2922(0x246)||_0x286230?.['persisted']?(pauseGame(),canvas['classList']['add'](_0x4e2922(0x22d))):(setTimeout(()=>{const _0x4a2d22=_0x4e2922;canvas['classList'][_0x4a2d22(0x23d)](_0x4a2d22(0x22d));},0x258),controlSetting[_0x4e2922(0x202)][_0x4e2922(0x225)]('visible')&&resumeGame());}async function statusShow(){const _0x2938f2=a0_0x26324c;document[_0x2938f2(0x23a)]('pagehide',handleVisibilityChange),document[_0x2938f2(0x23a)](_0x2938f2(0x240),handleVisibilityChange),window['addEventListener']('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),await a0_0x19ac42['turboF'](parseInt(await getData(gameName,'0','turboState'))),await delay(0xc8),await Module[_0x2938f2(0x23f)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x2938f2(0x247)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x8e2ffb=a0_0x26324c;await ledSave('#20A5A6'),await Module[_0x8e2ffb(0x1fb)](0x0),await Module[_0x8e2ffb(0x238)](),await screenShot(0x0),console[_0x8e2ffb(0x228)](_0x8e2ffb(0x1f4)+ ++countAutoSave+_0x8e2ffb(0x21a));}async function saveStateInCloud(){const _0x56d989=a0_0x26324c,_0x344a6f=gameName['replace'](/\.(zip|gb|gbc|gba)$/,_0x56d989(0x251)),_0x59c6d1=localStorage[_0x56d989(0x227)]('uId');navigator['onLine']&&(_0x59c6d1&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x344a6f,Module[_0x56d989(0x20e)](_0x56d989(0x23e)+_0x344a6f),_0x56d989(0x221)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x56d989(0x21a),0x7d0)));}function startTimer(){let [_0x5664ee,_0x171d94,_0x13aead,_0x5b5497,_0x2bbd03]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x37bcbc=a0_0x4936;_0x13aead++,_0x5b5497++,_0x2bbd03++;if(_0x13aead===0x3c)[_0x13aead,_0x171d94]=[0x0,_0x171d94+0x1];if(_0x171d94===0x3c)[_0x171d94,_0x5664ee]=[0x0,_0x5664ee+0x1];document[_0x37bcbc(0x21c)]('timer')[_0x37bcbc(0x22a)]=_0x5664ee+'h'+_0x171d94['toString']()[_0x37bcbc(0x25f)](0x2,'0')+'.'+_0x13aead[_0x37bcbc(0x1fd)]()['padStart'](0x2,'0');_0x5b5497===0x3c&&(saveStatePeriodically(),_0x5b5497=0x0);;_0x2bbd03===0x708&&(saveStateInCloud(),_0x2bbd03=0x0);;},0x3e8);}export async function uploadGame(_0x472943){const _0x5be3e4=a0_0x26324c,_0x177080=_0x472943[_0x5be3e4(0x203)][0x0];Module[_0x5be3e4(0x24a)](_0x177080,()=>{const _0x4f40f0=_0x5be3e4;Module[_0x4f40f0(0x238)]();});}export async function loadGame(_0x4fe3c9){const _0x3fe7a2=a0_0x26324c,_0x38d7f8=_0x4fe3c9[_0x3fe7a2(0x1f1)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x155de5=Module[_0x3fe7a2(0x204)]()[_0x3fe7a2(0x226)](_0x40b349=>_0x40b349!=='.'&&_0x40b349!=='..');intro[_0x3fe7a2(0x202)]['add'](_0x3fe7a2(0x24d)),errorLogElements[0x0][_0x3fe7a2(0x207)][_0x3fe7a2(0x211)]='0',ingame[_0x3fe7a2(0x202)][_0x3fe7a2(0x23d)](_0x3fe7a2(0x24d)),_0x4fe3c9[_0x3fe7a2(0x1f3)](_0x3fe7a2(0x256))||_0x4fe3c9[_0x3fe7a2(0x1f3)]('.gb')?(canvas[_0x3fe7a2(0x202)][_0x3fe7a2(0x220)](_0x3fe7a2(0x222)),areaTrans[_0x3fe7a2(0x202)][_0x3fe7a2(0x220)](_0x3fe7a2(0x224)),localStorage['setItem'](_0x3fe7a2(0x242),_0x3fe7a2(0x214)+(window[_0x3fe7a2(0x20a)]-0xe6)+','+(window[_0x3fe7a2(0x20a)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x3fe7a2(0x242),'0,0,'+(window[_0x3fe7a2(0x20a)]-0x96)+','+(window[_0x3fe7a2(0x20a)]-0x96)*0x2/0x3),_0x155de5[_0x3fe7a2(0x1ee)](_0x38d7f8)?(await Module[_0x3fe7a2(0x260)]('/data/games/'+_0x4fe3c9),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x3fe7a2(0x234)](0x0),await shaderData())):(await Module[_0x3fe7a2(0x260)](_0x3fe7a2(0x22e)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x555337){const _0xf22650=a0_0x26324c;await Module[_0xf22650(0x1fb)](_0x555337),await Module[_0xf22650(0x238)]();}export async function loadState(_0x3de8ec){const _0x3135d7=a0_0x26324c;await Module[_0x3135d7(0x234)](_0x3de8ec);}export async function downloadFile(_0x3f0f47,_0x42267d){const _0x5b5415=a0_0x26324c,_0x5f2584=Module['downloadFile'](_0x3f0f47),_0x5419ab=document[_0x5b5415(0x258)]('a');document[_0x5b5415(0x21d)][_0x5b5415(0x24f)](_0x5419ab),_0x5419ab[_0x5b5415(0x205)]=_0x42267d;const _0xfab5ae=new Blob([_0x5f2584],{'type':_0x5b5415(0x216)});_0x5419ab[_0x5b5415(0x208)]=URL['createObjectURL'](_0xfab5ae),_0x5419ab['click'](),URL[_0x5b5415(0x212)](_0xfab5ae),_0x5419ab[_0x5b5415(0x23d)]();}export function downloadFileInCloud(_0x15fcd2){const _0xc887c9=a0_0x26324c;try{const _0x1ddd53=Module[_0xc887c9(0x20e)](_0x15fcd2);return _0x1ddd53;}catch(_0x26100f){return null;}}export async function uploadFileInCloud(_0x389ba4){const _0x1a8498=a0_0x26324c;Module[_0x1a8498(0x250)](_0x389ba4,()=>{const _0x58f77c=_0x1a8498;localStorageFile(),Module[_0x58f77c(0x238)]();});}export async function uploadFile(_0x35b0c4){const _0x5f266e=_0x35b0c4['files'][0x0];Module['uploadAll'](_0x5f266e,()=>{const _0x248d29=a0_0x4936;localStorageFile(),Module[_0x248d29(0x238)]();});}export async function editFile(_0x5b09df,_0xe380d4,_0xca960){const _0x1ed79d=a0_0x26324c;await Module[_0x1ed79d(0x219)](_0x5b09df,_0xe380d4,_0xca960),await Module[_0x1ed79d(0x238)]();}export async function deleteFile(_0x28d051){const _0x53afe2=a0_0x26324c;await Module[_0x53afe2(0x1fe)](_0x28d051),await Module['FSSync']();}function a0_0x32ae(){const _0x225149=['split','bottom','revokeObjectURL','listSaves','0,0,','hidden','application/octet-stream','map','opacity','editFileName','\x20time(s)','length','getElementById','body','concat','exec','add','state','gbc','fileSize','gbc1','contains','filter','getItem','log','entries','textContent','658942iMQDqM','Error\x20ledSave:','visible','/data/games/','tEXtComment\x00','screenshot','set','.png','11965896OJAlya','loadState','\x20:\x20','rgba(245,\x20232,\x20209,\x200.4)','listCheats','FSSync','led02','addEventListener','124278iavFgE','led0','remove','/data/states/','SDL2','visibilitychange','noti-mess','screenSize','FSInit','error','image/png','beforeunload','slotStateSaved','40CEVEiP','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','uploadRom','trim','lastIndexOf','disable','\x20|\x20','appendChild','uploadAll','.ss0','led03','control-setting','listRoms','led04','.gbc','led06','createElement','2411943KhQqoq','943873dQgMVm','listScreenshots','saveTime','fill','90IckmiL','padStart','loadGame','0.4','125140piqZBR','setFastForwardMultiplier','Resumed!','includes','type','led00','replace','charCodeAt','endsWith','Auto\x20save\x20','then','All','indexOf','buttonUnpress','match','/data/screenshots/','saveState','Paused!','toString','deleteFile','buttonPress','pauseGame','now','classList','files','listStates','download','setVolume','style','href','encode','innerWidth','976073zEubbC','join','canvas','downloadFile','substring'];a0_0x32ae=function(){return _0x225149;};return a0_0x32ae();}export function listGame(){const _0x1c727d=a0_0x26324c,_0x3d1464=Module[_0x1c727d(0x254)]()['filter'](_0x46fda0=>_0x46fda0!=='.'&&_0x46fda0!=='..');return _0x3d1464;}export function listSave(){const _0x7d63e=a0_0x26324c,_0x4ab8c8=Module[_0x7d63e(0x213)]()[_0x7d63e(0x226)](_0x1cf495=>_0x1cf495!=='.'&&_0x1cf495!=='..');return _0x4ab8c8;}export function listState(){const _0x4b84ec=a0_0x26324c,_0x4cbeab=Module[_0x4b84ec(0x204)]()['filter'](_0x15a996=>_0x15a996!=='.'&&_0x15a996!=='..');return _0x4cbeab;}export function listCheat(){const _0x1d6c32=a0_0x26324c,_0xe5101c=Module[_0x1d6c32(0x237)]()['filter'](_0x118449=>_0x118449!=='.'&&_0x118449!=='..');return _0xe5101c;}export function listScreenshot(){const _0x1760a7=a0_0x26324c,_0x352518=Module[_0x1760a7(0x25b)]()[_0x1760a7(0x226)](_0xfdb655=>_0xfdb655!=='.'&&_0xfdb655!=='..');return _0x352518;}export function embedTextInPngFile(_0x3880e1,_0x413d01,_0x2c1209){const _0x3c098f=a0_0x26324c;let _0x41ccea=atob(_0x3880e1[_0x3c098f(0x210)](',')[0x1]),_0x2d7360=new Uint8Array(_0x41ccea[_0x3c098f(0x21b)]);for(let _0x4c877e=0x0;_0x4c877e<_0x41ccea[_0x3c098f(0x21b)];_0x4c877e++){_0x2d7360[_0x4c877e]=_0x41ccea[_0x3c098f(0x1f2)](_0x4c877e);}let _0x35970b=new TextEncoder()[_0x3c098f(0x209)](_0x3c098f(0x22f)+_0x413d01),_0xb5cfad=new Uint8Array(_0x2d7360[_0x3c098f(0x21b)]+_0x35970b[_0x3c098f(0x21b)]);_0xb5cfad['set'](_0x2d7360,0x0),_0xb5cfad[_0x3c098f(0x231)](_0x35970b,_0x2d7360[_0x3c098f(0x21b)]);let _0x226c5c=new Blob([_0xb5cfad],{'type':'image/png'}),_0x12b232=new File([_0x226c5c],_0x2c1209,{'type':'image/png'});return _0x12b232;}export function extractTextFromPngBase64(_0x4098ce){const _0x28ae5a=a0_0x26324c;let _0x415731=atob(_0x4098ce[_0x28ae5a(0x210)](',')[0x1]),_0x1fbc05='tEXtComment\x00',_0x3b01e1=_0x415731[_0x28ae5a(0x1f7)](_0x1fbc05);if(_0x3b01e1!==-0x1)return _0x415731['substring'](_0x3b01e1+_0x1fbc05['length']);return null;}export function fileSize(_0x304c9e){const _0x1ead6a=a0_0x26324c,_0x435a31=Module[_0x1ead6a(0x223)](_0x304c9e);return _0x435a31;}export async function resumeGame(){const _0x57c1f6=a0_0x26324c;Module['resumeGame'](),Module[_0x57c1f6(0x23f)](),notiMessage(_0x57c1f6(0x1ed),0x7d0);}export async function pauseGame(){const _0x2f68bd=a0_0x26324c;Module[_0x2f68bd(0x200)](),Module[_0x2f68bd(0x23f)](),notiMessage(_0x2f68bd(0x1fc),0x7d0);}export async function buttonPress(_0x237c3e){const _0x4598e5=a0_0x26324c;Module[_0x4598e5(0x1ff)](_0x237c3e);}export async function buttonUnpress(_0x674a31){const _0x2017ec=a0_0x26324c;Module[_0x2017ec(0x1f8)](_0x674a31);}export async function screenShot(_0x4fe1a0){const _0x41b7b6=a0_0x26324c,_0x3db22a=gameName[_0x41b7b6(0x1f1)](/\.(gba|gbc|gb|zip)$/,'_'+_0x4fe1a0+_0x41b7b6(0x232)),_0xde3445=await getData(gameName,_0x4fe1a0,_0x41b7b6(0x1f6))||'';console[_0x41b7b6(0x228)](_0xde3445),await Module[_0x41b7b6(0x230)](_0x3db22a),await Module[_0x41b7b6(0x238)](),await setData(gameName,_0x4fe1a0,_0x41b7b6(0x25c),formatDateTime(Date[_0x41b7b6(0x201)]()),_0xde3445);}function a0_0x4936(_0x1514d1,_0xb60195){const _0x32ae69=a0_0x32ae();return a0_0x4936=function(_0x4936d3,_0x940e18){_0x4936d3=_0x4936d3-0x1ec;let _0x57ad9a=_0x32ae69[_0x4936d3];return _0x57ad9a;},a0_0x4936(_0x1514d1,_0xb60195);}export async function dowloadScreenShot(_0x2ecc31){const _0x34b987=a0_0x26324c;try{const _0x539c44=await fileToBase64(Module[_0x34b987(0x20e)](_0x2ecc31));return _0x539c44;}catch{}}export async function captureOCR(_0x597978){Module['screenshot'](_0x597978);const _0x2cbcd3=Module['downloadFile']('/data/screenshots/'+_0x597978);return _0x2cbcd3;}export async function setFastForwardMultiplier(_0x429940){const _0xd0db63=a0_0x26324c;Module[_0xd0db63(0x1ec)](_0x429940);}export function uploadCheats(_0x43380e){const _0x2d708d=a0_0x26324c;Module[_0x2d708d(0x250)](_0x43380e,()=>{Module['autoLoadCheats'](),setTimeout(()=>{const _0x2b2d71=a0_0x4936;Module[_0x2b2d71(0x238)]();},0x1f4);});}export function setVolume(_0x4760f5){const _0xe45227=a0_0x26324c;Module[_0xe45227(0x206)](_0x4760f5);}export async function setData(_0x3b8c70,_0x131d3e,_0x30cf32,_0x1cf4ca,_0x58eb94=''){const _0x39a6fb=a0_0x26324c,_0x5ece83=_0x3b8c70[_0x39a6fb(0x1f1)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x3b2d29=_0x39a6fb(0x1fa)+_0x5ece83+'_'+_0x131d3e+_0x39a6fb(0x232);let _0x2401c0;try{_0x2401c0=await fileToBase64(Module['downloadFile'](_0x3b2d29));}catch(_0x1b690a){await Module['screenshot'](_0x5ece83+'_'+_0x131d3e+_0x39a6fb(0x232)),await delay(0x64),_0x2401c0=await fileToBase64(Module[_0x39a6fb(0x20e)](_0x3b2d29));}let _0x2f0d3e=atob(_0x2401c0[_0x39a6fb(0x210)](',')[0x1]),_0x3c107c='tEXtComment\x00',_0x3fdf56=_0x2f0d3e['indexOf'](_0x3c107c),_0x5216cb={};if(_0x3fdf56!==-0x1||_0x58eb94[_0x39a6fb(0x24b)]()!==''){let _0x2b6de7=_0x3fdf56!==-0x1?_0x2f0d3e[_0x39a6fb(0x20f)](_0x3fdf56+_0x3c107c[_0x39a6fb(0x21b)]):_0x58eb94,_0x478803=/(\w+)\s*:\s*([^|]*)/g,_0x3d01cf;while((_0x3d01cf=_0x478803[_0x39a6fb(0x21f)](_0x2b6de7))!==null){_0x5216cb[_0x3d01cf[0x1][_0x39a6fb(0x24b)]()]=_0x3d01cf[0x2][_0x39a6fb(0x24b)]();}_0x3fdf56!==-0x1&&(_0x2f0d3e=_0x2f0d3e[_0x39a6fb(0x20f)](0x0,_0x3fdf56));}_0x5216cb[_0x30cf32]=_0x1cf4ca;let _0x4704e5=Object[_0x39a6fb(0x229)](_0x5216cb)[_0x39a6fb(0x217)](([_0x560e1f,_0x587e46])=>_0x560e1f+_0x39a6fb(0x235)+_0x587e46)[_0x39a6fb(0x20c)](_0x39a6fb(0x24e)),_0x80155a=new TextEncoder()[_0x39a6fb(0x209)](_0x3c107c+'\x20'+_0x4704e5),_0x37d74a=new Uint8Array([..._0x2f0d3e][_0x39a6fb(0x217)](_0x5a2b69=>_0x5a2b69[_0x39a6fb(0x1f2)](0x0))[_0x39a6fb(0x21e)]([..._0x80155a])),_0x33b7a3=new File([new Blob([_0x37d74a],{'type':_0x39a6fb(0x245)})],_0x5ece83+'_'+_0x131d3e+_0x39a6fb(0x232),{'type':_0x39a6fb(0x245)});Module[_0x39a6fb(0x250)](_0x33b7a3,()=>{const _0x4c88b3=_0x39a6fb;localStorageFile(),Module[_0x4c88b3(0x238)]();});}export async function getData(_0x302668,_0x2de42d,_0xb277e){const _0x22832e=a0_0x26324c;try{const _0x7f61b2=_0x302668[_0x22832e(0x1f1)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x405701='/data/screenshots/'+_0x7f61b2+'_'+_0x2de42d+_0x22832e(0x232);let _0x4c5354;try{_0x4c5354=await fileToBase64(Module[_0x22832e(0x20e)](_0x405701));}catch(_0x1201b0){return null;}let _0x361406=atob(_0x4c5354[_0x22832e(0x210)](',')[0x1]),_0x4db80a='tEXtComment\x00',_0xc47234=_0x361406['indexOf'](_0x4db80a);if(_0xc47234!==-0x1){let _0x542258=_0x361406[_0x22832e(0x20f)](_0xc47234+_0x4db80a[_0x22832e(0x21b)]);if(_0xb277e===_0x22832e(0x1f6))return _0x542258[_0x22832e(0x24b)]();let _0x61fb98=new RegExp(_0xb277e+_0x22832e(0x249)),_0x1c57a2=_0x542258[_0x22832e(0x1f9)](_0x61fb98);if(_0x1c57a2)return _0x1c57a2[0x1][_0x22832e(0x24b)]();}}catch(_0x292a76){return console[_0x22832e(0x244)]({'romName':_0x302668,'slot':_0x2de42d,'type':_0xb277e}),null;}}export async function ledSave(_0xd66c83){const _0x41602b=a0_0x26324c,_0x454223=parseInt(await getData(gameName,'0',_0x41602b(0x247))),_0x4e6b98=_0x454223===0x1?'led01':_0x454223===0x2?_0x41602b(0x239):_0x454223===0x3?_0x41602b(0x252):_0x454223===0x4?_0x41602b(0x255):_0x454223===0x5?'led05':_0x454223===0x6?_0x41602b(0x257):_0x454223===0x7?'led07':_0x41602b(0x1f0);try{for(let _0x362b76=0x0;_0x362b76<=0x7;_0x362b76++){document[_0x41602b(0x21c)](_0x41602b(0x23c)+_0x362b76)['style']['fill']=_0x41602b(0x236);}await delay(0x3e8);for(let _0x4430f6=0x0;_0x4430f6<=0x7;_0x4430f6++){document['getElementById']('led0'+_0x4430f6)[_0x41602b(0x207)][_0x41602b(0x25d)]=_0x41602b(0x236);}document[_0x41602b(0x21c)](_0x4e6b98)[_0x41602b(0x207)][_0x41602b(0x25d)]=_0xd66c83;}catch(_0x1345fa){console[_0x41602b(0x244)](_0x41602b(0x22c),_0x1345fa);}};export async function notiMessage(_0x423dc2,_0x566c5b,_0x412568=![]){const _0x35bf48=a0_0x26324c;var _0xf0cd5f=document[_0x35bf48(0x21c)](_0x35bf48(0x241));const _0x27bbcd=parseInt(await getData(gameName,'0',_0x35bf48(0x247)))||0x0;_0xf0cd5f[_0x35bf48(0x207)][_0x35bf48(0x218)]===_0x35bf48(0x261)&&(clearTimeout(messageTimeout),_0xf0cd5f[_0x35bf48(0x207)][_0x35bf48(0x218)]='0'),_0xf0cd5f['textContent']=_0x423dc2,_0xf0cd5f['style'][_0x35bf48(0x218)]='0.4',messageTimeout=setTimeout(()=>{const _0x16f4c7=_0x35bf48;_0xf0cd5f['textContent']='['+_0x27bbcd+']\x20'+gameName['substring'](0x0,gameName[_0x16f4c7(0x24c)]('.')),_0xf0cd5f[_0x16f4c7(0x207)][_0x16f4c7(0x218)]='0.4';},_0x566c5b),_0x412568&&(canvas[_0x35bf48(0x202)][_0x35bf48(0x220)](_0x35bf48(0x22d)),setTimeout(()=>{const _0x25fdfc=_0x35bf48;canvas[_0x25fdfc(0x202)][_0x25fdfc(0x23d)]('visible');},0x258));}