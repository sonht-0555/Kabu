const a0_0x191a36=a0_0x6841;function a0_0x6841(_0x343a26,_0x3f5e1c){const _0x5005f4=a0_0x5005();return a0_0x6841=function(_0x684152,_0x4ecf71){_0x684152=_0x684152-0xb5;let _0xfac052=_0x5005f4[_0x684152];return _0xfac052;},a0_0x6841(_0x343a26,_0x3f5e1c);}(function(_0x2e781f,_0x261c88){const _0x52df66=a0_0x6841,_0x269fa6=_0x2e781f();while(!![]){try{const _0x40dcce=parseInt(_0x52df66(0xfc))/0x1+parseInt(_0x52df66(0xba))/0x2*(-parseInt(_0x52df66(0xf5))/0x3)+parseInt(_0x52df66(0xdb))/0x4*(parseInt(_0x52df66(0xbc))/0x5)+-parseInt(_0x52df66(0xb5))/0x6*(parseInt(_0x52df66(0xfe))/0x7)+-parseInt(_0x52df66(0xf6))/0x8+-parseInt(_0x52df66(0xcb))/0x9+parseInt(_0x52df66(0xfb))/0xa;if(_0x40dcce===_0x261c88)break;else _0x269fa6['push'](_0x269fa6['shift']());}catch(_0x38ba7e){_0x269fa6['push'](_0x269fa6['shift']());}}}(a0_0x5005,0x211a2));import a0_0x40a30f from'../core/mgba.js';import*as a0_0x2a53db from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0x191a36(0xca))};function initializeCore(_0xbaaad0,_0x2b6fe2){const _0x2bb606=a0_0x191a36;_0xbaaad0(_0x2b6fe2)[_0x2bb606(0x101)](function(_0x5306a1){_0x5306a1['FSInit']();});}initializeCore(a0_0x40a30f,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x191a36(0xd1)](a0_0x191a36(0xca)),savedTurboState=localStorage[a0_0x191a36(0x110)](a0_0x191a36(0xf3)),controlSetting=document[a0_0x191a36(0xd1)]('control-setting');function handleVisibilityChange(_0x4c3f24){const _0xd430a5=a0_0x191a36;document['visibilityState']===_0xd430a5(0xb8)||_0x4c3f24?.[_0xd430a5(0xc7)]===_0xd430a5(0xe4)||_0x4c3f24?.[_0xd430a5(0xdd)]?(pauseGame(),canvas[_0xd430a5(0xb7)][_0xd430a5(0x109)]('visible')):(setTimeout(()=>{const _0x4d2337=_0xd430a5;canvas[_0x4d2337(0xb7)]['remove'](_0x4d2337(0x10d));},0x258),controlSetting[_0xd430a5(0xb7)][_0xd430a5(0x106)](_0xd430a5(0x10d))&&resumeGame());}async function statusShow(){const _0x17dac7=a0_0x191a36;document[_0x17dac7(0xf8)](_0x17dac7(0x10b),handleVisibilityChange),document[_0x17dac7(0xf8)]('visibilitychange',handleVisibilityChange),window['addEventListener'](_0x17dac7(0xe4),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x2a53db[_0x17dac7(0x10c)](turboState)),await delay(0xc8),await Module[_0x17dac7(0xe0)](),await delay(0x320),await led(parseInt(localStorage['getItem'](_0x17dac7(0xd8)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x363e34=a0_0x191a36;await ledSave(_0x363e34(0xdf)),await Module[_0x363e34(0xc0)](0x0),await Module['FSSync'](),await screenShot(0x0),console['log']('Auto\x20save\x20'+ ++countAutoSave+_0x363e34(0xe3));}async function saveStateInCloud(){const _0x165414=a0_0x191a36,_0x17954d=localStorage[_0x165414(0x110)](_0x165414(0xfd)),_0x34f79a=_0x17954d[_0x165414(0xf4)](/\.(zip|gb|gbc|gba)$/,_0x165414(0x112)),_0x232556=localStorage[_0x165414(0x110)]('uId');navigator[_0x165414(0x100)]&&(_0x232556&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x34f79a,Module['downloadFile'](_0x165414(0xd7)+_0x34f79a),'state'),await lockNoti('',_0x165414(0x102)+ ++countUpload+_0x165414(0xe3),0x7d0)));}function startTimer(){let [_0x341c19,_0x414f87,_0xc363ea,_0x49ae5b,_0x10b9db]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x422f01=a0_0x6841;_0xc363ea++,_0x49ae5b++,_0x10b9db++;if(_0xc363ea===0x3c)[_0xc363ea,_0x414f87]=[0x0,_0x414f87+0x1];if(_0x414f87===0x3c)[_0x414f87,_0x341c19]=[0x0,_0x341c19+0x1];document[_0x422f01(0xd1)]('timer')[_0x422f01(0xe8)]=_0x341c19+'h'+_0x414f87[_0x422f01(0x107)]()[_0x422f01(0xeb)](0x2,'0')+'.'+_0xc363ea['toString']()['padStart'](0x2,'0');_0x49ae5b===0x3c&&(saveStatePeriodically(),_0x49ae5b=0x0);;_0x10b9db===0x708&&(saveStateInCloud(),_0x10b9db=0x0);;},0x3e8);}export async function uploadGame(_0x1e58b4){const _0x54b9e0=a0_0x191a36,_0x5497dd=_0x1e58b4[_0x54b9e0(0xff)][0x0];Module['uploadRom'](_0x5497dd,()=>{const _0x403566=_0x54b9e0;Module[_0x403566(0xe2)]();});}export async function loadGame(_0x5236b0){const _0x36d594=a0_0x191a36,_0x106011=_0x5236b0[_0x36d594(0xf4)](/\.(gba|gbc|gb|zip)$/,_0x36d594(0x112)),_0x48b30a=Module[_0x36d594(0xc1)]()['filter'](_0x3447e1=>_0x3447e1!=='.'&&_0x3447e1!=='..');intro[_0x36d594(0xb7)][_0x36d594(0x109)](_0x36d594(0xbb)),errorLogElements[0x0][_0x36d594(0xc2)][_0x36d594(0xd4)]='0',ingame[_0x36d594(0xb7)][_0x36d594(0xc6)](_0x36d594(0xbb)),_0x5236b0['endsWith'](_0x36d594(0xd0))||_0x5236b0['endsWith'](_0x36d594(0xbf))?(canvas[_0x36d594(0xb7)]['add'](_0x36d594(0xda)),areaTrans[_0x36d594(0xb7)][_0x36d594(0x109)](_0x36d594(0xde)),localStorage[_0x36d594(0x10e)]('screenSize',_0x36d594(0x103)+(window[_0x36d594(0xd9)]-0xe6)+','+(window[_0x36d594(0xd9)]-0xe6)*0x9/0xa)):localStorage[_0x36d594(0x10e)](_0x36d594(0xe7),_0x36d594(0x103)+(window[_0x36d594(0xd9)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x48b30a['includes'](_0x106011)?(await Module[_0x36d594(0xcc)](_0x36d594(0x10a)+_0x5236b0),confirm(_0x36d594(0xfa))&&(await Module['loadState'](0x0),localStorage[_0x36d594(0x10e)]('gameName',_0x5236b0),console[_0x36d594(0xc9)](_0x5236b0))):(await Module[_0x36d594(0xcc)](_0x36d594(0x10a)+_0x5236b0),localStorage[_0x36d594(0x10e)](_0x36d594(0xfd),_0x5236b0),console[_0x36d594(0xc9)](_0x5236b0)),await statusShow();}export async function saveState(_0x11c00b){const _0x581187=a0_0x191a36;await Module[_0x581187(0xc0)](_0x11c00b),await Module['FSSync']();}export async function loadState(_0x34d76e){const _0x5d6fce=a0_0x191a36;await Module[_0x5d6fce(0xbd)](_0x34d76e);}export async function downloadFile(_0x260b63,_0x2e6161){const _0x2368aa=a0_0x191a36,_0x2d53f1=Module['downloadFile'](_0x260b63),_0x4e6d3f=document[_0x2368aa(0xd2)]('a');document[_0x2368aa(0xe6)][_0x2368aa(0x104)](_0x4e6d3f),_0x4e6d3f[_0x2368aa(0x113)]=_0x2e6161;const _0x14347=new Blob([_0x2d53f1],{'type':_0x2368aa(0xc3)});_0x4e6d3f[_0x2368aa(0xf1)]=URL['createObjectURL'](_0x14347),_0x4e6d3f['click'](),URL['revokeObjectURL'](_0x14347),_0x4e6d3f['remove']();}export function downloadFileInCloud(_0x205206){const _0x369fc4=a0_0x191a36,_0x5b96fc=Module[_0x369fc4(0xd3)](_0x205206);return _0x5b96fc;}export async function uploadFileInCloud(_0x26c9d4){const _0xee02f9=a0_0x191a36;Module[_0xee02f9(0xc5)](_0x26c9d4,()=>{localStorageFile(),Module['FSSync']();});}export async function uploadFile(_0x2ea3eb){const _0x4253b0=a0_0x191a36,_0x5ea0af=_0x2ea3eb[_0x4253b0(0xff)][0x0];Module[_0x4253b0(0xc5)](_0x5ea0af,()=>{const _0x1a33f5=_0x4253b0;localStorageFile(),Module[_0x1a33f5(0xe2)]();});}export async function editFile(_0xda6bd5,_0x1d8fa3,_0x3e30b8){const _0x1a3fbd=a0_0x191a36;await Module['editFileName'](_0xda6bd5,_0x1d8fa3,_0x3e30b8),await Module[_0x1a3fbd(0xe2)]();}export async function deleteFile(_0x410990){const _0x536fb2=a0_0x191a36;await Module[_0x536fb2(0xd6)](_0x410990),await Module['FSSync']();}export function listGame(){const _0x45ab31=a0_0x191a36,_0x505ff2=Module['listRoms']()[_0x45ab31(0xe1)](_0x40895e=>_0x40895e!=='.'&&_0x40895e!=='..');return _0x505ff2;}export function listSave(){const _0x2728b7=a0_0x191a36,_0x570693=Module[_0x2728b7(0x10f)]()[_0x2728b7(0xe1)](_0x382313=>_0x382313!=='.'&&_0x382313!=='..');return _0x570693;}export function listState(){const _0x3996d7=a0_0x191a36,_0x24f4e4=Module[_0x3996d7(0xc1)]()['filter'](_0xf8e5a4=>_0xf8e5a4!=='.'&&_0xf8e5a4!=='..');return _0x24f4e4;}export function listCheat(){const _0x147f85=a0_0x191a36,_0x97f54c=Module[_0x147f85(0xc8)]()[_0x147f85(0xe1)](_0x59ff4e=>_0x59ff4e!=='.'&&_0x59ff4e!=='..');return _0x97f54c;}function a0_0x5005(){const _0x21e5c3=['.gb','saveState','listStates','style','application/octet-stream','set','uploadAll','remove','type','listCheats','log','canvas','2268963bbhhbJ','loadGame','buttonUnpress','image/png','pauseGame','.gbc','getElementById','createElement','downloadFile','bottom','buttonPress','deleteFile','/data/states/','slotStateSaved','innerWidth','gbc','52eihORh','fileSize','persisted','gbc1','#20A5A6','SDL2','filter','FSSync','\x20time(s)','beforeunload','now','body','screenSize','textContent','Off','setVolume','padStart','charCodeAt','length','encode','/data/screenshots/','resumeGame','href','indexOf','turboState','replace','120603PmUuqf','2145736ZFeeMA','listScreenshots','addEventListener','tEXtComment\x00','Do\x20you\x20want\x20to\x20load\x20save\x20state?','8226040LTXuSX','248148JzOoep','gameName','45682BwIsWL','files','onLine','then','Cloud\x20upload\x20','0,0,','appendChild','split','contains','toString','Resumed!','add','/data/games/','pagehide','turboF','visible','setItem','listSaves','getItem','substring','.ss0','download','autoLoadCheats','246uNdcRQ','_savedCheats','classList','hidden','Cheat\x20Enabled!','10NodzGj','disable','20665iybvjM','loadState','screenshot'];a0_0x5005=function(){return _0x21e5c3;};return a0_0x5005();}export function listScreenshot(){const _0x247b69=a0_0x191a36,_0x4c677e=Module[_0x247b69(0xf7)]()['filter'](_0x1f7744=>_0x1f7744!=='.'&&_0x1f7744!=='..');return _0x4c677e;}export function embedTextInPngFile(_0x21cda3,_0x549cf9,_0xd17414){const _0x4b1153=a0_0x191a36;let _0x5248b2=atob(_0x21cda3['split'](',')[0x1]),_0x2e9824=new Uint8Array(_0x5248b2[_0x4b1153(0xed)]);for(let _0x583916=0x0;_0x583916<_0x5248b2[_0x4b1153(0xed)];_0x583916++){_0x2e9824[_0x583916]=_0x5248b2[_0x4b1153(0xec)](_0x583916);}let _0x581545=new TextEncoder()[_0x4b1153(0xee)](_0x4b1153(0xf9)+_0x549cf9),_0x367959=new Uint8Array(_0x2e9824[_0x4b1153(0xed)]+_0x581545[_0x4b1153(0xed)]);_0x367959[_0x4b1153(0xc4)](_0x2e9824,0x0),_0x367959[_0x4b1153(0xc4)](_0x581545,_0x2e9824[_0x4b1153(0xed)]);let _0x55df0a=new Blob([_0x367959],{'type':'image/png'}),_0x5ba26f=new File([_0x55df0a],_0xd17414,{'type':_0x4b1153(0xce)});return _0x5ba26f;}export function extractTextFromPngBase64(_0x19e480){const _0x3bb7a1=a0_0x191a36;let _0x23b65d=atob(_0x19e480[_0x3bb7a1(0x105)](',')[0x1]),_0x5e58ad=_0x3bb7a1(0xf9),_0x40bc97=_0x23b65d[_0x3bb7a1(0xf2)](_0x5e58ad);if(_0x40bc97!==-0x1)return _0x23b65d[_0x3bb7a1(0x111)](_0x40bc97+_0x5e58ad['length']);return null;}export function fileSize(_0xf79de6){const _0x7f71e0=a0_0x191a36,_0x4d57ad=Module[_0x7f71e0(0xdc)](_0xf79de6);return _0x4d57ad;}export async function resumeGame(){const _0x395aed=a0_0x191a36;Module[_0x395aed(0xf0)](),Module[_0x395aed(0xe0)](),notiMessage(_0x395aed(0x108),0x7d0);}export async function pauseGame(){const _0x44b106=a0_0x191a36;Module[_0x44b106(0xcf)](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x52c1a0){const _0x132acc=a0_0x191a36;Module[_0x132acc(0xd5)](_0x52c1a0);}export async function buttonUnpress(_0x2b5fbc){const _0x2d5cc0=a0_0x191a36;Module[_0x2d5cc0(0xcd)](_0x2b5fbc);}export async function screenShot(_0x50b2eb){const _0x47f876=a0_0x191a36,_0x1f24f1=localStorage[_0x47f876(0x110)](_0x47f876(0xfd))[_0x47f876(0xf4)](/\.(gba|gbc|gb|zip)$/,''),_0x4c9a88=_0x1f24f1+'_'+_0x50b2eb+'.png';await Module['screenshot'](_0x4c9a88),await Module['FSSync']();const _0x388825=await fileToBase64(Module[_0x47f876(0xd3)](_0x47f876(0xef)+_0x4c9a88)),_0x1d9113=embedTextInPngFile(_0x388825,formatDateTime(Date[_0x47f876(0xe5)]()),_0x4c9a88);Module['uploadAll'](_0x1d9113,()=>{localStorageFile(),Module['FSSync']();});}export async function dowloadScreenShot(_0x13daa1){const _0x3843af=a0_0x191a36;try{const _0x581b84=await fileToBase64(Module[_0x3843af(0xd3)](_0x13daa1));return _0x581b84;}catch{}}export async function captureOCR(_0x2abd5b){const _0x33c5fe=a0_0x191a36;Module[_0x33c5fe(0xbe)](_0x2abd5b);const _0x272345=Module[_0x33c5fe(0xd3)](_0x33c5fe(0xef)+_0x2abd5b);return _0x272345;}export async function setFastForwardMultiplier(_0x5c4658){Module['setFastForwardMultiplier'](_0x5c4658);}export function uploadCheats(_0x196c6a,_0x534021,_0x528256,_0x194106,_0x12e1ab){const _0x4979b4=a0_0x191a36;Module[_0x4979b4(0xc5)](_0x196c6a,()=>{const _0x3f7126=_0x4979b4;Module[_0x3f7126(0x114)](),setTimeout(()=>{const _0x197b95=_0x3f7126;Module[_0x197b95(0xe2)]();},0x1f4),_0x194106&&(localStorage[_0x3f7126(0x10e)](_0x534021+_0x3f7126(0xb6),_0x528256),notiMessage(_0x3f7126(0xb9),0x5dc)),_0x12e1ab[_0x3f7126(0xe8)]=localStorage[_0x3f7126(0x110)](_0x534021+_0x3f7126(0xb6)||_0x3f7126(0xe9));});}export function setVolume(_0x40ef2e){const _0x5d684c=a0_0x191a36;Module[_0x5d684c(0xea)](_0x40ef2e);}