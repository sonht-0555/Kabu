const a0_0x44b689=a0_0x453a;(function(_0x50d687,_0xed87cf){const _0x2d6c84=a0_0x453a,_0x10a140=_0x50d687();while(!![]){try{const _0x291222=parseInt(_0x2d6c84(0x170))/0x1*(parseInt(_0x2d6c84(0x197))/0x2)+-parseInt(_0x2d6c84(0x185))/0x3+parseInt(_0x2d6c84(0x1aa))/0x4*(parseInt(_0x2d6c84(0x1af))/0x5)+parseInt(_0x2d6c84(0x1a9))/0x6*(-parseInt(_0x2d6c84(0x1b0))/0x7)+-parseInt(_0x2d6c84(0x15a))/0x8*(parseInt(_0x2d6c84(0x159))/0x9)+-parseInt(_0x2d6c84(0x179))/0xa*(-parseInt(_0x2d6c84(0x17a))/0xb)+parseInt(_0x2d6c84(0x19c))/0xc*(parseInt(_0x2d6c84(0x16d))/0xd);if(_0x291222===_0xed87cf)break;else _0x10a140['push'](_0x10a140['shift']());}catch(_0x38510e){_0x10a140['push'](_0x10a140['shift']());}}}(a0_0x462c,0xaf313));import a0_0x28b2f6 from'../core/mgba.js';import*as a0_0x873a41 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x44b689(0x17d)](a0_0x44b689(0x165))};function initializeCore(_0x273b31,_0x376881){_0x273b31(_0x376881)['then'](function(_0x23d614){_0x23d614['FSInit']();});}initializeCore(a0_0x28b2f6,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;function a0_0x462c(){const _0x1843fc=['visible','editFileName','3140cFdfGU','15598DvVpHW','_imageState0','uploadCheats','getElementById','Auto\x20save\x20','loadState','visibilitychange','Cheat\x20Enabled!','padStart','text/plain','/data/screenshots/','1425846tzLAFC','replace','remove','name','disable','timer','listScreenshots','FSSync','downloadFile','setItem','setFastForwardMultiplier','files','persisted','0,0,','bottom','uploadSaveOrSaveState','pagehide','Unable\x20to\x20upload\x20to\x20Cloud!','4HgUbgk','appendChild','resumeGame','\x20time(s)','innerWidth','1356aujnXv','style','uploadRom','createElement','listStates','endsWith','gbc','type','_savedCheats','.gba','Paused!','gbc1','.ss0','780xwTpoU','1084LjbiiV','listSaves','revokeObjectURL','fileSize','screenshot','1525vZdSFg','17241oiOamD','control-setting','_imageState','classList','contains','download','body','screenSize','href','click','turboF','297FdFKFp','205256PhKtYJ','/data/states/','Cloud\x20upload\x20','getItem','now','log','add','/data/games/','buttonUnpress','_dateState','_slot0.txt','canvas','SDL2','.png','_dateState0','beforeunload','saveState','textContent','No\x20screenshot!','97617zkoyEu','addEventListener','Resumed!','491658qqHYNp','.gbc','createObjectURL','Save/State\x20uploaded\x20successfully:','error','turboState','gameName'];a0_0x462c=function(){return _0x1843fc;};return a0_0x462c();}const canvas=document[a0_0x44b689(0x17d)](a0_0x44b689(0x165)),savedTurboState=localStorage[a0_0x44b689(0x15d)](a0_0x44b689(0x175)),controlSetting=document[a0_0x44b689(0x17d)](a0_0x44b689(0x1b1));function handleVisibilityChange(_0x176aa9){const _0x203119=a0_0x44b689;document['visibilityState']==='hidden'||_0x176aa9?.[_0x203119(0x1a3)]===_0x203119(0x169)||_0x176aa9?.[_0x203119(0x191)]?(pauseGame(),canvas['classList'][_0x203119(0x160)](_0x203119(0x177))):(setTimeout(()=>{const _0x5084c1=_0x203119;canvas['classList'][_0x5084c1(0x187)](_0x5084c1(0x177));},0x258),controlSetting[_0x203119(0x151)][_0x203119(0x152)](_0x203119(0x177))&&resumeGame());}async function statusShow(){const _0x294d0f=a0_0x44b689;document[_0x294d0f(0x16e)](_0x294d0f(0x195),handleVisibilityChange),document[_0x294d0f(0x16e)](_0x294d0f(0x180),handleVisibilityChange),window[_0x294d0f(0x16e)](_0x294d0f(0x169),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x873a41[_0x294d0f(0x158)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x294d0f(0x15d)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x1b7195=a0_0x44b689;await ledSave('#20A5A6'),await Module[_0x1b7195(0x16a)](0x0),await Module[_0x1b7195(0x18c)](),await screenShot(0x0),console['log'](_0x1b7195(0x17e)+ ++countAutoSave+_0x1b7195(0x19a));}async function saveStateInCloud(){const _0x3e208b=a0_0x44b689,_0x2809aa=localStorage[_0x3e208b(0x15d)](_0x3e208b(0x176)),_0x1f6cb3=_0x2809aa[_0x3e208b(0x186)](_0x3e208b(0x1a5),_0x3e208b(0x1a8)),_0x32c151=localStorage[_0x3e208b(0x15d)]('uId'),_0x57d0a5=localStorage[_0x3e208b(0x15d)](_0x2809aa+_0x3e208b(0x17b)),_0x15f817=localStorage[_0x3e208b(0x15d)](_0x2809aa+_0x3e208b(0x168));if(navigator['onLine']){if(_0x32c151){await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x1f6cb3,Module[_0x3e208b(0x18d)](_0x3e208b(0x15b)+_0x1f6cb3));if(_0x57d0a5!==null){const _0x54a46c=_0x57d0a5+'\x0a\x0a'+_0x15f817,_0x232cf5=new Blob([_0x54a46c],{'type':_0x3e208b(0x183)});await dpUploadFile(_0x2809aa+_0x3e208b(0x164),_0x232cf5);}else console[_0x3e208b(0x15f)](_0x3e208b(0x16c));await lockNoti('',_0x3e208b(0x15c)+ ++countUpload+_0x3e208b(0x19a),0x7d0);}else console[_0x3e208b(0x15f)](_0x3e208b(0x196));}else console['log']('Online!');}function startTimer(){let [_0x46b326,_0x516f39,_0x559c4b,_0x556105,_0x62525b]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x13072c=a0_0x453a;_0x559c4b++,_0x556105++,_0x62525b++;if(_0x559c4b===0x3c)[_0x559c4b,_0x516f39]=[0x0,_0x516f39+0x1];if(_0x516f39===0x3c)[_0x516f39,_0x46b326]=[0x0,_0x46b326+0x1];document[_0x13072c(0x17d)](_0x13072c(0x18a))[_0x13072c(0x16b)]=_0x46b326+'h'+_0x516f39['toString']()[_0x13072c(0x182)](0x2,'0')+'.'+_0x559c4b['toString']()['padStart'](0x2,'0');_0x556105===0x3c&&(saveStatePeriodically(),_0x556105=0x0);;_0x556105===0xe10&&(saveStateInCloud(),_0x62525b=0x0);;},0x3e8);}export async function uploadGame(_0x60ea39){const _0x24f78d=a0_0x44b689,_0x1eae24=_0x60ea39[_0x24f78d(0x190)][0x0];Module[_0x24f78d(0x19e)](_0x1eae24,()=>{Module['FSSync']();});}export async function loadGame(_0x43c88e){const _0x1a7956=a0_0x44b689,_0x217d01=_0x43c88e[_0x1a7956(0x186)](/\.(gba|gbc|gb|zip)$/,_0x1a7956(0x1a8)),_0x576021=Module[_0x1a7956(0x1a0)]();intro[_0x1a7956(0x151)][_0x1a7956(0x160)](_0x1a7956(0x189)),errorLogElements[0x0][_0x1a7956(0x19d)][_0x1a7956(0x193)]='0',ingame[_0x1a7956(0x151)]['remove'](_0x1a7956(0x189)),_0x43c88e[_0x1a7956(0x1a1)](_0x1a7956(0x171))||_0x43c88e[_0x1a7956(0x1a1)]('.gb')?(canvas[_0x1a7956(0x151)][_0x1a7956(0x160)](_0x1a7956(0x1a2)),areaTrans[_0x1a7956(0x151)][_0x1a7956(0x160)](_0x1a7956(0x1a7)),localStorage[_0x1a7956(0x18e)](_0x1a7956(0x155),'0,0,'+(window['innerWidth']-0xe6)+','+(window[_0x1a7956(0x19b)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x1a7956(0x155),_0x1a7956(0x192)+(window[_0x1a7956(0x19b)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x576021['includes'](_0x217d01)?(await Module['loadGame'](_0x1a7956(0x161)+_0x43c88e),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x1a7956(0x17f)](0x0),localStorage[_0x1a7956(0x18e)](_0x1a7956(0x176),_0x43c88e),console[_0x1a7956(0x15f)](_0x43c88e))):(await Module['loadGame']('/data/games/'+_0x43c88e),localStorage[_0x1a7956(0x18e)](_0x1a7956(0x176),_0x43c88e)),await statusShow();}export async function saveState(_0xcba0fd){const _0x2c8022=a0_0x44b689;await Module[_0x2c8022(0x16a)](_0xcba0fd),await Module[_0x2c8022(0x18c)]();}export async function loadState(_0x334ef2){const _0x4da966=a0_0x44b689;await Module[_0x4da966(0x17f)](_0x334ef2);}export async function downloadFile(_0x136d74,_0x22af02){const _0x4d5e77=a0_0x44b689,_0x18fe88=Module[_0x4d5e77(0x18d)](_0x136d74),_0x53e3e4=document[_0x4d5e77(0x19f)]('a');document[_0x4d5e77(0x154)][_0x4d5e77(0x198)](_0x53e3e4),_0x53e3e4[_0x4d5e77(0x153)]=_0x22af02;const _0x13c3c7=new Blob([_0x18fe88],{'type':'application/octet-stream'});_0x53e3e4[_0x4d5e77(0x156)]=URL[_0x4d5e77(0x172)](_0x13c3c7),_0x53e3e4[_0x4d5e77(0x157)](),URL[_0x4d5e77(0x1ac)](_0x13c3c7),_0x53e3e4['remove']();}export function downloadFileInCloud(_0x58110f){const _0xafecf7=a0_0x44b689,_0x6b4a77=Module[_0xafecf7(0x18d)](_0x58110f);return _0x6b4a77;}export async function uploadFile(_0x51c772){const _0x466e31=a0_0x44b689,_0x5cbfaf=_0x51c772[_0x466e31(0x190)][0x0];Module[_0x466e31(0x194)](_0x5cbfaf,()=>{const _0xbd698d=_0x466e31;Module[_0xbd698d(0x18c)]();});}export async function editFile(_0x495ebb,_0x286e7c,_0x5b0460){const _0x203368=a0_0x44b689;await Module[_0x203368(0x178)](_0x495ebb,_0x286e7c,_0x5b0460),await Module[_0x203368(0x18c)]();}export async function deleteFile(_0x498b2d){const _0xde1367=a0_0x44b689;await Module['deleteFile'](_0x498b2d),await Module[_0xde1367(0x18c)]();}export function listGame(){const _0xc9ab0d=Module['listGames']();return _0xc9ab0d;}export function listSave(){const _0x4470a9=a0_0x44b689,_0x27d0ff=Module[_0x4470a9(0x1ab)]();return _0x27d0ff;}export function listState(){const _0x279749=Module['listStates']();return _0x279749;}export function listCheat(){const _0x1c63ce=Module['listCheats']();return _0x1c63ce;}export function listScreenshot(){const _0xbd8a89=a0_0x44b689,_0x39ab96=Module[_0xbd8a89(0x18b)]();return _0x39ab96;}export function fileSize(_0x4ce2fa){const _0x1b6bc3=a0_0x44b689,_0x7e9bfe=Module[_0x1b6bc3(0x1ad)](_0x4ce2fa);return _0x7e9bfe;}export async function uploadCheat(_0x4174bc){const _0x24bec3=a0_0x44b689;try{const _0x36b20c=_0x4174bc[_0x24bec3(0x190)][0x0];await Module[_0x24bec3(0x17c)](_0x36b20c,()=>{const _0x3ca17d=_0x24bec3;console[_0x3ca17d(0x15f)]('Cheat\x20uploaded\x20successfully:',_0x36b20c[_0x3ca17d(0x188)]),localStorageFile(),Module[_0x3ca17d(0x18c)]();});}catch(_0x36cabe){console[_0x24bec3(0x174)]('Error\x20uploadCheat:',_0x36cabe);}}function a0_0x453a(_0x269fe8,_0x420202){const _0x462c5a=a0_0x462c();return a0_0x453a=function(_0x453a86,_0x1b1da8){_0x453a86=_0x453a86-0x150;let _0x38316c=_0x462c5a[_0x453a86];return _0x38316c;},a0_0x453a(_0x269fe8,_0x420202);}export async function uploadSavSta(_0x298592){const _0x2898fd=a0_0x44b689;try{const _0x4a1a0b=_0x298592['files'][0x0];await Module[_0x2898fd(0x194)](_0x4a1a0b,()=>{const _0x30aa90=_0x2898fd;console[_0x30aa90(0x15f)](_0x30aa90(0x173),_0x4a1a0b[_0x30aa90(0x188)]),localStorageFile(),Module[_0x30aa90(0x18c)]();});}catch(_0x297909){console[_0x2898fd(0x174)]('Error\x20uploadSavSta:',_0x297909);}}export async function uploadSaveOrSaveState(_0x509491){const _0x21e0d7=a0_0x44b689;Module[_0x21e0d7(0x194)](_0x509491,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0xc4c9ca=a0_0x44b689;Module[_0xc4c9ca(0x199)](),Module[_0xc4c9ca(0x166)](),notiMessage(_0xc4c9ca(0x16f),0x7d0);}export async function pauseGame(){const _0x389ce6=a0_0x44b689;Module['pauseGame'](),Module[_0x389ce6(0x166)](),notiMessage(_0x389ce6(0x1a6),0x7d0);}export async function buttonPress(_0x33eda4){Module['buttonPress'](_0x33eda4);}export async function buttonUnpress(_0x4fe65a){const _0x2993e1=a0_0x44b689;Module[_0x2993e1(0x162)](_0x4fe65a);}export async function screenShot(_0x6e5683){const _0x505bcb=a0_0x44b689,_0xa6b590=localStorage['getItem'](_0x505bcb(0x176)),_0x3b063d=_0xa6b590[_0x505bcb(0x186)](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x505bcb(0x1ae)](''+_0x3b063d+_0x6e5683+'.png'),await Module[_0x505bcb(0x18c)]();const _0x2963bd=await fileToBase64(Module['downloadFile'](_0x505bcb(0x184)+_0x3b063d+_0x6e5683+_0x505bcb(0x167))),_0x5f2d3a=Date[_0x505bcb(0x15e)](),_0x871a8a=formatDateTime(_0x5f2d3a);localStorage[_0x505bcb(0x18e)](_0xa6b590+_0x505bcb(0x163)+_0x6e5683,_0x871a8a),localStorage['setItem'](_0xa6b590+_0x505bcb(0x150)+_0x6e5683,_0x2963bd);}export async function captureOCR(_0x504811){const _0x3e21d9=a0_0x44b689;Module['screenshot'](_0x504811);const _0xdeb1c4=Module[_0x3e21d9(0x18d)]('/data/screenshots/'+_0x504811);return _0xdeb1c4;}export async function setFastForwardMultiplier(_0x263c31){const _0x2e9f44=a0_0x44b689;Module[_0x2e9f44(0x18f)](_0x263c31);}export function uploadCheats(_0x583411,_0x204ac7,_0x5e9b59,_0x10fb68,_0x1643d9){const _0x1a0c11=a0_0x44b689;Module[_0x1a0c11(0x17c)](_0x583411,()=>{const _0x4c1940=_0x1a0c11;Module['autoLoadCheats'](),setTimeout(()=>{const _0x227127=a0_0x453a;Module[_0x227127(0x18c)]();},0x1f4),_0x10fb68&&(localStorage['setItem'](_0x204ac7+_0x4c1940(0x1a4),_0x5e9b59),notiMessage(_0x4c1940(0x181),0x5dc)),_0x1643d9[_0x4c1940(0x16b)]=localStorage['getItem'](_0x204ac7+_0x4c1940(0x1a4)||'Off');});}