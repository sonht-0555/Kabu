const a0_0xcb4595=a0_0x4716;(function(_0x1bb72f,_0x2b22d6){const _0x435d0b=a0_0x4716,_0x10400f=_0x1bb72f();while(!![]){try{const _0x1a5407=-parseInt(_0x435d0b(0xc7))/0x1*(parseInt(_0x435d0b(0x111))/0x2)+-parseInt(_0x435d0b(0x10a))/0x3+parseInt(_0x435d0b(0xcc))/0x4+-parseInt(_0x435d0b(0xd4))/0x5+parseInt(_0x435d0b(0x117))/0x6+parseInt(_0x435d0b(0xe7))/0x7+-parseInt(_0x435d0b(0x11b))/0x8;if(_0x1a5407===_0x2b22d6)break;else _0x10400f['push'](_0x10400f['shift']());}catch(_0x52a738){_0x10400f['push'](_0x10400f['shift']());}}}(a0_0x4e0e,0x4ef8a));import a0_0x2e874e from'../core/mgba.js';import*as a0_0x532162 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0xcb4595(0xc6))};function initializeCore(_0x5b4822,_0x497ba0){const _0x4f218a=a0_0xcb4595;_0x5b4822(_0x497ba0)[_0x4f218a(0x113)](function(_0x499b55){const _0x91df95=_0x4f218a;_0x499b55[_0x91df95(0x10f)]();});}initializeCore(a0_0x2e874e,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document['getElementById'](a0_0xcb4595(0xc6)),savedTurboState=localStorage['getItem'](a0_0xcb4595(0x11d)),controlSetting=document['getElementById'](a0_0xcb4595(0xe5));function handleVisibilityChange(_0x192ed6){const _0x4944f7=a0_0xcb4595;document[_0x4944f7(0x104)]==='hidden'||_0x192ed6?.[_0x4944f7(0xd5)]==='beforeunload'||_0x192ed6?.[_0x4944f7(0xe4)]?(pauseGame(),canvas[_0x4944f7(0xea)][_0x4944f7(0xe1)]('visible')):(setTimeout(()=>{const _0x10ceb3=_0x4944f7;canvas[_0x10ceb3(0xea)][_0x10ceb3(0xf3)](_0x10ceb3(0xef));},0x258),controlSetting[_0x4944f7(0xea)][_0x4944f7(0xd1)](_0x4944f7(0xef))&&resumeGame());}async function statusShow(){const _0x108a18=a0_0xcb4595;document[_0x108a18(0xe9)](_0x108a18(0x114),handleVisibilityChange),document[_0x108a18(0xe9)]('visibilitychange',handleVisibilityChange),window['addEventListener'](_0x108a18(0xc0),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x532162['turboF'](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x108a18(0x123)](_0x108a18(0x10c)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3dd565=a0_0xcb4595;await ledSave(_0x3dd565(0xfd)),await Module['saveState'](0x0),await Module['FSSync'](),await screenShot(0x0),console['log'](_0x3dd565(0xc1)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0xfce6ec=a0_0xcb4595,_0x5f14f6=localStorage[_0xfce6ec(0x123)](_0xfce6ec(0xf1)),_0x1f3545=_0x5f14f6[_0xfce6ec(0xd8)]('.gba','.ss0'),_0x5c775c=localStorage[_0xfce6ec(0x123)]('uId'),_0x5a4437=localStorage['getItem'](_0x5f14f6+_0xfce6ec(0x11a)),_0x45ecfe=localStorage[_0xfce6ec(0x123)](_0x5f14f6+_0xfce6ec(0xc8));if(navigator[_0xfce6ec(0x110)]){if(_0x5c775c){await ledSave(_0xfce6ec(0xd6)),await delay(0x3e8),await dpUploadFile(_0x1f3545,Module[_0xfce6ec(0x119)](_0xfce6ec(0xe3)+_0x1f3545));if(_0x5a4437!==null){const _0x4ea381=_0x5a4437+'\x0a\x0a'+_0x45ecfe,_0x4e9b2f=new Blob([_0x4ea381],{'type':_0xfce6ec(0xd2)});await dpUploadFile(_0x5f14f6+_0xfce6ec(0x102),_0x4e9b2f);}else console['log']('No\x20screenshot!');await lockNoti('',_0xfce6ec(0xf6)+ ++countUpload+_0xfce6ec(0xe2),0x7d0);}else console[_0xfce6ec(0x10b)](_0xfce6ec(0xc4));}else console[_0xfce6ec(0x10b)](_0xfce6ec(0xd3));}function startTimer(){let [_0x24aede,_0x1c2a8d,_0x4a1be0,_0x3905c7,_0x39c771]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x53d51c=a0_0x4716;_0x4a1be0++,_0x3905c7++,_0x39c771++;if(_0x4a1be0===0x3c)[_0x4a1be0,_0x1c2a8d]=[0x0,_0x1c2a8d+0x1];if(_0x1c2a8d===0x3c)[_0x1c2a8d,_0x24aede]=[0x0,_0x24aede+0x1];document[_0x53d51c(0xe0)](_0x53d51c(0xf9))[_0x53d51c(0x103)]=_0x24aede+'h'+_0x1c2a8d[_0x53d51c(0xf4)]()[_0x53d51c(0x100)](0x2,'0')+'.'+_0x4a1be0[_0x53d51c(0xf4)]()[_0x53d51c(0x100)](0x2,'0');_0x3905c7===0x3c&&(saveStatePeriodically(),_0x3905c7=0x0);;_0x3905c7===0xe10&&(saveStateInCloud(),_0x39c771=0x0);;},0x3e8);}export async function uploadGame(_0x192772){const _0x465a33=a0_0xcb4595,_0x1e1ef9=_0x192772['files'][0x0];Module[_0x465a33(0xc3)](_0x1e1ef9,()=>{const _0x29b9b3=_0x465a33;Module[_0x29b9b3(0xde)]();});}export async function loadGame(_0x36cec2){const _0x9e738a=a0_0xcb4595,_0x439ef5=_0x36cec2['replace'](/\.(gba|gbc|gb|zip)$/,_0x9e738a(0x10e)),_0x392f57=Module[_0x9e738a(0xec)]()[_0x9e738a(0xf0)](_0x1ca73b=>_0x1ca73b!=='.'&&_0x1ca73b!=='..');intro['classList'][_0x9e738a(0xe1)](_0x9e738a(0xe8)),errorLogElements[0x0][_0x9e738a(0xf2)][_0x9e738a(0x118)]='0',ingame[_0x9e738a(0xea)][_0x9e738a(0xf3)]('disable'),_0x36cec2[_0x9e738a(0xfb)](_0x9e738a(0xc5))||_0x36cec2['endsWith']('.gb')?(canvas[_0x9e738a(0xea)][_0x9e738a(0xe1)]('gbc'),areaTrans[_0x9e738a(0xea)]['add']('gbc1'),localStorage[_0x9e738a(0xdf)]('screenSize',_0x9e738a(0xca)+(window['innerWidth']-0xe6)+','+(window[_0x9e738a(0x106)]-0xe6)*0x9/0xa)):localStorage[_0x9e738a(0xdf)](_0x9e738a(0x11c),'0,0,'+(window[_0x9e738a(0x106)]-0x96)+','+(window[_0x9e738a(0x106)]-0x96)*0x2/0x3),_0x392f57['includes'](_0x439ef5)?(await Module[_0x9e738a(0xe6)](_0x9e738a(0xed)+_0x36cec2),confirm(_0x9e738a(0x121))&&(await Module[_0x9e738a(0xd0)](0x0),await Module[_0x9e738a(0xf8)](),localStorage[_0x9e738a(0xdf)]('gameName',_0x36cec2),console['log'](_0x36cec2))):(await Module[_0x9e738a(0xe6)](_0x9e738a(0xed)+_0x36cec2),await Module['SDL2'](),localStorage[_0x9e738a(0xdf)](_0x9e738a(0xf1),_0x36cec2)),await statusShow();}function a0_0x4e0e(){const _0x58de5c=['then','pagehide','Error\x20uploadSavSta:','now','2819718iCiCWi','bottom','downloadFile','_imageState0','394848zdIEpn','screenSize','turboState','createObjectURL','error','download','Do\x20you\x20want\x20to\x20load\x20save\x20state?','/data/screenshots/','getItem','href','beforeunload','Auto\x20save\x20','pauseGame','uploadRom','Unable\x20to\x20upload\x20to\x20Cloud!','.gbc','canvas','746zzCpEc','_dateState0','uploadCheats','0,0,','Cheat\x20Enabled!','411688ueNLCc','createElement','.png','screenshot','loadState','contains','text/plain','Online!','83750oBMxqM','type','#E0C068','appendChild','replace','Save/State\x20uploaded\x20successfully:','Error\x20uploadCheat:','editFileName','name','_imageState','FSSync','setItem','getElementById','add','\x20time(s)','/data/states/','persisted','control-setting','loadGame','3381658mUFxaA','disable','addEventListener','classList','setFastForwardMultiplier','listStates','/data/games/','listCheats','visible','filter','gameName','style','remove','toString','Paused!','Cloud\x20upload\x20','resumeGame','SDL2','timer','buttonUnpress','endsWith','listSaves','#20A5A6','buttonPress','files','padStart','body','_slot0.txt','textContent','visibilityState','Off','innerWidth','_dateState','saveState','listScreenshots','1840293iHnYzD','log','slotStateSaved','Resumed!','.ss0','FSInit','onLine','142lCbvCm','uploadSaveOrSaveState'];a0_0x4e0e=function(){return _0x58de5c;};return a0_0x4e0e();}export async function saveState(_0x2a803c){const _0x5abeb6=a0_0xcb4595;await Module[_0x5abeb6(0x108)](_0x2a803c),await Module[_0x5abeb6(0xde)]();}export async function loadState(_0x2f9687){const _0x82a785=a0_0xcb4595;await Module[_0x82a785(0xd0)](_0x2f9687);}function a0_0x4716(_0x27aba1,_0x165ab9){const _0x4e0e28=a0_0x4e0e();return a0_0x4716=function(_0x471640,_0x35d646){_0x471640=_0x471640-0xc0;let _0x45af5a=_0x4e0e28[_0x471640];return _0x45af5a;},a0_0x4716(_0x27aba1,_0x165ab9);}export async function downloadFile(_0x17498b,_0x502eb5){const _0x364ff8=a0_0xcb4595,_0x727e17=Module['downloadFile'](_0x17498b),_0x537524=document[_0x364ff8(0xcd)]('a');document[_0x364ff8(0x101)][_0x364ff8(0xd7)](_0x537524),_0x537524[_0x364ff8(0x120)]=_0x502eb5;const _0xe8d4eb=new Blob([_0x727e17],{'type':'application/octet-stream'});_0x537524[_0x364ff8(0x124)]=URL[_0x364ff8(0x11e)](_0xe8d4eb),_0x537524['click'](),URL['revokeObjectURL'](_0xe8d4eb),_0x537524['remove']();}export function downloadFileInCloud(_0x2633d7){const _0x1c5dc0=a0_0xcb4595,_0x1be39e=Module[_0x1c5dc0(0x119)](_0x2633d7);return _0x1be39e;}export async function uploadFile(_0x1e2eff){const _0x2ed113=a0_0xcb4595,_0x5b8073=_0x1e2eff[_0x2ed113(0xff)][0x0];Module['uploadSaveOrSaveState'](_0x5b8073,()=>{const _0x5086b6=_0x2ed113;Module[_0x5086b6(0xde)]();});}export async function editFile(_0x4441a4,_0x58a966,_0xd97282){const _0x520901=a0_0xcb4595;await Module[_0x520901(0xdb)](_0x4441a4,_0x58a966,_0xd97282),await Module['FSSync']();}export async function deleteFile(_0x43aad0){await Module['deleteFile'](_0x43aad0),await Module['FSSync']();}export function listGame(){const _0x1a3de9=Module['listRoms']()['filter'](_0x133573=>_0x133573!=='.'&&_0x133573!=='..');return _0x1a3de9;}export function listSave(){const _0x286295=a0_0xcb4595,_0x26c1ce=Module[_0x286295(0xfc)]()[_0x286295(0xf0)](_0x38bd56=>_0x38bd56!=='.'&&_0x38bd56!=='..');return _0x26c1ce;}export function listState(){const _0x116c52=a0_0xcb4595,_0x5175c5=Module[_0x116c52(0xec)]()[_0x116c52(0xf0)](_0xda979b=>_0xda979b!=='.'&&_0xda979b!=='..');return _0x5175c5;}export function listCheat(){const _0x3a9ee6=a0_0xcb4595,_0x68d944=Module[_0x3a9ee6(0xee)]()[_0x3a9ee6(0xf0)](_0x5bc047=>_0x5bc047!=='.'&&_0x5bc047!=='..');return _0x68d944;}export function listScreenshot(){const _0x5783b0=a0_0xcb4595,_0x3410d0=Module[_0x5783b0(0x109)]()[_0x5783b0(0xf0)](_0x469f31=>_0x469f31!=='.'&&_0x469f31!=='..');return _0x3410d0;}export function fileSize(_0x531a5c){const _0x59bf3f=Module['fileSize'](_0x531a5c);return _0x59bf3f;}export async function uploadCheat(_0x36dc4f){const _0xa0a232=a0_0xcb4595;try{const _0x434793=_0x36dc4f[_0xa0a232(0xff)][0x0];await Module['uploadCheats'](_0x434793,()=>{const _0x181bd2=_0xa0a232;console[_0x181bd2(0x10b)]('Cheat\x20uploaded\x20successfully:',_0x434793['name']),localStorageFile(),Module[_0x181bd2(0xde)]();});}catch(_0x2713c8){console[_0xa0a232(0x11f)](_0xa0a232(0xda),_0x2713c8);}}export async function uploadSavSta(_0x37c8cf){const _0x6083af=a0_0xcb4595;try{const _0xdbf9eb=_0x37c8cf[_0x6083af(0xff)][0x0];await Module[_0x6083af(0x112)](_0xdbf9eb,()=>{const _0x3f98ef=_0x6083af;console[_0x3f98ef(0x10b)](_0x3f98ef(0xd9),_0xdbf9eb[_0x3f98ef(0xdc)]),localStorageFile(),Module['FSSync']();});}catch(_0x5e60f2){console['error'](_0x6083af(0x115),_0x5e60f2);}}export async function uploadSaveOrSaveState(_0x1b7c1a){Module['uploadSaveOrSaveState'](_0x1b7c1a,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0x8b1871=a0_0xcb4595;Module[_0x8b1871(0xf7)](),Module[_0x8b1871(0xf8)](),notiMessage(_0x8b1871(0x10d),0x7d0);}export async function pauseGame(){const _0x38b27d=a0_0xcb4595;Module[_0x38b27d(0xc2)](),Module[_0x38b27d(0xf8)](),notiMessage(_0x38b27d(0xf5),0x7d0);}export async function buttonPress(_0x384ad9){const _0xb24694=a0_0xcb4595;Module[_0xb24694(0xfe)](_0x384ad9);}export async function buttonUnpress(_0x5afe8c){const _0x5c4177=a0_0xcb4595;Module[_0x5c4177(0xfa)](_0x5afe8c);}export async function screenShot(_0x4703e1){const _0x56829c=a0_0xcb4595,_0x5553e7=localStorage[_0x56829c(0x123)](_0x56829c(0xf1)),_0x5ae19f=_0x5553e7[_0x56829c(0xd8)](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x56829c(0xcf)](''+_0x5ae19f+_0x4703e1+_0x56829c(0xce)),await Module[_0x56829c(0xde)]();const _0x53f03c=await fileToBase64(Module[_0x56829c(0x119)](_0x56829c(0x122)+_0x5ae19f+_0x4703e1+'.png')),_0x357571=Date[_0x56829c(0x116)](),_0x48f33a=formatDateTime(_0x357571);localStorage[_0x56829c(0xdf)](_0x5553e7+_0x56829c(0x107)+_0x4703e1,_0x48f33a),localStorage[_0x56829c(0xdf)](_0x5553e7+_0x56829c(0xdd)+_0x4703e1,_0x53f03c);}export async function captureOCR(_0x3ea75d){const _0xd015b2=a0_0xcb4595;Module[_0xd015b2(0xcf)](_0x3ea75d);const _0x54bfab=Module[_0xd015b2(0x119)](_0xd015b2(0x122)+_0x3ea75d);return _0x54bfab;}export async function setFastForwardMultiplier(_0x5be32f){const _0x1b3fbd=a0_0xcb4595;Module[_0x1b3fbd(0xeb)](_0x5be32f);}export function uploadCheats(_0x466e30,_0x9d7611,_0x1e2639,_0x58ab6d,_0x5aab71){const _0x54539d=a0_0xcb4595;Module[_0x54539d(0xc9)](_0x466e30,()=>{const _0x3d5b1d=_0x54539d;Module['autoLoadCheats'](),setTimeout(()=>{const _0x12c1b6=a0_0x4716;Module[_0x12c1b6(0xde)]();},0x1f4),_0x58ab6d&&(localStorage[_0x3d5b1d(0xdf)](_0x9d7611+'_savedCheats',_0x1e2639),notiMessage(_0x3d5b1d(0xcb),0x5dc)),_0x5aab71[_0x3d5b1d(0x103)]=localStorage[_0x3d5b1d(0x123)](_0x9d7611+'_savedCheats'||_0x3d5b1d(0x105));});}