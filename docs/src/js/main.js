const a0_0x53b4e2=a0_0x24bf;(function(_0x54d8cf,_0x588e49){const _0x3f5c0c=a0_0x24bf,_0x56f72a=_0x54d8cf();while(!![]){try{const _0x1b6dc5=-parseInt(_0x3f5c0c(0x103))/0x1+parseInt(_0x3f5c0c(0xd6))/0x2*(parseInt(_0x3f5c0c(0x127))/0x3)+-parseInt(_0x3f5c0c(0xe7))/0x4+parseInt(_0x3f5c0c(0xd7))/0x5*(parseInt(_0x3f5c0c(0xe3))/0x6)+-parseInt(_0x3f5c0c(0x101))/0x7+-parseInt(_0x3f5c0c(0xcd))/0x8*(-parseInt(_0x3f5c0c(0xd8))/0x9)+parseInt(_0x3f5c0c(0xc6))/0xa;if(_0x1b6dc5===_0x588e49)break;else _0x56f72a['push'](_0x56f72a['shift']());}catch(_0x32218b){_0x56f72a['push'](_0x56f72a['shift']());}}}(a0_0x3cf5,0xd9c58));import a0_0x3cf579 from'../core/mgba.js';import*as a0_0x138198 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';const Module={'canvas':document[a0_0x53b4e2(0xd9)](a0_0x53b4e2(0xfe))};function initializeCore(_0x1e825b,_0x57ea56){_0x1e825b(_0x57ea56)['then'](function(_0x667db){const _0x1f0115=a0_0x24bf;_0x667db[_0x1f0115(0x105)]();});}initializeCore(a0_0x3cf579,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x53b4e2(0xd9)]('canvas'),controlSetting=document[a0_0x53b4e2(0xd9)](a0_0x53b4e2(0xf9));function handleVisibilityChange(_0x3ab56c){const _0x104434=a0_0x53b4e2;document[_0x104434(0xee)]===_0x104434(0x102)||_0x3ab56c?.[_0x104434(0xea)]===_0x104434(0x11f)||_0x3ab56c?.[_0x104434(0x10a)]?(pauseGame(),canvas[_0x104434(0xff)][_0x104434(0x110)](_0x104434(0xfa))):(setTimeout(()=>{const _0x4f65ac=_0x104434;canvas[_0x4f65ac(0xff)][_0x4f65ac(0x106)](_0x4f65ac(0xfa));},0x258),controlSetting[_0x104434(0xff)][_0x104434(0x117)](_0x104434(0xfa))&&resumeGame());}async function statusShow(){const _0x26b516=a0_0x53b4e2;document[_0x26b516(0xc5)](_0x26b516(0x119),handleVisibilityChange),document[_0x26b516(0xc5)](_0x26b516(0x126),handleVisibilityChange),window[_0x26b516(0xc5)](_0x26b516(0x11f),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x138198[_0x26b516(0xc4)](parseInt(await getData(gameName,'0',_0x26b516(0x12d)))),await delay(0xc8),await Module[_0x26b516(0xe2)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x26b516(0x109)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x1ce121=a0_0x53b4e2;await ledSave(_0x1ce121(0x118)),await Module[_0x1ce121(0x114)](0x0),await Module[_0x1ce121(0xf7)](),await screenShot(0x0),console[_0x1ce121(0xd2)](_0x1ce121(0x132)+ ++countAutoSave+_0x1ce121(0xe4));}async function saveStateInCloud(){const _0x3d739c=a0_0x53b4e2,_0x1644b8=gameName[_0x3d739c(0xf5)](/\.(zip|gb|gbc|gba)$/,_0x3d739c(0x128)),_0x1b8ff3=localStorage[_0x3d739c(0x12c)](_0x3d739c(0xf1));navigator[_0x3d739c(0xf8)]&&(_0x1b8ff3&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x1644b8,Module['downloadFile'](_0x3d739c(0xd1)+_0x1644b8),_0x3d739c(0xc9)),await lockNoti('',_0x3d739c(0x11c)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0x5a2fbd,_0xbb58e5,_0x145722,_0x2f3a83,_0x55b1cf]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x5aa53a=a0_0x24bf;_0x145722++,_0x2f3a83++,_0x55b1cf++;if(_0x145722===0x3c)[_0x145722,_0xbb58e5]=[0x0,_0xbb58e5+0x1];if(_0xbb58e5===0x3c)[_0xbb58e5,_0x5a2fbd]=[0x0,_0x5a2fbd+0x1];document[_0x5aa53a(0xd9)](_0x5aa53a(0x11a))['textContent']=_0x5a2fbd+'h'+_0xbb58e5['toString']()[_0x5aa53a(0xc2)](0x2,'0')+'.'+_0x145722[_0x5aa53a(0xce)]()[_0x5aa53a(0xc2)](0x2,'0');_0x2f3a83===0x3c&&(saveStatePeriodically(),_0x2f3a83=0x0);;_0x55b1cf===0x708&&(saveStateInCloud(),_0x55b1cf=0x0);;},0x3e8);}export async function uploadGame(_0x3fcb32){const _0xa0266d=a0_0x53b4e2,_0x44608b=_0x3fcb32[_0xa0266d(0x113)][0x0];Module['uploadRom'](_0x44608b,()=>{const _0xd5a46c=_0xa0266d;Module[_0xd5a46c(0xf7)]();});}export async function loadGame(_0x5f4a0d){const _0x4142ab=a0_0x53b4e2,_0x35d96b=_0x5f4a0d[_0x4142ab(0xf5)](/\.(gba|gbc|gb|zip)$/,_0x4142ab(0x128)),_0x13d26e=Module['listStates']()[_0x4142ab(0xf0)](_0x242198=>_0x242198!=='.'&&_0x242198!=='..');intro[_0x4142ab(0xff)]['add']('disable'),errorLogElements[0x0][_0x4142ab(0x124)]['bottom']='0',ingame[_0x4142ab(0xff)][_0x4142ab(0x106)](_0x4142ab(0xdd)),_0x5f4a0d[_0x4142ab(0xd5)]('.gbc')||_0x5f4a0d['endsWith']('.gb')?(canvas[_0x4142ab(0xff)][_0x4142ab(0x110)](_0x4142ab(0x112)),areaTrans['classList'][_0x4142ab(0x110)](_0x4142ab(0xc3)),localStorage[_0x4142ab(0xfd)]('screenSize',_0x4142ab(0x12e)+(window[_0x4142ab(0xe9)]-0xe6)+','+(window[_0x4142ab(0xe9)]-0xe6)*0x9/0xa)):localStorage[_0x4142ab(0xfd)](_0x4142ab(0x11b),'0,0,'+(window['innerWidth']-0x96)+','+(window[_0x4142ab(0xe9)]-0x96)*0x2/0x3),_0x13d26e[_0x4142ab(0x11d)](_0x35d96b)?(await Module['loadGame'](_0x4142ab(0xed)+_0x5f4a0d),confirm(_0x4142ab(0x130))&&(await Module[_0x4142ab(0x12a)](0x0),await shaderData())):(await Module[_0x4142ab(0xf3)]('/data/games/'+gameName),await shaderData()),await statusShow();}export async function saveState(_0xcba315){const _0x2364e7=a0_0x53b4e2;await Module[_0x2364e7(0x114)](_0xcba315),await Module[_0x2364e7(0xf7)]();}function a0_0x3cf5(){const _0x33c66f=['persisted','pauseGame','led01','uploadAll','led02','opacity','add','\x20:\x20','gbc','files','saveState','led00','tEXtComment\x00','contains','#20A5A6','pagehide','timer','screenSize','Cloud\x20upload\x20','includes','Error\x20ledSave:','beforeunload','lastIndexOf','appendChild','body','led07','style','download','visibilitychange','1034661zmhDwp','.ss0','length','loadState','resumeGame','getItem','turboState','0,0,','setVolume','Do\x20you\x20want\x20to\x20load\x20save\x20state?','setFastForwardMultiplier','Auto\x20save\x20','error','downloadFile','createElement','padStart','gbc1','turboF','addEventListener','30632430tKUBkE','image/png','fill','state','listStates','textContent','listSaves','625272pZRiNe','toString','charCodeAt','Paused!','/data/states/','log','fileSize','autoLoadCheats','endsWith','2DaNjPW','736705wflYmn','63BbCFia','getElementById','substring','application/octet-stream','led04','disable','noti-mess','0.4','indexOf','/data/screenshots/','SDL2','42lQBzla','\x20time(s)','trim','set','6027440JBWWpf','.png','innerWidth','type','split','rgba(245,\x20232,\x20209,\x200.4)','/data/games/','visibilityState','buttonPress','filter','uId','led05','loadGame','led0','replace','buttonUnpress','FSSync','onLine','control-setting','visible','saveTime','now','setItem','canvas','classList','revokeObjectURL','8785406Olvsll','hidden','1332720vTeQqI','map','FSInit','remove','click','match','slotStateSaved'];a0_0x3cf5=function(){return _0x33c66f;};return a0_0x3cf5();}export async function loadState(_0x2666dd){const _0x4d90a4=a0_0x53b4e2;await Module[_0x4d90a4(0x12a)](_0x2666dd);}export async function downloadFile(_0x3d012a,_0x3b2699){const _0x228c97=a0_0x53b4e2,_0x2c5011=Module[_0x228c97(0xc0)](_0x3d012a),_0x56b319=document[_0x228c97(0xc1)]('a');document[_0x228c97(0x122)][_0x228c97(0x121)](_0x56b319),_0x56b319[_0x228c97(0x125)]=_0x3b2699;const _0xd0de62=new Blob([_0x2c5011],{'type':_0x228c97(0xdb)});_0x56b319['href']=URL['createObjectURL'](_0xd0de62),_0x56b319[_0x228c97(0x107)](),URL[_0x228c97(0x100)](_0xd0de62),_0x56b319[_0x228c97(0x106)]();}export function downloadFileInCloud(_0x54667f){const _0x59ac0d=a0_0x53b4e2;try{const _0x474836=Module[_0x59ac0d(0xc0)](_0x54667f);return _0x474836;}catch(_0x336774){return null;}}export async function uploadFileInCloud(_0x388a96){const _0x2fe57f=a0_0x53b4e2;Module[_0x2fe57f(0x10d)](_0x388a96,async()=>{const _0x9b6a8c=_0x2fe57f;localStorageFile(),await Module[_0x9b6a8c(0xf7)]();});}export async function uploadFile(_0xbbe51c){const _0x37b330=a0_0x53b4e2,_0x414d5d=_0xbbe51c[_0x37b330(0x113)][0x0];Module[_0x37b330(0x10d)](_0x414d5d,async()=>{localStorageFile(),await Module['FSSync']();});}export async function editFile(_0x1e2296,_0x4fd0d8,_0x2fe2e1){const _0x13ae57=a0_0x53b4e2;await Module['editFileName'](_0x1e2296,_0x4fd0d8,_0x2fe2e1),await Module[_0x13ae57(0xf7)]();}export async function deleteFile(_0x500fc6){const _0x4440cb=a0_0x53b4e2;await Module['deleteFile'](_0x500fc6),await Module[_0x4440cb(0xf7)]();}export function listGame(){const _0x12f530=a0_0x53b4e2,_0x892b93=Module['listRoms']()[_0x12f530(0xf0)](_0x481d0b=>_0x481d0b!=='.'&&_0x481d0b!=='..');return _0x892b93;}export function listSave(){const _0x388bff=a0_0x53b4e2,_0x3b6c0b=Module[_0x388bff(0xcc)]()[_0x388bff(0xf0)](_0x3b6202=>_0x3b6202!=='.'&&_0x3b6202!=='..');return _0x3b6c0b;}export function listState(){const _0x12cfb9=a0_0x53b4e2,_0x5863d5=Module[_0x12cfb9(0xca)]()[_0x12cfb9(0xf0)](_0x12fa0d=>_0x12fa0d!=='.'&&_0x12fa0d!=='..');return _0x5863d5;}export function listCheat(){const _0x10113c=a0_0x53b4e2,_0x223d71=Module['listCheats']()[_0x10113c(0xf0)](_0x3c15ff=>_0x3c15ff!=='.'&&_0x3c15ff!=='..');return _0x223d71;}export function listScreenshot(){const _0x3de361=Module['listScreenshots']()['filter'](_0x1aa97e=>_0x1aa97e!=='.'&&_0x1aa97e!=='..');return _0x3de361;}export function embedTextInPngFile(_0x38d077,_0x3cabf9,_0x3666f0){const _0x4d3df1=a0_0x53b4e2;let _0x5f2e95=atob(_0x38d077[_0x4d3df1(0xeb)](',')[0x1]),_0xd98163=new Uint8Array(_0x5f2e95['length']);for(let _0x9b9caa=0x0;_0x9b9caa<_0x5f2e95['length'];_0x9b9caa++){_0xd98163[_0x9b9caa]=_0x5f2e95[_0x4d3df1(0xcf)](_0x9b9caa);}let _0x4cd259=new TextEncoder()['encode'](_0x4d3df1(0x116)+_0x3cabf9),_0x1ace4d=new Uint8Array(_0xd98163['length']+_0x4cd259[_0x4d3df1(0x129)]);_0x1ace4d[_0x4d3df1(0xe6)](_0xd98163,0x0),_0x1ace4d[_0x4d3df1(0xe6)](_0x4cd259,_0xd98163[_0x4d3df1(0x129)]);let _0x177d0c=new Blob([_0x1ace4d],{'type':'image/png'}),_0x41de91=new File([_0x177d0c],_0x3666f0,{'type':'image/png'});return _0x41de91;}export function extractTextFromPngBase64(_0x1bb5fa){const _0xb5bc72=a0_0x53b4e2;let _0x22b528=atob(_0x1bb5fa[_0xb5bc72(0xeb)](',')[0x1]),_0x184bb0=_0xb5bc72(0x116),_0x1313d3=_0x22b528[_0xb5bc72(0xe0)](_0x184bb0);if(_0x1313d3!==-0x1)return _0x22b528[_0xb5bc72(0xda)](_0x1313d3+_0x184bb0[_0xb5bc72(0x129)]);return null;}function a0_0x24bf(_0x328576,_0x4460f7){const _0x3cf567=a0_0x3cf5();return a0_0x24bf=function(_0x24bfa7,_0x21e8ff){_0x24bfa7=_0x24bfa7-0xc0;let _0x170b61=_0x3cf567[_0x24bfa7];return _0x170b61;},a0_0x24bf(_0x328576,_0x4460f7);}export function fileSize(_0x55c3da){const _0x42ed46=a0_0x53b4e2,_0x31c80b=Module[_0x42ed46(0xd3)](_0x55c3da);return _0x31c80b;}export async function resumeGame(){const _0x2daaac=a0_0x53b4e2;Module[_0x2daaac(0x12b)](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x4b88c0=a0_0x53b4e2;Module[_0x4b88c0(0x10b)](),Module[_0x4b88c0(0xe2)](),notiMessage(_0x4b88c0(0xd0),0x7d0);}export async function buttonPress(_0x3cf267){const _0x2ab43e=a0_0x53b4e2;Module[_0x2ab43e(0xef)](_0x3cf267);}export async function buttonUnpress(_0x40155e){const _0x212343=a0_0x53b4e2;Module[_0x212343(0xf6)](_0x40155e);}export async function screenShot(_0x259f90){const _0x42252c=a0_0x53b4e2,_0x45adcd=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0x259f90+'.png'),_0x30b4f8=await getData(gameName,_0x259f90,'All')||'';console[_0x42252c(0xd2)](_0x30b4f8),await Module['screenshot'](_0x45adcd),await setData(gameName,_0x259f90,_0x42252c(0xfb),formatDateTime(Date[_0x42252c(0xfc)]()),_0x30b4f8);}export async function dowloadScreenShot(_0x3d43b2){const _0x23c705=a0_0x53b4e2;try{const _0x1b7bef=await fileToBase64(Module[_0x23c705(0xc0)](_0x3d43b2));return _0x1b7bef;}catch{}}export async function captureOCR(_0xcdb268){const _0x18765e=a0_0x53b4e2;Module['screenshot'](_0xcdb268);const _0x1d6025=Module[_0x18765e(0xc0)](_0x18765e(0xe1)+_0xcdb268);return _0x1d6025;}export async function setFastForwardMultiplier(_0xf95cbb){const _0x4adf23=a0_0x53b4e2;Module[_0x4adf23(0x131)](_0xf95cbb);}export async function uploadCheats(_0x1cffc9){const _0x42747c=a0_0x53b4e2;Module[_0x42747c(0xd4)](async),Module[_0x42747c(0x10d)](_0x1cffc9,async()=>{await Module['FSSync']();});}export function setVolume(_0x2464bf){const _0x2049ba=a0_0x53b4e2;Module[_0x2049ba(0x12f)](_0x2464bf);}export async function setData(_0x20ea1d,_0x2ea650,_0xdd6cbc,_0x44b2dc,_0x416c22=''){const _0x31099c=a0_0x53b4e2,_0xcecd18=_0x20ea1d[_0x31099c(0xf5)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0xd89ed0='/data/screenshots/'+_0xcecd18+'_'+_0x2ea650+_0x31099c(0xe8);let _0x356e31;try{_0x356e31=await fileToBase64(Module[_0x31099c(0xc0)](_0xd89ed0));}catch(_0x2367a6){await Module['screenshot'](_0xcecd18+'_'+_0x2ea650+_0x31099c(0xe8)),await delay(0xc8),_0x356e31=await fileToBase64(Module[_0x31099c(0xc0)](_0xd89ed0));}let _0x34a5ba=atob(_0x356e31[_0x31099c(0xeb)](',')[0x1]),_0x5905ec=_0x31099c(0x116),_0x3d35a1=_0x34a5ba[_0x31099c(0xe0)](_0x5905ec),_0x2afb9e={};if(_0x3d35a1!==-0x1||_0x416c22[_0x31099c(0xe5)]()!==''){let _0x44e941=_0x3d35a1!==-0x1?_0x34a5ba[_0x31099c(0xda)](_0x3d35a1+_0x5905ec[_0x31099c(0x129)]):_0x416c22,_0x44c6cf=/(\w+)\s*:\s*([^|]*)/g,_0x40d88f;while((_0x40d88f=_0x44c6cf['exec'](_0x44e941))!==null){_0x2afb9e[_0x40d88f[0x1][_0x31099c(0xe5)]()]=_0x40d88f[0x2][_0x31099c(0xe5)]();}_0x3d35a1!==-0x1&&(_0x34a5ba=_0x34a5ba['substring'](0x0,_0x3d35a1));}_0x2afb9e[_0xdd6cbc]=_0x44b2dc;let _0xd2330d=Object['entries'](_0x2afb9e)[_0x31099c(0x104)](([_0x19c888,_0x129b2c])=>_0x19c888+_0x31099c(0x111)+_0x129b2c)['join']('\x20|\x20'),_0x5b72ea=new TextEncoder()['encode'](_0x5905ec+'\x20'+_0xd2330d),_0x3aa32c=new Uint8Array([..._0x34a5ba][_0x31099c(0x104)](_0x153b74=>_0x153b74[_0x31099c(0xcf)](0x0))['concat']([..._0x5b72ea])),_0x2d363c=new File([new Blob([_0x3aa32c],{'type':_0x31099c(0xc7)})],_0xcecd18+'_'+_0x2ea650+'.png',{'type':'image/png'});Module[_0x31099c(0x10d)](_0x2d363c,()=>{});}export async function getData(_0xe640fc,_0x119e69,_0x20c02d){const _0x347edb=a0_0x53b4e2;try{const _0x4bb6be=_0xe640fc[_0x347edb(0xf5)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x21eb4e=_0x347edb(0xe1)+_0x4bb6be+'_'+_0x119e69+_0x347edb(0xe8);let _0x4d2d01;try{_0x4d2d01=await fileToBase64(Module[_0x347edb(0xc0)](_0x21eb4e));}catch(_0x1dbd25){return null;}let _0x433541=atob(_0x4d2d01[_0x347edb(0xeb)](',')[0x1]),_0x1e4b65=_0x347edb(0x116),_0x211adb=_0x433541[_0x347edb(0xe0)](_0x1e4b65);if(_0x211adb!==-0x1){let _0x3c2f1e=_0x433541[_0x347edb(0xda)](_0x211adb+_0x1e4b65[_0x347edb(0x129)]);if(_0x20c02d==='All')return _0x3c2f1e[_0x347edb(0xe5)]();let _0xc30c45=new RegExp(_0x20c02d+'\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)'),_0x496783=_0x3c2f1e[_0x347edb(0x108)](_0xc30c45);if(_0x496783)return _0x496783[0x1][_0x347edb(0xe5)]();}}catch(_0x25d7db){return console[_0x347edb(0x133)]({'romName':_0xe640fc,'slot':_0x119e69,'type':_0x20c02d}),null;}}export async function ledSave(_0x330136){const _0x3c728f=a0_0x53b4e2,_0xc91728=parseInt(await getData(gameName,'0','slotStateSaved')),_0x2ce6f8=_0xc91728===0x1?_0x3c728f(0x10c):_0xc91728===0x2?_0x3c728f(0x10e):_0xc91728===0x3?'led03':_0xc91728===0x4?_0x3c728f(0xdc):_0xc91728===0x5?_0x3c728f(0xf2):_0xc91728===0x6?'led06':_0xc91728===0x7?_0x3c728f(0x123):_0x3c728f(0x115);try{for(let _0x53ac3a=0x0;_0x53ac3a<=0x7;_0x53ac3a++){document[_0x3c728f(0xd9)]('led0'+_0x53ac3a)[_0x3c728f(0x124)][_0x3c728f(0xc8)]=_0x3c728f(0xec);}await delay(0x3e8);for(let _0x30d667=0x0;_0x30d667<=0x7;_0x30d667++){document[_0x3c728f(0xd9)](_0x3c728f(0xf4)+_0x30d667)[_0x3c728f(0x124)][_0x3c728f(0xc8)]=_0x3c728f(0xec);}document[_0x3c728f(0xd9)](_0x2ce6f8)['style']['fill']=_0x330136;}catch(_0x1456ab){console[_0x3c728f(0x133)](_0x3c728f(0x11e),_0x1456ab);}};export async function notiMessage(_0x404d22,_0x5cd31f,_0x34529d=![]){const _0x250269=a0_0x53b4e2;var _0x26c41c=document[_0x250269(0xd9)](_0x250269(0xde));const _0x4f47d9=parseInt(await getData(gameName,'0',_0x250269(0x109)))||0x0;_0x26c41c[_0x250269(0x124)][_0x250269(0x10f)]===_0x250269(0xdf)&&(clearTimeout(messageTimeout),_0x26c41c[_0x250269(0x124)][_0x250269(0x10f)]='0'),_0x26c41c[_0x250269(0xcb)]=_0x404d22,_0x26c41c[_0x250269(0x124)][_0x250269(0x10f)]=_0x250269(0xdf),messageTimeout=setTimeout(()=>{const _0x4f1e60=_0x250269;_0x26c41c['textContent']='['+_0x4f47d9+']\x20'+gameName[_0x4f1e60(0xda)](0x0,gameName[_0x4f1e60(0x120)]('.')),_0x26c41c[_0x4f1e60(0x124)][_0x4f1e60(0x10f)]=_0x4f1e60(0xdf);},_0x5cd31f),_0x34529d&&(canvas[_0x250269(0xff)]['add'](_0x250269(0xfa)),setTimeout(()=>{const _0x414a4f=_0x250269;canvas['classList'][_0x414a4f(0x106)](_0x414a4f(0xfa));},0x258));}