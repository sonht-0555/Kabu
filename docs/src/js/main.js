const a0_0x12025d=a0_0x51dc;(function(_0x11e133,_0x5ed5f7){const _0x168767=a0_0x51dc,_0xc6e783=_0x11e133();while(!![]){try{const _0x2b7fac=-parseInt(_0x168767(0x109))/0x1+parseInt(_0x168767(0x145))/0x2*(-parseInt(_0x168767(0xf6))/0x3)+parseInt(_0x168767(0x13f))/0x4*(parseInt(_0x168767(0x140))/0x5)+-parseInt(_0x168767(0xeb))/0x6*(-parseInt(_0x168767(0x131))/0x7)+-parseInt(_0x168767(0x101))/0x8*(parseInt(_0x168767(0x132))/0x9)+-parseInt(_0x168767(0x13b))/0xa*(parseInt(_0x168767(0x118))/0xb)+-parseInt(_0x168767(0x10b))/0xc*(-parseInt(_0x168767(0x11c))/0xd);if(_0x2b7fac===_0x5ed5f7)break;else _0xc6e783['push'](_0xc6e783['shift']());}catch(_0x4024dc){_0xc6e783['push'](_0xc6e783['shift']());}}}(a0_0xbd9d,0x62dfe));import a0_0x4127f5 from'../core/mgba.js';import*as a0_0x1fc01d from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x12025d(0x117)](a0_0x12025d(0xe6))};function initializeCore(_0x50dcdd,_0x188fa1){const _0x1d335c=a0_0x12025d;_0x50dcdd(_0x188fa1)[_0x1d335c(0x104)](function(_0x4c3c20){const _0x57e1e6=_0x1d335c;_0x4c3c20[_0x57e1e6(0x100)]();});}initializeCore(a0_0x4127f5,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x12025d(0x117)](a0_0x12025d(0xe6)),savedTurboState=localStorage['getItem'](a0_0x12025d(0x123)),controlSetting=document[a0_0x12025d(0x117)](a0_0x12025d(0x138));function handleVisibilityChange(_0x2b5694){const _0x280c14=a0_0x12025d;document[_0x280c14(0x120)]==='hidden'||_0x2b5694?.[_0x280c14(0x121)]===_0x280c14(0x105)||_0x2b5694?.[_0x280c14(0x14a)]?(pauseGame(),canvas['classList']['add'](_0x280c14(0x113))):(setTimeout(()=>{const _0x1bb5a8=_0x280c14;canvas[_0x1bb5a8(0xf1)][_0x1bb5a8(0x14b)](_0x1bb5a8(0x113));},0x258),controlSetting[_0x280c14(0xf1)][_0x280c14(0x149)]('visible')&&resumeGame());}async function statusShow(){const _0x5dc788=a0_0x12025d;document['addEventListener']('pagehide',handleVisibilityChange),document['addEventListener']('visibilitychange',handleVisibilityChange),window[_0x5dc788(0x14d)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x1fc01d[_0x5dc788(0x10a)](turboState)),await delay(0xc8),await Module[_0x5dc788(0x12f)](),await delay(0x320),await led(parseInt(localStorage[_0x5dc788(0x148)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x51dc57=a0_0x12025d;await ledSave(_0x51dc57(0x142)),await Module[_0x51dc57(0x147)](0x0),await Module[_0x51dc57(0x124)](),await screenShot(0x0),console[_0x51dc57(0x13d)](_0x51dc57(0xe7)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x10a4fd=a0_0x12025d,_0x4a8f19=localStorage[_0x10a4fd(0x148)](_0x10a4fd(0x14e)),_0x4f4528=_0x4a8f19[_0x10a4fd(0x108)](/\.(zip|gb|gbc|gba)$/,_0x10a4fd(0x11f)),_0x2ddf6e=localStorage['getItem'](_0x10a4fd(0x112));navigator['onLine']&&(_0x2ddf6e&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x4f4528,Module[_0x10a4fd(0x107)](_0x10a4fd(0x11e)+_0x4f4528),_0x10a4fd(0xf3)),await lockNoti('',_0x10a4fd(0xed)+ ++countUpload+_0x10a4fd(0x125),0x7d0)));}function startTimer(){let [_0x2b195d,_0xa533b4,_0x2c0bc1,_0xfcea79,_0x1be50b]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x2286f6=a0_0x51dc;_0x2c0bc1++,_0xfcea79++,_0x1be50b++;if(_0x2c0bc1===0x3c)[_0x2c0bc1,_0xa533b4]=[0x0,_0xa533b4+0x1];if(_0xa533b4===0x3c)[_0xa533b4,_0x2b195d]=[0x0,_0x2b195d+0x1];document['getElementById'](_0x2286f6(0xfb))[_0x2286f6(0x10c)]=_0x2b195d+'h'+_0xa533b4[_0x2286f6(0xf5)]()[_0x2286f6(0x139)](0x2,'0')+'.'+_0x2c0bc1[_0x2286f6(0xf5)]()['padStart'](0x2,'0');_0xfcea79===0x3c&&(saveStatePeriodically(),_0xfcea79=0x0);;_0x1be50b===0x708&&(saveStateInCloud(),_0x1be50b=0x0);;},0x3e8);}export async function uploadGame(_0x46b38b){const _0x251332=a0_0x12025d,_0x478a75=_0x46b38b[_0x251332(0x13c)][0x0];Module[_0x251332(0x12c)](_0x478a75,()=>{const _0x38f2a4=_0x251332;Module[_0x38f2a4(0x124)]();});}export async function loadGame(_0x13c6d7){const _0x5463a2=a0_0x12025d,_0x123b04=_0x13c6d7[_0x5463a2(0x108)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x3a998f=Module['listStates']()[_0x5463a2(0x10e)](_0x5d0aed=>_0x5d0aed!=='.'&&_0x5d0aed!=='..');intro['classList'][_0x5463a2(0x135)](_0x5463a2(0xfd)),errorLogElements[0x0][_0x5463a2(0x144)][_0x5463a2(0x137)]='0',ingame['classList']['remove'](_0x5463a2(0xfd)),_0x13c6d7[_0x5463a2(0xee)]('.gbc')||_0x13c6d7[_0x5463a2(0xee)](_0x5463a2(0x10d))?(canvas[_0x5463a2(0xf1)]['add'](_0x5463a2(0xfe)),areaTrans[_0x5463a2(0xf1)][_0x5463a2(0x135)](_0x5463a2(0x11a)),localStorage[_0x5463a2(0x116)](_0x5463a2(0xef),_0x5463a2(0x134)+(window['innerWidth']-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x5463a2(0x116)]('screenSize',_0x5463a2(0x134)+(window['innerWidth']-0x96)+','+(window[_0x5463a2(0x11d)]-0x96)*0x2/0x3),_0x3a998f['includes'](_0x123b04)?(await Module[_0x5463a2(0xf9)]('/data/games/'+_0x13c6d7),confirm(_0x5463a2(0x12a))&&(await Module[_0x5463a2(0x106)](0x0),localStorage[_0x5463a2(0x116)](_0x5463a2(0x14e),_0x13c6d7),console[_0x5463a2(0x13d)](_0x13c6d7))):(await Module['loadGame'](_0x5463a2(0x129)+_0x13c6d7),localStorage[_0x5463a2(0x116)]('gameName',_0x13c6d7),console[_0x5463a2(0x13d)](_0x13c6d7)),await statusShow();}export async function saveState(_0x46c563){const _0x5b5505=a0_0x12025d;await Module[_0x5b5505(0x147)](_0x46c563),await Module['FSSync']();}export async function loadState(_0x7d7389){const _0x325c39=a0_0x12025d;await Module[_0x325c39(0x106)](_0x7d7389);}export async function downloadFile(_0xf446d8,_0x11152e){const _0x4bdd19=a0_0x12025d,_0x56d43d=Module[_0x4bdd19(0x107)](_0xf446d8),_0x4b14e5=document[_0x4bdd19(0xf4)]('a');document[_0x4bdd19(0x12e)][_0x4bdd19(0x14c)](_0x4b14e5),_0x4b14e5[_0x4bdd19(0x10f)]=_0x11152e;const _0x441c78=new Blob([_0x56d43d],{'type':_0x4bdd19(0x119)});_0x4b14e5['href']=URL[_0x4bdd19(0x111)](_0x441c78),_0x4b14e5[_0x4bdd19(0xf0)](),URL[_0x4bdd19(0x130)](_0x441c78),_0x4b14e5[_0x4bdd19(0x14b)]();}export function downloadFileInCloud(_0x56adb7){const _0x2ddcde=a0_0x12025d,_0x1fbd8e=Module[_0x2ddcde(0x107)](_0x56adb7);return _0x1fbd8e;}export async function uploadFileInCloud(_0x2cee4b){const _0x552d94=a0_0x12025d;Module[_0x552d94(0x127)](_0x2cee4b,()=>{const _0x1905ef=_0x552d94;localStorageFile(),Module[_0x1905ef(0x124)]();});}function a0_0xbd9d(){const _0x1392de=['filter','download','buttonPress','createObjectURL','uId','visible','autoLoadCheats','listCheats','setItem','getElementById','253aVErWG','application/octet-stream','gbc1','/data/screenshots/','297167ZKOWox','innerWidth','/data/states/','.ss0','visibilityState','type','Cheat\x20Enabled!','turboState','FSSync','\x20time(s)','Off','uploadAll','Resumed!','/data/games/','Do\x20you\x20want\x20to\x20load\x20save\x20state?','tEXtComment\x00','uploadRom','_savedCheats','body','SDL2','revokeObjectURL','1365bGaTqo','45KDkhpG','setFastForwardMultiplier','0,0,','add','fileSize','bottom','control-setting','padStart','listStates','85240YiLnFU','files','log','.png','4OxaoMk','1836310jNtCLX','listScreenshots','#20A5A6','image/png','style','4DlzaXJ','length','saveState','getItem','contains','persisted','remove','appendChild','addEventListener','gameName','encode','canvas','Auto\x20save\x20','set','charCodeAt','screenshot','18978IyyqNY','editFileName','Cloud\x20upload\x20','endsWith','screenSize','click','classList','now','state','createElement','toString','439800qGQGBb','listSaves','indexOf','loadGame','Paused!','timer','deleteFile','disable','gbc','split','FSInit','1146456doDOEe','resumeGame','pauseGame','then','beforeunload','loadState','downloadFile','replace','81899TaDHVj','turboF','372vFAmjO','textContent','.gb'];a0_0xbd9d=function(){return _0x1392de;};return a0_0xbd9d();}export async function uploadFile(_0xd864cb){const _0x3fd12f=a0_0x12025d,_0x529e47=_0xd864cb[_0x3fd12f(0x13c)][0x0];Module[_0x3fd12f(0x127)](_0x529e47,()=>{const _0x3834d8=_0x3fd12f;localStorageFile(),Module[_0x3834d8(0x124)]();});}export async function editFile(_0x41a1b6,_0x238841,_0x2b0274){const _0x48fec1=a0_0x12025d;await Module[_0x48fec1(0xec)](_0x41a1b6,_0x238841,_0x2b0274),await Module['FSSync']();}export async function deleteFile(_0x21dcb3){const _0x54bcdc=a0_0x12025d;await Module[_0x54bcdc(0xfc)](_0x21dcb3),await Module[_0x54bcdc(0x124)]();}export function listGame(){const _0x22292f=a0_0x12025d,_0x290f22=Module['listRoms']()[_0x22292f(0x10e)](_0x4d0129=>_0x4d0129!=='.'&&_0x4d0129!=='..');return _0x290f22;}export function listSave(){const _0xa72a1a=a0_0x12025d,_0x52d2ef=Module[_0xa72a1a(0xf7)]()['filter'](_0x417048=>_0x417048!=='.'&&_0x417048!=='..');return _0x52d2ef;}export function listState(){const _0x1f5d53=a0_0x12025d,_0xcb4ec1=Module[_0x1f5d53(0x13a)]()[_0x1f5d53(0x10e)](_0x203229=>_0x203229!=='.'&&_0x203229!=='..');return _0xcb4ec1;}export function listCheat(){const _0x14e2fe=a0_0x12025d,_0x86ec2f=Module[_0x14e2fe(0x115)]()[_0x14e2fe(0x10e)](_0x52cd76=>_0x52cd76!=='.'&&_0x52cd76!=='..');return _0x86ec2f;}export function listScreenshot(){const _0x2888d3=a0_0x12025d,_0x4521a4=Module[_0x2888d3(0x141)]()[_0x2888d3(0x10e)](_0x231ca7=>_0x231ca7!=='.'&&_0x231ca7!=='..');return _0x4521a4;}export function embedTextInPngFile(_0x59bfcc,_0x3d7df2,_0x1cc1ff){const _0x162f50=a0_0x12025d;let _0xfab70=atob(_0x59bfcc[_0x162f50(0xff)](',')[0x1]),_0x3ba0cf=new Uint8Array(_0xfab70[_0x162f50(0x146)]);for(let _0x4f5232=0x0;_0x4f5232<_0xfab70[_0x162f50(0x146)];_0x4f5232++){_0x3ba0cf[_0x4f5232]=_0xfab70[_0x162f50(0xe9)](_0x4f5232);}let _0x3f44c5=new TextEncoder()[_0x162f50(0xe5)](_0x162f50(0x12b)+_0x3d7df2),_0x25a05a=new Uint8Array(_0x3ba0cf['length']+_0x3f44c5['length']);_0x25a05a[_0x162f50(0xe8)](_0x3ba0cf,0x0),_0x25a05a['set'](_0x3f44c5,_0x3ba0cf['length']);let _0x181922=new Blob([_0x25a05a],{'type':_0x162f50(0x143)}),_0x375d86=new File([_0x181922],_0x1cc1ff,{'type':_0x162f50(0x143)});return _0x375d86;}export function extractTextFromPngBase64(_0x1a1c3f){const _0x22b392=a0_0x12025d;let _0x130f0c=atob(_0x1a1c3f[_0x22b392(0xff)](',')[0x1]),_0x17be9a='tEXtComment\x00',_0x38e068=_0x130f0c[_0x22b392(0xf8)](_0x17be9a);if(_0x38e068!==-0x1)return _0x130f0c['substring'](_0x38e068+_0x17be9a[_0x22b392(0x146)]);return null;}function a0_0x51dc(_0x237336,_0x5ad4d4){const _0xbd9db6=a0_0xbd9d();return a0_0x51dc=function(_0x51dc62,_0x2523ec){_0x51dc62=_0x51dc62-0xe5;let _0x40b6=_0xbd9db6[_0x51dc62];return _0x40b6;},a0_0x51dc(_0x237336,_0x5ad4d4);}export function fileSize(_0x313b2f){const _0x18270e=a0_0x12025d,_0xf82a65=Module[_0x18270e(0x136)](_0x313b2f);return _0xf82a65;}export async function resumeGame(){const _0x55d559=a0_0x12025d;Module[_0x55d559(0x102)](),Module['SDL2'](),notiMessage(_0x55d559(0x128),0x7d0);}export async function pauseGame(){const _0xd26482=a0_0x12025d;Module[_0xd26482(0x103)](),Module[_0xd26482(0x12f)](),notiMessage(_0xd26482(0xfa),0x7d0);}export async function buttonPress(_0x4721ef){const _0x5d632b=a0_0x12025d;Module[_0x5d632b(0x110)](_0x4721ef);}export async function buttonUnpress(_0x2bf56a){Module['buttonUnpress'](_0x2bf56a);}export async function screenShot(_0x3cb0e6){const _0x551abd=a0_0x12025d,_0x420484=localStorage[_0x551abd(0x148)]('gameName')[_0x551abd(0x108)](/\.(gba|gbc|gb|zip)$/,''),_0xa3f463=_0x420484+'_'+_0x3cb0e6+_0x551abd(0x13e);await Module[_0x551abd(0xea)](_0xa3f463),await Module[_0x551abd(0x124)]();const _0x51e650=await fileToBase64(Module['downloadFile'](_0x551abd(0x11b)+_0xa3f463)),_0x58ad8a=embedTextInPngFile(_0x51e650,formatDateTime(Date[_0x551abd(0xf2)]()),_0xa3f463);Module[_0x551abd(0x127)](_0x58ad8a,()=>{const _0x4c6b1f=_0x551abd;localStorageFile(),Module[_0x4c6b1f(0x124)]();});}export async function dowloadScreenShot(_0x40b312){try{const _0x76adbb=await fileToBase64(Module['downloadFile'](_0x40b312));return _0x76adbb;}catch{}}export async function captureOCR(_0x28782b){const _0x598b80=a0_0x12025d;Module[_0x598b80(0xea)](_0x28782b);const _0x48eca9=Module[_0x598b80(0x107)](_0x598b80(0x11b)+_0x28782b);return _0x48eca9;}export async function setFastForwardMultiplier(_0x18a864){const _0x133a10=a0_0x12025d;Module[_0x133a10(0x133)](_0x18a864);}export function uploadCheats(_0x37e805,_0x58f5bb,_0x542b07,_0x15462f,_0x31a2c4){const _0x3e13d2=a0_0x12025d;Module[_0x3e13d2(0x127)](_0x37e805,()=>{const _0x5e2979=_0x3e13d2;Module[_0x5e2979(0x114)](),setTimeout(()=>{const _0x45cea6=_0x5e2979;Module[_0x45cea6(0x124)]();},0x1f4),_0x15462f&&(localStorage[_0x5e2979(0x116)](_0x58f5bb+'_savedCheats',_0x542b07),notiMessage(_0x5e2979(0x122),0x5dc)),_0x31a2c4['textContent']=localStorage['getItem'](_0x58f5bb+_0x5e2979(0x12d)||_0x5e2979(0x126));});}export function setVolume(_0x254104){Module['setVolume'](_0x254104);}