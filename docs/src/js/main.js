const a0_0x337e4d=a0_0x5071;(function(_0x5a5375,_0x38ac16){const _0xfde95f=a0_0x5071,_0x3a5cfe=_0x5a5375();while(!![]){try{const _0x428c10=parseInt(_0xfde95f(0x210))/0x1+parseInt(_0xfde95f(0x1fa))/0x2+-parseInt(_0xfde95f(0x1e3))/0x3+parseInt(_0xfde95f(0x228))/0x4*(parseInt(_0xfde95f(0x1dd))/0x5)+-parseInt(_0xfde95f(0x1ea))/0x6*(parseInt(_0xfde95f(0x216))/0x7)+-parseInt(_0xfde95f(0x22d))/0x8*(-parseInt(_0xfde95f(0x1f7))/0x9)+-parseInt(_0xfde95f(0x214))/0xa*(parseInt(_0xfde95f(0x217))/0xb);if(_0x428c10===_0x38ac16)break;else _0x3a5cfe['push'](_0x3a5cfe['shift']());}catch(_0x30675f){_0x3a5cfe['push'](_0x3a5cfe['shift']());}}}(a0_0x4bea,0xbdeba));import a0_0x229f2a from'../core/mgba.js';import*as a0_0x3448b3 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';const Module={'canvas':document[a0_0x337e4d(0x1cf)](a0_0x337e4d(0x230))};function initializeCore(_0x514b11,_0x7840f0){_0x514b11(_0x7840f0)['then'](function(_0x3b8e55){_0x3b8e55['FSInit']();});}initializeCore(a0_0x229f2a,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x337e4d(0x1cf)](a0_0x337e4d(0x230)),controlSetting=document[a0_0x337e4d(0x1cf)]('control-setting');function handleVisibilityChange(_0x3fbc2a){const _0x4667a0=a0_0x337e4d;document[_0x4667a0(0x1ee)]===_0x4667a0(0x207)||_0x3fbc2a?.['type']===_0x4667a0(0x20c)||_0x3fbc2a?.['persisted']?(pauseGame(),canvas[_0x4667a0(0x205)][_0x4667a0(0x22c)]('visible')):(setTimeout(()=>{const _0x29c0a1=_0x4667a0;canvas[_0x29c0a1(0x205)][_0x29c0a1(0x20d)](_0x29c0a1(0x1ff));},0x258),controlSetting['classList'][_0x4667a0(0x22e)](_0x4667a0(0x1ff))&&resumeGame());}async function statusShow(){const _0x2ef81e=a0_0x337e4d;document[_0x2ef81e(0x237)](_0x2ef81e(0x235),handleVisibilityChange),document[_0x2ef81e(0x237)]('visibilitychange',handleVisibilityChange),window[_0x2ef81e(0x237)](_0x2ef81e(0x20c),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x3448b3[_0x2ef81e(0x1e6)](parseInt(await getData(gameName,'0','turboState'))),await delay(0xc8),await Module['SDL2'](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x2ef81e(0x1f0)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0xda5d06=a0_0x337e4d;await ledSave(_0xda5d06(0x1ce)),await Module[_0xda5d06(0x223)](0x0),await Module[_0xda5d06(0x1ec)](),await screenShot(0x0),console[_0xda5d06(0x1de)](_0xda5d06(0x1eb)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x604ce2=a0_0x337e4d,_0x5614f7=gameName[_0x604ce2(0x239)](/\.(zip|gb|gbc|gba)$/,_0x604ce2(0x1ef)),_0x51a100=localStorage[_0x604ce2(0x1e2)](_0x604ce2(0x233));navigator[_0x604ce2(0x209)]&&(_0x51a100&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x5614f7,Module[_0x604ce2(0x1d2)](_0x604ce2(0x1fd)+_0x5614f7),'state'),await lockNoti('',_0x604ce2(0x232)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0xc0c2c3,_0x542ef5,_0x162dc8,_0x44314c,_0x542af3]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x556252=a0_0x5071;_0x162dc8++,_0x44314c++,_0x542af3++;if(_0x162dc8===0x3c)[_0x162dc8,_0x542ef5]=[0x0,_0x542ef5+0x1];if(_0x542ef5===0x3c)[_0x542ef5,_0xc0c2c3]=[0x0,_0xc0c2c3+0x1];document[_0x556252(0x1cf)](_0x556252(0x221))[_0x556252(0x1d0)]=_0xc0c2c3+'h'+_0x542ef5[_0x556252(0x204)]()['padStart'](0x2,'0')+'.'+_0x162dc8[_0x556252(0x204)]()[_0x556252(0x21e)](0x2,'0');_0x44314c===0x3c&&(saveStatePeriodically(),_0x44314c=0x0);;_0x542af3===0x708&&(saveStateInCloud(),_0x542af3=0x0);;},0x3e8);}export async function uploadGame(_0x225515){const _0x1c880b=a0_0x337e4d,_0x57c84b=_0x225515[_0x1c880b(0x229)][0x0];Module[_0x1c880b(0x1f6)](_0x57c84b,()=>{Module['FSSync']();});}export async function loadGame(_0xd89f21){const _0x24edf5=a0_0x337e4d,_0x199672=_0xd89f21[_0x24edf5(0x239)](/\.(gba|gbc|gb|zip)$/,_0x24edf5(0x1ef)),_0x5c2e71=Module[_0x24edf5(0x1e0)]()[_0x24edf5(0x236)](_0x3c0efd=>_0x3c0efd!=='.'&&_0x3c0efd!=='..');intro[_0x24edf5(0x205)][_0x24edf5(0x22c)]('disable'),errorLogElements[0x0][_0x24edf5(0x1e4)][_0x24edf5(0x1fc)]='0',ingame[_0x24edf5(0x205)][_0x24edf5(0x20d)](_0x24edf5(0x1d1)),_0xd89f21['endsWith'](_0x24edf5(0x1f8))||_0xd89f21[_0x24edf5(0x23d)]('.gb')?(canvas[_0x24edf5(0x205)][_0x24edf5(0x22c)](_0x24edf5(0x203)),areaTrans[_0x24edf5(0x205)][_0x24edf5(0x22c)](_0x24edf5(0x202)),localStorage[_0x24edf5(0x219)](_0x24edf5(0x21a),'0,0,'+(window['innerWidth']-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x24edf5(0x219)]('screenSize',_0x24edf5(0x1d9)+(window[_0x24edf5(0x213)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x5c2e71['includes'](_0x199672)?(await Module[_0x24edf5(0x215)](_0x24edf5(0x206)+_0xd89f21),confirm(_0x24edf5(0x1e9))&&(await Module['loadState'](0x0),await shaderData())):(await Module['loadGame']('/data/games/'+gameName),await shaderData()),await statusShow();}export async function saveState(_0x298bde){const _0x2e8e8f=a0_0x337e4d;await Module[_0x2e8e8f(0x223)](_0x298bde),await Module[_0x2e8e8f(0x1ec)]();}export async function loadState(_0x108405){const _0x52de74=a0_0x337e4d;await Module[_0x52de74(0x224)](_0x108405);}export async function downloadFile(_0xd95f74,_0x57dfbe){const _0x490a86=a0_0x337e4d,_0x4f361c=Module[_0x490a86(0x1d2)](_0xd95f74),_0x1d0133=document['createElement']('a');document[_0x490a86(0x22f)][_0x490a86(0x22a)](_0x1d0133),_0x1d0133[_0x490a86(0x234)]=_0x57dfbe;const _0x8c3fe8=new Blob([_0x4f361c],{'type':_0x490a86(0x1d4)});_0x1d0133['href']=URL[_0x490a86(0x21d)](_0x8c3fe8),_0x1d0133[_0x490a86(0x23b)](),URL['revokeObjectURL'](_0x8c3fe8),_0x1d0133['remove']();}function a0_0x4bea(){const _0x57a335=['listStates','editFileName','getItem','1988463LTGjUN','style','led04','turboF','led00','led05','Do\x20you\x20want\x20to\x20load\x20save\x20state?','28734VZjLBe','Auto\x20save\x20','FSSync','split','visibilityState','.ss0','slotStateSaved','trim','led07','noti-mess','listSaves','buttonPress','uploadRom','41796cqCgPP','.gbc','charCodeAt','2329618NhYdHD','setFastForwardMultiplier','bottom','/data/states/','\x20:\x20','visible','exec','deleteFile','gbc1','gbc','toString','classList','/data/games/','hidden','.png','onLine','screenshot','All','beforeunload','remove','fileSize','autoLoadCheats','297136ebbykK','listCheats','\x20|\x20','innerWidth','140fCUlmu','loadGame','105LgNgQq','1557974BLFXoG','uploadAll','setItem','screenSize','length','Error\x20ledSave:','createObjectURL','padStart','led0','setVolume','timer','error','saveState','loadState','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','0.4','SDL2','1017508yciKLN','files','appendChild','map','add','1312NAiEce','contains','body','canvas','/data/screenshots/','Cloud\x20upload\x20','uId','download','pagehide','filter','addEventListener','led06','replace','fill','click','tEXtComment\x00','endsWith','opacity','saveTime','#20A5A6','getElementById','textContent','disable','downloadFile','image/png','application/octet-stream','listScreenshots','substring','led02','led01','0,0,','entries','encode','set','25vCRuvL','log','indexOf'];a0_0x4bea=function(){return _0x57a335;};return a0_0x4bea();}export function downloadFileInCloud(_0x108ddf){try{const _0x30e1e3=Module['downloadFile'](_0x108ddf);return _0x30e1e3;}catch(_0x350377){return null;}}export async function uploadFileInCloud(_0x4f0980){const _0x3cdafe=a0_0x337e4d;Module[_0x3cdafe(0x218)](_0x4f0980,async()=>{const _0x392b1c=_0x3cdafe;localStorageFile(),await Module[_0x392b1c(0x1ec)]();});}export async function uploadFile(_0x133a4d){const _0x7d7fad=a0_0x337e4d,_0x13768e=_0x133a4d[_0x7d7fad(0x229)][0x0];Module[_0x7d7fad(0x218)](_0x13768e,async()=>{const _0x2042f9=_0x7d7fad;localStorageFile(),await Module[_0x2042f9(0x1ec)]();});}export async function editFile(_0x173c30,_0xa318de,_0x20f7f1){const _0x25345e=a0_0x337e4d;await Module[_0x25345e(0x1e1)](_0x173c30,_0xa318de,_0x20f7f1),await Module[_0x25345e(0x1ec)]();}function a0_0x5071(_0x31bb95,_0x1b5b7e){const _0x4beacc=a0_0x4bea();return a0_0x5071=function(_0x5071c4,_0x4b038a){_0x5071c4=_0x5071c4-0x1cc;let _0x598ffe=_0x4beacc[_0x5071c4];return _0x598ffe;},a0_0x5071(_0x31bb95,_0x1b5b7e);}export async function deleteFile(_0x27721c){const _0x3f0ec2=a0_0x337e4d;await Module[_0x3f0ec2(0x201)](_0x27721c),await Module[_0x3f0ec2(0x1ec)]();}export function listGame(){const _0x4cf8eb=a0_0x337e4d,_0x25425a=Module['listRoms']()[_0x4cf8eb(0x236)](_0x431a91=>_0x431a91!=='.'&&_0x431a91!=='..');return _0x25425a;}export function listSave(){const _0x816d69=a0_0x337e4d,_0x3d55b8=Module[_0x816d69(0x1f4)]()[_0x816d69(0x236)](_0x516c50=>_0x516c50!=='.'&&_0x516c50!=='..');return _0x3d55b8;}export function listState(){const _0x27866a=a0_0x337e4d,_0x58b30a=Module['listStates']()[_0x27866a(0x236)](_0xd7034f=>_0xd7034f!=='.'&&_0xd7034f!=='..');return _0x58b30a;}export function listCheat(){const _0x66befa=a0_0x337e4d,_0x307f45=Module[_0x66befa(0x211)]()[_0x66befa(0x236)](_0x452d94=>_0x452d94!=='.'&&_0x452d94!=='..');return _0x307f45;}export function listScreenshot(){const _0x1a7a8a=a0_0x337e4d,_0x80deb2=Module[_0x1a7a8a(0x1d5)]()[_0x1a7a8a(0x236)](_0x11bb36=>_0x11bb36!=='.'&&_0x11bb36!=='..');return _0x80deb2;}export function embedTextInPngFile(_0x4d5130,_0x511a14,_0x4d859c){const _0x59d623=a0_0x337e4d;let _0x5e0c32=atob(_0x4d5130['split'](',')[0x1]),_0x53b830=new Uint8Array(_0x5e0c32[_0x59d623(0x21b)]);for(let _0x2a6ba1=0x0;_0x2a6ba1<_0x5e0c32[_0x59d623(0x21b)];_0x2a6ba1++){_0x53b830[_0x2a6ba1]=_0x5e0c32[_0x59d623(0x1f9)](_0x2a6ba1);}let _0x2d2a06=new TextEncoder()[_0x59d623(0x1db)](_0x59d623(0x23c)+_0x511a14),_0x127e80=new Uint8Array(_0x53b830[_0x59d623(0x21b)]+_0x2d2a06['length']);_0x127e80[_0x59d623(0x1dc)](_0x53b830,0x0),_0x127e80['set'](_0x2d2a06,_0x53b830[_0x59d623(0x21b)]);let _0x3c8a54=new Blob([_0x127e80],{'type':_0x59d623(0x1d3)}),_0x56c907=new File([_0x3c8a54],_0x4d859c,{'type':_0x59d623(0x1d3)});return _0x56c907;}export function extractTextFromPngBase64(_0x4ac7e9){const _0x5e2737=a0_0x337e4d;let _0x4b0f4d=atob(_0x4ac7e9[_0x5e2737(0x1ed)](',')[0x1]),_0x421a5b=_0x5e2737(0x23c),_0x3e4594=_0x4b0f4d['indexOf'](_0x421a5b);if(_0x3e4594!==-0x1)return _0x4b0f4d[_0x5e2737(0x1d6)](_0x3e4594+_0x421a5b[_0x5e2737(0x21b)]);return null;}export function fileSize(_0x1dd4b4){const _0x4b5d6c=a0_0x337e4d,_0x588ea3=Module[_0x4b5d6c(0x20e)](_0x1dd4b4);return _0x588ea3;}export async function resumeGame(){const _0x5bff79=a0_0x337e4d;Module['resumeGame'](),Module[_0x5bff79(0x227)](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x3c5002=a0_0x337e4d;Module['pauseGame'](),Module[_0x3c5002(0x227)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x14f6e1){const _0x23709a=a0_0x337e4d;Module[_0x23709a(0x1f5)](_0x14f6e1);}export async function buttonUnpress(_0x3af7b0){Module['buttonUnpress'](_0x3af7b0);}export async function screenShot(_0x47121c){const _0x31af5d=a0_0x337e4d,_0x336a23=gameName[_0x31af5d(0x239)](/\.(gba|gbc|gb|zip)$/,'_'+_0x47121c+_0x31af5d(0x208)),_0x4ae259=await getData(gameName,_0x47121c,_0x31af5d(0x20b))||'';console[_0x31af5d(0x1de)](_0x4ae259),await Module[_0x31af5d(0x20a)](_0x336a23),await setData(gameName,_0x47121c,_0x31af5d(0x1cd),formatDateTime(Date['now']()),_0x4ae259);}export async function dowloadScreenShot(_0x42d464){const _0x54abde=a0_0x337e4d;try{const _0x507b94=await fileToBase64(Module[_0x54abde(0x1d2)](_0x42d464));return _0x507b94;}catch{}}export async function captureOCR(_0x23e42f){const _0x248f85=a0_0x337e4d;Module[_0x248f85(0x20a)](_0x23e42f);const _0x3eb214=Module[_0x248f85(0x1d2)](_0x248f85(0x231)+_0x23e42f);return _0x3eb214;}export async function setFastForwardMultiplier(_0x497661){const _0x494662=a0_0x337e4d;Module[_0x494662(0x1fb)](_0x497661);}export async function uploadCheats(_0x196f7a){const _0x586869=a0_0x337e4d;Module[_0x586869(0x20f)](async),Module[_0x586869(0x218)](_0x196f7a,async()=>{const _0x111c5e=_0x586869;await Module[_0x111c5e(0x1ec)]();});}export function setVolume(_0x3f65ab){const _0x2f824d=a0_0x337e4d;Module[_0x2f824d(0x220)](_0x3f65ab);}export async function setData(_0x1e12cc,_0x18cfbf,_0x194881,_0x4a36b6,_0x45c641=''){const _0x4b61f0=a0_0x337e4d,_0x29e83b=_0x1e12cc['replace'](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x5ba488='/data/screenshots/'+_0x29e83b+'_'+_0x18cfbf+_0x4b61f0(0x208);let _0x48bdf2;try{_0x48bdf2=await fileToBase64(Module[_0x4b61f0(0x1d2)](_0x5ba488));}catch(_0x4bc3e7){await Module['screenshot'](_0x29e83b+'_'+_0x18cfbf+_0x4b61f0(0x208)),await delay(0xc8),_0x48bdf2=await fileToBase64(Module[_0x4b61f0(0x1d2)](_0x5ba488));}let _0x377d17=atob(_0x48bdf2[_0x4b61f0(0x1ed)](',')[0x1]),_0x14f310=_0x4b61f0(0x23c),_0xe534c9=_0x377d17[_0x4b61f0(0x1df)](_0x14f310),_0x257072={};if(_0xe534c9!==-0x1||_0x45c641[_0x4b61f0(0x1f1)]()!==''){let _0x5908f4=_0xe534c9!==-0x1?_0x377d17[_0x4b61f0(0x1d6)](_0xe534c9+_0x14f310['length']):_0x45c641,_0xe73894=/(\w+)\s*:\s*([^|]*)/g,_0x4c8f77;while((_0x4c8f77=_0xe73894[_0x4b61f0(0x200)](_0x5908f4))!==null){_0x257072[_0x4c8f77[0x1][_0x4b61f0(0x1f1)]()]=_0x4c8f77[0x2]['trim']();}_0xe534c9!==-0x1&&(_0x377d17=_0x377d17[_0x4b61f0(0x1d6)](0x0,_0xe534c9));}_0x257072[_0x194881]=_0x4a36b6;let _0x2ab231=Object[_0x4b61f0(0x1da)](_0x257072)[_0x4b61f0(0x22b)](([_0x48af84,_0x485a19])=>_0x48af84+_0x4b61f0(0x1fe)+_0x485a19)['join'](_0x4b61f0(0x212)),_0x3d05ac=new TextEncoder()['encode'](_0x14f310+'\x20'+_0x2ab231),_0x4484f1=new Uint8Array([..._0x377d17]['map'](_0xc5bffb=>_0xc5bffb['charCodeAt'](0x0))['concat']([..._0x3d05ac])),_0xe38a3a=new File([new Blob([_0x4484f1],{'type':'image/png'})],_0x29e83b+'_'+_0x18cfbf+_0x4b61f0(0x208),{'type':_0x4b61f0(0x1d3)});Module[_0x4b61f0(0x218)](_0xe38a3a,()=>{});}export async function getData(_0x73a15b,_0x4d92dc,_0x86f4c5){const _0x3373ac=a0_0x337e4d;try{const _0x4d5015=_0x73a15b[_0x3373ac(0x239)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x33cf47=_0x3373ac(0x231)+_0x4d5015+'_'+_0x4d92dc+_0x3373ac(0x208);let _0x1bcd3e;try{_0x1bcd3e=await fileToBase64(Module[_0x3373ac(0x1d2)](_0x33cf47));}catch(_0x515364){return null;}let _0x390928=atob(_0x1bcd3e[_0x3373ac(0x1ed)](',')[0x1]),_0x5909cc=_0x3373ac(0x23c),_0x105bb0=_0x390928[_0x3373ac(0x1df)](_0x5909cc);if(_0x105bb0!==-0x1){let _0x10660b=_0x390928[_0x3373ac(0x1d6)](_0x105bb0+_0x5909cc[_0x3373ac(0x21b)]);if(_0x86f4c5===_0x3373ac(0x20b))return _0x10660b[_0x3373ac(0x1f1)]();let _0x44df80=new RegExp(_0x86f4c5+_0x3373ac(0x225)),_0x1511bc=_0x10660b['match'](_0x44df80);if(_0x1511bc)return _0x1511bc[0x1]['trim']();}}catch(_0x240d80){return console[_0x3373ac(0x222)]({'romName':_0x73a15b,'slot':_0x4d92dc,'type':_0x86f4c5}),null;}}export async function ledSave(_0x1cf15f){const _0x48dac2=a0_0x337e4d,_0xdbcac0=parseInt(await getData(gameName,'0','slotStateSaved')),_0x4469b8=_0xdbcac0===0x1?_0x48dac2(0x1d8):_0xdbcac0===0x2?_0x48dac2(0x1d7):_0xdbcac0===0x3?'led03':_0xdbcac0===0x4?_0x48dac2(0x1e5):_0xdbcac0===0x5?_0x48dac2(0x1e8):_0xdbcac0===0x6?_0x48dac2(0x238):_0xdbcac0===0x7?_0x48dac2(0x1f2):_0x48dac2(0x1e7);try{for(let _0x682c81=0x0;_0x682c81<=0x7;_0x682c81++){document[_0x48dac2(0x1cf)](_0x48dac2(0x21f)+_0x682c81)[_0x48dac2(0x1e4)][_0x48dac2(0x23a)]='rgba(245,\x20232,\x20209,\x200.4)';}await delay(0x3e8);for(let _0x36750b=0x0;_0x36750b<=0x7;_0x36750b++){document[_0x48dac2(0x1cf)](_0x48dac2(0x21f)+_0x36750b)[_0x48dac2(0x1e4)][_0x48dac2(0x23a)]='rgba(245,\x20232,\x20209,\x200.4)';}document['getElementById'](_0x4469b8)[_0x48dac2(0x1e4)][_0x48dac2(0x23a)]=_0x1cf15f;}catch(_0x11da32){console[_0x48dac2(0x222)](_0x48dac2(0x21c),_0x11da32);}};export async function notiMessage(_0xe8fdb5,_0x14cff4,_0xb0c00f=![]){const _0xb5dec0=a0_0x337e4d;var _0x42a640=document[_0xb5dec0(0x1cf)](_0xb5dec0(0x1f3));const _0xb15a48=parseInt(await getData(gameName,'0',_0xb5dec0(0x1f0)))||0x0;_0x42a640[_0xb5dec0(0x1e4)][_0xb5dec0(0x1cc)]===_0xb5dec0(0x226)&&(clearTimeout(messageTimeout),_0x42a640[_0xb5dec0(0x1e4)]['opacity']='0'),_0x42a640[_0xb5dec0(0x1d0)]=_0xe8fdb5,_0x42a640[_0xb5dec0(0x1e4)][_0xb5dec0(0x1cc)]=_0xb5dec0(0x226),messageTimeout=setTimeout(()=>{const _0x1608b7=_0xb5dec0;_0x42a640[_0x1608b7(0x1d0)]='['+_0xb15a48+']\x20'+gameName[_0x1608b7(0x1d6)](0x0,gameName['lastIndexOf']('.')),_0x42a640[_0x1608b7(0x1e4)]['opacity']=_0x1608b7(0x226);},_0x14cff4),_0xb0c00f&&(canvas[_0xb5dec0(0x205)]['add'](_0xb5dec0(0x1ff)),setTimeout(()=>{const _0x21d6ee=_0xb5dec0;canvas['classList'][_0x21d6ee(0x20d)](_0x21d6ee(0x1ff));},0x258));}