const a0_0x5bcd0f=a0_0x40ba;(function(_0x3f56f6,_0x5e5fe7){const _0x1c189a=a0_0x40ba,_0x15e4f2=_0x3f56f6();while(!![]){try{const _0x1aa508=parseInt(_0x1c189a(0x196))/0x1*(-parseInt(_0x1c189a(0x171))/0x2)+-parseInt(_0x1c189a(0x1a8))/0x3*(parseInt(_0x1c189a(0x166))/0x4)+-parseInt(_0x1c189a(0x1ad))/0x5*(-parseInt(_0x1c189a(0x191))/0x6)+parseInt(_0x1c189a(0x199))/0x7+parseInt(_0x1c189a(0x1a3))/0x8*(-parseInt(_0x1c189a(0x1ac))/0x9)+parseInt(_0x1c189a(0x177))/0xa*(parseInt(_0x1c189a(0x1aa))/0xb)+parseInt(_0x1c189a(0x180))/0xc;if(_0x1aa508===_0x5e5fe7)break;else _0x15e4f2['push'](_0x15e4f2['shift']());}catch(_0x4de1ed){_0x15e4f2['push'](_0x15e4f2['shift']());}}}(a0_0x4184,0xa6abd));import a0_0x4d6598 from'../core/mgba.js';import*as a0_0x278e92 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x5bcd0f(0x1b5)](a0_0x5bcd0f(0x198))};function initializeCore(_0x272dc8,_0x10cca5){const _0xdcdca7=a0_0x5bcd0f;_0x272dc8(_0x10cca5)[_0xdcdca7(0x184)](function(_0x5f2e41){const _0x5ba0ed=_0xdcdca7;_0x5f2e41[_0x5ba0ed(0x161)]();});}initializeCore(a0_0x4d6598,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x5bcd0f(0x1b5)](a0_0x5bcd0f(0x198)),savedTurboState=localStorage[a0_0x5bcd0f(0x190)](a0_0x5bcd0f(0x1b1)),controlSetting=document['getElementById'](a0_0x5bcd0f(0x1af));function handleVisibilityChange(_0x1a6e3d){const _0x4df431=a0_0x5bcd0f;document[_0x4df431(0x181)]===_0x4df431(0x169)||_0x1a6e3d?.[_0x4df431(0x19d)]===_0x4df431(0x178)||_0x1a6e3d?.['persisted']?(pauseGame(),canvas['classList'][_0x4df431(0x15f)]('visible')):(setTimeout(()=>{const _0x6a4e93=_0x4df431;canvas['classList']['remove'](_0x6a4e93(0x157));},0x258),controlSetting[_0x4df431(0x1b4)]['contains'](_0x4df431(0x157))&&resumeGame());}async function statusShow(){const _0x4f0f27=a0_0x5bcd0f;document[_0x4f0f27(0x188)]('pagehide',handleVisibilityChange),document[_0x4f0f27(0x188)](_0x4f0f27(0x159),handleVisibilityChange),window[_0x4f0f27(0x188)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x278e92[_0x4f0f27(0x187)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x4f0f27(0x190)](_0x4f0f27(0x168)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x514c48=a0_0x5bcd0f;await ledSave(_0x514c48(0x16e)),await Module[_0x514c48(0x15d)](0x0),await Module[_0x514c48(0x167)](),await screenShot(0x0),console[_0x514c48(0x15a)](_0x514c48(0x16a)+ ++countAutoSave+_0x514c48(0x17e));}async function saveStateInCloud(){const _0x3ef48c=a0_0x5bcd0f,_0x36e122=localStorage[_0x3ef48c(0x190)](_0x3ef48c(0x151)),_0x28e8c2=_0x36e122[_0x3ef48c(0x18c)](_0x3ef48c(0x14f),_0x3ef48c(0x1a7)),_0x507486=localStorage[_0x3ef48c(0x190)]('uId'),_0x58ac2f=localStorage['getItem'](_0x36e122+_0x3ef48c(0x173)),_0x5e89f6=localStorage['getItem'](_0x36e122+_0x3ef48c(0x158));if(navigator[_0x3ef48c(0x165)]){if(_0x507486){await ledSave(_0x3ef48c(0x153)),await delay(0x3e8),await dpUploadFile(_0x28e8c2,Module[_0x3ef48c(0x1b6)]('/data/states/'+_0x28e8c2));if(_0x58ac2f!==null){const _0x5453dc=_0x58ac2f+'\x0a\x0a'+_0x5e89f6,_0x53265a=new Blob([_0x5453dc],{'type':_0x3ef48c(0x192)});await dpUploadFile(_0x36e122+_0x3ef48c(0x19a),_0x53265a);}else console[_0x3ef48c(0x15a)]('No\x20screenshot!');await lockNoti('',_0x3ef48c(0x16b)+ ++countUpload+_0x3ef48c(0x17e),0x7d0);}else console['log'](_0x3ef48c(0x194));}else console[_0x3ef48c(0x15a)](_0x3ef48c(0x19e));}function startTimer(){let [_0x153a87,_0x47e8b0,_0x111ad5,_0x180a6f,_0x4858e8]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x1ebdff=a0_0x40ba;_0x111ad5++,_0x180a6f++,_0x4858e8++;if(_0x111ad5===0x3c)[_0x111ad5,_0x47e8b0]=[0x0,_0x47e8b0+0x1];if(_0x47e8b0===0x3c)[_0x47e8b0,_0x153a87]=[0x0,_0x153a87+0x1];document['getElementById'](_0x1ebdff(0x150))[_0x1ebdff(0x1a9)]=_0x153a87+'h'+_0x47e8b0[_0x1ebdff(0x160)]()[_0x1ebdff(0x18b)](0x2,'0')+'.'+_0x111ad5['toString']()['padStart'](0x2,'0');_0x180a6f===0x3c&&(saveStatePeriodically(),_0x180a6f=0x0);;_0x180a6f===0xe10&&(saveStateInCloud(),_0x4858e8=0x0);;},0x3e8);}export async function uploadGame(_0x3469a8){const _0x187500=a0_0x5bcd0f,_0x38d57c=_0x3469a8[_0x187500(0x195)][0x0];Module[_0x187500(0x15e)](_0x38d57c,()=>{const _0x331111=_0x187500;Module[_0x331111(0x167)]();});}export async function loadGame(_0x3ac583){const _0x1f297a=a0_0x5bcd0f,_0xd844a1=_0x3ac583[_0x1f297a(0x18c)](/\.(gba|gbc|gb|zip)$/,_0x1f297a(0x1a7)),_0x5d9c6f=Module[_0x1f297a(0x179)]();intro['classList'][_0x1f297a(0x15f)]('disable'),errorLogElements[0x0][_0x1f297a(0x1ab)][_0x1f297a(0x189)]='0',ingame[_0x1f297a(0x1b4)]['remove'](_0x1f297a(0x174)),_0x3ac583[_0x1f297a(0x186)]('.gbc')||_0x3ac583[_0x1f297a(0x186)]('.gb')?(canvas[_0x1f297a(0x1b4)][_0x1f297a(0x15f)](_0x1f297a(0x18f)),areaTrans[_0x1f297a(0x1b4)]['add']('gbc1'),localStorage['setItem'](_0x1f297a(0x16c),'0,0,'+(window[_0x1f297a(0x18e)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x1f297a(0x15b)](_0x1f297a(0x16c),'0,0,'+(window['innerWidth']-0x96)+','+(window[_0x1f297a(0x18e)]-0x96)*0x2/0x3),_0x5d9c6f[_0x1f297a(0x14e)](_0xd844a1)?(await Module['loadGame'](_0x1f297a(0x19b)+_0x3ac583),confirm(_0x1f297a(0x18a))&&(await Module[_0x1f297a(0x17a)](0x0),localStorage['setItem'](_0x1f297a(0x151),_0x3ac583),console[_0x1f297a(0x15a)](_0x3ac583))):(await Module[_0x1f297a(0x1a0)](_0x1f297a(0x19b)+_0x3ac583),localStorage[_0x1f297a(0x15b)]('gameName',_0x3ac583)),await statusShow();}export async function saveState(_0x55215a){const _0x298ba5=a0_0x5bcd0f;await Module[_0x298ba5(0x15d)](_0x55215a),await Module[_0x298ba5(0x167)]();}export async function loadState(_0x1c60a5){const _0x369817=a0_0x5bcd0f;await Module[_0x369817(0x17a)](_0x1c60a5);}export async function downloadFile(_0x2ade79,_0xf3e8f2){const _0x51c973=a0_0x5bcd0f,_0x2ca4da=Module[_0x51c973(0x1b6)](_0x2ade79),_0xd6215f=document[_0x51c973(0x19f)]('a');document[_0x51c973(0x185)]['appendChild'](_0xd6215f),_0xd6215f['download']=_0xf3e8f2;const _0xd83642=new Blob([_0x2ca4da],{'type':_0x51c973(0x162)});_0xd6215f[_0x51c973(0x155)]=URL[_0x51c973(0x17f)](_0xd83642),_0xd6215f[_0x51c973(0x18d)](),URL[_0x51c973(0x19c)](_0xd83642),_0xd6215f[_0x51c973(0x152)]();}export function downloadFileInCloud(_0x46d783){const _0x4cafbd=Module['downloadFile'](_0x46d783);return _0x4cafbd;}export async function uploadFile(_0x385fc8){const _0x2e7a6e=a0_0x5bcd0f,_0x3200ec=_0x385fc8['files'][0x0];Module[_0x2e7a6e(0x1b0)](_0x3200ec,()=>{const _0x28a42d=_0x2e7a6e;Module[_0x28a42d(0x167)]();});}export async function editFile(_0x4f687c,_0x4794ee,_0x1d2dff){const _0x1f8677=a0_0x5bcd0f;await Module[_0x1f8677(0x17c)](_0x4f687c,_0x4794ee,_0x1d2dff),await Module[_0x1f8677(0x167)]();}export async function deleteFile(_0x426fd0){const _0x118736=a0_0x5bcd0f;await Module[_0x118736(0x193)](_0x426fd0),await Module[_0x118736(0x167)]();}export function listGame(){const _0x42a44f=a0_0x5bcd0f,_0x28b04e=Module[_0x42a44f(0x164)]();return _0x28b04e;}function a0_0x40ba(_0x533a73,_0x1dfe7d){const _0x4184bf=a0_0x4184();return a0_0x40ba=function(_0x40ba9d,_0x1c0a91){_0x40ba9d=_0x40ba9d-0x14e;let _0x4b97b1=_0x4184bf[_0x40ba9d];return _0x4b97b1;},a0_0x40ba(_0x533a73,_0x1dfe7d);}export function listSave(){const _0x53dc19=a0_0x5bcd0f,_0x333f7a=Module[_0x53dc19(0x16f)]();return _0x333f7a;}export function listState(){const _0x33bcd7=a0_0x5bcd0f,_0x3b4556=Module[_0x33bcd7(0x179)]();return _0x3b4556;}export function listCheat(){const _0x42284d=Module['listCheats']();return _0x42284d;}export function listScreenshot(){const _0x3156cd=a0_0x5bcd0f,_0x5e60d3=Module[_0x3156cd(0x156)]();return _0x5e60d3;}export function fileSize(_0x1084fa){const _0x3e41b5=Module['fileSize'](_0x1084fa);return _0x3e41b5;}export async function uploadCheat(_0x19545b){const _0x52e291=a0_0x5bcd0f;try{const _0x216d75=_0x19545b[_0x52e291(0x195)][0x0];await Module[_0x52e291(0x154)](_0x216d75,()=>{const _0x72108c=_0x52e291;console[_0x72108c(0x15a)](_0x72108c(0x182),_0x216d75[_0x72108c(0x1a6)]),localStorageFile(),Module['FSSync']();});}catch(_0x65eb72){console[_0x52e291(0x197)]('Error\x20uploadCheat:',_0x65eb72);}}function a0_0x4184(){const _0x237258=['Resumed!','4336860kigngu','beforeunload','listStates','loadState','buttonPress','editFileName','_dateState','\x20time(s)','createObjectURL','18917412HcVIdy','visibilityState','Cheat\x20uploaded\x20successfully:','_imageState','then','body','endsWith','turboF','addEventListener','bottom','Do\x20you\x20want\x20to\x20load\x20save\x20state?','padStart','replace','click','innerWidth','gbc','getItem','18ZByrim','text/plain','deleteFile','Unable\x20to\x20upload\x20to\x20Cloud!','files','1EzaBqh','error','canvas','1787499eBTUIZ','_slot0.txt','/data/games/','revokeObjectURL','type','Online!','createElement','loadGame','.png','_savedCheats','275048NRDgpE','pauseGame','/data/screenshots/','name','.ss0','9nDrMgy','textContent','11vgAnhz','style','99lHKddG','178185xMyfLR','setFastForwardMultiplier','control-setting','uploadSaveOrSaveState','turboState','Cheat\x20Enabled!','autoLoadCheats','classList','getElementById','downloadFile','includes','.gba','timer','gameName','remove','#E0C068','uploadCheats','href','listScreenshots','visible','_dateState0','visibilitychange','log','setItem','Save/State\x20uploaded\x20successfully:','saveState','uploadRom','add','toString','FSInit','application/octet-stream','screenshot','listGames','onLine','415704eOUTDE','FSSync','slotStateSaved','hidden','Auto\x20save\x20','Cloud\x20upload\x20','screenSize','Paused!','#20A5A6','listSaves','resumeGame','1999502bMJPOw','Error\x20uploadSavSta:','_imageState0','disable','SDL2'];a0_0x4184=function(){return _0x237258;};return a0_0x4184();}export async function uploadSavSta(_0x2da26a){const _0x890f49=a0_0x5bcd0f;try{const _0x280871=_0x2da26a[_0x890f49(0x195)][0x0];await Module['uploadSaveOrSaveState'](_0x280871,()=>{const _0x38d745=_0x890f49;console[_0x38d745(0x15a)](_0x38d745(0x15c),_0x280871[_0x38d745(0x1a6)]),localStorageFile(),Module['FSSync']();});}catch(_0x3ac091){console['error'](_0x890f49(0x172),_0x3ac091);}}export async function uploadSaveOrSaveState(_0x4ddf09){const _0x413eda=a0_0x5bcd0f;Module[_0x413eda(0x1b0)](_0x4ddf09,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0xd6838=a0_0x5bcd0f;Module[_0xd6838(0x170)](),Module['SDL2'](),notiMessage(_0xd6838(0x176),0x7d0);}export async function pauseGame(){const _0x2cf741=a0_0x5bcd0f;Module[_0x2cf741(0x1a4)](),Module[_0x2cf741(0x175)](),notiMessage(_0x2cf741(0x16d),0x7d0);}export async function buttonPress(_0x372f4d){const _0x4699d2=a0_0x5bcd0f;Module[_0x4699d2(0x17b)](_0x372f4d);}export async function buttonUnpress(_0x321afa){Module['buttonUnpress'](_0x321afa);}export async function screenShot(_0x443964){const _0x40a009=a0_0x5bcd0f,_0x253f8d=localStorage[_0x40a009(0x190)](_0x40a009(0x151)),_0x5180f2=_0x253f8d[_0x40a009(0x18c)](/\.(gba|gbc|gb|zip)$/,'_');await Module['screenshot'](''+_0x5180f2+_0x443964+_0x40a009(0x1a1)),await Module['FSSync']();const _0x718863=await fileToBase64(Module[_0x40a009(0x1b6)]('/data/screenshots/'+_0x5180f2+_0x443964+'.png')),_0x262081=Date['now'](),_0x5b6056=formatDateTime(_0x262081);localStorage[_0x40a009(0x15b)](_0x253f8d+_0x40a009(0x17d)+_0x443964,_0x5b6056),localStorage[_0x40a009(0x15b)](_0x253f8d+_0x40a009(0x183)+_0x443964,_0x718863);}export async function captureOCR(_0x544a75){const _0x4bab05=a0_0x5bcd0f;Module[_0x4bab05(0x163)](_0x544a75);const _0x1c8116=Module[_0x4bab05(0x1b6)](_0x4bab05(0x1a5)+_0x544a75);return _0x1c8116;}export async function setFastForwardMultiplier(_0x1917c8){const _0x200d42=a0_0x5bcd0f;Module[_0x200d42(0x1ae)](_0x1917c8);}export function uploadCheats(_0x5bb788,_0x21733a,_0x2e4b97,_0x95f65e,_0x12cbf9){const _0x4a2fdb=a0_0x5bcd0f;Module[_0x4a2fdb(0x154)](_0x5bb788,()=>{const _0x34d839=_0x4a2fdb;Module[_0x34d839(0x1b3)](),setTimeout(()=>{const _0x3b738c=_0x34d839;Module[_0x3b738c(0x167)]();},0x1f4),_0x95f65e&&(localStorage[_0x34d839(0x15b)](_0x21733a+_0x34d839(0x1a2),_0x2e4b97),notiMessage(_0x34d839(0x1b2),0x5dc)),_0x12cbf9[_0x34d839(0x1a9)]=localStorage[_0x34d839(0x190)](_0x21733a+_0x34d839(0x1a2)||'Off');});}