const a0_0x3df255=a0_0x5081;(function(_0x9af2f0,_0x3cf2cd){const _0xe0734a=a0_0x5081,_0x5251a3=_0x9af2f0();while(!![]){try{const _0x16795d=parseInt(_0xe0734a(0x202))/0x1*(-parseInt(_0xe0734a(0x223))/0x2)+parseInt(_0xe0734a(0x209))/0x3+-parseInt(_0xe0734a(0x1e8))/0x4+parseInt(_0xe0734a(0x201))/0x5+parseInt(_0xe0734a(0x1e9))/0x6*(-parseInt(_0xe0734a(0x219))/0x7)+-parseInt(_0xe0734a(0x216))/0x8*(-parseInt(_0xe0734a(0x227))/0x9)+parseInt(_0xe0734a(0x1ff))/0xa;if(_0x16795d===_0x3cf2cd)break;else _0x5251a3['push'](_0x5251a3['shift']());}catch(_0x2997f5){_0x5251a3['push'](_0x5251a3['shift']());}}}(a0_0x8b25,0x4d2e1));import a0_0x12316f from'../core/mgba.js';import*as a0_0x63eb9c from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x3df255(0x21b)](a0_0x3df255(0x203))};function initializeCore(_0x83441e,_0x561d50){const _0xf80b51=a0_0x3df255;_0x83441e(_0x561d50)[_0xf80b51(0x1cb)](function(_0x311bca){const _0x455610=_0xf80b51;_0x311bca[_0x455610(0x21e)]();});}initializeCore(a0_0x12316f,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x3df255(0x21b)]('canvas'),savedTurboState=localStorage[a0_0x3df255(0x1c3)](a0_0x3df255(0x217)),controlSetting=document[a0_0x3df255(0x21b)]('control-setting');function handleVisibilityChange(_0x1c1de4){const _0x5600d6=a0_0x3df255;document['visibilityState']===_0x5600d6(0x1ce)||_0x1c1de4?.[_0x5600d6(0x212)]===_0x5600d6(0x1e5)||_0x1c1de4?.[_0x5600d6(0x1e4)]?(pauseGame(),canvas[_0x5600d6(0x225)]['add'](_0x5600d6(0x20b))):(setTimeout(()=>{const _0xceba32=_0x5600d6;canvas[_0xceba32(0x225)][_0xceba32(0x208)]('visible');},0x258),controlSetting['classList']['contains'](_0x5600d6(0x20b))&&resumeGame());}async function statusShow(){const _0x396f79=a0_0x3df255;document['addEventListener']('pagehide',handleVisibilityChange),document[_0x396f79(0x1f1)](_0x396f79(0x1ec),handleVisibilityChange),window['addEventListener'](_0x396f79(0x1e5),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x63eb9c[_0x396f79(0x200)](turboState)),await delay(0xc8),await Module[_0x396f79(0x1fb)](),await delay(0x320),await led(parseInt(localStorage['getItem'](_0x396f79(0x1e2)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x5f3d1a=a0_0x3df255;await ledSave(_0x5f3d1a(0x220)),await Module[_0x5f3d1a(0x215)](0x0),await Module['FSSync'](),await screenShot(0x0),console[_0x5f3d1a(0x1ef)](_0x5f3d1a(0x1cc)+ ++countAutoSave+_0x5f3d1a(0x1de));}async function saveStateInCloud(){const _0x39357a=a0_0x3df255,_0x26d30c=localStorage['getItem']('gameName'),_0x1dfb82=_0x26d30c[_0x39357a(0x1f0)](/\.(zip|gb|gbc|gba)$/,_0x39357a(0x1c7)),_0x34ed8e=localStorage['getItem'](_0x39357a(0x1f9));navigator['onLine']&&(_0x34ed8e&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x1dfb82,Module[_0x39357a(0x206)](_0x39357a(0x1f6)+_0x1dfb82),_0x39357a(0x21c)),await lockNoti('',_0x39357a(0x1c6)+ ++countUpload+_0x39357a(0x1de),0x7d0)));}function startTimer(){let [_0x2f90ac,_0x332d0b,_0x3fc0b0,_0x1deef8,_0x23f578]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x1ef53c=a0_0x5081;_0x3fc0b0++,_0x1deef8++,_0x23f578++;if(_0x3fc0b0===0x3c)[_0x3fc0b0,_0x332d0b]=[0x0,_0x332d0b+0x1];if(_0x332d0b===0x3c)[_0x332d0b,_0x2f90ac]=[0x0,_0x2f90ac+0x1];document[_0x1ef53c(0x21b)](_0x1ef53c(0x1fe))[_0x1ef53c(0x21f)]=_0x2f90ac+'h'+_0x332d0b[_0x1ef53c(0x20d)]()[_0x1ef53c(0x1d4)](0x2,'0')+'.'+_0x3fc0b0[_0x1ef53c(0x20d)]()['padStart'](0x2,'0');_0x1deef8===0x3c&&(saveStatePeriodically(),_0x1deef8=0x0);;_0x23f578===0x708&&(saveStateInCloud(),_0x23f578=0x0);;},0x3e8);}export async function uploadGame(_0x48c683){const _0x301041=a0_0x3df255,_0x4e3b91=_0x48c683['files'][0x0];Module[_0x301041(0x1f8)](_0x4e3b91,()=>{const _0x3e96f2=_0x301041;Module[_0x3e96f2(0x1df)]();});}export async function loadGame(_0xd33946){const _0x339b1c=a0_0x3df255,_0x2cf20d=_0xd33946[_0x339b1c(0x1f0)](/\.(gba|gbc|gb|zip)$/,_0x339b1c(0x1c7)),_0x3f8cf8=Module[_0x339b1c(0x21d)]()[_0x339b1c(0x1fc)](_0x40ad81=>_0x40ad81!=='.'&&_0x40ad81!=='..');intro[_0x339b1c(0x225)]['add'](_0x339b1c(0x1c8)),errorLogElements[0x0][_0x339b1c(0x1f3)]['bottom']='0',ingame[_0x339b1c(0x225)][_0x339b1c(0x208)](_0x339b1c(0x1c8)),_0xd33946[_0x339b1c(0x1ea)](_0x339b1c(0x1d9))||_0xd33946[_0x339b1c(0x1ea)](_0x339b1c(0x20a))?(canvas[_0x339b1c(0x225)][_0x339b1c(0x1ee)](_0x339b1c(0x1db)),areaTrans[_0x339b1c(0x225)]['add'](_0x339b1c(0x1d3)),localStorage['setItem'](_0x339b1c(0x226),'0,0,'+(window[_0x339b1c(0x1c4)]-0xe6)+','+(window[_0x339b1c(0x1c4)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x339b1c(0x226),_0x339b1c(0x1fa)+(window[_0x339b1c(0x1c4)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x3f8cf8[_0x339b1c(0x1d2)](_0x2cf20d)?(await Module['loadGame']('/data/games/'+_0xd33946),confirm(_0x339b1c(0x1d5))&&(await Module[_0x339b1c(0x1dd)](0x0),localStorage[_0x339b1c(0x1d8)]('gameName',_0xd33946),console[_0x339b1c(0x1ef)](_0xd33946))):(await Module[_0x339b1c(0x221)](_0x339b1c(0x1cd)+_0xd33946),localStorage[_0x339b1c(0x1d8)](_0x339b1c(0x1e0),_0xd33946),console[_0x339b1c(0x1ef)](_0xd33946)),await statusShow();}export async function saveState(_0x228775){await Module['saveState'](_0x228775),await Module['FSSync']();}export async function loadState(_0x309189){await Module['loadState'](_0x309189);}export async function downloadFile(_0x36cbab,_0x282ad2){const _0x1e1dfc=a0_0x3df255,_0x4440dd=Module[_0x1e1dfc(0x206)](_0x36cbab),_0x14459c=document[_0x1e1dfc(0x218)]('a');document[_0x1e1dfc(0x1ca)][_0x1e1dfc(0x1d7)](_0x14459c),_0x14459c['download']=_0x282ad2;const _0x3db4db=new Blob([_0x4440dd],{'type':_0x1e1dfc(0x1f7)});_0x14459c['href']=URL['createObjectURL'](_0x3db4db),_0x14459c[_0x1e1dfc(0x1c5)](),URL[_0x1e1dfc(0x205)](_0x3db4db),_0x14459c[_0x1e1dfc(0x208)]();}export function downloadFileInCloud(_0x48474d){const _0x5eb01d=Module['downloadFile'](_0x48474d);return _0x5eb01d;}export async function uploadFileInCloud(_0x38999b){const _0x15e0d6=a0_0x3df255;Module[_0x15e0d6(0x1d0)](_0x38999b,()=>{const _0x6c933=_0x15e0d6;localStorageFile(),Module[_0x6c933(0x1df)]();});}export async function uploadFile(_0x3535ed){const _0x1defe9=a0_0x3df255,_0x111598=_0x3535ed['files'][0x0];Module[_0x1defe9(0x1d0)](_0x111598,()=>{const _0x1b82b2=_0x1defe9;localStorageFile(),Module[_0x1b82b2(0x1df)]();});}export async function editFile(_0x541f0f,_0x43c076,_0x323691){const _0x4da2d1=a0_0x3df255;await Module[_0x4da2d1(0x210)](_0x541f0f,_0x43c076,_0x323691),await Module[_0x4da2d1(0x1df)]();}export async function deleteFile(_0x2d36c8){const _0x44b26b=a0_0x3df255;await Module['deleteFile'](_0x2d36c8),await Module[_0x44b26b(0x1df)]();}export function listGame(){const _0x420789=a0_0x3df255,_0x48deff=Module[_0x420789(0x1e1)]()[_0x420789(0x1fc)](_0x21a03c=>_0x21a03c!=='.'&&_0x21a03c!=='..');return _0x48deff;}export function listSave(){const _0x86c03b=a0_0x3df255,_0x5ca49d=Module[_0x86c03b(0x1d6)]()['filter'](_0x40329c=>_0x40329c!=='.'&&_0x40329c!=='..');return _0x5ca49d;}export function listState(){const _0x339675=a0_0x3df255,_0x122c54=Module[_0x339675(0x21d)]()[_0x339675(0x1fc)](_0x1f6336=>_0x1f6336!=='.'&&_0x1f6336!=='..');return _0x122c54;}export function listCheat(){const _0x5521bb=a0_0x3df255,_0x3c6daa=Module[_0x5521bb(0x222)]()[_0x5521bb(0x1fc)](_0x53a9a6=>_0x53a9a6!=='.'&&_0x53a9a6!=='..');return _0x3c6daa;}export function listScreenshot(){const _0x1f7c38=a0_0x3df255,_0x1565a4=Module[_0x1f7c38(0x1ed)]()['filter'](_0x193767=>_0x193767!=='.'&&_0x193767!=='..');return _0x1565a4;}function a0_0x5081(_0x3a9a30,_0x207ad9){const _0x8b2500=a0_0x8b25();return a0_0x5081=function(_0x5081f7,_0x1f8079){_0x5081f7=_0x5081f7-0x1c3;let _0x58ff7e=_0x8b2500[_0x5081f7];return _0x58ff7e;},a0_0x5081(_0x3a9a30,_0x207ad9);}export function embedTextInPngFile(_0x2c9737,_0x59431b,_0x15f12e){const _0x2da19d=a0_0x3df255;let _0x543abd=atob(_0x2c9737[_0x2da19d(0x1eb)](',')[0x1]),_0x9d142d=new Uint8Array(_0x543abd['length']);for(let _0x41c896=0x0;_0x41c896<_0x543abd[_0x2da19d(0x1c9)];_0x41c896++){_0x9d142d[_0x41c896]=_0x543abd[_0x2da19d(0x1da)](_0x41c896);}let _0x41e6f1=new TextEncoder()['encode'](_0x2da19d(0x207)+_0x59431b),_0x55bb57=new Uint8Array(_0x9d142d['length']+_0x41e6f1[_0x2da19d(0x1c9)]);_0x55bb57[_0x2da19d(0x1dc)](_0x9d142d,0x0),_0x55bb57[_0x2da19d(0x1dc)](_0x41e6f1,_0x9d142d[_0x2da19d(0x1c9)]);let _0x33919c=new Blob([_0x55bb57],{'type':'image/png'}),_0x25312f=new File([_0x33919c],_0x15f12e,{'type':_0x2da19d(0x204)});return _0x25312f;}function a0_0x8b25(){const _0x320ed3=['.ss0','disable','length','body','then','Auto\x20save\x20','/data/games/','hidden','fileSize','uploadAll','Cheat\x20Enabled!','includes','gbc1','padStart','Do\x20you\x20want\x20to\x20load\x20save\x20state?','listSaves','appendChild','setItem','.gbc','charCodeAt','gbc','set','loadState','\x20time(s)','FSSync','gameName','listRoms','slotStateSaved','setFastForwardMultiplier','persisted','beforeunload','screenshot','Paused!','492656TEqBbw','90vscOkY','endsWith','split','visibilitychange','listScreenshots','add','log','replace','addEventListener','resumeGame','style','_savedCheats','substring','/data/states/','application/octet-stream','uploadRom','uId','0,0,','SDL2','filter','pauseGame','timer','296910CUQFDo','turboF','1910375SielOp','5083CtjzHO','canvas','image/png','revokeObjectURL','downloadFile','tEXtComment\x00','remove','504750ssLygc','.gb','visible','Resumed!','toString','/data/screenshots/','.png','editFileName','setVolume','type','now','autoLoadCheats','saveState','184lUQpZp','turboState','createElement','119273VrjyNY','indexOf','getElementById','state','listStates','FSInit','textContent','#20A5A6','loadGame','listCheats','110xaCxER','Off','classList','screenSize','154341PlsKdG','getItem','innerWidth','click','Cloud\x20upload\x20'];a0_0x8b25=function(){return _0x320ed3;};return a0_0x8b25();}export function extractTextFromPngBase64(_0x25173f){const _0x23340c=a0_0x3df255;let _0x5887a3=atob(_0x25173f[_0x23340c(0x1eb)](',')[0x1]),_0x3e34b1=_0x23340c(0x207),_0x196cd8=_0x5887a3[_0x23340c(0x21a)](_0x3e34b1);if(_0x196cd8!==-0x1)return _0x5887a3[_0x23340c(0x1f5)](_0x196cd8+_0x3e34b1[_0x23340c(0x1c9)]);return null;}export function fileSize(_0x31d19f){const _0x51e625=a0_0x3df255,_0x196baf=Module[_0x51e625(0x1cf)](_0x31d19f);return _0x196baf;}export async function resumeGame(){const _0xe3a9fa=a0_0x3df255;Module[_0xe3a9fa(0x1f2)](),Module[_0xe3a9fa(0x1fb)](),notiMessage(_0xe3a9fa(0x20c),0x7d0);}export async function pauseGame(){const _0x24f26b=a0_0x3df255;Module[_0x24f26b(0x1fd)](),Module[_0x24f26b(0x1fb)](),notiMessage(_0x24f26b(0x1e7),0x7d0);}export async function buttonPress(_0x1f155c){Module['buttonPress'](_0x1f155c);}export async function buttonUnpress(_0x4f6c94){Module['buttonUnpress'](_0x4f6c94);}export async function screenShot(_0x59265c){const _0x721d81=a0_0x3df255,_0x4e9b77=localStorage[_0x721d81(0x1c3)](_0x721d81(0x1e0))['replace'](/\.(gba|gbc|gb|zip)$/,''),_0x560702=_0x4e9b77+'_'+_0x59265c+_0x721d81(0x20f);await Module[_0x721d81(0x1e6)](_0x560702),await Module['FSSync']();const _0x1b5a90=await fileToBase64(Module['downloadFile'](_0x721d81(0x20e)+_0x560702)),_0x2af7b4=embedTextInPngFile(_0x1b5a90,formatDateTime(Date[_0x721d81(0x213)]()),_0x560702);Module[_0x721d81(0x1d0)](_0x2af7b4,()=>{const _0x142d71=_0x721d81;localStorageFile(),Module[_0x142d71(0x1df)]();});}export async function dowloadScreenShot(_0x2a5367){const _0x1fd520=a0_0x3df255;try{const _0x1b2b04=await fileToBase64(Module[_0x1fd520(0x206)](_0x2a5367));return _0x1b2b04;}catch{}}export async function captureOCR(_0xc1d3){const _0x3aafeb=a0_0x3df255;Module[_0x3aafeb(0x1e6)](_0xc1d3);const _0x4ff5bc=Module['downloadFile'](_0x3aafeb(0x20e)+_0xc1d3);return _0x4ff5bc;}export async function setFastForwardMultiplier(_0x5d3943){const _0xf49b6c=a0_0x3df255;Module[_0xf49b6c(0x1e3)](_0x5d3943);}export function uploadCheats(_0x1d52ee,_0x5cb761,_0x1ab571,_0x2020ec,_0x385f11){Module['uploadAll'](_0x1d52ee,()=>{const _0x1db053=a0_0x5081;Module[_0x1db053(0x214)](),setTimeout(()=>{const _0x3c8a7d=_0x1db053;Module[_0x3c8a7d(0x1df)]();},0x1f4),_0x2020ec&&(localStorage[_0x1db053(0x1d8)](_0x5cb761+'_savedCheats',_0x1ab571),notiMessage(_0x1db053(0x1d1),0x5dc)),_0x385f11[_0x1db053(0x21f)]=localStorage['getItem'](_0x5cb761+_0x1db053(0x1f4)||_0x1db053(0x224));});}export function setVolume(_0x4cb8c4){const _0x554c1e=a0_0x3df255;Module[_0x554c1e(0x211)](_0x4cb8c4);}