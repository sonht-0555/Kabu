const a0_0x311848=a0_0xa927;(function(_0xf3fe35,_0xd2467b){const _0x1e557b=a0_0xa927,_0x444bad=_0xf3fe35();while(!![]){try{const _0xfffeb6=parseInt(_0x1e557b(0x240))/0x1+-parseInt(_0x1e557b(0x219))/0x2+-parseInt(_0x1e557b(0x203))/0x3+parseInt(_0x1e557b(0x200))/0x4+parseInt(_0x1e557b(0x218))/0x5+parseInt(_0x1e557b(0x21f))/0x6*(parseInt(_0x1e557b(0x1f4))/0x7)+-parseInt(_0x1e557b(0x222))/0x8*(parseInt(_0x1e557b(0x236))/0x9);if(_0xfffeb6===_0xd2467b)break;else _0x444bad['push'](_0x444bad['shift']());}catch(_0x4adc55){_0x444bad['push'](_0x444bad['shift']());}}}(a0_0x48ff,0xe96cc));import a0_0x21c3ed from'../core/mgba.js';import*as a0_0x38352e from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';function a0_0x48ff(){const _0x55a865=['deleteFile','1206204JCvNvZ','control-setting','uploadSaveOrSaveState','createElement','Cheat\x20Enabled!','FSSync','getItem','/data/states/','autoLoadCheats','persisted','download','filter','#20A5A6','_dateState','endsWith','turboState','gbc1','remove','editFileName','#E0C068','loadState','canvas','click','visibilityState','now','classList','/data/screenshots/','application/octet-stream','uId','resumeGame','body','Paused!','7eTEbkI','screenshot','_imageState','listRoms','log','addEventListener','Do\x20you\x20want\x20to\x20load\x20save\x20state?','text/plain','loadGame','_dateState0','.gbc','slotStateSaved','7622380NwxAFl','pauseGame','visibilitychange','4469805GoDUMP','onLine','Error\x20uploadCheat:','screenSize','beforeunload','listStates','type','Auto\x20save\x20','SDL2','Cheat\x20uploaded\x20successfully:','buttonPress','then','replace','.png','Error\x20uploadSavSta:','href','\x20time(s)','Unable\x20to\x20upload\x20to\x20Cloud!','disable','Online!','Off','7108010NLGhFu','1231606tzYUTS','visible','Resumed!','setFastForwardMultiplier','gameName','.ss0','3046566PJrmEx','name','bottom','3576DdyHrf','_savedCheats','downloadFile','No\x20screenshot!','appendChild','padStart','fileSize','setItem','innerWidth','add','contains','uploadCheats','style','textContent','saveState','turboF','listCheats','error','toString','/data/games/','39852xdEsOv','buttonUnpress','files','Cloud\x20upload\x20','listScreenshots','getElementById','_imageState0','0,0,','revokeObjectURL'];a0_0x48ff=function(){return _0x55a865;};return a0_0x48ff();}const Module={'canvas':document['getElementById']('canvas')};function initializeCore(_0x883317,_0x57f586){const _0x1ede19=a0_0xa927;_0x883317(_0x57f586)[_0x1ede19(0x20e)](function(_0xa8b49){_0xa8b49['FSInit']();});}initializeCore(a0_0x21c3ed,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x311848(0x23b)](a0_0x311848(0x1e9)),savedTurboState=localStorage[a0_0x311848(0x1da)](a0_0x311848(0x1e3)),controlSetting=document['getElementById'](a0_0x311848(0x241));function handleVisibilityChange(_0x235beb){const _0x4fd59c=a0_0x311848;document[_0x4fd59c(0x1eb)]==='hidden'||_0x235beb?.[_0x4fd59c(0x209)]===_0x4fd59c(0x207)||_0x235beb?.[_0x4fd59c(0x1dd)]?(pauseGame(),canvas[_0x4fd59c(0x1ed)][_0x4fd59c(0x22b)](_0x4fd59c(0x21a))):(setTimeout(()=>{const _0x2e6dec=_0x4fd59c;canvas[_0x2e6dec(0x1ed)]['remove'](_0x2e6dec(0x21a));},0x258),controlSetting['classList'][_0x4fd59c(0x22c)](_0x4fd59c(0x21a))&&resumeGame());}async function statusShow(){const _0x2fbc3b=a0_0x311848;document[_0x2fbc3b(0x1f9)]('pagehide',handleVisibilityChange),document[_0x2fbc3b(0x1f9)](_0x2fbc3b(0x202),handleVisibilityChange),window[_0x2fbc3b(0x1f9)](_0x2fbc3b(0x207),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x38352e[_0x2fbc3b(0x231)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x2fbc3b(0x1da)](_0x2fbc3b(0x1ff)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x5b0485=a0_0x311848;await ledSave(_0x5b0485(0x1e0)),await Module[_0x5b0485(0x230)](0x0),await Module[_0x5b0485(0x245)](),await screenShot(0x0),console[_0x5b0485(0x1f8)](_0x5b0485(0x20a)+ ++countAutoSave+_0x5b0485(0x213));}function a0_0xa927(_0x2b0fb9,_0x59019f){const _0x48ff06=a0_0x48ff();return a0_0xa927=function(_0xa9276a,_0x25287d){_0xa9276a=_0xa9276a-0x1da;let _0x2c39fc=_0x48ff06[_0xa9276a];return _0x2c39fc;},a0_0xa927(_0x2b0fb9,_0x59019f);}async function saveStateInCloud(){const _0x8a9f98=a0_0x311848,_0x2e6625=localStorage['getItem'](_0x8a9f98(0x21d)),_0x5991fe=_0x2e6625[_0x8a9f98(0x20f)]('.gba',_0x8a9f98(0x21e)),_0x3cc3ed=localStorage[_0x8a9f98(0x1da)](_0x8a9f98(0x1f0)),_0x5081b1=localStorage[_0x8a9f98(0x1da)](_0x2e6625+_0x8a9f98(0x23c)),_0x29962c=localStorage[_0x8a9f98(0x1da)](_0x2e6625+_0x8a9f98(0x1fd));if(navigator[_0x8a9f98(0x204)]){if(_0x3cc3ed){await ledSave(_0x8a9f98(0x1e7)),await delay(0x3e8),await dpUploadFile(_0x5991fe,Module[_0x8a9f98(0x224)](_0x8a9f98(0x1db)+_0x5991fe));if(_0x5081b1!==null){const _0x3fd9c0=_0x5081b1+'\x0a\x0a'+_0x29962c,_0x3bf644=new Blob([_0x3fd9c0],{'type':_0x8a9f98(0x1fb)});await dpUploadFile(_0x2e6625+'_slot0.txt',_0x3bf644);}else console[_0x8a9f98(0x1f8)](_0x8a9f98(0x225));await lockNoti('',_0x8a9f98(0x239)+ ++countUpload+_0x8a9f98(0x213),0x7d0);}else console['log'](_0x8a9f98(0x214));}else console[_0x8a9f98(0x1f8)](_0x8a9f98(0x216));}function startTimer(){let [_0x442c61,_0x49ed9c,_0x4e8cf3,_0x4594bc,_0xa9a7bf]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x352d27=a0_0xa927;_0x4e8cf3++,_0x4594bc++,_0xa9a7bf++;if(_0x4e8cf3===0x3c)[_0x4e8cf3,_0x49ed9c]=[0x0,_0x49ed9c+0x1];if(_0x49ed9c===0x3c)[_0x49ed9c,_0x442c61]=[0x0,_0x442c61+0x1];document['getElementById']('timer')[_0x352d27(0x22f)]=_0x442c61+'h'+_0x49ed9c['toString']()[_0x352d27(0x227)](0x2,'0')+'.'+_0x4e8cf3[_0x352d27(0x234)]()[_0x352d27(0x227)](0x2,'0');_0x4594bc===0x3c&&(saveStatePeriodically(),_0x4594bc=0x0);;_0x4594bc===0xe10&&(saveStateInCloud(),_0xa9a7bf=0x0);;},0x3e8);}export async function uploadGame(_0xa57601){const _0x4c928a=a0_0x311848,_0x11e7b7=_0xa57601[_0x4c928a(0x238)][0x0];Module['uploadRom'](_0x11e7b7,()=>{const _0x327c82=_0x4c928a;Module[_0x327c82(0x245)]();});}export async function loadGame(_0x3e0887){const _0x57a93c=a0_0x311848,_0x487a16=_0x3e0887[_0x57a93c(0x20f)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x456f94=Module[_0x57a93c(0x208)]()[_0x57a93c(0x1df)](_0x4f505b=>_0x4f505b!=='.'&&_0x4f505b!=='..');intro['classList'][_0x57a93c(0x22b)](_0x57a93c(0x215)),errorLogElements[0x0][_0x57a93c(0x22e)][_0x57a93c(0x221)]='0',ingame[_0x57a93c(0x1ed)][_0x57a93c(0x1e5)](_0x57a93c(0x215)),_0x3e0887[_0x57a93c(0x1e2)](_0x57a93c(0x1fe))||_0x3e0887['endsWith']('.gb')?(canvas['classList']['add']('gbc'),areaTrans[_0x57a93c(0x1ed)][_0x57a93c(0x22b)](_0x57a93c(0x1e4)),localStorage[_0x57a93c(0x229)](_0x57a93c(0x206),_0x57a93c(0x23d)+(window['innerWidth']-0xe6)+','+(window[_0x57a93c(0x22a)]-0xe6)*0x9/0xa)):localStorage[_0x57a93c(0x229)](_0x57a93c(0x206),_0x57a93c(0x23d)+(window[_0x57a93c(0x22a)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x456f94['includes'](_0x487a16)?(await Module[_0x57a93c(0x1fc)](_0x57a93c(0x235)+_0x3e0887),confirm(_0x57a93c(0x1fa))&&(await Module[_0x57a93c(0x1e8)](0x0),localStorage['setItem']('gameName',_0x3e0887),console[_0x57a93c(0x1f8)](_0x3e0887))):(await Module['loadGame']('/data/games/'+_0x3e0887),localStorage['setItem'](_0x57a93c(0x21d),_0x3e0887)),await statusShow();}export async function saveState(_0x38d6e5){const _0x4aee10=a0_0x311848;await Module['saveState'](_0x38d6e5),await Module[_0x4aee10(0x245)]();}export async function loadState(_0x5dedd7){const _0x2b1bd8=a0_0x311848;await Module[_0x2b1bd8(0x1e8)](_0x5dedd7);}export async function downloadFile(_0x4124bf,_0x3e5e76){const _0x217036=a0_0x311848,_0x43eb99=Module[_0x217036(0x224)](_0x4124bf),_0x57a03c=document[_0x217036(0x243)]('a');document[_0x217036(0x1f2)][_0x217036(0x226)](_0x57a03c),_0x57a03c[_0x217036(0x1de)]=_0x3e5e76;const _0x269c30=new Blob([_0x43eb99],{'type':_0x217036(0x1ef)});_0x57a03c[_0x217036(0x212)]=URL['createObjectURL'](_0x269c30),_0x57a03c[_0x217036(0x1ea)](),URL[_0x217036(0x23e)](_0x269c30),_0x57a03c[_0x217036(0x1e5)]();}export function downloadFileInCloud(_0xc48865){const _0x5e978b=a0_0x311848,_0xe769b9=Module[_0x5e978b(0x224)](_0xc48865);return _0xe769b9;}export async function uploadFile(_0x96cc43){const _0x504cf3=a0_0x311848,_0x49e303=_0x96cc43[_0x504cf3(0x238)][0x0];Module['uploadSaveOrSaveState'](_0x49e303,()=>{Module['FSSync']();});}export async function editFile(_0x2cefd2,_0x10e324,_0x5ddd3c){const _0x12ef9f=a0_0x311848;await Module[_0x12ef9f(0x1e6)](_0x2cefd2,_0x10e324,_0x5ddd3c),await Module[_0x12ef9f(0x245)]();}export async function deleteFile(_0x45dc54){const _0x581c01=a0_0x311848;await Module[_0x581c01(0x23f)](_0x45dc54),await Module[_0x581c01(0x245)]();}export function listGame(){const _0x29f98f=a0_0x311848,_0x5a2a2a=Module[_0x29f98f(0x1f7)]()['filter'](_0x2ce1fd=>_0x2ce1fd!=='.'&&_0x2ce1fd!=='..');return _0x5a2a2a;}export function listSave(){const _0x11d90f=a0_0x311848,_0x2abc6f=Module['listSaves']()[_0x11d90f(0x1df)](_0x13aeae=>_0x13aeae!=='.'&&_0x13aeae!=='..');return _0x2abc6f;}export function listState(){const _0x21f132=a0_0x311848,_0x4d5d06=Module[_0x21f132(0x208)]()[_0x21f132(0x1df)](_0x1d4135=>_0x1d4135!=='.'&&_0x1d4135!=='..');return _0x4d5d06;}export function listCheat(){const _0x468785=a0_0x311848,_0x1569f7=Module[_0x468785(0x232)]()[_0x468785(0x1df)](_0x297ce5=>_0x297ce5!=='.'&&_0x297ce5!=='..');return _0x1569f7;}export function listScreenshot(){const _0x5f3a5e=a0_0x311848,_0x210eae=Module[_0x5f3a5e(0x23a)]()['filter'](_0x470b0d=>_0x470b0d!=='.'&&_0x470b0d!=='..');return _0x210eae;}export function fileSize(_0x5d32d3){const _0x2860bc=a0_0x311848,_0x8b6e6f=Module[_0x2860bc(0x228)](_0x5d32d3);return _0x8b6e6f;}export async function uploadCheat(_0x6f2571){const _0x5c6569=a0_0x311848;try{const _0x9144fd=_0x6f2571[_0x5c6569(0x238)][0x0];await Module['uploadCheats'](_0x9144fd,()=>{const _0x35c644=_0x5c6569;console[_0x35c644(0x1f8)](_0x35c644(0x20c),_0x9144fd[_0x35c644(0x220)]),localStorageFile(),Module[_0x35c644(0x245)]();});}catch(_0x359e1b){console[_0x5c6569(0x233)](_0x5c6569(0x205),_0x359e1b);}}export async function uploadSavSta(_0x446888){const _0x3f2482=a0_0x311848;try{const _0x1d6110=_0x446888[_0x3f2482(0x238)][0x0];await Module[_0x3f2482(0x242)](_0x1d6110,()=>{const _0x49144d=_0x3f2482;console[_0x49144d(0x1f8)]('Save/State\x20uploaded\x20successfully:',_0x1d6110[_0x49144d(0x220)]),localStorageFile(),Module['FSSync']();});}catch(_0x2bbd3d){console['error'](_0x3f2482(0x211),_0x2bbd3d);}}export async function uploadSaveOrSaveState(_0x4327d4){const _0xa35949=a0_0x311848;Module[_0xa35949(0x242)](_0x4327d4,()=>{const _0x5a7991=_0xa35949;localStorageFile(),Module[_0x5a7991(0x245)]();});}export async function resumeGame(){const _0xdcf9ce=a0_0x311848;Module[_0xdcf9ce(0x1f1)](),Module[_0xdcf9ce(0x20b)](),notiMessage(_0xdcf9ce(0x21b),0x7d0);}export async function pauseGame(){const _0x573efb=a0_0x311848;Module[_0x573efb(0x201)](),Module[_0x573efb(0x20b)](),notiMessage(_0x573efb(0x1f3),0x7d0);}export async function buttonPress(_0x30ece2){const _0x4fbd8d=a0_0x311848;Module[_0x4fbd8d(0x20d)](_0x30ece2);}export async function buttonUnpress(_0xb87c3){const _0x5518f2=a0_0x311848;Module[_0x5518f2(0x237)](_0xb87c3);}export async function screenShot(_0x34e0af){const _0xbea1d3=a0_0x311848,_0x5bc485=localStorage['getItem'](_0xbea1d3(0x21d)),_0x5995d2=_0x5bc485[_0xbea1d3(0x20f)](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0xbea1d3(0x1f5)](''+_0x5995d2+_0x34e0af+'.png'),await Module[_0xbea1d3(0x245)]();const _0x1f0848=await fileToBase64(Module[_0xbea1d3(0x224)]('/data/screenshots/'+_0x5995d2+_0x34e0af+_0xbea1d3(0x210))),_0x35b6ad=Date[_0xbea1d3(0x1ec)](),_0x37622c=formatDateTime(_0x35b6ad);localStorage[_0xbea1d3(0x229)](_0x5bc485+_0xbea1d3(0x1e1)+_0x34e0af,_0x37622c),localStorage['setItem'](_0x5bc485+_0xbea1d3(0x1f6)+_0x34e0af,_0x1f0848);}export async function captureOCR(_0x148306){const _0x1869f8=a0_0x311848;Module[_0x1869f8(0x1f5)](_0x148306);const _0x163e64=Module[_0x1869f8(0x224)](_0x1869f8(0x1ee)+_0x148306);return _0x163e64;}export async function setFastForwardMultiplier(_0x14ed8b){const _0x533ff5=a0_0x311848;Module[_0x533ff5(0x21c)](_0x14ed8b);}export function uploadCheats(_0x1fea54,_0x406ba8,_0x1dcccc,_0x594176,_0x2d1861){const _0x93bde6=a0_0x311848;Module[_0x93bde6(0x22d)](_0x1fea54,()=>{const _0x13edaf=_0x93bde6;Module[_0x13edaf(0x1dc)](),setTimeout(()=>{const _0x528851=_0x13edaf;Module[_0x528851(0x245)]();},0x1f4),_0x594176&&(localStorage[_0x13edaf(0x229)](_0x406ba8+_0x13edaf(0x223),_0x1dcccc),notiMessage(_0x13edaf(0x244),0x5dc)),_0x2d1861[_0x13edaf(0x22f)]=localStorage[_0x13edaf(0x1da)](_0x406ba8+'_savedCheats'||_0x13edaf(0x217));});}