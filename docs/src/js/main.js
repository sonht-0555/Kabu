const a0_0x4c5fdf=a0_0x4f6f;(function(_0x4847d4,_0x1a9966){const _0x1bed0d=a0_0x4f6f,_0x4d2569=_0x4847d4();while(!![]){try{const _0x18e6e8=-parseInt(_0x1bed0d(0xb5))/0x1+-parseInt(_0x1bed0d(0xa3))/0x2+-parseInt(_0x1bed0d(0xe4))/0x3*(parseInt(_0x1bed0d(0x94))/0x4)+parseInt(_0x1bed0d(0xe6))/0x5+-parseInt(_0x1bed0d(0xb9))/0x6+parseInt(_0x1bed0d(0xf0))/0x7+parseInt(_0x1bed0d(0xf3))/0x8*(parseInt(_0x1bed0d(0xea))/0x9);if(_0x18e6e8===_0x1a9966)break;else _0x4d2569['push'](_0x4d2569['shift']());}catch(_0x5c0093){_0x4d2569['push'](_0x4d2569['shift']());}}}(a0_0x56e3,0x2021f));import a0_0x40c2d8 from'../core/mgba.js';import*as a0_0x340e99 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x4c5fdf(0xed)](a0_0x4c5fdf(0xa5))};function a0_0x4f6f(_0x4a1264,_0x4bd700){const _0x56e360=a0_0x56e3();return a0_0x4f6f=function(_0x4f6f41,_0x5a143b){_0x4f6f41=_0x4f6f41-0x90;let _0x524c33=_0x56e360[_0x4f6f41];return _0x524c33;},a0_0x4f6f(_0x4a1264,_0x4bd700);}function a0_0x56e3(){const _0x2f265d=['addEventListener','bottom','indexOf','image/png','persisted','add','visibilityState','downloadFile','0,0,','deleteFile','charCodeAt','No\x20screenshot!','onLine','169321SMwWhU','includes','Auto\x20save\x20','textContent','291900utNQuw','classList','loadState','uploadAll','slotStateSaved','revokeObjectURL','split','/data/screenshots/','setItem','saveState','FSInit','_savedCheats','screenshot','style','turboF','innerWidth','_dateState0','timer','application/octet-stream','resumeGame','buttonUnpress','body','_imageState0','gameName','gbc1','#20A5A6','/data/games/','_slot0.txt','encode','uploadRom','padStart','listRoms','visible','listStates','createElement','Cheat\x20Enabled!','click','.png','Unable\x20to\x20upload\x20to\x20Cloud!','loadGame','listScreenshots','control-setting','screenSize','1959qJvIRt','tEXtComment\x00','141035vjePCL','\x20time(s)','log','listCheats','549GOYFZX','fileSize','turboState','getElementById','now','createObjectURL','1784664pztsHO','set','filter','20312ahbIjs','pagehide','FSSync','buttonPress','Online!','type','beforeunload','208ABEkch','href','remove','Do\x20you\x20want\x20to\x20load\x20save\x20state?','replace','Resumed!','pauseGame','files','length','uId','disable','gbc','endsWith','then','toString','108992zsyasK','autoLoadCheats','canvas','SDL2','getItem'];a0_0x56e3=function(){return _0x2f265d;};return a0_0x56e3();}function initializeCore(_0x5c1598,_0x273aab){const _0x4b6fd2=a0_0x4c5fdf;_0x5c1598(_0x273aab)[_0x4b6fd2(0xa1)](function(_0x36ac7c){const _0x1785e3=_0x4b6fd2;_0x36ac7c[_0x1785e3(0xc3)]();});}initializeCore(a0_0x40c2d8,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x4c5fdf(0xed)]('canvas'),savedTurboState=localStorage['getItem'](a0_0x4c5fdf(0xec)),controlSetting=document[a0_0x4c5fdf(0xed)](a0_0x4c5fdf(0xe2));function handleVisibilityChange(_0x1932e3){const _0x3f9dd2=a0_0x4c5fdf;document[_0x3f9dd2(0xae)]==='hidden'||_0x1932e3?.[_0x3f9dd2(0x92)]===_0x3f9dd2(0x93)||_0x1932e3?.[_0x3f9dd2(0xac)]?(pauseGame(),canvas[_0x3f9dd2(0xba)][_0x3f9dd2(0xad)]('visible')):(setTimeout(()=>{const _0x28620b=_0x3f9dd2;canvas[_0x28620b(0xba)][_0x28620b(0x96)](_0x28620b(0xd9));},0x258),controlSetting[_0x3f9dd2(0xba)]['contains']('visible')&&resumeGame());}async function statusShow(){const _0x587ca5=a0_0x4c5fdf;document[_0x587ca5(0xa8)](_0x587ca5(0xf4),handleVisibilityChange),document[_0x587ca5(0xa8)]('visibilitychange',handleVisibilityChange),window[_0x587ca5(0xa8)](_0x587ca5(0x93),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x340e99[_0x587ca5(0xc7)](turboState)),await delay(0xc8),await Module[_0x587ca5(0xa6)](),await delay(0x320),await led(parseInt(localStorage[_0x587ca5(0xa7)](_0x587ca5(0xbd)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3c4ac6=a0_0x4c5fdf;await ledSave(_0x3c4ac6(0xd2)),await Module[_0x3c4ac6(0xc2)](0x0),await Module[_0x3c4ac6(0xf5)](),await screenShot(0x0),console[_0x3c4ac6(0xe8)](_0x3c4ac6(0xb7)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x31b834=a0_0x4c5fdf,_0x5b3089=localStorage[_0x31b834(0xa7)](_0x31b834(0xd0)),_0x43d65e=_0x5b3089[_0x31b834(0x98)](/\.(zip|gb|gbc|gba)$/,'.ss0'),_0xa33ff2=localStorage[_0x31b834(0xa7)](_0x31b834(0x9d)),_0x502bf3=localStorage[_0x31b834(0xa7)](_0x5b3089+_0x31b834(0xcf)),_0x17c056=localStorage[_0x31b834(0xa7)](_0x5b3089+_0x31b834(0xc9));if(navigator[_0x31b834(0xb4)]){if(_0xa33ff2){await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x43d65e,Module[_0x31b834(0xaf)]('/data/states/'+_0x43d65e));if(_0x502bf3!==null){const _0x31a598=_0x502bf3+'\x0a\x0a'+_0x17c056,_0x4ba910=new Blob([_0x31a598],{'type':'text/plain'});await dpUploadFile(_0x5b3089+_0x31b834(0xd4),_0x4ba910);}else console['log'](_0x31b834(0xb3));await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x31b834(0xe7),0x7d0);}else console[_0x31b834(0xe8)](_0x31b834(0xdf));}else console['log'](_0x31b834(0x91));}function startTimer(){let [_0x588fdc,_0x3e48d1,_0xab3718,_0x51da0c,_0x59fec8]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x28abc7=a0_0x4f6f;_0xab3718++,_0x51da0c++,_0x59fec8++;if(_0xab3718===0x3c)[_0xab3718,_0x3e48d1]=[0x0,_0x3e48d1+0x1];if(_0x3e48d1===0x3c)[_0x3e48d1,_0x588fdc]=[0x0,_0x588fdc+0x1];document[_0x28abc7(0xed)](_0x28abc7(0xca))['textContent']=_0x588fdc+'h'+_0x3e48d1[_0x28abc7(0xa2)]()[_0x28abc7(0xd7)](0x2,'0')+'.'+_0xab3718[_0x28abc7(0xa2)]()[_0x28abc7(0xd7)](0x2,'0');_0x51da0c===0x3c&&(saveStatePeriodically(),_0x51da0c=0x0);;_0x59fec8===0xe10&&(saveStateInCloud(),_0x59fec8=0x0);;},0x3e8);}export async function uploadGame(_0x345c9a){const _0x3b4fca=a0_0x4c5fdf,_0x4d33ec=_0x345c9a[_0x3b4fca(0x9b)][0x0];Module[_0x3b4fca(0xd6)](_0x4d33ec,()=>{const _0x2b0582=_0x3b4fca;Module[_0x2b0582(0xf5)]();});}export async function loadGame(_0x404f65){const _0x461be3=a0_0x4c5fdf,_0x42188e=_0x404f65['replace'](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x579b4b=Module['listStates']()[_0x461be3(0xf2)](_0x16fc5d=>_0x16fc5d!=='.'&&_0x16fc5d!=='..');intro[_0x461be3(0xba)][_0x461be3(0xad)](_0x461be3(0x9e)),errorLogElements[0x0][_0x461be3(0xc6)][_0x461be3(0xa9)]='0',ingame['classList']['remove'](_0x461be3(0x9e)),_0x404f65['endsWith']('.gbc')||_0x404f65[_0x461be3(0xa0)]('.gb')?(canvas[_0x461be3(0xba)]['add'](_0x461be3(0x9f)),areaTrans['classList'][_0x461be3(0xad)](_0x461be3(0xd1)),localStorage[_0x461be3(0xc1)](_0x461be3(0xe3),_0x461be3(0xb0)+(window[_0x461be3(0xc8)]-0xe6)+','+(window[_0x461be3(0xc8)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x461be3(0xe3),'0,0,'+(window[_0x461be3(0xc8)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x579b4b[_0x461be3(0xb6)](_0x42188e)?(await Module['loadGame'](_0x461be3(0xd3)+_0x404f65),confirm(_0x461be3(0x97))&&(await Module[_0x461be3(0xbb)](0x0),localStorage[_0x461be3(0xc1)]('gameName',_0x404f65),console[_0x461be3(0xe8)](_0x404f65))):(await Module[_0x461be3(0xe0)](_0x461be3(0xd3)+_0x404f65),localStorage[_0x461be3(0xc1)](_0x461be3(0xd0),_0x404f65),console[_0x461be3(0xe8)](_0x404f65)),await statusShow();}export async function saveState(_0x2bf650){const _0x172d4a=a0_0x4c5fdf;await Module[_0x172d4a(0xc2)](_0x2bf650),await Module[_0x172d4a(0xf5)]();}export async function loadState(_0x4236fb){await Module['loadState'](_0x4236fb);}export async function downloadFile(_0x1ceb8b,_0x5dca55){const _0x3e0105=a0_0x4c5fdf,_0x19c0c3=Module[_0x3e0105(0xaf)](_0x1ceb8b),_0x3fe39c=document[_0x3e0105(0xdb)]('a');document[_0x3e0105(0xce)]['appendChild'](_0x3fe39c),_0x3fe39c['download']=_0x5dca55;const _0x52dd6c=new Blob([_0x19c0c3],{'type':_0x3e0105(0xcb)});_0x3fe39c[_0x3e0105(0x95)]=URL[_0x3e0105(0xef)](_0x52dd6c),_0x3fe39c[_0x3e0105(0xdd)](),URL[_0x3e0105(0xbe)](_0x52dd6c),_0x3fe39c[_0x3e0105(0x96)]();}export function downloadFileInCloud(_0xd5ef38){const _0x1f5151=a0_0x4c5fdf,_0x755caa=Module[_0x1f5151(0xaf)](_0xd5ef38);return _0x755caa;}export async function uploadFile(_0x33ad4e){const _0xd34c27=a0_0x4c5fdf,_0x2e6594=_0x33ad4e[_0xd34c27(0x9b)][0x0];Module['uploadAll'](_0x2e6594,()=>{const _0x5171d1=_0xd34c27;localStorageFile(),Module[_0x5171d1(0xf5)]();});}export async function editFile(_0x5e832e,_0x1cb20d,_0x1f2311){const _0x23a5ee=a0_0x4c5fdf;await Module['editFileName'](_0x5e832e,_0x1cb20d,_0x1f2311),await Module[_0x23a5ee(0xf5)]();}export async function deleteFile(_0x30cbd4){const _0x1741f3=a0_0x4c5fdf;await Module[_0x1741f3(0xb1)](_0x30cbd4),await Module['FSSync']();}export function listGame(){const _0x410855=a0_0x4c5fdf,_0x3d02cb=Module[_0x410855(0xd8)]()[_0x410855(0xf2)](_0xd8dfa8=>_0xd8dfa8!=='.'&&_0xd8dfa8!=='..');return _0x3d02cb;}export function listSave(){const _0x5aa72c=Module['listSaves']()['filter'](_0x49a1b8=>_0x49a1b8!=='.'&&_0x49a1b8!=='..');return _0x5aa72c;}export function listState(){const _0x397aa4=a0_0x4c5fdf,_0x151b7d=Module[_0x397aa4(0xda)]()[_0x397aa4(0xf2)](_0x4cf432=>_0x4cf432!=='.'&&_0x4cf432!=='..');return _0x151b7d;}export function listCheat(){const _0x541080=a0_0x4c5fdf,_0x5b0c2b=Module[_0x541080(0xe9)]()['filter'](_0x35bd9d=>_0x35bd9d!=='.'&&_0x35bd9d!=='..');return _0x5b0c2b;}export function listScreenshot(){const _0x2e33dd=a0_0x4c5fdf,_0x5946e2=Module[_0x2e33dd(0xe1)]()[_0x2e33dd(0xf2)](_0x550d32=>_0x550d32!=='.'&&_0x550d32!=='..');return _0x5946e2;}export function embedTextInPngFile(_0x4c241f,_0x5ce4d1,_0x551495){const _0x557de7=a0_0x4c5fdf;let _0x2a2339=atob(_0x4c241f['split'](',')[0x1]),_0x2e65bb=new Uint8Array(_0x2a2339[_0x557de7(0x9c)]);for(let _0x5d3feb=0x0;_0x5d3feb<_0x2a2339[_0x557de7(0x9c)];_0x5d3feb++){_0x2e65bb[_0x5d3feb]=_0x2a2339[_0x557de7(0xb2)](_0x5d3feb);}let _0x4c95e0=new TextEncoder()[_0x557de7(0xd5)](_0x557de7(0xe5)+_0x5ce4d1),_0x41116b=new Uint8Array(_0x2e65bb[_0x557de7(0x9c)]+_0x4c95e0[_0x557de7(0x9c)]);_0x41116b[_0x557de7(0xf1)](_0x2e65bb,0x0),_0x41116b[_0x557de7(0xf1)](_0x4c95e0,_0x2e65bb['length']);let _0x54355b=new Blob([_0x41116b],{'type':'image/png'}),_0xa99b1a=new File([_0x54355b],_0x551495,{'type':_0x557de7(0xab)});return _0xa99b1a;}export function extractTextFromPngBase64(_0x18085e){const _0x316f2c=a0_0x4c5fdf;let _0x31e898=atob(_0x18085e[_0x316f2c(0xbf)](',')[0x1]),_0x525153=_0x316f2c(0xe5),_0x65bab2=_0x31e898[_0x316f2c(0xaa)](_0x525153);if(_0x65bab2!==-0x1)return _0x31e898['substring'](_0x65bab2+_0x525153['length']);return null;}export function fileSize(_0x2984f5){const _0x2baf18=a0_0x4c5fdf,_0x12edc7=Module[_0x2baf18(0xeb)](_0x2984f5);return _0x12edc7;}export async function resumeGame(){const _0x2eb508=a0_0x4c5fdf;Module[_0x2eb508(0xcc)](),Module[_0x2eb508(0xa6)](),notiMessage(_0x2eb508(0x99),0x7d0);}export async function pauseGame(){const _0x5dc423=a0_0x4c5fdf;Module[_0x5dc423(0x9a)](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x4e7a74){const _0x32d269=a0_0x4c5fdf;Module[_0x32d269(0x90)](_0x4e7a74);}export async function buttonUnpress(_0x4cf286){const _0x5c78eb=a0_0x4c5fdf;Module[_0x5c78eb(0xcd)](_0x4cf286);}export async function screenShot(_0x52af31){const _0x305de1=a0_0x4c5fdf,_0x1abd91=localStorage[_0x305de1(0xa7)](_0x305de1(0xd0))[_0x305de1(0x98)](/\.(gba|gbc|gb|zip)$/,''),_0x52a83b=_0x1abd91+'_'+_0x52af31+_0x305de1(0xde);await Module[_0x305de1(0xc5)](_0x52a83b),await Module[_0x305de1(0xf5)]();const _0x14e8b6=await fileToBase64(Module[_0x305de1(0xaf)](_0x305de1(0xc0)+_0x52a83b)),_0x18865f=embedTextInPngFile(_0x14e8b6,formatDateTime(Date[_0x305de1(0xee)]()),_0x52a83b);Module['uploadAll'](_0x18865f,()=>{localStorageFile(),Module['FSSync']();});}export async function dowloadScreenShot(_0x59963d){try{const _0x24b563=await fileToBase64(Module['downloadFile'](_0x59963d));return _0x24b563;}catch{}}export async function captureOCR(_0xb0d291){const _0x320fe1=a0_0x4c5fdf;Module['screenshot'](_0xb0d291);const _0x521725=Module[_0x320fe1(0xaf)](_0x320fe1(0xc0)+_0xb0d291);return _0x521725;}export async function setFastForwardMultiplier(_0x3ac89c){Module['setFastForwardMultiplier'](_0x3ac89c);}export function uploadCheats(_0x1b72a6,_0x178687,_0x292dab,_0xfe04d7,_0x263e79){const _0x6fe508=a0_0x4c5fdf;Module[_0x6fe508(0xbc)](_0x1b72a6,()=>{const _0x52895e=_0x6fe508;Module[_0x52895e(0xa4)](),setTimeout(()=>{const _0x55af1b=_0x52895e;Module[_0x55af1b(0xf5)]();},0x1f4),_0xfe04d7&&(localStorage[_0x52895e(0xc1)](_0x178687+'_savedCheats',_0x292dab),notiMessage(_0x52895e(0xdc),0x5dc)),_0x263e79[_0x52895e(0xb8)]=localStorage[_0x52895e(0xa7)](_0x178687+_0x52895e(0xc4)||'Off');});}