const a0_0x394dde=a0_0x3619;(function(_0x13f25a,_0x682f86){const _0x1fc4c4=a0_0x3619,_0x3ea8c2=_0x13f25a();while(!![]){try{const _0x548d96=-parseInt(_0x1fc4c4(0x1d3))/0x1+-parseInt(_0x1fc4c4(0x1d4))/0x2+-parseInt(_0x1fc4c4(0x1fe))/0x3*(-parseInt(_0x1fc4c4(0x218))/0x4)+-parseInt(_0x1fc4c4(0x1cf))/0x5+parseInt(_0x1fc4c4(0x1ca))/0x6+parseInt(_0x1fc4c4(0x1de))/0x7+parseInt(_0x1fc4c4(0x209))/0x8*(parseInt(_0x1fc4c4(0x205))/0x9);if(_0x548d96===_0x682f86)break;else _0x3ea8c2['push'](_0x3ea8c2['shift']());}catch(_0x39ea13){_0x3ea8c2['push'](_0x3ea8c2['shift']());}}}(a0_0x403d,0xb15ba));import a0_0x59c688 from'../core/mgba.js';import*as a0_0x4aa2a6 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x394dde(0x1da)](a0_0x394dde(0x1cb))};function initializeCore(_0xfb1023,_0x11eeea){const _0x40860c=a0_0x394dde;_0xfb1023(_0x11eeea)[_0x40860c(0x21c)](function(_0x2ab870){_0x2ab870['FSInit']();});}initializeCore(a0_0x59c688,Module);function a0_0x3619(_0x1bdde9,_0x3c0fe8){const _0x403d26=a0_0x403d();return a0_0x3619=function(_0x361991,_0xbd3f2e){_0x361991=_0x361991-0x1c9;let _0x4440d5=_0x403d26[_0x361991];return _0x4440d5;},a0_0x3619(_0x1bdde9,_0x3c0fe8);}let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document['getElementById'](a0_0x394dde(0x1cb)),savedTurboState=localStorage[a0_0x394dde(0x20e)](a0_0x394dde(0x215)),controlSetting=document[a0_0x394dde(0x1da)](a0_0x394dde(0x216));function handleVisibilityChange(_0x35a5bf){const _0x2c67cc=a0_0x394dde;document[_0x2c67cc(0x217)]===_0x2c67cc(0x208)||_0x35a5bf?.[_0x2c67cc(0x1e6)]===_0x2c67cc(0x1e8)||_0x35a5bf?.[_0x2c67cc(0x1e2)]?(pauseGame(),canvas[_0x2c67cc(0x230)][_0x2c67cc(0x1e3)](_0x2c67cc(0x213))):(setTimeout(()=>{const _0x4e505b=_0x2c67cc;canvas['classList']['remove'](_0x4e505b(0x213));},0x258),controlSetting['classList']['contains'](_0x2c67cc(0x213))&&resumeGame());}async function statusShow(){const _0x460302=a0_0x394dde;document[_0x460302(0x1ee)](_0x460302(0x22a),handleVisibilityChange),document['addEventListener'](_0x460302(0x1e0),handleVisibilityChange),window[_0x460302(0x1ee)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x4aa2a6[_0x460302(0x212)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x460302(0x20e)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0xbb4132=a0_0x394dde;await ledSave(_0xbb4132(0x223)),await Module[_0xbb4132(0x1f3)](0x0),await Module[_0xbb4132(0x1e7)](),await screenShot(0x0),console['log']('Auto\x20save\x20'+ ++countAutoSave+_0xbb4132(0x21f));}async function saveStateInCloud(){const _0x130053=a0_0x394dde,_0x4ed65d=localStorage['getItem'](_0x130053(0x1fd)),_0x5610e7=_0x4ed65d[_0x130053(0x1f5)]('.gba',_0x130053(0x1f7)),_0xaaf598=localStorage[_0x130053(0x20e)](_0x130053(0x1fa)),_0x49ea43=localStorage[_0x130053(0x20e)](_0x4ed65d+'_imageState0'),_0x28e7c7=localStorage[_0x130053(0x20e)](_0x4ed65d+_0x130053(0x202));if(navigator[_0x130053(0x200)]){if(_0xaaf598){await ledSave(_0x130053(0x1db)),await delay(0x3e8),await dpUploadFile(_0x5610e7,Module['downloadFile'](_0x130053(0x22d)+_0x5610e7));if(_0x49ea43!==null){const _0xd65ad=_0x49ea43+'\x0a\x0a'+_0x28e7c7,_0x3c0d21=new Blob([_0xd65ad],{'type':_0x130053(0x1ce)});await dpUploadFile(_0x4ed65d+'_slot0.txt',_0x3c0d21);}else console[_0x130053(0x20f)](_0x130053(0x1e1));await lockNoti('',_0x130053(0x1d6)+ ++countUpload+_0x130053(0x21f),0x7d0);}else console[_0x130053(0x20f)](_0x130053(0x1e5));}else console[_0x130053(0x20f)](_0x130053(0x227));}function startTimer(){let [_0xa45fbd,_0x1640ad,_0x14c09d,_0x328b79,_0x2ee9a8]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x45e688=a0_0x3619;_0x14c09d++,_0x328b79++,_0x2ee9a8++;if(_0x14c09d===0x3c)[_0x14c09d,_0x1640ad]=[0x0,_0x1640ad+0x1];if(_0x1640ad===0x3c)[_0x1640ad,_0xa45fbd]=[0x0,_0xa45fbd+0x1];document[_0x45e688(0x1da)](_0x45e688(0x1d8))[_0x45e688(0x203)]=_0xa45fbd+'h'+_0x1640ad['toString']()[_0x45e688(0x210)](0x2,'0')+'.'+_0x14c09d['toString']()['padStart'](0x2,'0');_0x328b79===0x3c&&(saveStatePeriodically(),_0x328b79=0x0);;_0x328b79===0xe10&&(saveStateInCloud(),_0x2ee9a8=0x0);;},0x3e8);}export async function uploadGame(_0x13e2c0){const _0x5dab42=a0_0x394dde,_0x158679=_0x13e2c0[_0x5dab42(0x1f8)][0x0];Module[_0x5dab42(0x225)](_0x158679,()=>{const _0x245669=_0x5dab42;Module[_0x245669(0x1e7)]();});}export async function loadGame(_0x16c40c){const _0x2214e6=a0_0x394dde,_0x2c1a39=_0x16c40c[_0x2214e6(0x1f5)](/\.(gba|gbc|gb|zip)$/,_0x2214e6(0x1f7)),_0x225c56=Module['listStates']();intro[_0x2214e6(0x230)]['add'](_0x2214e6(0x20c)),errorLogElements[0x0][_0x2214e6(0x1fc)][_0x2214e6(0x221)]='0',ingame[_0x2214e6(0x230)][_0x2214e6(0x1f6)](_0x2214e6(0x20c)),_0x16c40c[_0x2214e6(0x22f)](_0x2214e6(0x211))||_0x16c40c[_0x2214e6(0x22f)](_0x2214e6(0x207))?(canvas[_0x2214e6(0x230)]['add'](_0x2214e6(0x224)),areaTrans[_0x2214e6(0x230)][_0x2214e6(0x1e3)]('gbc1'),localStorage[_0x2214e6(0x1dc)](_0x2214e6(0x1ff),'0,0,'+(window[_0x2214e6(0x1e4)]-0xe6)+','+(window[_0x2214e6(0x1e4)]-0xe6)*0x9/0xa)):localStorage[_0x2214e6(0x1dc)](_0x2214e6(0x1ff),_0x2214e6(0x1ef)+(window[_0x2214e6(0x1e4)]-0x96)+','+(window[_0x2214e6(0x1e4)]-0x96)*0x2/0x3),_0x225c56[_0x2214e6(0x21a)](_0x2c1a39)?(await Module[_0x2214e6(0x21e)](_0x2214e6(0x1d9)+_0x16c40c),confirm(_0x2214e6(0x1d7))&&(await Module[_0x2214e6(0x229)](0x0),localStorage['setItem'](_0x2214e6(0x1fd),_0x16c40c),console[_0x2214e6(0x20f)](_0x16c40c))):(await Module['loadGame']('/data/games/'+_0x16c40c),localStorage['setItem'](_0x2214e6(0x1fd),_0x16c40c)),await statusShow();}function a0_0x403d(){const _0x4a9801=['buttonUnpress','href','/data/states/','Cheat\x20Enabled!','endsWith','classList','listScreenshots','Resumed!','downloadFile','1587510KFsKRb','canvas','Error\x20uploadSavSta:','/data/screenshots/','text/plain','2748960EtqPAo','pauseGame','Paused!','autoLoadCheats','416461DuqXTU','369214aiEKhW','screenshot','Cloud\x20upload\x20','Do\x20you\x20want\x20to\x20load\x20save\x20state?','timer','/data/games/','getElementById','#E0C068','setItem','Error\x20uploadCheat:','352856NlXXLo','_imageState','visibilitychange','No\x20screenshot!','persisted','add','innerWidth','Unable\x20to\x20upload\x20to\x20Cloud!','type','FSSync','beforeunload','name','revokeObjectURL','uploadSaveOrSaveState','Cheat\x20uploaded\x20successfully:','Save/State\x20uploaded\x20successfully:','addEventListener','0,0,','createElement','listCheats','createObjectURL','saveState','application/octet-stream','replace','remove','.ss0','files','.png','uId','body','style','gameName','471ooiLBF','screenSize','onLine','listStates','_dateState0','textContent','now','2266614qTwEqS','_savedCheats','.gb','hidden','8jBXLXw','listGames','setFastForwardMultiplier','disable','Off','getItem','log','padStart','.gbc','turboF','visible','deleteFile','turboState','control-setting','visibilityState','33388Lijoxp','SDL2','includes','buttonPress','then','fileSize','loadGame','\x20time(s)','error','bottom','editFileName','#20A5A6','gbc','uploadRom','_dateState','Online!','uploadCheats','loadState','pagehide'];a0_0x403d=function(){return _0x4a9801;};return a0_0x403d();}export async function saveState(_0x5d13f1){const _0xa60a52=a0_0x394dde;await Module[_0xa60a52(0x1f3)](_0x5d13f1),await Module[_0xa60a52(0x1e7)]();}export async function loadState(_0x30e4e8){const _0x2a20e5=a0_0x394dde;await Module[_0x2a20e5(0x229)](_0x30e4e8);}export async function downloadFile(_0x2cb0bb,_0xe6c0dd){const _0x5db706=a0_0x394dde,_0x4efdcf=Module[_0x5db706(0x1c9)](_0x2cb0bb),_0xb14bf3=document[_0x5db706(0x1f0)]('a');document[_0x5db706(0x1fb)]['appendChild'](_0xb14bf3),_0xb14bf3['download']=_0xe6c0dd;const _0x3ff501=new Blob([_0x4efdcf],{'type':_0x5db706(0x1f4)});_0xb14bf3[_0x5db706(0x22c)]=URL[_0x5db706(0x1f2)](_0x3ff501),_0xb14bf3['click'](),URL[_0x5db706(0x1ea)](_0x3ff501),_0xb14bf3[_0x5db706(0x1f6)]();}export function downloadFileInCloud(_0x235150){const _0x53e91c=Module['downloadFile'](_0x235150);return _0x53e91c;}export async function uploadFile(_0x2131fc){const _0x5d3871=a0_0x394dde,_0x2db2cc=_0x2131fc['files'][0x0];Module[_0x5d3871(0x1eb)](_0x2db2cc,()=>{const _0x10e7ae=_0x5d3871;Module[_0x10e7ae(0x1e7)]();});}export async function editFile(_0x46da7e,_0x5f3499,_0x1d847d){const _0x17416c=a0_0x394dde;await Module[_0x17416c(0x222)](_0x46da7e,_0x5f3499,_0x1d847d),await Module[_0x17416c(0x1e7)]();}export async function deleteFile(_0x3d92e7){const _0x15dd81=a0_0x394dde;await Module[_0x15dd81(0x214)](_0x3d92e7),await Module['FSSync']();}export function listGame(){const _0x5604e6=a0_0x394dde,_0x12eac3=Module[_0x5604e6(0x20a)]();return _0x12eac3;}export function listSave(){const _0x3bb9b0=Module['listSaves']();return _0x3bb9b0;}export function listState(){const _0x434b8f=a0_0x394dde,_0x4a6397=Module[_0x434b8f(0x201)]();return _0x4a6397;}export function listCheat(){const _0x4ccf5c=a0_0x394dde,_0x4a51ee=Module[_0x4ccf5c(0x1f1)]();return _0x4a51ee;}export function listScreenshot(){const _0x2ca07b=a0_0x394dde,_0x4857e7=Module[_0x2ca07b(0x231)]();return _0x4857e7;}export function fileSize(_0x296950){const _0x383ab9=a0_0x394dde,_0x3a738d=Module[_0x383ab9(0x21d)](_0x296950);return _0x3a738d;}export async function uploadCheat(_0x52aa44){const _0x5e4126=a0_0x394dde;try{const _0x568a8b=_0x52aa44[_0x5e4126(0x1f8)][0x0];await Module[_0x5e4126(0x228)](_0x568a8b,()=>{const _0x249535=_0x5e4126;console[_0x249535(0x20f)](_0x249535(0x1ec),_0x568a8b[_0x249535(0x1e9)]),localStorageFile(),Module[_0x249535(0x1e7)]();});}catch(_0x1311a4){console[_0x5e4126(0x220)](_0x5e4126(0x1dd),_0x1311a4);}}export async function uploadSavSta(_0x251b2b){const _0x24116e=a0_0x394dde;try{const _0x2785a9=_0x251b2b[_0x24116e(0x1f8)][0x0];await Module[_0x24116e(0x1eb)](_0x2785a9,()=>{const _0x3d7097=_0x24116e;console[_0x3d7097(0x20f)](_0x3d7097(0x1ed),_0x2785a9['name']),localStorageFile(),Module['FSSync']();});}catch(_0x54895e){console['error'](_0x24116e(0x1cc),_0x54895e);}}export async function uploadSaveOrSaveState(_0x9be9c3){const _0x75aa47=a0_0x394dde;Module[_0x75aa47(0x1eb)](_0x9be9c3,()=>{const _0x50e36c=_0x75aa47;localStorageFile(),Module[_0x50e36c(0x1e7)]();});}export async function resumeGame(){const _0x1a73a9=a0_0x394dde;Module['resumeGame'](),Module[_0x1a73a9(0x219)](),notiMessage(_0x1a73a9(0x232),0x7d0);}export async function pauseGame(){const _0x59168c=a0_0x394dde;Module[_0x59168c(0x1d0)](),Module[_0x59168c(0x219)](),notiMessage(_0x59168c(0x1d1),0x7d0);}export async function buttonPress(_0x30b6aa){const _0x2c0fae=a0_0x394dde;Module[_0x2c0fae(0x21b)](_0x30b6aa);}export async function buttonUnpress(_0x1d364d){const _0x505591=a0_0x394dde;Module[_0x505591(0x22b)](_0x1d364d);}export async function screenShot(_0x10f0ff){const _0x4fd93f=a0_0x394dde,_0x5c8509=localStorage[_0x4fd93f(0x20e)](_0x4fd93f(0x1fd)),_0x332492=_0x5c8509['replace'](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x4fd93f(0x1d5)](''+_0x332492+_0x10f0ff+_0x4fd93f(0x1f9)),await Module[_0x4fd93f(0x1e7)]();const _0x16ed09=await fileToBase64(Module[_0x4fd93f(0x1c9)](_0x4fd93f(0x1cd)+_0x332492+_0x10f0ff+'.png')),_0x2cc9d0=Date[_0x4fd93f(0x204)](),_0xf4acee=formatDateTime(_0x2cc9d0);localStorage[_0x4fd93f(0x1dc)](_0x5c8509+_0x4fd93f(0x226)+_0x10f0ff,_0xf4acee),localStorage[_0x4fd93f(0x1dc)](_0x5c8509+_0x4fd93f(0x1df)+_0x10f0ff,_0x16ed09);}export async function captureOCR(_0xa92144){const _0xb6f2ce=a0_0x394dde;Module[_0xb6f2ce(0x1d5)](_0xa92144);const _0x447522=Module[_0xb6f2ce(0x1c9)](_0xb6f2ce(0x1cd)+_0xa92144);return _0x447522;}export async function setFastForwardMultiplier(_0x10f88d){const _0x199c79=a0_0x394dde;Module[_0x199c79(0x20b)](_0x10f88d);}export function uploadCheats(_0xcaf1a4,_0x55be87,_0x420e75,_0x294e08,_0x10d937){const _0x2f2e1e=a0_0x394dde;Module[_0x2f2e1e(0x228)](_0xcaf1a4,()=>{const _0x3feda8=_0x2f2e1e;Module[_0x3feda8(0x1d2)](),setTimeout(()=>{const _0x299293=_0x3feda8;Module[_0x299293(0x1e7)]();},0x1f4),_0x294e08&&(localStorage['setItem'](_0x55be87+_0x3feda8(0x206),_0x420e75),notiMessage(_0x3feda8(0x22e),0x5dc)),_0x10d937['textContent']=localStorage['getItem'](_0x55be87+_0x3feda8(0x206)||_0x3feda8(0x20d));});}