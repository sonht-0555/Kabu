const a0_0x37f798=a0_0x4672;(function(_0x17812b,_0x3ae22a){const _0x1d5ac1=a0_0x4672,_0x13d07a=_0x17812b();while(!![]){try{const _0x2255c1=-parseInt(_0x1d5ac1(0x153))/0x1*(-parseInt(_0x1d5ac1(0x139))/0x2)+parseInt(_0x1d5ac1(0x115))/0x3*(parseInt(_0x1d5ac1(0x143))/0x4)+-parseInt(_0x1d5ac1(0x15a))/0x5+parseInt(_0x1d5ac1(0x161))/0x6+parseInt(_0x1d5ac1(0x157))/0x7*(parseInt(_0x1d5ac1(0x10a))/0x8)+parseInt(_0x1d5ac1(0x168))/0x9+-parseInt(_0x1d5ac1(0x116))/0xa*(parseInt(_0x1d5ac1(0x12a))/0xb);if(_0x2255c1===_0x3ae22a)break;else _0x13d07a['push'](_0x13d07a['shift']());}catch(_0x73acf7){_0x13d07a['push'](_0x13d07a['shift']());}}}(a0_0x55e0,0x3e4a8));import a0_0xcf9c07 from'../core/mgba.js';import*as a0_0x17a92b from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0x37f798(0x132))};function initializeCore(_0x3cc485,_0x571331){const _0xb8ae69=a0_0x37f798;_0x3cc485(_0x571331)[_0xb8ae69(0x140)](function(_0x11c07e){const _0x5b2396=_0xb8ae69;_0x11c07e[_0x5b2396(0x127)]();});}initializeCore(a0_0xcf9c07,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x37f798(0x16b)]('canvas'),savedTurboState=localStorage['getItem'](a0_0x37f798(0x133)),controlSetting=document[a0_0x37f798(0x16b)](a0_0x37f798(0x134));function handleVisibilityChange(_0x237d95){const _0x44fbff=a0_0x37f798;document['visibilityState']===_0x44fbff(0x15c)||_0x237d95?.['type']===_0x44fbff(0x10c)||_0x237d95?.['persisted']?(pauseGame(),canvas['classList'][_0x44fbff(0x123)](_0x44fbff(0x149))):(setTimeout(()=>{const _0x5b8d4a=_0x44fbff;canvas[_0x5b8d4a(0x145)][_0x5b8d4a(0x156)](_0x5b8d4a(0x149));},0x258),controlSetting['classList'][_0x44fbff(0x10b)](_0x44fbff(0x149))&&resumeGame());}async function statusShow(){const _0x878bdb=a0_0x37f798;document[_0x878bdb(0x16c)](_0x878bdb(0x10e),handleVisibilityChange),document[_0x878bdb(0x16c)](_0x878bdb(0x148),handleVisibilityChange),window['addEventListener'](_0x878bdb(0x10c),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x17a92b[_0x878bdb(0x154)](turboState)),await delay(0x3e8),await led(parseInt(localStorage['getItem'](_0x878bdb(0x128)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0xc60a44=a0_0x37f798;await ledSave(_0xc60a44(0x122)),await Module[_0xc60a44(0x12f)](0x0),await Module[_0xc60a44(0x16d)](),await screenShot(0x0),console['log'](_0xc60a44(0x129)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x2034bc=a0_0x37f798,_0x440c27=localStorage[_0x2034bc(0x10d)]('gameName'),_0x312d37=_0x440c27[_0x2034bc(0x118)](_0x2034bc(0x121),_0x2034bc(0x124)),_0x4a4757=localStorage[_0x2034bc(0x10d)]('uId'),_0x41bdfc=localStorage[_0x2034bc(0x10d)](_0x440c27+'_imageState0'),_0xf4abac=localStorage[_0x2034bc(0x10d)](_0x440c27+_0x2034bc(0x142));if(navigator[_0x2034bc(0x14c)]){if(_0x4a4757){await ledSave(_0x2034bc(0x13f)),await delay(0x3e8),await dpUploadFile(_0x312d37,Module[_0x2034bc(0x16a)](_0x2034bc(0x13a)+_0x312d37));if(_0x41bdfc!==null){const _0xd7abdd=_0x41bdfc+'\x0a\x0a'+_0xf4abac,_0x388e21=new Blob([_0xd7abdd],{'type':_0x2034bc(0x152)});await dpUploadFile(_0x440c27+_0x2034bc(0x130),_0x388e21);}else console[_0x2034bc(0x136)](_0x2034bc(0x14d));await lockNoti('',_0x2034bc(0x14a)+ ++countUpload+_0x2034bc(0x147),0x7d0);}else console[_0x2034bc(0x136)](_0x2034bc(0x117));}else console[_0x2034bc(0x136)](_0x2034bc(0x15e));}function startTimer(){let [_0x3acf09,_0x25a204,_0x3de707,_0x56b100,_0x4ec01e]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x10631f=a0_0x4672;_0x3de707++,_0x56b100++,_0x4ec01e++;if(_0x3de707===0x3c)[_0x3de707,_0x25a204]=[0x0,_0x25a204+0x1];if(_0x25a204===0x3c)[_0x25a204,_0x3acf09]=[0x0,_0x3acf09+0x1];document[_0x10631f(0x16b)]('timer')['textContent']=_0x3acf09+'h'+_0x25a204['toString']()['padStart'](0x2,'0')+'.'+_0x3de707['toString']()[_0x10631f(0x125)](0x2,'0');_0x56b100===0x3c&&(saveStatePeriodically(),_0x56b100=0x0);;_0x56b100===0xe10&&(saveStateInCloud(),_0x4ec01e=0x0);;},0x3e8);}export async function uploadGame(_0x17046e){const _0x26fc83=a0_0x37f798,_0x2e5f50=_0x17046e[_0x26fc83(0x131)][0x0];Module['uploadRom'](_0x2e5f50,()=>{const _0x30fd56=_0x26fc83;Module[_0x30fd56(0x16d)]();});}export async function loadGame(_0x39040a){const _0x22a016=a0_0x37f798,_0x426ea8=_0x39040a[_0x22a016(0x118)](/\.(gba|gbc|gb|zip)$/,_0x22a016(0x124)),_0x298d65=Module[_0x22a016(0x13e)]();intro[_0x22a016(0x145)][_0x22a016(0x123)](_0x22a016(0x151)),errorLogElements[0x0][_0x22a016(0x155)][_0x22a016(0x110)]='0',ingame['classList']['remove']('disable'),_0x39040a['endsWith'](_0x22a016(0x13b))||_0x39040a[_0x22a016(0x15d)]('.gb')?(canvas[_0x22a016(0x145)][_0x22a016(0x123)](_0x22a016(0x16e)),areaTrans[_0x22a016(0x145)]['add'](_0x22a016(0x10f)),localStorage[_0x22a016(0x114)](_0x22a016(0x112),'0,0,'+(window[_0x22a016(0x162)]-0xe6)+','+(window[_0x22a016(0x162)]-0xe6)*0x9/0xa)):localStorage['setItem']('screenSize','0,0,'+(window[_0x22a016(0x162)]-0x96)+','+(window[_0x22a016(0x162)]-0x96)*0x2/0x3),_0x298d65[_0x22a016(0x167)](_0x426ea8)?(await Module['loadGame'](_0x22a016(0x166)+_0x39040a),confirm(_0x22a016(0x141))&&(await Module['loadState'](0x0),localStorage[_0x22a016(0x114)]('gameName',_0x39040a),console[_0x22a016(0x136)](_0x39040a))):(await Module[_0x22a016(0x137)](_0x22a016(0x166)+_0x39040a),localStorage[_0x22a016(0x114)]('gameName',_0x39040a)),await statusShow();}export async function saveState(_0x5c15e7){const _0xb577df=a0_0x37f798;await Module[_0xb577df(0x12f)](_0x5c15e7),await Module['FSSync']();}export async function loadState(_0x3b86c7){const _0xe969c9=a0_0x37f798;await Module[_0xe969c9(0x119)](_0x3b86c7);}export async function downloadFile(_0x3716e8,_0x7e94c9){const _0x3e652b=a0_0x37f798,_0x23ec91=Module[_0x3e652b(0x16a)](_0x3716e8),_0x458744=document[_0x3e652b(0x11e)]('a');document[_0x3e652b(0x158)]['appendChild'](_0x458744),_0x458744['download']=_0x7e94c9;const _0xf256c8=new Blob([_0x23ec91],{'type':_0x3e652b(0x12e)});_0x458744[_0x3e652b(0x14b)]=URL[_0x3e652b(0x13d)](_0xf256c8),_0x458744['click'](),URL['revokeObjectURL'](_0xf256c8),_0x458744['remove']();}export function downloadFileInCloud(_0x172b01){const _0x3a4368=a0_0x37f798,_0x9d24f=Module[_0x3a4368(0x16a)](_0x172b01);return _0x9d24f;}export async function uploadFile(_0x2ad8f5){const _0xe0bc3a=_0x2ad8f5['files'][0x0];Module['uploadSaveOrSaveState'](_0xe0bc3a,()=>{const _0x1e66e9=a0_0x4672;Module[_0x1e66e9(0x16d)]();});}export async function editFile(_0x112a41,_0xa0e589,_0x3da715){const _0x5a349a=a0_0x37f798;await Module['editFileName'](_0x112a41,_0xa0e589,_0x3da715),await Module[_0x5a349a(0x16d)]();}export async function deleteFile(_0x5d75bb){const _0x24d38e=a0_0x37f798;await Module[_0x24d38e(0x163)](_0x5d75bb),await Module[_0x24d38e(0x16d)]();}export function listGame(){const _0x1f82ab=a0_0x37f798,_0x1c0c19=Module[_0x1f82ab(0x169)]();return _0x1c0c19;}function a0_0x55e0(){const _0x5529aa=['loadState','Cheat\x20uploaded\x20successfully:','fileSize','SDL2','Resumed!','createElement','_dateState','Paused!','.gba','#20A5A6','add','.ss0','padStart','name','FSInit','slotStateSaved','Auto\x20save\x20','119724cvHDST','Cheat\x20Enabled!','buttonUnpress','Error\x20uploadCheat:','application/octet-stream','saveState','_slot0.txt','files','canvas','turboState','control-setting','Off','log','loadGame','listCheats','3746BxMuWA','/data/states/','.gbc','buttonPress','createObjectURL','listStates','#E0C068','then','Do\x20you\x20want\x20to\x20load\x20save\x20state?','_dateState0','308848TvkeTg','gameName','classList','screenshot','\x20time(s)','visibilitychange','visible','Cloud\x20upload\x20','href','onLine','No\x20screenshot!','error','resumeGame','.png','disable','text/plain','269EpoARD','turboF','style','remove','212058ZxGlpn','body','listSaves','1373205weAFpv','uploadSaveOrSaveState','hidden','endsWith','Online!','_imageState','/data/screenshots/','1106622aQExHn','innerWidth','deleteFile','_savedCheats','listScreenshots','/data/games/','includes','3682557AOBBAM','listGames','downloadFile','getElementById','addEventListener','FSSync','gbc','120CrukbU','contains','beforeunload','getItem','pagehide','gbc1','bottom','textContent','screenSize','uploadCheats','setItem','3YggdkL','1010SBybEc','Unable\x20to\x20upload\x20to\x20Cloud!','replace'];a0_0x55e0=function(){return _0x5529aa;};return a0_0x55e0();}export function listSave(){const _0x1e1ce2=a0_0x37f798,_0x291433=Module[_0x1e1ce2(0x159)]();return _0x291433;}export function listState(){const _0x423de6=Module['listStates']();return _0x423de6;}export function listCheat(){const _0x40614f=a0_0x37f798,_0x1d488a=Module[_0x40614f(0x138)]();return _0x1d488a;}export function listScreenshot(){const _0x26c6b0=a0_0x37f798,_0x18a543=Module[_0x26c6b0(0x165)]();return _0x18a543;}export function fileSize(_0x2e34be){const _0x3fca51=a0_0x37f798,_0x40d3e0=Module[_0x3fca51(0x11b)](_0x2e34be);return _0x40d3e0;}export async function uploadCheat(_0x2c1f70){const _0xeae171=a0_0x37f798;try{const _0x113f3f=_0x2c1f70['files'][0x0];await Module[_0xeae171(0x113)](_0x113f3f,()=>{const _0x26a1ee=_0xeae171;console[_0x26a1ee(0x136)](_0x26a1ee(0x11a),_0x113f3f[_0x26a1ee(0x126)]),localStorageFile(),Module[_0x26a1ee(0x16d)]();});}catch(_0x1b8c25){console[_0xeae171(0x14e)](_0xeae171(0x12d),_0x1b8c25);}}export async function uploadSavSta(_0x249035){const _0x3c25cf=a0_0x37f798;try{const _0x30b6c6=_0x249035[_0x3c25cf(0x131)][0x0];await Module['uploadSaveOrSaveState'](_0x30b6c6,()=>{const _0x278f91=_0x3c25cf;console[_0x278f91(0x136)]('Save/State\x20uploaded\x20successfully:',_0x30b6c6[_0x278f91(0x126)]),localStorageFile(),Module['FSSync']();});}catch(_0x51fc52){console['error']('Error\x20uploadSavSta:',_0x51fc52);}}export async function uploadSaveOrSaveState(_0x2b88bb){const _0x1fa731=a0_0x37f798;Module[_0x1fa731(0x15b)](_0x2b88bb,()=>{const _0x8405c3=_0x1fa731;localStorageFile(),Module[_0x8405c3(0x16d)]();});}export async function resumeGame(){const _0x1fffc2=a0_0x37f798;Module[_0x1fffc2(0x14f)](),Module[_0x1fffc2(0x11c)](),notiMessage(_0x1fffc2(0x11d),0x7d0);}export async function pauseGame(){const _0xf53298=a0_0x37f798;Module['pauseGame'](),Module[_0xf53298(0x11c)](),notiMessage(_0xf53298(0x120),0x7d0);}export async function buttonPress(_0x4c9e9a){const _0x3af9f0=a0_0x37f798;Module[_0x3af9f0(0x13c)](_0x4c9e9a);}export async function buttonUnpress(_0x28679c){const _0x58aec1=a0_0x37f798;Module[_0x58aec1(0x12c)](_0x28679c);}export async function screenShot(_0x1d484c){const _0x162042=a0_0x37f798,_0x3fea86=localStorage[_0x162042(0x10d)](_0x162042(0x144)),_0x38e2bc=_0x3fea86['replace'](/\.(gba|gbc|gb|zip)$/,'_');await Module['screenshot'](''+_0x38e2bc+_0x1d484c+_0x162042(0x150)),await Module[_0x162042(0x16d)]();const _0x1f057e=await fileToBase64(Module['downloadFile']('/data/screenshots/'+_0x38e2bc+_0x1d484c+'.png')),_0x1af7e7=Date['now'](),_0x55824d=formatDateTime(_0x1af7e7);localStorage[_0x162042(0x114)](_0x3fea86+_0x162042(0x11f)+_0x1d484c,_0x55824d),localStorage[_0x162042(0x114)](_0x3fea86+_0x162042(0x15f)+_0x1d484c,_0x1f057e);}export async function captureOCR(_0x347ea6){const _0xa0b238=a0_0x37f798;Module[_0xa0b238(0x146)](_0x347ea6);const _0x193e50=Module[_0xa0b238(0x16a)](_0xa0b238(0x160)+_0x347ea6);return _0x193e50;}export async function setFastForwardMultiplier(_0x494474){Module['setFastForwardMultiplier'](_0x494474);}function a0_0x4672(_0x1c86f9,_0xe5b12b){const _0x55e036=a0_0x55e0();return a0_0x4672=function(_0x4672c0,_0x287cbc){_0x4672c0=_0x4672c0-0x10a;let _0x4e0fd7=_0x55e036[_0x4672c0];return _0x4e0fd7;},a0_0x4672(_0x1c86f9,_0xe5b12b);}export function uploadCheats(_0x237b10,_0x232ae5,_0x4efaca,_0x43f60e,_0x35b8a8){const _0x35f4ca=a0_0x37f798;Module[_0x35f4ca(0x113)](_0x237b10,()=>{const _0x40e0ec=_0x35f4ca;Module['autoLoadCheats'](),setTimeout(()=>{const _0x12c5a8=a0_0x4672;Module[_0x12c5a8(0x16d)]();},0x1f4),_0x43f60e&&(localStorage[_0x40e0ec(0x114)](_0x232ae5+_0x40e0ec(0x164),_0x4efaca),notiMessage(_0x40e0ec(0x12b),0x5dc)),_0x35b8a8[_0x40e0ec(0x111)]=localStorage[_0x40e0ec(0x10d)](_0x232ae5+_0x40e0ec(0x164)||_0x40e0ec(0x135));});}