const a0_0x4cdf54=a0_0x5167;(function(_0x413f53,_0x3a7b3b){const _0x36427e=a0_0x5167,_0x2a5f1e=_0x413f53();while(!![]){try{const _0x32e3c5=parseInt(_0x36427e(0x231))/0x1*(parseInt(_0x36427e(0x249))/0x2)+-parseInt(_0x36427e(0x233))/0x3+-parseInt(_0x36427e(0x21d))/0x4*(parseInt(_0x36427e(0x218))/0x5)+parseInt(_0x36427e(0x20e))/0x6+parseInt(_0x36427e(0x244))/0x7+-parseInt(_0x36427e(0x23f))/0x8*(parseInt(_0x36427e(0x1ee))/0x9)+-parseInt(_0x36427e(0x20d))/0xa*(-parseInt(_0x36427e(0x21a))/0xb);if(_0x32e3c5===_0x3a7b3b)break;else _0x2a5f1e['push'](_0x2a5f1e['shift']());}catch(_0x54b651){_0x2a5f1e['push'](_0x2a5f1e['shift']());}}}(a0_0x2d84,0xa82a4));import a0_0x4814c8 from'../core/mgba.js';import*as a0_0x31b96e from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document['getElementById'](a0_0x4cdf54(0x22d))};function initializeCore(_0x512f96,_0x324f27){_0x512f96(_0x324f27)['then'](function(_0x124cb6){_0x124cb6['FSInit']();});}initializeCore(a0_0x4814c8,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x4cdf54(0x241)](a0_0x4cdf54(0x22d)),savedTurboState=localStorage[a0_0x4cdf54(0x1fe)]('turboState'),controlSetting=document[a0_0x4cdf54(0x241)](a0_0x4cdf54(0x234));function handleVisibilityChange(_0x3b6075){const _0x13d410=a0_0x4cdf54;document[_0x13d410(0x23a)]===_0x13d410(0x203)||_0x3b6075?.[_0x13d410(0x223)]===_0x13d410(0x210)||_0x3b6075?.['persisted']?(pauseGame(),canvas[_0x13d410(0x1f4)][_0x13d410(0x23d)](_0x13d410(0x239))):(setTimeout(()=>{const _0x1f8b8a=_0x13d410;canvas[_0x1f8b8a(0x1f4)][_0x1f8b8a(0x21c)](_0x1f8b8a(0x239));},0x258),controlSetting['classList'][_0x13d410(0x22c)](_0x13d410(0x239))&&resumeGame());}async function statusShow(){const _0x26c62a=a0_0x4cdf54;document[_0x26c62a(0x232)](_0x26c62a(0x1e7),handleVisibilityChange),document['addEventListener'](_0x26c62a(0x204),handleVisibilityChange),window[_0x26c62a(0x232)](_0x26c62a(0x210),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x31b96e[_0x26c62a(0x214)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x26c62a(0x1fe)](_0x26c62a(0x237)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x4435c1=a0_0x4cdf54;await ledSave(_0x4435c1(0x201)),await Module[_0x4435c1(0x1fd)](0x0),await Module[_0x4435c1(0x216)](),await screenShot(0x0),console[_0x4435c1(0x1f1)](_0x4435c1(0x209)+ ++countAutoSave+_0x4435c1(0x1f9));}async function saveStateInCloud(){const _0x4c0da2=a0_0x4cdf54,_0x2c2dbf=localStorage[_0x4c0da2(0x1fe)]('gameName'),_0x571a32=_0x2c2dbf['replace'](_0x4c0da2(0x1e6),_0x4c0da2(0x21f)),_0x2b1c19=localStorage[_0x4c0da2(0x1fe)](_0x4c0da2(0x227)),_0x71a20a=localStorage['getItem'](_0x2c2dbf+_0x4c0da2(0x205)),_0x48731c=localStorage['getItem'](_0x2c2dbf+_0x4c0da2(0x224));if(navigator[_0x4c0da2(0x217)]){if(_0x2b1c19){await ledSave(_0x4c0da2(0x243)),await delay(0x3e8),await dpUploadFile(_0x571a32,Module['downloadFile']('/data/states/'+_0x571a32));if(_0x71a20a!==null){const _0x3826fe=_0x71a20a+'\x0a\x0a'+_0x48731c,_0x358ddb=new Blob([_0x3826fe],{'type':_0x4c0da2(0x238)});await dpUploadFile(_0x2c2dbf+_0x4c0da2(0x1f6),_0x358ddb);}else console[_0x4c0da2(0x1f1)](_0x4c0da2(0x213));await lockNoti('',_0x4c0da2(0x221)+ ++countUpload+_0x4c0da2(0x1f9),0x7d0);}else console[_0x4c0da2(0x1f1)](_0x4c0da2(0x219));}else console[_0x4c0da2(0x1f1)](_0x4c0da2(0x222));}function startTimer(){let [_0x5e370f,_0x196f61,_0xfd7c81,_0x36ab34,_0x2e0e9c]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x2e75fa=a0_0x5167;_0xfd7c81++,_0x36ab34++,_0x2e0e9c++;if(_0xfd7c81===0x3c)[_0xfd7c81,_0x196f61]=[0x0,_0x196f61+0x1];if(_0x196f61===0x3c)[_0x196f61,_0x5e370f]=[0x0,_0x5e370f+0x1];document[_0x2e75fa(0x241)]('timer')[_0x2e75fa(0x242)]=_0x5e370f+'h'+_0x196f61['toString']()[_0x2e75fa(0x1fc)](0x2,'0')+'.'+_0xfd7c81[_0x2e75fa(0x248)]()[_0x2e75fa(0x1fc)](0x2,'0');_0x36ab34===0x3c&&(saveStatePeriodically(),_0x36ab34=0x0);;_0x36ab34===0xe10&&(saveStateInCloud(),_0x2e0e9c=0x0);;},0x3e8);}export async function uploadGame(_0x55640d){const _0x3a7ac1=_0x55640d['files'][0x0];Module['uploadRom'](_0x3a7ac1,()=>{const _0x3b9412=a0_0x5167;Module[_0x3b9412(0x216)]();});}export async function loadGame(_0x581c70){const _0x2fb66d=a0_0x4cdf54,_0x27d225=_0x581c70[_0x2fb66d(0x230)](/\.(gba|gbc|gb|zip)$/,_0x2fb66d(0x21f)),_0x5a3a89=Module[_0x2fb66d(0x246)]();intro[_0x2fb66d(0x1f4)][_0x2fb66d(0x23d)](_0x2fb66d(0x202)),errorLogElements[0x0]['style'][_0x2fb66d(0x22a)]='0',ingame[_0x2fb66d(0x1f4)]['remove'](_0x2fb66d(0x202)),_0x581c70[_0x2fb66d(0x23c)](_0x2fb66d(0x21b))||_0x581c70[_0x2fb66d(0x23c)](_0x2fb66d(0x211))?(canvas[_0x2fb66d(0x1f4)][_0x2fb66d(0x23d)](_0x2fb66d(0x226)),areaTrans[_0x2fb66d(0x1f4)]['add'](_0x2fb66d(0x1fa)),localStorage[_0x2fb66d(0x1e5)](_0x2fb66d(0x1eb),_0x2fb66d(0x1ea)+(window['innerWidth']-0xe6)+','+(window[_0x2fb66d(0x206)]-0xe6)*0x9/0xa)):localStorage[_0x2fb66d(0x1e5)]('screenSize',_0x2fb66d(0x1ea)+(window[_0x2fb66d(0x206)]-0x96)+','+(window[_0x2fb66d(0x206)]-0x96)*0x2/0x3),_0x5a3a89[_0x2fb66d(0x23b)](_0x27d225)?(await Module[_0x2fb66d(0x21e)](_0x2fb66d(0x236)+_0x581c70),confirm(_0x2fb66d(0x1e8))&&(await Module['loadState'](0x0),localStorage[_0x2fb66d(0x1e5)](_0x2fb66d(0x208),_0x581c70),console[_0x2fb66d(0x1f1)](_0x581c70))):(await Module[_0x2fb66d(0x21e)](_0x2fb66d(0x236)+_0x581c70),localStorage['setItem']('gameName',_0x581c70)),await statusShow();}export async function saveState(_0x3bc92c){const _0x36fec3=a0_0x4cdf54;await Module[_0x36fec3(0x1fd)](_0x3bc92c),await Module[_0x36fec3(0x216)]();}export async function loadState(_0x5e5137){await Module['loadState'](_0x5e5137);}export async function downloadFile(_0x1143b2,_0x443f98){const _0x129a9f=a0_0x4cdf54,_0x267096=Module[_0x129a9f(0x1f2)](_0x1143b2),_0x2049fc=document[_0x129a9f(0x240)]('a');document[_0x129a9f(0x20f)][_0x129a9f(0x1ed)](_0x2049fc),_0x2049fc['download']=_0x443f98;const _0x20cc49=new Blob([_0x267096],{'type':_0x129a9f(0x1e9)});_0x2049fc[_0x129a9f(0x212)]=URL[_0x129a9f(0x1fb)](_0x20cc49),_0x2049fc[_0x129a9f(0x1f0)](),URL[_0x129a9f(0x23e)](_0x20cc49),_0x2049fc['remove']();}export function downloadFileInCloud(_0x32777b){const _0x243379=a0_0x4cdf54,_0x2bb12c=Module[_0x243379(0x1f2)](_0x32777b);return _0x2bb12c;}export async function uploadFile(_0xf001b5){const _0x1f411a=a0_0x4cdf54,_0x1320d2=_0xf001b5[_0x1f411a(0x229)][0x0];Module[_0x1f411a(0x1ec)](_0x1320d2,()=>{Module['FSSync']();});}export async function editFile(_0x149758,_0x36e52e,_0x1f0c40){const _0xc6bcdc=a0_0x4cdf54;await Module['editFileName'](_0x149758,_0x36e52e,_0x1f0c40),await Module[_0xc6bcdc(0x216)]();}export async function deleteFile(_0x32e2c7){const _0x52db5f=a0_0x4cdf54;await Module[_0x52db5f(0x215)](_0x32e2c7),await Module['FSSync']();}function a0_0x2d84(){const _0xeba184=['files','bottom','_savedCheats','contains','canvas','setFastForwardMultiplier','Error\x20uploadSavSta:','replace','13046hkjNch','addEventListener','2204208bAMuyd','control-setting','_imageState','/data/games/','slotStateSaved','text/plain','visible','visibilityState','includes','endsWith','add','revokeObjectURL','24zRcwGg','createElement','getElementById','textContent','#E0C068','1311072OtRaif','screenshot','listStates','error','toString','58nSEclg','listScreenshots','setItem','.gba','pagehide','Do\x20you\x20want\x20to\x20load\x20save\x20state?','application/octet-stream','0,0,','screenSize','uploadSaveOrSaveState','appendChild','3039129WyqWon','/data/screenshots/','click','log','downloadFile','pauseGame','classList','autoLoadCheats','_slot0.txt','Off','Error\x20uploadCheat:','\x20time(s)','gbc1','createObjectURL','padStart','saveState','getItem','Save/State\x20uploaded\x20successfully:','now','#20A5A6','disable','hidden','visibilitychange','_imageState0','innerWidth','buttonUnpress','gameName','Auto\x20save\x20','SDL2','Resumed!','.png','10rIPUqp','5643792tWMbKi','body','beforeunload','.gb','href','No\x20screenshot!','turboF','deleteFile','FSSync','onLine','10bLGobD','Unable\x20to\x20upload\x20to\x20Cloud!','12608101lnxtQT','.gbc','remove','431740JbWLhQ','loadGame','.ss0','buttonPress','Cloud\x20upload\x20','Online!','type','_dateState0','listSaves','gbc','uId','uploadCheats'];a0_0x2d84=function(){return _0xeba184;};return a0_0x2d84();}export function listGame(){const _0x3d4f3b=Module['listGames']();return _0x3d4f3b;}export function listSave(){const _0x28d049=a0_0x4cdf54,_0x4e9291=Module[_0x28d049(0x225)]();return _0x4e9291;}export function listState(){const _0xfe6602=a0_0x4cdf54,_0x415d93=Module[_0xfe6602(0x246)]();return _0x415d93;}export function listCheat(){const _0x45eed9=Module['listCheats']();return _0x45eed9;}export function listScreenshot(){const _0x37f697=a0_0x4cdf54,_0x253b04=Module[_0x37f697(0x1e4)]();return _0x253b04;}function a0_0x5167(_0x462f15,_0x2441f0){const _0x2d848d=a0_0x2d84();return a0_0x5167=function(_0x5167a2,_0x5a6509){_0x5167a2=_0x5167a2-0x1e4;let _0x27ce90=_0x2d848d[_0x5167a2];return _0x27ce90;},a0_0x5167(_0x462f15,_0x2441f0);}export function fileSize(_0x2a8693){const _0x39a6bb=Module['fileSize'](_0x2a8693);return _0x39a6bb;}export async function uploadCheat(_0x3f0351){const _0x42e159=a0_0x4cdf54;try{const _0x328dbd=_0x3f0351[_0x42e159(0x229)][0x0];await Module[_0x42e159(0x228)](_0x328dbd,()=>{const _0x2cc380=_0x42e159;console[_0x2cc380(0x1f1)]('Cheat\x20uploaded\x20successfully:',_0x328dbd['name']),localStorageFile(),Module[_0x2cc380(0x216)]();});}catch(_0x101d0b){console[_0x42e159(0x247)](_0x42e159(0x1f8),_0x101d0b);}}export async function uploadSavSta(_0x34418e){const _0x5988e6=a0_0x4cdf54;try{const _0x35b324=_0x34418e['files'][0x0];await Module['uploadSaveOrSaveState'](_0x35b324,()=>{const _0x125869=a0_0x5167;console['log'](_0x125869(0x1ff),_0x35b324['name']),localStorageFile(),Module[_0x125869(0x216)]();});}catch(_0x118172){console['error'](_0x5988e6(0x22f),_0x118172);}}export async function uploadSaveOrSaveState(_0x5cfb92){const _0xe5ad00=a0_0x4cdf54;Module[_0xe5ad00(0x1ec)](_0x5cfb92,()=>{const _0x4b6263=_0xe5ad00;localStorageFile(),Module[_0x4b6263(0x216)]();});}export async function resumeGame(){const _0x5f103e=a0_0x4cdf54;Module['resumeGame'](),Module[_0x5f103e(0x20a)](),notiMessage(_0x5f103e(0x20b),0x7d0);}export async function pauseGame(){const _0x522071=a0_0x4cdf54;Module[_0x522071(0x1f3)](),Module[_0x522071(0x20a)](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x484c5a){const _0x4f1699=a0_0x4cdf54;Module[_0x4f1699(0x220)](_0x484c5a);}export async function buttonUnpress(_0x401252){const _0x21db14=a0_0x4cdf54;Module[_0x21db14(0x207)](_0x401252);}export async function screenShot(_0x2cdbf5){const _0x9d414b=a0_0x4cdf54,_0x4cebcb=localStorage['getItem'](_0x9d414b(0x208)),_0x5e939d=_0x4cebcb[_0x9d414b(0x230)](/\.(gba|gbc|gb|zip)$/,'_');await Module['screenshot'](''+_0x5e939d+_0x2cdbf5+_0x9d414b(0x20c)),await Module[_0x9d414b(0x216)]();const _0x2359c7=await fileToBase64(Module['downloadFile'](_0x9d414b(0x1ef)+_0x5e939d+_0x2cdbf5+_0x9d414b(0x20c))),_0x44f689=Date[_0x9d414b(0x200)](),_0x3a53e8=formatDateTime(_0x44f689);localStorage['setItem'](_0x4cebcb+'_dateState'+_0x2cdbf5,_0x3a53e8),localStorage[_0x9d414b(0x1e5)](_0x4cebcb+_0x9d414b(0x235)+_0x2cdbf5,_0x2359c7);}export async function captureOCR(_0x5e08a5){const _0x5537e0=a0_0x4cdf54;Module[_0x5537e0(0x245)](_0x5e08a5);const _0x5e1af8=Module[_0x5537e0(0x1f2)](_0x5537e0(0x1ef)+_0x5e08a5);return _0x5e1af8;}export async function setFastForwardMultiplier(_0x123537){const _0x586b28=a0_0x4cdf54;Module[_0x586b28(0x22e)](_0x123537);}export function uploadCheats(_0x1cb981,_0x328907,_0x10f08,_0x4de615,_0x138c52){Module['uploadCheats'](_0x1cb981,()=>{const _0x5a9173=a0_0x5167;Module[_0x5a9173(0x1f5)](),setTimeout(()=>{const _0x53bc4b=_0x5a9173;Module[_0x53bc4b(0x216)]();},0x1f4),_0x4de615&&(localStorage[_0x5a9173(0x1e5)](_0x328907+'_savedCheats',_0x10f08),notiMessage('Cheat\x20Enabled!',0x5dc)),_0x138c52[_0x5a9173(0x242)]=localStorage[_0x5a9173(0x1fe)](_0x328907+_0x5a9173(0x22b)||_0x5a9173(0x1f7));});}