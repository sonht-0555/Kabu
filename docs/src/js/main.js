const a0_0x3c9e4a=a0_0x3d70;(function(_0x350540,_0x55bb66){const _0x5aebfb=a0_0x3d70,_0x157238=_0x350540();while(!![]){try{const _0x28433c=-parseInt(_0x5aebfb(0x181))/0x1*(-parseInt(_0x5aebfb(0x14d))/0x2)+parseInt(_0x5aebfb(0x151))/0x3+parseInt(_0x5aebfb(0x16a))/0x4*(-parseInt(_0x5aebfb(0x193))/0x5)+parseInt(_0x5aebfb(0x171))/0x6+-parseInt(_0x5aebfb(0x15d))/0x7*(-parseInt(_0x5aebfb(0x191))/0x8)+-parseInt(_0x5aebfb(0x166))/0x9+parseInt(_0x5aebfb(0x189))/0xa*(-parseInt(_0x5aebfb(0x185))/0xb);if(_0x28433c===_0x55bb66)break;else _0x157238['push'](_0x157238['shift']());}catch(_0x222a0b){_0x157238['push'](_0x157238['shift']());}}}(a0_0x19b0,0x328c9));import a0_0x25812f from'../core/mgba.js';import*as a0_0x373c71 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0x3c9e4a(0x12f)]('canvas')};function initializeCore(_0x19c8cd,_0x459e85){_0x19c8cd(_0x459e85)['then'](function(_0x2d3b46){_0x2d3b46['FSInit']();});}initializeCore(a0_0x25812f,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x3c9e4a(0x12f)](a0_0x3c9e4a(0x167)),controlSetting=document[a0_0x3c9e4a(0x12f)](a0_0x3c9e4a(0x148));function handleVisibilityChange(_0x1a0df8){const _0x2be4b6=a0_0x3c9e4a;document[_0x2be4b6(0x135)]===_0x2be4b6(0x18e)||_0x1a0df8?.[_0x2be4b6(0x15f)]==='beforeunload'||_0x1a0df8?.[_0x2be4b6(0x141)]?(Module[_0x2be4b6(0x147)](),pauseGame(),canvas[_0x2be4b6(0x16d)][_0x2be4b6(0x179)](_0x2be4b6(0x182))):(setTimeout(()=>{const _0x4f0994=_0x2be4b6;canvas['classList'][_0x4f0994(0x158)](_0x4f0994(0x182));},0x258),controlSetting[_0x2be4b6(0x16d)]['contains'](_0x2be4b6(0x182))&&resumeGame());}async function statusShow(){const _0x43e857=a0_0x3c9e4a;document[_0x43e857(0x160)]('pagehide',handleVisibilityChange),document[_0x43e857(0x160)](_0x43e857(0x130),handleVisibilityChange),window[_0x43e857(0x160)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),await a0_0x373c71[_0x43e857(0x16f)](parseInt(await getData(gameName,'0','turboState'))),await delay(0xc8),await Module[_0x43e857(0x15e)](),await delay(0x320),await led(parseInt(await getData(gameName,'0','slotStateSaved'))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x49842a=a0_0x3c9e4a;await ledSave('#20A5A6'),await Module[_0x49842a(0x163)](0x0),await Module[_0x49842a(0x147)](),await screenShot(0x0),console['log'](_0x49842a(0x12e)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x4af29e=a0_0x3c9e4a,_0x39b87a=gameName[_0x4af29e(0x18c)](/\.(zip|gb|gbc|gba)$/,_0x4af29e(0x161)),_0x457d3d=localStorage['getItem'](_0x4af29e(0x14a));navigator[_0x4af29e(0x138)]&&(_0x457d3d&&(await ledSave(_0x4af29e(0x131)),await delay(0x3e8),await dpUploadFile(_0x39b87a,Module[_0x4af29e(0x157)](_0x4af29e(0x17d)+_0x39b87a),_0x4af29e(0x162)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x4af29e(0x14e),0x7d0)));}function startTimer(){let [_0x12c2a1,_0x39b216,_0x9bee60,_0xe03db4,_0xccf0e5]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0xc0064=a0_0x3d70;_0x9bee60++,_0xe03db4++,_0xccf0e5++;if(_0x9bee60===0x3c)[_0x9bee60,_0x39b216]=[0x0,_0x39b216+0x1];if(_0x39b216===0x3c)[_0x39b216,_0x12c2a1]=[0x0,_0x12c2a1+0x1];document[_0xc0064(0x12f)](_0xc0064(0x187))[_0xc0064(0x13d)]=_0x12c2a1+'h'+_0x39b216[_0xc0064(0x17b)]()[_0xc0064(0x134)](0x2,'0')+'.'+_0x9bee60[_0xc0064(0x17b)]()['padStart'](0x2,'0');_0xe03db4===0x3c&&(saveStatePeriodically(),_0xe03db4=0x0);;_0xccf0e5===0x708&&(saveStateInCloud(),_0xccf0e5=0x0);;},0x3e8);}export async function uploadGame(_0xf90741){const _0x3746d8=a0_0x3c9e4a,_0x2e7b68=_0xf90741[_0x3746d8(0x169)][0x0];Module['uploadRom'](_0x2e7b68,()=>{const _0x284c30=_0x3746d8;Module[_0x284c30(0x147)]();});}export async function loadGame(_0x47280e){const _0x3c5875=a0_0x3c9e4a,_0x5e8f9e=_0x47280e['replace'](/\.(gba|gbc|gb|zip)$/,_0x3c5875(0x161)),_0x2c6d35=Module[_0x3c5875(0x197)](_0x3c5875(0x198))['filter'](_0x45a327=>_0x45a327!=='.'&&_0x45a327!=='..');intro[_0x3c5875(0x16d)][_0x3c5875(0x179)]('disable'),errorLogElements[0x0]['style'][_0x3c5875(0x144)]='0',ingame['classList'][_0x3c5875(0x158)](_0x3c5875(0x145)),_0x47280e[_0x3c5875(0x153)](_0x3c5875(0x17e))||_0x47280e[_0x3c5875(0x153)](_0x3c5875(0x186))?(canvas[_0x3c5875(0x16d)][_0x3c5875(0x179)](_0x3c5875(0x14b)),areaTrans[_0x3c5875(0x16d)][_0x3c5875(0x179)](_0x3c5875(0x19a)),localStorage[_0x3c5875(0x178)]('screenSize','0,0,'+(window[_0x3c5875(0x180)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x3c5875(0x178)](_0x3c5875(0x155),_0x3c5875(0x149)+(window[_0x3c5875(0x180)]-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x2c6d35[_0x3c5875(0x184)](_0x5e8f9e)?(await Module['loadGame'](_0x3c5875(0x13b)+_0x47280e),confirm(_0x3c5875(0x172))&&(await Module['loadState'](0x0),await shaderData())):(await Module[_0x3c5875(0x12c)]('/data/games/'+gameName),await shaderData()),await statusShow();}export async function saveState(_0x310156){await Module['saveState'](_0x310156);}export async function loadState(_0x443fe3){const _0x3f1662=a0_0x3c9e4a;await Module[_0x3f1662(0x17f)](_0x443fe3);}export async function downloadFile(_0x192f4b,_0x54990b){const _0x10b342=a0_0x3c9e4a,_0x1698ab=Module[_0x10b342(0x157)](_0x192f4b),_0x55c9bd=document['createElement']('a');document[_0x10b342(0x136)][_0x10b342(0x173)](_0x55c9bd),_0x55c9bd['download']=_0x54990b;const _0x2a30fa=new Blob([_0x1698ab],{'type':_0x10b342(0x146)});_0x55c9bd['href']=URL[_0x10b342(0x176)](_0x2a30fa),_0x55c9bd['click'](),URL[_0x10b342(0x18a)](_0x2a30fa),_0x55c9bd['remove']();}export function downloadFileInCloud(_0x18f2a5){const _0x3037be=a0_0x3c9e4a;try{const _0x1b65df=Module[_0x3037be(0x157)](_0x18f2a5);return _0x1b65df;}catch(_0x4932e5){return null;}}export async function uploadFileInCloud(_0x398323){const _0x22492c=a0_0x3c9e4a;Module[_0x22492c(0x18d)](_0x398323,async()=>{const _0x1ba429=_0x22492c;localStorageFile(),await Module[_0x1ba429(0x147)]();});}export async function uploadFile(_0x305596){const _0x29ab62=a0_0x3c9e4a,_0xef6999=_0x305596[_0x29ab62(0x169)][0x0];Module[_0x29ab62(0x18d)](_0xef6999,async()=>{localStorageFile(),await Module['FSSync']();});}export async function editFile(_0x574621,_0x3a7759,_0x22cd2c){await Module['editFileName'](_0x574621,_0x3a7759,_0x22cd2c);}function a0_0x19b0(){const _0x1e3c56=['disable','application/octet-stream','FSSync','control-setting','0,0,','uId','gbc','led01','2Hxctyz','\x20time(s)','split','.png','1091160MuabyJ','log','endsWith','opacity','screenSize','filter','downloadFile','remove','Resumed!','fileSize','substring','\x20:\x20','7iVywUA','SDL2','type','addEventListener','.ss0','state','saveState','fill','length','1835685pZnWgL','canvas','match','files','35044uRZQqr','entries','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','classList','listCheats','turboF','rgba(245,\x20232,\x20209,\x200.4)','1663740TWxDVe','Do\x20you\x20want\x20to\x20load\x20save\x20state?','appendChild','deleteFile','exec','createObjectURL','All','setItem','add','listStates','toString','listScreenshots','/data/states/','.gbc','loadState','innerWidth','291323RgBDdZ','visible','style','includes','9608467tduVvy','.gb','timer','Error\x20ledSave:','10LjaFGD','revokeObjectURL','indexOf','replace','uploadAll','hidden','charCodeAt','screenshot','3308040fdEupJ','image/png','35NUieLW','error','led07','led04','listFiles','states','led00','gbc1','/data/screenshots/','resumeGame','loadGame','\x20|\x20','Auto\x20save\x20','getElementById','visibilitychange','#E0C068','trim','tEXtComment\x00','padStart','visibilityState','body','noti-mess','onLine','0.4','lastIndexOf','/data/games/','buttonPress','textContent','encode','led0','led06','persisted','buttonUnpress','led03','bottom'];a0_0x19b0=function(){return _0x1e3c56;};return a0_0x19b0();}export async function deleteFile(_0x4b6299){const _0x1be79f=a0_0x3c9e4a;try{return await Module[_0x1be79f(0x174)](_0x4b6299),!![];}catch(_0x5e672a){return console[_0x1be79f(0x194)](_0x4b6299),null;}}function a0_0x3d70(_0x5b5f6a,_0x43d8a6){const _0x19b014=a0_0x19b0();return a0_0x3d70=function(_0x3d7067,_0x1bc75d){_0x3d7067=_0x3d7067-0x12b;let _0x17177f=_0x19b014[_0x3d7067];return _0x17177f;},a0_0x3d70(_0x5b5f6a,_0x43d8a6);}export function listFiles(_0x27122c){const _0x4177f8=a0_0x3c9e4a,_0x24a142=Module[_0x4177f8(0x197)](_0x27122c)[_0x4177f8(0x156)](_0x538cb5=>_0x538cb5!=='.'&&_0x538cb5!=='..');return _0x24a142;}export function listGame(){const _0x45acc2=a0_0x3c9e4a,_0x4022c4=Module['listRoms']()[_0x45acc2(0x156)](_0x5d4580=>_0x5d4580!=='.'&&_0x5d4580!=='..');return _0x4022c4;}export function listSave(){const _0x51c5d5=a0_0x3c9e4a,_0x1d9cea=Module['listSaves']()[_0x51c5d5(0x156)](_0x477379=>_0x477379!=='.'&&_0x477379!=='..');return _0x1d9cea;}export function listState(){const _0x5d4c8d=a0_0x3c9e4a,_0x35a3a0=Module[_0x5d4c8d(0x17a)]()[_0x5d4c8d(0x156)](_0x328595=>_0x328595!=='.'&&_0x328595!=='..');return _0x35a3a0;}export function listCheat(){const _0x143a7e=a0_0x3c9e4a,_0x1855f3=Module[_0x143a7e(0x16e)]()[_0x143a7e(0x156)](_0x31a9bc=>_0x31a9bc!=='.'&&_0x31a9bc!=='..');return _0x1855f3;}export function listScreenshot(){const _0x560dd4=a0_0x3c9e4a,_0x4f7aea=Module[_0x560dd4(0x17c)]()['filter'](_0xdf9ff0=>_0xdf9ff0!=='.'&&_0xdf9ff0!=='..');return _0x4f7aea;}export function fileSize(_0x55beff){const _0x183ced=a0_0x3c9e4a,_0x14a648=Module[_0x183ced(0x15a)](_0x55beff);return _0x14a648;}export async function resumeGame(){const _0x49d8c4=a0_0x3c9e4a;Module[_0x49d8c4(0x12b)](),Module[_0x49d8c4(0x15e)](),notiMessage(_0x49d8c4(0x159),0x7d0);}export async function pauseGame(){Module['pauseGame'](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x3b8946){const _0xc3bcef=a0_0x3c9e4a;Module[_0xc3bcef(0x13c)](_0x3b8946);}export async function buttonUnpress(_0x2e675c){const _0x495e63=a0_0x3c9e4a;Module[_0x495e63(0x142)](_0x2e675c);}export async function screenShot(_0x2410d9){const _0x3dbdb5=a0_0x3c9e4a,_0x311283=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0x2410d9+_0x3dbdb5(0x150)),_0x318352=await getData(gameName,_0x2410d9,_0x3dbdb5(0x177))||'';console[_0x3dbdb5(0x152)](_0x318352),await Module['screenshot'](_0x311283),await setData(gameName,_0x2410d9,'saveTime',formatDateTime(Date['now']()),_0x318352);}export async function dowloadScreenShot(_0xcfa96e){const _0x3ab677=a0_0x3c9e4a;try{const _0x8f3a31=await fileToBase64(Module[_0x3ab677(0x157)](_0xcfa96e));return _0x8f3a31;}catch{}}export async function captureOCR(_0x3b9e4f){const _0x34efa1=a0_0x3c9e4a;Module[_0x34efa1(0x190)](_0x3b9e4f);const _0x444724=Module[_0x34efa1(0x157)](_0x34efa1(0x19b)+_0x3b9e4f);return _0x444724;}export async function setFastForwardMultiplier(_0x5840e9){Module['setFastForwardMultiplier'](_0x5840e9);}export async function uploadCheats(_0x5ac15a){const _0x4117aa=a0_0x3c9e4a;Module['autoLoadCheats'](),Module[_0x4117aa(0x18d)](_0x5ac15a,async()=>{});}export function setVolume(_0x51d47f){Module['setVolume'](_0x51d47f);}export async function setData(_0x1a57bc,_0x3ab24c,_0x483acc,_0x584876,_0x540919=''){const _0x30fd6e=a0_0x3c9e4a,_0x572b98=_0x1a57bc[_0x30fd6e(0x18c)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x25b9fe=_0x30fd6e(0x19b)+_0x572b98+'_'+_0x3ab24c+_0x30fd6e(0x150);let _0x13c79d;try{_0x13c79d=await fileToBase64(Module[_0x30fd6e(0x157)](_0x25b9fe));}catch(_0x434c9d){await Module[_0x30fd6e(0x190)](_0x572b98+'_'+_0x3ab24c+_0x30fd6e(0x150)),await delay(0xc8),_0x13c79d=await fileToBase64(Module[_0x30fd6e(0x157)](_0x25b9fe));}let _0xffeaba=atob(_0x13c79d[_0x30fd6e(0x14f)](',')[0x1]),_0x7d5340=_0x30fd6e(0x133),_0x1b0a73=_0xffeaba[_0x30fd6e(0x18b)](_0x7d5340),_0x5c4525={};if(_0x1b0a73!==-0x1||_0x540919[_0x30fd6e(0x132)]()!==''){let _0x56dc24=_0x1b0a73!==-0x1?_0xffeaba[_0x30fd6e(0x15b)](_0x1b0a73+_0x7d5340[_0x30fd6e(0x165)]):_0x540919,_0xbbdc03=/(\w+)\s*:\s*([^|]*)/g,_0x4aaf07;while((_0x4aaf07=_0xbbdc03[_0x30fd6e(0x175)](_0x56dc24))!==null){_0x5c4525[_0x4aaf07[0x1]['trim']()]=_0x4aaf07[0x2]['trim']();}_0x1b0a73!==-0x1&&(_0xffeaba=_0xffeaba['substring'](0x0,_0x1b0a73));}_0x5c4525[_0x483acc]=_0x584876;let _0x122b32=Object[_0x30fd6e(0x16b)](_0x5c4525)['map'](([_0x18bfd4,_0x42ef08])=>_0x18bfd4+_0x30fd6e(0x15c)+_0x42ef08)['join'](_0x30fd6e(0x12d)),_0x16ac5e=new TextEncoder()[_0x30fd6e(0x13e)](_0x7d5340+'\x20'+_0x122b32),_0x1eb295=new Uint8Array([..._0xffeaba]['map'](_0x2465f1=>_0x2465f1[_0x30fd6e(0x18f)](0x0))['concat']([..._0x16ac5e])),_0x162688=new File([new Blob([_0x1eb295],{'type':_0x30fd6e(0x192)})],_0x572b98+'_'+_0x3ab24c+_0x30fd6e(0x150),{'type':'image/png'});Module[_0x30fd6e(0x18d)](_0x162688,async()=>{});}export async function getData(_0x5575f1,_0x220132,_0x392253){const _0x87c05=a0_0x3c9e4a;try{const _0x476515=_0x5575f1[_0x87c05(0x18c)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x26b3a2=_0x87c05(0x19b)+_0x476515+'_'+_0x220132+_0x87c05(0x150);let _0x1585f2;try{_0x1585f2=await fileToBase64(Module[_0x87c05(0x157)](_0x26b3a2));}catch(_0x580a1d){return null;}let _0x54488f=atob(_0x1585f2[_0x87c05(0x14f)](',')[0x1]),_0x2e19c5='tEXtComment\x00',_0x554a57=_0x54488f['indexOf'](_0x2e19c5);if(_0x554a57!==-0x1){let _0x2fa246=_0x54488f[_0x87c05(0x15b)](_0x554a57+_0x2e19c5['length']);if(_0x392253==='All')return _0x2fa246[_0x87c05(0x132)]();let _0x3c76ef=new RegExp(_0x392253+_0x87c05(0x16c)),_0x5b9778=_0x2fa246[_0x87c05(0x168)](_0x3c76ef);if(_0x5b9778)return _0x5b9778[0x1][_0x87c05(0x132)]();}}catch(_0x5f45e6){return console[_0x87c05(0x194)]({'romName':_0x5575f1,'slot':_0x220132,'type':_0x392253}),null;}}export async function ledSave(_0xce8fdf){const _0x47e30b=a0_0x3c9e4a,_0x4aba16=parseInt(await getData(gameName,'0','slotStateSaved')),_0x55f68b=_0x4aba16===0x1?_0x47e30b(0x14c):_0x4aba16===0x2?'led02':_0x4aba16===0x3?_0x47e30b(0x143):_0x4aba16===0x4?_0x47e30b(0x196):_0x4aba16===0x5?'led05':_0x4aba16===0x6?_0x47e30b(0x140):_0x4aba16===0x7?_0x47e30b(0x195):_0x47e30b(0x199);try{for(let _0x5748b2=0x0;_0x5748b2<=0x7;_0x5748b2++){document[_0x47e30b(0x12f)](_0x47e30b(0x13f)+_0x5748b2)[_0x47e30b(0x183)][_0x47e30b(0x164)]=_0x47e30b(0x170);}await delay(0x3e8);for(let _0x2e4017=0x0;_0x2e4017<=0x7;_0x2e4017++){document[_0x47e30b(0x12f)]('led0'+_0x2e4017)[_0x47e30b(0x183)][_0x47e30b(0x164)]='rgba(245,\x20232,\x20209,\x200.4)';}document[_0x47e30b(0x12f)](_0x55f68b)[_0x47e30b(0x183)][_0x47e30b(0x164)]=_0xce8fdf;}catch(_0x536968){console[_0x47e30b(0x194)](_0x47e30b(0x188),_0x536968);}};export async function notiMessage(_0x3bdc91,_0x5befe4,_0x8f5eaf=![]){const _0x334d47=a0_0x3c9e4a;var _0x225363=document[_0x334d47(0x12f)](_0x334d47(0x137));const _0x279c9e=parseInt(await getData(gameName,'0','slotStateSaved'))||0x0;_0x225363[_0x334d47(0x183)]['opacity']===_0x334d47(0x139)&&(clearTimeout(messageTimeout),_0x225363[_0x334d47(0x183)][_0x334d47(0x154)]='0'),_0x225363[_0x334d47(0x13d)]=_0x3bdc91,_0x225363[_0x334d47(0x183)][_0x334d47(0x154)]=_0x334d47(0x139),messageTimeout=setTimeout(()=>{const _0x5d438e=_0x334d47;_0x225363[_0x5d438e(0x13d)]='['+_0x279c9e+']\x20'+gameName[_0x5d438e(0x15b)](0x0,gameName[_0x5d438e(0x13a)]('.')),_0x225363['style'][_0x5d438e(0x154)]='0.4';},_0x5befe4),_0x8f5eaf&&(canvas[_0x334d47(0x16d)][_0x334d47(0x179)]('visible'),setTimeout(()=>{const _0xd8ba67=_0x334d47;canvas[_0xd8ba67(0x16d)][_0xd8ba67(0x158)](_0xd8ba67(0x182));},0x258));}export async function FSSync(){const _0x23eea7=a0_0x3c9e4a;Module[_0x23eea7(0x147)]();}export function rewind(_0x30997d){Module['toggleRewind'](_0x30997d);}