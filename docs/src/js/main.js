const a0_0x39eff6=a0_0x243b;(function(_0x512aee,_0x657ea2){const _0x21115a=a0_0x243b,_0x139835=_0x512aee();while(!![]){try{const _0x437c2f=parseInt(_0x21115a(0xb4))/0x1*(-parseInt(_0x21115a(0x99))/0x2)+-parseInt(_0x21115a(0xcd))/0x3+parseInt(_0x21115a(0x9b))/0x4+parseInt(_0x21115a(0xad))/0x5*(parseInt(_0x21115a(0xb9))/0x6)+-parseInt(_0x21115a(0x88))/0x7+-parseInt(_0x21115a(0x9f))/0x8+parseInt(_0x21115a(0xa9))/0x9;if(_0x437c2f===_0x657ea2)break;else _0x139835['push'](_0x139835['shift']());}catch(_0xd645f6){_0x139835['push'](_0x139835['shift']());}}}(a0_0x1687,0x4915e));import a0_0x52bc3a from'../core/mgba.js';import*as a0_0x2900eb from'./gamepad.js';import{localStorageFile}from'./storage.js';function a0_0x1687(){const _0x5e68a3=['createObjectURL','screenSize','download','tEXtComment\x00','12obNkVc','deleteFile','uploadAll','SDL2','_savedCheats','length','type','screenshot','charCodeAt','Auto\x20save\x20','replace','\x20time(s)','onLine','persisted','padStart','indexOf','canvas','/data/states/','revokeObjectURL','FSSync','1608786CsrpZH','style','turboF','/data/screenshots/','.png','state','toString','now','resumeGame','bottom','gbc','contains','getElementById','textContent','Paused!','autoLoadCheats','loadState','saveState','visible','buttonPress','getItem','.gbc','setItem','gameName','image/png','addEventListener','.gb','editFileName','listStates','innerWidth','996583xVjsYI','href','Cheat\x20Enabled!','add','buttonUnpress','set','endsWith','body','classList','uploadRom','remove','listScreenshots','listRoms','log','loadGame','disable','uId','4988BvdAxH','setFastForwardMultiplier','1307016gLcZpC','downloadFile','hidden','0,0,','1903712FiwlLj','fileSize','split','beforeunload','filter','#20A5A6','appendChild','setVolume','Resumed!','turboState','7659081WLHGDP','visibilityState','listCheats','click','288760xDzbhw','control-setting','#E0C068','visibilitychange','pauseGame','Do\x20you\x20want\x20to\x20load\x20save\x20state?','timer','31jbfhrb'];a0_0x1687=function(){return _0x5e68a3;};return a0_0x1687();}import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x39eff6(0x76)](a0_0x39eff6(0xc9))};function initializeCore(_0x2a3a5d,_0x44bf2f){_0x2a3a5d(_0x44bf2f)['then'](function(_0x12a6a1){_0x12a6a1['FSInit']();});}initializeCore(a0_0x52bc3a,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x39eff6(0x76)](a0_0x39eff6(0xc9)),savedTurboState=localStorage[a0_0x39eff6(0x7e)](a0_0x39eff6(0xa8)),controlSetting=document['getElementById'](a0_0x39eff6(0xae));function handleVisibilityChange(_0x1fb898){const _0x975a43=a0_0x39eff6;document[_0x975a43(0xaa)]===_0x975a43(0x9d)||_0x1fb898?.[_0x975a43(0xbf)]===_0x975a43(0xa2)||_0x1fb898?.[_0x975a43(0xc6)]?(pauseGame(),canvas['classList'][_0x975a43(0x8b)](_0x975a43(0x7c))):(setTimeout(()=>{const _0x275617=_0x975a43;canvas[_0x275617(0x90)]['remove'](_0x275617(0x7c));},0x258),controlSetting[_0x975a43(0x90)][_0x975a43(0x75)]('visible')&&resumeGame());}async function statusShow(){const _0x13129d=a0_0x39eff6;document[_0x13129d(0x83)]('pagehide',handleVisibilityChange),document[_0x13129d(0x83)](_0x13129d(0xb0),handleVisibilityChange),window['addEventListener'](_0x13129d(0xa2),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x2900eb[_0x13129d(0xcf)](turboState)),await delay(0xc8),await Module[_0x13129d(0xbc)](),await delay(0x320),await led(parseInt(localStorage[_0x13129d(0x7e)]('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x3232e0=a0_0x39eff6;await ledSave(_0x3232e0(0xa4)),await Module[_0x3232e0(0x7b)](0x0),await Module[_0x3232e0(0xcc)](),await screenShot(0x0),console[_0x3232e0(0x95)](_0x3232e0(0xc2)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x2df3c4=a0_0x39eff6,_0x3f8d88=localStorage[_0x2df3c4(0x7e)]('gameName'),_0x48ab8e=_0x3f8d88[_0x2df3c4(0xc3)](/\.(zip|gb|gbc|gba)$/,'.ss0'),_0x3998d1=localStorage[_0x2df3c4(0x7e)](_0x2df3c4(0x98));navigator[_0x2df3c4(0xc5)]&&(_0x3998d1&&(await ledSave(_0x2df3c4(0xaf)),await delay(0x3e8),await dpUploadFile(_0x48ab8e,Module['downloadFile'](_0x2df3c4(0xca)+_0x48ab8e),_0x2df3c4(0xd2)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x2df3c4(0xc4),0x7d0)));}function startTimer(){let [_0x361f09,_0x1d9e93,_0xb3e91b,_0x48897e,_0x38c1cc]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x22f4e3=a0_0x243b;_0xb3e91b++,_0x48897e++,_0x38c1cc++;if(_0xb3e91b===0x3c)[_0xb3e91b,_0x1d9e93]=[0x0,_0x1d9e93+0x1];if(_0x1d9e93===0x3c)[_0x1d9e93,_0x361f09]=[0x0,_0x361f09+0x1];document[_0x22f4e3(0x76)](_0x22f4e3(0xb3))[_0x22f4e3(0x77)]=_0x361f09+'h'+_0x1d9e93['toString']()['padStart'](0x2,'0')+'.'+_0xb3e91b[_0x22f4e3(0xd3)]()[_0x22f4e3(0xc7)](0x2,'0');_0x48897e===0x3c&&(saveStatePeriodically(),_0x48897e=0x0);;_0x38c1cc===0x708&&(saveStateInCloud(),_0x38c1cc=0x0);;},0x3e8);}export async function uploadGame(_0x324989){const _0x586fa9=a0_0x39eff6,_0x1f9f7f=_0x324989['files'][0x0];Module[_0x586fa9(0x91)](_0x1f9f7f,()=>{Module['FSSync']();});}export async function loadGame(_0x6383c9){const _0x472963=a0_0x39eff6,_0x2e3330=_0x6383c9[_0x472963(0xc3)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x34aab2=Module[_0x472963(0x86)]()[_0x472963(0xa3)](_0x2c6e1b=>_0x2c6e1b!=='.'&&_0x2c6e1b!=='..');intro[_0x472963(0x90)][_0x472963(0x8b)](_0x472963(0x97)),errorLogElements[0x0][_0x472963(0xce)][_0x472963(0x73)]='0',ingame[_0x472963(0x90)][_0x472963(0x92)](_0x472963(0x97)),_0x6383c9['endsWith'](_0x472963(0x7f))||_0x6383c9[_0x472963(0x8e)](_0x472963(0x84))?(canvas[_0x472963(0x90)][_0x472963(0x8b)](_0x472963(0x74)),areaTrans[_0x472963(0x90)][_0x472963(0x8b)]('gbc1'),localStorage[_0x472963(0x80)]('screenSize',_0x472963(0x9e)+(window[_0x472963(0x87)]-0xe6)+','+(window[_0x472963(0x87)]-0xe6)*0x9/0xa)):localStorage[_0x472963(0x80)](_0x472963(0xb6),_0x472963(0x9e)+(window[_0x472963(0x87)]-0x96)+','+(window[_0x472963(0x87)]-0x96)*0x2/0x3),_0x34aab2['includes'](_0x2e3330)?(await Module['loadGame']('/data/games/'+_0x6383c9),confirm(_0x472963(0xb2))&&(await Module[_0x472963(0x7a)](0x0),localStorage['setItem'](_0x472963(0x81),_0x6383c9),console['log'](_0x6383c9))):(await Module[_0x472963(0x96)]('/data/games/'+_0x6383c9),localStorage['setItem'](_0x472963(0x81),_0x6383c9),console[_0x472963(0x95)](_0x6383c9)),await statusShow();}export async function saveState(_0x53acec){const _0x28fccf=a0_0x39eff6;await Module[_0x28fccf(0x7b)](_0x53acec),await Module[_0x28fccf(0xcc)]();}export async function loadState(_0x55cdde){await Module['loadState'](_0x55cdde);}export async function downloadFile(_0x40fb99,_0x892139){const _0x3111e5=a0_0x39eff6,_0x9b31c9=Module[_0x3111e5(0x9c)](_0x40fb99),_0x3c668d=document['createElement']('a');document[_0x3111e5(0x8f)][_0x3111e5(0xa5)](_0x3c668d),_0x3c668d[_0x3111e5(0xb7)]=_0x892139;const _0x4b263c=new Blob([_0x9b31c9],{'type':'application/octet-stream'});_0x3c668d[_0x3111e5(0x89)]=URL[_0x3111e5(0xb5)](_0x4b263c),_0x3c668d[_0x3111e5(0xac)](),URL[_0x3111e5(0xcb)](_0x4b263c),_0x3c668d[_0x3111e5(0x92)]();}export function downloadFileInCloud(_0xd3b416){const _0x5041f6=a0_0x39eff6,_0x3b7234=Module[_0x5041f6(0x9c)](_0xd3b416);return _0x3b7234;}export async function uploadFileInCloud(_0x2bb89e){const _0x4936d9=a0_0x39eff6;Module[_0x4936d9(0xbb)](_0x2bb89e,()=>{const _0x486858=_0x4936d9;localStorageFile(),Module[_0x486858(0xcc)]();});}export async function uploadFile(_0x530931){const _0x41fe7e=_0x530931['files'][0x0];Module['uploadAll'](_0x41fe7e,()=>{const _0x40948d=a0_0x243b;localStorageFile(),Module[_0x40948d(0xcc)]();});}export async function editFile(_0xc63046,_0x2a62b5,_0x42b002){const _0x2b48aa=a0_0x39eff6;await Module[_0x2b48aa(0x85)](_0xc63046,_0x2a62b5,_0x42b002),await Module['FSSync']();}export async function deleteFile(_0x404607){const _0x26557b=a0_0x39eff6;await Module[_0x26557b(0xba)](_0x404607),await Module[_0x26557b(0xcc)]();}export function listGame(){const _0x380833=a0_0x39eff6,_0x9b2fda=Module[_0x380833(0x94)]()['filter'](_0x5dbf70=>_0x5dbf70!=='.'&&_0x5dbf70!=='..');return _0x9b2fda;}export function listSave(){const _0x24b3d2=a0_0x39eff6,_0x40296e=Module['listSaves']()[_0x24b3d2(0xa3)](_0x4881a3=>_0x4881a3!=='.'&&_0x4881a3!=='..');return _0x40296e;}export function listState(){const _0x5057e0=a0_0x39eff6,_0x37b74e=Module[_0x5057e0(0x86)]()[_0x5057e0(0xa3)](_0x853c6b=>_0x853c6b!=='.'&&_0x853c6b!=='..');return _0x37b74e;}export function listCheat(){const _0x56a4ab=a0_0x39eff6,_0x212197=Module[_0x56a4ab(0xab)]()[_0x56a4ab(0xa3)](_0x133e54=>_0x133e54!=='.'&&_0x133e54!=='..');return _0x212197;}export function listScreenshot(){const _0x261518=a0_0x39eff6,_0x4df1cf=Module[_0x261518(0x93)]()[_0x261518(0xa3)](_0x17dd69=>_0x17dd69!=='.'&&_0x17dd69!=='..');return _0x4df1cf;}export function embedTextInPngFile(_0x240886,_0x2dfd21,_0x2af2c5){const _0x4ac99e=a0_0x39eff6;let _0x14a1e1=atob(_0x240886['split'](',')[0x1]),_0x539ad0=new Uint8Array(_0x14a1e1[_0x4ac99e(0xbe)]);for(let _0x56155a=0x0;_0x56155a<_0x14a1e1[_0x4ac99e(0xbe)];_0x56155a++){_0x539ad0[_0x56155a]=_0x14a1e1[_0x4ac99e(0xc1)](_0x56155a);}let _0x55145c=new TextEncoder()['encode'](_0x4ac99e(0xb8)+_0x2dfd21),_0x3126d2=new Uint8Array(_0x539ad0[_0x4ac99e(0xbe)]+_0x55145c[_0x4ac99e(0xbe)]);_0x3126d2[_0x4ac99e(0x8d)](_0x539ad0,0x0),_0x3126d2[_0x4ac99e(0x8d)](_0x55145c,_0x539ad0[_0x4ac99e(0xbe)]);let _0x313531=new Blob([_0x3126d2],{'type':_0x4ac99e(0x82)}),_0x10e4b6=new File([_0x313531],_0x2af2c5,{'type':_0x4ac99e(0x82)});return _0x10e4b6;}export function extractTextFromPngBase64(_0x56534e){const _0x43d187=a0_0x39eff6;let _0x592b92=atob(_0x56534e[_0x43d187(0xa1)](',')[0x1]),_0x435c0b='tEXtComment\x00',_0x418689=_0x592b92[_0x43d187(0xc8)](_0x435c0b);if(_0x418689!==-0x1)return _0x592b92['substring'](_0x418689+_0x435c0b[_0x43d187(0xbe)]);return null;}function a0_0x243b(_0x1463e1,_0x3d69b1){const _0x16870c=a0_0x1687();return a0_0x243b=function(_0x243b67,_0x1c136f){_0x243b67=_0x243b67-0x71;let _0x4f51fc=_0x16870c[_0x243b67];return _0x4f51fc;},a0_0x243b(_0x1463e1,_0x3d69b1);}export function fileSize(_0x115b34){const _0x1a1a4d=a0_0x39eff6,_0x383237=Module[_0x1a1a4d(0xa0)](_0x115b34);return _0x383237;}export async function resumeGame(){const _0x127db2=a0_0x39eff6;Module[_0x127db2(0x72)](),Module[_0x127db2(0xbc)](),notiMessage(_0x127db2(0xa7),0x7d0);}export async function pauseGame(){const _0x26bea0=a0_0x39eff6;Module[_0x26bea0(0xb1)](),Module[_0x26bea0(0xbc)](),notiMessage(_0x26bea0(0x78),0x7d0);}export async function buttonPress(_0x385510){const _0xfc24ad=a0_0x39eff6;Module[_0xfc24ad(0x7d)](_0x385510);}export async function buttonUnpress(_0x27b37c){const _0x4b4007=a0_0x39eff6;Module[_0x4b4007(0x8c)](_0x27b37c);}export async function screenShot(_0x52531c){const _0x9688bd=a0_0x39eff6,_0x19952e=localStorage[_0x9688bd(0x7e)](_0x9688bd(0x81))[_0x9688bd(0xc3)](/\.(gba|gbc|gb|zip)$/,''),_0x4b172a=_0x19952e+'_'+_0x52531c+_0x9688bd(0xd1);await Module['screenshot'](_0x4b172a),await Module['FSSync']();const _0x338146=await fileToBase64(Module[_0x9688bd(0x9c)](_0x9688bd(0xd0)+_0x4b172a)),_0x438e8e=embedTextInPngFile(_0x338146,formatDateTime(Date[_0x9688bd(0x71)]()),_0x4b172a);Module[_0x9688bd(0xbb)](_0x438e8e,()=>{const _0x253c62=_0x9688bd;localStorageFile(),Module[_0x253c62(0xcc)]();});}export async function dowloadScreenShot(_0x5e5322){const _0x517a80=a0_0x39eff6;try{const _0x36bb16=await fileToBase64(Module[_0x517a80(0x9c)](_0x5e5322));return _0x36bb16;}catch{}}export async function captureOCR(_0x5b5b01){const _0x31cc9f=a0_0x39eff6;Module[_0x31cc9f(0xc0)](_0x5b5b01);const _0x32b66b=Module[_0x31cc9f(0x9c)](_0x31cc9f(0xd0)+_0x5b5b01);return _0x32b66b;}export async function setFastForwardMultiplier(_0xdbe15c){const _0x10ce2a=a0_0x39eff6;Module[_0x10ce2a(0x9a)](_0xdbe15c);}export function uploadCheats(_0x3af3f1,_0x4da04b,_0x4653d5,_0x519f9d,_0x2c5f44){Module['uploadAll'](_0x3af3f1,()=>{const _0x19e30b=a0_0x243b;Module[_0x19e30b(0x79)](),setTimeout(()=>{Module['FSSync']();},0x1f4),_0x519f9d&&(localStorage[_0x19e30b(0x80)](_0x4da04b+_0x19e30b(0xbd),_0x4653d5),notiMessage(_0x19e30b(0x8a),0x5dc)),_0x2c5f44[_0x19e30b(0x77)]=localStorage['getItem'](_0x4da04b+'_savedCheats'||'Off');});}export function setVolume(_0x3d6e5d){const _0x2d0ae8=a0_0x39eff6;Module[_0x2d0ae8(0xa6)](_0x3d6e5d);}