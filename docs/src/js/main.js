const a0_0x47070e=a0_0x4221;(function(_0x3e0f70,_0x1d7bfe){const _0x20ead0=a0_0x4221,_0x384677=_0x3e0f70();while(!![]){try{const _0x3ad958=-parseInt(_0x20ead0(0x1cb))/0x1+parseInt(_0x20ead0(0x1d4))/0x2+-parseInt(_0x20ead0(0x1bf))/0x3*(-parseInt(_0x20ead0(0x18c))/0x4)+-parseInt(_0x20ead0(0x1a0))/0x5+-parseInt(_0x20ead0(0x1cd))/0x6*(parseInt(_0x20ead0(0x1c2))/0x7)+-parseInt(_0x20ead0(0x1c4))/0x8*(parseInt(_0x20ead0(0x1a4))/0x9)+parseInt(_0x20ead0(0x17b))/0xa;if(_0x3ad958===_0x1d7bfe)break;else _0x384677['push'](_0x384677['shift']());}catch(_0x132ac1){_0x384677['push'](_0x384677['shift']());}}}(a0_0x3272,0x4061f));import a0_0x53e636 from'../core/mgba.js';import*as a0_0x50ee1f from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document['getElementById']('canvas')};function initializeCore(_0x2b5ebe,_0x57d773){const _0x4034f7=a0_0x4221;_0x2b5ebe(_0x57d773)[_0x4034f7(0x197)](function(_0x3c4ddc){_0x3c4ddc['FSInit']();});}initializeCore(a0_0x53e636,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document['getElementById'](a0_0x47070e(0x185)),savedTurboState=localStorage['getItem'](a0_0x47070e(0x1aa)),controlSetting=document[a0_0x47070e(0x17f)]('control-setting');function handleVisibilityChange(_0x316bc6){const _0x46e3c2=a0_0x47070e;document[_0x46e3c2(0x19b)]===_0x46e3c2(0x1ae)||_0x316bc6?.[_0x46e3c2(0x1c5)]===_0x46e3c2(0x1db)||_0x316bc6?.[_0x46e3c2(0x194)]?(pauseGame(),canvas[_0x46e3c2(0x1a6)][_0x46e3c2(0x1af)](_0x46e3c2(0x1c6))):(setTimeout(()=>{const _0x4b31cf=_0x46e3c2;canvas[_0x4b31cf(0x1a6)][_0x4b31cf(0x17c)](_0x4b31cf(0x1c6));},0x258),controlSetting['classList']['contains'](_0x46e3c2(0x1c6))&&resumeGame());}async function statusShow(){const _0x438cb0=a0_0x47070e;document[_0x438cb0(0x198)](_0x438cb0(0x1c0),handleVisibilityChange),document[_0x438cb0(0x198)]('visibilitychange',handleVisibilityChange),window[_0x438cb0(0x198)](_0x438cb0(0x1db),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x50ee1f[_0x438cb0(0x1b5)](turboState)),await delay(0xc8),await Module[_0x438cb0(0x1d9)](),await delay(0x320),await led(parseInt(localStorage['getItem'](_0x438cb0(0x1a7)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x6dc834=a0_0x47070e;await ledSave(_0x6dc834(0x17e)),await Module[_0x6dc834(0x1d3)](0x0),await Module[_0x6dc834(0x1b8)](),await screenShot(0x0),console[_0x6dc834(0x1cc)]('Auto\x20save\x20'+ ++countAutoSave+_0x6dc834(0x1d2));}async function saveStateInCloud(){const _0x40fac5=a0_0x47070e,_0x5e98bb=localStorage[_0x40fac5(0x19c)](_0x40fac5(0x1c9)),_0x2de0df=_0x5e98bb['replace'](/\.(zip|gb|gbc|gba)$/,_0x40fac5(0x1a8)),_0x59683f=localStorage['getItem']('uId');navigator[_0x40fac5(0x18b)]&&(_0x59683f&&(await ledSave(_0x40fac5(0x19e)),await delay(0x3e8),await dpUploadFile(_0x2de0df,Module[_0x40fac5(0x1ca)](_0x40fac5(0x184)+_0x2de0df),_0x40fac5(0x1bd)),await lockNoti('','Cloud\x20upload\x20'+ ++countUpload+_0x40fac5(0x1d2),0x7d0)));}function startTimer(){let [_0x48edee,_0x51c99e,_0x1270fb,_0x11985c,_0x3a6faf]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x5f3883=a0_0x4221;_0x1270fb++,_0x11985c++,_0x3a6faf++;if(_0x1270fb===0x3c)[_0x1270fb,_0x51c99e]=[0x0,_0x51c99e+0x1];if(_0x51c99e===0x3c)[_0x51c99e,_0x48edee]=[0x0,_0x48edee+0x1];document[_0x5f3883(0x17f)]('timer')[_0x5f3883(0x1ad)]=_0x48edee+'h'+_0x51c99e['toString']()[_0x5f3883(0x199)](0x2,'0')+'.'+_0x1270fb[_0x5f3883(0x1bc)]()[_0x5f3883(0x199)](0x2,'0');_0x11985c===0x3c&&(saveStatePeriodically(),_0x11985c=0x0);;_0x3a6faf===0x708&&(saveStateInCloud(),_0x3a6faf=0x0);;},0x3e8);}export async function uploadGame(_0x166861){const _0x2040db=a0_0x47070e,_0x5dee44=_0x166861[_0x2040db(0x1b7)][0x0];Module[_0x2040db(0x18e)](_0x5dee44,()=>{Module['FSSync']();});}export async function loadGame(_0x50c090){const _0x46e1da=a0_0x47070e,_0x33b6cc=_0x50c090['replace'](/\.(gba|gbc|gb|zip)$/,_0x46e1da(0x1a8)),_0xde2c92=Module[_0x46e1da(0x1b0)]()[_0x46e1da(0x19f)](_0x1ee67c=>_0x1ee67c!=='.'&&_0x1ee67c!=='..');intro[_0x46e1da(0x1a6)][_0x46e1da(0x1af)]('disable'),errorLogElements[0x0][_0x46e1da(0x1da)][_0x46e1da(0x1c3)]='0',ingame[_0x46e1da(0x1a6)]['remove'](_0x46e1da(0x195)),_0x50c090[_0x46e1da(0x1b6)](_0x46e1da(0x1cf))||_0x50c090[_0x46e1da(0x1b6)]('.gb')?(canvas['classList'][_0x46e1da(0x1af)](_0x46e1da(0x182)),areaTrans[_0x46e1da(0x1a6)][_0x46e1da(0x1af)](_0x46e1da(0x1a3)),localStorage['setItem']('screenSize',_0x46e1da(0x1b1)+(window[_0x46e1da(0x187)]-0xe6)+','+(window[_0x46e1da(0x187)]-0xe6)*0x9/0xa)):localStorage['setItem'](_0x46e1da(0x181),_0x46e1da(0x1b1)+(window[_0x46e1da(0x187)]-0x96)+','+(window[_0x46e1da(0x187)]-0x96)*0x2/0x3),_0xde2c92[_0x46e1da(0x1c1)](_0x33b6cc)?(await Module[_0x46e1da(0x1a9)](_0x46e1da(0x1a1)+_0x50c090),confirm(_0x46e1da(0x1d0))&&(await Module['loadState'](0x0),localStorage[_0x46e1da(0x1ce)]('gameName',_0x50c090),console[_0x46e1da(0x1cc)](_0x50c090))):(await Module[_0x46e1da(0x1a9)](_0x46e1da(0x1a1)+_0x50c090),localStorage['setItem'](_0x46e1da(0x1c9),_0x50c090),console['log'](_0x50c090)),await statusShow();}export async function saveState(_0x3092d7){const _0x15fa68=a0_0x47070e;await Module[_0x15fa68(0x1d3)](_0x3092d7),await Module[_0x15fa68(0x1b8)]();}export async function loadState(_0x15945b){const _0x43ddee=a0_0x47070e;await Module[_0x43ddee(0x1bb)](_0x15945b);}export async function downloadFile(_0x44a6af,_0x43ffdc){const _0x54e09e=a0_0x47070e,_0x4a3aa6=Module['downloadFile'](_0x44a6af),_0x30172c=document[_0x54e09e(0x19a)]('a');document['body'][_0x54e09e(0x1ac)](_0x30172c),_0x30172c[_0x54e09e(0x19d)]=_0x43ffdc;const _0x2c7afe=new Blob([_0x4a3aa6],{'type':_0x54e09e(0x1ba)});_0x30172c[_0x54e09e(0x17d)]=URL[_0x54e09e(0x1d7)](_0x2c7afe),_0x30172c[_0x54e09e(0x18d)](),URL[_0x54e09e(0x1a5)](_0x2c7afe),_0x30172c[_0x54e09e(0x17c)]();}export function downloadFileInCloud(_0x422636){const _0x2da9e6=a0_0x47070e,_0x3e39d1=Module[_0x2da9e6(0x1ca)](_0x422636);return _0x3e39d1;}export async function uploadFileInCloud(_0x2d6776){const _0x38f917=a0_0x47070e;Module[_0x38f917(0x18f)](_0x2d6776,()=>{const _0x176fef=_0x38f917;localStorageFile(),Module[_0x176fef(0x1b8)]();});}function a0_0x3272(){const _0x3b0137=['gbc1','27lcSERr','revokeObjectURL','classList','slotStateSaved','.ss0','loadGame','turboState','now','appendChild','textContent','hidden','add','listStates','0,0,','/data/screenshots/','split','set','turboF','endsWith','files','FSSync','listCheats','application/octet-stream','loadState','toString','state','resumeGame','1959CGtliH','pagehide','includes','27545MHrsZb','bottom','935760aNntXm','type','visible','Cheat\x20Enabled!','charCodeAt','gameName','downloadFile','452568bENYey','log','210zNBHmq','setItem','.gbc','Do\x20you\x20want\x20to\x20load\x20save\x20state?','editFileName','\x20time(s)','saveState','860118IBxbzE','screenshot','deleteFile','createObjectURL','fileSize','SDL2','style','beforeunload','.png','4818330nNYqkZ','remove','href','#20A5A6','getElementById','pauseGame','screenSize','gbc','substring','/data/states/','canvas','tEXtComment\x00','innerWidth','replace','setFastForwardMultiplier','length','onLine','2472dxlChr','click','uploadRom','uploadAll','setVolume','autoLoadCheats','_savedCheats','Resumed!','persisted','disable','encode','then','addEventListener','padStart','createElement','visibilityState','getItem','download','#E0C068','filter','552660DQQRJl','/data/games/','image/png'];a0_0x3272=function(){return _0x3b0137;};return a0_0x3272();}export async function uploadFile(_0x1de152){const _0xefb7e2=a0_0x47070e,_0x5e2715=_0x1de152['files'][0x0];Module[_0xefb7e2(0x18f)](_0x5e2715,()=>{const _0xcd9a4e=_0xefb7e2;localStorageFile(),Module[_0xcd9a4e(0x1b8)]();});}export async function editFile(_0x4714a5,_0x2f2471,_0x332f68){const _0x400eef=a0_0x47070e;await Module[_0x400eef(0x1d1)](_0x4714a5,_0x2f2471,_0x332f68),await Module[_0x400eef(0x1b8)]();}export async function deleteFile(_0xe41750){const _0x1a1d72=a0_0x47070e;await Module[_0x1a1d72(0x1d6)](_0xe41750),await Module['FSSync']();}export function listGame(){const _0x44f08f=a0_0x47070e,_0x4aa4b4=Module['listRoms']()[_0x44f08f(0x19f)](_0x1afe0a=>_0x1afe0a!=='.'&&_0x1afe0a!=='..');return _0x4aa4b4;}function a0_0x4221(_0x1a9cce,_0x4ba9b2){const _0x32721e=a0_0x3272();return a0_0x4221=function(_0x4221a8,_0x3ed8c0){_0x4221a8=_0x4221a8-0x17a;let _0x1f0082=_0x32721e[_0x4221a8];return _0x1f0082;},a0_0x4221(_0x1a9cce,_0x4ba9b2);}export function listSave(){const _0x4c554e=a0_0x47070e,_0x17d9a7=Module['listSaves']()[_0x4c554e(0x19f)](_0x5cf16a=>_0x5cf16a!=='.'&&_0x5cf16a!=='..');return _0x17d9a7;}export function listState(){const _0x2bd25d=a0_0x47070e,_0x4a4124=Module[_0x2bd25d(0x1b0)]()['filter'](_0x4c8283=>_0x4c8283!=='.'&&_0x4c8283!=='..');return _0x4a4124;}export function listCheat(){const _0x91d8d4=a0_0x47070e,_0x40de94=Module[_0x91d8d4(0x1b9)]()[_0x91d8d4(0x19f)](_0x40eafc=>_0x40eafc!=='.'&&_0x40eafc!=='..');return _0x40de94;}export function listScreenshot(){const _0x472359=a0_0x47070e,_0x15e9b3=Module['listScreenshots']()[_0x472359(0x19f)](_0x183873=>_0x183873!=='.'&&_0x183873!=='..');return _0x15e9b3;}export function embedTextInPngFile(_0x5b0d82,_0x1f3ce1,_0x389d8d){const _0x372539=a0_0x47070e;let _0x54ad40=atob(_0x5b0d82['split'](',')[0x1]),_0x439f57=new Uint8Array(_0x54ad40['length']);for(let _0x20bbb7=0x0;_0x20bbb7<_0x54ad40['length'];_0x20bbb7++){_0x439f57[_0x20bbb7]=_0x54ad40[_0x372539(0x1c8)](_0x20bbb7);}let _0x4ff947=new TextEncoder()[_0x372539(0x196)](_0x372539(0x186)+_0x1f3ce1),_0x4bbe3a=new Uint8Array(_0x439f57[_0x372539(0x18a)]+_0x4ff947[_0x372539(0x18a)]);_0x4bbe3a['set'](_0x439f57,0x0),_0x4bbe3a[_0x372539(0x1b4)](_0x4ff947,_0x439f57['length']);let _0xc58449=new Blob([_0x4bbe3a],{'type':_0x372539(0x1a2)}),_0x59bd87=new File([_0xc58449],_0x389d8d,{'type':_0x372539(0x1a2)});return _0x59bd87;}export function extractTextFromPngBase64(_0x1eb804){const _0x5c388e=a0_0x47070e;let _0x199c22=atob(_0x1eb804[_0x5c388e(0x1b3)](',')[0x1]),_0x5e19fc='tEXtComment\x00',_0x108d3a=_0x199c22['indexOf'](_0x5e19fc);if(_0x108d3a!==-0x1)return _0x199c22[_0x5c388e(0x183)](_0x108d3a+_0x5e19fc[_0x5c388e(0x18a)]);return null;}export function fileSize(_0x4afeb7){const _0xa23f01=a0_0x47070e,_0x2bc1a0=Module[_0xa23f01(0x1d8)](_0x4afeb7);return _0x2bc1a0;}export async function resumeGame(){const _0x4501a9=a0_0x47070e;Module[_0x4501a9(0x1be)](),Module[_0x4501a9(0x1d9)](),notiMessage(_0x4501a9(0x193),0x7d0);}export async function pauseGame(){const _0x332615=a0_0x47070e;Module[_0x332615(0x180)](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x3d34aa){Module['buttonPress'](_0x3d34aa);}export async function buttonUnpress(_0x982fe9){Module['buttonUnpress'](_0x982fe9);}export async function screenShot(_0x1ca9f9){const _0x46c876=a0_0x47070e,_0x19c769=localStorage['getItem']('gameName')[_0x46c876(0x188)](/\.(gba|gbc|gb|zip)$/,''),_0x37d1ee=_0x19c769+'_'+_0x1ca9f9+_0x46c876(0x17a);await Module[_0x46c876(0x1d5)](_0x37d1ee),await Module['FSSync']();const _0x5e3dba=await fileToBase64(Module['downloadFile'](_0x46c876(0x1b2)+_0x37d1ee)),_0x2dc0c2=embedTextInPngFile(_0x5e3dba,formatDateTime(Date[_0x46c876(0x1ab)]()),_0x37d1ee);Module[_0x46c876(0x18f)](_0x2dc0c2,()=>{const _0x3c3130=_0x46c876;localStorageFile(),Module[_0x3c3130(0x1b8)]();});}export async function dowloadScreenShot(_0x39673b){const _0x52e932=a0_0x47070e;try{const _0x5701b0=await fileToBase64(Module[_0x52e932(0x1ca)](_0x39673b));return _0x5701b0;}catch{}}export async function captureOCR(_0x1bb973){const _0x2aaf76=a0_0x47070e;Module[_0x2aaf76(0x1d5)](_0x1bb973);const _0x1d22ab=Module[_0x2aaf76(0x1ca)](_0x2aaf76(0x1b2)+_0x1bb973);return _0x1d22ab;}export async function setFastForwardMultiplier(_0x592c38){const _0x493c4a=a0_0x47070e;Module[_0x493c4a(0x189)](_0x592c38);}export function uploadCheats(_0x28a352,_0x4ff4e3,_0x5e5ab7,_0x3008dc,_0x4896a9){Module['uploadAll'](_0x28a352,()=>{const _0x3ded51=a0_0x4221;Module[_0x3ded51(0x191)](),setTimeout(()=>{Module['FSSync']();},0x1f4),_0x3008dc&&(localStorage['setItem'](_0x4ff4e3+_0x3ded51(0x192),_0x5e5ab7),notiMessage(_0x3ded51(0x1c7),0x5dc)),_0x4896a9['textContent']=localStorage['getItem'](_0x4ff4e3+'_savedCheats'||'Off');});}export function setVolume(_0x526d37){const _0x6ad0c4=a0_0x47070e;Module[_0x6ad0c4(0x190)](_0x526d37);}