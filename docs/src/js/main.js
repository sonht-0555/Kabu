const a0_0x1fbb75=a0_0x4eae;(function(_0x56ee01,_0x389f04){const _0x5ae8af=a0_0x4eae,_0x1026c6=_0x56ee01();while(!![]){try{const _0x1edb09=parseInt(_0x5ae8af(0xdd))/0x1*(-parseInt(_0x5ae8af(0xbe))/0x2)+-parseInt(_0x5ae8af(0xd0))/0x3*(-parseInt(_0x5ae8af(0x105))/0x4)+parseInt(_0x5ae8af(0x114))/0x5*(-parseInt(_0x5ae8af(0x10b))/0x6)+parseInt(_0x5ae8af(0xb1))/0x7*(parseInt(_0x5ae8af(0xfc))/0x8)+parseInt(_0x5ae8af(0xb6))/0x9+parseInt(_0x5ae8af(0x10e))/0xa+-parseInt(_0x5ae8af(0xe2))/0xb;if(_0x1edb09===_0x389f04)break;else _0x1026c6['push'](_0x1026c6['shift']());}catch(_0x29d1aa){_0x1026c6['push'](_0x1026c6['shift']());}}}(a0_0xb14c,0x42aef));import a0_0x15a28b from'../core/mgba.js';import*as a0_0x1a39fa from'./gamepad.js';import{localStorageFile}from'./storage.js';function a0_0x4eae(_0x3e3dca,_0x5993ec){const _0xb14c4b=a0_0xb14c();return a0_0x4eae=function(_0x4eaeb6,_0x5e23e8){_0x4eaeb6=_0x4eaeb6-0xae;let _0x1a5241=_0xb14c4b[_0x4eaeb6];return _0x1a5241;},a0_0x4eae(_0x3e3dca,_0x5993ec);}import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x1fbb75(0xcd)](a0_0x1fbb75(0xe5))};function initializeCore(_0x15f6d2,_0x1adb99){const _0x1b4f0b=a0_0x1fbb75;_0x15f6d2(_0x1adb99)[_0x1b4f0b(0xbb)](function(_0x59f851){const _0x476558=_0x1b4f0b;_0x59f851[_0x476558(0xc1)]();});}initializeCore(a0_0x15a28b,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x1fbb75(0xcd)](a0_0x1fbb75(0xe5)),savedTurboState=localStorage[a0_0x1fbb75(0xef)](a0_0x1fbb75(0xc2)),controlSetting=document[a0_0x1fbb75(0xcd)](a0_0x1fbb75(0x101));function handleVisibilityChange(_0x589ed5){const _0x231a2d=a0_0x1fbb75;document[_0x231a2d(0xe0)]===_0x231a2d(0xdb)||_0x589ed5?.[_0x231a2d(0xd7)]===_0x231a2d(0x10f)||_0x589ed5?.[_0x231a2d(0x111)]?(pauseGame(),canvas['classList']['add'](_0x231a2d(0xba))):(setTimeout(()=>{const _0x6ffebb=_0x231a2d;canvas[_0x6ffebb(0xe4)][_0x6ffebb(0xb2)]('visible');},0x258),controlSetting[_0x231a2d(0xe4)][_0x231a2d(0xf0)](_0x231a2d(0xba))&&resumeGame());}async function statusShow(){const _0x45661f=a0_0x1fbb75;document[_0x45661f(0xc3)]('pagehide',handleVisibilityChange),document['addEventListener'](_0x45661f(0xc0),handleVisibilityChange),window[_0x45661f(0xc3)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x1a39fa[_0x45661f(0xf1)](turboState)),await delay(0x3e8),await led(parseInt(localStorage['getItem'](_0x45661f(0xfb)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x2d1fa7=a0_0x1fbb75;await ledSave(_0x2d1fa7(0x113)),await Module['saveState'](0x0),await Module[_0x2d1fa7(0xcb)](),await screenShot(0x0),console[_0x2d1fa7(0xf2)]('Auto\x20save\x20'+ ++countAutoSave+_0x2d1fa7(0xf4));}async function saveStateInCloud(){const _0x36485d=a0_0x1fbb75,_0x227130=localStorage['getItem'](_0x36485d(0xb4)),_0x12dd93=_0x227130['replace'](_0x36485d(0x10a),'.ss0'),_0x4a76bb=localStorage[_0x36485d(0xef)](_0x36485d(0xeb)),_0x1a7655=localStorage[_0x36485d(0xef)](_0x227130+_0x36485d(0xfe)),_0x3437c=localStorage[_0x36485d(0xef)](_0x227130+_0x36485d(0xb9));if(navigator[_0x36485d(0xec)]){if(_0x4a76bb){await ledSave(_0x36485d(0xf8)),await delay(0x3e8),await dpUploadFile(_0x12dd93,Module[_0x36485d(0x106)](_0x36485d(0x115)+_0x12dd93));if(_0x1a7655!==null){const _0x2490e5=_0x1a7655+'\x0a\x0a'+_0x3437c,_0xf539df=new Blob([_0x2490e5],{'type':_0x36485d(0x107)});await dpUploadFile(_0x227130+_0x36485d(0xf5),_0xf539df);}else console[_0x36485d(0xf2)](_0x36485d(0xf9));await lockNoti('',_0x36485d(0xcf)+ ++countUpload+_0x36485d(0xf4),0x7d0);}else console['log'](_0x36485d(0xd2));}else console[_0x36485d(0xf2)](_0x36485d(0xc4));}function startTimer(){let [_0x54c977,_0x4c06f2,_0x43465c,_0x374cb6,_0x1e17ec]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x395230=a0_0x4eae;_0x43465c++,_0x374cb6++,_0x1e17ec++;if(_0x43465c===0x3c)[_0x43465c,_0x4c06f2]=[0x0,_0x4c06f2+0x1];if(_0x4c06f2===0x3c)[_0x4c06f2,_0x54c977]=[0x0,_0x54c977+0x1];document[_0x395230(0xcd)](_0x395230(0xb8))[_0x395230(0xe9)]=_0x54c977+'h'+_0x4c06f2[_0x395230(0xdc)]()[_0x395230(0xbd)](0x2,'0')+'.'+_0x43465c['toString']()[_0x395230(0xbd)](0x2,'0');_0x374cb6===0x3c&&(saveStatePeriodically(),_0x374cb6=0x0);;_0x374cb6===0xe10&&(saveStateInCloud(),_0x1e17ec=0x0);;},0x3e8);}export async function uploadGame(_0x176ed8){const _0x160f24=a0_0x1fbb75,_0x9dd6e7=_0x176ed8[_0x160f24(0xff)][0x0];Module[_0x160f24(0xbf)](_0x9dd6e7,()=>{const _0x5d6f1e=_0x160f24;Module[_0x5d6f1e(0xcb)]();});}export async function loadGame(_0x29744e){const _0x27571a=a0_0x1fbb75,_0x40f7f1=_0x29744e[_0x27571a(0xf3)](/\.(gba|gbc|gb|zip)$/,_0x27571a(0xd8)),_0x5de580=Module[_0x27571a(0xda)]();intro[_0x27571a(0xe4)][_0x27571a(0xfa)](_0x27571a(0xe7)),errorLogElements[0x0]['style'][_0x27571a(0xd5)]='0',ingame[_0x27571a(0xe4)][_0x27571a(0xb2)]('disable'),_0x29744e['endsWith'](_0x27571a(0xb0))||_0x29744e['endsWith'](_0x27571a(0xae))?(canvas['classList'][_0x27571a(0xfa)]('gbc'),areaTrans[_0x27571a(0xe4)][_0x27571a(0xfa)](_0x27571a(0xc6)),localStorage[_0x27571a(0x10d)]('screenSize',_0x27571a(0xe6)+(window[_0x27571a(0xd4)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x27571a(0x10d)]('screenSize',_0x27571a(0xe6)+(window[_0x27571a(0xd4)]-0x96)+','+(window[_0x27571a(0xd4)]-0x96)*0x2/0x3),_0x5de580[_0x27571a(0x108)](_0x40f7f1)?(await Module['loadGame'](_0x27571a(0xd1)+_0x29744e),confirm(_0x27571a(0x103))&&(await Module[_0x27571a(0xce)](0x0),localStorage['setItem'](_0x27571a(0xb4),_0x29744e),console[_0x27571a(0xf2)](_0x29744e))):(await Module['loadGame'](_0x27571a(0xd1)+_0x29744e),localStorage[_0x27571a(0x10d)]('gameName',_0x29744e)),await statusShow();}export async function saveState(_0x26a15f){const _0x12e0d7=a0_0x1fbb75;await Module[_0x12e0d7(0xb5)](_0x26a15f),await Module[_0x12e0d7(0xcb)]();}export async function loadState(_0xc72aa5){const _0x3565b4=a0_0x1fbb75;await Module[_0x3565b4(0xce)](_0xc72aa5);}export async function downloadFile(_0x46b7c9,_0x5cefae){const _0x5769ae=a0_0x1fbb75,_0x4a87e0=Module[_0x5769ae(0x106)](_0x46b7c9),_0x5e303c=document[_0x5769ae(0xe1)]('a');document[_0x5769ae(0xb3)]['appendChild'](_0x5e303c),_0x5e303c['download']=_0x5cefae;const _0x38f297=new Blob([_0x4a87e0],{'type':_0x5769ae(0xd9)});_0x5e303c[_0x5769ae(0xe3)]=URL[_0x5769ae(0xdf)](_0x38f297),_0x5e303c[_0x5769ae(0x100)](),URL['revokeObjectURL'](_0x38f297),_0x5e303c[_0x5769ae(0xb2)]();}export function downloadFileInCloud(_0x21b272){const _0x466ec8=a0_0x1fbb75,_0x374ee6=Module[_0x466ec8(0x106)](_0x21b272);return _0x374ee6;}export async function uploadFile(_0x3d67b2){const _0x59bf60=a0_0x1fbb75,_0xdbaa50=_0x3d67b2[_0x59bf60(0xff)][0x0];Module['uploadSaveOrSaveState'](_0xdbaa50,()=>{const _0x4c59c9=_0x59bf60;Module[_0x4c59c9(0xcb)]();});}export async function editFile(_0xc681c0,_0x3c105d,_0x77462a){const _0x2529d1=a0_0x1fbb75;await Module['editFileName'](_0xc681c0,_0x3c105d,_0x77462a),await Module[_0x2529d1(0xcb)]();}function a0_0xb14c(){const _0x50a99a=['Error\x20uploadSavSta:','_imageState0','files','click','control-setting','buttonPress','Do\x20you\x20want\x20to\x20load\x20save\x20state?','uploadSaveOrSaveState','4aAymYx','downloadFile','text/plain','includes','uploadCheats','.gba','12BgGMfH','screenshot','setItem','4390570BNcsPx','beforeunload','_imageState','persisted','Paused!','#20A5A6','1313285DWpAtO','/data/states/','.gb','buttonUnpress','.gbc','63553iBhOsF','remove','body','gameName','saveState','3540906EEwJMk','name','timer','_dateState0','visible','then','.png','padStart','30mlSJnf','uploadRom','visibilitychange','FSInit','turboState','addEventListener','Online!','setFastForwardMultiplier','gbc1','SDL2','/data/screenshots/','listCheats','listGames','FSSync','_savedCheats','getElementById','loadState','Cloud\x20upload\x20','398091hQVsNI','/data/games/','Unable\x20to\x20upload\x20to\x20Cloud!','Error\x20uploadCheat:','innerWidth','bottom','Off','type','.ss0','application/octet-stream','listStates','hidden','toString','6817qSYIvg','_dateState','createObjectURL','visibilityState','createElement','3305918bsaTaa','href','classList','canvas','0,0,','disable','Cheat\x20uploaded\x20successfully:','textContent','now','uId','onLine','autoLoadCheats','pauseGame','getItem','contains','turboF','log','replace','\x20time(s)','_slot0.txt','deleteFile','error','#E0C068','No\x20screenshot!','add','slotStateSaved','208VNsOOE'];a0_0xb14c=function(){return _0x50a99a;};return a0_0xb14c();}export async function deleteFile(_0x15f1f3){const _0x56ea26=a0_0x1fbb75;await Module[_0x56ea26(0xf6)](_0x15f1f3),await Module[_0x56ea26(0xcb)]();}export function listGame(){const _0x393d29=a0_0x1fbb75,_0x3e8760=Module[_0x393d29(0xca)]();return _0x3e8760;}export function listSave(){const _0x1760b6=Module['listSaves']();return _0x1760b6;}export function listState(){const _0x548461=Module['listStates']();return _0x548461;}export function listCheat(){const _0x37365d=a0_0x1fbb75,_0x108926=Module[_0x37365d(0xc9)]();return _0x108926;}export function listScreenshot(){const _0x525520=Module['listScreenshots']();return _0x525520;}export function fileSize(_0x4d4cef){const _0x688c01=Module['fileSize'](_0x4d4cef);return _0x688c01;}export async function uploadCheat(_0x5b5ba5){const _0x117435=a0_0x1fbb75;try{const _0x3becc8=_0x5b5ba5[_0x117435(0xff)][0x0];await Module[_0x117435(0x109)](_0x3becc8,()=>{const _0xb779d3=_0x117435;console[_0xb779d3(0xf2)](_0xb779d3(0xe8),_0x3becc8['name']),localStorageFile(),Module[_0xb779d3(0xcb)]();});}catch(_0xa5444a){console[_0x117435(0xf7)](_0x117435(0xd3),_0xa5444a);}}export async function uploadSavSta(_0x466723){const _0x5c3bff=a0_0x1fbb75;try{const _0x3ae416=_0x466723['files'][0x0];await Module[_0x5c3bff(0x104)](_0x3ae416,()=>{const _0x1d7fbe=_0x5c3bff;console[_0x1d7fbe(0xf2)]('Save/State\x20uploaded\x20successfully:',_0x3ae416[_0x1d7fbe(0xb7)]),localStorageFile(),Module[_0x1d7fbe(0xcb)]();});}catch(_0x1e4756){console['error'](_0x5c3bff(0xfd),_0x1e4756);}}export async function uploadSaveOrSaveState(_0x26cdc0){const _0x2c786f=a0_0x1fbb75;Module[_0x2c786f(0x104)](_0x26cdc0,()=>{const _0xfb6d54=_0x2c786f;localStorageFile(),Module[_0xfb6d54(0xcb)]();});}export async function resumeGame(){const _0x26cfc4=a0_0x1fbb75;Module['resumeGame'](),Module[_0x26cfc4(0xc7)](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x30c998=a0_0x1fbb75;Module[_0x30c998(0xee)](),Module['SDL2'](),notiMessage(_0x30c998(0x112),0x7d0);}export async function buttonPress(_0x5b0f02){const _0x10e487=a0_0x1fbb75;Module[_0x10e487(0x102)](_0x5b0f02);}export async function buttonUnpress(_0x6d5dab){const _0x222ce6=a0_0x1fbb75;Module[_0x222ce6(0xaf)](_0x6d5dab);}export async function screenShot(_0x12936a){const _0x103ee5=a0_0x1fbb75,_0x24c924=localStorage[_0x103ee5(0xef)](_0x103ee5(0xb4)),_0x149322=_0x24c924[_0x103ee5(0xf3)](/\.(gba|gbc|gb|zip)$/,'_');await Module[_0x103ee5(0x10c)](''+_0x149322+_0x12936a+_0x103ee5(0xbc)),await Module[_0x103ee5(0xcb)]();const _0x5dfece=await fileToBase64(Module[_0x103ee5(0x106)](_0x103ee5(0xc8)+_0x149322+_0x12936a+_0x103ee5(0xbc))),_0x5a4f1f=Date[_0x103ee5(0xea)](),_0x10dd88=formatDateTime(_0x5a4f1f);localStorage[_0x103ee5(0x10d)](_0x24c924+_0x103ee5(0xde)+_0x12936a,_0x10dd88),localStorage['setItem'](_0x24c924+_0x103ee5(0x110)+_0x12936a,_0x5dfece);}export async function captureOCR(_0x25d7cb){const _0x5c8f4b=a0_0x1fbb75;Module[_0x5c8f4b(0x10c)](_0x25d7cb);const _0x57408b=Module[_0x5c8f4b(0x106)]('/data/screenshots/'+_0x25d7cb);return _0x57408b;}export async function setFastForwardMultiplier(_0x46957f){const _0x45a86b=a0_0x1fbb75;Module[_0x45a86b(0xc5)](_0x46957f);}export function uploadCheats(_0x394e22,_0x208305,_0x45026e,_0x4a9ad7,_0x14ce4a){const _0xd1ceff=a0_0x1fbb75;Module[_0xd1ceff(0x109)](_0x394e22,()=>{const _0x6c7151=_0xd1ceff;Module[_0x6c7151(0xed)](),setTimeout(()=>{const _0x732de7=_0x6c7151;Module[_0x732de7(0xcb)]();},0x1f4),_0x4a9ad7&&(localStorage[_0x6c7151(0x10d)](_0x208305+_0x6c7151(0xcc),_0x45026e),notiMessage('Cheat\x20Enabled!',0x5dc)),_0x14ce4a[_0x6c7151(0xe9)]=localStorage['getItem'](_0x208305+_0x6c7151(0xcc)||_0x6c7151(0xd6));});}