const a0_0x51c1ef=a0_0x32da;(function(_0x416be0,_0x5ec157){const _0x5b190f=a0_0x32da,_0x5ba476=_0x416be0();while(!![]){try{const _0x3e157f=-parseInt(_0x5b190f(0x1be))/0x1*(-parseInt(_0x5b190f(0x1e3))/0x2)+parseInt(_0x5b190f(0x222))/0x3+-parseInt(_0x5b190f(0x215))/0x4*(-parseInt(_0x5b190f(0x20d))/0x5)+-parseInt(_0x5b190f(0x21e))/0x6*(-parseInt(_0x5b190f(0x1bf))/0x7)+-parseInt(_0x5b190f(0x1dc))/0x8*(-parseInt(_0x5b190f(0x1e7))/0x9)+-parseInt(_0x5b190f(0x1da))/0xa*(-parseInt(_0x5b190f(0x1c5))/0xb)+parseInt(_0x5b190f(0x1c3))/0xc*(-parseInt(_0x5b190f(0x1ec))/0xd);if(_0x3e157f===_0x5ec157)break;else _0x5ba476['push'](_0x5ba476['shift']());}catch(_0x2da3e5){_0x5ba476['push'](_0x5ba476['shift']());}}}(a0_0x10fc,0x73556));import a0_0x43d87c from'../core/mgba.js';import*as a0_0x3fb7d8 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0x51c1ef(0x208)](a0_0x51c1ef(0x1b4))};function initializeCore(_0x215eb2,_0xe3e07f){const _0x28bbdd=a0_0x51c1ef;_0x215eb2(_0xe3e07f)[_0x28bbdd(0x224)](function(_0x127d16){const _0x21e929=_0x28bbdd;_0x127d16[_0x21e929(0x225)]();});}initializeCore(a0_0x43d87c,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x51c1ef(0x208)]('canvas'),controlSetting=document[a0_0x51c1ef(0x208)](a0_0x51c1ef(0x1bd));function handleVisibilityChange(_0x411beb){const _0x9d5488=a0_0x51c1ef;document['visibilityState']==='hidden'||_0x411beb?.[_0x9d5488(0x1d3)]===_0x9d5488(0x227)||_0x411beb?.['persisted']?(Module[_0x9d5488(0x1ba)](),pauseGame(),canvas[_0x9d5488(0x218)][_0x9d5488(0x1e5)](_0x9d5488(0x21b))):(setTimeout(()=>{const _0x3cba39=_0x9d5488;canvas[_0x3cba39(0x218)][_0x3cba39(0x1e1)](_0x3cba39(0x21b));},0x258),controlSetting[_0x9d5488(0x218)][_0x9d5488(0x1d5)]('visible')&&resumeGame());}async function statusShow(){const _0x33316b=a0_0x51c1ef;document['addEventListener'](_0x33316b(0x200),handleVisibilityChange),document[_0x33316b(0x229)](_0x33316b(0x232),handleVisibilityChange),window[_0x33316b(0x229)](_0x33316b(0x227),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x3fb7d8[_0x33316b(0x22d)](parseInt(await getData(gameName,'0','turboState'))),await delay(0xc8),await Module[_0x33316b(0x206)](),await delay(0x320),await led(parseInt(await getData(gameName,'0','slotStateSaved'))),await notiMessage(gameVer,0x3e8),await wrapContent();}function a0_0x32da(_0x35f9a9,_0x18370c){const _0x10fc1e=a0_0x10fc();return a0_0x32da=function(_0x32daf2,_0x2840d9){_0x32daf2=_0x32daf2-0x1b4;let _0x2c149a=_0x10fc1e[_0x32daf2];return _0x2c149a;},a0_0x32da(_0x35f9a9,_0x18370c);}async function saveStatePeriodically(){const _0x42c9a3=a0_0x51c1ef;await ledSave(_0x42c9a3(0x219)),await Module[_0x42c9a3(0x1d1)](0x0),await Module[_0x42c9a3(0x1ba)](),await screenShot(0x0),console[_0x42c9a3(0x1cd)](_0x42c9a3(0x233)+ ++countAutoSave+_0x42c9a3(0x1c1));}async function saveStateInCloud(){const _0x413e84=a0_0x51c1ef,_0xcfa529=gameName[_0x413e84(0x20b)](/\.(zip|gb|gbc|gba)$/,_0x413e84(0x1bc)),_0x5bbf0e=localStorage[_0x413e84(0x212)](_0x413e84(0x1cb));navigator[_0x413e84(0x1ca)]&&(_0x5bbf0e&&(await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0xcfa529,Module[_0x413e84(0x22e)](_0x413e84(0x1e4)+_0xcfa529),_0x413e84(0x1c6)),await lockNoti('',_0x413e84(0x1d9)+ ++countUpload+_0x413e84(0x1c1),0x7d0)));}function startTimer(){let [_0x41f183,_0x1f325a,_0x8249c2,_0x282b41,_0x24cced]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x3023e6=a0_0x32da;_0x8249c2++,_0x282b41++,_0x24cced++;if(_0x8249c2===0x3c)[_0x8249c2,_0x1f325a]=[0x0,_0x1f325a+0x1];if(_0x1f325a===0x3c)[_0x1f325a,_0x41f183]=[0x0,_0x41f183+0x1];document[_0x3023e6(0x208)](_0x3023e6(0x202))[_0x3023e6(0x1d4)]=_0x41f183+'h'+_0x1f325a[_0x3023e6(0x1c8)]()[_0x3023e6(0x226)](0x2,'0')+'.'+_0x8249c2[_0x3023e6(0x1c8)]()[_0x3023e6(0x226)](0x2,'0');_0x282b41===0x3c&&(saveStatePeriodically(),_0x282b41=0x0);;_0x24cced===0x708&&(saveStateInCloud(),_0x24cced=0x0);;},0x3e8);}export async function uploadGame(_0x371857){const _0x1f64d9=a0_0x51c1ef,_0x23daf3=_0x371857[_0x1f64d9(0x231)][0x0];Module[_0x1f64d9(0x217)](_0x23daf3,()=>{const _0x53e6d3=_0x1f64d9;Module[_0x53e6d3(0x1ba)]();});}export async function loadGame(_0x1171fe){const _0x17040a=a0_0x51c1ef,_0x568677=_0x1171fe[_0x17040a(0x20b)](/\.(gba|gbc|gb|zip)$/,'.ss0'),_0x352bf8=Module['listFiles'](_0x17040a(0x1f6))[_0x17040a(0x22a)](_0x120222=>_0x120222!=='.'&&_0x120222!=='..');intro[_0x17040a(0x218)][_0x17040a(0x1e5)]('disable'),errorLogElements[0x0]['style'][_0x17040a(0x22c)]='0',ingame['classList']['remove'](_0x17040a(0x1ee)),_0x1171fe[_0x17040a(0x21f)](_0x17040a(0x20f))||_0x1171fe['endsWith'](_0x17040a(0x1d7))?(canvas[_0x17040a(0x218)][_0x17040a(0x1e5)]('gbc'),areaTrans[_0x17040a(0x218)][_0x17040a(0x1e5)](_0x17040a(0x21c)),localStorage[_0x17040a(0x22f)](_0x17040a(0x1f0),'0,0,'+(window[_0x17040a(0x207)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage['setItem']('screenSize',_0x17040a(0x1fd)+(window['innerWidth']-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x352bf8[_0x17040a(0x1ea)](_0x568677)?(await Module['loadGame']('/data/games/'+_0x1171fe),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await delay(0x64),await Module[_0x17040a(0x1ed)](0x0),await shaderData())):(await Module[_0x17040a(0x211)](_0x17040a(0x1f2)+_0x1171fe),await shaderData()),await statusShow();}export async function saveState(_0x2accc4){const _0x17c616=a0_0x51c1ef;await Module[_0x17c616(0x1d1)](_0x2accc4);}export async function loadState(_0x289d10){const _0x215019=a0_0x51c1ef;await Module[_0x215019(0x1ed)](_0x289d10);}export async function downloadFile(_0x4bfd1f,_0x3cde71){const _0x3f24de=a0_0x51c1ef,_0x3ad5fd=Module['downloadFile'](_0x4bfd1f),_0x36e4a7=document[_0x3f24de(0x221)]('a');document[_0x3f24de(0x1f1)]['appendChild'](_0x36e4a7),_0x36e4a7['download']=_0x3cde71;const _0x49ef39=new Blob([_0x3ad5fd],{'type':_0x3f24de(0x1e0)});_0x36e4a7[_0x3f24de(0x1b7)]=URL['createObjectURL'](_0x49ef39),_0x36e4a7[_0x3f24de(0x1f9)](),URL[_0x3f24de(0x1d2)](_0x49ef39),_0x36e4a7['remove']();}export function downloadFileInCloud(_0x12ff82){const _0x46c798=a0_0x51c1ef;try{const _0x1fe659=Module[_0x46c798(0x22e)](_0x12ff82);return _0x1fe659;}catch(_0x152423){return null;}}export async function uploadFileInCloud(_0x2f7836){const _0x3d2150=a0_0x51c1ef;Module[_0x3d2150(0x1b8)](_0x2f7836,async()=>{localStorageFile(),await Module['FSSync']();});}export async function uploadFile(_0x59bf1f){const _0xd98859=a0_0x51c1ef,_0x18a412=_0x59bf1f[_0xd98859(0x231)][0x0];Module[_0xd98859(0x1b8)](_0x18a412,async()=>{const _0xe6ccb0=_0xd98859;localStorageFile(),await Module[_0xe6ccb0(0x1ba)]();});}export async function editFile(_0x1f904e,_0x513384,_0x7fcb65){await Module['editFileName'](_0x1f904e,_0x513384,_0x7fcb65);}export async function deleteFile(_0x35882a){const _0x581249=a0_0x51c1ef;try{return await Module['deleteFile'](_0x35882a),!![];}catch(_0x535be8){return console[_0x581249(0x21a)](_0x35882a),null;}}export function listFiles(_0x343297){const _0x4a3d55=a0_0x51c1ef,_0x5a4783=Module[_0x4a3d55(0x213)](_0x343297)['filter'](_0x1a895c=>_0x1a895c!=='.'&&_0x1a895c!=='..');return _0x5a4783;}export function listGame(){const _0xe29a90=a0_0x51c1ef,_0xf67d8b=Module[_0xe29a90(0x1db)]()[_0xe29a90(0x22a)](_0x1ba97c=>_0x1ba97c!=='.'&&_0x1ba97c!=='..');return _0xf67d8b;}export function listSave(){const _0x1ce1f3=a0_0x51c1ef,_0x2bbbfd=Module['listSaves']()[_0x1ce1f3(0x22a)](_0x5eff5e=>_0x5eff5e!=='.'&&_0x5eff5e!=='..');return _0x2bbbfd;}export function listState(){const _0x5b5760=a0_0x51c1ef,_0x139143=Module[_0x5b5760(0x20a)]()[_0x5b5760(0x22a)](_0x4a7f02=>_0x4a7f02!=='.'&&_0x4a7f02!=='..');return _0x139143;}export function listCheat(){const _0x2e279d=a0_0x51c1ef,_0x217924=Module[_0x2e279d(0x1eb)]()['filter'](_0x2e92f1=>_0x2e92f1!=='.'&&_0x2e92f1!=='..');return _0x217924;}export function listScreenshot(){const _0xfaa5ca=a0_0x51c1ef,_0x3d9296=Module[_0xfaa5ca(0x22b)]()[_0xfaa5ca(0x22a)](_0x53da61=>_0x53da61!=='.'&&_0x53da61!=='..');return _0x3d9296;}export function fileSize(_0x4ada56){const _0x2725fe=a0_0x51c1ef,_0x54bfef=Module[_0x2725fe(0x230)](_0x4ada56);return _0x54bfef;}export async function resumeGame(){const _0x4701b6=a0_0x51c1ef;Module[_0x4701b6(0x1f8)](),Module['SDL2'](),notiMessage(_0x4701b6(0x223),0x7d0);}export async function pauseGame(){const _0x1ff370=a0_0x51c1ef;Module[_0x1ff370(0x1f4)](),Module[_0x1ff370(0x206)](),notiMessage(_0x1ff370(0x1e2),0x7d0);}export async function buttonPress(_0x4702fc){Module['buttonPress'](_0x4702fc);}export async function buttonUnpress(_0x490519){const _0xa77af8=a0_0x51c1ef;Module[_0xa77af8(0x1fc)](_0x490519);}export async function screenShot(_0x56303d){const _0x1fae64=a0_0x51c1ef,_0x58edb9=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0x56303d+_0x1fae64(0x1ce)),_0x50a62f=await getData(gameName,_0x56303d,_0x1fae64(0x1fe))||'';console[_0x1fae64(0x1cd)](_0x50a62f),await Module['screenshot'](_0x58edb9),await setData(gameName,_0x56303d,_0x1fae64(0x1df),formatDateTime(Date[_0x1fae64(0x214)]()),_0x50a62f);}export async function dowloadScreenShot(_0x271e7c){try{const _0xbc1dd=await fileToBase64(Module['downloadFile'](_0x271e7c));return _0xbc1dd;}catch{}}export async function captureOCR(_0x2aa0ad){const _0x5aa1e6=a0_0x51c1ef;Module['screenshot'](_0x2aa0ad);const _0x5dfb3a=Module[_0x5aa1e6(0x22e)](_0x5aa1e6(0x216)+_0x2aa0ad);return _0x5dfb3a;}export async function setFastForwardMultiplier(_0x222fee){const _0x1dd54b=a0_0x51c1ef;Module[_0x1dd54b(0x1cc)](_0x222fee);}export async function uploadCheats(_0x212245){const _0xc50e1f=a0_0x51c1ef;Module[_0xc50e1f(0x1e9)](),Module[_0xc50e1f(0x1b8)](_0x212245,async()=>{});}export function setVolume(_0x263940){const _0xf1c44d=a0_0x51c1ef;Module[_0xf1c44d(0x1dd)](_0x263940);}export async function setData(_0x22c046,_0x347921,_0x283975,_0x1563c9,_0x5c7708=''){const _0x41b42b=a0_0x51c1ef,_0x1e9cef=_0x22c046[_0x41b42b(0x20b)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x5d901a=_0x41b42b(0x216)+_0x1e9cef+'_'+_0x347921+_0x41b42b(0x1ce);let _0x14459a;try{_0x14459a=await fileToBase64(Module[_0x41b42b(0x22e)](_0x5d901a));}catch(_0xd1270){await Module[_0x41b42b(0x1e6)](_0x1e9cef+'_'+_0x347921+_0x41b42b(0x1ce)),await delay(0xc8),_0x14459a=await fileToBase64(Module[_0x41b42b(0x22e)](_0x5d901a));}let _0x1290ba=atob(_0x14459a[_0x41b42b(0x1c2)](',')[0x1]),_0x3c8950=_0x41b42b(0x1c9),_0x40ea5c=_0x1290ba[_0x41b42b(0x210)](_0x3c8950),_0x4341a9={};if(_0x40ea5c!==-0x1||_0x5c7708['trim']()!==''){let _0x50dcb4=_0x40ea5c!==-0x1?_0x1290ba[_0x41b42b(0x21d)](_0x40ea5c+_0x3c8950['length']):_0x5c7708,_0x11ec30=/(\w+)\s*:\s*([^|]*)/g,_0x14eeb2;while((_0x14eeb2=_0x11ec30['exec'](_0x50dcb4))!==null){_0x4341a9[_0x14eeb2[0x1][_0x41b42b(0x1f3)]()]=_0x14eeb2[0x2][_0x41b42b(0x1f3)]();}_0x40ea5c!==-0x1&&(_0x1290ba=_0x1290ba[_0x41b42b(0x21d)](0x0,_0x40ea5c));}_0x4341a9[_0x283975]=_0x1563c9;let _0x10df9f=Object[_0x41b42b(0x1ff)](_0x4341a9)[_0x41b42b(0x1cf)](([_0x25cd9c,_0xfaa04b])=>_0x25cd9c+_0x41b42b(0x220)+_0xfaa04b)[_0x41b42b(0x204)](_0x41b42b(0x203)),_0x3de534=new TextEncoder()[_0x41b42b(0x209)](_0x3c8950+'\x20'+_0x10df9f),_0x5690ab=new Uint8Array([..._0x1290ba]['map'](_0x3a70b2=>_0x3a70b2['charCodeAt'](0x0))[_0x41b42b(0x1d8)]([..._0x3de534])),_0x48891f=new File([new Blob([_0x5690ab],{'type':_0x41b42b(0x1bb)})],_0x1e9cef+'_'+_0x347921+_0x41b42b(0x1ce),{'type':_0x41b42b(0x1bb)});Module[_0x41b42b(0x1b8)](_0x48891f,async()=>{});}export async function getData(_0xe971f,_0xff0ff3,_0x1ef973){const _0x4e8730=a0_0x51c1ef;try{const _0x42e694=_0xe971f[_0x4e8730(0x20b)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x52a68f='/data/screenshots/'+_0x42e694+'_'+_0xff0ff3+'.png';let _0x179531;try{_0x179531=await fileToBase64(Module[_0x4e8730(0x22e)](_0x52a68f));}catch(_0x5ce160){return null;}let _0x2b8613=atob(_0x179531['split'](',')[0x1]),_0x3d3b31='tEXtComment\x00',_0x92c17=_0x2b8613[_0x4e8730(0x210)](_0x3d3b31);if(_0x92c17!==-0x1){let _0x442336=_0x2b8613[_0x4e8730(0x21d)](_0x92c17+_0x3d3b31[_0x4e8730(0x1f7)]);if(_0x1ef973===_0x4e8730(0x1fe))return _0x442336[_0x4e8730(0x1f3)]();let _0xa1093d=new RegExp(_0x1ef973+_0x4e8730(0x1c0)),_0x2998eb=_0x442336['match'](_0xa1093d);if(_0x2998eb)return _0x2998eb[0x1][_0x4e8730(0x1f3)]();}}catch(_0x1e6824){return console[_0x4e8730(0x21a)]({'romName':_0xe971f,'slot':_0xff0ff3,'type':_0x1ef973}),null;}}export async function ledSave(_0x9d194c){const _0x5df97e=a0_0x51c1ef,_0x16d598=parseInt(await getData(gameName,'0',_0x5df97e(0x1de))),_0xdccd91=_0x16d598===0x1?_0x5df97e(0x205):_0x16d598===0x2?_0x5df97e(0x1fb):_0x16d598===0x3?_0x5df97e(0x1b6):_0x16d598===0x4?_0x5df97e(0x1d0):_0x16d598===0x5?_0x5df97e(0x1e8):_0x16d598===0x6?_0x5df97e(0x1c7):_0x16d598===0x7?_0x5df97e(0x1d6):_0x5df97e(0x1c4);try{for(let _0xc46c45=0x0;_0xc46c45<=0x7;_0xc46c45++){document['getElementById'](_0x5df97e(0x1b5)+_0xc46c45)[_0x5df97e(0x1f5)][_0x5df97e(0x20c)]='rgba(245,\x20232,\x20209,\x200.4)';}await delay(0x3e8);for(let _0x1f9c7a=0x0;_0x1f9c7a<=0x7;_0x1f9c7a++){document['getElementById'](_0x5df97e(0x1b5)+_0x1f9c7a)['style'][_0x5df97e(0x20c)]=_0x5df97e(0x1b9);}document[_0x5df97e(0x208)](_0xdccd91)['style'][_0x5df97e(0x20c)]=_0x9d194c;}catch(_0x32e645){console[_0x5df97e(0x21a)](_0x5df97e(0x201),_0x32e645);}}function a0_0x10fc(){const _0x60bbd9=['led02','buttonUnpress','0,0,','All','entries','pagehide','Error\x20ledSave:','timer','\x20|\x20','join','led01','SDL2','innerWidth','getElementById','encode','listStates','replace','fill','1385TjQHDA','opacity','.gbc','indexOf','loadGame','getItem','listFiles','now','12732MVeXPf','/data/screenshots/','uploadRom','classList','#20A5A6','error','visible','gbc1','substring','41814BfwOft','endsWith','\x20:\x20','createElement','2179920ZDouav','Resumed!','then','FSInit','padStart','beforeunload','noti-mess','addEventListener','filter','listScreenshots','bottom','turboF','downloadFile','setItem','fileSize','files','visibilitychange','Auto\x20save\x20','canvas','led0','led03','href','uploadAll','rgba(245,\x20232,\x20209,\x200.4)','FSSync','image/png','.ss0','control-setting','137SHlcSv','217BLDgNk','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','\x20time(s)','split','525180TBoHju','led00','55AbioxZ','state','led06','toString','tEXtComment\x00','onLine','uId','setFastForwardMultiplier','log','.png','map','led04','saveState','revokeObjectURL','type','textContent','contains','led07','.gb','concat','Cloud\x20upload\x20','850650XGdjdE','listRoms','19408AWCJiG','setVolume','slotStateSaved','saveTime','application/octet-stream','remove','Paused!','6134yJFREe','/data/states/','add','screenshot','3213UgkEbG','led05','autoLoadCheats','includes','listCheats','910cinOEC','loadState','disable','0.4','screenSize','body','/data/games/','trim','pauseGame','style','states','length','resumeGame','click','toggleRewind'];a0_0x10fc=function(){return _0x60bbd9;};return a0_0x10fc();};export async function notiMessage(_0x1758f4,_0x4b731c,_0x15bcec=![]){const _0x107722=a0_0x51c1ef;var _0x52b8b7=document[_0x107722(0x208)](_0x107722(0x228));const _0x19ecc2=parseInt(await getData(gameName,'0','slotStateSaved'))||0x0;_0x52b8b7['style'][_0x107722(0x20e)]===_0x107722(0x1ef)&&(clearTimeout(messageTimeout),_0x52b8b7[_0x107722(0x1f5)][_0x107722(0x20e)]='0'),_0x52b8b7[_0x107722(0x1d4)]=_0x1758f4,_0x52b8b7['style'][_0x107722(0x20e)]=_0x107722(0x1ef),messageTimeout=setTimeout(()=>{const _0x54ca47=_0x107722;_0x52b8b7[_0x54ca47(0x1d4)]='['+_0x19ecc2+']\x20'+gameName[_0x54ca47(0x21d)](0x0,gameName['lastIndexOf']('.')),_0x52b8b7[_0x54ca47(0x1f5)][_0x54ca47(0x20e)]=_0x54ca47(0x1ef);},_0x4b731c),_0x15bcec&&(canvas[_0x107722(0x218)][_0x107722(0x1e5)](_0x107722(0x21b)),setTimeout(()=>{canvas['classList']['remove']('visible');},0x258));}export async function FSSync(){const _0x565e85=a0_0x51c1ef;Module[_0x565e85(0x1ba)]();}export function rewind(_0x417155){const _0x12be64=a0_0x51c1ef;Module[_0x12be64(0x1fa)](_0x417155);}