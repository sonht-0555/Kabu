const a0_0x3d0498=a0_0x4a6c;(function(_0x45b8b1,_0x7dd1d6){const _0x3b8e65=a0_0x4a6c,_0x21a004=_0x45b8b1();while(!![]){try{const _0x147846=-parseInt(_0x3b8e65(0x12b))/0x1*(-parseInt(_0x3b8e65(0x114))/0x2)+-parseInt(_0x3b8e65(0x12c))/0x3+parseInt(_0x3b8e65(0x11d))/0x4*(parseInt(_0x3b8e65(0xf1))/0x5)+-parseInt(_0x3b8e65(0xf7))/0x6*(-parseInt(_0x3b8e65(0x11c))/0x7)+-parseInt(_0x3b8e65(0x119))/0x8*(-parseInt(_0x3b8e65(0xed))/0x9)+parseInt(_0x3b8e65(0x118))/0xa*(-parseInt(_0x3b8e65(0x10f))/0xb)+-parseInt(_0x3b8e65(0x10e))/0xc;if(_0x147846===_0x7dd1d6)break;else _0x21a004['push'](_0x21a004['shift']());}catch(_0x5c614f){_0x21a004['push'](_0x21a004['shift']());}}}(a0_0x509e,0x20b08));import a0_0x3676c0 from'../core/mgba.js';import*as a0_0x215d28 from'./gamepad.js';function a0_0x509e(){const _0x3a8e0e=['uId','textContent','getElementById','downloadFile','loadState','_dateState0','Unable\x20to\x20upload\x20to\x20Cloud!','editFileName','innerWidth','gbc','revokeObjectURL','then','buttonPress','slotStateSaved','classList','resumeGame','Cloud\x20upload\x20','appendChild','disable','FSInit','fileSize','beforeunload','_imageState','createElement','log','uploadSaveOrSaveState','toString','#E0C068','setItem','saveState','buttonUnpress','90756aTniAE','href','pauseGame','Auto\x20save\x20','2770PKDPwJ','error','0,0,','_imageState0','/data/screenshots/','visibilityState','35790pPdiXa','/data/states/','\x20time(s)','style','Online!','listGames','control-setting','endsWith','files','Error\x20uploadSavSta:','type','.ss0','name','uploadRom','add','#20A5A6','FSSync','replace','/data/games/','_slot0.txt','includes','.gba','_dateState','3751476DsoPxV','121vgfjsl','setFastForwardMultiplier','pagehide','persisted','No\x20screenshot!','8ZINLWN','Cheat\x20uploaded\x20successfully:','addEventListener','Error\x20uploadCheat:','22390sSOMVv','88Pevuwj','.png','download','301gsZcrh','164LLpZTv','application/octet-stream','listScreenshots','now','visibilitychange','listCheats','gbc1','loadGame','canvas','_savedCheats','visible','gameName','.gbc','turboF','39635wWVtkw','232575SsPCXL','createObjectURL','getItem','autoLoadCheats','listStates','screenSize','uploadCheats','remove'];a0_0x509e=function(){return _0x3a8e0e;};return a0_0x509e();}import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x3d0498(0x136)](a0_0x3d0498(0x125))};function initializeCore(_0x4b184b,_0x400899){const _0x4480d3=a0_0x3d0498;_0x4b184b(_0x400899)[_0x4480d3(0x13f)](function(_0x40208f){const _0x51a0e1=_0x4480d3;_0x40208f[_0x51a0e1(0xe1)]();});}initializeCore(a0_0x3676c0,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x3d0498(0x136)](a0_0x3d0498(0x125)),savedTurboState=localStorage[a0_0x3d0498(0x12e)]('turboState'),controlSetting=document[a0_0x3d0498(0x136)](a0_0x3d0498(0xfd));function handleVisibilityChange(_0x2a1100){const _0x1f689b=a0_0x3d0498;document[_0x1f689b(0xf6)]==='hidden'||_0x2a1100?.[_0x1f689b(0x101)]===_0x1f689b(0xe3)||_0x2a1100?.[_0x1f689b(0x112)]?(pauseGame(),canvas[_0x1f689b(0x142)][_0x1f689b(0x105)](_0x1f689b(0x127))):(setTimeout(()=>{const _0x443586=_0x1f689b;canvas['classList'][_0x443586(0x133)]('visible');},0x258),controlSetting['classList']['contains'](_0x1f689b(0x127))&&resumeGame());}async function statusShow(){const _0x11d381=a0_0x3d0498;document[_0x11d381(0x116)](_0x11d381(0x111),handleVisibilityChange),document[_0x11d381(0x116)](_0x11d381(0x121),handleVisibilityChange),window[_0x11d381(0x116)](_0x11d381(0xe3),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x215d28[_0x11d381(0x12a)](turboState)),await delay(0x3e8),await led(parseInt(localStorage[_0x11d381(0x12e)](_0x11d381(0x141)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0xc2e1a6=a0_0x3d0498;await ledSave(_0xc2e1a6(0x106)),await Module[_0xc2e1a6(0xeb)](0x0),await Module[_0xc2e1a6(0x107)](),await screenShot(0x0),console['log'](_0xc2e1a6(0xf0)+ ++countAutoSave+_0xc2e1a6(0xf9));}async function saveStateInCloud(){const _0x509da2=a0_0x3d0498,_0x2c8850=localStorage[_0x509da2(0x12e)]('gameName'),_0x1d5b7f=_0x2c8850[_0x509da2(0x108)](_0x509da2(0x10c),'.ss0'),_0x3c2216=localStorage[_0x509da2(0x12e)](_0x509da2(0x134)),_0x4704a2=localStorage[_0x509da2(0x12e)](_0x2c8850+_0x509da2(0xf4)),_0x1c84bc=localStorage[_0x509da2(0x12e)](_0x2c8850+_0x509da2(0x139));if(navigator['onLine']){if(_0x3c2216){await ledSave(_0x509da2(0xe9)),await delay(0x3e8),await dpUploadFile(_0x1d5b7f,Module[_0x509da2(0x137)](_0x509da2(0xf8)+_0x1d5b7f));if(_0x4704a2!==null){const _0x5e489e=_0x4704a2+'\x0a\x0a'+_0x1c84bc,_0x142e3a=new Blob([_0x5e489e],{'type':'text/plain'});await dpUploadFile(_0x2c8850+_0x509da2(0x10a),_0x142e3a);}else console[_0x509da2(0xe6)](_0x509da2(0x113));await lockNoti('',_0x509da2(0xde)+ ++countUpload+_0x509da2(0xf9),0x7d0);}else console['log'](_0x509da2(0x13a));}else console[_0x509da2(0xe6)](_0x509da2(0xfb));}function startTimer(){let [_0x46b5c3,_0xb02562,_0x49aa0e,_0x488f5b,_0x300191]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x486523=a0_0x4a6c;_0x49aa0e++,_0x488f5b++,_0x300191++;if(_0x49aa0e===0x3c)[_0x49aa0e,_0xb02562]=[0x0,_0xb02562+0x1];if(_0xb02562===0x3c)[_0xb02562,_0x46b5c3]=[0x0,_0x46b5c3+0x1];document[_0x486523(0x136)]('timer')[_0x486523(0x135)]=_0x46b5c3+'h'+_0xb02562[_0x486523(0xe8)]()['padStart'](0x2,'0')+'.'+_0x49aa0e['toString']()['padStart'](0x2,'0');_0x488f5b===0x3c&&(saveStatePeriodically(),_0x488f5b=0x0);;_0x488f5b===0xe10&&(saveStateInCloud(),_0x300191=0x0);;},0x3e8);}export async function uploadGame(_0x1c9766){const _0xeb1529=a0_0x3d0498,_0x44b6a7=_0x1c9766[_0xeb1529(0xff)][0x0];Module[_0xeb1529(0x104)](_0x44b6a7,()=>{const _0x237671=_0xeb1529;Module[_0x237671(0x107)]();});}export async function loadGame(_0x12d9ce){const _0x8c0656=a0_0x3d0498,_0x27a4d5=_0x12d9ce[_0x8c0656(0x108)](/\.(gba|gbc|gb|zip)$/,_0x8c0656(0x102)),_0x24dfeb=Module[_0x8c0656(0x130)]();intro[_0x8c0656(0x142)]['add'](_0x8c0656(0xe0)),errorLogElements[0x0][_0x8c0656(0xfa)]['bottom']='0',ingame[_0x8c0656(0x142)][_0x8c0656(0x133)](_0x8c0656(0xe0)),_0x12d9ce[_0x8c0656(0xfe)](_0x8c0656(0x129))||_0x12d9ce[_0x8c0656(0xfe)]('.gb')?(canvas[_0x8c0656(0x142)][_0x8c0656(0x105)](_0x8c0656(0x13d)),areaTrans[_0x8c0656(0x142)][_0x8c0656(0x105)](_0x8c0656(0x123)),localStorage[_0x8c0656(0xea)](_0x8c0656(0x131),_0x8c0656(0xf3)+(window[_0x8c0656(0x13c)]-0xe6)+','+(window[_0x8c0656(0x13c)]-0xe6)*0x9/0xa)):localStorage[_0x8c0656(0xea)]('screenSize','0,0,'+(window[_0x8c0656(0x13c)]-0x96)+','+(window[_0x8c0656(0x13c)]-0x96)*0x2/0x3),_0x24dfeb[_0x8c0656(0x10b)](_0x27a4d5)?(await Module[_0x8c0656(0x124)](_0x8c0656(0x109)+_0x12d9ce),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&(await Module[_0x8c0656(0x138)](0x0),localStorage['setItem'](_0x8c0656(0x128),_0x12d9ce),console['log'](_0x12d9ce))):(await Module[_0x8c0656(0x124)](_0x8c0656(0x109)+_0x12d9ce),localStorage[_0x8c0656(0xea)](_0x8c0656(0x128),_0x12d9ce)),await statusShow();}function a0_0x4a6c(_0x5cf5ab,_0x1a6697){const _0x509ebf=a0_0x509e();return a0_0x4a6c=function(_0x4a6c14,_0x45b037){_0x4a6c14=_0x4a6c14-0xdd;let _0x5511c1=_0x509ebf[_0x4a6c14];return _0x5511c1;},a0_0x4a6c(_0x5cf5ab,_0x1a6697);}export async function saveState(_0x1cbc2e){const _0x1abb3b=a0_0x3d0498;await Module[_0x1abb3b(0xeb)](_0x1cbc2e),await Module[_0x1abb3b(0x107)]();}export async function loadState(_0x73c78e){await Module['loadState'](_0x73c78e);}export async function downloadFile(_0x4a6b34,_0x2491e6){const _0x4e76be=a0_0x3d0498,_0x11f3e4=Module[_0x4e76be(0x137)](_0x4a6b34),_0x4928bb=document[_0x4e76be(0xe5)]('a');document['body'][_0x4e76be(0xdf)](_0x4928bb),_0x4928bb[_0x4e76be(0x11b)]=_0x2491e6;const _0x31e40c=new Blob([_0x11f3e4],{'type':_0x4e76be(0x11e)});_0x4928bb[_0x4e76be(0xee)]=URL[_0x4e76be(0x12d)](_0x31e40c),_0x4928bb['click'](),URL[_0x4e76be(0x13e)](_0x31e40c),_0x4928bb[_0x4e76be(0x133)]();}export function downloadFileInCloud(_0x42449e){const _0x234487=a0_0x3d0498,_0x30a290=Module[_0x234487(0x137)](_0x42449e);return _0x30a290;}export async function uploadFile(_0x5c160a){const _0x47c0f6=a0_0x3d0498,_0x1be628=_0x5c160a[_0x47c0f6(0xff)][0x0];Module[_0x47c0f6(0xe7)](_0x1be628,()=>{const _0x294f7d=_0x47c0f6;Module[_0x294f7d(0x107)]();});}export async function editFile(_0x2216d4,_0x4e95a5,_0x9ceb85){const _0x519069=a0_0x3d0498;await Module[_0x519069(0x13b)](_0x2216d4,_0x4e95a5,_0x9ceb85),await Module[_0x519069(0x107)]();}export async function deleteFile(_0x4887c0){const _0x2c952b=a0_0x3d0498;await Module['deleteFile'](_0x4887c0),await Module[_0x2c952b(0x107)]();}export function listGame(){const _0x256b11=a0_0x3d0498,_0x2d4ccd=Module[_0x256b11(0xfc)]();return _0x2d4ccd;}export function listSave(){const _0x309b37=Module['listSaves']();return _0x309b37;}export function listState(){const _0x3c47a5=a0_0x3d0498,_0x2bf2c6=Module[_0x3c47a5(0x130)]();return _0x2bf2c6;}export function listCheat(){const _0x24009e=a0_0x3d0498,_0x9c1870=Module[_0x24009e(0x122)]();return _0x9c1870;}export function listScreenshot(){const _0x1b7010=a0_0x3d0498,_0x3d1ced=Module[_0x1b7010(0x11f)]();return _0x3d1ced;}export function fileSize(_0x1d49d9){const _0x3265f6=a0_0x3d0498,_0x253a27=Module[_0x3265f6(0xe2)](_0x1d49d9);return _0x253a27;}export async function uploadCheat(_0x40343c){const _0x5d9794=a0_0x3d0498;try{const _0x4375b1=_0x40343c[_0x5d9794(0xff)][0x0];await Module['uploadCheats'](_0x4375b1,()=>{const _0x7ef5c9=_0x5d9794;console[_0x7ef5c9(0xe6)](_0x7ef5c9(0x115),_0x4375b1[_0x7ef5c9(0x103)]),localStorageFile(),Module[_0x7ef5c9(0x107)]();});}catch(_0x1ce196){console[_0x5d9794(0xf2)](_0x5d9794(0x117),_0x1ce196);}}export async function uploadSavSta(_0x1986af){const _0x58179b=a0_0x3d0498;try{const _0x77ee2a=_0x1986af[_0x58179b(0xff)][0x0];await Module[_0x58179b(0xe7)](_0x77ee2a,()=>{const _0x19feb5=_0x58179b;console[_0x19feb5(0xe6)]('Save/State\x20uploaded\x20successfully:',_0x77ee2a['name']),localStorageFile(),Module[_0x19feb5(0x107)]();});}catch(_0x5721cd){console[_0x58179b(0xf2)](_0x58179b(0x100),_0x5721cd);}}export async function uploadSaveOrSaveState(_0x2ac7b6){const _0x223756=a0_0x3d0498;Module[_0x223756(0xe7)](_0x2ac7b6,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){const _0x508f5d=a0_0x3d0498;Module[_0x508f5d(0xdd)](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x451de7=a0_0x3d0498;Module[_0x451de7(0xef)](),Module['SDL2'](),notiMessage('Paused!',0x7d0);}export async function buttonPress(_0x59ff3a){const _0x49bc4b=a0_0x3d0498;Module[_0x49bc4b(0x140)](_0x59ff3a);}export async function buttonUnpress(_0x1e2ed6){const _0x508efc=a0_0x3d0498;Module[_0x508efc(0xec)](_0x1e2ed6);}export async function screenShot(_0x5b2fe1){const _0x33e816=a0_0x3d0498,_0x48e50f=localStorage[_0x33e816(0x12e)]('gameName'),_0x1613dd=_0x48e50f[_0x33e816(0x108)](/\.(gba|gbc|gb|zip)$/,'_');await Module['screenshot'](''+_0x1613dd+_0x5b2fe1+_0x33e816(0x11a)),await Module['FSSync']();const _0x148498=await fileToBase64(Module['downloadFile']('/data/screenshots/'+_0x1613dd+_0x5b2fe1+_0x33e816(0x11a))),_0x189d59=Date[_0x33e816(0x120)](),_0x5e1fae=formatDateTime(_0x189d59);localStorage['setItem'](_0x48e50f+_0x33e816(0x10d)+_0x5b2fe1,_0x5e1fae),localStorage[_0x33e816(0xea)](_0x48e50f+_0x33e816(0xe4)+_0x5b2fe1,_0x148498);}export async function captureOCR(_0x4e1892){const _0x124f38=a0_0x3d0498;Module['screenshot'](_0x4e1892);const _0x21e303=Module[_0x124f38(0x137)](_0x124f38(0xf5)+_0x4e1892);return _0x21e303;}export async function setFastForwardMultiplier(_0x331d5e){const _0x247a23=a0_0x3d0498;Module[_0x247a23(0x110)](_0x331d5e);}export function uploadCheats(_0x15fd16,_0x50be6c,_0x2dd983,_0x3f9846,_0xb88dc3){const _0x176ca8=a0_0x3d0498;Module[_0x176ca8(0x132)](_0x15fd16,()=>{const _0x180f69=_0x176ca8;Module[_0x180f69(0x12f)](),setTimeout(()=>{const _0x1c0770=_0x180f69;Module[_0x1c0770(0x107)]();},0x1f4),_0x3f9846&&(localStorage['setItem'](_0x50be6c+_0x180f69(0x126),_0x2dd983),notiMessage('Cheat\x20Enabled!',0x5dc)),_0xb88dc3[_0x180f69(0x135)]=localStorage['getItem'](_0x50be6c+'_savedCheats'||'Off');});}