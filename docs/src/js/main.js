const a0_0x40e39d=a0_0x314c;function a0_0x2f22(){const _0x546be7=['pagehide','813634RazgYp','body','disable','turboState','control-setting','screenshot','12445610uerOvk','#E0C068','Cloud\x20upload\x20','2454275XOeDNi','click','charCodeAt','now','toString','/data/screenshots/','59997AwbFCG','setItem','image/png','state','addEventListener','9JQHDUO','getElementById','screenSize','log','tEXtComment\x00','Resumed!','2626240AtrpjS','/data/games/','substring','Auto\x20save\x20','hidden','.gb','replace','downloadFile','FSInit','turboF','style','endsWith','setVolume','padStart','0,0,','Do\x20you\x20want\x20to\x20load\x20save\x20state?','gbc1','uploadAll','_savedCheats','add','filter','buttonUnpress','1wtAVNb','files','includes','listSaves','getItem','href','resumeGame','SDL2','loadGame','bottom','persisted','uploadRom','innerWidth','Off','download','/data/states/','length','.ss0','Paused!','remove','contains','revokeObjectURL','pauseGame','gameName','uId','\x20time(s)','.png','classList','editFileName','autoLoadCheats','textContent','beforeunload','saveState','listStates','split','.gbc','onLine','deleteFile','#20A5A6','Cheat\x20Enabled!','gbc','listScreenshots','FSSync','2080864NQyYbl','setFastForwardMultiplier','fileSize','set','60zMuNUf','createElement','visible','3436950YIQnlS','createObjectURL','indexOf'];a0_0x2f22=function(){return _0x546be7;};return a0_0x2f22();}(function(_0x660b40,_0xa94973){const _0x411a4a=a0_0x314c,_0x565305=_0x660b40();while(!![]){try{const _0x568368=-parseInt(_0x411a4a(0x1d3))/0x1*(parseInt(_0x411a4a(0x209))/0x2)+parseInt(_0x411a4a(0x205))/0x3+parseInt(_0x411a4a(0x1fe))/0x4+parseInt(_0x411a4a(0x212))/0x5+parseInt(_0x411a4a(0x202))/0x6*(-parseInt(_0x411a4a(0x218))/0x7)+parseInt(_0x411a4a(0x223))/0x8+parseInt(_0x411a4a(0x21d))/0x9*(-parseInt(_0x411a4a(0x20f))/0xa);if(_0x568368===_0xa94973)break;else _0x565305['push'](_0x565305['shift']());}catch(_0x432a9f){_0x565305['push'](_0x565305['shift']());}}}(a0_0x2f22,0xb6989));import a0_0x57be7c from'../core/mgba.js';import*as a0_0x26d1d8 from'./gamepad.js';function a0_0x314c(_0x535cd0,_0x3d83c0){const _0x2f22e9=a0_0x2f22();return a0_0x314c=function(_0x314cf6,_0x3e4585){_0x314cf6=_0x314cf6-0x1c1;let _0x1cf958=_0x2f22e9[_0x314cf6];return _0x1cf958;},a0_0x314c(_0x535cd0,_0x3d83c0);}import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';const Module={'canvas':document[a0_0x40e39d(0x21e)]('canvas')};function initializeCore(_0x3bd9f8,_0x491c14){_0x3bd9f8(_0x491c14)['then'](function(_0x3feba1){const _0x372f55=a0_0x314c;_0x3feba1[_0x372f55(0x1c5)]();});}initializeCore(a0_0x57be7c,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x40e39d(0x21e)]('canvas'),savedTurboState=localStorage[a0_0x40e39d(0x1d7)](a0_0x40e39d(0x20c)),controlSetting=document[a0_0x40e39d(0x21e)](a0_0x40e39d(0x20d));function handleVisibilityChange(_0x42d1b){const _0x142a66=a0_0x40e39d;document['visibilityState']===_0x142a66(0x1c1)||_0x42d1b?.['type']==='beforeunload'||_0x42d1b?.[_0x142a66(0x1dd)]?(pauseGame(),canvas[_0x142a66(0x1ee)][_0x142a66(0x1d0)]('visible')):(setTimeout(()=>{const _0x359361=_0x142a66;canvas[_0x359361(0x1ee)][_0x359361(0x1e6)](_0x359361(0x204));},0x258),controlSetting['classList'][_0x142a66(0x1e7)](_0x142a66(0x204))&&resumeGame());}async function statusShow(){const _0x174a58=a0_0x40e39d;document['addEventListener'](_0x174a58(0x208),handleVisibilityChange),document[_0x174a58(0x21c)]('visibilitychange',handleVisibilityChange),window[_0x174a58(0x21c)](_0x174a58(0x1f2),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x26d1d8[_0x174a58(0x1c6)](turboState)),await delay(0xc8),await Module['SDL2'](),await delay(0x320),await led(parseInt(localStorage['getItem']('slotStateSaved'))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x18e7b5=a0_0x40e39d;await ledSave(_0x18e7b5(0x1f9)),await Module[_0x18e7b5(0x1f3)](0x0),await Module[_0x18e7b5(0x1fd)](),await screenShot(0x0),console[_0x18e7b5(0x220)](_0x18e7b5(0x226)+ ++countAutoSave+_0x18e7b5(0x1ec));}async function saveStateInCloud(){const _0x49e185=a0_0x40e39d,_0x420b9e=localStorage[_0x49e185(0x1d7)](_0x49e185(0x1ea)),_0x156c19=_0x420b9e[_0x49e185(0x1c3)](/\.(zip|gb|gbc|gba)$/,_0x49e185(0x1e4)),_0x21ae9a=localStorage[_0x49e185(0x1d7)](_0x49e185(0x1eb));navigator[_0x49e185(0x1f7)]&&(_0x21ae9a&&(await ledSave(_0x49e185(0x210)),await delay(0x3e8),await dpUploadFile(_0x156c19,Module[_0x49e185(0x1c4)](_0x49e185(0x1e2)+_0x156c19),_0x49e185(0x21b)),await lockNoti('',_0x49e185(0x211)+ ++countUpload+_0x49e185(0x1ec),0x7d0)));}function startTimer(){let [_0x3232ab,_0x251530,_0x1decc0,_0x5799b4,_0x5308e1]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x3e07be=a0_0x314c;_0x1decc0++,_0x5799b4++,_0x5308e1++;if(_0x1decc0===0x3c)[_0x1decc0,_0x251530]=[0x0,_0x251530+0x1];if(_0x251530===0x3c)[_0x251530,_0x3232ab]=[0x0,_0x3232ab+0x1];document[_0x3e07be(0x21e)]('timer')[_0x3e07be(0x1f1)]=_0x3232ab+'h'+_0x251530['toString']()[_0x3e07be(0x1ca)](0x2,'0')+'.'+_0x1decc0[_0x3e07be(0x216)]()['padStart'](0x2,'0');_0x5799b4===0x3c&&(saveStatePeriodically(),_0x5799b4=0x0);;_0x5308e1===0x708&&(saveStateInCloud(),_0x5308e1=0x0);;},0x3e8);}export async function uploadGame(_0x40c822){const _0xcdae5=a0_0x40e39d,_0x43971a=_0x40c822['files'][0x0];Module[_0xcdae5(0x1de)](_0x43971a,()=>{Module['FSSync']();});}export async function loadGame(_0x26e10a){const _0x2068ed=a0_0x40e39d,_0x11ed40=_0x26e10a[_0x2068ed(0x1c3)](/\.(gba|gbc|gb|zip)$/,_0x2068ed(0x1e4)),_0x3e9be2=Module[_0x2068ed(0x1f4)]()[_0x2068ed(0x1d1)](_0x51601c=>_0x51601c!=='.'&&_0x51601c!=='..');intro[_0x2068ed(0x1ee)][_0x2068ed(0x1d0)](_0x2068ed(0x20b)),errorLogElements[0x0][_0x2068ed(0x1c7)][_0x2068ed(0x1dc)]='0',ingame[_0x2068ed(0x1ee)]['remove'](_0x2068ed(0x20b)),_0x26e10a[_0x2068ed(0x1c8)](_0x2068ed(0x1f6))||_0x26e10a[_0x2068ed(0x1c8)](_0x2068ed(0x1c2))?(canvas[_0x2068ed(0x1ee)][_0x2068ed(0x1d0)](_0x2068ed(0x1fb)),areaTrans[_0x2068ed(0x1ee)][_0x2068ed(0x1d0)](_0x2068ed(0x1cd)),localStorage['setItem'](_0x2068ed(0x21f),_0x2068ed(0x1cb)+(window[_0x2068ed(0x1df)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x2068ed(0x219)](_0x2068ed(0x21f),_0x2068ed(0x1cb)+(window['innerWidth']-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x3e9be2[_0x2068ed(0x1d5)](_0x11ed40)?(await Module['loadGame']('/data/games/'+_0x26e10a),confirm(_0x2068ed(0x1cc))&&(await Module['loadState'](0x0),localStorage['setItem']('gameName',_0x26e10a),console['log'](_0x26e10a))):(await Module[_0x2068ed(0x1db)](_0x2068ed(0x224)+_0x26e10a),localStorage['setItem']('gameName',_0x26e10a),console[_0x2068ed(0x220)](_0x26e10a)),await statusShow();}export async function saveState(_0x59e73c){const _0x6f7b6d=a0_0x40e39d;await Module['saveState'](_0x59e73c),await Module[_0x6f7b6d(0x1fd)]();}export async function loadState(_0x220a02){await Module['loadState'](_0x220a02);}export async function downloadFile(_0x256f05,_0x14a263){const _0x3a24ff=a0_0x40e39d,_0x1636a8=Module[_0x3a24ff(0x1c4)](_0x256f05),_0x296aaf=document[_0x3a24ff(0x203)]('a');document[_0x3a24ff(0x20a)]['appendChild'](_0x296aaf),_0x296aaf[_0x3a24ff(0x1e1)]=_0x14a263;const _0x47a6e0=new Blob([_0x1636a8],{'type':'application/octet-stream'});_0x296aaf[_0x3a24ff(0x1d8)]=URL[_0x3a24ff(0x206)](_0x47a6e0),_0x296aaf[_0x3a24ff(0x213)](),URL[_0x3a24ff(0x1e8)](_0x47a6e0),_0x296aaf[_0x3a24ff(0x1e6)]();}export function downloadFileInCloud(_0x4c0368){const _0x273a22=a0_0x40e39d,_0x8bc740=Module[_0x273a22(0x1c4)](_0x4c0368);return _0x8bc740;}export async function uploadFileInCloud(_0x9ba0db){const _0x5f1fc6=a0_0x40e39d;Module[_0x5f1fc6(0x1ce)](_0x9ba0db,()=>{const _0x49e318=_0x5f1fc6;localStorageFile(),Module[_0x49e318(0x1fd)]();});}export async function uploadFile(_0x4eb305){const _0x3f7e3f=a0_0x40e39d,_0x5453d5=_0x4eb305[_0x3f7e3f(0x1d4)][0x0];Module[_0x3f7e3f(0x1ce)](_0x5453d5,()=>{const _0x4b118b=_0x3f7e3f;localStorageFile(),Module[_0x4b118b(0x1fd)]();});}export async function editFile(_0x4419be,_0x23839e,_0x56a4f1){const _0x127b23=a0_0x40e39d;await Module[_0x127b23(0x1ef)](_0x4419be,_0x23839e,_0x56a4f1),await Module[_0x127b23(0x1fd)]();}export async function deleteFile(_0x370f66){const _0x61fa2d=a0_0x40e39d;await Module[_0x61fa2d(0x1f8)](_0x370f66),await Module['FSSync']();}export function listGame(){const _0x38714f=Module['listRoms']()['filter'](_0x4dd25e=>_0x4dd25e!=='.'&&_0x4dd25e!=='..');return _0x38714f;}export function listSave(){const _0x344bdf=a0_0x40e39d,_0x515330=Module[_0x344bdf(0x1d6)]()[_0x344bdf(0x1d1)](_0x7a81eb=>_0x7a81eb!=='.'&&_0x7a81eb!=='..');return _0x515330;}export function listState(){const _0x2d0b48=Module['listStates']()['filter'](_0x47d7ae=>_0x47d7ae!=='.'&&_0x47d7ae!=='..');return _0x2d0b48;}export function listCheat(){const _0x2e3aee=Module['listCheats']()['filter'](_0x161545=>_0x161545!=='.'&&_0x161545!=='..');return _0x2e3aee;}export function listScreenshot(){const _0x27f130=a0_0x40e39d,_0x4e046a=Module[_0x27f130(0x1fc)]()[_0x27f130(0x1d1)](_0x2cef14=>_0x2cef14!=='.'&&_0x2cef14!=='..');return _0x4e046a;}export function embedTextInPngFile(_0x1855e0,_0x5b81c3,_0x45fe8e){const _0x349e31=a0_0x40e39d;let _0x2f4e6c=atob(_0x1855e0[_0x349e31(0x1f5)](',')[0x1]),_0x5b0f9a=new Uint8Array(_0x2f4e6c[_0x349e31(0x1e3)]);for(let _0x2a9354=0x0;_0x2a9354<_0x2f4e6c[_0x349e31(0x1e3)];_0x2a9354++){_0x5b0f9a[_0x2a9354]=_0x2f4e6c[_0x349e31(0x214)](_0x2a9354);}let _0x2fc374=new TextEncoder()['encode'](_0x349e31(0x221)+_0x5b81c3),_0x522f27=new Uint8Array(_0x5b0f9a['length']+_0x2fc374['length']);_0x522f27[_0x349e31(0x201)](_0x5b0f9a,0x0),_0x522f27[_0x349e31(0x201)](_0x2fc374,_0x5b0f9a['length']);let _0xb9a5b2=new Blob([_0x522f27],{'type':_0x349e31(0x21a)}),_0x32b780=new File([_0xb9a5b2],_0x45fe8e,{'type':_0x349e31(0x21a)});return _0x32b780;}export function extractTextFromPngBase64(_0x5a9bfc){const _0x5586f1=a0_0x40e39d;let _0x4809f6=atob(_0x5a9bfc[_0x5586f1(0x1f5)](',')[0x1]),_0x3f8088=_0x5586f1(0x221),_0x3f5406=_0x4809f6[_0x5586f1(0x207)](_0x3f8088);if(_0x3f5406!==-0x1)return _0x4809f6[_0x5586f1(0x225)](_0x3f5406+_0x3f8088[_0x5586f1(0x1e3)]);return null;}export function fileSize(_0xb51b5b){const _0x1430bf=a0_0x40e39d,_0xb8378d=Module[_0x1430bf(0x200)](_0xb51b5b);return _0xb8378d;}export async function resumeGame(){const _0x56941c=a0_0x40e39d;Module[_0x56941c(0x1d9)](),Module[_0x56941c(0x1da)](),notiMessage(_0x56941c(0x222),0x7d0);}export async function pauseGame(){const _0xd9118f=a0_0x40e39d;Module[_0xd9118f(0x1e9)](),Module[_0xd9118f(0x1da)](),notiMessage(_0xd9118f(0x1e5),0x7d0);}export async function buttonPress(_0x5985a0){Module['buttonPress'](_0x5985a0);}export async function buttonUnpress(_0xcccd61){const _0x51bf23=a0_0x40e39d;Module[_0x51bf23(0x1d2)](_0xcccd61);}export async function screenShot(_0x25b4e7){const _0x3dc4fa=a0_0x40e39d,_0x272d56=localStorage[_0x3dc4fa(0x1d7)](_0x3dc4fa(0x1ea))[_0x3dc4fa(0x1c3)](/\.(gba|gbc|gb|zip)$/,''),_0x34b7ec=_0x272d56+'_'+_0x25b4e7+_0x3dc4fa(0x1ed);await Module[_0x3dc4fa(0x20e)](_0x34b7ec),await Module['FSSync']();const _0x3d36d0=await fileToBase64(Module['downloadFile'](_0x3dc4fa(0x217)+_0x34b7ec)),_0x509576=embedTextInPngFile(_0x3d36d0,formatDateTime(Date[_0x3dc4fa(0x215)]()),_0x34b7ec);Module[_0x3dc4fa(0x1ce)](_0x509576,()=>{const _0x22a73b=_0x3dc4fa;localStorageFile(),Module[_0x22a73b(0x1fd)]();});}export async function dowloadScreenShot(_0x1663eb){const _0x407778=a0_0x40e39d;try{const _0x25e0ce=await fileToBase64(Module[_0x407778(0x1c4)](_0x1663eb));return _0x25e0ce;}catch{}}export async function captureOCR(_0x5e913f){const _0x578920=a0_0x40e39d;Module[_0x578920(0x20e)](_0x5e913f);const _0x305049=Module['downloadFile'](_0x578920(0x217)+_0x5e913f);return _0x305049;}export async function setFastForwardMultiplier(_0x2e4117){const _0x13b395=a0_0x40e39d;Module[_0x13b395(0x1ff)](_0x2e4117);}export function uploadCheats(_0xb9f0fa,_0x5ef305,_0x455d2b,_0x282982,_0x4528c2){const _0x19135a=a0_0x40e39d;Module[_0x19135a(0x1ce)](_0xb9f0fa,()=>{const _0x35b365=_0x19135a;Module[_0x35b365(0x1f0)](),setTimeout(()=>{Module['FSSync']();},0x1f4),_0x282982&&(localStorage[_0x35b365(0x219)](_0x5ef305+_0x35b365(0x1cf),_0x455d2b),notiMessage(_0x35b365(0x1fa),0x5dc)),_0x4528c2['textContent']=localStorage[_0x35b365(0x1d7)](_0x5ef305+_0x35b365(0x1cf)||_0x35b365(0x1e0));});}export function setVolume(_0x54e2d1){const _0x207f90=a0_0x40e39d;Module[_0x207f90(0x1c9)](_0x54e2d1);}