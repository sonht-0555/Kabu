const a0_0x1704cb=a0_0x1141;(function(_0x23fca2,_0xc8efa7){const _0x48e023=a0_0x1141,_0x688020=_0x23fca2();while(!![]){try{const _0x2f58d9=-parseInt(_0x48e023(0x129))/0x1+-parseInt(_0x48e023(0x179))/0x2*(-parseInt(_0x48e023(0x15d))/0x3)+-parseInt(_0x48e023(0x124))/0x4*(-parseInt(_0x48e023(0x145))/0x5)+-parseInt(_0x48e023(0x142))/0x6*(parseInt(_0x48e023(0x17a))/0x7)+parseInt(_0x48e023(0x186))/0x8*(-parseInt(_0x48e023(0x18b))/0x9)+-parseInt(_0x48e023(0x161))/0xa*(-parseInt(_0x48e023(0x156))/0xb)+parseInt(_0x48e023(0x133))/0xc;if(_0x2f58d9===_0xc8efa7)break;else _0x688020['push'](_0x688020['shift']());}catch(_0x3f5b7e){_0x688020['push'](_0x688020['shift']());}}}(a0_0x4cb9,0xc1cd0));import a0_0x297d6d from'../core/mgba.js';import*as a0_0x3ede75 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x1704cb(0x183)](a0_0x1704cb(0x15b))};function initializeCore(_0x3a3720,_0x13344e){const _0x3034ad=a0_0x1704cb;_0x3a3720(_0x13344e)[_0x3034ad(0x175)](function(_0x508466){const _0xf76721=_0x3034ad;_0x508466[_0xf76721(0x143)]();});}initializeCore(a0_0x297d6d,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x1704cb(0x183)](a0_0x1704cb(0x15b)),savedTurboState=localStorage[a0_0x1704cb(0x130)](a0_0x1704cb(0x134)),controlSetting=document['getElementById'](a0_0x1704cb(0x168));function handleVisibilityChange(_0x1bd9f1){const _0x15ad97=a0_0x1704cb;document[_0x15ad97(0x136)]===_0x15ad97(0x141)||_0x1bd9f1?.[_0x15ad97(0x137)]===_0x15ad97(0x13a)||_0x1bd9f1?.[_0x15ad97(0x169)]?(pauseGame(),canvas[_0x15ad97(0x13b)][_0x15ad97(0x14c)](_0x15ad97(0x16c))):(setTimeout(()=>{const _0x57d95a=_0x15ad97;canvas[_0x57d95a(0x13b)]['remove']('visible');},0x258),controlSetting['classList'][_0x15ad97(0x15c)]('visible')&&resumeGame());}function a0_0x1141(_0x4e095b,_0x8d836f){const _0x4cb99b=a0_0x4cb9();return a0_0x1141=function(_0x11413f,_0x5cc76d){_0x11413f=_0x11413f-0x123;let _0x27f519=_0x4cb99b[_0x11413f];return _0x27f519;},a0_0x1141(_0x4e095b,_0x8d836f);}async function statusShow(){const _0x525d00=a0_0x1704cb;document[_0x525d00(0x170)](_0x525d00(0x128),handleVisibilityChange),document[_0x525d00(0x170)](_0x525d00(0x126),handleVisibilityChange),window[_0x525d00(0x170)]('beforeunload',handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x3ede75[_0x525d00(0x16a)](turboState)),await delay(0xc8),await Module[_0x525d00(0x14d)](),await delay(0x320),await led(parseInt(localStorage[_0x525d00(0x130)](_0x525d00(0x123)))),await notiMessage(gameVer,0x3e8);}async function saveStatePeriodically(){const _0x4a01d9=a0_0x1704cb;await ledSave('#20A5A6'),await Module[_0x4a01d9(0x163)](0x0),await Module[_0x4a01d9(0x171)](),await screenShot(0x0),console[_0x4a01d9(0x132)](_0x4a01d9(0x166)+ ++countAutoSave+'\x20time(s)');}async function saveStateInCloud(){const _0x20935b=a0_0x1704cb,_0x48d798=localStorage[_0x20935b(0x130)](_0x20935b(0x17b)),_0x50e662=_0x48d798[_0x20935b(0x15f)](/\.(zip|gb|gbc|gba)$/,_0x20935b(0x13e)),_0x2e298e=localStorage['getItem']('uId'),_0x18facf=localStorage[_0x20935b(0x130)](_0x48d798+'_imageState0'),_0x42a5e9=localStorage['getItem'](_0x48d798+_0x20935b(0x172));if(navigator['onLine']){if(_0x2e298e){await ledSave('#E0C068'),await delay(0x3e8),await dpUploadFile(_0x50e662,Module[_0x20935b(0x185)]('/data/states/'+_0x50e662));if(_0x18facf!==null){const _0x588967=_0x18facf+'\x0a\x0a'+_0x42a5e9,_0x2ce6ec=new Blob([_0x588967],{'type':_0x20935b(0x14f)});await dpUploadFile(_0x48d798+_0x20935b(0x153),_0x2ce6ec);}else console['log']('No\x20screenshot!');await lockNoti('',_0x20935b(0x152)+ ++countUpload+_0x20935b(0x184),0x7d0);}else console[_0x20935b(0x132)](_0x20935b(0x18a));}else console[_0x20935b(0x132)](_0x20935b(0x12f));}function startTimer(){let [_0xe9d30,_0x518623,_0x4ff1b8,_0x21794e,_0x18afeb]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0xb0f828=a0_0x1141;_0x4ff1b8++,_0x21794e++,_0x18afeb++;if(_0x4ff1b8===0x3c)[_0x4ff1b8,_0x518623]=[0x0,_0x518623+0x1];if(_0x518623===0x3c)[_0x518623,_0xe9d30]=[0x0,_0xe9d30+0x1];document[_0xb0f828(0x183)](_0xb0f828(0x12e))['textContent']=_0xe9d30+'h'+_0x518623[_0xb0f828(0x16d)]()[_0xb0f828(0x164)](0x2,'0')+'.'+_0x4ff1b8[_0xb0f828(0x16d)]()[_0xb0f828(0x164)](0x2,'0');_0x21794e===0x3c&&(saveStatePeriodically(),_0x21794e=0x0);;_0x18afeb===0xe10&&(saveStateInCloud(),_0x18afeb=0x0);;},0x3e8);}export async function uploadGame(_0x2fd724){const _0x53f0f6=a0_0x1704cb,_0x33d8d5=_0x2fd724[_0x53f0f6(0x182)][0x0];Module[_0x53f0f6(0x15e)](_0x33d8d5,()=>{Module['FSSync']();});}export async function loadGame(_0x2694b7){const _0x42b8fc=a0_0x1704cb,_0x5ca999=_0x2694b7[_0x42b8fc(0x15f)](/\.(gba|gbc|gb|zip)$/,_0x42b8fc(0x13e)),_0x4230c1=Module[_0x42b8fc(0x13d)]()['filter'](_0x1bf6d1=>_0x1bf6d1!=='.'&&_0x1bf6d1!=='..');intro[_0x42b8fc(0x13b)][_0x42b8fc(0x14c)](_0x42b8fc(0x148)),errorLogElements[0x0]['style'][_0x42b8fc(0x17d)]='0',ingame[_0x42b8fc(0x13b)][_0x42b8fc(0x139)]('disable'),_0x2694b7[_0x42b8fc(0x165)](_0x42b8fc(0x16e))||_0x2694b7[_0x42b8fc(0x165)](_0x42b8fc(0x15a))?(canvas[_0x42b8fc(0x13b)][_0x42b8fc(0x14c)](_0x42b8fc(0x125)),areaTrans[_0x42b8fc(0x13b)][_0x42b8fc(0x14c)](_0x42b8fc(0x12b)),localStorage[_0x42b8fc(0x181)](_0x42b8fc(0x188),_0x42b8fc(0x154)+(window[_0x42b8fc(0x176)]-0xe6)+','+(window[_0x42b8fc(0x176)]-0xe6)*0x9/0xa)):localStorage[_0x42b8fc(0x181)](_0x42b8fc(0x188),'0,0,'+(window['innerWidth']-0x96)+','+(window[_0x42b8fc(0x176)]-0x96)*0x2/0x3),_0x4230c1[_0x42b8fc(0x189)](_0x5ca999)?(await Module[_0x42b8fc(0x177)](_0x42b8fc(0x138)+_0x2694b7),confirm(_0x42b8fc(0x12a))&&(await Module[_0x42b8fc(0x13c)](0x0),localStorage[_0x42b8fc(0x181)](_0x42b8fc(0x17b),_0x2694b7),console[_0x42b8fc(0x132)](_0x2694b7))):(await Module[_0x42b8fc(0x177)](_0x42b8fc(0x138)+_0x2694b7),localStorage[_0x42b8fc(0x181)](_0x42b8fc(0x17b),_0x2694b7),console[_0x42b8fc(0x132)](_0x2694b7)),await statusShow();}export async function saveState(_0x3df790){const _0x333321=a0_0x1704cb;await Module[_0x333321(0x163)](_0x3df790),await Module[_0x333321(0x171)]();}export async function loadState(_0x2a2fbc){await Module['loadState'](_0x2a2fbc);}export async function downloadFile(_0x47bfba,_0x2e0e8e){const _0x4cd760=a0_0x1704cb,_0x8c9989=Module[_0x4cd760(0x185)](_0x47bfba),_0x219183=document['createElement']('a');document[_0x4cd760(0x167)][_0x4cd760(0x17e)](_0x219183),_0x219183['download']=_0x2e0e8e;const _0x315cc3=new Blob([_0x8c9989],{'type':_0x4cd760(0x180)});_0x219183[_0x4cd760(0x150)]=URL['createObjectURL'](_0x315cc3),_0x219183[_0x4cd760(0x16b)](),URL[_0x4cd760(0x13f)](_0x315cc3),_0x219183[_0x4cd760(0x139)]();}export function downloadFileInCloud(_0x1f480b){const _0x9e09a1=a0_0x1704cb,_0x504a7e=Module[_0x9e09a1(0x185)](_0x1f480b);return _0x504a7e;}export async function uploadFile(_0x586180){const _0x17166d=a0_0x1704cb,_0x55a60c=_0x586180[_0x17166d(0x182)][0x0];Module['uploadAll'](_0x55a60c,()=>{const _0x4a6b96=_0x17166d;localStorageFile(),Module[_0x4a6b96(0x171)]();});}export async function editFile(_0x3a8016,_0x43af17,_0x376e5b){const _0x2da22f=a0_0x1704cb;await Module[_0x2da22f(0x135)](_0x3a8016,_0x43af17,_0x376e5b),await Module['FSSync']();}export async function deleteFile(_0x434bc7){const _0x59c268=a0_0x1704cb;await Module['deleteFile'](_0x434bc7),await Module[_0x59c268(0x171)]();}export function listGame(){const _0x2b2f06=a0_0x1704cb,_0x41fa44=Module['listRoms']()[_0x2b2f06(0x157)](_0x3499c8=>_0x3499c8!=='.'&&_0x3499c8!=='..');return _0x41fa44;}export function listSave(){const _0x25e859=a0_0x1704cb,_0x4c44fb=Module[_0x25e859(0x18d)]()[_0x25e859(0x157)](_0x2d5cfb=>_0x2d5cfb!=='.'&&_0x2d5cfb!=='..');return _0x4c44fb;}export function listState(){const _0x2dac7a=a0_0x1704cb,_0x400f03=Module[_0x2dac7a(0x13d)]()['filter'](_0x1f436e=>_0x1f436e!=='.'&&_0x1f436e!=='..');return _0x400f03;}export function listCheat(){const _0xb2c006=a0_0x1704cb,_0x5ccf50=Module[_0xb2c006(0x17c)]()[_0xb2c006(0x157)](_0x117033=>_0x117033!=='.'&&_0x117033!=='..');return _0x5ccf50;}export function listScreenshot(){const _0x26b9e0=a0_0x1704cb,_0x5a7f07=Module[_0x26b9e0(0x155)]()['filter'](_0x178f52=>_0x178f52!=='.'&&_0x178f52!=='..');return _0x5a7f07;}export function embedTextInPngFile(_0x4365df,_0x4512f1,_0x13654c){const _0x102b42=a0_0x1704cb;let _0x21376f=atob(_0x4365df['split'](',')[0x1]),_0x522f0a=new Uint8Array(_0x21376f[_0x102b42(0x146)]);for(let _0x8fe082=0x0;_0x8fe082<_0x21376f[_0x102b42(0x146)];_0x8fe082++){_0x522f0a[_0x8fe082]=_0x21376f[_0x102b42(0x131)](_0x8fe082);}let _0x3f0c0e=new TextEncoder()[_0x102b42(0x162)](_0x102b42(0x151)+_0x4512f1),_0x26b2f8=new Uint8Array(_0x522f0a[_0x102b42(0x146)]+_0x3f0c0e['length']);_0x26b2f8[_0x102b42(0x17f)](_0x522f0a,0x0),_0x26b2f8['set'](_0x3f0c0e,_0x522f0a[_0x102b42(0x146)]);let _0x3ccb5e=new Blob([_0x26b2f8],{'type':_0x102b42(0x14a)}),_0x35ff19=new File([_0x3ccb5e],_0x13654c,{'type':'image/png'});return _0x35ff19;}export function extractTextFromPngBase64(_0x5c2df2){const _0x223162=a0_0x1704cb;let _0x1774fb=atob(_0x5c2df2[_0x223162(0x158)](',')[0x1]),_0x4935e1=_0x223162(0x151),_0x3d7a2d=_0x1774fb[_0x223162(0x144)](_0x4935e1);if(_0x3d7a2d!==-0x1)return _0x1774fb['substring'](_0x3d7a2d+_0x4935e1[_0x223162(0x146)]);return null;}export function fileSize(_0x492492){const _0x267aee=a0_0x1704cb,_0x38d491=Module[_0x267aee(0x14e)](_0x492492);return _0x38d491;}export async function resumeGame(){const _0x2a8dcf=a0_0x1704cb;Module['resumeGame'](),Module[_0x2a8dcf(0x14d)](),notiMessage(_0x2a8dcf(0x159),0x7d0);}export async function pauseGame(){const _0x27fa48=a0_0x1704cb;Module[_0x27fa48(0x147)](),Module[_0x27fa48(0x14d)](),notiMessage(_0x27fa48(0x160),0x7d0);}export async function buttonPress(_0x344acc){const _0x5bd8cb=a0_0x1704cb;Module[_0x5bd8cb(0x16f)](_0x344acc);}export async function buttonUnpress(_0x2cba9e){const _0x406a50=a0_0x1704cb;Module[_0x406a50(0x178)](_0x2cba9e);}export async function screenShot(_0x4a09e6){const _0x2db555=a0_0x1704cb,_0x608bd8=localStorage[_0x2db555(0x130)](_0x2db555(0x17b))[_0x2db555(0x15f)](/\.(gba|gbc|gb|zip)$/,''),_0x190501=_0x608bd8+'_'+_0x4a09e6+_0x2db555(0x140);await Module[_0x2db555(0x12c)](_0x190501),await Module[_0x2db555(0x171)]();const _0x39ca37=await fileToBase64(Module[_0x2db555(0x185)](_0x2db555(0x127)+_0x190501)),_0x2ede31=embedTextInPngFile(_0x39ca37,formatDateTime(Date[_0x2db555(0x149)]()),_0x190501);Module['uploadAll'](_0x2ede31,()=>{const _0xaabc0d=_0x2db555;localStorageFile(),Module[_0xaabc0d(0x171)]();});}export async function dowloadScreenShot(_0x35383e){const _0x398146=a0_0x1704cb;try{const _0x3de957=await fileToBase64(Module[_0x398146(0x185)](_0x35383e));return _0x3de957;}catch{}}export async function captureOCR(_0x9f3d8a){const _0x7caa2b=a0_0x1704cb;Module[_0x7caa2b(0x12c)](_0x9f3d8a);const _0x233c34=Module[_0x7caa2b(0x185)](_0x7caa2b(0x127)+_0x9f3d8a);return _0x233c34;}export async function setFastForwardMultiplier(_0xaf39d9){const _0x59f684=a0_0x1704cb;Module[_0x59f684(0x14b)](_0xaf39d9);}function a0_0x4cb9(){const _0x17f0b8=['fileSize','text/plain','href','tEXtComment\x00','Cloud\x20upload\x20','_slot0.txt','0,0,','listScreenshots','88FYQNYT','filter','split','Resumed!','.gb','canvas','contains','412785QDREEK','uploadRom','replace','Paused!','382730XMSMdu','encode','saveState','padStart','endsWith','Auto\x20save\x20','body','control-setting','persisted','turboF','click','visible','toString','.gbc','buttonPress','addEventListener','FSSync','_dateState0','autoLoadCheats','_savedCheats','then','innerWidth','loadGame','buttonUnpress','10gSgTdQ','1370866JfNMXT','gameName','listCheats','bottom','appendChild','set','application/octet-stream','setItem','files','getElementById','\x20time(s)','downloadFile','203384nyVzlY','Cheat\x20Enabled!','screenSize','includes','Unable\x20to\x20upload\x20to\x20Cloud!','333jUgEtd','uploadAll','listSaves','slotStateSaved','5438460lzCKmu','gbc','visibilitychange','/data/screenshots/','pagehide','459908CcmKBr','Do\x20you\x20want\x20to\x20load\x20save\x20state?','gbc1','screenshot','textContent','timer','Online!','getItem','charCodeAt','log','16887564wqHgzW','turboState','editFileName','visibilityState','type','/data/games/','remove','beforeunload','classList','loadState','listStates','.ss0','revokeObjectURL','.png','hidden','48IOPgyQ','FSInit','indexOf','5ZeEMWg','length','pauseGame','disable','now','image/png','setFastForwardMultiplier','add','SDL2'];a0_0x4cb9=function(){return _0x17f0b8;};return a0_0x4cb9();}export function uploadCheats(_0x3a020e,_0x3037ce,_0x15c232,_0x1c3545,_0x2bf926){const _0x54fd48=a0_0x1704cb;Module[_0x54fd48(0x18c)](_0x3a020e,()=>{const _0x4ba19f=_0x54fd48;Module[_0x4ba19f(0x173)](),setTimeout(()=>{const _0x226a51=_0x4ba19f;Module[_0x226a51(0x171)]();},0x1f4),_0x1c3545&&(localStorage[_0x4ba19f(0x181)](_0x3037ce+_0x4ba19f(0x174),_0x15c232),notiMessage(_0x4ba19f(0x187),0x5dc)),_0x2bf926[_0x4ba19f(0x12d)]=localStorage['getItem'](_0x3037ce+_0x4ba19f(0x174)||'Off');});}