const a0_0xdd0282=a0_0xa70f;(function(_0x7d1b66,_0x2d4ef4){const _0x30088b=a0_0xa70f,_0x2abcec=_0x7d1b66();while(!![]){try{const _0x13c8e2=-parseInt(_0x30088b(0x158))/0x1*(parseInt(_0x30088b(0x12e))/0x2)+-parseInt(_0x30088b(0x146))/0x3+parseInt(_0x30088b(0x14b))/0x4*(-parseInt(_0x30088b(0x114))/0x5)+-parseInt(_0x30088b(0x120))/0x6+-parseInt(_0x30088b(0x11c))/0x7+parseInt(_0x30088b(0x10d))/0x8*(-parseInt(_0x30088b(0x13d))/0x9)+parseInt(_0x30088b(0x134))/0xa;if(_0x13c8e2===_0x2d4ef4)break;else _0x2abcec['push'](_0x2abcec['shift']());}catch(_0x268c8b){_0x2abcec['push'](_0x2abcec['shift']());}}}(a0_0x383d,0xe83bb));import a0_0x25dd98 from'../core/mgba.js';import*as a0_0x8a4d56 from'./gamepad.js';function a0_0xa70f(_0x17e7d4,_0xafd810){const _0x383d69=a0_0x383d();return a0_0xa70f=function(_0xa70fb5,_0x421af7){_0xa70fb5=_0xa70fb5-0x101;let _0x50f0c4=_0x383d69[_0xa70fb5];return _0x50f0c4;},a0_0xa70f(_0x17e7d4,_0xafd810);}import{localStorageFile}from'./storage.js';import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0xdd0282(0x175)](a0_0xdd0282(0x15d))};function initializeCore(_0x1dc117,_0x229af1){const _0x35ddbc=a0_0xdd0282;_0x1dc117(_0x229af1)[_0x35ddbc(0x16a)](function(_0x4787d5){_0x4787d5['FSInit']();});}initializeCore(a0_0x25dd98,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document['getElementById'](a0_0xdd0282(0x15d)),controlSetting=document[a0_0xdd0282(0x175)](a0_0xdd0282(0x125));function handleVisibilityChange(_0x207ca0){const _0x42edf4=a0_0xdd0282;document[_0x42edf4(0x12f)]===_0x42edf4(0x113)||_0x207ca0?.[_0x42edf4(0x127)]===_0x42edf4(0x115)||_0x207ca0?.[_0x42edf4(0x13f)]?(Module['FSSync'](),pauseGame(),canvas[_0x42edf4(0x138)]['add'](_0x42edf4(0x157))):(setTimeout(()=>{const _0x4eda4a=_0x42edf4;canvas['classList'][_0x4eda4a(0x137)](_0x4eda4a(0x157));},0x258),controlSetting['classList'][_0x42edf4(0x139)](_0x42edf4(0x157))&&resumeGame());}async function statusShow(){const _0x5b0bbf=a0_0xdd0282;document[_0x5b0bbf(0x121)](_0x5b0bbf(0x117),handleVisibilityChange),document[_0x5b0bbf(0x121)](_0x5b0bbf(0x12d),handleVisibilityChange),window[_0x5b0bbf(0x121)](_0x5b0bbf(0x115),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x8a4d56[_0x5b0bbf(0x14f)](parseInt(await getData(gameName,'0',_0x5b0bbf(0x16b)))),await delay(0xc8),await Module[_0x5b0bbf(0x172)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x5b0bbf(0x110)))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x1d6bc1=a0_0xdd0282;await ledSave(_0x1d6bc1(0x149)),await Module[_0x1d6bc1(0x14e)](0x0),await Module['FSSync'](),await screenShot(0x0),console[_0x1d6bc1(0x116)](_0x1d6bc1(0x143)+ ++countAutoSave+_0x1d6bc1(0x11f));}async function saveStateInCloud(){const _0x247b53=a0_0xdd0282,_0x1b5c70=gameName[_0x247b53(0x151)](/\.(zip|gb|gbc|gba)$/,_0x247b53(0x168)),_0x921335=localStorage[_0x247b53(0x12c)]('uId');navigator[_0x247b53(0x164)]&&(_0x921335&&(await ledSave(_0x247b53(0x129)),await delay(0x3e8),await dpUploadFile(_0x1b5c70,Module[_0x247b53(0x15b)](_0x247b53(0x145)+_0x1b5c70),'state'),await lockNoti('',_0x247b53(0x133)+ ++countUpload+_0x247b53(0x11f),0x7d0)));}function startTimer(){let [_0x2479fa,_0x2d8bba,_0x5c4444,_0x3d876c,_0x4b77c6]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x4aeb70=a0_0xa70f;_0x5c4444++,_0x3d876c++,_0x4b77c6++;if(_0x5c4444===0x3c)[_0x5c4444,_0x2d8bba]=[0x0,_0x2d8bba+0x1];if(_0x2d8bba===0x3c)[_0x2d8bba,_0x2479fa]=[0x0,_0x2479fa+0x1];document[_0x4aeb70(0x175)]('timer')[_0x4aeb70(0x142)]=_0x2479fa+'h'+_0x2d8bba['toString']()[_0x4aeb70(0x166)](0x2,'0')+'.'+_0x5c4444[_0x4aeb70(0x119)]()[_0x4aeb70(0x166)](0x2,'0');_0x3d876c===0x3c&&(saveStatePeriodically(),_0x3d876c=0x0);;_0x4b77c6===0x708&&(saveStateInCloud(),_0x4b77c6=0x0);;},0x3e8);}export async function uploadGame(_0x5e2158){const _0x16d6f7=a0_0xdd0282,_0x422bfa=_0x5e2158[_0x16d6f7(0x170)][0x0];Module[_0x16d6f7(0x10f)](_0x422bfa,()=>{Module['FSSync']();});}export async function loadGame(_0x303f55){const _0x3bfe53=a0_0xdd0282,_0x1ea20e=_0x303f55['replace'](/\.(gba|gbc|gb|zip)$/,_0x3bfe53(0x168)),_0x56b3ce=Module[_0x3bfe53(0x11a)]()[_0x3bfe53(0x176)](_0x5262e9=>_0x5262e9!=='.'&&_0x5262e9!=='..');intro[_0x3bfe53(0x138)][_0x3bfe53(0x12a)](_0x3bfe53(0x15f)),errorLogElements[0x0][_0x3bfe53(0x140)]['bottom']='0',ingame['classList'][_0x3bfe53(0x137)](_0x3bfe53(0x15f)),_0x303f55[_0x3bfe53(0x161)](_0x3bfe53(0x13e))||_0x303f55[_0x3bfe53(0x161)](_0x3bfe53(0x155))?(canvas[_0x3bfe53(0x138)]['add']('gbc'),areaTrans[_0x3bfe53(0x138)][_0x3bfe53(0x12a)]('gbc1'),localStorage[_0x3bfe53(0x102)]('screenSize',_0x3bfe53(0x108)+(window['innerWidth']-0xe6)+','+(window[_0x3bfe53(0x165)]-0xe6)*0x9/0xa)):localStorage[_0x3bfe53(0x102)](_0x3bfe53(0x14d),_0x3bfe53(0x108)+(window[_0x3bfe53(0x165)]-0x96)+','+(window[_0x3bfe53(0x165)]-0x96)*0x2/0x3),_0x56b3ce[_0x3bfe53(0x130)](_0x1ea20e)?(await Module[_0x3bfe53(0x147)](_0x3bfe53(0x173)+_0x303f55),confirm(_0x3bfe53(0x136))&&(await Module['loadState'](0x0),await shaderData())):(await Module['loadGame'](_0x3bfe53(0x173)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x304f70){const _0x1f0ca9=a0_0xdd0282;await Module[_0x1f0ca9(0x14e)](_0x304f70);}export async function loadState(_0x5c91b4){const _0xa7898f=a0_0xdd0282;await Module[_0xa7898f(0x15e)](_0x5c91b4);}export async function downloadFile(_0x10a4ad,_0x56db5e){const _0x267016=a0_0xdd0282,_0x1fd5c8=Module[_0x267016(0x15b)](_0x10a4ad),_0x4c2ec2=document[_0x267016(0x141)]('a');document['body']['appendChild'](_0x4c2ec2),_0x4c2ec2[_0x267016(0x144)]=_0x56db5e;const _0x7aa558=new Blob([_0x1fd5c8],{'type':_0x267016(0x101)});_0x4c2ec2['href']=URL[_0x267016(0x16d)](_0x7aa558),_0x4c2ec2[_0x267016(0x148)](),URL[_0x267016(0x112)](_0x7aa558),_0x4c2ec2[_0x267016(0x137)]();}export function downloadFileInCloud(_0x1c7248){const _0xd30084=a0_0xdd0282;try{const _0x1921a1=Module[_0xd30084(0x15b)](_0x1c7248);return _0x1921a1;}catch(_0xe2b70a){return null;}}export async function uploadFileInCloud(_0x507cb0){const _0x37aede=a0_0xdd0282;Module[_0x37aede(0x153)](_0x507cb0,async()=>{localStorageFile(),await Module['FSSync']();});}export async function uploadFile(_0x329178){const _0x5d48c4=a0_0xdd0282,_0x5941ab=_0x329178[_0x5d48c4(0x170)][0x0];Module[_0x5d48c4(0x153)](_0x5941ab,async()=>{const _0x565082=_0x5d48c4;localStorageFile(),await Module[_0x565082(0x13a)]();});}export async function editFile(_0x3e7679,_0x1fbd25,_0x790508){const _0xd6aa08=a0_0xdd0282;await Module[_0xd6aa08(0x152)](_0x3e7679,_0x1fbd25,_0x790508);}export async function deleteFile(_0x435fab){const _0x7ae8dd=a0_0xdd0282;try{return await Module[_0x7ae8dd(0x163)](_0x435fab),!![];}catch(_0x324ba1){return console[_0x7ae8dd(0x123)](_0x435fab),null;}}function a0_0x383d(){const _0x1b73a3=['.gbc','persisted','style','createElement','textContent','Auto\x20save\x20','download','/data/states/','1954953KgSupm','loadGame','click','#20A5A6','led06','8IWRWCS','saveTime','screenSize','saveState','turboF','lastIndexOf','replace','editFileName','uploadAll','led00','.gb','autoLoadCheats','visible','1GkDHUK','led07','/data/screenshots/','downloadFile','trim','canvas','loadState','disable','setFastForwardMultiplier','endsWith','led0','deleteFile','onLine','innerWidth','padStart','concat','.ss0','substring','then','turboState','match','createObjectURL','join','Error\x20ledSave:','files','screenshot','SDL2','/data/games/','led01','getElementById','filter','application/octet-stream','setItem','split','exec','\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)','opacity','encode','0,0,','tEXtComment\x00','led02','fill','led03','8EzFgvE','.png','uploadRom','slotStateSaved','setVolume','revokeObjectURL','hidden','2999105iTHyYu','beforeunload','log','pagehide','rgba(245,\x20232,\x20209,\x200.4)','toString','listStates','now','1751610WSUnSN','image/png','All','\x20time(s)','4360800GxycyR','addEventListener','length','error','listSaves','control-setting','Paused!','type','buttonUnpress','#E0C068','add','0.4','getItem','visibilitychange','1846918jgdOVN','visibilityState','includes','listCheats','entries','Cloud\x20upload\x20','60304280ytlFVb','\x20:\x20','Do\x20you\x20want\x20to\x20load\x20save\x20state?','remove','classList','contains','FSSync','map','listScreenshots','11946771PgJcOZ'];a0_0x383d=function(){return _0x1b73a3;};return a0_0x383d();}export function listGame(){const _0x1b9ec7=Module['listRoms']()['filter'](_0x3adaff=>_0x3adaff!=='.'&&_0x3adaff!=='..');return _0x1b9ec7;}export function listSave(){const _0x4437f6=a0_0xdd0282,_0x56eebe=Module[_0x4437f6(0x124)]()[_0x4437f6(0x176)](_0x5a68a7=>_0x5a68a7!=='.'&&_0x5a68a7!=='..');return _0x56eebe;}export function listState(){const _0x5eeb0d=Module['listStates']()['filter'](_0x23ebd0=>_0x23ebd0!=='.'&&_0x23ebd0!=='..');return _0x5eeb0d;}export function listCheat(){const _0x22018d=a0_0xdd0282,_0xf2b33d=Module[_0x22018d(0x131)]()[_0x22018d(0x176)](_0x4aff28=>_0x4aff28!=='.'&&_0x4aff28!=='..');return _0xf2b33d;}export function listScreenshot(){const _0x5d6ecf=a0_0xdd0282,_0xbc51fe=Module[_0x5d6ecf(0x13c)]()['filter'](_0x1ae28c=>_0x1ae28c!=='.'&&_0x1ae28c!=='..');return _0xbc51fe;}export function fileSize(_0x588dd3){const _0x38b64d=Module['fileSize'](_0x588dd3);return _0x38b64d;}export async function resumeGame(){Module['resumeGame'](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x4d6797=a0_0xdd0282;Module['pauseGame'](),Module[_0x4d6797(0x172)](),notiMessage(_0x4d6797(0x126),0x7d0);}export async function buttonPress(_0x239b72){Module['buttonPress'](_0x239b72);}export async function buttonUnpress(_0x687000){const _0x4e62b9=a0_0xdd0282;Module[_0x4e62b9(0x128)](_0x687000);}export async function screenShot(_0x363ef7){const _0x2f367b=a0_0xdd0282,_0x104ec3=gameName['replace'](/\.(gba|gbc|gb|zip)$/,'_'+_0x363ef7+_0x2f367b(0x10e)),_0x14cf33=await getData(gameName,_0x363ef7,_0x2f367b(0x11e))||'';console[_0x2f367b(0x116)](_0x14cf33),await Module[_0x2f367b(0x171)](_0x104ec3),await setData(gameName,_0x363ef7,_0x2f367b(0x14c),formatDateTime(Date[_0x2f367b(0x11b)]()),_0x14cf33);}export async function dowloadScreenShot(_0x34434b){const _0x471434=a0_0xdd0282;try{const _0x4fde3f=await fileToBase64(Module[_0x471434(0x15b)](_0x34434b));return _0x4fde3f;}catch{}}export async function captureOCR(_0x1d54c7){const _0x454200=a0_0xdd0282;Module['screenshot'](_0x1d54c7);const _0x38a24e=Module[_0x454200(0x15b)]('/data/screenshots/'+_0x1d54c7);return _0x38a24e;}export async function setFastForwardMultiplier(_0x297193){const _0xc72d7=a0_0xdd0282;Module[_0xc72d7(0x160)](_0x297193);}export async function uploadCheats(_0x290876){const _0x42fbd3=a0_0xdd0282;Module[_0x42fbd3(0x156)](),Module[_0x42fbd3(0x153)](_0x290876,async()=>{});}export function setVolume(_0x5242fe){const _0xcf499f=a0_0xdd0282;Module[_0xcf499f(0x111)](_0x5242fe);}export async function setData(_0x5e62e0,_0x596c57,_0x498645,_0x33d767,_0x47ce17=''){const _0x1cfe9b=a0_0xdd0282,_0x3716a0=_0x5e62e0['replace'](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x12f0cd=_0x1cfe9b(0x15a)+_0x3716a0+'_'+_0x596c57+_0x1cfe9b(0x10e);let _0x4eedaa;try{_0x4eedaa=await fileToBase64(Module[_0x1cfe9b(0x15b)](_0x12f0cd));}catch(_0x36077e){await Module[_0x1cfe9b(0x171)](_0x3716a0+'_'+_0x596c57+_0x1cfe9b(0x10e)),await delay(0xc8),_0x4eedaa=await fileToBase64(Module[_0x1cfe9b(0x15b)](_0x12f0cd));}let _0xaf4651=atob(_0x4eedaa[_0x1cfe9b(0x103)](',')[0x1]),_0x2d0f5d=_0x1cfe9b(0x109),_0x186687=_0xaf4651['indexOf'](_0x2d0f5d),_0x108fb4={};if(_0x186687!==-0x1||_0x47ce17['trim']()!==''){let _0x3278d2=_0x186687!==-0x1?_0xaf4651[_0x1cfe9b(0x169)](_0x186687+_0x2d0f5d[_0x1cfe9b(0x122)]):_0x47ce17,_0x18ef82=/(\w+)\s*:\s*([^|]*)/g,_0x22c6af;while((_0x22c6af=_0x18ef82[_0x1cfe9b(0x104)](_0x3278d2))!==null){_0x108fb4[_0x22c6af[0x1][_0x1cfe9b(0x15c)]()]=_0x22c6af[0x2]['trim']();}_0x186687!==-0x1&&(_0xaf4651=_0xaf4651[_0x1cfe9b(0x169)](0x0,_0x186687));}_0x108fb4[_0x498645]=_0x33d767;let _0x440634=Object[_0x1cfe9b(0x132)](_0x108fb4)[_0x1cfe9b(0x13b)](([_0x2be2a1,_0x2a1950])=>_0x2be2a1+_0x1cfe9b(0x135)+_0x2a1950)[_0x1cfe9b(0x16e)]('\x20|\x20'),_0x49e330=new TextEncoder()[_0x1cfe9b(0x107)](_0x2d0f5d+'\x20'+_0x440634),_0x59526f=new Uint8Array([..._0xaf4651][_0x1cfe9b(0x13b)](_0x575d76=>_0x575d76['charCodeAt'](0x0))[_0x1cfe9b(0x167)]([..._0x49e330])),_0x45d306=new File([new Blob([_0x59526f],{'type':_0x1cfe9b(0x11d)})],_0x3716a0+'_'+_0x596c57+'.png',{'type':'image/png'});Module[_0x1cfe9b(0x153)](_0x45d306,async()=>{});}export async function getData(_0x5f3360,_0x1b65bb,_0x3ab671){const _0x268240=a0_0xdd0282;try{const _0x4c3745=_0x5f3360[_0x268240(0x151)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x18834b='/data/screenshots/'+_0x4c3745+'_'+_0x1b65bb+_0x268240(0x10e);let _0x4d8f7e;try{_0x4d8f7e=await fileToBase64(Module[_0x268240(0x15b)](_0x18834b));}catch(_0x263f2e){return null;}let _0x52827d=atob(_0x4d8f7e[_0x268240(0x103)](',')[0x1]),_0x1eb037=_0x268240(0x109),_0x2a6404=_0x52827d['indexOf'](_0x1eb037);if(_0x2a6404!==-0x1){let _0x20b9da=_0x52827d[_0x268240(0x169)](_0x2a6404+_0x1eb037[_0x268240(0x122)]);if(_0x3ab671===_0x268240(0x11e))return _0x20b9da[_0x268240(0x15c)]();let _0x20acfc=new RegExp(_0x3ab671+_0x268240(0x105)),_0x163b4a=_0x20b9da[_0x268240(0x16c)](_0x20acfc);if(_0x163b4a)return _0x163b4a[0x1][_0x268240(0x15c)]();}}catch(_0x248fde){return console[_0x268240(0x123)]({'romName':_0x5f3360,'slot':_0x1b65bb,'type':_0x3ab671}),null;}}export async function ledSave(_0x270b26){const _0x5aa3f1=a0_0xdd0282,_0x241928=parseInt(await getData(gameName,'0',_0x5aa3f1(0x110))),_0x119296=_0x241928===0x1?_0x5aa3f1(0x174):_0x241928===0x2?_0x5aa3f1(0x10a):_0x241928===0x3?_0x5aa3f1(0x10c):_0x241928===0x4?'led04':_0x241928===0x5?'led05':_0x241928===0x6?_0x5aa3f1(0x14a):_0x241928===0x7?_0x5aa3f1(0x159):_0x5aa3f1(0x154);try{for(let _0x2faeb2=0x0;_0x2faeb2<=0x7;_0x2faeb2++){document['getElementById']('led0'+_0x2faeb2)['style']['fill']='rgba(245,\x20232,\x20209,\x200.4)';}await delay(0x3e8);for(let _0x415653=0x0;_0x415653<=0x7;_0x415653++){document[_0x5aa3f1(0x175)](_0x5aa3f1(0x162)+_0x415653)[_0x5aa3f1(0x140)][_0x5aa3f1(0x10b)]=_0x5aa3f1(0x118);}document[_0x5aa3f1(0x175)](_0x119296)[_0x5aa3f1(0x140)]['fill']=_0x270b26;}catch(_0x33dec8){console[_0x5aa3f1(0x123)](_0x5aa3f1(0x16f),_0x33dec8);}};export async function notiMessage(_0x14ebe7,_0x452e8a,_0x2d710e=![]){const _0x4c2c7d=a0_0xdd0282;var _0x49371f=document[_0x4c2c7d(0x175)]('noti-mess');const _0x43cc35=parseInt(await getData(gameName,'0',_0x4c2c7d(0x110)))||0x0;_0x49371f[_0x4c2c7d(0x140)][_0x4c2c7d(0x106)]===_0x4c2c7d(0x12b)&&(clearTimeout(messageTimeout),_0x49371f[_0x4c2c7d(0x140)][_0x4c2c7d(0x106)]='0'),_0x49371f[_0x4c2c7d(0x142)]=_0x14ebe7,_0x49371f[_0x4c2c7d(0x140)][_0x4c2c7d(0x106)]=_0x4c2c7d(0x12b),messageTimeout=setTimeout(()=>{const _0x1b6d81=_0x4c2c7d;_0x49371f[_0x1b6d81(0x142)]='['+_0x43cc35+']\x20'+gameName['substring'](0x0,gameName[_0x1b6d81(0x150)]('.')),_0x49371f[_0x1b6d81(0x140)][_0x1b6d81(0x106)]=_0x1b6d81(0x12b);},_0x452e8a),_0x2d710e&&(canvas[_0x4c2c7d(0x138)][_0x4c2c7d(0x12a)]('visible'),setTimeout(()=>{const _0x30853c=_0x4c2c7d;canvas[_0x30853c(0x138)]['remove']('visible');},0x258));}export async function FSSync(){const _0x5e6c31=a0_0xdd0282;Module[_0x5e6c31(0x13a)]();}