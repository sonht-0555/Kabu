const a0_0x2a984f=a0_0x5765;(function(_0x4cca2a,_0x524080){const _0x1c4186=a0_0x5765,_0x1f903c=_0x4cca2a();while(!![]){try{const _0x319b4d=parseInt(_0x1c4186(0x81))/0x1+parseInt(_0x1c4186(0xab))/0x2+-parseInt(_0x1c4186(0x86))/0x3*(-parseInt(_0x1c4186(0x8d))/0x4)+-parseInt(_0x1c4186(0xa0))/0x5+-parseInt(_0x1c4186(0xa5))/0x6*(-parseInt(_0x1c4186(0x9c))/0x7)+-parseInt(_0x1c4186(0xb7))/0x8*(parseInt(_0x1c4186(0x94))/0x9)+parseInt(_0x1c4186(0x7b))/0xa*(-parseInt(_0x1c4186(0xd2))/0xb);if(_0x319b4d===_0x524080)break;else _0x1f903c['push'](_0x1f903c['shift']());}catch(_0x21cd22){_0x1f903c['push'](_0x1f903c['shift']());}}}(a0_0x5f11,0x61630));import a0_0xdd68fb from'../core/mgba.js';import*as a0_0x233a56 from'./gamepad.js';import{localStorageFile}from'./storage.js';function a0_0x5765(_0x3729e0,_0x50fb94){const _0x5f119c=a0_0x5f11();return a0_0x5765=function(_0x576518,_0x387e3d){_0x576518=_0x576518-0x6a;let _0x6d147f=_0x5f119c[_0x576518];return _0x6d147f;},a0_0x5765(_0x3729e0,_0x50fb94);}import{dpUploadFile}from'./cloud.js';import{shaderData}from'./setting.js';import{wrapContent}from'./state.js';const Module={'canvas':document[a0_0x2a984f(0x85)]('canvas')};function initializeCore(_0x509ba9,_0x216642){const _0xec4460=a0_0x2a984f;_0x509ba9(_0x216642)[_0xec4460(0x8c)](function(_0x24f266){const _0x1756d5=_0xec4460;_0x24f266[_0x1756d5(0xc4)]();});}initializeCore(a0_0xdd68fb,Module);let countAutoSave=0x0,countUpload=0x0;const canvas=document[a0_0x2a984f(0x85)](a0_0x2a984f(0xdd)),controlSetting=document[a0_0x2a984f(0x85)](a0_0x2a984f(0xde));function handleVisibilityChange(_0x47ec5b){const _0x3563a6=a0_0x2a984f;document[_0x3563a6(0xc9)]===_0x3563a6(0xc5)||_0x47ec5b?.['type']===_0x3563a6(0xd6)||_0x47ec5b?.['persisted']?(Module[_0x3563a6(0xb4)](),pauseGame(),canvas['classList'][_0x3563a6(0x7c)](_0x3563a6(0xbb))):(setTimeout(()=>{const _0x43661b=_0x3563a6;canvas['classList'][_0x43661b(0xe0)](_0x43661b(0xbb));},0x258),controlSetting['classList'][_0x3563a6(0xcb)](_0x3563a6(0xbb))&&resumeGame());}async function statusShow(){const _0x462dc8=a0_0x2a984f;document[_0x462dc8(0xad)](_0x462dc8(0x8a),handleVisibilityChange),document[_0x462dc8(0xad)]('visibilitychange',handleVisibilityChange),window[_0x462dc8(0xad)](_0x462dc8(0xd6),handleVisibilityChange),restoreArea(),startTimer(),await a0_0x233a56[_0x462dc8(0xa4)](parseInt(await getData(gameName,'0',_0x462dc8(0xb6)))),await delay(0xc8),await Module[_0x462dc8(0x79)](),await delay(0x320),await led(parseInt(await getData(gameName,'0',_0x462dc8(0xd8)))),await notiMessage(gameVer,0x3e8),await wrapContent();}async function saveStatePeriodically(){const _0x182597=a0_0x2a984f;await ledSave(_0x182597(0xc7)),await Module[_0x182597(0xda)](0x0),await Module[_0x182597(0xb4)](),await screenShot(0x0),console[_0x182597(0xbc)](_0x182597(0x88)+ ++countAutoSave+_0x182597(0xac));}async function saveStateInCloud(){const _0x564292=a0_0x2a984f,_0x344301=gameName[_0x564292(0x8b)](/\.(zip|gb|gbc|gba)$/,_0x564292(0xc6)),_0x41b5ad=localStorage['getItem'](_0x564292(0xcd));navigator['onLine']&&(_0x41b5ad&&(await ledSave(_0x564292(0xd1)),await delay(0x3e8),await dpUploadFile(_0x344301,Module['downloadFile']('/data/states/'+_0x344301),_0x564292(0x74)),await lockNoti('',_0x564292(0xdc)+ ++countUpload+'\x20time(s)',0x7d0)));}function startTimer(){let [_0x1587d4,_0x4de6f0,_0x346a9a,_0x3ffdb8,_0x4f3b84]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x1cf159=a0_0x5765;_0x346a9a++,_0x3ffdb8++,_0x4f3b84++;if(_0x346a9a===0x3c)[_0x346a9a,_0x4de6f0]=[0x0,_0x4de6f0+0x1];if(_0x4de6f0===0x3c)[_0x4de6f0,_0x1587d4]=[0x0,_0x1587d4+0x1];document[_0x1cf159(0x85)](_0x1cf159(0xb9))['textContent']=_0x1587d4+'h'+_0x4de6f0[_0x1cf159(0xd9)]()[_0x1cf159(0xcc)](0x2,'0')+'.'+_0x346a9a[_0x1cf159(0xd9)]()[_0x1cf159(0xcc)](0x2,'0');_0x3ffdb8===0x3c&&(saveStatePeriodically(),_0x3ffdb8=0x0);;_0x4f3b84===0x708&&(saveStateInCloud(),_0x4f3b84=0x0);;},0x3e8);}export async function uploadGame(_0x52561b){const _0x27e005=a0_0x2a984f,_0x3a9d6b=_0x52561b['files'][0x0];Module[_0x27e005(0x6a)](_0x3a9d6b,()=>{const _0x4f0fa0=_0x27e005;Module[_0x4f0fa0(0xb4)]();});}export async function loadGame(_0x286184){const _0xc4eb03=a0_0x2a984f,_0x2630a9=_0x286184[_0xc4eb03(0x8b)](/\.(gba|gbc|gb|zip)$/,_0xc4eb03(0xc6)),_0x1c9c97=Module[_0xc4eb03(0x84)]()[_0xc4eb03(0x70)](_0x1dc010=>_0x1dc010!=='.'&&_0x1dc010!=='..');intro[_0xc4eb03(0xdb)][_0xc4eb03(0x7c)]('disable'),errorLogElements[0x0][_0xc4eb03(0x6d)][_0xc4eb03(0xb8)]='0',ingame['classList'][_0xc4eb03(0xe0)](_0xc4eb03(0x8f)),_0x286184['endsWith'](_0xc4eb03(0xa2))||_0x286184[_0xc4eb03(0x99)](_0xc4eb03(0x93))?(canvas[_0xc4eb03(0xdb)][_0xc4eb03(0x7c)]('gbc'),areaTrans[_0xc4eb03(0xdb)]['add'](_0xc4eb03(0x89)),localStorage[_0xc4eb03(0x77)](_0xc4eb03(0xa6),_0xc4eb03(0xc2)+(window[_0xc4eb03(0x9b)]-0xe6)+','+(window[_0xc4eb03(0x9b)]-0xe6)*0x9/0xa)):localStorage[_0xc4eb03(0x77)]('screenSize',_0xc4eb03(0xc2)+(window[_0xc4eb03(0x9b)]-0x96)+','+(window[_0xc4eb03(0x9b)]-0x96)*0x2/0x3),_0x1c9c97[_0xc4eb03(0x6b)](_0x2630a9)?(await Module[_0xc4eb03(0xc8)]('/data/games/'+_0x286184),confirm(_0xc4eb03(0x76))&&(await Module['loadState'](0x0),await shaderData())):(await Module[_0xc4eb03(0xc8)](_0xc4eb03(0x6f)+gameName),await shaderData()),await statusShow();}export async function saveState(_0x2b6b44){const _0x9037a4=a0_0x2a984f;await Module[_0x9037a4(0xda)](_0x2b6b44);}export async function loadState(_0x142881){const _0x212a9d=a0_0x2a984f;await Module[_0x212a9d(0xa8)](_0x142881);}export async function downloadFile(_0x155f79,_0x2f1427){const _0x2cfe06=a0_0x2a984f,_0x54039b=Module['downloadFile'](_0x155f79),_0x178f06=document[_0x2cfe06(0x72)]('a');document[_0x2cfe06(0x71)][_0x2cfe06(0x92)](_0x178f06),_0x178f06[_0x2cfe06(0xc0)]=_0x2f1427;const _0x58c8e0=new Blob([_0x54039b],{'type':_0x2cfe06(0xdf)});_0x178f06[_0x2cfe06(0x96)]=URL['createObjectURL'](_0x58c8e0),_0x178f06[_0x2cfe06(0xbd)](),URL['revokeObjectURL'](_0x58c8e0),_0x178f06[_0x2cfe06(0xe0)]();}export function downloadFileInCloud(_0x13b103){const _0x3c168e=a0_0x2a984f;try{const _0x35c81a=Module[_0x3c168e(0x75)](_0x13b103);return _0x35c81a;}catch(_0x581420){return null;}}export async function uploadFileInCloud(_0x4b62e2){const _0x109ddf=a0_0x2a984f;Module[_0x109ddf(0xcf)](_0x4b62e2,async()=>{const _0x3db885=_0x109ddf;localStorageFile(),await Module[_0x3db885(0xb4)]();});}function a0_0x5f11(){const _0xff9890=['Error\x20ledSave:','.gbc','led03','turboF','4464858FTsqHj','screenSize','fileSize','loadState','editFileName','0.4','632712owAvIc','\x20time(s)','addEventListener','opacity','saveTime','indexOf','led0','led07','/data/screenshots/','FSSync','charCodeAt','turboState','62024lWtYoM','bottom','timer','trim','visible','log','click','entries','textContent','download','\x20:\x20','0,0,','All','FSInit','hidden','.ss0','#20A5A6','loadGame','visibilityState','image/png','contains','padStart','uId','rgba(245,\x20232,\x20209,\x200.4)','uploadAll','buttonPress','#E0C068','55mpWkYQ','exec','fill','buttonUnpress','beforeunload','tEXtComment\x00','slotStateSaved','toString','saveState','classList','Cloud\x20upload\x20','canvas','control-setting','application/octet-stream','remove','setFastForwardMultiplier','uploadRom','includes','listCheats','style','Paused!','/data/games/','filter','body','createElement','setVolume','state','downloadFile','Do\x20you\x20want\x20to\x20load\x20save\x20state?','setItem','screenshot','SDL2','error','1448430TnCkoV','add','lastIndexOf','split','set','led05','661028SMxxQX','join','map','listStates','getElementById','15FWXLkl','encode','Auto\x20save\x20','gbc1','pagehide','replace','then','215276bCxdCS','length','disable','led02','substring','appendChild','.gb','279EemMXz','listSaves','href','autoLoadCheats','resumeGame','endsWith','led00','innerWidth','7OuieeQ','.png','\x20|\x20','deleteFile','3135840jnKqxY'];a0_0x5f11=function(){return _0xff9890;};return a0_0x5f11();}export async function uploadFile(_0x1d5ab4){const _0x4f2305=a0_0x2a984f,_0x355f20=_0x1d5ab4['files'][0x0];Module[_0x4f2305(0xcf)](_0x355f20,async()=>{localStorageFile(),await Module['FSSync']();});}export async function editFile(_0x3d06cb,_0x22ef39,_0x36eff4){const _0x5dfa4a=a0_0x2a984f;await Module[_0x5dfa4a(0xa9)](_0x3d06cb,_0x22ef39,_0x36eff4);}export async function deleteFile(_0xe48fdd){const _0x154262=a0_0x2a984f;try{return await Module[_0x154262(0x9f)](_0xe48fdd),!![];}catch(_0x4eef7f){return console[_0x154262(0x7a)](_0xe48fdd),null;}}export function listGame(){const _0x3372b7=a0_0x2a984f,_0x3f9e7b=Module['listRoms']()[_0x3372b7(0x70)](_0x2209d1=>_0x2209d1!=='.'&&_0x2209d1!=='..');return _0x3f9e7b;}export function listSave(){const _0x30f3bd=a0_0x2a984f,_0x456143=Module[_0x30f3bd(0x95)]()[_0x30f3bd(0x70)](_0x43ce4f=>_0x43ce4f!=='.'&&_0x43ce4f!=='..');return _0x456143;}export function listState(){const _0x35ba5b=a0_0x2a984f,_0x5a8711=Module['listStates']()[_0x35ba5b(0x70)](_0x27d379=>_0x27d379!=='.'&&_0x27d379!=='..');return _0x5a8711;}export function listCheat(){const _0x78e7e=a0_0x2a984f,_0x31b1a1=Module[_0x78e7e(0x6c)]()[_0x78e7e(0x70)](_0xe15cfd=>_0xe15cfd!=='.'&&_0xe15cfd!=='..');return _0x31b1a1;}export function listScreenshot(){const _0x4bbb7b=a0_0x2a984f,_0x2c11cb=Module['listScreenshots']()[_0x4bbb7b(0x70)](_0x991858=>_0x991858!=='.'&&_0x991858!=='..');return _0x2c11cb;}export function embedTextInPngFile(_0x2bf2ec,_0x2011c9,_0x508a21){const _0x3aa254=a0_0x2a984f;let _0x499799=atob(_0x2bf2ec[_0x3aa254(0x7e)](',')[0x1]),_0x5504af=new Uint8Array(_0x499799['length']);for(let _0x58b214=0x0;_0x58b214<_0x499799['length'];_0x58b214++){_0x5504af[_0x58b214]=_0x499799[_0x3aa254(0xb5)](_0x58b214);}let _0x3b327c=new TextEncoder()[_0x3aa254(0x87)](_0x3aa254(0xd7)+_0x2011c9),_0x58130d=new Uint8Array(_0x5504af[_0x3aa254(0x8e)]+_0x3b327c[_0x3aa254(0x8e)]);_0x58130d['set'](_0x5504af,0x0),_0x58130d[_0x3aa254(0x7f)](_0x3b327c,_0x5504af[_0x3aa254(0x8e)]);let _0x589698=new Blob([_0x58130d],{'type':'image/png'}),_0x5374de=new File([_0x589698],_0x508a21,{'type':_0x3aa254(0xca)});return _0x5374de;}export function extractTextFromPngBase64(_0x16840e){const _0x1f8bf8=a0_0x2a984f;let _0xcfab5f=atob(_0x16840e[_0x1f8bf8(0x7e)](',')[0x1]),_0x2a7da2=_0x1f8bf8(0xd7),_0xb26603=_0xcfab5f['indexOf'](_0x2a7da2);if(_0xb26603!==-0x1)return _0xcfab5f[_0x1f8bf8(0x91)](_0xb26603+_0x2a7da2[_0x1f8bf8(0x8e)]);return null;}export function fileSize(_0x4dca5d){const _0x2ef1f8=a0_0x2a984f,_0x1e6694=Module[_0x2ef1f8(0xa7)](_0x4dca5d);return _0x1e6694;}export async function resumeGame(){const _0x579a1b=a0_0x2a984f;Module[_0x579a1b(0x98)](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x2b731d=a0_0x2a984f;Module['pauseGame'](),Module[_0x2b731d(0x79)](),notiMessage(_0x2b731d(0x6e),0x7d0);}export async function buttonPress(_0x558fc6){const _0x5c0879=a0_0x2a984f;Module[_0x5c0879(0xd0)](_0x558fc6);}export async function buttonUnpress(_0x1baedb){const _0xd3feb1=a0_0x2a984f;Module[_0xd3feb1(0xd5)](_0x1baedb);}export async function screenShot(_0x24419d){const _0x4e4b69=a0_0x2a984f,_0x39d981=gameName[_0x4e4b69(0x8b)](/\.(gba|gbc|gb|zip)$/,'_'+_0x24419d+_0x4e4b69(0x9d)),_0x549bff=await getData(gameName,_0x24419d,_0x4e4b69(0xc3))||'';console[_0x4e4b69(0xbc)](_0x549bff),await Module[_0x4e4b69(0x78)](_0x39d981),await setData(gameName,_0x24419d,_0x4e4b69(0xaf),formatDateTime(Date['now']()),_0x549bff);}export async function dowloadScreenShot(_0x1e5b56){try{const _0x331787=await fileToBase64(Module['downloadFile'](_0x1e5b56));return _0x331787;}catch{}}export async function captureOCR(_0xb4c100){const _0x1ebf4c=a0_0x2a984f;Module[_0x1ebf4c(0x78)](_0xb4c100);const _0xd9ce98=Module[_0x1ebf4c(0x75)](_0x1ebf4c(0xb3)+_0xb4c100);return _0xd9ce98;}export async function setFastForwardMultiplier(_0x17dad5){const _0x4e6ec6=a0_0x2a984f;Module[_0x4e6ec6(0xe1)](_0x17dad5);}export async function uploadCheats(_0xe64cf2){const _0x5baf4e=a0_0x2a984f;Module[_0x5baf4e(0x97)](),Module[_0x5baf4e(0xcf)](_0xe64cf2,async()=>{});}export function setVolume(_0x558c4d){const _0xb76f97=a0_0x2a984f;Module[_0xb76f97(0x73)](_0x558c4d);}export async function setData(_0x294a9c,_0x2d644d,_0x30b2ff,_0x5bb7a9,_0x5e8671=''){const _0x46dd29=a0_0x2a984f,_0xd42b54=_0x294a9c[_0x46dd29(0x8b)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x1689e2=_0x46dd29(0xb3)+_0xd42b54+'_'+_0x2d644d+'.png';let _0x44809b;try{_0x44809b=await fileToBase64(Module[_0x46dd29(0x75)](_0x1689e2));}catch(_0x42345c){await Module[_0x46dd29(0x78)](_0xd42b54+'_'+_0x2d644d+_0x46dd29(0x9d)),await delay(0xc8),_0x44809b=await fileToBase64(Module[_0x46dd29(0x75)](_0x1689e2));}let _0x502885=atob(_0x44809b[_0x46dd29(0x7e)](',')[0x1]),_0x1ba43a=_0x46dd29(0xd7),_0x4ef9fd=_0x502885[_0x46dd29(0xb0)](_0x1ba43a),_0xc689af={};if(_0x4ef9fd!==-0x1||_0x5e8671['trim']()!==''){let _0x2896bb=_0x4ef9fd!==-0x1?_0x502885[_0x46dd29(0x91)](_0x4ef9fd+_0x1ba43a[_0x46dd29(0x8e)]):_0x5e8671,_0x109f5c=/(\w+)\s*:\s*([^|]*)/g,_0x2e949c;while((_0x2e949c=_0x109f5c[_0x46dd29(0xd3)](_0x2896bb))!==null){_0xc689af[_0x2e949c[0x1][_0x46dd29(0xba)]()]=_0x2e949c[0x2][_0x46dd29(0xba)]();}_0x4ef9fd!==-0x1&&(_0x502885=_0x502885[_0x46dd29(0x91)](0x0,_0x4ef9fd));}_0xc689af[_0x30b2ff]=_0x5bb7a9;let _0x23c112=Object[_0x46dd29(0xbe)](_0xc689af)[_0x46dd29(0x83)](([_0x894842,_0x46f950])=>_0x894842+_0x46dd29(0xc1)+_0x46f950)[_0x46dd29(0x82)](_0x46dd29(0x9e)),_0xf7f12b=new TextEncoder()[_0x46dd29(0x87)](_0x1ba43a+'\x20'+_0x23c112),_0x195af4=new Uint8Array([..._0x502885][_0x46dd29(0x83)](_0x1886b6=>_0x1886b6[_0x46dd29(0xb5)](0x0))['concat']([..._0xf7f12b])),_0x5b3cd5=new File([new Blob([_0x195af4],{'type':'image/png'})],_0xd42b54+'_'+_0x2d644d+_0x46dd29(0x9d),{'type':_0x46dd29(0xca)});Module[_0x46dd29(0xcf)](_0x5b3cd5,async()=>{});}export async function getData(_0x3c73a0,_0x18b053,_0x4d02c4){const _0x5518d8=a0_0x2a984f;try{const _0x5f33fc=_0x3c73a0[_0x5518d8(0x8b)](/\.(gba|gbc|gb|zip|cheats)$/,''),_0x23f16d='/data/screenshots/'+_0x5f33fc+'_'+_0x18b053+_0x5518d8(0x9d);let _0x3738a5;try{_0x3738a5=await fileToBase64(Module['downloadFile'](_0x23f16d));}catch(_0x4c6334){return null;}let _0x683fe7=atob(_0x3738a5[_0x5518d8(0x7e)](',')[0x1]),_0xb019b1='tEXtComment\x00',_0xe5138f=_0x683fe7[_0x5518d8(0xb0)](_0xb019b1);if(_0xe5138f!==-0x1){let _0x476c23=_0x683fe7['substring'](_0xe5138f+_0xb019b1[_0x5518d8(0x8e)]);if(_0x4d02c4===_0x5518d8(0xc3))return _0x476c23[_0x5518d8(0xba)]();let _0x36dc64=new RegExp(_0x4d02c4+'\x5cs*:\x5cs*(.*?)\x5cs*(?=\x5c||$)'),_0x4065d6=_0x476c23['match'](_0x36dc64);if(_0x4065d6)return _0x4065d6[0x1][_0x5518d8(0xba)]();}}catch(_0x3ed493){return console['error']({'romName':_0x3c73a0,'slot':_0x18b053,'type':_0x4d02c4}),null;}}export async function ledSave(_0x461bfa){const _0x250c52=a0_0x2a984f,_0x578909=parseInt(await getData(gameName,'0',_0x250c52(0xd8))),_0x4c8e33=_0x578909===0x1?'led01':_0x578909===0x2?_0x250c52(0x90):_0x578909===0x3?_0x250c52(0xa3):_0x578909===0x4?'led04':_0x578909===0x5?_0x250c52(0x80):_0x578909===0x6?'led06':_0x578909===0x7?_0x250c52(0xb2):_0x250c52(0x9a);try{for(let _0x518826=0x0;_0x518826<=0x7;_0x518826++){document[_0x250c52(0x85)](_0x250c52(0xb1)+_0x518826)[_0x250c52(0x6d)]['fill']=_0x250c52(0xce);}await delay(0x3e8);for(let _0x3f32a7=0x0;_0x3f32a7<=0x7;_0x3f32a7++){document['getElementById']('led0'+_0x3f32a7)['style'][_0x250c52(0xd4)]=_0x250c52(0xce);}document[_0x250c52(0x85)](_0x4c8e33)['style'][_0x250c52(0xd4)]=_0x461bfa;}catch(_0x1d3a1b){console[_0x250c52(0x7a)](_0x250c52(0xa1),_0x1d3a1b);}};export async function notiMessage(_0x116540,_0x5cf307,_0x3eb83e=![]){const _0x37b59c=a0_0x2a984f;var _0x2c9455=document[_0x37b59c(0x85)]('noti-mess');const _0x29c700=parseInt(await getData(gameName,'0','slotStateSaved'))||0x0;_0x2c9455[_0x37b59c(0x6d)]['opacity']==='0.4'&&(clearTimeout(messageTimeout),_0x2c9455[_0x37b59c(0x6d)][_0x37b59c(0xae)]='0'),_0x2c9455[_0x37b59c(0xbf)]=_0x116540,_0x2c9455['style']['opacity']=_0x37b59c(0xaa),messageTimeout=setTimeout(()=>{const _0x578986=_0x37b59c;_0x2c9455[_0x578986(0xbf)]='['+_0x29c700+']\x20'+gameName[_0x578986(0x91)](0x0,gameName[_0x578986(0x7d)]('.')),_0x2c9455[_0x578986(0x6d)]['opacity']=_0x578986(0xaa);},_0x5cf307),_0x3eb83e&&(canvas['classList']['add'](_0x37b59c(0xbb)),setTimeout(()=>{const _0x6f3e8a=_0x37b59c;canvas[_0x6f3e8a(0xdb)][_0x6f3e8a(0xe0)](_0x6f3e8a(0xbb));},0x258));}export async function FSSync(){const _0x2e9b15=a0_0x2a984f;Module[_0x2e9b15(0xb4)]();}