const a0_0x339e91=a0_0x4bba;(function(_0x2fe21c,_0x1faede){const _0x47aa50=a0_0x4bba,_0x2fb98f=_0x2fe21c();while(!![]){try{const _0x1d9373=-parseInt(_0x47aa50(0x1d9))/0x1+parseInt(_0x47aa50(0x1de))/0x2+-parseInt(_0x47aa50(0x1ec))/0x3+-parseInt(_0x47aa50(0x1f7))/0x4*(-parseInt(_0x47aa50(0x22c))/0x5)+parseInt(_0x47aa50(0x217))/0x6*(-parseInt(_0x47aa50(0x1e6))/0x7)+-parseInt(_0x47aa50(0x232))/0x8*(parseInt(_0x47aa50(0x200))/0x9)+parseInt(_0x47aa50(0x230))/0xa*(parseInt(_0x47aa50(0x1fc))/0xb);if(_0x1d9373===_0x1faede)break;else _0x2fb98f['push'](_0x2fb98f['shift']());}catch(_0xd359d9){_0x2fb98f['push'](_0x2fb98f['shift']());}}}(a0_0x46c4,0xf2c38));import a0_0x39490a from'../core/mgba.js';function a0_0x4bba(_0x465ad9,_0x3d0796){const _0x46c49e=a0_0x46c4();return a0_0x4bba=function(_0x4bba30,_0x30e575){_0x4bba30=_0x4bba30-0x1d3;let _0xd5130d=_0x46c49e[_0x4bba30];return _0xd5130d;},a0_0x4bba(_0x465ad9,_0x3d0796);}import*as a0_0x3ced45 from'./gamepad.js';import{localStorageFile}from'./storage.js';import{dpUploadFile,dpRefreshToken}from'./cloud.js';const Module={'canvas':document[a0_0x339e91(0x220)](a0_0x339e91(0x20c))};function initializeCore(_0x53df0d,_0x17ee5a){const _0x3b0d5b=a0_0x339e91;_0x53df0d(_0x17ee5a)[_0x3b0d5b(0x223)](function(_0x458139){const _0x5b5b82=_0x3b0d5b;_0x458139[_0x5b5b82(0x216)]();});}initializeCore(a0_0x39490a,Module);let countAutoSave=0x0,turboState=0x1,countUpload=0x0;const canvas=document[a0_0x339e91(0x220)]('canvas'),savedTurboState=localStorage['getItem'](a0_0x339e91(0x22f)),controlSetting=document[a0_0x339e91(0x220)]('control-setting');function handleVisibilityChange(_0x298d30){const _0x1a7dc3=a0_0x339e91;document[_0x1a7dc3(0x209)]===_0x1a7dc3(0x1f1)||_0x298d30?.[_0x1a7dc3(0x21e)]===_0x1a7dc3(0x21b)||_0x298d30?.[_0x1a7dc3(0x1e7)]?(pauseGame(),canvas[_0x1a7dc3(0x20a)]['add'](_0x1a7dc3(0x1df))):(setTimeout(()=>{const _0x47194b=_0x1a7dc3;canvas[_0x47194b(0x20a)]['remove']('visible');},0x258),controlSetting['classList'][_0x1a7dc3(0x22a)](_0x1a7dc3(0x1df))&&resumeGame());}async function statusShow(){const _0x3fb42d=a0_0x339e91;document['addEventListener']('pagehide',handleVisibilityChange),document[_0x3fb42d(0x234)](_0x3fb42d(0x1e1),handleVisibilityChange),window['addEventListener'](_0x3fb42d(0x21b),handleVisibilityChange),restoreArea(),startTimer(),savedTurboState!==null&&(turboState=parseInt(savedTurboState),await a0_0x3ced45['turboF'](turboState)),await delay(0x3e8),await led(parseInt(localStorage['getItem'](_0x3fb42d(0x1d5)))),await notiMessage(gameVer,0x3e8);}function reName(_0x16534f,_0x13bee4){const _0x457bf0=a0_0x339e91;localStorage[_0x457bf0(0x215)]('gameName',_0x16534f);const _0x42a77a=_0x16534f[_0x457bf0(0x203)](/\.(gba|gbc|gb)$/,_0x13bee4);return _0x42a77a;}async function saveStatePeriodically(){const _0x3836af=a0_0x339e91;await ledSave('#20A5A6'),await Module['saveState'](0x0),await Module[_0x3836af(0x1ef)](),await screenShot(0x0),console['log'](_0x3836af(0x1e8)+ ++countAutoSave+_0x3836af(0x21c));}async function saveStateInCloud(){const _0x3e1745=a0_0x339e91,_0x2f9c78=localStorage[_0x3e1745(0x1f0)]('gameName'),_0x1340e2=_0x2f9c78['replace'](_0x3e1745(0x201),'.ss0'),_0x4efc6c=localStorage[_0x3e1745(0x1f0)](_0x3e1745(0x1ff)),_0x190cd1=localStorage['getItem'](_0x2f9c78+_0x3e1745(0x1db)),_0x280a6d=localStorage[_0x3e1745(0x1f0)](_0x2f9c78+_0x3e1745(0x1f4));if(navigator[_0x3e1745(0x1ed)]){if(_0x4efc6c){await ledSave(_0x3e1745(0x1d7)),await delay(0x3e8),await dpUploadFile(_0x1340e2,Module[_0x3e1745(0x22e)](_0x3e1745(0x1dc)+_0x1340e2));if(_0x190cd1!==null){const _0x505a2c=_0x190cd1+'\x0a\x0a'+_0x280a6d,_0x26d2ed=new Blob([_0x505a2c],{'type':_0x3e1745(0x1e2)});await dpUploadFile(_0x2f9c78+_0x3e1745(0x214),_0x26d2ed);}else console['log']('No\x20screenshot!');await lockNoti('',_0x3e1745(0x1f5)+ ++countUpload+_0x3e1745(0x21c),0x7d0);}else console[_0x3e1745(0x21f)](_0x3e1745(0x211));}else console[_0x3e1745(0x21f)](_0x3e1745(0x1d8));}function startTimer(){let [_0x17afa2,_0x2d87c3,_0x73e8f9,_0x54c04a,_0x2f6ac6]=[0x0,0x0,0x0,0x0,0x0];setInterval(()=>{const _0x7bdb89=a0_0x4bba;_0x73e8f9++,_0x54c04a++,_0x2f6ac6++;if(_0x73e8f9===0x3c)[_0x73e8f9,_0x2d87c3]=[0x0,_0x2d87c3+0x1];if(_0x2d87c3===0x3c)[_0x2d87c3,_0x17afa2]=[0x0,_0x17afa2+0x1];document[_0x7bdb89(0x220)](_0x7bdb89(0x225))[_0x7bdb89(0x1fd)]=_0x17afa2+'h'+_0x2d87c3[_0x7bdb89(0x1f9)]()[_0x7bdb89(0x1eb)](0x2,'0')+'.'+_0x73e8f9[_0x7bdb89(0x1f9)]()[_0x7bdb89(0x1eb)](0x2,'0');_0x54c04a===0x3c&&(saveStatePeriodically(),_0x54c04a=0x0);;_0x54c04a===0xe10&&(saveStateInCloud(),_0x2f6ac6=0x0);;},0x3e8);}export async function uploadGame(_0x4f6121){const _0x333507=a0_0x339e91,_0x446fa4=_0x4f6121['files'][0x0];Module[_0x333507(0x221)](_0x446fa4,()=>{Module['FSSync']();});}export async function loadGame(_0x3dab07){const _0x38aa7b=a0_0x339e91,_0x4287dc=reName(_0x3dab07,_0x38aa7b(0x1fa)),_0x3cac4c=Module[_0x38aa7b(0x228)]();intro['classList'][_0x38aa7b(0x1e9)](_0x38aa7b(0x233)),ingame[_0x38aa7b(0x20a)][_0x38aa7b(0x212)](_0x38aa7b(0x233)),_0x3dab07[_0x38aa7b(0x1e0)](_0x38aa7b(0x205))||_0x3dab07[_0x38aa7b(0x1e0)](_0x38aa7b(0x227))?(canvas[_0x38aa7b(0x20a)][_0x38aa7b(0x1e9)](_0x38aa7b(0x231)),areaTrans['classList'][_0x38aa7b(0x1e9)]('gbc1'),localStorage[_0x38aa7b(0x215)](_0x38aa7b(0x1f3),_0x38aa7b(0x226)+(window[_0x38aa7b(0x1ee)]-0xe6)+','+(window['innerWidth']-0xe6)*0x9/0xa)):localStorage[_0x38aa7b(0x215)](_0x38aa7b(0x1f3),_0x38aa7b(0x226)+(window['innerWidth']-0x96)+','+(window['innerWidth']-0x96)*0x2/0x3),_0x3cac4c['includes'](_0x4287dc)?(await Module['loadGame'](_0x38aa7b(0x1d4)+_0x3dab07),confirm('Do\x20you\x20want\x20to\x20load\x20save\x20state?')&&await Module[_0x38aa7b(0x204)](0x0)):await Module['loadGame'](_0x38aa7b(0x1d4)+_0x3dab07),await statusShow();}export async function saveState(_0x2df1e6){const _0xc654ae=a0_0x339e91;await Module[_0xc654ae(0x1ea)](_0x2df1e6),await Module[_0xc654ae(0x1ef)]();}export async function loadState(_0x10e3d0){const _0x531820=a0_0x339e91;await Module[_0x531820(0x204)](_0x10e3d0);}export async function downloadFile(_0x3e7619,_0x26f804){const _0x362d5c=a0_0x339e91,_0x1ef296=Module[_0x362d5c(0x22e)](_0x3e7619),_0x3904c2=document[_0x362d5c(0x1f8)]('a');document[_0x362d5c(0x218)]['appendChild'](_0x3904c2),_0x3904c2['download']=_0x26f804;const _0xf92b26=new Blob([_0x1ef296],{'type':_0x362d5c(0x22d)});_0x3904c2[_0x362d5c(0x1d3)]=URL['createObjectURL'](_0xf92b26),_0x3904c2[_0x362d5c(0x21a)](),URL[_0x362d5c(0x222)](_0xf92b26),_0x3904c2[_0x362d5c(0x212)]();}export function downloadFileInCloud(_0x2de560){const _0x235655=Module['downloadFile'](_0x2de560);return _0x235655;}export async function uploadFile(_0x37e3dd){const _0x1d9ebc=a0_0x339e91,_0x1ae0b3=_0x37e3dd[_0x1d9ebc(0x213)][0x0];Module[_0x1d9ebc(0x20d)](_0x1ae0b3,()=>{const _0x5eb019=_0x1d9ebc;Module[_0x5eb019(0x1ef)]();});}export async function editFile(_0x5ae10c,_0x3fd6e0,_0x31cd71){const _0x2707f0=a0_0x339e91;await Module[_0x2707f0(0x229)](_0x5ae10c,_0x3fd6e0,_0x31cd71),await Module[_0x2707f0(0x1ef)]();}export async function deleteFile(_0x5c5eea){const _0x3a0847=a0_0x339e91;await Module['deleteFile'](_0x5c5eea),await Module[_0x3a0847(0x1ef)]();}export function listGame(){const _0x4ef758=a0_0x339e91,_0x53d3b1=Module[_0x4ef758(0x202)]();return _0x53d3b1;}export function listSave(){const _0x2d6599=Module['listSaves']();return _0x2d6599;}export function listState(){const _0x3d7426=Module['listStates']();return _0x3d7426;}export function listCheat(){const _0x5b8cd2=a0_0x339e91,_0x665c0b=Module[_0x5b8cd2(0x1f6)]();return _0x665c0b;}export function listScreenshot(){const _0x438459=a0_0x339e91,_0x4e590d=Module[_0x438459(0x235)]();return _0x4e590d;}export function fileSize(_0x40985f){const _0x1d9686=a0_0x339e91,_0x3c2d46=Module[_0x1d9686(0x20e)](_0x40985f);return _0x3c2d46;}export async function uploadCheat(_0x42eb63){const _0x5ae33a=a0_0x339e91;try{const _0x4d1548=_0x42eb63['files'][0x0];await Module[_0x5ae33a(0x219)](_0x4d1548,()=>{const _0x6caceb=_0x5ae33a;console[_0x6caceb(0x21f)](_0x6caceb(0x207),_0x4d1548[_0x6caceb(0x206)]),localStorageFile(),Module[_0x6caceb(0x1ef)]();});}catch(_0x28e696){console[_0x5ae33a(0x1d6)](_0x5ae33a(0x1da),_0x28e696);}}export async function uploadSavSta(_0x58ee8b){const _0x57c353=a0_0x339e91;try{const _0x4f545b=_0x58ee8b[_0x57c353(0x213)][0x0];await Module[_0x57c353(0x20d)](_0x4f545b,()=>{const _0x25e029=_0x57c353;console[_0x25e029(0x21f)]('Save/State\x20uploaded\x20successfully:',_0x4f545b['name']),localStorageFile(),Module['FSSync']();});}catch(_0x1fefcc){console[_0x57c353(0x1d6)](_0x57c353(0x1e4),_0x1fefcc);}}export async function uploadSaveOrSaveState(_0x532a3c){Module['uploadSaveOrSaveState'](_0x532a3c,()=>{localStorageFile(),Module['FSSync']();});}export async function resumeGame(){Module['resumeGame'](),Module['SDL2'](),notiMessage('Resumed!',0x7d0);}export async function pauseGame(){const _0x5b4009=a0_0x339e91;Module['pauseGame'](),Module[_0x5b4009(0x1fb)](),notiMessage(_0x5b4009(0x1e5),0x7d0);}export async function buttonPress(_0x3a0c84){Module['buttonPress'](_0x3a0c84);}export async function buttonUnpress(_0x2a8727){const _0x367ee4=a0_0x339e91;Module[_0x367ee4(0x210)](_0x2a8727);}export async function screenShot(_0x1b807a){const _0x31d2a5=a0_0x339e91,_0x58d2e0=localStorage[_0x31d2a5(0x1f0)](_0x31d2a5(0x20f)),_0x28b7a1=reName(_0x58d2e0,'_');await Module[_0x31d2a5(0x1f2)](''+_0x28b7a1+_0x1b807a+_0x31d2a5(0x20b)),await Module['FSSync']();const _0x848816=await fileToBase64(Module[_0x31d2a5(0x22e)](_0x31d2a5(0x22b)+_0x28b7a1+_0x1b807a+'.png')),_0x2ec31c=Date[_0x31d2a5(0x1e3)](),_0x4a09b4=formatDateTime(_0x2ec31c);localStorage[_0x31d2a5(0x215)](_0x58d2e0+_0x31d2a5(0x208)+_0x1b807a,_0x4a09b4),localStorage[_0x31d2a5(0x215)](_0x58d2e0+_0x31d2a5(0x1dd)+_0x1b807a,_0x848816);}export async function captureOCR(_0x4ef0e2){const _0x459207=a0_0x339e91;Module[_0x459207(0x1f2)](_0x4ef0e2);const _0x234a32=Module['downloadFile'](_0x459207(0x22b)+_0x4ef0e2);return _0x234a32;}function a0_0x46c4(){const _0x476783=['buttonUnpress','Unable\x20to\x20upload\x20to\x20Cloud!','remove','files','_slot0.txt','setItem','FSInit','16248ZqKGNO','body','uploadCheats','click','beforeunload','\x20time(s)','_savedCheats','type','log','getElementById','uploadGame','revokeObjectURL','then','setFastForwardMultiplier','timer','0,0,','.gb','listStates','editFileName','contains','/data/screenshots/','773495TGZqDU','application/octet-stream','downloadFile','turboState','10BPMtRO','gbc','72mvtYIC','disable','addEventListener','listScreenshots','href','/data/games/','slotStateSaved','error','#E0C068','Online!','765400DIMTqM','Error\x20uploadCheat:','_imageState0','/data/states/','_imageState','1448378PEZqNZ','visible','endsWith','visibilitychange','text/plain','now','Error\x20uploadSavSta:','Paused!','4207HwqpBr','persisted','Auto\x20save\x20','add','saveState','padStart','5604051EaJTro','onLine','innerWidth','FSSync','getItem','hidden','screenshot','screenSize','_dateState0','Cloud\x20upload\x20','listCheats','12tDgQwM','createElement','toString','.ss0','SDL2','59912897PyUTKT','textContent','Off','uId','1379628FcVDqQ','.gba','listGames','replace','loadState','.gbc','name','Cheat\x20uploaded\x20successfully:','_dateState','visibilityState','classList','.png','canvas','uploadSaveOrSaveState','fileSize','gameName'];a0_0x46c4=function(){return _0x476783;};return a0_0x46c4();}export async function setFastForwardMultiplier(_0x4e497a){const _0xb8f639=a0_0x339e91;Module[_0xb8f639(0x224)](_0x4e497a);}export function uploadCheats(_0x4d2324,_0x452094,_0x3747b6,_0x1707c0,_0x17aaea){const _0x3b1a0d=a0_0x339e91;Module[_0x3b1a0d(0x219)](_0x4d2324,()=>{const _0x5b29b4=_0x3b1a0d;Module['autoLoadCheats'](),setTimeout(()=>{const _0x411815=a0_0x4bba;Module[_0x411815(0x1ef)]();},0x1f4),_0x1707c0&&(localStorage[_0x5b29b4(0x215)](_0x452094+_0x5b29b4(0x21d),_0x3747b6),notiMessage('Cheat\x20Enabled!',0x5dc)),_0x17aaea['textContent']=localStorage['getItem'](_0x452094+_0x5b29b4(0x21d)||_0x5b29b4(0x1fe));});}