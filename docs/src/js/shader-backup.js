const a0_0x493691=a0_0xb887;(function(_0x27331f,_0x222be9){const _0x44e8be=a0_0xb887,_0x2bb070=_0x27331f();while(!![]){try{const _0x1f2ab1=-parseInt(_0x44e8be(0xc1))/0x1+-parseInt(_0x44e8be(0xd5))/0x2+parseInt(_0x44e8be(0xc3))/0x3+parseInt(_0x44e8be(0xd4))/0x4*(parseInt(_0x44e8be(0xa6))/0x5)+parseInt(_0x44e8be(0xb0))/0x6+-parseInt(_0x44e8be(0xce))/0x7*(-parseInt(_0x44e8be(0x99))/0x8)+-parseInt(_0x44e8be(0xd6))/0x9;if(_0x1f2ab1===_0x222be9)break;else _0x2bb070['push'](_0x2bb070['shift']());}catch(_0x3878bf){_0x2bb070['push'](_0x2bb070['shift']());}}}(a0_0x1d4b,0xda582));import*as a0_0xabd5ff from'./main.js';function a0_0xb887(_0x3e0ff1,_0x17a632){const _0x1d4bd7=a0_0x1d4b();return a0_0xb887=function(_0xb88780,_0x14e48e){_0xb88780=_0xb88780-0x8b;let _0x36f233=_0x1d4bd7[_0xb88780];return _0x36f233;},a0_0xb887(_0x3e0ff1,_0x17a632);}let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x493691(0x9f)](a0_0x493691(0xbe)),bufferCanvas=document[a0_0x493691(0x9f)](a0_0x493691(0x8f)),canvasContainer=document[a0_0x493691(0x9f)]('canvas-container'),imgShader=document[a0_0x493691(0x9f)](a0_0x493691(0xbd)),settingContainer=document[a0_0x493691(0xc7)](a0_0x493691(0x96)),messageContainer=document[a0_0x493691(0xc7)](a0_0x493691(0xa5)),stateTitle=document['querySelectorAll']('.stateTitle,\x20.stateDate');let imageDataObj=null;async function loadLUT64(){const _0x4eab43=a0_0x493691;systemType=gameName['slice'](-0x3);const _0x51ea5c=localStorage[_0x4eab43(0xde)](gameName+'_streng')||'4.0',_0x308246=(localStorage['getItem'](gameName+'_temperature')||'warm')[_0x4eab43(0xd0)]();if(!lut64||lut64Streng!==_0x51ea5c||lut64Profile!==_0x308246){const _0x4f3d0c=_0x4eab43(0xd7)+_0x308246+'_'+_0x51ea5c+_0x4eab43(0xcc);console[_0x4eab43(0xb1)](_0x4f3d0c);const _0x5ec62b=await fetch(_0x4f3d0c),_0x3bfa32=await _0x5ec62b[_0x4eab43(0x9c)]();lut64=new Uint8Array(_0x3bfa32),lut64Streng=_0x51ea5c,lut64Profile=_0x308246;}}async function loadShaderSource(_0x376e8c){const _0x5a1fd8=await fetch(_0x376e8c);return await _0x5a1fd8['text']();}function setupStyle(_0x50f6db){const _0x1ca879=a0_0x493691;clientWidth=document[_0x1ca879(0x9e)]['clientWidth'];const _0x4ef046=window['devicePixelRatio'];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x1ca879(0x9a)](clientWidth*_0x4ef046/gameWidth),localStorage[_0x1ca879(0xac)](_0x1ca879(0xb9),_0x1ca879(0xd1)+gameWidth*(integerScaling/_0x4ef046)+','+gameHeight*(integerScaling/_0x4ef046))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x1ca879(0x9a)](clientWidth*_0x4ef046/gameWidth),localStorage[_0x1ca879(0xac)](_0x1ca879(0xb9),_0x1ca879(0xd1)+gameWidth*(integerScaling/_0x4ef046)+','+gameHeight*(integerScaling/_0x4ef046)));if(_0x50f6db==='2d')bufferCanvas['width']=gameWidth,bufferCanvas[_0x1ca879(0xba)]=gameHeight,bufferCanvas[_0x1ca879(0xc4)][_0x1ca879(0xb7)]=''+integerScaling/_0x4ef046,bufferCanvas['style'][_0x1ca879(0xbc)]=_0x1ca879(0x93),canvasContainer[_0x1ca879(0xc4)]['width']=gameWidth*(integerScaling/_0x4ef046)+'px',canvasContainer[_0x1ca879(0xc4)][_0x1ca879(0xba)]=gameHeight*(integerScaling/_0x4ef046)+'px',textured[_0x1ca879(0xc4)][_0x1ca879(0xb3)]=gameWidth*(integerScaling/_0x4ef046)+'px',textured[_0x1ca879(0xc4)]['height']=gameHeight*(integerScaling/_0x4ef046)+'px',imgShader[_0x1ca879(0xc4)][_0x1ca879(0xe0)]=_0x1ca879(0xa0)+integerScaling/_0x4ef046/upscaleShader+')',settingContainer[_0x1ca879(0xd8)](function(_0x13d9ac){const _0x4ed455=_0x1ca879;_0x13d9ac[_0x4ed455(0xc4)][_0x4ed455(0xb3)]=gameWidth*(integerScaling/_0x4ef046)+'px',_0x13d9ac[_0x4ed455(0xc4)][_0x4ed455(0xba)]=gameHeight*(integerScaling/_0x4ef046)+'px';}),messageContainer[_0x1ca879(0xd8)](function(_0x13317f){const _0x414aa8=_0x1ca879;_0x13317f[_0x414aa8(0xc4)]['width']=gameWidth+'px',_0x13317f[_0x414aa8(0xc4)][_0x414aa8(0xba)]=gameHeight+'px',_0x13317f[_0x414aa8(0xc4)][_0x414aa8(0xb7)]=''+integerScaling/_0x4ef046;}),stateTitle['forEach'](function(_0x39c3e7){const _0x4b2487=_0x1ca879;_0x39c3e7[_0x4b2487(0xdf)][_0x4b2487(0x9b)](_0x4b2487(0xe6));});else _0x50f6db===_0x1ca879(0xe5)&&(bufferCanvas[_0x1ca879(0xb3)]=clientWidth*upscaleFactor,bufferCanvas[_0x1ca879(0xba)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x1ca879(0xc4)][_0x1ca879(0xb7)]=''+0x1/upscaleFactor,bufferCanvas['style'][_0x1ca879(0xbc)]='',canvasContainer[_0x1ca879(0xc4)][_0x1ca879(0xb3)]=clientWidth+'px',canvasContainer['style'][_0x1ca879(0xba)]=clientWidth*(gameHeight/gameWidth)+'px',textured['style'][_0x1ca879(0xb3)]=clientWidth+'px',textured[_0x1ca879(0xc4)]['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x1ca879(0xc4)]['transform']=_0x1ca879(0xa0)+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x2000d4){const _0x1d0de1=_0x1ca879;_0x2000d4[_0x1d0de1(0xc4)][_0x1d0de1(0xb3)]=clientWidth+'px',_0x2000d4[_0x1d0de1(0xc4)][_0x1d0de1(0xba)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x1ca879(0xd8)](function(_0x4aae95){const _0x6a3d39=_0x1ca879;_0x4aae95[_0x6a3d39(0xc4)][_0x6a3d39(0xb3)]=gameWidth+'px',_0x4aae95['style'][_0x6a3d39(0xba)]=gameHeight+'px',_0x4aae95[_0x6a3d39(0xc4)][_0x6a3d39(0xb7)]=''+clientWidth/gameWidth;}),stateTitle[_0x1ca879(0xd8)](function(_0x2c6184){const _0x27d77a=_0x1ca879;_0x2c6184[_0x27d77a(0xdf)]['add'](_0x27d77a(0xe6));}));imgShader[_0x1ca879(0xc4)][_0x1ca879(0xb3)]=gameWidth*upscaleShader+'px',imgShader[_0x1ca879(0xc4)][_0x1ca879(0xba)]=gameHeight*upscaleShader+'px',imgShader[_0x1ca879(0xc4)][_0x1ca879(0x8c)]=_0x1ca879(0xc0),imgShader[_0x1ca879(0xc4)][_0x1ca879(0xdc)](_0x1ca879(0xda),upscaleShader+'px\x20'+upscaleShader+'px');}function setupWebGL(){const _0x1c0658=a0_0x493691;gl=bufferCanvas[_0x1c0658(0xae)](_0x1c0658(0xe5));if(!gl)return console[_0x1c0658(0xd3)](_0x1c0658(0xa9)),null;gl['viewport'](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x1c0658(0xba)]);}function createShader(_0x32d8cb,_0x371818){const _0x2f631a=a0_0x493691,_0x270c1b=gl['createShader'](_0x32d8cb);gl['shaderSource'](_0x270c1b,_0x371818),gl['compileShader'](_0x270c1b);if(!gl[_0x2f631a(0xa4)](_0x270c1b,gl[_0x2f631a(0xb5)]))return console['error'](gl['getShaderInfoLog'](_0x270c1b)),gl[_0x2f631a(0xa1)](_0x270c1b),null;return _0x270c1b;}async function setupShaders(){const _0x178e45=a0_0x493691,_0xe8150a=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x5a3788=await loadShaderSource(_0x178e45(0xc9)),_0x285ae0=createShader(gl[_0x178e45(0xad)],_0xe8150a),_0x2398b5=createShader(gl[_0x178e45(0xa3)],_0x5a3788);return program=gl[_0x178e45(0xdd)](),gl[_0x178e45(0xdb)](program,_0x285ae0),gl[_0x178e45(0xdb)](program,_0x2398b5),gl['linkProgram'](program),gl[_0x178e45(0xca)](program),program;}function setupTexture(){const _0xdb2a6e=a0_0x493691;texture=gl[_0xdb2a6e(0xb2)](),gl['bindTexture'](gl['TEXTURE_2D'],texture),gl['texParameteri'](gl[_0xdb2a6e(0xcb)],gl[_0xdb2a6e(0xd9)],gl[_0xdb2a6e(0xd2)]),gl['texParameteri'](gl[_0xdb2a6e(0xcb)],gl[_0xdb2a6e(0xab)],gl['NEAREST']),gl['texParameteri'](gl[_0xdb2a6e(0xcb)],gl[_0xdb2a6e(0xcf)],gl[_0xdb2a6e(0x94)]),gl['texParameteri'](gl[_0xdb2a6e(0xcb)],gl[_0xdb2a6e(0x91)],gl[_0xdb2a6e(0x94)]),gl['uniform2f'](gl[_0xdb2a6e(0xe1)](program,_0xdb2a6e(0x95)),gameWidth,gameHeight),gl[_0xdb2a6e(0x8d)](gl[_0xdb2a6e(0xe1)](program,_0xdb2a6e(0xc2)),gl[_0xdb2a6e(0x8f)][_0xdb2a6e(0xb3)],gl['canvas'][_0xdb2a6e(0xba)]),gl[_0xdb2a6e(0xaf)](gl['getUniformLocation'](program,'smooth_width'),gameWidth/gl['canvas'][_0xdb2a6e(0xb3)]),gl['uniform1f'](gl['getUniformLocation'](program,'smooth_height'),gameHeight/gl[_0xdb2a6e(0x8f)][_0xdb2a6e(0xba)]);}function setupBuffers(){const _0x593443=a0_0x493691,_0x595130=gl[_0x593443(0x90)]();gl[_0x593443(0xc6)](gl[_0x593443(0x8b)],_0x595130),gl[_0x593443(0x98)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x593443(0xa7)]);const _0x536c10=gl[_0x593443(0x9d)](program,'position');gl['enableVertexAttribArray'](_0x536c10),gl[_0x593443(0x92)](_0x536c10,0x2,gl['FLOAT'],![],0x0,0x0);const _0x3bf233=gl['createBuffer']();gl[_0x593443(0xc6)](gl[_0x593443(0x8b)],_0x3bf233),gl[_0x593443(0x98)](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x593443(0xa7)]);const _0x1daa47=gl[_0x593443(0x9d)](program,_0x593443(0x8e));gl['enableVertexAttribArray'](_0x1daa47),gl[_0x593443(0x92)](_0x1daa47,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x64d2a8){const _0x1a0a64=a0_0x493691,_0x4a5e55=a0_0xabd5ff[_0x1a0a64(0xb4)]();if(!_0x4a5e55)return;await loadLUT64();const _0xaecc1b=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x95ff5b=0x0;_0x95ff5b<gameHeight;_0x95ff5b++){for(let _0x2ae563=0x0;_0x2ae563<gameWidth;_0x2ae563++){const _0x492369=_0x95ff5b*gameStride+_0x2ae563,_0x43f737=(_0x95ff5b*gameWidth+_0x2ae563)*0x4,_0x317d8a=_0x4a5e55[_0x492369],_0x537a7b=(_0x317d8a&0xff)>>0x2,_0x3235ea=(_0x317d8a>>0x8&0xff)>>0x2,_0x19777d=(_0x317d8a>>0x10&0xff)>>0x2,_0x5877b6=(_0x537a7b*0x40*0x40+_0x3235ea*0x40+_0x19777d)*0x3;_0xaecc1b[_0x43f737]=lut64[_0x5877b6],_0xaecc1b[_0x43f737+0x1]=lut64[_0x5877b6+0x1],_0xaecc1b[_0x43f737+0x2]=lut64[_0x5877b6+0x2],_0xaecc1b[_0x43f737+0x3]=0xff;}}if(_0x64d2a8===_0x1a0a64(0xe5))gl['bindTexture'](gl['TEXTURE_2D'],texture),gl[_0x1a0a64(0x97)](gl[_0x1a0a64(0xcb)],0x0,gl[_0x1a0a64(0xcd)],gameWidth,gameHeight,0x0,gl[_0x1a0a64(0xcd)],gl[_0x1a0a64(0xe4)],_0xaecc1b),gl[_0x1a0a64(0xc8)](gl[_0x1a0a64(0xa2)]),gl[_0x1a0a64(0xaa)](gl['TRIANGLE_STRIP'],0x0,0x4);else _0x64d2a8==='2d'&&(!ctx2d&&(ctx2d=bufferCanvas[_0x1a0a64(0xae)]('2d',{'alpha':![]}),ctx2d['imageSmoothingEnabled']=![]),!imageDataObj?imageDataObj=new ImageData(gameWidth,gameHeight):imageDataObj[_0x1a0a64(0xb8)][_0x1a0a64(0xa8)](_0xaecc1b),createImageBitmap(imageDataObj)[_0x1a0a64(0xb6)](_0x13fc64=>{const _0x4a50ff=_0x1a0a64;ctx2d[_0x4a50ff(0xe3)](0x0,0x0,bufferCanvas[_0x4a50ff(0xb3)],bufferCanvas['height']),ctx2d[_0x4a50ff(0xbf)](_0x13fc64,0x0,0x0),_0x13fc64[_0x4a50ff(0xbb)]();}));requestAnimationFrame(()=>renderPixel(_0x64d2a8));}function a0_0x1d4b(){const _0x311059=['UNSIGNED_BYTE','webgl2','fefs','ARRAY_BUFFER','transformOrigin','uniform2f','texcoord','canvas','createBuffer','TEXTURE_WRAP_T','vertexAttribPointer','crisp-edges','CLAMP_TO_EDGE','game_size','.setting-container','texImage2D','bufferData','8xLWkuO','floor','remove','arrayBuffer','getAttribLocation','documentElement','getElementById','scale(','deleteShader','COLOR_BUFFER_BIT','FRAGMENT_SHADER','getShaderParameter','.message-container','65ndCeUl','STATIC_DRAW','set','WebGL2\x20not\x20supported','drawArrays','TEXTURE_MAG_FILTER','setItem','VERTEX_SHADER','getContext','uniform1f','6351774QKlxhK','log','createTexture','width','getPixelData','COMPILE_STATUS','then','zoom','data','screenSize','height','close','imageRendering','img-shader','textured','drawImage','top\x20center','491368OoNAWv','render_size','1334265AZSsIi','style','DOMContentLoaded','bindBuffer','querySelectorAll','clear','./src/shaders/fragmentShader.glsl','useProgram','TEXTURE_2D','.bin','RGBA','12249433jjfZbJ','TEXTURE_WRAP_S','toLowerCase','0,0,','NEAREST','error','519804UgjrUI','573094EFtgQJ','29433717LsHmML','./src/lut/lut64_','forEach','TEXTURE_MIN_FILTER','--bg-size','attachShader','setProperty','createProgram','getItem','classList','transform','getUniformLocation','addEventListener','clearRect'];a0_0x1d4b=function(){return _0x311059;};return a0_0x1d4b();}export async function switchRenderMode(_0x4bd0be){const _0x320d44=a0_0x493691;systemType=gameName['slice'](-0x3);if(_0x4bd0be==='2d')setupStyle('2d'),renderPixel('2d');else _0x4bd0be==='webgl2'&&(setupStyle(_0x320d44(0xe5)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x320d44(0xe5)));}document[a0_0x493691(0xe2)](a0_0x493691(0xc5),function(){});