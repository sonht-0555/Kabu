(function(_0x4c6b5a,_0x1f16e3){const _0x1ff42c=a0_0x32c7,_0x871ccb=_0x4c6b5a();while(!![]){try{const _0x10fa10=-parseInt(_0x1ff42c(0x1bb))/0x1*(parseInt(_0x1ff42c(0x1b9))/0x2)+-parseInt(_0x1ff42c(0x1cd))/0x3+parseInt(_0x1ff42c(0x1b7))/0x4+parseInt(_0x1ff42c(0x1be))/0x5*(-parseInt(_0x1ff42c(0x1ce))/0x6)+-parseInt(_0x1ff42c(0x1a1))/0x7+parseInt(_0x1ff42c(0x1b2))/0x8+parseInt(_0x1ff42c(0x1bf))/0x9;if(_0x10fa10===_0x1f16e3)break;else _0x871ccb['push'](_0x871ccb['shift']());}catch(_0x3ff970){_0x871ccb['push'](_0x871ccb['shift']());}}}(a0_0x701a,0x3ca3b));import*as a0_0x38c531 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x5964bb=a0_0x32c7;systemType=gameName[_0x5964bb(0x1c9)](-0x3);const _0x4edcad=(localStorage['getItem'](gameName+_0x5964bb(0x1ba))||_0x5964bb(0x1ca))[_0x5964bb(0x1a2)]();if(!lut64||lut64Profile!==_0x4edcad){const _0x539310='./src/lut/lut64_'+_0x4edcad+_0x5964bb(0x1a4);console['log'](_0x539310);const _0x232e31=await fetch(_0x539310),_0x4fe0be=await _0x232e31[_0x5964bb(0x1d9)]();lut64=new Uint8Array(_0x4fe0be),lut64Profile=_0x4edcad;}}function a0_0x701a(){const _0x141245=['slice','none','texParameteri','VERTEX_SHADER','560988bdUggz','23658MMxMRd','render_size','createProgram','width','drawArrays','CLAMP_TO_EDGE','FLOAT','bindTexture','smooth_height','webgl_full','imageSmoothingEnabled','arrayBuffer','data','shaderSource','getAttribLocation','TRIANGLE_STRIP','height','position','bindBuffer','createShader','2182740BoWVsq','toLowerCase','canvas','_4.0.bin','enableVertexAttribArray','vertexAttribPointer','attachShader','createBuffer','ARRAY_BUFFER','UNSIGNED_BYTE','smooth_width','TEXTURE_MAG_FILTER','TEXTURE_WRAP_S','getUniformLocation','uniform1f','low-power','clear','2144184ovvcwK','compileShader','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','STATIC_DRAW','clearRect','284276WsmWLk','uniform2f','837636UieVMO','_temperature','1BkJjIT','NEAREST','texcoord','435bVYkUh','10529658xhFPUv','getContext','useProgram','webgl','texImage2D','FRAGMENT_SHADER','bufferData','game_size','TEXTURE_2D','viewport'];a0_0x701a=function(){return _0x141245;};return a0_0x701a();}function setupWebGL_Shader(_0x2df750){const _0x498e2b=a0_0x32c7;gl=bufferCanvas[_0x498e2b(0x1c0)]('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x498e2b(0x1b0)}),gl[_0x498e2b(0x1c8)](0x0,0x0,bufferCanvas[_0x498e2b(0x1d1)],bufferCanvas[_0x498e2b(0x19d)]);function _0x5e9f33(_0x4e150e,_0x29afdf){const _0x426a52=_0x498e2b,_0xc52ace=gl[_0x426a52(0x1a0)](_0x4e150e);return gl[_0x426a52(0x19a)](_0xc52ace,_0x29afdf),gl[_0x426a52(0x1b3)](_0xc52ace),_0xc52ace;}vs=_0x498e2b(0x1b4);if(_0x2df750===_0x498e2b(0x1c2))fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}';else _0x2df750===_0x498e2b(0x1d7)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x220322=_0x5e9f33(gl[_0x498e2b(0x1cc)],vs),_0x102dd9=_0x5e9f33(gl[_0x498e2b(0x1c4)],fs);return program=gl[_0x498e2b(0x1d0)](),gl[_0x498e2b(0x1a7)](program,_0x220322),gl['attachShader'](program,_0x102dd9),gl['linkProgram'](program),gl[_0x498e2b(0x1c1)](program),program;}function setupTexture_Buffer(_0x57983c){const _0x3ef594=a0_0x32c7;texture=gl['createTexture'](),gl[_0x3ef594(0x1d5)](gl[_0x3ef594(0x1c7)],texture),gl[_0x3ef594(0x1cb)](gl[_0x3ef594(0x1c7)],gl['TEXTURE_MIN_FILTER'],gl['NEAREST']),gl[_0x3ef594(0x1cb)](gl[_0x3ef594(0x1c7)],gl[_0x3ef594(0x1ac)],gl[_0x3ef594(0x1bc)]),gl[_0x3ef594(0x1cb)](gl[_0x3ef594(0x1c7)],gl[_0x3ef594(0x1ad)],gl['CLAMP_TO_EDGE']),gl[_0x3ef594(0x1cb)](gl[_0x3ef594(0x1c7)],gl['TEXTURE_WRAP_T'],gl[_0x3ef594(0x1d3)]);_0x57983c==='webgl_full'&&(gl['uniform2f'](gl[_0x3ef594(0x1ae)](program,_0x3ef594(0x1c6)),gameWidth,gameHeight),gl[_0x3ef594(0x1b8)](gl['getUniformLocation'](program,_0x3ef594(0x1cf)),gl[_0x3ef594(0x1a3)][_0x3ef594(0x1d1)],gl[_0x3ef594(0x1a3)][_0x3ef594(0x19d)]),gl[_0x3ef594(0x1af)](gl[_0x3ef594(0x1ae)](program,_0x3ef594(0x1ab)),gameWidth/gl['canvas'][_0x3ef594(0x1d1)]),gl[_0x3ef594(0x1af)](gl['getUniformLocation'](program,_0x3ef594(0x1d6)),gameHeight/gl['canvas']['height']));const _0x329907=gl[_0x3ef594(0x1a8)]();gl[_0x3ef594(0x19f)](gl[_0x3ef594(0x1a9)],_0x329907),gl[_0x3ef594(0x1c5)](gl[_0x3ef594(0x1a9)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x3ef594(0x1b5)]),gl[_0x3ef594(0x1a6)](gl[_0x3ef594(0x19b)](program,_0x3ef594(0x19e)),0x2,gl[_0x3ef594(0x1d4)],![],0x0,0x0),gl[_0x3ef594(0x1a5)](gl['getAttribLocation'](program,_0x3ef594(0x19e)));const _0x31e5ff=gl[_0x3ef594(0x1a8)]();gl[_0x3ef594(0x19f)](gl[_0x3ef594(0x1a9)],_0x31e5ff),gl[_0x3ef594(0x1c5)](gl[_0x3ef594(0x1a9)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x3ef594(0x1b5)]),gl[_0x3ef594(0x1a6)](gl[_0x3ef594(0x19b)](program,_0x3ef594(0x1bd)),0x2,gl[_0x3ef594(0x1d4)],![],0x0,0x0),gl[_0x3ef594(0x1a5)](gl[_0x3ef594(0x19b)](program,_0x3ef594(0x1bd)));}function a0_0x32c7(_0x57e3f8,_0x90b39f){const _0x701a=a0_0x701a();return a0_0x32c7=function(_0x32c724,_0x541520){_0x32c724=_0x32c724-0x19a;let _0x47c964=_0x701a[_0x32c724];return _0x47c964;},a0_0x32c7(_0x57e3f8,_0x90b39f);}function setup2DContext(){const _0x4a7421=a0_0x32c7;ctx2d=bufferCanvas[_0x4a7421(0x1c0)]('2d'),ctx2d[_0x4a7421(0x1d8)]=![];}async function renderPixel(_0x514eca){const _0x2e17c0=a0_0x32c7,_0x4f1bab=a0_0x38c531['getPixelData']();if(!_0x4f1bab)return;await loadLUT64();const _0x54397b=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x1939f7=0x0;_0x1939f7<gameHeight;_0x1939f7++){for(let _0x3f0c6c=0x0;_0x3f0c6c<gameWidth;_0x3f0c6c++){const _0x5774c2=_0x1939f7*gameStride+_0x3f0c6c,_0x471158=(_0x1939f7*gameWidth+_0x3f0c6c)*0x4,_0x393511=_0x4f1bab[_0x5774c2];if(lut64Profile==='none')_0x54397b[_0x471158]=_0x393511&0xff,_0x54397b[_0x471158+0x1]=_0x393511>>0x8&0xff,_0x54397b[_0x471158+0x2]=_0x393511>>0x10&0xff,_0x54397b[_0x471158+0x3]=0xff;else{const _0x23a154=(_0x393511&0xff)>>0x2,_0x318bbc=(_0x393511>>0x8&0xff)>>0x2,_0x2874c8=(_0x393511>>0x10&0xff)>>0x2,_0x5bea40=(_0x23a154*0x40*0x40+_0x318bbc*0x40+_0x2874c8)*0x3;_0x54397b[_0x471158]=lut64[_0x5bea40],_0x54397b[_0x471158+0x1]=lut64[_0x5bea40+0x1],_0x54397b[_0x471158+0x2]=lut64[_0x5bea40+0x2],_0x54397b[_0x471158+0x3]=0xff;}}}if(_0x514eca===_0x2e17c0(0x1c2))gl[_0x2e17c0(0x1c3)](gl['TEXTURE_2D'],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x2e17c0(0x1aa)],_0x54397b),gl[_0x2e17c0(0x1b1)](gl['COLOR_BUFFER_BIT']),gl[_0x2e17c0(0x1d2)](gl[_0x2e17c0(0x19c)],0x0,0x4);else _0x514eca==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x54397b,gameWidth,gameHeight):imageDataObj[_0x2e17c0(0x1da)]['set'](_0x54397b),ctx2d[_0x2e17c0(0x1b6)](0x0,0x0,bufferCanvas[_0x2e17c0(0x1d1)],bufferCanvas[_0x2e17c0(0x19d)]),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x514eca));}export async function switchRenderMode(_0x4e5d70){const _0x3257b0=a0_0x32c7;systemType=gameName[_0x3257b0(0x1c9)](-0x3);if(_0x4e5d70==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x4e5d70===_0x3257b0(0x1c2))setupStyle('2d'),setupWebGL_Shader(_0x3257b0(0x1c2)),setupTexture_Buffer(_0x3257b0(0x1c2)),renderPixel(_0x3257b0(0x1c2));else _0x4e5d70===_0x3257b0(0x1d7)&&(setupStyle('webgl_full'),setupWebGL_Shader(_0x3257b0(0x1d7)),setupTexture_Buffer(_0x3257b0(0x1d7)),renderPixel('webgl'));}}