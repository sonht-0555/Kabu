const a0_0x5107ed=a0_0x25a0;(function(_0x179091,_0x2e8e54){const _0x4cb057=a0_0x25a0,_0x5586c8=_0x179091();while(!![]){try{const _0x1593f7=parseInt(_0x4cb057(0x198))/0x1*(parseInt(_0x4cb057(0x190))/0x2)+parseInt(_0x4cb057(0x1d3))/0x3*(-parseInt(_0x4cb057(0x1af))/0x4)+parseInt(_0x4cb057(0x17f))/0x5*(parseInt(_0x4cb057(0x19d))/0x6)+-parseInt(_0x4cb057(0x1ac))/0x7*(parseInt(_0x4cb057(0x1bd))/0x8)+parseInt(_0x4cb057(0x1c3))/0x9+-parseInt(_0x4cb057(0x1b0))/0xa*(-parseInt(_0x4cb057(0x1d0))/0xb)+-parseInt(_0x4cb057(0x1b5))/0xc;if(_0x1593f7===_0x2e8e54)break;else _0x5586c8['push'](_0x5586c8['shift']());}catch(_0x3011a2){_0x5586c8['push'](_0x5586c8['shift']());}}}(a0_0x2c2d,0x86372));import*as a0_0x26d569 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document['getElementById']('textured'),bufferCanvas=document[a0_0x5107ed(0x1b3)](a0_0x5107ed(0x1cc)),canvasContainer=document[a0_0x5107ed(0x1b3)](a0_0x5107ed(0x197)),imgShader=document[a0_0x5107ed(0x1b3)](a0_0x5107ed(0x180)),settingContainer=document[a0_0x5107ed(0x1c9)](a0_0x5107ed(0x1cb)),messageContainer=document[a0_0x5107ed(0x1c9)]('.message-container'),stateTitle=document['querySelectorAll'](a0_0x5107ed(0x1dd));async function loadLUT64(){const _0x5e8886=a0_0x5107ed;systemType=gameName[_0x5e8886(0x1d4)](-0x3);const _0x366b18=localStorage['getItem'](gameName+'_streng')||'4.0',_0x194607=(localStorage[_0x5e8886(0x17b)](gameName+_0x5e8886(0x1dc))||'warm')['toLowerCase']();if(!lut64||lut64Streng!==_0x366b18||lut64Profile!==_0x194607){const _0x59c4c7=_0x5e8886(0x1b9)+_0x194607+'_'+_0x366b18+'.bin';console[_0x5e8886(0x1d6)](_0x59c4c7);const _0x32660a=await fetch(_0x59c4c7),_0x3448f2=await _0x32660a[_0x5e8886(0x17d)]();lut64=new Uint8Array(_0x3448f2),lut64Streng=_0x366b18,lut64Profile=_0x194607;}}async function loadShaderSource(_0x357148){const _0x1bded1=a0_0x5107ed,_0x2b3f56=await fetch(_0x357148);return await _0x2b3f56[_0x1bded1(0x181)]();}function setupStyle(_0x428ab1){const _0x269b9e=a0_0x5107ed;clientWidth=document[_0x269b9e(0x1c7)][_0x269b9e(0x18d)];const _0x50bb10=window[_0x269b9e(0x1ad)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x269b9e(0x177)](clientWidth*_0x50bb10/gameWidth),localStorage[_0x269b9e(0x1da)](_0x269b9e(0x19b),_0x269b9e(0x185)+gameWidth*(integerScaling/_0x50bb10)+','+gameHeight*(integerScaling/_0x50bb10))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math['floor'](clientWidth*_0x50bb10/gameWidth),localStorage[_0x269b9e(0x1da)](_0x269b9e(0x19b),_0x269b9e(0x185)+gameWidth*(integerScaling/_0x50bb10)+','+gameHeight*(integerScaling/_0x50bb10)));if(_0x428ab1==='2d')bufferCanvas[_0x269b9e(0x1a0)]=gameWidth,bufferCanvas[_0x269b9e(0x1d1)]=gameHeight,bufferCanvas[_0x269b9e(0x1a5)][_0x269b9e(0x187)]=''+integerScaling/_0x50bb10,bufferCanvas['style'][_0x269b9e(0x193)]='crisp-edges',canvasContainer[_0x269b9e(0x1a5)][_0x269b9e(0x1a0)]=gameWidth*(integerScaling/_0x50bb10)+'px',canvasContainer[_0x269b9e(0x1a5)][_0x269b9e(0x1d1)]=gameHeight*(integerScaling/_0x50bb10)+'px',textured[_0x269b9e(0x1a5)][_0x269b9e(0x1a0)]=gameWidth*(integerScaling/_0x50bb10)+'px',textured[_0x269b9e(0x1a5)]['height']=gameHeight*(integerScaling/_0x50bb10)+'px',imgShader['style'][_0x269b9e(0x1be)]=_0x269b9e(0x18f)+integerScaling/_0x50bb10/upscaleShader+')',settingContainer[_0x269b9e(0x1c2)](function(_0x3640ed){_0x3640ed['style']['width']=gameWidth*(integerScaling/_0x50bb10)+'px',_0x3640ed['style']['height']=gameHeight*(integerScaling/_0x50bb10)+'px';}),messageContainer[_0x269b9e(0x1c2)](function(_0x703002){const _0x346acb=_0x269b9e;_0x703002[_0x346acb(0x1a5)]['width']=gameWidth+'px',_0x703002[_0x346acb(0x1a5)][_0x346acb(0x1d1)]=gameHeight+'px',_0x703002[_0x346acb(0x1a5)]['zoom']=''+integerScaling/_0x50bb10;}),stateTitle[_0x269b9e(0x1c2)](function(_0xdcd633){const _0x11ee9b=_0x269b9e;_0xdcd633[_0x11ee9b(0x1a7)][_0x11ee9b(0x18b)](_0x11ee9b(0x1a1));});else _0x428ab1==='webgl2'&&(bufferCanvas['width']=clientWidth*upscaleFactor,bufferCanvas[_0x269b9e(0x1d1)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style']['zoom']=''+0x1/upscaleFactor,bufferCanvas[_0x269b9e(0x1a5)][_0x269b9e(0x193)]='',canvasContainer[_0x269b9e(0x1a5)][_0x269b9e(0x1a0)]=clientWidth+'px',canvasContainer[_0x269b9e(0x1a5)][_0x269b9e(0x1d1)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x269b9e(0x1a5)][_0x269b9e(0x1a0)]=clientWidth+'px',textured[_0x269b9e(0x1a5)][_0x269b9e(0x1d1)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x269b9e(0x1a5)][_0x269b9e(0x1be)]=_0x269b9e(0x18f)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x269b9e(0x1c2)](function(_0x1eb6ac){const _0x35e4e1=_0x269b9e;_0x1eb6ac['style'][_0x35e4e1(0x1a0)]=clientWidth+'px',_0x1eb6ac[_0x35e4e1(0x1a5)][_0x35e4e1(0x1d1)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x269b9e(0x1c2)](function(_0x191ff9){const _0x3504d2=_0x269b9e;_0x191ff9[_0x3504d2(0x1a5)]['width']=gameWidth+'px',_0x191ff9['style'][_0x3504d2(0x1d1)]=gameHeight+'px',_0x191ff9['style'][_0x3504d2(0x187)]=''+clientWidth/gameWidth;}),stateTitle[_0x269b9e(0x1c2)](function(_0x915b35){const _0x48fcc3=_0x269b9e;_0x915b35[_0x48fcc3(0x1a7)][_0x48fcc3(0x1d9)]('fefs');}));imgShader[_0x269b9e(0x1a5)]['width']=gameWidth*upscaleShader+'px',imgShader['style'][_0x269b9e(0x1d1)]=gameHeight*upscaleShader+'px',imgShader[_0x269b9e(0x1a5)][_0x269b9e(0x1ce)]=_0x269b9e(0x178),imgShader[_0x269b9e(0x1a5)][_0x269b9e(0x1c0)](_0x269b9e(0x1a2),upscaleShader+_0x269b9e(0x1d8)+upscaleShader+'px');}function setupWebGL(){const _0x21ba64=a0_0x5107ed;gl=bufferCanvas[_0x21ba64(0x195)]('webgl2');if(!gl)return console[_0x21ba64(0x1c5)]('WebGL2\x20not\x20supported'),null;gl[_0x21ba64(0x1ca)](0x0,0x0,bufferCanvas['width'],bufferCanvas['height']);}function createShader(_0x3226b6,_0x48e398){const _0x394198=a0_0x5107ed,_0x10efe6=gl[_0x394198(0x19a)](_0x3226b6);gl[_0x394198(0x199)](_0x10efe6,_0x48e398),gl[_0x394198(0x1b8)](_0x10efe6);if(!gl[_0x394198(0x1c4)](_0x10efe6,gl[_0x394198(0x1c8)]))return console[_0x394198(0x1c5)](gl[_0x394198(0x183)](_0x10efe6)),gl['deleteShader'](_0x10efe6),null;return _0x10efe6;}async function setupShaders(){const _0x551931=a0_0x5107ed,_0x158341=await loadShaderSource(_0x551931(0x182)),_0x279864=await loadShaderSource(_0x551931(0x1ba)),_0x354a20=createShader(gl['VERTEX_SHADER'],_0x158341),_0x254bf=createShader(gl[_0x551931(0x196)],_0x279864);return program=gl[_0x551931(0x1b4)](),gl['attachShader'](program,_0x354a20),gl[_0x551931(0x1b2)](program,_0x254bf),gl['linkProgram'](program),gl[_0x551931(0x176)](program),program;}function setupTexture(){const _0x1dce71=a0_0x5107ed;texture=gl[_0x1dce71(0x191)](),gl['bindTexture'](gl[_0x1dce71(0x1d2)],texture),gl[_0x1dce71(0x175)](gl[_0x1dce71(0x1d2)],gl[_0x1dce71(0x19f)],gl['NEAREST']),gl[_0x1dce71(0x175)](gl['TEXTURE_2D'],gl[_0x1dce71(0x184)],gl[_0x1dce71(0x1a8)]),gl['texParameteri'](gl[_0x1dce71(0x1d2)],gl[_0x1dce71(0x192)],gl[_0x1dce71(0x17c)]),gl['texParameteri'](gl['TEXTURE_2D'],gl[_0x1dce71(0x194)],gl[_0x1dce71(0x17c)]),gl['uniform2f'](gl[_0x1dce71(0x1db)](program,'game_size'),gameWidth,gameHeight),gl[_0x1dce71(0x1b1)](gl['getUniformLocation'](program,_0x1dce71(0x186)),gl[_0x1dce71(0x1cc)][_0x1dce71(0x1a0)],gl[_0x1dce71(0x1cc)]['height']),gl['uniform1f'](gl[_0x1dce71(0x1db)](program,'smooth_width'),gameWidth/gl[_0x1dce71(0x1cc)][_0x1dce71(0x1a0)]),gl[_0x1dce71(0x189)](gl[_0x1dce71(0x1db)](program,'smooth_height'),gameHeight/gl['canvas'][_0x1dce71(0x1d1)]);}function setupBuffers(){const _0x456288=a0_0x5107ed,_0xd46f19=gl['createBuffer']();gl[_0x456288(0x1bb)](gl[_0x456288(0x1d7)],_0xd46f19),gl[_0x456288(0x17a)](gl[_0x456288(0x1d7)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x456288(0x1b6)]);const _0x3eb90e=gl[_0x456288(0x18a)](program,_0x456288(0x18c));gl['enableVertexAttribArray'](_0x3eb90e),gl[_0x456288(0x1d5)](_0x3eb90e,0x2,gl[_0x456288(0x1cf)],![],0x0,0x0);const _0x10c874=gl[_0x456288(0x188)]();gl[_0x456288(0x1bb)](gl['ARRAY_BUFFER'],_0x10c874),gl[_0x456288(0x17a)](gl[_0x456288(0x1d7)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x456288(0x1b6)]);const _0x182907=gl['getAttribLocation'](program,_0x456288(0x17e));gl['enableVertexAttribArray'](_0x182907),gl[_0x456288(0x1d5)](_0x182907,0x2,gl[_0x456288(0x1cf)],![],0x0,0x0);}function a0_0x2c2d(){const _0x51c876=['onmessage','7AttXtB','devicePixelRatio','getPixelData','59088DPiXmK','30tyiKDe','uniform2f','attachShader','getElementById','createProgram','6144840RMnynG','STATIC_DRAW','UNSIGNED_BYTE','compileShader','./src/lut/lut64_','./src/shaders/fragmentShader.glsl','bindBuffer','RGBA','623312qPlvFK','transform','bindTexture','setProperty','drawImage','forEach','2690127CxKbSf','getShaderParameter','error','webgl2','documentElement','COMPILE_STATUS','querySelectorAll','viewport','.setting-container','canvas','COLOR_BUFFER_BIT','transformOrigin','FLOAT','1286439yTkHdQ','height','TEXTURE_2D','120BMVvHP','slice','vertexAttribPointer','log','ARRAY_BUFFER','px\x20','add','setItem','getUniformLocation','_temperature','.stateTitle,\x20.stateDate','texParameteri','useProgram','floor','top\x20center','TRIANGLE_STRIP','bufferData','getItem','CLAMP_TO_EDGE','arrayBuffer','texcoord','105815ZXCMuQ','img-shader','text','./src/shaders/vertexShader.glsl','getShaderInfoLog','TEXTURE_MAG_FILTER','0,0,','render_size','zoom','createBuffer','uniform1f','getAttribLocation','remove','position','clientWidth','clear','scale(','454uWTwdy','createTexture','TEXTURE_WRAP_S','imageRendering','TEXTURE_WRAP_T','getContext','FRAGMENT_SHADER','canvas-container','2524XSpRDo','shaderSource','createShader','screenSize','postMessage','144aOeFkD','onerror','TEXTURE_MIN_FILTER','width','fefs','--bg-size','DOMContentLoaded','data','style','message','classList','NEAREST','./src/js/worker.js','then'];a0_0x2c2d=function(){return _0x51c876;};return a0_0x2c2d();}async function renderPixel(_0x403fba){const _0x3a1586=a0_0x5107ed,_0x591450=a0_0x26d569[_0x3a1586(0x1ae)]();if(!_0x591450)return;await loadLUT64();const _0x4d2c99=new Worker(_0x3a1586(0x1a9));_0x4d2c99[_0x3a1586(0x1ab)]=function(_0x7fbcb4){const _0x23b788=_0x3a1586,_0x4f5a50=_0x7fbcb4[_0x23b788(0x1a4)];if(_0x403fba===_0x23b788(0x1c6))gl[_0x23b788(0x1bf)](gl[_0x23b788(0x1d2)],texture),gl['texImage2D'](gl[_0x23b788(0x1d2)],0x0,gl[_0x23b788(0x1bc)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x23b788(0x1b7)],_0x4f5a50),gl[_0x23b788(0x18e)](gl[_0x23b788(0x1cd)]),gl['drawArrays'](gl[_0x23b788(0x179)],0x0,0x4);else{if(_0x403fba==='2d'){ctx2d=bufferCanvas[_0x23b788(0x195)]('2d'),ctx2d['imageSmoothingEnabled']=![];const _0x12e35c=new ImageData(_0x4f5a50,gameWidth,gameHeight);createImageBitmap(_0x12e35c)[_0x23b788(0x1aa)](_0x368714=>{const _0x5db7f1=_0x23b788;ctx2d['clearRect'](0x0,0x0,bufferCanvas[_0x5db7f1(0x1a0)],bufferCanvas[_0x5db7f1(0x1d1)]),ctx2d[_0x5db7f1(0x1c1)](_0x368714,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x403fba));},_0x4d2c99[_0x3a1586(0x19e)]=function(_0x59538f){const _0x5e6e5d=_0x3a1586;console[_0x5e6e5d(0x1c5)]('Lỗi\x20trong\x20Worker:',_0x59538f[_0x5e6e5d(0x1a6)]);},_0x4d2c99[_0x3a1586(0x19c)]({'pixelData':_0x591450,'lut64':lut64,'gameWidth':gameWidth,'gameHeight':gameHeight,'gameStride':gameStride},[_0x591450['buffer'],lut64['buffer']]);}export async function switchRenderMode(_0x3b5302){const _0x44b670=a0_0x5107ed;systemType=gameName[_0x44b670(0x1d4)](-0x3);if(_0x3b5302==='2d')setupStyle('2d'),renderPixel('2d');else _0x3b5302===_0x44b670(0x1c6)&&(setupStyle(_0x44b670(0x1c6)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x44b670(0x1c6)));}function a0_0x25a0(_0x137252,_0x5c768c){const _0x2c2d56=a0_0x2c2d();return a0_0x25a0=function(_0x25a00c,_0x2d44a8){_0x25a00c=_0x25a00c-0x175;let _0x38b8fb=_0x2c2d56[_0x25a00c];return _0x38b8fb;},a0_0x25a0(_0x137252,_0x5c768c);}document['addEventListener'](a0_0x5107ed(0x1a3),function(){});