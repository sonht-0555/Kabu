(function(_0x3e69ea,_0xe9cc14){const _0x2f9739=a0_0x3e31,_0x265492=_0x3e69ea();while(!![]){try{const _0x3f4173=parseInt(_0x2f9739(0x10f))/0x1*(parseInt(_0x2f9739(0x107))/0x2)+-parseInt(_0x2f9739(0x120))/0x3+-parseInt(_0x2f9739(0x128))/0x4+-parseInt(_0x2f9739(0x11f))/0x5*(parseInt(_0x2f9739(0x105))/0x6)+parseInt(_0x2f9739(0x108))/0x7*(-parseInt(_0x2f9739(0x129))/0x8)+parseInt(_0x2f9739(0xf2))/0x9+-parseInt(_0x2f9739(0x112))/0xa*(-parseInt(_0x2f9739(0x10e))/0xb);if(_0x3f4173===_0xe9cc14)break;else _0x265492['push'](_0x265492['shift']());}catch(_0x14ab75){_0x265492['push'](_0x265492['shift']());}}}(a0_0x171b,0xda338));import*as a0_0xb8f2e from'./main.js';function a0_0x171b(){const _0x208a78=['getAttribLocation','VERTEX_SHADER','FLOAT','33104126khOeVC','18313hLOTLK','createBuffer','_streng','10NDWQMA','shaderSource','getUniformLocation','width','createProgram','getContext','drawImage','createShader','createTexture','game_size','uniform1f','COLOR_BUFFER_BIT','slice','99095cnwiJv','4306287LShRIH','attachShader','UNSIGNED_BYTE','RGBA','low-power','clear','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','TEXTURE_2D','4498256qvpjyq','37424mZphDL','4.0','NEAREST','texcoord','imageSmoothingEnabled','log','then','STATIC_DRAW','uniform2f','getItem','viewport','bufferData','3853980CmwyHH','bindBuffer','CLAMP_TO_EDGE','clearRect','getPixelData','TRIANGLE_STRIP','webgl_full','height','FRAGMENT_SHADER','canvas','enableVertexAttribArray','render_size','TEXTURE_MIN_FILTER','webgl','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','arrayBuffer','texParameteri','linkProgram','ARRAY_BUFFER','24nOJPTX','useProgram','38UTRXgq','378fBWokP','vertexAttribPointer','position'];a0_0x171b=function(){return _0x208a78;};return a0_0x171b();}let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x2eea80=a0_0x3e31;systemType=gameName['slice'](-0x3);const _0x2b38f5=localStorage[_0x2eea80(0x132)](gameName+_0x2eea80(0x111))||_0x2eea80(0x12a),_0x38e204=(localStorage['getItem'](gameName+'_temperature')||'warm')['toLowerCase']();if(!lut64||lut64Streng!==_0x2b38f5||lut64Profile!==_0x38e204){const _0x2411fc='./src/lut/lut64_'+_0x38e204+'_'+_0x2b38f5+'.bin';console[_0x2eea80(0x12e)](_0x2411fc);const _0x4bd4b4=await fetch(_0x2411fc),_0x2c367e=await _0x4bd4b4[_0x2eea80(0x101)]();lut64=new Uint8Array(_0x2c367e),lut64Streng=_0x2b38f5,lut64Profile=_0x38e204;}}function setupWebGL_Shader(_0x3f87d0){const _0x282977=a0_0x3e31;gl=bufferCanvas[_0x282977(0x117)]('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x282977(0x124)}),gl[_0x282977(0xf0)](0x0,0x0,bufferCanvas[_0x282977(0x115)],bufferCanvas['height']);function _0x4914c4(_0x1c721c,_0x18ca79){const _0x5628b3=_0x282977,_0x133e88=gl[_0x5628b3(0x119)](_0x1c721c);return gl[_0x5628b3(0x113)](_0x133e88,_0x18ca79),gl['compileShader'](_0x133e88),_0x133e88;}vs='attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}';if(_0x3f87d0===_0x282977(0xff))fs=_0x282977(0x126);else _0x3f87d0===_0x282977(0xf8)&&(fs=_0x282977(0x100));const _0x5e9a86=_0x4914c4(gl[_0x282977(0x10c)],vs),_0xcbf51c=_0x4914c4(gl[_0x282977(0xfa)],fs);return program=gl[_0x282977(0x116)](),gl[_0x282977(0x121)](program,_0x5e9a86),gl[_0x282977(0x121)](program,_0xcbf51c),gl[_0x282977(0x103)](program),gl[_0x282977(0x106)](program),program;}function setupTexture_Buffer(_0x28e587){const _0x30adcf=a0_0x3e31;texture=gl[_0x30adcf(0x11a)](),gl['bindTexture'](gl[_0x30adcf(0x127)],texture),gl[_0x30adcf(0x102)](gl['TEXTURE_2D'],gl[_0x30adcf(0xfe)],gl[_0x30adcf(0x12b)]),gl['texParameteri'](gl[_0x30adcf(0x127)],gl['TEXTURE_MAG_FILTER'],gl[_0x30adcf(0x12b)]),gl['texParameteri'](gl[_0x30adcf(0x127)],gl['TEXTURE_WRAP_S'],gl[_0x30adcf(0xf4)]),gl[_0x30adcf(0x102)](gl['TEXTURE_2D'],gl['TEXTURE_WRAP_T'],gl[_0x30adcf(0xf4)]);_0x28e587===_0x30adcf(0xf8)&&(gl['uniform2f'](gl[_0x30adcf(0x114)](program,_0x30adcf(0x11b)),gameWidth,gameHeight),gl[_0x30adcf(0x131)](gl[_0x30adcf(0x114)](program,_0x30adcf(0xfd)),gl[_0x30adcf(0xfb)]['width'],gl[_0x30adcf(0xfb)][_0x30adcf(0xf9)]),gl[_0x30adcf(0x11c)](gl[_0x30adcf(0x114)](program,'smooth_width'),gameWidth/gl[_0x30adcf(0xfb)]['width']),gl[_0x30adcf(0x11c)](gl['getUniformLocation'](program,'smooth_height'),gameHeight/gl[_0x30adcf(0xfb)][_0x30adcf(0xf9)]));const _0x59ab43=gl['createBuffer']();gl[_0x30adcf(0xf3)](gl[_0x30adcf(0x104)],_0x59ab43),gl[_0x30adcf(0xf1)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x30adcf(0x130)]),gl[_0x30adcf(0x109)](gl[_0x30adcf(0x10b)](program,'position'),0x2,gl['FLOAT'],![],0x0,0x0),gl['enableVertexAttribArray'](gl[_0x30adcf(0x10b)](program,_0x30adcf(0x10a)));const _0x388ce4=gl[_0x30adcf(0x110)]();gl['bindBuffer'](gl[_0x30adcf(0x104)],_0x388ce4),gl[_0x30adcf(0xf1)](gl[_0x30adcf(0x104)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x30adcf(0x130)]),gl[_0x30adcf(0x109)](gl[_0x30adcf(0x10b)](program,_0x30adcf(0x12c)),0x2,gl[_0x30adcf(0x10d)],![],0x0,0x0),gl[_0x30adcf(0xfc)](gl[_0x30adcf(0x10b)](program,_0x30adcf(0x12c)));}function setup2DContext(){const _0x1ef664=a0_0x3e31;ctx2d=bufferCanvas[_0x1ef664(0x117)]('2d'),ctx2d[_0x1ef664(0x12d)]=![];}async function renderPixel(_0x4770a4){const _0x5b87aa=a0_0x3e31,_0x4aefc4=a0_0xb8f2e[_0x5b87aa(0xf6)]();if(!_0x4aefc4)return;await loadLUT64();const _0xaf6565=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x47e924=0x0;_0x47e924<gameHeight;_0x47e924++){for(let _0x27931a=0x0;_0x27931a<gameWidth;_0x27931a++){const _0xc7a955=_0x47e924*gameStride+_0x27931a,_0x5b8db0=(_0x47e924*gameWidth+_0x27931a)*0x4,_0x94e00e=_0x4aefc4[_0xc7a955],_0xf86e1a=(_0x94e00e&0xff)>>0x2,_0x45099d=(_0x94e00e>>0x8&0xff)>>0x2,_0x2fe8ea=(_0x94e00e>>0x10&0xff)>>0x2,_0x3eff80=(_0xf86e1a*0x40*0x40+_0x45099d*0x40+_0x2fe8ea)*0x3;_0xaf6565[_0x5b8db0]=lut64[_0x3eff80],_0xaf6565[_0x5b8db0+0x1]=lut64[_0x3eff80+0x1],_0xaf6565[_0x5b8db0+0x2]=lut64[_0x3eff80+0x2],_0xaf6565[_0x5b8db0+0x3]=0xff;}}if(_0x4770a4===_0x5b87aa(0xff))gl['texImage2D'](gl[_0x5b87aa(0x127)],0x0,gl[_0x5b87aa(0x123)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x5b87aa(0x122)],_0xaf6565),gl[_0x5b87aa(0x125)](gl[_0x5b87aa(0x11d)]),gl['drawArrays'](gl[_0x5b87aa(0xf7)],0x0,0x4);else _0x4770a4==='2d'&&(imageDataObj=new ImageData(_0xaf6565,gameWidth,gameHeight),createImageBitmap(imageDataObj)[_0x5b87aa(0x12f)](_0x3fe8d4=>{const _0x49719d=_0x5b87aa;ctx2d[_0x49719d(0xf5)](0x0,0x0,bufferCanvas[_0x49719d(0x115)],bufferCanvas[_0x49719d(0xf9)]),ctx2d[_0x49719d(0x118)](_0x3fe8d4,0x0,0x0);}));requestAnimationFrame(()=>renderPixel(_0x4770a4));}function a0_0x3e31(_0x562f5f,_0x235ca5){const _0x171b2c=a0_0x171b();return a0_0x3e31=function(_0x3e316d,_0x12a616){_0x3e316d=_0x3e316d-0xf0;let _0x454639=_0x171b2c[_0x3e316d];return _0x454639;},a0_0x3e31(_0x562f5f,_0x235ca5);}export async function switchRenderMode(_0x2c57a8){const _0x37cc00=a0_0x3e31;systemType=gameName[_0x37cc00(0x11e)](-0x3);if(_0x2c57a8==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x2c57a8===_0x37cc00(0xff))setupStyle('2d'),setupWebGL_Shader(_0x37cc00(0xff)),setupTexture_Buffer(_0x37cc00(0xff)),renderPixel(_0x37cc00(0xff));else _0x2c57a8===_0x37cc00(0xf8)&&(setupStyle('webgl_full'),setupWebGL_Shader(_0x37cc00(0xf8)),setupTexture_Buffer('webgl_full'),renderPixel(_0x37cc00(0xff)));}}