const a0_0xc3dc1a=a0_0xf98b;function a0_0xf98b(_0x24eb46,_0xb37d8a){const _0x4f076e=a0_0x4f07();return a0_0xf98b=function(_0xf98b3b,_0x5dee76){_0xf98b3b=_0xf98b3b-0x164;let _0x400f66=_0x4f076e[_0xf98b3b];return _0x400f66;},a0_0xf98b(_0x24eb46,_0xb37d8a);}(function(_0x26e6a6,_0x5e5a6a){const _0x3dafe3=a0_0xf98b,_0x12f09f=_0x26e6a6();while(!![]){try{const _0x489a03=parseInt(_0x3dafe3(0x1c0))/0x1+parseInt(_0x3dafe3(0x16e))/0x2*(parseInt(_0x3dafe3(0x1c5))/0x3)+-parseInt(_0x3dafe3(0x1b6))/0x4*(-parseInt(_0x3dafe3(0x178))/0x5)+-parseInt(_0x3dafe3(0x167))/0x6*(parseInt(_0x3dafe3(0x1a0))/0x7)+parseInt(_0x3dafe3(0x18d))/0x8+-parseInt(_0x3dafe3(0x1c8))/0x9*(-parseInt(_0x3dafe3(0x1a8))/0xa)+parseInt(_0x3dafe3(0x170))/0xb*(-parseInt(_0x3dafe3(0x19c))/0xc);if(_0x489a03===_0x5e5a6a)break;else _0x12f09f['push'](_0x12f09f['shift']());}catch(_0x30db50){_0x12f09f['push'](_0x12f09f['shift']());}}}(a0_0x4f07,0xc34ad));import*as a0_0x271bf6 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0xc3dc1a(0x1b5)](a0_0xc3dc1a(0x181)),bufferCanvas=document[a0_0xc3dc1a(0x1b5)](a0_0xc3dc1a(0x1cf)),canvasContainer=document['getElementById'](a0_0xc3dc1a(0x1c7)),imgShader=document[a0_0xc3dc1a(0x1b5)](a0_0xc3dc1a(0x182)),settingContainer=document['querySelectorAll'](a0_0xc3dc1a(0x177)),messageContainer=document[a0_0xc3dc1a(0x1b1)](a0_0xc3dc1a(0x1b9)),stateTitle=document[a0_0xc3dc1a(0x1b1)](a0_0xc3dc1a(0x1a9));let imageDataObj=null;async function loadLUT64(){const _0x2df392=a0_0xc3dc1a;systemType=gameName['slice'](-0x3);const _0x12e68a=localStorage[_0x2df392(0x164)](gameName+_0x2df392(0x186))||'4.0',_0x2b5d18=(localStorage[_0x2df392(0x164)](gameName+_0x2df392(0x1ae))||_0x2df392(0x19d))[_0x2df392(0x193)]();if(!lut64||lut64Streng!==_0x12e68a||lut64Profile!==_0x2b5d18){const _0x436bfa=_0x2df392(0x1ad)+_0x2b5d18+'_'+_0x12e68a+_0x2df392(0x1bd);console[_0x2df392(0x173)](_0x436bfa);const _0x43e0af=await fetch(_0x436bfa),_0xc8cb50=await _0x43e0af[_0x2df392(0x197)]();lut64=new Uint8Array(_0xc8cb50),lut64Streng=_0x12e68a,lut64Profile=_0x2b5d18;}}async function loadShaderSource(_0x54ad99){const _0xc637c7=a0_0xc3dc1a,_0xb5b023=await fetch(_0x54ad99);return await _0xb5b023[_0xc637c7(0x1a3)]();}function setupStyle(_0x1e413d){const _0x171e27=a0_0xc3dc1a;clientWidth=document['documentElement'][_0x171e27(0x1ab)];const _0x3dcff6=window[_0x171e27(0x17f)];systemType===_0x171e27(0x1af)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math['floor'](clientWidth*_0x3dcff6/gameWidth),localStorage['setItem']('screenSize',_0x171e27(0x18a)+gameWidth*(integerScaling/_0x3dcff6)+','+gameHeight*(integerScaling/_0x3dcff6))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x171e27(0x1b4)](clientWidth*_0x3dcff6/gameWidth),localStorage[_0x171e27(0x1b8)](_0x171e27(0x1c6),_0x171e27(0x18a)+gameWidth*(integerScaling/_0x3dcff6)+','+gameHeight*(integerScaling/_0x3dcff6)));if(_0x1e413d==='2d')bufferCanvas[_0x171e27(0x1a2)]=gameWidth,bufferCanvas[_0x171e27(0x17d)]=gameHeight,bufferCanvas['style'][_0x171e27(0x185)]=''+integerScaling/_0x3dcff6,bufferCanvas[_0x171e27(0x1aa)][_0x171e27(0x175)]=_0x171e27(0x187),canvasContainer[_0x171e27(0x1aa)][_0x171e27(0x1a2)]=gameWidth*(integerScaling/_0x3dcff6)+'px',canvasContainer[_0x171e27(0x1aa)][_0x171e27(0x17d)]=gameHeight*(integerScaling/_0x3dcff6)+'px',textured[_0x171e27(0x1aa)][_0x171e27(0x1a2)]=gameWidth*(integerScaling/_0x3dcff6)+'px',textured[_0x171e27(0x1aa)][_0x171e27(0x17d)]=gameHeight*(integerScaling/_0x3dcff6)+'px',imgShader['style'][_0x171e27(0x1ce)]=_0x171e27(0x18c)+integerScaling/_0x3dcff6/upscaleShader+')',settingContainer[_0x171e27(0x174)](function(_0x34084c){const _0x5ec842=_0x171e27;_0x34084c['style'][_0x5ec842(0x1a2)]=gameWidth*(integerScaling/_0x3dcff6)+'px',_0x34084c[_0x5ec842(0x1aa)]['height']=gameHeight*(integerScaling/_0x3dcff6)+'px';}),messageContainer[_0x171e27(0x174)](function(_0x54f370){const _0x4af9ff=_0x171e27;_0x54f370[_0x4af9ff(0x1aa)][_0x4af9ff(0x1a2)]=gameWidth+'px',_0x54f370[_0x4af9ff(0x1aa)][_0x4af9ff(0x17d)]=gameHeight+'px',_0x54f370[_0x4af9ff(0x1aa)][_0x4af9ff(0x185)]=''+integerScaling/_0x3dcff6;}),stateTitle[_0x171e27(0x174)](function(_0x157b36){const _0xed9d2c=_0x171e27;_0x157b36['classList'][_0xed9d2c(0x195)](_0xed9d2c(0x184));});else _0x1e413d===_0x171e27(0x16f)&&(bufferCanvas[_0x171e27(0x1a2)]=clientWidth*upscaleFactor,bufferCanvas[_0x171e27(0x17d)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x171e27(0x1aa)][_0x171e27(0x185)]=''+0x1/upscaleFactor,bufferCanvas['style']['imageRendering']='',canvasContainer[_0x171e27(0x1aa)][_0x171e27(0x1a2)]=clientWidth+'px',canvasContainer['style'][_0x171e27(0x17d)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x171e27(0x1aa)][_0x171e27(0x1a2)]=clientWidth+'px',textured[_0x171e27(0x1aa)]['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader['style']['transform']=_0x171e27(0x18c)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x171e27(0x174)](function(_0xc0f341){const _0x4dda9f=_0x171e27;_0xc0f341['style'][_0x4dda9f(0x1a2)]=clientWidth+'px',_0xc0f341[_0x4dda9f(0x1aa)][_0x4dda9f(0x17d)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x425883){const _0x100a00=_0x171e27;_0x425883['style']['width']=gameWidth+'px',_0x425883[_0x100a00(0x1aa)][_0x100a00(0x17d)]=gameHeight+'px',_0x425883[_0x100a00(0x1aa)][_0x100a00(0x185)]=''+clientWidth/gameWidth;}),stateTitle[_0x171e27(0x174)](function(_0x442cc6){const _0x437474=_0x171e27;_0x442cc6[_0x437474(0x1c4)][_0x437474(0x169)](_0x437474(0x184));}));imgShader['style'][_0x171e27(0x1a2)]=gameWidth*upscaleShader+'px',imgShader['style'][_0x171e27(0x17d)]=gameHeight*upscaleShader+'px',imgShader[_0x171e27(0x1aa)]['transformOrigin']=_0x171e27(0x17e),imgShader[_0x171e27(0x1aa)][_0x171e27(0x168)](_0x171e27(0x183),upscaleShader+_0x171e27(0x1bb)+upscaleShader+'px');}function setupWebGL(){const _0x38cd5d=a0_0xc3dc1a;gl=bufferCanvas[_0x38cd5d(0x18e)]('webgl2');if(!gl)return console[_0x38cd5d(0x166)](_0x38cd5d(0x1cc)),null;gl[_0x38cd5d(0x1bf)](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x38cd5d(0x17d)]);}function a0_0x4f07(){const _0x1f5579=['clearRect','TEXTURE_MIN_FILTER','getItem','bufferData','error','12HnsJLX','setProperty','add','game_size','shaderSource','render_size','FLOAT','2KxLLMm','webgl2','22471933mfVTyd','RGBA','./src/lut/colorToLutIndex.bin','log','forEach','imageRendering','createTexture','.setting-container','5LphdYa','TEXTURE_WRAP_S','CLAMP_TO_EDGE','data','getUniformLocation','height','top\x20center','devicePixelRatio','smooth_width','textured','img-shader','--bg-size','fefs','zoom','_streng','crisp-edges','bindBuffer','linkProgram','0,0,','enableVertexAttribArray','scale(','10101824RPuOWW','getContext','VERTEX_SHADER','TRIANGLE_STRIP','getPixelData','FRAGMENT_SHADER','toLowerCase','createShader','remove','uniform1f','arrayBuffer','ARRAY_BUFFER','slice','useProgram','addEventListener','24JNvEzZ','warm','drawArrays','attachShader','348180cisFyy','clear','width','text','TEXTURE_2D','TEXTURE_WRAP_T','createProgram','bindTexture','7340arexIM','.stateTitle,\x20.stateDate','style','clientWidth','createBuffer','./src/lut/lut64_','_temperature','gbc','COMPILE_STATUS','querySelectorAll','vertexAttribPointer','texParameteri','floor','getElementById','3497876bCtVIh','UNSIGNED_BYTE','setItem','.message-container','STATIC_DRAW','px\x20','then','.bin','drawImage','viewport','1214459wKWZpU','getShaderInfoLog','./src/shaders/fragmentShader.glsl','texcoord','classList','472419rVwxdP','screenSize','canvas-container','18099QxcorW','NEAREST','getAttribLocation','getShaderParameter','WebGL2\x20not\x20supported','deleteShader','transform','canvas','close'];a0_0x4f07=function(){return _0x1f5579;};return a0_0x4f07();}function createShader(_0x227363,_0x518a26){const _0x4b95f0=a0_0xc3dc1a,_0x519ad8=gl[_0x4b95f0(0x194)](_0x227363);gl[_0x4b95f0(0x16b)](_0x519ad8,_0x518a26),gl['compileShader'](_0x519ad8);if(!gl[_0x4b95f0(0x1cb)](_0x519ad8,gl[_0x4b95f0(0x1b0)]))return console[_0x4b95f0(0x166)](gl[_0x4b95f0(0x1c1)](_0x519ad8)),gl[_0x4b95f0(0x1cd)](_0x519ad8),null;return _0x519ad8;}async function setupShaders(){const _0x3f38bf=a0_0xc3dc1a,_0xeb2f30=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x482ed6=await loadShaderSource(_0x3f38bf(0x1c2)),_0x154d1e=createShader(gl[_0x3f38bf(0x18f)],_0xeb2f30),_0x197500=createShader(gl[_0x3f38bf(0x192)],_0x482ed6);return program=gl[_0x3f38bf(0x1a6)](),gl[_0x3f38bf(0x19f)](program,_0x154d1e),gl[_0x3f38bf(0x19f)](program,_0x197500),gl[_0x3f38bf(0x189)](program),gl[_0x3f38bf(0x19a)](program),program;}function setupTexture(){const _0x2c4af0=a0_0xc3dc1a;texture=gl[_0x2c4af0(0x176)](),gl[_0x2c4af0(0x1a7)](gl[_0x2c4af0(0x1a4)],texture),gl[_0x2c4af0(0x1b3)](gl['TEXTURE_2D'],gl[_0x2c4af0(0x1d2)],gl['NEAREST']),gl[_0x2c4af0(0x1b3)](gl['TEXTURE_2D'],gl['TEXTURE_MAG_FILTER'],gl[_0x2c4af0(0x1c9)]),gl[_0x2c4af0(0x1b3)](gl[_0x2c4af0(0x1a4)],gl[_0x2c4af0(0x179)],gl[_0x2c4af0(0x17a)]),gl[_0x2c4af0(0x1b3)](gl[_0x2c4af0(0x1a4)],gl[_0x2c4af0(0x1a5)],gl[_0x2c4af0(0x17a)]),gl['uniform2f'](gl[_0x2c4af0(0x17c)](program,_0x2c4af0(0x16a)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x2c4af0(0x17c)](program,_0x2c4af0(0x16c)),gl[_0x2c4af0(0x1cf)][_0x2c4af0(0x1a2)],gl[_0x2c4af0(0x1cf)][_0x2c4af0(0x17d)]),gl[_0x2c4af0(0x196)](gl['getUniformLocation'](program,_0x2c4af0(0x180)),gameWidth/gl[_0x2c4af0(0x1cf)]['width']),gl['uniform1f'](gl[_0x2c4af0(0x17c)](program,'smooth_height'),gameHeight/gl[_0x2c4af0(0x1cf)][_0x2c4af0(0x17d)]);}function setupBuffers(){const _0x5af000=a0_0xc3dc1a,_0xfb7611=gl['createBuffer']();gl[_0x5af000(0x188)](gl[_0x5af000(0x198)],_0xfb7611),gl[_0x5af000(0x165)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x5af000(0x1ba)]);const _0x4474db=gl['getAttribLocation'](program,'position');gl[_0x5af000(0x18b)](_0x4474db),gl[_0x5af000(0x1b2)](_0x4474db,0x2,gl['FLOAT'],![],0x0,0x0);const _0x4b3b79=gl[_0x5af000(0x1ac)]();gl[_0x5af000(0x188)](gl['ARRAY_BUFFER'],_0x4b3b79),gl['bufferData'](gl[_0x5af000(0x198)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']);const _0x543d51=gl[_0x5af000(0x1ca)](program,_0x5af000(0x1c3));gl[_0x5af000(0x18b)](_0x543d51),gl[_0x5af000(0x1b2)](_0x543d51,0x2,gl[_0x5af000(0x16d)],![],0x0,0x0);}let colorToLutIndexMap=null;async function loadColorToLutIndexMap(){const _0x139a37=a0_0xc3dc1a;if(!colorToLutIndexMap){const _0x39759e=await fetch(_0x139a37(0x172)),_0x1d2afb=await _0x39759e[_0x139a37(0x197)]();colorToLutIndexMap=new Uint32Array(_0x1d2afb);}}async function renderPixel(_0x3e496f){const _0x718c46=a0_0xc3dc1a,_0x3658f2=a0_0x271bf6[_0x718c46(0x191)]();if(!_0x3658f2)return;await loadLUT64(),await loadColorToLutIndexMap();const _0xb66c2b=new Uint8ClampedArray(gameWidth*gameHeight*0x4),_0x568570=gameWidth*gameHeight;for(let _0x4c66e2=0x0;_0x4c66e2<_0x568570;_0x4c66e2++){const _0xc2e2b4=_0x4c66e2%gameWidth,_0x203b94=Math['floor'](_0x4c66e2/gameWidth),_0x161960=_0x203b94*gameStride+_0xc2e2b4,_0x3bfc8c=_0x4c66e2*0x4,_0x5e8a38=_0x3658f2[_0x161960]&0xffffff,_0x132e87=colorToLutIndexMap[_0x5e8a38];_0xb66c2b[_0x3bfc8c]=lut64[_0x132e87],_0xb66c2b[_0x3bfc8c+0x1]=lut64[_0x132e87+0x1],_0xb66c2b[_0x3bfc8c+0x2]=lut64[_0x132e87+0x2],_0xb66c2b[_0x3bfc8c+0x3]=0xff;}if(_0x3e496f===_0x718c46(0x16f))gl['bindTexture'](gl[_0x718c46(0x1a4)],texture),gl['texImage2D'](gl[_0x718c46(0x1a4)],0x0,gl[_0x718c46(0x171)],gameWidth,gameHeight,0x0,gl[_0x718c46(0x171)],gl[_0x718c46(0x1b7)],_0xb66c2b),gl[_0x718c46(0x1a1)](gl['COLOR_BUFFER_BIT']),gl[_0x718c46(0x19e)](gl[_0x718c46(0x190)],0x0,0x4);else _0x3e496f==='2d'&&(!ctx2d&&(ctx2d=bufferCanvas['getContext']('2d',{'alpha':![]}),ctx2d['imageSmoothingEnabled']=![]),!imageDataObj?imageDataObj=new ImageData(gameWidth,gameHeight):imageDataObj[_0x718c46(0x17b)]['set'](_0xb66c2b),createImageBitmap(imageDataObj)[_0x718c46(0x1bc)](_0x6a2c98=>{const _0x17e607=_0x718c46;ctx2d[_0x17e607(0x1d1)](0x0,0x0,bufferCanvas[_0x17e607(0x1a2)],bufferCanvas[_0x17e607(0x17d)]),ctx2d[_0x17e607(0x1be)](_0x6a2c98,0x0,0x0),_0x6a2c98[_0x17e607(0x1d0)]();}));requestAnimationFrame(()=>renderPixel(_0x3e496f));}export async function switchRenderMode(_0x43d472){const _0x66637c=a0_0xc3dc1a;systemType=gameName[_0x66637c(0x199)](-0x3);if(_0x43d472==='2d')setupStyle('2d'),renderPixel('2d');else _0x43d472===_0x66637c(0x16f)&&(setupStyle(_0x66637c(0x16f)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x66637c(0x16f)));}document[a0_0xc3dc1a(0x19b)]('DOMContentLoaded',function(){});