const a0_0x551088=a0_0x2d9f;(function(_0x32891d,_0x400ecc){const _0x353d12=a0_0x2d9f,_0x49ff91=_0x32891d();while(!![]){try{const _0x1d036e=parseInt(_0x353d12(0x139))/0x1+-parseInt(_0x353d12(0x173))/0x2*(parseInt(_0x353d12(0x164))/0x3)+-parseInt(_0x353d12(0x149))/0x4+parseInt(_0x353d12(0x152))/0x5*(-parseInt(_0x353d12(0x148))/0x6)+parseInt(_0x353d12(0x17e))/0x7+parseInt(_0x353d12(0x13f))/0x8*(-parseInt(_0x353d12(0x160))/0x9)+parseInt(_0x353d12(0x141))/0xa;if(_0x1d036e===_0x400ecc)break;else _0x49ff91['push'](_0x49ff91['shift']());}catch(_0x5b2975){_0x49ff91['push'](_0x49ff91['shift']());}}}(a0_0x96bb,0x8faaf));import*as a0_0x1fa45b from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x551088(0x137)](a0_0x551088(0x16a)),bufferCanvas=document[a0_0x551088(0x137)](a0_0x551088(0x18e)),canvasContainer=document[a0_0x551088(0x137)](a0_0x551088(0x14f)),imgShader=document[a0_0x551088(0x137)]('img-shader'),settingContainer=document['querySelectorAll'](a0_0x551088(0x18a)),messageContainer=document['querySelectorAll'](a0_0x551088(0x178)),stateTitle=document[a0_0x551088(0x185)](a0_0x551088(0x190));let imageDataObj=null;async function loadLUT64(){const _0x518a79=a0_0x551088;systemType=gameName[_0x518a79(0x153)](-0x3);const _0x22de50=localStorage[_0x518a79(0x187)](gameName+_0x518a79(0x14b))||'4.0',_0xc82090=(localStorage['getItem'](gameName+_0x518a79(0x167))||_0x518a79(0x159))[_0x518a79(0x154)]();if(!lut64||lut64Streng!==_0x22de50||lut64Profile!==_0xc82090){const _0x44797d=_0x518a79(0x17b)+_0xc82090+'_'+_0x22de50+'.bin';console[_0x518a79(0x18f)](_0x44797d);const _0x339aae=await fetch(_0x44797d),_0x11633d=await _0x339aae[_0x518a79(0x179)]();lut64=new Uint8Array(_0x11633d),lut64Streng=_0x22de50,lut64Profile=_0xc82090;}}async function loadShaderSource(_0x484bf5){const _0x29a716=await fetch(_0x484bf5);return await _0x29a716['text']();}function setupStyle(_0x3a0b63){const _0x771e57=a0_0x551088;clientWidth=document[_0x771e57(0x156)][_0x771e57(0x16b)];const _0x3430a8=window[_0x771e57(0x135)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x771e57(0x15e)](clientWidth*_0x3430a8/gameWidth),localStorage['setItem'](_0x771e57(0x191),_0x771e57(0x138)+gameWidth*(integerScaling/_0x3430a8)+','+gameHeight*(integerScaling/_0x3430a8))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math['floor'](clientWidth*_0x3430a8/gameWidth),localStorage[_0x771e57(0x12a)](_0x771e57(0x191),'0,0,'+gameWidth*(integerScaling/_0x3430a8)+','+gameHeight*(integerScaling/_0x3430a8)));if(_0x3a0b63==='2d')bufferCanvas[_0x771e57(0x147)]=gameWidth,bufferCanvas['height']=gameHeight,bufferCanvas[_0x771e57(0x16e)][_0x771e57(0x16d)]=''+integerScaling/_0x3430a8,bufferCanvas[_0x771e57(0x16e)][_0x771e57(0x142)]=_0x771e57(0x183),canvasContainer[_0x771e57(0x16e)][_0x771e57(0x147)]=gameWidth*(integerScaling/_0x3430a8)+'px',canvasContainer[_0x771e57(0x16e)][_0x771e57(0x13b)]=gameHeight*(integerScaling/_0x3430a8)+'px',textured['style'][_0x771e57(0x147)]=gameWidth*(integerScaling/_0x3430a8)+'px',textured[_0x771e57(0x16e)][_0x771e57(0x13b)]=gameHeight*(integerScaling/_0x3430a8)+'px',imgShader[_0x771e57(0x16e)][_0x771e57(0x144)]=_0x771e57(0x161)+integerScaling/_0x3430a8/upscaleShader+')',settingContainer[_0x771e57(0x140)](function(_0x1afc70){const _0x137bfe=_0x771e57;_0x1afc70['style'][_0x137bfe(0x147)]=gameWidth*(integerScaling/_0x3430a8)+'px',_0x1afc70[_0x137bfe(0x16e)][_0x137bfe(0x13b)]=gameHeight*(integerScaling/_0x3430a8)+'px';}),messageContainer[_0x771e57(0x140)](function(_0x310743){const _0x299ed8=_0x771e57;_0x310743['style'][_0x299ed8(0x147)]=gameWidth+'px',_0x310743[_0x299ed8(0x16e)][_0x299ed8(0x13b)]=gameHeight+'px',_0x310743[_0x299ed8(0x16e)]['zoom']=''+integerScaling/_0x3430a8;}),stateTitle[_0x771e57(0x140)](function(_0x108c9f){const _0x5bbb3d=_0x771e57;_0x108c9f[_0x5bbb3d(0x12b)][_0x5bbb3d(0x175)]('fefs');});else _0x3a0b63===_0x771e57(0x184)&&(bufferCanvas[_0x771e57(0x147)]=clientWidth*upscaleFactor,bufferCanvas['height']=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style'][_0x771e57(0x16d)]=''+0x1/upscaleFactor,bufferCanvas['style'][_0x771e57(0x142)]='',canvasContainer[_0x771e57(0x16e)][_0x771e57(0x147)]=clientWidth+'px',canvasContainer[_0x771e57(0x16e)][_0x771e57(0x13b)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x771e57(0x16e)][_0x771e57(0x147)]=clientWidth+'px',textured[_0x771e57(0x16e)]['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x771e57(0x16e)][_0x771e57(0x144)]=_0x771e57(0x161)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x771e57(0x140)](function(_0x4ba8e4){const _0x415d74=_0x771e57;_0x4ba8e4[_0x415d74(0x16e)][_0x415d74(0x147)]=clientWidth+'px',_0x4ba8e4[_0x415d74(0x16e)][_0x415d74(0x13b)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x50f1d4){const _0x504d07=_0x771e57;_0x50f1d4[_0x504d07(0x16e)][_0x504d07(0x147)]=gameWidth+'px',_0x50f1d4['style'][_0x504d07(0x13b)]=gameHeight+'px',_0x50f1d4[_0x504d07(0x16e)]['zoom']=''+clientWidth/gameWidth;}),stateTitle[_0x771e57(0x140)](function(_0x46d027){const _0x5bdfdc=_0x771e57;_0x46d027['classList'][_0x5bdfdc(0x16c)](_0x5bdfdc(0x151));}));imgShader[_0x771e57(0x16e)][_0x771e57(0x147)]=gameWidth*upscaleShader+'px',imgShader[_0x771e57(0x16e)][_0x771e57(0x13b)]=gameHeight*upscaleShader+'px',imgShader[_0x771e57(0x16e)][_0x771e57(0x145)]=_0x771e57(0x12f),imgShader[_0x771e57(0x16e)][_0x771e57(0x182)]('--bg-size',upscaleShader+_0x771e57(0x131)+upscaleShader+'px');}function setupWebGL(){const _0x44278f=a0_0x551088;gl=bufferCanvas[_0x44278f(0x146)](_0x44278f(0x184));if(!gl)return console['error'](_0x44278f(0x16f)),null;gl[_0x44278f(0x18d)](0x0,0x0,bufferCanvas[_0x44278f(0x147)],bufferCanvas[_0x44278f(0x13b)]);}function createShader(_0x432957,_0x28732e){const _0x388964=a0_0x551088,_0x12041e=gl[_0x388964(0x176)](_0x432957);gl[_0x388964(0x166)](_0x12041e,_0x28732e),gl[_0x388964(0x17d)](_0x12041e);if(!gl['getShaderParameter'](_0x12041e,gl[_0x388964(0x13a)]))return console[_0x388964(0x13d)](gl[_0x388964(0x14a)](_0x12041e)),gl[_0x388964(0x158)](_0x12041e),null;return _0x12041e;}async function setupShaders(){const _0x101532=a0_0x551088,_0x590939=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x504b90=await loadShaderSource(_0x101532(0x132)),_0x4f12a7=createShader(gl[_0x101532(0x170)],_0x590939),_0x3f531d=createShader(gl['FRAGMENT_SHADER'],_0x504b90);return program=gl[_0x101532(0x15b)](),gl[_0x101532(0x18c)](program,_0x4f12a7),gl[_0x101532(0x18c)](program,_0x3f531d),gl[_0x101532(0x168)](program),gl[_0x101532(0x171)](program),program;}function setupTexture(){const _0x316061=a0_0x551088;texture=gl['createTexture'](),gl[_0x316061(0x150)](gl[_0x316061(0x162)],texture),gl[_0x316061(0x181)](gl[_0x316061(0x162)],gl['TEXTURE_MIN_FILTER'],gl[_0x316061(0x17c)]),gl[_0x316061(0x181)](gl[_0x316061(0x162)],gl[_0x316061(0x165)],gl[_0x316061(0x17c)]),gl[_0x316061(0x181)](gl[_0x316061(0x162)],gl[_0x316061(0x134)],gl['CLAMP_TO_EDGE']),gl[_0x316061(0x181)](gl[_0x316061(0x162)],gl['TEXTURE_WRAP_T'],gl['CLAMP_TO_EDGE']),gl[_0x316061(0x172)](gl[_0x316061(0x15a)](program,'game_size'),gameWidth,gameHeight),gl['uniform2f'](gl['getUniformLocation'](program,_0x316061(0x169)),gl['canvas'][_0x316061(0x147)],gl[_0x316061(0x18e)][_0x316061(0x13b)]),gl[_0x316061(0x15f)](gl['getUniformLocation'](program,_0x316061(0x15c)),gameWidth/gl[_0x316061(0x18e)]['width']),gl[_0x316061(0x15f)](gl[_0x316061(0x15a)](program,_0x316061(0x13c)),gameHeight/gl['canvas']['height']);}function a0_0x2d9f(_0x5b7b3b,_0x275376){const _0x96bbff=a0_0x96bb();return a0_0x2d9f=function(_0x2d9f11,_0x3173e8){_0x2d9f11=_0x2d9f11-0x12a;let _0x17e2b8=_0x96bbff[_0x2d9f11];return _0x17e2b8;},a0_0x2d9f(_0x5b7b3b,_0x275376);}function setupBuffers(){const _0x3e4efb=a0_0x551088,_0x1776d3=gl['createBuffer']();gl[_0x3e4efb(0x136)](gl[_0x3e4efb(0x177)],_0x1776d3),gl['bufferData'](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x3e4efb(0x17f)]);const _0x4a505d=gl['getAttribLocation'](program,_0x3e4efb(0x143));gl[_0x3e4efb(0x15d)](_0x4a505d),gl['vertexAttribPointer'](_0x4a505d,0x2,gl[_0x3e4efb(0x14d)],![],0x0,0x0);const _0x2b7764=gl[_0x3e4efb(0x14c)]();gl[_0x3e4efb(0x136)](gl[_0x3e4efb(0x177)],_0x2b7764),gl[_0x3e4efb(0x18b)](gl[_0x3e4efb(0x177)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x3e4efb(0x17f)]);const _0x27a873=gl[_0x3e4efb(0x17a)](program,_0x3e4efb(0x133));gl[_0x3e4efb(0x15d)](_0x27a873),gl[_0x3e4efb(0x180)](_0x27a873,0x2,gl[_0x3e4efb(0x14d)],![],0x0,0x0);}async function renderPixel(_0xcf6c31){const _0x2bb06f=a0_0x551088,_0x24e4d6=a0_0x1fa45b[_0x2bb06f(0x12c)]();if(!_0x24e4d6)return;await loadLUT64();const _0x4c002e=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x4a2acc=0x0;_0x4a2acc<gameHeight;_0x4a2acc++){for(let _0x139fd9=0x0;_0x139fd9<gameWidth;_0x139fd9++){const _0x497aa6=_0x4a2acc*gameStride+_0x139fd9,_0x3b5a12=(_0x4a2acc*gameWidth+_0x139fd9)*0x4,_0x1f33b1=_0x24e4d6[_0x497aa6],_0x4e8c5f=(_0x1f33b1&0xff)>>0x2,_0x291f26=(_0x1f33b1>>0x8&0xff)>>0x2,_0x4acc2d=(_0x1f33b1>>0x10&0xff)>>0x2,_0xd4880a=(_0x4e8c5f*0x40*0x40+_0x291f26*0x40+_0x4acc2d)*0x3;_0x4c002e[_0x3b5a12]=lut64[_0xd4880a],_0x4c002e[_0x3b5a12+0x1]=lut64[_0xd4880a+0x1],_0x4c002e[_0x3b5a12+0x2]=lut64[_0xd4880a+0x2],_0x4c002e[_0x3b5a12+0x3]=0xff;}}if(_0xcf6c31===_0x2bb06f(0x184))gl[_0x2bb06f(0x150)](gl[_0x2bb06f(0x162)],texture),gl[_0x2bb06f(0x189)](gl[_0x2bb06f(0x162)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x2bb06f(0x12e)],gl[_0x2bb06f(0x13e)],_0x4c002e),gl[_0x2bb06f(0x130)](gl['COLOR_BUFFER_BIT']),gl[_0x2bb06f(0x14e)](gl['TRIANGLE_STRIP'],0x0,0x4);else _0xcf6c31==='2d'&&(!ctx2d&&(ctx2d=bufferCanvas[_0x2bb06f(0x146)]('2d',{'alpha':![]}),ctx2d['imageSmoothingEnabled']=![]),(!imageDataObj||imageDataObj[_0x2bb06f(0x147)]!==gameWidth||imageDataObj[_0x2bb06f(0x13b)]!==gameHeight)&&(imageDataObj=new ImageData(gameWidth,gameHeight)),imageDataObj[_0x2bb06f(0x188)]['set'](_0x4c002e),createImageBitmap(imageDataObj)[_0x2bb06f(0x186)](_0x30ac79=>{const _0x1cb424=_0x2bb06f;ctx2d[_0x1cb424(0x163)](0x0,0x0,bufferCanvas[_0x1cb424(0x147)],bufferCanvas[_0x1cb424(0x13b)]),ctx2d[_0x1cb424(0x155)](_0x30ac79,0x0,0x0),_0x30ac79[_0x1cb424(0x174)]();}));requestAnimationFrame(()=>renderPixel(_0xcf6c31));}export async function switchRenderMode(_0x27a491){const _0xf9f83d=a0_0x551088;systemType=gameName[_0xf9f83d(0x153)](-0x3);if(_0x27a491==='2d')setupStyle('2d'),renderPixel('2d');else _0x27a491===_0xf9f83d(0x184)&&(setupStyle(_0xf9f83d(0x184)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0xf9f83d(0x184)));}document[a0_0x551088(0x12d)](a0_0x551088(0x157),function(){});function a0_0x96bb(){const _0x1e82e0=['shaderSource','_temperature','linkProgram','render_size','textured','clientWidth','add','zoom','style','WebGL2\x20not\x20supported','VERTEX_SHADER','useProgram','uniform2f','302522QWtCMd','close','remove','createShader','ARRAY_BUFFER','.message-container','arrayBuffer','getAttribLocation','./src/lut/lut64_','NEAREST','compileShader','4714962vNfSpv','STATIC_DRAW','vertexAttribPointer','texParameteri','setProperty','crisp-edges','webgl2','querySelectorAll','then','getItem','data','texImage2D','.setting-container','bufferData','attachShader','viewport','canvas','log','.stateTitle,\x20.stateDate','screenSize','setItem','classList','getPixelData','addEventListener','RGBA','top\x20center','clear','px\x20','./src/shaders/fragmentShader.glsl','texcoord','TEXTURE_WRAP_S','devicePixelRatio','bindBuffer','getElementById','0,0,','941082NTdshB','COMPILE_STATUS','height','smooth_height','error','UNSIGNED_BYTE','8UCnFiJ','forEach','8536040ijbMyS','imageRendering','position','transform','transformOrigin','getContext','width','154740fCPbHe','1473520gDJQgm','getShaderInfoLog','_streng','createBuffer','FLOAT','drawArrays','canvas-container','bindTexture','fefs','5SAZGQp','slice','toLowerCase','drawImage','documentElement','DOMContentLoaded','deleteShader','warm','getUniformLocation','createProgram','smooth_width','enableVertexAttribArray','floor','uniform1f','9286524epUsCD','scale(','TEXTURE_2D','clearRect','9SkRfpb','TEXTURE_MAG_FILTER'];a0_0x96bb=function(){return _0x1e82e0;};return a0_0x96bb();}