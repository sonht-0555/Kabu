(function(_0x4cb288,_0x1630ae){const _0x443603=a0_0x2675,_0x55486e=_0x4cb288();while(!![]){try{const _0x50fc59=-parseInt(_0x443603(0x12a))/0x1+parseInt(_0x443603(0x11d))/0x2+parseInt(_0x443603(0x115))/0x3+parseInt(_0x443603(0xfc))/0x4*(-parseInt(_0x443603(0x105))/0x5)+parseInt(_0x443603(0x130))/0x6*(-parseInt(_0x443603(0x133))/0x7)+-parseInt(_0x443603(0x10b))/0x8*(-parseInt(_0x443603(0x139))/0x9)+parseInt(_0x443603(0xfa))/0xa;if(_0x50fc59===_0x1630ae)break;else _0x55486e['push'](_0x55486e['shift']());}catch(_0x7c3152){_0x55486e['push'](_0x55486e['shift']());}}}(a0_0x5d1c,0xaa521));import*as a0_0x2d6d39 from'./main.js';function a0_0x2675(_0x35eaab,_0x55cdaf){const _0x5d1cd3=a0_0x5d1c();return a0_0x2675=function(_0x26757f,_0x14eb8c){_0x26757f=_0x26757f-0xfa;let _0x3d5c04=_0x5d1cd3[_0x26757f];return _0x3d5c04;},a0_0x2675(_0x35eaab,_0x55cdaf);}let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;function a0_0x5d1c(){const _0x5bcd55=['clearRect','createBuffer','getAttribLocation','smooth_width','587836FDGQXO','webgl_full','bufferData','drawArrays','vertexAttribPointer','STATIC_DRAW','468678lbVhyp','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','compileShader','7QuzTQu','texParameteri','canvas','webgl','./src/lut/lut64_','low-power','45ICCHBi','uniform1f','TRIANGLE_STRIP','2852820KgpzwW','uniform2f','52732ixcYBx','FLOAT','TEXTURE_WRAP_T','enableVertexAttribArray','log','TEXTURE_WRAP_S','bindBuffer','texImage2D','putImageData','260taWNSp','smooth_height','ARRAY_BUFFER','width','height','createShader','1998872IguFFA','texcoord','CLAMP_TO_EDGE','toLowerCase','bindTexture','createProgram','NEAREST','none','UNSIGNED_BYTE','COLOR_BUFFER_BIT','973413UHNwFn','shaderSource','game_size','getPixelData','linkProgram','viewport','position','imageSmoothingEnabled','380100aeLyik','attachShader','TEXTURE_2D','getContext','FRAGMENT_SHADER','RGBA','getUniformLocation','_temperature','clear'];a0_0x5d1c=function(){return _0x5bcd55;};return a0_0x5d1c();}async function loadLUT64(){const _0x448168=a0_0x2675;systemType=gameName['slice'](-0x3);const _0x32f48d=(localStorage['getItem'](gameName+_0x448168(0x124))||_0x448168(0x112))[_0x448168(0x10e)]();if(!lut64||lut64Profile!==_0x32f48d){const _0x262e9c=_0x448168(0x137)+_0x32f48d+'_4.0.bin';console[_0x448168(0x100)](_0x262e9c);const _0x41541a=await fetch(_0x262e9c),_0x505dde=await _0x41541a['arrayBuffer']();lut64=new Uint8Array(_0x505dde),lut64Profile=_0x32f48d;}}function setupWebGL_Shader(_0x36fb9b){const _0x411fc5=a0_0x2675;gl=bufferCanvas[_0x411fc5(0x120)](_0x411fc5(0x136),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x411fc5(0x138)}),gl[_0x411fc5(0x11a)](0x0,0x0,bufferCanvas[_0x411fc5(0x108)],bufferCanvas[_0x411fc5(0x109)]);function _0x3385a6(_0x59917c,_0x5862cf){const _0x56042d=_0x411fc5,_0x2adf31=gl[_0x56042d(0x10a)](_0x59917c);return gl[_0x56042d(0x116)](_0x2adf31,_0x5862cf),gl[_0x56042d(0x132)](_0x2adf31),_0x2adf31;}vs=_0x411fc5(0x131);if(_0x36fb9b===_0x411fc5(0x136))fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}';else _0x36fb9b===_0x411fc5(0x12b)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x456586=_0x3385a6(gl['VERTEX_SHADER'],vs),_0x464eae=_0x3385a6(gl[_0x411fc5(0x121)],fs);return program=gl[_0x411fc5(0x110)](),gl[_0x411fc5(0x11e)](program,_0x456586),gl[_0x411fc5(0x11e)](program,_0x464eae),gl[_0x411fc5(0x119)](program),gl['useProgram'](program),program;}function setupTexture_Buffer(_0x4e67b6){const _0x366844=a0_0x2675;texture=gl['createTexture'](),gl[_0x366844(0x10f)](gl['TEXTURE_2D'],texture),gl[_0x366844(0x134)](gl[_0x366844(0x11f)],gl['TEXTURE_MIN_FILTER'],gl[_0x366844(0x111)]),gl['texParameteri'](gl[_0x366844(0x11f)],gl['TEXTURE_MAG_FILTER'],gl['NEAREST']),gl['texParameteri'](gl[_0x366844(0x11f)],gl[_0x366844(0x101)],gl[_0x366844(0x10d)]),gl[_0x366844(0x134)](gl[_0x366844(0x11f)],gl[_0x366844(0xfe)],gl[_0x366844(0x10d)]);_0x4e67b6===_0x366844(0x12b)&&(gl[_0x366844(0xfb)](gl[_0x366844(0x123)](program,_0x366844(0x117)),gameWidth,gameHeight),gl['uniform2f'](gl['getUniformLocation'](program,'render_size'),gl[_0x366844(0x135)][_0x366844(0x108)],gl[_0x366844(0x135)][_0x366844(0x109)]),gl[_0x366844(0x13a)](gl[_0x366844(0x123)](program,_0x366844(0x129)),gameWidth/gl[_0x366844(0x135)][_0x366844(0x108)]),gl[_0x366844(0x13a)](gl[_0x366844(0x123)](program,_0x366844(0x106)),gameHeight/gl[_0x366844(0x135)][_0x366844(0x109)]));const _0x45cffa=gl['createBuffer']();gl[_0x366844(0x102)](gl[_0x366844(0x107)],_0x45cffa),gl[_0x366844(0x12c)](gl[_0x366844(0x107)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x366844(0x12f)]),gl['vertexAttribPointer'](gl['getAttribLocation'](program,_0x366844(0x11b)),0x2,gl['FLOAT'],![],0x0,0x0),gl['enableVertexAttribArray'](gl[_0x366844(0x128)](program,_0x366844(0x11b)));const _0x4123a4=gl[_0x366844(0x127)]();gl[_0x366844(0x102)](gl[_0x366844(0x107)],_0x4123a4),gl[_0x366844(0x12c)](gl[_0x366844(0x107)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x366844(0x12f)]),gl[_0x366844(0x12e)](gl[_0x366844(0x128)](program,_0x366844(0x10c)),0x2,gl[_0x366844(0xfd)],![],0x0,0x0),gl[_0x366844(0xff)](gl[_0x366844(0x128)](program,'texcoord'));}function setup2DContext(){const _0x157228=a0_0x2675;ctx2d=bufferCanvas[_0x157228(0x120)]('2d'),ctx2d[_0x157228(0x11c)]=![];}async function renderPixel(_0x2cd72c){const _0x55fbd5=a0_0x2675,_0x14da20=a0_0x2d6d39[_0x55fbd5(0x118)]();if(!_0x14da20)return;await loadLUT64();const _0x26dc9d=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x5d7873=0x0;_0x5d7873<gameHeight;_0x5d7873++){for(let _0x444bc7=0x0;_0x444bc7<gameWidth;_0x444bc7++){const _0x5416c5=_0x5d7873*gameStride+_0x444bc7,_0x23bcbb=(_0x5d7873*gameWidth+_0x444bc7)*0x4,_0x327906=_0x14da20[_0x5416c5];if(lut64Profile==='none')_0x26dc9d[_0x23bcbb]=_0x327906&0xff,_0x26dc9d[_0x23bcbb+0x1]=_0x327906>>0x8&0xff,_0x26dc9d[_0x23bcbb+0x2]=_0x327906>>0x10&0xff,_0x26dc9d[_0x23bcbb+0x3]=0xff;else{const _0x2fd3cb=(_0x327906&0xff)>>0x2,_0x346d10=(_0x327906>>0x8&0xff)>>0x2,_0xd1b453=(_0x327906>>0x10&0xff)>>0x2,_0x9585ff=(_0x2fd3cb*0x40*0x40+_0x346d10*0x40+_0xd1b453)*0x3;_0x26dc9d[_0x23bcbb]=lut64[_0x9585ff],_0x26dc9d[_0x23bcbb+0x1]=lut64[_0x9585ff+0x1],_0x26dc9d[_0x23bcbb+0x2]=lut64[_0x9585ff+0x2],_0x26dc9d[_0x23bcbb+0x3]=0xff;}}}if(_0x2cd72c===_0x55fbd5(0x136))gl[_0x55fbd5(0x103)](gl[_0x55fbd5(0x11f)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x55fbd5(0x122)],gl[_0x55fbd5(0x113)],_0x26dc9d),gl[_0x55fbd5(0x125)](gl[_0x55fbd5(0x114)]),gl[_0x55fbd5(0x12d)](gl[_0x55fbd5(0x13b)],0x0,0x4);else _0x2cd72c==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x26dc9d,gameWidth,gameHeight):imageDataObj['data']['set'](_0x26dc9d),ctx2d[_0x55fbd5(0x126)](0x0,0x0,bufferCanvas['width'],bufferCanvas['height']),ctx2d[_0x55fbd5(0x104)](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x2cd72c));}export async function switchRenderMode(_0x2ae93f){const _0x3a8f30=a0_0x2675;systemType=gameName['slice'](-0x3);if(_0x2ae93f==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x2ae93f==='webgl')setupStyle('2d'),setupWebGL_Shader(_0x3a8f30(0x136)),setupTexture_Buffer(_0x3a8f30(0x136)),renderPixel(_0x3a8f30(0x136));else _0x2ae93f==='webgl_full'&&(setupStyle(_0x3a8f30(0x12b)),setupWebGL_Shader('webgl_full'),setupTexture_Buffer(_0x3a8f30(0x12b)),renderPixel(_0x3a8f30(0x136)));}}