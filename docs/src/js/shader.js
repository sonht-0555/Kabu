(function(_0x6f3b84,_0x1ee268){const _0x6a7456=a0_0x52f4,_0x2f4d5e=_0x6f3b84();while(!![]){try{const _0x3a650b=parseInt(_0x6a7456(0x1fc))/0x1*(-parseInt(_0x6a7456(0x1f6))/0x2)+-parseInt(_0x6a7456(0x1e7))/0x3*(-parseInt(_0x6a7456(0x205))/0x4)+parseInt(_0x6a7456(0x1dc))/0x5*(parseInt(_0x6a7456(0x1f4))/0x6)+-parseInt(_0x6a7456(0x20c))/0x7+-parseInt(_0x6a7456(0x1f0))/0x8*(-parseInt(_0x6a7456(0x1f9))/0x9)+parseInt(_0x6a7456(0x209))/0xa+parseInt(_0x6a7456(0x1e0))/0xb*(-parseInt(_0x6a7456(0x1ce))/0xc);if(_0x3a650b===_0x1ee268)break;else _0x2f4d5e['push'](_0x2f4d5e['shift']());}catch(_0x5a605d){_0x2f4d5e['push'](_0x2f4d5e['shift']());}}}(a0_0x5f45,0x595d0));import*as a0_0x321051 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x4bd826=a0_0x52f4;systemType=gameName[_0x4bd826(0x20a)](-0x3);const _0xb09cf5=(localStorage[_0x4bd826(0x1d4)](gameName+_0x4bd826(0x1e1))||_0x4bd826(0x201))[_0x4bd826(0x1d8)]();if(!lut64||lut64Profile!==_0xb09cf5){const _0x4ce5b5=_0x4bd826(0x1e6)+_0xb09cf5+_0x4bd826(0x1fa);console['log'](_0x4ce5b5);const _0x142585=await fetch(_0x4ce5b5),_0x1e512c=await _0x142585[_0x4bd826(0x1d5)]();lut64=new Uint8Array(_0x1e512c),lut64Profile=_0xb09cf5;}}function setupWebGL_Shader(_0x171d36){const _0xc8d20c=a0_0x52f4;gl=bufferCanvas[_0xc8d20c(0x1ef)](_0xc8d20c(0x20e),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':'low-power'}),gl[_0xc8d20c(0x1d9)](0x0,0x0,bufferCanvas[_0xc8d20c(0x207)],bufferCanvas[_0xc8d20c(0x1f8)]);function _0x1c5270(_0x22d14e,_0x6538a9){const _0x3f08e7=_0xc8d20c,_0x59b850=gl[_0x3f08e7(0x1db)](_0x22d14e);return gl[_0x3f08e7(0x1f1)](_0x59b850,_0x6538a9),gl[_0x3f08e7(0x1cd)](_0x59b850),_0x59b850;}vs=_0xc8d20c(0x1e5);if(_0x171d36==='webgl')fs=_0xc8d20c(0x202);else _0x171d36===_0xc8d20c(0x1df)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x12fd80=_0x1c5270(gl[_0xc8d20c(0x203)],vs),_0x449459=_0x1c5270(gl[_0xc8d20c(0x1e3)],fs);return program=gl[_0xc8d20c(0x1cc)](),gl[_0xc8d20c(0x1de)](program,_0x12fd80),gl[_0xc8d20c(0x1de)](program,_0x449459),gl[_0xc8d20c(0x1ea)](program),gl['useProgram'](program),program;}function a0_0x52f4(_0x1100db,_0x3f0d04){const _0x5f45ae=a0_0x5f45();return a0_0x52f4=function(_0x52f4bb,_0x29b88c){_0x52f4bb=_0x52f4bb-0x1cc;let _0x15dc15=_0x5f45ae[_0x52f4bb];return _0x15dc15;},a0_0x52f4(_0x1100db,_0x3f0d04);}function setupTexture_Buffer(_0x2efe93){const _0x15e177=a0_0x52f4;texture=gl[_0x15e177(0x1ec)](),gl['bindTexture'](gl[_0x15e177(0x1da)],texture),gl[_0x15e177(0x1d0)](gl[_0x15e177(0x1da)],gl[_0x15e177(0x1e8)],gl[_0x15e177(0x208)]),gl[_0x15e177(0x1d0)](gl[_0x15e177(0x1da)],gl['TEXTURE_MAG_FILTER'],gl[_0x15e177(0x208)]),gl[_0x15e177(0x1d0)](gl[_0x15e177(0x1da)],gl[_0x15e177(0x1f5)],gl[_0x15e177(0x1f3)]),gl[_0x15e177(0x1d0)](gl[_0x15e177(0x1da)],gl['TEXTURE_WRAP_T'],gl[_0x15e177(0x1f3)]);_0x2efe93===_0x15e177(0x1df)&&(gl['uniform2f'](gl['getUniformLocation'](program,'game_size'),gameWidth,gameHeight),gl[_0x15e177(0x20b)](gl[_0x15e177(0x1d1)](program,'render_size'),gl[_0x15e177(0x1ff)]['width'],gl[_0x15e177(0x1ff)][_0x15e177(0x1f8)]),gl['uniform1f'](gl[_0x15e177(0x1d1)](program,_0x15e177(0x1fd)),gameWidth/gl[_0x15e177(0x1ff)]['width']),gl[_0x15e177(0x1d6)](gl[_0x15e177(0x1d1)](program,'smooth_height'),gameHeight/gl[_0x15e177(0x1ff)][_0x15e177(0x1f8)]));const _0x161910=gl[_0x15e177(0x1e2)]();gl[_0x15e177(0x1dd)](gl['ARRAY_BUFFER'],_0x161910),gl[_0x15e177(0x1d2)](gl[_0x15e177(0x1e9)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x15e177(0x1eb)]),gl[_0x15e177(0x1f2)](gl[_0x15e177(0x1d3)](program,_0x15e177(0x20d)),0x2,gl[_0x15e177(0x1f7)],![],0x0,0x0),gl['enableVertexAttribArray'](gl[_0x15e177(0x1d3)](program,'position'));const _0x329ab5=gl[_0x15e177(0x1e2)]();gl[_0x15e177(0x1dd)](gl[_0x15e177(0x1e9)],_0x329ab5),gl['bufferData'](gl[_0x15e177(0x1e9)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl[_0x15e177(0x1f2)](gl[_0x15e177(0x1d3)](program,_0x15e177(0x1fb)),0x2,gl[_0x15e177(0x1f7)],![],0x0,0x0),gl[_0x15e177(0x206)](gl[_0x15e177(0x1d3)](program,'texcoord'));}function a0_0x5f45(){const _0x505d4c=['shaderSource','vertexAttribPointer','CLAMP_TO_EDGE','12FCIXSg','TEXTURE_WRAP_S','262342uWdixt','FLOAT','height','261razAXT','_4.0.bin','texcoord','5jMklNz','smooth_width','clearRect','canvas','clear','none','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','VERTEX_SHADER','set','8cRWBpX','enableVertexAttribArray','width','NEAREST','6264840cmUPyJ','slice','uniform2f','759087mcCXTM','position','webgl','createProgram','compileShader','156ZHUKZC','RGBA','texParameteri','getUniformLocation','bufferData','getAttribLocation','getItem','arrayBuffer','uniform1f','TRIANGLE_STRIP','toLowerCase','viewport','TEXTURE_2D','createShader','1175870ITPevs','bindBuffer','attachShader','webgl_full','590821yOSgCH','_temperature','createBuffer','FRAGMENT_SHADER','imageSmoothingEnabled','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','./src/lut/lut64_','843177LCoGao','TEXTURE_MIN_FILTER','ARRAY_BUFFER','linkProgram','STATIC_DRAW','createTexture','UNSIGNED_BYTE','putImageData','getContext','46792YeXgYV'];a0_0x5f45=function(){return _0x505d4c;};return a0_0x5f45();}function setup2DContext(){const _0x36130a=a0_0x52f4;ctx2d=bufferCanvas[_0x36130a(0x1ef)]('2d'),ctx2d[_0x36130a(0x1e4)]=![];}async function renderPixel(_0x1d7b41){const _0x58a5c0=a0_0x52f4,_0x497188=a0_0x321051['getPixelData']();if(!_0x497188)return;await loadLUT64();const _0x42e83e=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x31ac6c=0x0;_0x31ac6c<gameHeight;_0x31ac6c++){for(let _0x641809=0x0;_0x641809<gameWidth;_0x641809++){const _0x13ec1b=_0x31ac6c*gameStride+_0x641809,_0x70c2f2=(_0x31ac6c*gameWidth+_0x641809)*0x4,_0x4c05d6=_0x497188[_0x13ec1b];if(lut64Profile===_0x58a5c0(0x201))_0x42e83e[_0x70c2f2]=_0x4c05d6&0xff,_0x42e83e[_0x70c2f2+0x1]=_0x4c05d6>>0x8&0xff,_0x42e83e[_0x70c2f2+0x2]=_0x4c05d6>>0x10&0xff,_0x42e83e[_0x70c2f2+0x3]=0xff;else{const _0x21691f=(_0x4c05d6&0xff)>>0x2,_0x2ec6ca=(_0x4c05d6>>0x8&0xff)>>0x2,_0x20b1f8=(_0x4c05d6>>0x10&0xff)>>0x2,_0x15a753=(_0x21691f*0x40*0x40+_0x2ec6ca*0x40+_0x20b1f8)*0x3;_0x42e83e[_0x70c2f2]=lut64[_0x15a753],_0x42e83e[_0x70c2f2+0x1]=lut64[_0x15a753+0x1],_0x42e83e[_0x70c2f2+0x2]=lut64[_0x15a753+0x2],_0x42e83e[_0x70c2f2+0x3]=0xff;}}}if(_0x1d7b41===_0x58a5c0(0x20e))gl['texImage2D'](gl[_0x58a5c0(0x1da)],0x0,gl[_0x58a5c0(0x1cf)],gameWidth,gameHeight,0x0,gl[_0x58a5c0(0x1cf)],gl[_0x58a5c0(0x1ed)],_0x42e83e),gl[_0x58a5c0(0x200)](gl['COLOR_BUFFER_BIT']),gl['drawArrays'](gl[_0x58a5c0(0x1d7)],0x0,0x4);else _0x1d7b41==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x42e83e,gameWidth,gameHeight):imageDataObj['data'][_0x58a5c0(0x204)](_0x42e83e),ctx2d[_0x58a5c0(0x1fe)](0x0,0x0,bufferCanvas[_0x58a5c0(0x207)],bufferCanvas[_0x58a5c0(0x1f8)]),ctx2d[_0x58a5c0(0x1ee)](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x1d7b41));}export async function switchRenderMode(_0x1854fa){const _0x735e35=a0_0x52f4;systemType=gameName[_0x735e35(0x20a)](-0x3);if(_0x1854fa==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x1854fa===_0x735e35(0x20e))setupStyle('2d'),setupWebGL_Shader('webgl'),setupTexture_Buffer(_0x735e35(0x20e)),renderPixel(_0x735e35(0x20e));else _0x1854fa==='webgl_full'&&(setupStyle(_0x735e35(0x1df)),setupWebGL_Shader(_0x735e35(0x1df)),setupTexture_Buffer(_0x735e35(0x1df)),renderPixel(_0x735e35(0x20e)));}}