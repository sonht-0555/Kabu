const a0_0x213399=a0_0x4b63;(function(_0xdd0ed1,_0x545ae9){const _0x36fb35=a0_0x4b63,_0x117630=_0xdd0ed1();while(!![]){try{const _0x502bdc=-parseInt(_0x36fb35(0x1b3))/0x1+parseInt(_0x36fb35(0x1b1))/0x2*(-parseInt(_0x36fb35(0x194))/0x3)+parseInt(_0x36fb35(0x196))/0x4+-parseInt(_0x36fb35(0x1aa))/0x5+-parseInt(_0x36fb35(0x19d))/0x6*(-parseInt(_0x36fb35(0x198))/0x7)+parseInt(_0x36fb35(0x1b0))/0x8+parseInt(_0x36fb35(0x1dc))/0x9*(-parseInt(_0x36fb35(0x1af))/0xa);if(_0x502bdc===_0x545ae9)break;else _0x117630['push'](_0x117630['shift']());}catch(_0x43effd){_0x117630['push'](_0x117630['shift']());}}}(a0_0x3e21,0x1ca75));import*as a0_0x188884 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x213399(0x1e0)]('textured'),bufferCanvas=document[a0_0x213399(0x1e0)](a0_0x213399(0x19a)),canvasContainer=document[a0_0x213399(0x1e0)](a0_0x213399(0x1ed)),imgShader=document['getElementById'](a0_0x213399(0x1b2)),settingContainer=document[a0_0x213399(0x1a1)]('.setting-container'),messageContainer=document['querySelectorAll'](a0_0x213399(0x1e5)),stateTitle=document[a0_0x213399(0x1a1)](a0_0x213399(0x1d0));async function loadLUT64(){const _0x47efa6=a0_0x213399;systemType=gameName[_0x47efa6(0x1ba)](-0x3);const _0x46c2c5=localStorage[_0x47efa6(0x1cb)](gameName+_0x47efa6(0x1a3))||_0x47efa6(0x1e1),_0x4b3329=(localStorage[_0x47efa6(0x1cb)](gameName+_0x47efa6(0x1ea))||_0x47efa6(0x1dd))['toLowerCase']();if(!lut64||lut64Streng!==_0x46c2c5||lut64Profile!==_0x4b3329){const _0x39cccc=_0x47efa6(0x19c)+_0x4b3329+'_'+_0x46c2c5+_0x47efa6(0x1db);console[_0x47efa6(0x197)](_0x39cccc);const _0x5e8f83=await fetch(_0x39cccc),_0x245038=await _0x5e8f83[_0x47efa6(0x1ef)]();lut64=new Uint8Array(_0x245038),lut64Streng=_0x46c2c5,lut64Profile=_0x4b3329;}}async function loadShaderSource(_0x1680be){const _0x4f1bd2=a0_0x213399,_0x193d74=await fetch(_0x1680be);return await _0x193d74[_0x4f1bd2(0x1a8)]();}function a0_0x3e21(){const _0xf5d1da=['2BIQcCP','img-shader','34917QPgwea','COMPILE_STATUS','FRAGMENT_SHADER','CLAMP_TO_EDGE','screenSize','remove','getUniformLocation','slice','game_size','bindBuffer','viewport','createBuffer','documentElement','UNSIGNED_BYTE','TEXTURE_WRAP_S','addEventListener','compileShader','top\x20center','clientWidth','uniform2f','px\x20','imageRendering','TEXTURE_MAG_FILTER','TRIANGLE_STRIP','getItem','texParameteri','then','getShaderParameter','./src/shaders/vertexShader.glsl','.stateTitle,\x20.stateDate','STATIC_DRAW','setItem','render_size','texImage2D','useProgram','deleteShader','texcoord','transform','smooth_height','uniform1f','.bin','54QVzIFE','warm','floor','width','getElementById','4.0','transformOrigin','NEAREST','height','.message-container','enableVertexAttribArray','WebGL2\x20not\x20supported','TEXTURE_2D','ARRAY_BUFFER','_temperature','0,0,','webgl2','canvas-container','setProperty','arrayBuffer','getContext','smooth_width','style','scale(','shaderSource','598191Ekbbgs','forEach','505568QbmzpT','log','7CwPuJN','RGBA','canvas','TEXTURE_WRAP_T','./src/lut/lut64_','1111686YZGKvN','classList','./src/shaders/fragmentShader.glsl','imageSmoothingEnabled','querySelectorAll','COLOR_BUFFER_BIT','_streng','getAttribLocation','bufferData','error','bindTexture','text','crisp-edges','41280STgVsy','createShader','attachShader','zoom','getPixelData','231970mlLqKv','1499552wKkoMx'];a0_0x3e21=function(){return _0xf5d1da;};return a0_0x3e21();}function setupStyle(_0x166a5a){const _0x440208=a0_0x213399;clientWidth=document[_0x440208(0x1bf)][_0x440208(0x1c5)];const _0x57bb3d=window['devicePixelRatio'];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x440208(0x1de)](clientWidth*_0x57bb3d/gameWidth),localStorage[_0x440208(0x1d2)](_0x440208(0x1b7),_0x440208(0x1eb)+gameWidth*(integerScaling/_0x57bb3d)+','+gameHeight*(integerScaling/_0x57bb3d))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x440208(0x1de)](clientWidth*_0x57bb3d/gameWidth),localStorage['setItem'](_0x440208(0x1b7),_0x440208(0x1eb)+gameWidth*(integerScaling/_0x57bb3d)+','+gameHeight*(integerScaling/_0x57bb3d)));if(_0x166a5a==='2d')bufferCanvas[_0x440208(0x1df)]=gameWidth,bufferCanvas['height']=gameHeight,bufferCanvas[_0x440208(0x191)][_0x440208(0x1ad)]=''+integerScaling/_0x57bb3d,bufferCanvas['style'][_0x440208(0x1c8)]=_0x440208(0x1a9),canvasContainer[_0x440208(0x191)]['width']=gameWidth*(integerScaling/_0x57bb3d)+'px',canvasContainer['style']['height']=gameHeight*(integerScaling/_0x57bb3d)+'px',textured[_0x440208(0x191)][_0x440208(0x1df)]=gameWidth*(integerScaling/_0x57bb3d)+'px',textured['style']['height']=gameHeight*(integerScaling/_0x57bb3d)+'px',imgShader['style'][_0x440208(0x1d8)]=_0x440208(0x192)+integerScaling/_0x57bb3d/upscaleShader+')',settingContainer['forEach'](function(_0x71161e){const _0x491c8b=_0x440208;_0x71161e[_0x491c8b(0x191)][_0x491c8b(0x1df)]=gameWidth*(integerScaling/_0x57bb3d)+'px',_0x71161e[_0x491c8b(0x191)]['height']=gameHeight*(integerScaling/_0x57bb3d)+'px';}),messageContainer[_0x440208(0x195)](function(_0x4b81e2){const _0x44e939=_0x440208;_0x4b81e2[_0x44e939(0x191)]['width']=gameWidth+'px',_0x4b81e2[_0x44e939(0x191)]['height']=gameHeight+'px',_0x4b81e2[_0x44e939(0x191)]['zoom']=''+integerScaling/_0x57bb3d;}),stateTitle[_0x440208(0x195)](function(_0x2a19e9){const _0x21f314=_0x440208;_0x2a19e9[_0x21f314(0x19e)][_0x21f314(0x1b8)]('fefs');});else _0x166a5a===_0x440208(0x1ec)&&(bufferCanvas['width']=clientWidth*upscaleFactor,bufferCanvas[_0x440208(0x1e4)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style']['zoom']=''+0x1/upscaleFactor,bufferCanvas['style']['imageRendering']='',canvasContainer[_0x440208(0x191)][_0x440208(0x1df)]=clientWidth+'px',canvasContainer['style'][_0x440208(0x1e4)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x440208(0x191)][_0x440208(0x1df)]=clientWidth+'px',textured['style'][_0x440208(0x1e4)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x440208(0x191)][_0x440208(0x1d8)]=_0x440208(0x192)+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x3d271b){const _0x43fc42=_0x440208;_0x3d271b[_0x43fc42(0x191)][_0x43fc42(0x1df)]=clientWidth+'px',_0x3d271b[_0x43fc42(0x191)][_0x43fc42(0x1e4)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x440208(0x195)](function(_0x458b1c){const _0x455cfe=_0x440208;_0x458b1c[_0x455cfe(0x191)][_0x455cfe(0x1df)]=gameWidth+'px',_0x458b1c[_0x455cfe(0x191)][_0x455cfe(0x1e4)]=gameHeight+'px',_0x458b1c[_0x455cfe(0x191)][_0x455cfe(0x1ad)]=''+clientWidth/gameWidth;}),stateTitle[_0x440208(0x195)](function(_0x26c1ed){_0x26c1ed['classList']['add']('fefs');}));imgShader[_0x440208(0x191)]['width']=gameWidth*upscaleShader+'px',imgShader[_0x440208(0x191)]['height']=gameHeight*upscaleShader+'px',imgShader['style'][_0x440208(0x1e2)]=_0x440208(0x1c4),imgShader[_0x440208(0x191)][_0x440208(0x1ee)]('--bg-size',upscaleShader+_0x440208(0x1c7)+upscaleShader+'px');}function setupWebGL(){const _0x118ad9=a0_0x213399;gl=bufferCanvas['getContext']('webgl2');if(!gl)return console['error'](_0x118ad9(0x1e7)),null;gl[_0x118ad9(0x1bd)](0x0,0x0,bufferCanvas[_0x118ad9(0x1df)],bufferCanvas['height']);}function createShader(_0x52c935,_0x399222){const _0x1f4818=a0_0x213399,_0x2505b2=gl[_0x1f4818(0x1ab)](_0x52c935);gl[_0x1f4818(0x193)](_0x2505b2,_0x399222),gl[_0x1f4818(0x1c3)](_0x2505b2);if(!gl[_0x1f4818(0x1ce)](_0x2505b2,gl[_0x1f4818(0x1b4)]))return console[_0x1f4818(0x1a6)](gl['getShaderInfoLog'](_0x2505b2)),gl[_0x1f4818(0x1d6)](_0x2505b2),null;return _0x2505b2;}async function setupShaders(){const _0x168759=a0_0x213399,_0x305ee0=await loadShaderSource(_0x168759(0x1cf)),_0x234dc6=await loadShaderSource(_0x168759(0x19f)),_0xa5f5d8=createShader(gl['VERTEX_SHADER'],_0x305ee0),_0x1bcb68=createShader(gl[_0x168759(0x1b5)],_0x234dc6);return program=gl['createProgram'](),gl[_0x168759(0x1ac)](program,_0xa5f5d8),gl[_0x168759(0x1ac)](program,_0x1bcb68),gl['linkProgram'](program),gl[_0x168759(0x1d5)](program),program;}function setupTexture(){const _0xce2045=a0_0x213399;texture=gl['createTexture'](),gl[_0xce2045(0x1a7)](gl[_0xce2045(0x1e8)],texture),gl['texParameteri'](gl['TEXTURE_2D'],gl['TEXTURE_MIN_FILTER'],gl[_0xce2045(0x1e3)]),gl[_0xce2045(0x1cc)](gl[_0xce2045(0x1e8)],gl[_0xce2045(0x1c9)],gl[_0xce2045(0x1e3)]),gl[_0xce2045(0x1cc)](gl['TEXTURE_2D'],gl[_0xce2045(0x1c1)],gl[_0xce2045(0x1b6)]),gl[_0xce2045(0x1cc)](gl[_0xce2045(0x1e8)],gl[_0xce2045(0x19b)],gl[_0xce2045(0x1b6)]),gl[_0xce2045(0x1c6)](gl[_0xce2045(0x1b9)](program,_0xce2045(0x1bb)),gameWidth,gameHeight),gl[_0xce2045(0x1c6)](gl['getUniformLocation'](program,_0xce2045(0x1d3)),gl[_0xce2045(0x19a)][_0xce2045(0x1df)],gl[_0xce2045(0x19a)][_0xce2045(0x1e4)]),gl[_0xce2045(0x1da)](gl['getUniformLocation'](program,_0xce2045(0x190)),gameWidth/gl['canvas'][_0xce2045(0x1df)]),gl['uniform1f'](gl[_0xce2045(0x1b9)](program,_0xce2045(0x1d9)),gameHeight/gl[_0xce2045(0x19a)]['height']);}function a0_0x4b63(_0x24a3ce,_0x1399fe){const _0x3e21e0=a0_0x3e21();return a0_0x4b63=function(_0x4b6312,_0x44c4f1){_0x4b6312=_0x4b6312-0x18f;let _0x3517eb=_0x3e21e0[_0x4b6312];return _0x3517eb;},a0_0x4b63(_0x24a3ce,_0x1399fe);}function setupBuffers(){const _0x5c3d3c=a0_0x213399,_0x28a244=gl[_0x5c3d3c(0x1be)]();gl[_0x5c3d3c(0x1bc)](gl[_0x5c3d3c(0x1e9)],_0x28a244),gl[_0x5c3d3c(0x1a5)](gl[_0x5c3d3c(0x1e9)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x5c3d3c(0x1d1)]);const _0x22a7ab=gl[_0x5c3d3c(0x1a4)](program,'position');gl[_0x5c3d3c(0x1e6)](_0x22a7ab),gl['vertexAttribPointer'](_0x22a7ab,0x2,gl['FLOAT'],![],0x0,0x0);const _0x35b9c8=gl[_0x5c3d3c(0x1be)]();gl[_0x5c3d3c(0x1bc)](gl[_0x5c3d3c(0x1e9)],_0x35b9c8),gl[_0x5c3d3c(0x1a5)](gl[_0x5c3d3c(0x1e9)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']);const _0x2e76fd=gl[_0x5c3d3c(0x1a4)](program,_0x5c3d3c(0x1d7));gl[_0x5c3d3c(0x1e6)](_0x2e76fd),gl['vertexAttribPointer'](_0x2e76fd,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x48f033){const _0x19aa27=a0_0x213399,_0xf2ebb5=a0_0x188884[_0x19aa27(0x1ae)]();if(!_0xf2ebb5)return;await loadLUT64();const _0x2302c9=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x463e05=0x0;_0x463e05<gameHeight;_0x463e05++){for(let _0x2f6feb=0x0;_0x2f6feb<gameWidth;_0x2f6feb++){const _0x4b9374=_0x463e05*gameStride+_0x2f6feb,_0x363093=(_0x463e05*gameWidth+_0x2f6feb)*0x4,_0xacc5ce=_0xf2ebb5[_0x4b9374],_0x1909f7=(_0xacc5ce&0xff)>>0x2,_0x4eed00=(_0xacc5ce>>0x8&0xff)>>0x2,_0x275c22=(_0xacc5ce>>0x10&0xff)>>0x2,_0x5bf2c0=(_0x1909f7*0x40*0x40+_0x4eed00*0x40+_0x275c22)*0x3;_0x2302c9[_0x363093]=lut64[_0x5bf2c0],_0x2302c9[_0x363093+0x1]=lut64[_0x5bf2c0+0x1],_0x2302c9[_0x363093+0x2]=lut64[_0x5bf2c0+0x2],_0x2302c9[_0x363093+0x3]=0xff;}}if(_0x48f033===_0x19aa27(0x1ec))gl[_0x19aa27(0x1a7)](gl[_0x19aa27(0x1e8)],texture),gl[_0x19aa27(0x1d4)](gl[_0x19aa27(0x1e8)],0x0,gl[_0x19aa27(0x199)],gameWidth,gameHeight,0x0,gl[_0x19aa27(0x199)],gl[_0x19aa27(0x1c0)],_0x2302c9),gl['clear'](gl[_0x19aa27(0x1a2)]),gl['drawArrays'](gl[_0x19aa27(0x1ca)],0x0,0x4);else{if(_0x48f033==='2d'){ctx2d=bufferCanvas[_0x19aa27(0x18f)]('2d'),ctx2d[_0x19aa27(0x1a0)]=![];const _0x3c09e9=new ImageData(_0x2302c9,gameWidth,gameHeight);createImageBitmap(_0x3c09e9)[_0x19aa27(0x1cd)](_0x5dbf7e=>{const _0x349586=_0x19aa27;ctx2d['clearRect'](0x0,0x0,bufferCanvas[_0x349586(0x1df)],bufferCanvas[_0x349586(0x1e4)]),ctx2d['drawImage'](_0x5dbf7e,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x48f033));}export async function switchRenderMode(_0x395acc){const _0x1b156e=a0_0x213399;systemType=gameName[_0x1b156e(0x1ba)](-0x3);if(_0x395acc==='2d')setupStyle('2d'),renderPixel('2d');else _0x395acc===_0x1b156e(0x1ec)&&(setupStyle(_0x1b156e(0x1ec)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x1b156e(0x1ec)));}document[a0_0x213399(0x1c2)]('DOMContentLoaded',function(){});