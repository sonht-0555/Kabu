const a0_0x473a0a=a0_0x14cb;(function(_0x58d29a,_0x4c94a7){const _0x1cfcd2=a0_0x14cb,_0x39b774=_0x58d29a();while(!![]){try{const _0x413400=parseInt(_0x1cfcd2(0x127))/0x1*(parseInt(_0x1cfcd2(0xee))/0x2)+-parseInt(_0x1cfcd2(0x113))/0x3+parseInt(_0x1cfcd2(0x109))/0x4+-parseInt(_0x1cfcd2(0x100))/0x5*(-parseInt(_0x1cfcd2(0xf3))/0x6)+parseInt(_0x1cfcd2(0x101))/0x7+-parseInt(_0x1cfcd2(0x11b))/0x8+-parseInt(_0x1cfcd2(0x11d))/0x9;if(_0x413400===_0x4c94a7)break;else _0x39b774['push'](_0x39b774['shift']());}catch(_0x5a5035){_0x39b774['push'](_0x39b774['shift']());}}}(a0_0x4067,0x7ed10));import*as a0_0x2e6dec from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null,lastFrameTime=0x0;function a0_0x14cb(_0x6fc0c5,_0xfa0c7c){const _0x40671b=a0_0x4067();return a0_0x14cb=function(_0x14cb17,_0x211132){_0x14cb17=_0x14cb17-0xed;let _0x515c61=_0x40671b[_0x14cb17];return _0x515c61;},a0_0x14cb(_0x6fc0c5,_0xfa0c7c);}const fps=59.7,frameDuration=0x3e8/fps,textured=document[a0_0x473a0a(0x106)](a0_0x473a0a(0x114)),bufferCanvas=document['getElementById'](a0_0x473a0a(0x146)),canvasContainer=document['getElementById'](a0_0x473a0a(0xf5)),imgShader=document[a0_0x473a0a(0x106)]('img-shader'),settingContainer=document[a0_0x473a0a(0x12f)](a0_0x473a0a(0x12c)),messageContainer=document[a0_0x473a0a(0x12f)]('.message-container'),stateTitle=document[a0_0x473a0a(0x12f)]('.stateTitle,\x20.stateDate');async function loadLUT64(){const _0x223bc9=a0_0x473a0a;systemType=gameName[_0x223bc9(0x141)](-0x3);const _0x50d096=localStorage[_0x223bc9(0x108)](gameName+_0x223bc9(0xfd))||'4.0',_0x4a5697=(localStorage['getItem'](gameName+_0x223bc9(0x148))||_0x223bc9(0x11e))['toLowerCase']();if(!lut64||lut64Streng!==_0x50d096||lut64Profile!==_0x4a5697){const _0x105269=_0x223bc9(0x140)+_0x4a5697+'_'+_0x50d096+_0x223bc9(0x121);console[_0x223bc9(0x132)](_0x105269);const _0x1893b7=await fetch(_0x105269),_0x55807e=await _0x1893b7[_0x223bc9(0x14d)]();lut64=new Uint8Array(_0x55807e),lut64Streng=_0x50d096,lut64Profile=_0x4a5697;}}function a0_0x4067(){const _0x4b9096=['zoom','TEXTURE_MAG_FILTER','0,0,','getContext','1271901PixEEo','textured','game_size','RGBA','FLOAT','useProgram','clear','text','884120ORLaXb','addEventListener','7928631YBfDhb','warm','width','uniform2f','.bin','viewport','transformOrigin','COLOR_BUFFER_BIT','bindTexture','crisp-edges','173064bnfLyD','setItem','VERTEX_SHADER','UNSIGNED_BYTE','gbc','.setting-container','drawArrays','style','querySelectorAll','getAttribLocation','attachShader','log','top\x20center','TEXTURE_WRAP_T','NEAREST','CLAMP_TO_EDGE','shaderSource','TEXTURE_WRAP_S','remove','createProgram','px\x20','scale(','texImage2D','height','TEXTURE_MIN_FILTER','./src/lut/lut64_','slice','getUniformLocation','linkProgram','imageRendering','clientWidth','canvas','classList','_temperature','forEach','documentElement','transform','floor','arrayBuffer','WebGL2\x20not\x20supported','TRIANGLE_STRIP','uniform1f','webgl2','2oFLunL','screenSize','compileShader','createShader','enableVertexAttribArray','792510dEPMOs','TEXTURE_2D','canvas-container','COMPILE_STATUS','clearRect','devicePixelRatio','render_size','position','vertexAttribPointer','add','_streng','bindBuffer','error','35NBAUbd','886305CtiFDE','imageSmoothingEnabled','createBuffer','FRAGMENT_SHADER','then','getElementById','ARRAY_BUFFER','getItem','2842428vSAgeu','STATIC_DRAW','bufferData','drawImage','createTexture','texParameteri'];a0_0x4067=function(){return _0x4b9096;};return a0_0x4067();}async function loadShaderSource(_0x6b2fcf){const _0x23a365=a0_0x473a0a,_0x56e53a=await fetch(_0x6b2fcf);return await _0x56e53a[_0x23a365(0x11a)]();}function setupStyle(_0x302305){const _0x3e4006=a0_0x473a0a;clientWidth=document[_0x3e4006(0x14a)][_0x3e4006(0x145)];const _0x5a7253=window[_0x3e4006(0xf8)];systemType===_0x3e4006(0x12b)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x3e4006(0x14c)](clientWidth*_0x5a7253/gameWidth),localStorage['setItem'](_0x3e4006(0xef),_0x3e4006(0x111)+gameWidth*(integerScaling/_0x5a7253)+','+gameHeight*(integerScaling/_0x5a7253))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x3e4006(0x14c)](clientWidth*_0x5a7253/gameWidth),localStorage[_0x3e4006(0x128)](_0x3e4006(0xef),_0x3e4006(0x111)+gameWidth*(integerScaling/_0x5a7253)+','+gameHeight*(integerScaling/_0x5a7253)));if(_0x302305==='2d')bufferCanvas['width']=gameWidth,bufferCanvas[_0x3e4006(0x13e)]=gameHeight,bufferCanvas['style'][_0x3e4006(0x10f)]=''+integerScaling/_0x5a7253,bufferCanvas['style'][_0x3e4006(0x144)]=_0x3e4006(0x126),canvasContainer[_0x3e4006(0x12e)][_0x3e4006(0x11f)]=gameWidth*(integerScaling/_0x5a7253)+'px',canvasContainer[_0x3e4006(0x12e)][_0x3e4006(0x13e)]=gameHeight*(integerScaling/_0x5a7253)+'px',textured['style'][_0x3e4006(0x11f)]=gameWidth*(integerScaling/_0x5a7253)+'px',textured[_0x3e4006(0x12e)]['height']=gameHeight*(integerScaling/_0x5a7253)+'px',imgShader[_0x3e4006(0x12e)][_0x3e4006(0x14b)]=_0x3e4006(0x13c)+integerScaling/_0x5a7253/upscaleShader+')',settingContainer[_0x3e4006(0x149)](function(_0x3ada0c){const _0x4e19fb=_0x3e4006;_0x3ada0c[_0x4e19fb(0x12e)][_0x4e19fb(0x11f)]=gameWidth*(integerScaling/_0x5a7253)+'px',_0x3ada0c[_0x4e19fb(0x12e)][_0x4e19fb(0x13e)]=gameHeight*(integerScaling/_0x5a7253)+'px';}),messageContainer['forEach'](function(_0x1e503d){const _0x535812=_0x3e4006;_0x1e503d['style'][_0x535812(0x11f)]=gameWidth+'px',_0x1e503d['style'][_0x535812(0x13e)]=gameHeight+'px',_0x1e503d['style'][_0x535812(0x10f)]=''+integerScaling/_0x5a7253;}),stateTitle['forEach'](function(_0x2de7cc){const _0x19448a=_0x3e4006;_0x2de7cc['classList'][_0x19448a(0x139)]('fefs');});else _0x302305==='webgl2'&&(bufferCanvas[_0x3e4006(0x11f)]=clientWidth*upscaleFactor,bufferCanvas[_0x3e4006(0x13e)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x3e4006(0x12e)][_0x3e4006(0x10f)]=''+0x1/upscaleFactor,bufferCanvas['style'][_0x3e4006(0x144)]='',canvasContainer['style'][_0x3e4006(0x11f)]=clientWidth+'px',canvasContainer[_0x3e4006(0x12e)][_0x3e4006(0x13e)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x3e4006(0x12e)][_0x3e4006(0x11f)]=clientWidth+'px',textured[_0x3e4006(0x12e)]['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x3e4006(0x12e)][_0x3e4006(0x14b)]=_0x3e4006(0x13c)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x3e4006(0x149)](function(_0x369e84){const _0x25e2c3=_0x3e4006;_0x369e84[_0x25e2c3(0x12e)][_0x25e2c3(0x11f)]=clientWidth+'px',_0x369e84[_0x25e2c3(0x12e)]['height']=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x3db911){const _0xcce4fe=_0x3e4006;_0x3db911['style'][_0xcce4fe(0x11f)]=gameWidth+'px',_0x3db911[_0xcce4fe(0x12e)]['height']=gameHeight+'px',_0x3db911[_0xcce4fe(0x12e)][_0xcce4fe(0x10f)]=''+clientWidth/gameWidth;}),stateTitle[_0x3e4006(0x149)](function(_0x4f3a8d){const _0x27c53e=_0x3e4006;_0x4f3a8d[_0x27c53e(0x147)][_0x27c53e(0xfc)]('fefs');}));imgShader[_0x3e4006(0x12e)][_0x3e4006(0x11f)]=gameWidth*upscaleShader+'px',imgShader['style'][_0x3e4006(0x13e)]=gameHeight*upscaleShader+'px',imgShader[_0x3e4006(0x12e)][_0x3e4006(0x123)]=_0x3e4006(0x133),imgShader['style']['setProperty']('--bg-size',upscaleShader+_0x3e4006(0x13b)+upscaleShader+'px');}function setupWebGL(){const _0x575972=a0_0x473a0a;gl=bufferCanvas[_0x575972(0x112)](_0x575972(0xed));if(!gl)return console[_0x575972(0xff)](_0x575972(0x14e)),null;gl[_0x575972(0x122)](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x575972(0x13e)]);}function createShader(_0xd8771e,_0xe8cf23){const _0x1d084f=a0_0x473a0a,_0x2454c6=gl[_0x1d084f(0xf1)](_0xd8771e);gl[_0x1d084f(0x137)](_0x2454c6,_0xe8cf23),gl[_0x1d084f(0xf0)](_0x2454c6);if(!gl['getShaderParameter'](_0x2454c6,gl[_0x1d084f(0xf6)]))return console[_0x1d084f(0xff)](gl['getShaderInfoLog'](_0x2454c6)),gl['deleteShader'](_0x2454c6),null;return _0x2454c6;}async function setupShaders(){const _0x2a4e32=a0_0x473a0a,_0x4f2520=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x40b830=await loadShaderSource('./src/shaders/fragmentShader.glsl'),_0x337ef5=createShader(gl[_0x2a4e32(0x129)],_0x4f2520),_0x3be453=createShader(gl[_0x2a4e32(0x104)],_0x40b830);return program=gl[_0x2a4e32(0x13a)](),gl[_0x2a4e32(0x131)](program,_0x337ef5),gl[_0x2a4e32(0x131)](program,_0x3be453),gl[_0x2a4e32(0x143)](program),gl[_0x2a4e32(0x118)](program),program;}function setupTexture(){const _0x17fc06=a0_0x473a0a;texture=gl[_0x17fc06(0x10d)](),gl[_0x17fc06(0x125)](gl[_0x17fc06(0xf4)],texture),gl[_0x17fc06(0x10e)](gl[_0x17fc06(0xf4)],gl[_0x17fc06(0x13f)],gl[_0x17fc06(0x135)]),gl['texParameteri'](gl[_0x17fc06(0xf4)],gl[_0x17fc06(0x110)],gl[_0x17fc06(0x135)]),gl[_0x17fc06(0x10e)](gl[_0x17fc06(0xf4)],gl[_0x17fc06(0x138)],gl[_0x17fc06(0x136)]),gl[_0x17fc06(0x10e)](gl[_0x17fc06(0xf4)],gl[_0x17fc06(0x134)],gl[_0x17fc06(0x136)]),gl['uniform2f'](gl[_0x17fc06(0x142)](program,_0x17fc06(0x115)),gameWidth,gameHeight),gl[_0x17fc06(0x120)](gl[_0x17fc06(0x142)](program,_0x17fc06(0xf9)),gl[_0x17fc06(0x146)][_0x17fc06(0x11f)],gl['canvas'][_0x17fc06(0x13e)]),gl[_0x17fc06(0x150)](gl[_0x17fc06(0x142)](program,'smooth_width'),gameWidth/gl['canvas'][_0x17fc06(0x11f)]),gl[_0x17fc06(0x150)](gl[_0x17fc06(0x142)](program,'smooth_height'),gameHeight/gl['canvas'][_0x17fc06(0x13e)]);}function setupBuffers(){const _0x588a05=a0_0x473a0a,_0x2b6ce2=gl[_0x588a05(0x103)]();gl[_0x588a05(0xfe)](gl[_0x588a05(0x107)],_0x2b6ce2),gl[_0x588a05(0x10b)](gl[_0x588a05(0x107)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl['STATIC_DRAW']);const _0x12a240=gl[_0x588a05(0x130)](program,_0x588a05(0xfa));gl[_0x588a05(0xf2)](_0x12a240),gl[_0x588a05(0xfb)](_0x12a240,0x2,gl[_0x588a05(0x117)],![],0x0,0x0);const _0x5e167f=gl[_0x588a05(0x103)]();gl['bindBuffer'](gl[_0x588a05(0x107)],_0x5e167f),gl[_0x588a05(0x10b)](gl[_0x588a05(0x107)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x588a05(0x10a)]);const _0x371e05=gl['getAttribLocation'](program,'texcoord');gl[_0x588a05(0xf2)](_0x371e05),gl[_0x588a05(0xfb)](_0x371e05,0x2,gl[_0x588a05(0x117)],![],0x0,0x0);}async function renderPixel(_0x1fbf17,_0x53710e){const _0x152417=a0_0x473a0a,_0x53bfa8=_0x53710e-lastFrameTime;if(_0x53bfa8>=frameDuration){const _0x225699=a0_0x2e6dec['getPixelData']();if(!_0x225699)return;await loadLUT64();const _0x35b415=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x48c7a9=0x0;_0x48c7a9<gameHeight;_0x48c7a9++){for(let _0x181faa=0x0;_0x181faa<gameWidth;_0x181faa++){const _0x4371b4=_0x48c7a9*gameStride+_0x181faa,_0x19ce99=(_0x48c7a9*gameWidth+_0x181faa)*0x4,_0x434da5=_0x225699[_0x4371b4],_0x267553=(_0x434da5&0xff)>>0x2,_0x3404b2=(_0x434da5>>0x8&0xff)>>0x2,_0x13dcd8=(_0x434da5>>0x10&0xff)>>0x2,_0x318365=(_0x267553*0x40*0x40+_0x3404b2*0x40+_0x13dcd8)*0x3;_0x35b415[_0x19ce99]=lut64[_0x318365],_0x35b415[_0x19ce99+0x1]=lut64[_0x318365+0x1],_0x35b415[_0x19ce99+0x2]=lut64[_0x318365+0x2],_0x35b415[_0x19ce99+0x3]=0xff;}}if(_0x1fbf17===_0x152417(0xed))gl['bindTexture'](gl[_0x152417(0xf4)],texture),gl[_0x152417(0x13d)](gl[_0x152417(0xf4)],0x0,gl[_0x152417(0x116)],gameWidth,gameHeight,0x0,gl[_0x152417(0x116)],gl[_0x152417(0x12a)],_0x35b415),gl[_0x152417(0x119)](gl[_0x152417(0x124)]),gl[_0x152417(0x12d)](gl[_0x152417(0x14f)],0x0,0x4);else{if(_0x1fbf17==='2d'){ctx2d=bufferCanvas[_0x152417(0x112)]('2d'),ctx2d[_0x152417(0x102)]=![];const _0x446688=new ImageData(_0x35b415,gameWidth,gameHeight);createImageBitmap(_0x446688)[_0x152417(0x105)](_0x1acd3b=>{const _0x351f19=_0x152417;ctx2d[_0x351f19(0xf7)](0x0,0x0,bufferCanvas[_0x351f19(0x11f)],bufferCanvas[_0x351f19(0x13e)]),ctx2d[_0x351f19(0x10c)](_0x1acd3b,0x0,0x0);});}}lastFrameTime=_0x53710e;}requestAnimationFrame(_0xfb3842=>renderPixel(_0x1fbf17,_0xfb3842));}export async function switchRenderMode(_0x1262e6){const _0x38de6b=a0_0x473a0a;systemType=gameName['slice'](-0x3);if(_0x1262e6==='2d')setupStyle('2d'),renderPixel('2d');else _0x1262e6===_0x38de6b(0xed)&&(setupStyle(_0x38de6b(0xed)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x38de6b(0xed)));}document[a0_0x473a0a(0x11c)]('DOMContentLoaded',function(){});