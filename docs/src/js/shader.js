const a0_0x2e15b5=a0_0x1243;(function(_0x60f35a,_0x152ad9){const _0x6a91f7=a0_0x1243,_0x48f67c=_0x60f35a();while(!![]){try{const _0x1838f0=-parseInt(_0x6a91f7(0x234))/0x1+-parseInt(_0x6a91f7(0x208))/0x2*(-parseInt(_0x6a91f7(0x20c))/0x3)+parseInt(_0x6a91f7(0x20f))/0x4+parseInt(_0x6a91f7(0x209))/0x5*(-parseInt(_0x6a91f7(0x245))/0x6)+parseInt(_0x6a91f7(0x239))/0x7*(-parseInt(_0x6a91f7(0x211))/0x8)+parseInt(_0x6a91f7(0x213))/0x9+-parseInt(_0x6a91f7(0x21c))/0xa*(-parseInt(_0x6a91f7(0x1ed))/0xb);if(_0x1838f0===_0x152ad9)break;else _0x48f67c['push'](_0x48f67c['shift']());}catch(_0x5b3f16){_0x48f67c['push'](_0x48f67c['shift']());}}}(a0_0x2ad0,0xdf4da));import*as a0_0x38ba50 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x2e15b5(0x1fb)](a0_0x2e15b5(0x1f2)),bufferCanvas=document[a0_0x2e15b5(0x1fb)]('canvas'),canvasContainer=document[a0_0x2e15b5(0x1fb)](a0_0x2e15b5(0x249)),imgShader=document[a0_0x2e15b5(0x1fb)]('img-shader'),settingContainer=document['querySelectorAll'](a0_0x2e15b5(0x203)),messageContainer=document[a0_0x2e15b5(0x232)](a0_0x2e15b5(0x22a)),stateTitle=document[a0_0x2e15b5(0x232)](a0_0x2e15b5(0x237));async function loadLUT64(){const _0x169f83=a0_0x2e15b5;systemType=gameName['slice'](-0x3);const _0x96eb=localStorage['getItem'](gameName+'_streng')||'4.0',_0x1420b1=(localStorage[_0x169f83(0x22c)](gameName+_0x169f83(0x23c))||_0x169f83(0x227))[_0x169f83(0x22e)]();if(!lut64||lut64Streng!==_0x96eb||lut64Profile!==_0x1420b1){const _0x33eeb2=_0x169f83(0x1fa)+_0x1420b1+'_'+_0x96eb+'.bin';console[_0x169f83(0x1ec)](_0x33eeb2);const _0x5d8ec5=await fetch(_0x33eeb2),_0x50b291=await _0x5d8ec5['arrayBuffer']();lut64=new Uint8Array(_0x50b291),lut64Streng=_0x96eb,lut64Profile=_0x1420b1;}}async function loadShaderSource(_0x2ca000){const _0x3d31f2=a0_0x2e15b5,_0x13c768=await fetch(_0x2ca000);return await _0x13c768[_0x3d31f2(0x1ff)]();}function setupStyle(_0x3384b2){const _0x16ff84=a0_0x2e15b5;clientWidth=document['documentElement']['clientWidth'];const _0x107d9c=window[_0x16ff84(0x241)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x16ff84(0x22b)](clientWidth*_0x107d9c/gameWidth),localStorage[_0x16ff84(0x23d)](_0x16ff84(0x226),_0x16ff84(0x216)+gameWidth*(integerScaling/_0x107d9c)+','+gameHeight*(integerScaling/_0x107d9c))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x16ff84(0x22b)](clientWidth*_0x107d9c/gameWidth),localStorage[_0x16ff84(0x23d)]('screenSize',_0x16ff84(0x216)+gameWidth*(integerScaling/_0x107d9c)+','+gameHeight*(integerScaling/_0x107d9c)));if(_0x3384b2==='2d')bufferCanvas[_0x16ff84(0x235)]=gameWidth,bufferCanvas[_0x16ff84(0x217)]=gameHeight,bufferCanvas['style'][_0x16ff84(0x210)]=''+integerScaling/_0x107d9c,bufferCanvas['style'][_0x16ff84(0x202)]='crisp-edges',canvasContainer[_0x16ff84(0x206)][_0x16ff84(0x235)]=gameWidth*(integerScaling/_0x107d9c)+'px',canvasContainer[_0x16ff84(0x206)][_0x16ff84(0x217)]=gameHeight*(integerScaling/_0x107d9c)+'px',textured[_0x16ff84(0x206)][_0x16ff84(0x235)]=gameWidth*(integerScaling/_0x107d9c)+'px',textured[_0x16ff84(0x206)][_0x16ff84(0x217)]=gameHeight*(integerScaling/_0x107d9c)+'px',imgShader[_0x16ff84(0x206)]['transform']=_0x16ff84(0x204)+integerScaling/_0x107d9c/upscaleShader+')',settingContainer['forEach'](function(_0x1b1125){const _0x1f71ee=_0x16ff84;_0x1b1125['style'][_0x1f71ee(0x235)]=gameWidth*(integerScaling/_0x107d9c)+'px',_0x1b1125[_0x1f71ee(0x206)]['height']=gameHeight*(integerScaling/_0x107d9c)+'px';}),messageContainer['forEach'](function(_0x542c9c){const _0x3e085a=_0x16ff84;_0x542c9c[_0x3e085a(0x206)][_0x3e085a(0x235)]=gameWidth+'px',_0x542c9c[_0x3e085a(0x206)][_0x3e085a(0x217)]=gameHeight+'px',_0x542c9c[_0x3e085a(0x206)][_0x3e085a(0x210)]=''+integerScaling/_0x107d9c;}),stateTitle[_0x16ff84(0x219)](function(_0x4402a2){const _0x19a17b=_0x16ff84;_0x4402a2[_0x19a17b(0x231)][_0x19a17b(0x218)]('fefs');});else _0x3384b2===_0x16ff84(0x20a)&&(bufferCanvas[_0x16ff84(0x235)]=clientWidth*upscaleFactor,bufferCanvas['height']=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style'][_0x16ff84(0x210)]=''+0x1/upscaleFactor,bufferCanvas[_0x16ff84(0x206)]['imageRendering']='',canvasContainer[_0x16ff84(0x206)][_0x16ff84(0x235)]=clientWidth+'px',canvasContainer[_0x16ff84(0x206)][_0x16ff84(0x217)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x16ff84(0x206)][_0x16ff84(0x235)]=clientWidth+'px',textured[_0x16ff84(0x206)][_0x16ff84(0x217)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x16ff84(0x206)][_0x16ff84(0x21e)]=_0x16ff84(0x204)+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x4a049){const _0x4fa7b4=_0x16ff84;_0x4a049[_0x4fa7b4(0x206)][_0x4fa7b4(0x235)]=clientWidth+'px',_0x4a049[_0x4fa7b4(0x206)][_0x4fa7b4(0x217)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x5cc7a5){const _0x394adc=_0x16ff84;_0x5cc7a5[_0x394adc(0x206)][_0x394adc(0x235)]=gameWidth+'px',_0x5cc7a5[_0x394adc(0x206)][_0x394adc(0x217)]=gameHeight+'px',_0x5cc7a5[_0x394adc(0x206)][_0x394adc(0x210)]=''+clientWidth/gameWidth;}),stateTitle['forEach'](function(_0x2a87d0){const _0x36f900=_0x16ff84;_0x2a87d0[_0x36f900(0x231)][_0x36f900(0x21b)](_0x36f900(0x205));}));imgShader[_0x16ff84(0x206)][_0x16ff84(0x235)]=gameWidth*upscaleShader+'px',imgShader[_0x16ff84(0x206)][_0x16ff84(0x217)]=gameHeight*upscaleShader+'px',imgShader[_0x16ff84(0x206)][_0x16ff84(0x1f0)]='top\x20center',imgShader[_0x16ff84(0x206)][_0x16ff84(0x23e)](_0x16ff84(0x240),upscaleShader+_0x16ff84(0x1ee)+upscaleShader+'px');}function setupWebGL(){const _0x2cba6f=a0_0x2e15b5;gl=bufferCanvas[_0x2cba6f(0x1fc)]('webgl2');if(!gl)return console[_0x2cba6f(0x224)](_0x2cba6f(0x222)),null;gl[_0x2cba6f(0x215)](0x0,0x0,bufferCanvas[_0x2cba6f(0x235)],bufferCanvas[_0x2cba6f(0x217)]);}function createShader(_0x2621ef,_0x5168e6){const _0x442328=a0_0x2e15b5,_0x35ebcd=gl[_0x442328(0x242)](_0x2621ef);gl['shaderSource'](_0x35ebcd,_0x5168e6),gl[_0x442328(0x1f6)](_0x35ebcd);if(!gl[_0x442328(0x1fd)](_0x35ebcd,gl[_0x442328(0x223)]))return console[_0x442328(0x224)](gl[_0x442328(0x236)](_0x35ebcd)),gl[_0x442328(0x238)](_0x35ebcd),null;return _0x35ebcd;}function a0_0x1243(_0x5936d4,_0x5856b5){const _0x2ad01a=a0_0x2ad0();return a0_0x1243=function(_0x124378,_0x481752){_0x124378=_0x124378-0x1eb;let _0x491c36=_0x2ad01a[_0x124378];return _0x491c36;},a0_0x1243(_0x5936d4,_0x5856b5);}async function setupShaders(){const _0x5c3271=a0_0x2e15b5,_0x358d54=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x11fceb=await loadShaderSource(_0x5c3271(0x22f)),_0x1542b0=createShader(gl[_0x5c3271(0x248)],_0x358d54),_0x5e8807=createShader(gl[_0x5c3271(0x21f)],_0x11fceb);return program=gl[_0x5c3271(0x1fe)](),gl[_0x5c3271(0x201)](program,_0x1542b0),gl['attachShader'](program,_0x5e8807),gl['linkProgram'](program),gl[_0x5c3271(0x23f)](program),program;}function setupTexture(){const _0x3e2282=a0_0x2e15b5;texture=gl[_0x3e2282(0x207)](),gl['bindTexture'](gl[_0x3e2282(0x23a)],texture),gl['texParameteri'](gl[_0x3e2282(0x23a)],gl[_0x3e2282(0x229)],gl[_0x3e2282(0x221)]),gl[_0x3e2282(0x1f8)](gl[_0x3e2282(0x23a)],gl[_0x3e2282(0x1f9)],gl[_0x3e2282(0x221)]),gl[_0x3e2282(0x1f8)](gl[_0x3e2282(0x23a)],gl['TEXTURE_WRAP_S'],gl['CLAMP_TO_EDGE']),gl[_0x3e2282(0x1f8)](gl['TEXTURE_2D'],gl[_0x3e2282(0x21d)],gl[_0x3e2282(0x214)]),gl[_0x3e2282(0x1f5)](gl['getUniformLocation'](program,_0x3e2282(0x220)),gameWidth,gameHeight),gl[_0x3e2282(0x1f5)](gl[_0x3e2282(0x20d)](program,_0x3e2282(0x1f4)),gl[_0x3e2282(0x200)][_0x3e2282(0x235)],gl[_0x3e2282(0x200)][_0x3e2282(0x217)]),gl[_0x3e2282(0x21a)](gl['getUniformLocation'](program,_0x3e2282(0x247)),gameWidth/gl['canvas'][_0x3e2282(0x235)]),gl[_0x3e2282(0x21a)](gl[_0x3e2282(0x20d)](program,'smooth_height'),gameHeight/gl[_0x3e2282(0x200)][_0x3e2282(0x217)]);}function setupBuffers(){const _0x233352=a0_0x2e15b5,_0x499e1d=gl[_0x233352(0x230)]();gl[_0x233352(0x1f3)](gl[_0x233352(0x233)],_0x499e1d),gl[_0x233352(0x212)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x233352(0x1f7)]);const _0x9a2e0=gl[_0x233352(0x225)](program,'position');gl['enableVertexAttribArray'](_0x9a2e0),gl[_0x233352(0x1ef)](_0x9a2e0,0x2,gl['FLOAT'],![],0x0,0x0);const _0x3f7e7f=gl[_0x233352(0x230)]();gl[_0x233352(0x1f3)](gl[_0x233352(0x233)],_0x3f7e7f),gl['bufferData'](gl[_0x233352(0x233)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x233352(0x1f7)]);const _0x5bc6c3=gl['getAttribLocation'](program,_0x233352(0x20e));gl[_0x233352(0x244)](_0x5bc6c3),gl[_0x233352(0x1ef)](_0x5bc6c3,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x4b92a8){const _0x20ccce=a0_0x2e15b5,_0x35cd50=a0_0x38ba50['getPixelData']();if(!_0x35cd50)return;await loadLUT64();const _0x46e275=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x285ac=0x0;_0x285ac<gameHeight;_0x285ac++){for(let _0x2eae5f=0x0;_0x2eae5f<gameWidth;_0x2eae5f++){const _0x3dd361=_0x285ac*gameStride+_0x2eae5f,_0x5cc257=(_0x285ac*gameWidth+_0x2eae5f)*0x4,_0x369691=_0x35cd50[_0x3dd361],_0x2bbc83=(_0x369691&0xff)>>0x2,_0x5b850d=(_0x369691>>0x8&0xff)>>0x2,_0x21d850=(_0x369691>>0x10&0xff)>>0x2,_0x2cbe26=(_0x2bbc83*0x40*0x40+_0x5b850d*0x40+_0x21d850)*0x3;_0x46e275[_0x5cc257]=lut64[_0x2cbe26],_0x46e275[_0x5cc257+0x1]=lut64[_0x2cbe26+0x1],_0x46e275[_0x5cc257+0x2]=lut64[_0x2cbe26+0x2],_0x46e275[_0x5cc257+0x3]=0xff;}}if(_0x4b92a8==='webgl2')gl[_0x20ccce(0x20b)](gl[_0x20ccce(0x23a)],texture),gl[_0x20ccce(0x228)](gl[_0x20ccce(0x23a)],0x0,gl[_0x20ccce(0x1eb)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x20ccce(0x1f1)],_0x46e275),gl['clear'](gl[_0x20ccce(0x243)]),gl[_0x20ccce(0x22d)](gl['TRIANGLE_STRIP'],0x0,0x4);else{if(_0x4b92a8==='2d'){ctx2d=bufferCanvas[_0x20ccce(0x1fc)]('2d'),ctx2d['imageSmoothingEnabled']=![];const _0x5d4a75=new ImageData(_0x46e275,gameWidth,gameHeight);createImageBitmap(_0x5d4a75)['then'](_0x3c9548=>{const _0x3747b8=_0x20ccce;ctx2d['clearRect'](0x0,0x0,bufferCanvas[_0x3747b8(0x235)],bufferCanvas[_0x3747b8(0x217)]),ctx2d['drawImage'](_0x3c9548,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x4b92a8));}export async function switchRenderMode(_0x5a14bc){const _0x42dd7c=a0_0x2e15b5;systemType=gameName[_0x42dd7c(0x23b)](-0x3);if(_0x5a14bc==='2d')setupStyle('2d'),renderPixel('2d');else _0x5a14bc==='webgl2'&&(setupStyle(_0x42dd7c(0x20a)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel('webgl2'));}document[a0_0x2e15b5(0x246)]('DOMContentLoaded',function(){});function a0_0x2ad0(){const _0x3b719a=['3eQipcv','getUniformLocation','texcoord','5048196ifmpNJ','zoom','8969800TttQHE','bufferData','1553049RDBqJD','CLAMP_TO_EDGE','viewport','0,0,','height','remove','forEach','uniform1f','add','19010xmgNci','TEXTURE_WRAP_T','transform','FRAGMENT_SHADER','game_size','NEAREST','WebGL2\x20not\x20supported','COMPILE_STATUS','error','getAttribLocation','screenSize','warm','texImage2D','TEXTURE_MIN_FILTER','.message-container','floor','getItem','drawArrays','toLowerCase','./src/shaders/fragmentShader.glsl','createBuffer','classList','querySelectorAll','ARRAY_BUFFER','603939JKwyll','width','getShaderInfoLog','.stateTitle,\x20.stateDate','deleteShader','7ZdFwZT','TEXTURE_2D','slice','_temperature','setItem','setProperty','useProgram','--bg-size','devicePixelRatio','createShader','COLOR_BUFFER_BIT','enableVertexAttribArray','523638BnXeBu','addEventListener','smooth_width','VERTEX_SHADER','canvas-container','RGBA','log','2211niVTWu','px\x20','vertexAttribPointer','transformOrigin','UNSIGNED_BYTE','textured','bindBuffer','render_size','uniform2f','compileShader','STATIC_DRAW','texParameteri','TEXTURE_MAG_FILTER','./src/lut/lut64_','getElementById','getContext','getShaderParameter','createProgram','text','canvas','attachShader','imageRendering','.setting-container','scale(','fefs','style','createTexture','1820752RiENNc','5YavnYI','webgl2','bindTexture'];a0_0x2ad0=function(){return _0x3b719a;};return a0_0x2ad0();}