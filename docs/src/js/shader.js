(function(_0x957c0a,_0x958449){const _0x5717fb=a0_0x2f18,_0x383849=_0x957c0a();while(!![]){try{const _0x37052b=-parseInt(_0x5717fb(0x21b))/0x1+parseInt(_0x5717fb(0x22c))/0x2*(parseInt(_0x5717fb(0x20d))/0x3)+-parseInt(_0x5717fb(0x234))/0x4*(parseInt(_0x5717fb(0x218))/0x5)+parseInt(_0x5717fb(0x1fc))/0x6*(parseInt(_0x5717fb(0x1f8))/0x7)+parseInt(_0x5717fb(0x1f9))/0x8+-parseInt(_0x5717fb(0x1f3))/0x9*(-parseInt(_0x5717fb(0x226))/0xa)+-parseInt(_0x5717fb(0x231))/0xb*(parseInt(_0x5717fb(0x21a))/0xc);if(_0x37052b===_0x958449)break;else _0x383849['push'](_0x383849['shift']());}catch(_0x12f379){_0x383849['push'](_0x383849['shift']());}}}(a0_0x2e4f,0x94e09));import*as a0_0x1aa3f1 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0xdfb53=a0_0x2f18;systemType=gameName[_0xdfb53(0x21f)](-0x3);const _0x315aff=(localStorage[_0xdfb53(0x209)](gameName+_0xdfb53(0x217))||'none')[_0xdfb53(0x1ef)]();if(!lut64||lut64Profile!==_0x315aff){const _0x252571=_0xdfb53(0x222)+_0x315aff+_0xdfb53(0x223);console[_0xdfb53(0x208)](_0x252571);const _0x3347ae=await fetch(_0x252571),_0x4e0246=await _0x3347ae[_0xdfb53(0x1f4)]();lut64=new Uint8Array(_0x4e0246),lut64Profile=_0x315aff;}}function setupWebGL_Shader(_0x16f3a6){const _0x5d572c=a0_0x2f18;gl=bufferCanvas[_0x5d572c(0x1f0)]('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x5d572c(0x211)}),gl[_0x5d572c(0x1f6)](0x0,0x0,bufferCanvas[_0x5d572c(0x213)],bufferCanvas[_0x5d572c(0x212)]);function _0xe6e23f(_0x3c8b39,_0x296a74){const _0x801dec=_0x5d572c,_0x3bf806=gl[_0x801dec(0x216)](_0x3c8b39);return gl['shaderSource'](_0x3bf806,_0x296a74),gl[_0x801dec(0x21d)](_0x3bf806),_0x3bf806;}vs=_0x5d572c(0x1f1);if(_0x16f3a6===_0x5d572c(0x232))fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}';else _0x16f3a6===_0x5d572c(0x204)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x5297f6=_0xe6e23f(gl[_0x5d572c(0x22d)],vs),_0x39e7d9=_0xe6e23f(gl[_0x5d572c(0x215)],fs);return program=gl[_0x5d572c(0x20c)](),gl[_0x5d572c(0x1f2)](program,_0x5297f6),gl[_0x5d572c(0x1f2)](program,_0x39e7d9),gl['linkProgram'](program),gl['useProgram'](program),program;}function a0_0x2f18(_0xfbbc5d,_0x24ae1c){const _0x2e4fec=a0_0x2e4f();return a0_0x2f18=function(_0x2f1840,_0x29564a){_0x2f1840=_0x2f1840-0x1ef;let _0x520289=_0x2e4fec[_0x2f1840];return _0x520289;},a0_0x2f18(_0xfbbc5d,_0x24ae1c);}function setupTexture_Buffer(_0x3a8f80){const _0xa6dcb6=a0_0x2f18;texture=gl[_0xa6dcb6(0x219)](),gl['bindTexture'](gl[_0xa6dcb6(0x22e)],texture),gl[_0xa6dcb6(0x220)](gl[_0xa6dcb6(0x22e)],gl[_0xa6dcb6(0x20f)],gl[_0xa6dcb6(0x207)]),gl['texParameteri'](gl['TEXTURE_2D'],gl[_0xa6dcb6(0x210)],gl[_0xa6dcb6(0x207)]),gl[_0xa6dcb6(0x220)](gl[_0xa6dcb6(0x22e)],gl[_0xa6dcb6(0x205)],gl[_0xa6dcb6(0x1fd)]),gl[_0xa6dcb6(0x220)](gl[_0xa6dcb6(0x22e)],gl['TEXTURE_WRAP_T'],gl[_0xa6dcb6(0x1fd)]);_0x3a8f80===_0xa6dcb6(0x204)&&(gl[_0xa6dcb6(0x21c)](gl[_0xa6dcb6(0x20b)](program,_0xa6dcb6(0x225)),gameWidth,gameHeight),gl[_0xa6dcb6(0x21c)](gl['getUniformLocation'](program,_0xa6dcb6(0x228)),gl[_0xa6dcb6(0x224)]['width'],gl[_0xa6dcb6(0x224)]['height']),gl[_0xa6dcb6(0x22f)](gl['getUniformLocation'](program,'smooth_width'),gameWidth/gl[_0xa6dcb6(0x224)][_0xa6dcb6(0x213)]),gl[_0xa6dcb6(0x22f)](gl[_0xa6dcb6(0x20b)](program,_0xa6dcb6(0x1f5)),gameHeight/gl[_0xa6dcb6(0x224)]['height']));const _0x4b167b=gl['createBuffer']();gl['bindBuffer'](gl[_0xa6dcb6(0x1fa)],_0x4b167b),gl[_0xa6dcb6(0x200)](gl[_0xa6dcb6(0x1fa)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0xa6dcb6(0x1fe)]),gl[_0xa6dcb6(0x1f7)](gl[_0xa6dcb6(0x22a)](program,_0xa6dcb6(0x229)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0xa6dcb6(0x201)](gl['getAttribLocation'](program,_0xa6dcb6(0x229)));const _0x2c058f=gl[_0xa6dcb6(0x20e)]();gl['bindBuffer'](gl[_0xa6dcb6(0x1fa)],_0x2c058f),gl[_0xa6dcb6(0x200)](gl[_0xa6dcb6(0x1fa)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0xa6dcb6(0x1fe)]),gl['vertexAttribPointer'](gl[_0xa6dcb6(0x22a)](program,_0xa6dcb6(0x206)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0xa6dcb6(0x201)](gl[_0xa6dcb6(0x22a)](program,'texcoord'));}function a0_0x2e4f(){const _0x17f10b=['TEXTURE_MIN_FILTER','TEXTURE_MAG_FILTER','low-power','height','width','RGBA','FRAGMENT_SHADER','createShader','_temperature','5qczgQI','createTexture','24IgYEuJ','538410qbZmTJ','uniform2f','compileShader','clearRect','slice','texParameteri','getPixelData','./src/lut/lut64_','_4.0.bin','canvas','game_size','16130YrPEWC','drawArrays','render_size','position','getAttribLocation','none','2jGTPmN','VERTEX_SHADER','TEXTURE_2D','uniform1f','UNSIGNED_BYTE','976019HoAMdN','webgl','texImage2D','2983316taGbUI','toLowerCase','getContext','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','attachShader','459gEZmaH','arrayBuffer','smooth_height','viewport','vertexAttribPointer','63378XjvuXv','8093808XPgNjp','ARRAY_BUFFER','putImageData','522bBoNua','CLAMP_TO_EDGE','STATIC_DRAW','COLOR_BUFFER_BIT','bufferData','enableVertexAttribArray','data','imageSmoothingEnabled','webgl_full','TEXTURE_WRAP_S','texcoord','NEAREST','log','getItem','TRIANGLE_STRIP','getUniformLocation','createProgram','569433YHZKjY','createBuffer'];a0_0x2e4f=function(){return _0x17f10b;};return a0_0x2e4f();}function setup2DContext(){const _0x593b63=a0_0x2f18;ctx2d=bufferCanvas[_0x593b63(0x1f0)]('2d'),ctx2d[_0x593b63(0x203)]=![];}async function renderPixel(_0x1530e7){const _0x2ed7cd=a0_0x2f18,_0x4cdb79=a0_0x1aa3f1[_0x2ed7cd(0x221)]();if(!_0x4cdb79)return;await loadLUT64();const _0xc4dc6e=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0xcd52ec=0x0;_0xcd52ec<gameHeight;_0xcd52ec++){for(let _0x387d78=0x0;_0x387d78<gameWidth;_0x387d78++){const _0x3cd531=_0xcd52ec*gameStride+_0x387d78,_0x1876ae=(_0xcd52ec*gameWidth+_0x387d78)*0x4,_0x27f20c=_0x4cdb79[_0x3cd531];if(lut64Profile===_0x2ed7cd(0x22b))_0xc4dc6e[_0x1876ae]=_0x27f20c&0xff,_0xc4dc6e[_0x1876ae+0x1]=_0x27f20c>>0x8&0xff,_0xc4dc6e[_0x1876ae+0x2]=_0x27f20c>>0x10&0xff,_0xc4dc6e[_0x1876ae+0x3]=0xff;else{const _0x22557e=(_0x27f20c&0xff)>>0x2,_0x39b453=(_0x27f20c>>0x8&0xff)>>0x2,_0x181d72=(_0x27f20c>>0x10&0xff)>>0x2,_0x1c3582=(_0x22557e*0x40*0x40+_0x39b453*0x40+_0x181d72)*0x3;_0xc4dc6e[_0x1876ae]=lut64[_0x1c3582],_0xc4dc6e[_0x1876ae+0x1]=lut64[_0x1c3582+0x1],_0xc4dc6e[_0x1876ae+0x2]=lut64[_0x1c3582+0x2],_0xc4dc6e[_0x1876ae+0x3]=0xff;}}}if(_0x1530e7===_0x2ed7cd(0x232))gl[_0x2ed7cd(0x233)](gl[_0x2ed7cd(0x22e)],0x0,gl[_0x2ed7cd(0x214)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x2ed7cd(0x230)],_0xc4dc6e),gl['clear'](gl[_0x2ed7cd(0x1ff)]),gl[_0x2ed7cd(0x227)](gl[_0x2ed7cd(0x20a)],0x0,0x4);else _0x1530e7==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0xc4dc6e,gameWidth,gameHeight):imageDataObj[_0x2ed7cd(0x202)]['set'](_0xc4dc6e),ctx2d[_0x2ed7cd(0x21e)](0x0,0x0,bufferCanvas[_0x2ed7cd(0x213)],bufferCanvas[_0x2ed7cd(0x212)]),ctx2d[_0x2ed7cd(0x1fb)](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x1530e7));}export async function switchRenderMode(_0x1d075d){const _0x2eb8e0=a0_0x2f18;systemType=gameName[_0x2eb8e0(0x21f)](-0x3);if(_0x1d075d==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x1d075d===_0x2eb8e0(0x232))setupStyle('2d'),setupWebGL_Shader(_0x2eb8e0(0x232)),setupTexture_Buffer('webgl'),renderPixel('webgl');else _0x1d075d==='webgl_full'&&(setupStyle(_0x2eb8e0(0x204)),setupWebGL_Shader(_0x2eb8e0(0x204)),setupTexture_Buffer(_0x2eb8e0(0x204)),renderPixel(_0x2eb8e0(0x232)));}}