const a0_0x53e089=a0_0x40a0;(function(_0x56accf,_0x5b10fa){const _0x123f13=a0_0x40a0,_0x5feaf9=_0x56accf();while(!![]){try{const _0x30491d=-parseInt(_0x123f13(0x1fe))/0x1*(parseInt(_0x123f13(0x1f3))/0x2)+parseInt(_0x123f13(0x206))/0x3+parseInt(_0x123f13(0x1e5))/0x4+parseInt(_0x123f13(0x1e6))/0x5*(parseInt(_0x123f13(0x1fb))/0x6)+parseInt(_0x123f13(0x1e3))/0x7+parseInt(_0x123f13(0x1eb))/0x8*(parseInt(_0x123f13(0x201))/0x9)+-parseInt(_0x123f13(0x1d6))/0xa;if(_0x30491d===_0x5b10fa)break;else _0x5feaf9['push'](_0x5feaf9['shift']());}catch(_0x15ef5a){_0x5feaf9['push'](_0x5feaf9['shift']());}}}(a0_0x54fa,0x5cc2b));import*as a0_0x4b06ec from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x53e089(0x1c5)](a0_0x53e089(0x202)),bufferCanvas=document[a0_0x53e089(0x1c5)](a0_0x53e089(0x1f1)),canvasContainer=document[a0_0x53e089(0x1c5)](a0_0x53e089(0x1e4)),imgShader=document['getElementById'](a0_0x53e089(0x1db)),settingContainer=document[a0_0x53e089(0x1f5)]('.setting-container'),messageContainer=document[a0_0x53e089(0x1f5)](a0_0x53e089(0x1d4)),stateTitle=document['querySelectorAll'](a0_0x53e089(0x216));async function loadLUT64(){const _0x4c6c33=a0_0x53e089;systemType=gameName[_0x4c6c33(0x207)](-0x3);const _0x25b3d0=localStorage[_0x4c6c33(0x1dc)](gameName+'_streng')||_0x4c6c33(0x219),_0x4f6bea=(localStorage[_0x4c6c33(0x1dc)](gameName+_0x4c6c33(0x1c4))||_0x4c6c33(0x1f7))['toLowerCase']();if(!lut64||lut64Streng!==_0x25b3d0||lut64Profile!==_0x4f6bea){const _0x7e68c2='./src/lut/lut64_'+_0x4f6bea+'_'+_0x25b3d0+'.bin';console[_0x4c6c33(0x1c7)](_0x7e68c2);const _0x47d547=await fetch(_0x7e68c2),_0x4ce2c0=await _0x47d547[_0x4c6c33(0x200)]();lut64=new Uint8Array(_0x4ce2c0),lut64Streng=_0x25b3d0,lut64Profile=_0x4f6bea;}}async function loadShaderSource(_0x5da5f8){const _0x22fa9f=a0_0x53e089,_0x24ef7a=await fetch(_0x5da5f8);return await _0x24ef7a[_0x22fa9f(0x203)]();}function setupStyle(_0x5d6a23){const _0x521396=a0_0x53e089;clientWidth=document['documentElement']['clientWidth'];const _0x3ca4cb=window[_0x521396(0x1cb)];systemType===_0x521396(0x1f8)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x521396(0x1d3)](clientWidth*_0x3ca4cb/gameWidth),localStorage['setItem']('screenSize',_0x521396(0x1c1)+gameWidth*(integerScaling/_0x3ca4cb)+','+gameHeight*(integerScaling/_0x3ca4cb))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math['floor'](clientWidth*_0x3ca4cb/gameWidth),localStorage['setItem'](_0x521396(0x1fc),'0,0,'+gameWidth*(integerScaling/_0x3ca4cb)+','+gameHeight*(integerScaling/_0x3ca4cb)));if(_0x5d6a23==='2d')bufferCanvas[_0x521396(0x1d8)]=gameWidth,bufferCanvas['height']=gameHeight,bufferCanvas[_0x521396(0x1df)][_0x521396(0x1f4)]=''+integerScaling/_0x3ca4cb,bufferCanvas[_0x521396(0x1df)]['imageRendering']=_0x521396(0x214),canvasContainer[_0x521396(0x1df)]['width']=gameWidth*(integerScaling/_0x3ca4cb)+'px',canvasContainer['style'][_0x521396(0x205)]=gameHeight*(integerScaling/_0x3ca4cb)+'px',textured['style'][_0x521396(0x1d8)]=gameWidth*(integerScaling/_0x3ca4cb)+'px',textured[_0x521396(0x1df)][_0x521396(0x205)]=gameHeight*(integerScaling/_0x3ca4cb)+'px',imgShader[_0x521396(0x1df)][_0x521396(0x1cf)]='scale('+integerScaling/_0x3ca4cb/upscaleShader+')',settingContainer[_0x521396(0x1c0)](function(_0x789207){const _0x314af3=_0x521396;_0x789207[_0x314af3(0x1df)][_0x314af3(0x1d8)]=gameWidth*(integerScaling/_0x3ca4cb)+'px',_0x789207['style'][_0x314af3(0x205)]=gameHeight*(integerScaling/_0x3ca4cb)+'px';}),messageContainer[_0x521396(0x1c0)](function(_0x214393){const _0xebf559=_0x521396;_0x214393[_0xebf559(0x1df)][_0xebf559(0x1d8)]=gameWidth+'px',_0x214393[_0xebf559(0x1df)][_0xebf559(0x205)]=gameHeight+'px',_0x214393[_0xebf559(0x1df)][_0xebf559(0x1f4)]=''+integerScaling/_0x3ca4cb;}),stateTitle[_0x521396(0x1c0)](function(_0x250817){const _0x43576b=_0x521396;_0x250817['classList']['remove'](_0x43576b(0x1cd));});else _0x5d6a23===_0x521396(0x1ff)&&(bufferCanvas[_0x521396(0x1d8)]=clientWidth*upscaleFactor,bufferCanvas[_0x521396(0x205)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style']['zoom']=''+0x1/upscaleFactor,bufferCanvas[_0x521396(0x1df)][_0x521396(0x20a)]='',canvasContainer['style']['width']=clientWidth+'px',canvasContainer['style'][_0x521396(0x205)]=clientWidth*(gameHeight/gameWidth)+'px',textured['style'][_0x521396(0x1d8)]=clientWidth+'px',textured['style']['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x521396(0x1df)][_0x521396(0x1cf)]=_0x521396(0x20f)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x521396(0x1c0)](function(_0x198eb5){const _0x3b0575=_0x521396;_0x198eb5['style'][_0x3b0575(0x1d8)]=clientWidth+'px',_0x198eb5[_0x3b0575(0x1df)]['height']=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x521396(0x1c0)](function(_0x4d6d83){const _0x418cd7=_0x521396;_0x4d6d83[_0x418cd7(0x1df)][_0x418cd7(0x1d8)]=gameWidth+'px',_0x4d6d83[_0x418cd7(0x1df)][_0x418cd7(0x205)]=gameHeight+'px',_0x4d6d83[_0x418cd7(0x1df)][_0x418cd7(0x1f4)]=''+clientWidth/gameWidth;}),stateTitle['forEach'](function(_0x149e34){const _0x11188d=_0x521396;_0x149e34[_0x11188d(0x20c)][_0x11188d(0x20b)](_0x11188d(0x1cd));}));imgShader['style'][_0x521396(0x1d8)]=gameWidth*upscaleShader+'px',imgShader[_0x521396(0x1df)][_0x521396(0x205)]=gameHeight*upscaleShader+'px',imgShader[_0x521396(0x1df)]['transformOrigin']=_0x521396(0x1d5),imgShader[_0x521396(0x1df)]['setProperty']('--bg-size',upscaleShader+_0x521396(0x1fa)+upscaleShader+'px');}function setupWebGL(){const _0x4d7839=a0_0x53e089;gl=bufferCanvas['getContext'](_0x4d7839(0x1ff));if(!gl)return console[_0x4d7839(0x1f0)]('WebGL2\x20not\x20supported'),null;gl[_0x4d7839(0x217)](0x0,0x0,bufferCanvas[_0x4d7839(0x1d8)],bufferCanvas[_0x4d7839(0x205)]);}function createShader(_0x1dce4a,_0x46b9ed){const _0x654cd=a0_0x53e089,_0x508231=gl[_0x654cd(0x1ce)](_0x1dce4a);gl[_0x654cd(0x1ef)](_0x508231,_0x46b9ed),gl[_0x654cd(0x1c3)](_0x508231);if(!gl[_0x654cd(0x21b)](_0x508231,gl[_0x654cd(0x20d)]))return console[_0x654cd(0x1f0)](gl[_0x654cd(0x1ec)](_0x508231)),gl['deleteShader'](_0x508231),null;return _0x508231;}async function setupShaders(){const _0x4ccae8=a0_0x53e089,_0x53557c=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x2a7de5=await loadShaderSource(_0x4ccae8(0x1ed)),_0x5ce7bf=createShader(gl[_0x4ccae8(0x1dd)],_0x53557c),_0xa2399a=createShader(gl[_0x4ccae8(0x1d9)],_0x2a7de5);return program=gl['createProgram'](),gl[_0x4ccae8(0x204)](program,_0x5ce7bf),gl[_0x4ccae8(0x204)](program,_0xa2399a),gl[_0x4ccae8(0x21a)](program),gl[_0x4ccae8(0x1d7)](program),program;}function a0_0x40a0(_0x5d70fb,_0x3b6723){const _0x54fafc=a0_0x54fa();return a0_0x40a0=function(_0x40a019,_0x8a10d1){_0x40a019=_0x40a019-0x1c0;let _0x52d4de=_0x54fafc[_0x40a019];return _0x52d4de;},a0_0x40a0(_0x5d70fb,_0x3b6723);}function a0_0x54fa(){const _0x43ea4=['gbc','enableVertexAttribArray','px\x20','222NWeAVv','screenSize','createTexture','199UzCbdM','webgl2','arrayBuffer','117cWHlCS','textured','text','attachShader','height','1351572eXJbNV','slice','getAttribLocation','FLOAT','imageRendering','add','classList','COMPILE_STATUS','drawImage','scale(','clear','CLAMP_TO_EDGE','STATIC_DRAW','ARRAY_BUFFER','crisp-edges','createBuffer','.stateTitle,\x20.stateDate','viewport','TEXTURE_WRAP_T','4.0','linkProgram','getShaderParameter','forEach','0,0,','uniform2f','compileShader','_temperature','getElementById','then','log','vertexAttribPointer','game_size','position','devicePixelRatio','imageSmoothingEnabled','fefs','createShader','transform','smooth_height','render_size','TEXTURE_WRAP_S','floor','.message-container','top\x20center','3107790EmlnVo','useProgram','width','FRAGMENT_SHADER','COLOR_BUFFER_BIT','img-shader','getItem','VERTEX_SHADER','bindBuffer','style','clearRect','TEXTURE_2D','getUniformLocation','1702869nPwhMW','canvas-container','983280BmLnXK','31715MkikXT','TEXTURE_MIN_FILTER','uniform1f','bufferData','UNSIGNED_BYTE','53512zBbjoT','getShaderInfoLog','./src/shaders/fragmentShader.glsl','RGBA','shaderSource','error','canvas','texParameteri','5734KTlpBA','zoom','querySelectorAll','bindTexture','warm'];a0_0x54fa=function(){return _0x43ea4;};return a0_0x54fa();}function setupTexture(){const _0xb3a9d6=a0_0x53e089;texture=gl[_0xb3a9d6(0x1fd)](),gl[_0xb3a9d6(0x1f6)](gl['TEXTURE_2D'],texture),gl[_0xb3a9d6(0x1f2)](gl[_0xb3a9d6(0x1e1)],gl[_0xb3a9d6(0x1e7)],gl['NEAREST']),gl[_0xb3a9d6(0x1f2)](gl[_0xb3a9d6(0x1e1)],gl['TEXTURE_MAG_FILTER'],gl['NEAREST']),gl[_0xb3a9d6(0x1f2)](gl[_0xb3a9d6(0x1e1)],gl[_0xb3a9d6(0x1d2)],gl[_0xb3a9d6(0x211)]),gl['texParameteri'](gl[_0xb3a9d6(0x1e1)],gl[_0xb3a9d6(0x218)],gl['CLAMP_TO_EDGE']),gl[_0xb3a9d6(0x1c2)](gl[_0xb3a9d6(0x1e2)](program,_0xb3a9d6(0x1c9)),gameWidth,gameHeight),gl[_0xb3a9d6(0x1c2)](gl[_0xb3a9d6(0x1e2)](program,_0xb3a9d6(0x1d1)),gl[_0xb3a9d6(0x1f1)]['width'],gl[_0xb3a9d6(0x1f1)][_0xb3a9d6(0x205)]),gl[_0xb3a9d6(0x1e8)](gl[_0xb3a9d6(0x1e2)](program,'smooth_width'),gameWidth/gl[_0xb3a9d6(0x1f1)][_0xb3a9d6(0x1d8)]),gl['uniform1f'](gl[_0xb3a9d6(0x1e2)](program,_0xb3a9d6(0x1d0)),gameHeight/gl[_0xb3a9d6(0x1f1)][_0xb3a9d6(0x205)]);}function setupBuffers(){const _0x431837=a0_0x53e089,_0x30ad37=gl[_0x431837(0x215)]();gl[_0x431837(0x1de)](gl[_0x431837(0x213)],_0x30ad37),gl[_0x431837(0x1e9)](gl[_0x431837(0x213)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl['STATIC_DRAW']);const _0x278578=gl['getAttribLocation'](program,_0x431837(0x1ca));gl[_0x431837(0x1f9)](_0x278578),gl[_0x431837(0x1c8)](_0x278578,0x2,gl[_0x431837(0x209)],![],0x0,0x0);const _0x2c294a=gl[_0x431837(0x215)]();gl['bindBuffer'](gl['ARRAY_BUFFER'],_0x2c294a),gl[_0x431837(0x1e9)](gl[_0x431837(0x213)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x431837(0x212)]);const _0x3d5535=gl[_0x431837(0x208)](program,'texcoord');gl[_0x431837(0x1f9)](_0x3d5535),gl[_0x431837(0x1c8)](_0x3d5535,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x5d7d9d){const _0x26f494=a0_0x53e089,_0x329e29=a0_0x4b06ec['getPixelData']();if(!_0x329e29)return;await loadLUT64();const _0x58924d=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x495d0f=0x0;_0x495d0f<gameHeight;_0x495d0f++){for(let _0x860c88=0x0;_0x860c88<gameWidth;_0x860c88++){const _0x5df576=_0x495d0f*gameStride+_0x860c88,_0x721282=(_0x495d0f*gameWidth+_0x860c88)*0x4,_0x138e0a=_0x329e29[_0x5df576],_0x4779db=(_0x138e0a&0xff)>>0x2,_0x1d2388=(_0x138e0a>>0x8&0xff)>>0x2,_0x5771c6=(_0x138e0a>>0x10&0xff)>>0x2,_0x2af7e3=(_0x4779db*0x40*0x40+_0x1d2388*0x40+_0x5771c6)*0x3;_0x58924d[_0x721282]=lut64[_0x2af7e3],_0x58924d[_0x721282+0x1]=lut64[_0x2af7e3+0x1],_0x58924d[_0x721282+0x2]=lut64[_0x2af7e3+0x2],_0x58924d[_0x721282+0x3]=0xff;}}if(_0x5d7d9d===_0x26f494(0x1ff))gl[_0x26f494(0x1f6)](gl['TEXTURE_2D'],texture),gl['texImage2D'](gl['TEXTURE_2D'],0x0,gl[_0x26f494(0x1ee)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x26f494(0x1ea)],_0x58924d),gl[_0x26f494(0x210)](gl[_0x26f494(0x1da)]),gl['drawArrays'](gl['TRIANGLE_STRIP'],0x0,0x4);else{if(_0x5d7d9d==='2d'){ctx2d=bufferCanvas['getContext']('2d'),ctx2d[_0x26f494(0x1cc)]=![];const _0x3539ca=new ImageData(_0x58924d,gameWidth,gameHeight);createImageBitmap(_0x3539ca)[_0x26f494(0x1c6)](_0x1e9181=>{const _0x2babc5=_0x26f494;ctx2d[_0x2babc5(0x1e0)](0x0,0x0,bufferCanvas[_0x2babc5(0x1d8)],bufferCanvas[_0x2babc5(0x205)]),ctx2d[_0x2babc5(0x20e)](_0x1e9181,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x5d7d9d));}export async function switchRenderMode(_0x35274f){const _0x54fd65=a0_0x53e089;systemType=gameName[_0x54fd65(0x207)](-0x3);if(_0x35274f==='2d')setupStyle('2d'),renderPixel('2d');else _0x35274f===_0x54fd65(0x1ff)&&(setupStyle(_0x54fd65(0x1ff)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel('webgl2'));}document['addEventListener']('DOMContentLoaded',function(){});