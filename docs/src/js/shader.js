(function(_0x2c2248,_0x2a2fb3){const _0x3e10ca=a0_0xdcb5,_0x313ef1=_0x2c2248();while(!![]){try{const _0x163c1e=-parseInt(_0x3e10ca(0x94))/0x1*(parseInt(_0x3e10ca(0xbc))/0x2)+parseInt(_0x3e10ca(0xce))/0x3+parseInt(_0x3e10ca(0x97))/0x4+parseInt(_0x3e10ca(0xaf))/0x5*(-parseInt(_0x3e10ca(0xda))/0x6)+-parseInt(_0x3e10ca(0x9c))/0x7*(-parseInt(_0x3e10ca(0xba))/0x8)+-parseInt(_0x3e10ca(0xad))/0x9+-parseInt(_0x3e10ca(0xc0))/0xa*(-parseInt(_0x3e10ca(0x9b))/0xb);if(_0x163c1e===_0x2a2fb3)break;else _0x313ef1['push'](_0x313ef1['shift']());}catch(_0x14c7bc){_0x313ef1['push'](_0x313ef1['shift']());}}}(a0_0x4817,0x6bbd6));import*as a0_0x7072e2 from'./main.js';function a0_0xdcb5(_0x12f631,_0x3b9579){const _0x4817ed=a0_0x4817();return a0_0xdcb5=function(_0xdcb506,_0x26fb7d){_0xdcb506=_0xdcb506-0x92;let _0x2e58e1=_0x4817ed[_0xdcb506];return _0x2e58e1;},a0_0xdcb5(_0x12f631,_0x3b9579);}let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x5092cd=a0_0xdcb5;systemType=gameName['slice'](-0x3);const _0x487374=localStorage[_0x5092cd(0xa0)](gameName+_0x5092cd(0xd1))||_0x5092cd(0xd8),_0x23da20=(localStorage[_0x5092cd(0xa0)](gameName+_0x5092cd(0xb0))||_0x5092cd(0xcf))[_0x5092cd(0xb5)]();if(!lut64||lut64Streng!==_0x487374||lut64Profile!==_0x23da20){const _0x12845b=_0x5092cd(0xa1)+_0x23da20+'_'+_0x487374+'.bin';console[_0x5092cd(0x9d)](_0x12845b);const _0x3fc0ea=await fetch(_0x12845b),_0x4f5b1d=await _0x3fc0ea[_0x5092cd(0x99)]();lut64=new Uint8Array(_0x4f5b1d),lut64Streng=_0x487374,lut64Profile=_0x23da20;}}function setupWebGL_Shader(_0x348b68){const _0x2ff014=a0_0xdcb5;gl=bufferCanvas['getContext'](_0x2ff014(0xd0),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x2ff014(0xa9)}),gl[_0x2ff014(0xb8)](0x0,0x0,bufferCanvas[_0x2ff014(0xd7)],bufferCanvas[_0x2ff014(0xc3)]);function _0x2e8d74(_0x116a8c,_0x627eb2){const _0x298a9f=_0x2ff014,_0x462438=gl[_0x298a9f(0xca)](_0x116a8c);return gl[_0x298a9f(0xcc)](_0x462438,_0x627eb2),gl[_0x298a9f(0x96)](_0x462438),_0x462438;}vs='attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}';if(_0x348b68==='webgl')fs=_0x2ff014(0xb1);else _0x348b68==='webgl_full'&&(fs=_0x2ff014(0xd9));const _0x2e4c37=_0x2e8d74(gl[_0x2ff014(0xac)],vs),_0x2beeca=_0x2e8d74(gl[_0x2ff014(0xcb)],fs);return program=gl['createProgram'](),gl[_0x2ff014(0xbe)](program,_0x2e4c37),gl['attachShader'](program,_0x2beeca),gl[_0x2ff014(0xae)](program),gl[_0x2ff014(0xa8)](program),program;}function setupTexture_Buffer(_0x36f81b){const _0x18eff7=a0_0xdcb5;texture=gl['createTexture'](),gl[_0x18eff7(0x9e)](gl[_0x18eff7(0xa2)],texture),gl[_0x18eff7(0x93)](gl[_0x18eff7(0xa2)],gl[_0x18eff7(0xd5)],gl[_0x18eff7(0x98)]),gl[_0x18eff7(0x93)](gl[_0x18eff7(0xa2)],gl[_0x18eff7(0xcd)],gl[_0x18eff7(0x98)]),gl['texParameteri'](gl[_0x18eff7(0xa2)],gl[_0x18eff7(0xb6)],gl[_0x18eff7(0xc2)]),gl['texParameteri'](gl[_0x18eff7(0xa2)],gl[_0x18eff7(0xb9)],gl[_0x18eff7(0xc2)]);_0x36f81b===_0x18eff7(0xd4)&&(gl[_0x18eff7(0xb2)](gl[_0x18eff7(0xc7)](program,_0x18eff7(0xa7)),gameWidth,gameHeight),gl[_0x18eff7(0xb2)](gl[_0x18eff7(0xc7)](program,_0x18eff7(0xa6)),gl[_0x18eff7(0xa4)][_0x18eff7(0xd7)],gl['canvas'][_0x18eff7(0xc3)]),gl[_0x18eff7(0xb4)](gl[_0x18eff7(0xc7)](program,'smooth_width'),gameWidth/gl[_0x18eff7(0xa4)][_0x18eff7(0xd7)]),gl[_0x18eff7(0xb4)](gl[_0x18eff7(0xc7)](program,_0x18eff7(0xa5)),gameHeight/gl[_0x18eff7(0xa4)][_0x18eff7(0xc3)]));const _0x277c44=gl[_0x18eff7(0xc1)]();gl[_0x18eff7(0xc5)](gl[_0x18eff7(0xc8)],_0x277c44),gl[_0x18eff7(0xd2)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x18eff7(0xbd)]),gl[_0x18eff7(0xbb)](gl['getAttribLocation'](program,_0x18eff7(0xc9)),0x2,gl[_0x18eff7(0xa3)],![],0x0,0x0),gl[_0x18eff7(0xd6)](gl[_0x18eff7(0xaa)](program,_0x18eff7(0xc9)));const _0x3cf40d=gl[_0x18eff7(0xc1)]();gl[_0x18eff7(0xc5)](gl['ARRAY_BUFFER'],_0x3cf40d),gl[_0x18eff7(0xd2)](gl[_0x18eff7(0xc8)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl['vertexAttribPointer'](gl[_0x18eff7(0xaa)](program,_0x18eff7(0x92)),0x2,gl[_0x18eff7(0xa3)],![],0x0,0x0),gl[_0x18eff7(0xd6)](gl[_0x18eff7(0xaa)](program,'texcoord'));}function a0_0x4817(){const _0x4ffaa7=['texcoord','texParameteri','1isOXmF','0.0','compileShader','189432GrSkNv','NEAREST','arrayBuffer','putImageData','8746694ysxjvP','4101377Levnrf','log','bindTexture','data','getItem','./src/lut/lut64_','TEXTURE_2D','FLOAT','canvas','smooth_height','render_size','game_size','useProgram','low-power','getAttribLocation','getContext','VERTEX_SHADER','7693443lgexHi','linkProgram','4119655VndIKp','_temperature','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','uniform2f','RGBA','uniform1f','toLowerCase','TEXTURE_WRAP_S','texImage2D','viewport','TEXTURE_WRAP_T','8lKOQFl','vertexAttribPointer','102068BZHney','STATIC_DRAW','attachShader','TRIANGLE_STRIP','10jazTMz','createBuffer','CLAMP_TO_EDGE','height','getPixelData','bindBuffer','slice','getUniformLocation','ARRAY_BUFFER','position','createShader','FRAGMENT_SHADER','shaderSource','TEXTURE_MAG_FILTER','2228013aUrXtc','warm','webgl','_streng','bufferData','COLOR_BUFFER_BIT','webgl_full','TEXTURE_MIN_FILTER','enableVertexAttribArray','width','4.0','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','6MEZTjf','drawArrays'];a0_0x4817=function(){return _0x4ffaa7;};return a0_0x4817();}function setup2DContext(){const _0x129f65=a0_0xdcb5;ctx2d=bufferCanvas[_0x129f65(0xab)]('2d'),ctx2d['imageSmoothingEnabled']=![];}async function renderPixel(_0x230c32){const _0x360a3b=a0_0xdcb5,_0x45f524=a0_0x7072e2[_0x360a3b(0xc4)]();if(!_0x45f524)return;await loadLUT64();const _0x103991=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0xe68c3=0x0;_0xe68c3<gameHeight;_0xe68c3++){for(let _0x5c7105=0x0;_0x5c7105<gameWidth;_0x5c7105++){const _0x582abb=_0xe68c3*gameStride+_0x5c7105,_0x20b4f8=(_0xe68c3*gameWidth+_0x5c7105)*0x4,_0x27162b=_0x45f524[_0x582abb];if(lut64Streng===_0x360a3b(0x95))_0x103991[_0x20b4f8]=_0x27162b&0xff,_0x103991[_0x20b4f8+0x1]=_0x27162b>>0x8&0xff,_0x103991[_0x20b4f8+0x2]=_0x27162b>>0x10&0xff,_0x103991[_0x20b4f8+0x3]=0xff;else{const _0x25c5c3=(_0x27162b&0xff)>>0x2,_0x37d764=(_0x27162b>>0x8&0xff)>>0x2,_0x3afdf8=(_0x27162b>>0x10&0xff)>>0x2,_0x258372=(_0x25c5c3*0x40*0x40+_0x37d764*0x40+_0x3afdf8)*0x3;_0x103991[_0x20b4f8]=lut64[_0x258372],_0x103991[_0x20b4f8+0x1]=lut64[_0x258372+0x1],_0x103991[_0x20b4f8+0x2]=lut64[_0x258372+0x2],_0x103991[_0x20b4f8+0x3]=0xff;}}}if(_0x230c32==='webgl')gl[_0x360a3b(0xb7)](gl['TEXTURE_2D'],0x0,gl[_0x360a3b(0xb3)],gameWidth,gameHeight,0x0,gl[_0x360a3b(0xb3)],gl['UNSIGNED_BYTE'],_0x103991),gl['clear'](gl[_0x360a3b(0xd3)]),gl[_0x360a3b(0xdb)](gl[_0x360a3b(0xbf)],0x0,0x4);else _0x230c32==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x103991,gameWidth,gameHeight):imageDataObj[_0x360a3b(0x9f)]['set'](_0x103991),ctx2d['clearRect'](0x0,0x0,bufferCanvas[_0x360a3b(0xd7)],bufferCanvas['height']),ctx2d[_0x360a3b(0x9a)](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x230c32));}export async function switchRenderMode(_0x53d292){const _0x209e28=a0_0xdcb5;systemType=gameName[_0x209e28(0xc6)](-0x3);if(_0x53d292==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x53d292===_0x209e28(0xd0))setupStyle('2d'),setupWebGL_Shader('webgl'),setupTexture_Buffer(_0x209e28(0xd0)),renderPixel(_0x209e28(0xd0));else _0x53d292===_0x209e28(0xd4)&&(setupStyle(_0x209e28(0xd4)),setupWebGL_Shader('webgl_full'),setupTexture_Buffer(_0x209e28(0xd4)),renderPixel(_0x209e28(0xd0)));}}