const a0_0x4351c6=a0_0x3bba;(function(_0x1cba4e,_0x1612db){const _0xf3a747=a0_0x3bba,_0x44ac87=_0x1cba4e();while(!![]){try{const _0x5ce6d1=parseInt(_0xf3a747(0x182))/0x1+-parseInt(_0xf3a747(0x15c))/0x2+-parseInt(_0xf3a747(0x16a))/0x3*(parseInt(_0xf3a747(0x145))/0x4)+parseInt(_0xf3a747(0x161))/0x5*(-parseInt(_0xf3a747(0x13b))/0x6)+-parseInt(_0xf3a747(0x18c))/0x7+-parseInt(_0xf3a747(0x15f))/0x8+parseInt(_0xf3a747(0x142))/0x9;if(_0x5ce6d1===_0x1612db)break;else _0x44ac87['push'](_0x44ac87['shift']());}catch(_0x10b2cf){_0x44ac87['push'](_0x44ac87['shift']());}}}(a0_0x5ed4,0x8fb41));function a0_0x3bba(_0x6efc0c,_0x38a211){const _0x5ed4ce=a0_0x5ed4();return a0_0x3bba=function(_0x3bbaa9,_0x1da640){_0x3bbaa9=_0x3bbaa9-0x12f;let _0x135635=_0x5ed4ce[_0x3bbaa9];return _0x135635;},a0_0x3bba(_0x6efc0c,_0x38a211);}import*as a0_0x2c5211 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x4351c6(0x17c)]('textured'),bufferCanvas=document[a0_0x4351c6(0x17c)](a0_0x4351c6(0x136)),canvasContainer=document['getElementById']('canvas-container'),imgShader=document[a0_0x4351c6(0x17c)](a0_0x4351c6(0x176)),settingContainer=document[a0_0x4351c6(0x170)](a0_0x4351c6(0x157)),messageContainer=document[a0_0x4351c6(0x170)](a0_0x4351c6(0x137)),stateTitle=document[a0_0x4351c6(0x170)](a0_0x4351c6(0x15e));async function loadLUT64(){const _0x4b1311=a0_0x4351c6;systemType=gameName['slice'](-0x3);const _0x305eb4=localStorage[_0x4b1311(0x16f)](gameName+_0x4b1311(0x144))||'4.0',_0x1538f=(localStorage[_0x4b1311(0x16f)](gameName+_0x4b1311(0x178))||_0x4b1311(0x13e))[_0x4b1311(0x143)]();if(!lut64||lut64Streng!==_0x305eb4||lut64Profile!==_0x1538f){const _0x425eb8=_0x4b1311(0x173)+_0x1538f+'_'+_0x305eb4+_0x4b1311(0x13d);console[_0x4b1311(0x158)](_0x425eb8);const _0x2fe33a=await fetch(_0x425eb8),_0x19533d=await _0x2fe33a[_0x4b1311(0x139)]();lut64=new Uint8Array(_0x19533d),lut64Streng=_0x305eb4,lut64Profile=_0x1538f;}}async function loadShaderSource(_0xdc30d6){const _0x478ec3=a0_0x4351c6,_0x21deb4=await fetch(_0xdc30d6);return await _0x21deb4[_0x478ec3(0x164)]();}function setupStyle(_0x5add2b){const _0x41c31d=a0_0x4351c6;clientWidth=document[_0x41c31d(0x140)][_0x41c31d(0x138)];const _0x3c44d9=window[_0x41c31d(0x188)];systemType===_0x41c31d(0x179)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x41c31d(0x150)](clientWidth*_0x3c44d9/gameWidth),localStorage[_0x41c31d(0x17d)]('screenSize',_0x41c31d(0x146)+gameWidth*(integerScaling/_0x3c44d9)+','+gameHeight*(integerScaling/_0x3c44d9))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x41c31d(0x150)](clientWidth*_0x3c44d9/gameWidth),localStorage[_0x41c31d(0x17d)]('screenSize',_0x41c31d(0x146)+gameWidth*(integerScaling/_0x3c44d9)+','+gameHeight*(integerScaling/_0x3c44d9)));if(_0x5add2b==='2d')bufferCanvas[_0x41c31d(0x181)]=gameWidth,bufferCanvas['height']=gameHeight,bufferCanvas[_0x41c31d(0x151)][_0x41c31d(0x187)]=''+integerScaling/_0x3c44d9,bufferCanvas[_0x41c31d(0x151)][_0x41c31d(0x15b)]=_0x41c31d(0x192),canvasContainer[_0x41c31d(0x151)][_0x41c31d(0x181)]=gameWidth*(integerScaling/_0x3c44d9)+'px',canvasContainer[_0x41c31d(0x151)]['height']=gameHeight*(integerScaling/_0x3c44d9)+'px',textured['style'][_0x41c31d(0x181)]=gameWidth*(integerScaling/_0x3c44d9)+'px',textured[_0x41c31d(0x151)][_0x41c31d(0x131)]=gameHeight*(integerScaling/_0x3c44d9)+'px',imgShader[_0x41c31d(0x151)][_0x41c31d(0x189)]='scale('+integerScaling/_0x3c44d9/upscaleShader+')',settingContainer[_0x41c31d(0x16e)](function(_0x176193){const _0x234d7e=_0x41c31d;_0x176193['style']['width']=gameWidth*(integerScaling/_0x3c44d9)+'px',_0x176193[_0x234d7e(0x151)][_0x234d7e(0x131)]=gameHeight*(integerScaling/_0x3c44d9)+'px';}),messageContainer[_0x41c31d(0x16e)](function(_0x235a33){const _0xbb59ce=_0x41c31d;_0x235a33[_0xbb59ce(0x151)][_0xbb59ce(0x181)]=gameWidth+'px',_0x235a33[_0xbb59ce(0x151)][_0xbb59ce(0x131)]=gameHeight+'px',_0x235a33['style'][_0xbb59ce(0x187)]=''+integerScaling/_0x3c44d9;}),stateTitle[_0x41c31d(0x16e)](function(_0x41b23c){const _0x3e03b9=_0x41c31d;_0x41b23c[_0x3e03b9(0x12f)][_0x3e03b9(0x185)]('fefs');});else _0x5add2b===_0x41c31d(0x166)&&(bufferCanvas[_0x41c31d(0x181)]=clientWidth*upscaleFactor,bufferCanvas[_0x41c31d(0x131)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x41c31d(0x151)][_0x41c31d(0x187)]=''+0x1/upscaleFactor,bufferCanvas[_0x41c31d(0x151)][_0x41c31d(0x15b)]='',canvasContainer[_0x41c31d(0x151)][_0x41c31d(0x181)]=clientWidth+'px',canvasContainer['style'][_0x41c31d(0x131)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x41c31d(0x151)][_0x41c31d(0x181)]=clientWidth+'px',textured[_0x41c31d(0x151)][_0x41c31d(0x131)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x41c31d(0x151)]['transform']='scale('+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x1c08c2){const _0x244541=_0x41c31d;_0x1c08c2[_0x244541(0x151)][_0x244541(0x181)]=clientWidth+'px',_0x1c08c2[_0x244541(0x151)][_0x244541(0x131)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x41c31d(0x16e)](function(_0x3b606e){const _0x239e79=_0x41c31d;_0x3b606e[_0x239e79(0x151)]['width']=gameWidth+'px',_0x3b606e[_0x239e79(0x151)][_0x239e79(0x131)]=gameHeight+'px',_0x3b606e[_0x239e79(0x151)]['zoom']=''+clientWidth/gameWidth;}),stateTitle['forEach'](function(_0x54fcee){const _0xcb334b=_0x41c31d;_0x54fcee['classList'][_0xcb334b(0x153)]('fefs');}));imgShader['style'][_0x41c31d(0x181)]=gameWidth*upscaleShader+'px',imgShader['style'][_0x41c31d(0x131)]=gameHeight*upscaleShader+'px',imgShader[_0x41c31d(0x151)][_0x41c31d(0x132)]='top\x20center',imgShader[_0x41c31d(0x151)]['setProperty'](_0x41c31d(0x15a),upscaleShader+'px\x20'+upscaleShader+'px');}function setupWebGL(){const _0x2206f2=a0_0x4351c6;gl=bufferCanvas['getContext'](_0x2206f2(0x166));if(!gl)return console[_0x2206f2(0x167)](_0x2206f2(0x154)),null;gl[_0x2206f2(0x175)](0x0,0x0,bufferCanvas[_0x2206f2(0x181)],bufferCanvas[_0x2206f2(0x131)]);}function createShader(_0x1fe902,_0x215454){const _0x501a87=a0_0x4351c6,_0x565209=gl['createShader'](_0x1fe902);gl['shaderSource'](_0x565209,_0x215454),gl[_0x501a87(0x184)](_0x565209);if(!gl['getShaderParameter'](_0x565209,gl['COMPILE_STATUS']))return console[_0x501a87(0x167)](gl[_0x501a87(0x165)](_0x565209)),gl[_0x501a87(0x18b)](_0x565209),null;return _0x565209;}async function setupShaders(){const _0x493bb2=a0_0x4351c6,_0x1f29de=await loadShaderSource(_0x493bb2(0x17b)),_0x158cbd=await loadShaderSource(_0x493bb2(0x162)),_0x4fa6d1=createShader(gl[_0x493bb2(0x141)],_0x1f29de),_0x4cf24c=createShader(gl['FRAGMENT_SHADER'],_0x158cbd);return program=gl[_0x493bb2(0x15d)](),gl[_0x493bb2(0x16b)](program,_0x4fa6d1),gl[_0x493bb2(0x16b)](program,_0x4cf24c),gl[_0x493bb2(0x17a)](program),gl[_0x493bb2(0x148)](program),program;}function setupTexture(){const _0x9922f7=a0_0x4351c6;texture=gl['createTexture'](),gl[_0x9922f7(0x186)](gl[_0x9922f7(0x14f)],texture),gl[_0x9922f7(0x183)](gl['TEXTURE_2D'],gl[_0x9922f7(0x18d)],gl[_0x9922f7(0x168)]),gl[_0x9922f7(0x183)](gl[_0x9922f7(0x14f)],gl[_0x9922f7(0x17e)],gl[_0x9922f7(0x168)]),gl[_0x9922f7(0x183)](gl[_0x9922f7(0x14f)],gl[_0x9922f7(0x14e)],gl[_0x9922f7(0x13f)]),gl[_0x9922f7(0x183)](gl[_0x9922f7(0x14f)],gl[_0x9922f7(0x149)],gl[_0x9922f7(0x13f)]),gl[_0x9922f7(0x135)](gl[_0x9922f7(0x172)](program,_0x9922f7(0x133)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x9922f7(0x172)](program,_0x9922f7(0x152)),gl[_0x9922f7(0x136)]['width'],gl[_0x9922f7(0x136)][_0x9922f7(0x131)]),gl['uniform1f'](gl[_0x9922f7(0x172)](program,_0x9922f7(0x14c)),gameWidth/gl['canvas'][_0x9922f7(0x181)]),gl[_0x9922f7(0x190)](gl[_0x9922f7(0x172)](program,_0x9922f7(0x17f)),gameHeight/gl[_0x9922f7(0x136)]['height']);}function a0_0x5ed4(){const _0x407748=['floor','style','render_size','add','WebGL2\x20not\x20supported','getAttribLocation','createBuffer','.setting-container','log','UNSIGNED_BYTE','--bg-size','imageRendering','1191358FeMMkW','createProgram','.stateTitle,\x20.stateDate','7318496DnnXOZ','DOMContentLoaded','6570ecEErh','./src/shaders/fragmentShader.glsl','getContext','text','getShaderInfoLog','webgl2','error','NEAREST','enableVertexAttribArray','60183VeNgFa','attachShader','then','clearRect','forEach','getItem','querySelectorAll','position','getUniformLocation','./src/lut/lut64_','slice','viewport','img-shader','getPixelData','_temperature','gbc','linkProgram','./src/shaders/vertexShader.glsl','getElementById','setItem','TEXTURE_MAG_FILTER','smooth_height','texcoord','width','1058306wMUAbY','texParameteri','compileShader','remove','bindTexture','zoom','devicePixelRatio','transform','ARRAY_BUFFER','deleteShader','5799675HItgzG','TEXTURE_MIN_FILTER','STATIC_DRAW','vertexAttribPointer','uniform1f','drawArrays','crisp-edges','classList','addEventListener','height','transformOrigin','game_size','clear','uniform2f','canvas','.message-container','clientWidth','arrayBuffer','COLOR_BUFFER_BIT','4830FfMtDb','FLOAT','.bin','warm','CLAMP_TO_EDGE','documentElement','VERTEX_SHADER','34468506MEQhap','toLowerCase','_streng','180drIQBv','0,0,','bindBuffer','useProgram','TEXTURE_WRAP_T','TRIANGLE_STRIP','bufferData','smooth_width','RGBA','TEXTURE_WRAP_S','TEXTURE_2D'];a0_0x5ed4=function(){return _0x407748;};return a0_0x5ed4();}function setupBuffers(){const _0x3a2cff=a0_0x4351c6,_0xc3f264=gl[_0x3a2cff(0x156)]();gl[_0x3a2cff(0x147)](gl['ARRAY_BUFFER'],_0xc3f264),gl[_0x3a2cff(0x14b)](gl[_0x3a2cff(0x18a)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x3a2cff(0x18e)]);const _0x11864f=gl[_0x3a2cff(0x155)](program,_0x3a2cff(0x171));gl[_0x3a2cff(0x169)](_0x11864f),gl['vertexAttribPointer'](_0x11864f,0x2,gl[_0x3a2cff(0x13c)],![],0x0,0x0);const _0x2328b8=gl['createBuffer']();gl[_0x3a2cff(0x147)](gl[_0x3a2cff(0x18a)],_0x2328b8),gl[_0x3a2cff(0x14b)](gl[_0x3a2cff(0x18a)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x3a2cff(0x18e)]);const _0x5b9d58=gl[_0x3a2cff(0x155)](program,_0x3a2cff(0x180));gl['enableVertexAttribArray'](_0x5b9d58),gl[_0x3a2cff(0x18f)](_0x5b9d58,0x2,gl[_0x3a2cff(0x13c)],![],0x0,0x0);}async function renderPixel(_0x2e364a){const _0xd43e0a=a0_0x4351c6,_0x4354b6=a0_0x2c5211[_0xd43e0a(0x177)]();if(!_0x4354b6)return;await loadLUT64();const _0x330029=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x5421f3=0x0;_0x5421f3<gameHeight;_0x5421f3++){for(let _0x2e4fd1=0x0;_0x2e4fd1<gameWidth;_0x2e4fd1++){const _0x352772=_0x5421f3*gameStride+_0x2e4fd1,_0x45909e=(_0x5421f3*gameWidth+_0x2e4fd1)*0x4,_0x30f62c=_0x4354b6[_0x352772],_0x200941=(_0x30f62c&0xff)>>0x2,_0xcd6cf3=(_0x30f62c>>0x8&0xff)>>0x2,_0x290b9c=(_0x30f62c>>0x10&0xff)>>0x2,_0x375114=(_0x200941*0x40*0x40+_0xcd6cf3*0x40+_0x290b9c)*0x3;_0x330029[_0x45909e]=lut64[_0x375114],_0x330029[_0x45909e+0x1]=lut64[_0x375114+0x1],_0x330029[_0x45909e+0x2]=lut64[_0x375114+0x2],_0x330029[_0x45909e+0x3]=0xff;}}if(_0x2e364a===_0xd43e0a(0x166))gl[_0xd43e0a(0x186)](gl[_0xd43e0a(0x14f)],texture),gl['texImage2D'](gl[_0xd43e0a(0x14f)],0x0,gl[_0xd43e0a(0x14d)],gameWidth,gameHeight,0x0,gl[_0xd43e0a(0x14d)],gl[_0xd43e0a(0x159)],_0x330029),gl[_0xd43e0a(0x134)](gl[_0xd43e0a(0x13a)]),gl[_0xd43e0a(0x191)](gl[_0xd43e0a(0x14a)],0x0,0x4);else{if(_0x2e364a==='2d'){ctx2d=bufferCanvas[_0xd43e0a(0x163)]('2d'),ctx2d['imageSmoothingEnabled']=![];const _0x18dc9a=new ImageData(_0x330029,gameWidth,gameHeight);createImageBitmap(_0x18dc9a)[_0xd43e0a(0x16c)](_0x2668c1=>{const _0x238059=_0xd43e0a;ctx2d[_0x238059(0x16d)](0x0,0x0,bufferCanvas[_0x238059(0x181)],bufferCanvas[_0x238059(0x131)]),ctx2d['drawImage'](_0x2668c1,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x2e364a));}export async function switchRenderMode(_0x2ea934){const _0x3f67fe=a0_0x4351c6;systemType=gameName[_0x3f67fe(0x174)](-0x3);if(_0x2ea934==='2d')setupStyle('2d'),renderPixel('2d');else _0x2ea934==='webgl2'&&(setupStyle(_0x3f67fe(0x166)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel('webgl2'));}document[a0_0x4351c6(0x130)](a0_0x4351c6(0x160),function(){});