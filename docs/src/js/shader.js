const a0_0x292148=a0_0x1db2;(function(_0x524719,_0x2d954e){const _0x41cff9=a0_0x1db2,_0x267832=_0x524719();while(!![]){try{const _0x71148f=parseInt(_0x41cff9(0x126))/0x1+-parseInt(_0x41cff9(0x111))/0x2*(-parseInt(_0x41cff9(0x132))/0x3)+-parseInt(_0x41cff9(0xfb))/0x4*(parseInt(_0x41cff9(0x117))/0x5)+parseInt(_0x41cff9(0x10c))/0x6+parseInt(_0x41cff9(0x11f))/0x7+-parseInt(_0x41cff9(0x104))/0x8*(-parseInt(_0x41cff9(0x118))/0x9)+-parseInt(_0x41cff9(0x106))/0xa*(parseInt(_0x41cff9(0xe3))/0xb);if(_0x71148f===_0x2d954e)break;else _0x267832['push'](_0x267832['shift']());}catch(_0x15722a){_0x267832['push'](_0x267832['shift']());}}}(a0_0x26fa,0x7b77a));import*as a0_0x108e2f from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x292148(0x139)]('textured'),bufferCanvas=document[a0_0x292148(0x139)]('canvas'),canvasContainer=document[a0_0x292148(0x139)](a0_0x292148(0x129)),imgShader=document[a0_0x292148(0x139)]('img-shader'),settingContainer=document[a0_0x292148(0x12b)]('.setting-container'),messageContainer=document[a0_0x292148(0x12b)](a0_0x292148(0xf2)),stateTitle=document[a0_0x292148(0x12b)](a0_0x292148(0xf9));async function loadLUT64(){const _0x59c261=a0_0x292148;systemType=gameName['slice'](-0x3);const _0x34c2df=localStorage[_0x59c261(0xe4)](gameName+_0x59c261(0xe7))||_0x59c261(0x131),_0x25fc04=(localStorage[_0x59c261(0xe4)](gameName+_0x59c261(0xfe))||_0x59c261(0x107))['toLowerCase']();if(!lut64||lut64Streng!==_0x34c2df||lut64Profile!==_0x25fc04){const _0x45e1f2=_0x59c261(0x136)+_0x25fc04+'_'+_0x34c2df+_0x59c261(0x124);console['log'](_0x45e1f2);const _0x597e44=await fetch(_0x45e1f2),_0x5f0067=await _0x597e44[_0x59c261(0x13c)]();lut64=new Uint8Array(_0x5f0067),lut64Streng=_0x34c2df,lut64Profile=_0x25fc04;}}async function loadShaderSource(_0x5e2e75){const _0x1cb1ac=a0_0x292148,_0x5192e1=await fetch(_0x5e2e75);return await _0x5192e1[_0x1cb1ac(0x112)]();}function setupStyle(_0x2a70ba){const _0x502ca8=a0_0x292148;clientWidth=document[_0x502ca8(0xe1)]['clientWidth'];const _0x5810bf=window[_0x502ca8(0xda)];systemType===_0x502ca8(0xf6)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math['floor'](clientWidth*_0x5810bf/gameWidth),localStorage[_0x502ca8(0x115)]('screenSize',_0x502ca8(0xdb)+gameWidth*(integerScaling/_0x5810bf)+','+gameHeight*(integerScaling/_0x5810bf))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x502ca8(0x11d)](clientWidth*_0x5810bf/gameWidth),localStorage[_0x502ca8(0x115)](_0x502ca8(0x11a),'0,0,'+gameWidth*(integerScaling/_0x5810bf)+','+gameHeight*(integerScaling/_0x5810bf)));if(_0x2a70ba==='2d')bufferCanvas[_0x502ca8(0x11e)]=gameWidth,bufferCanvas[_0x502ca8(0x116)]=gameHeight,bufferCanvas[_0x502ca8(0x103)][_0x502ca8(0xdd)]=''+integerScaling/_0x5810bf,bufferCanvas[_0x502ca8(0x103)][_0x502ca8(0xf1)]=_0x502ca8(0x128),canvasContainer[_0x502ca8(0x103)][_0x502ca8(0x11e)]=gameWidth*(integerScaling/_0x5810bf)+'px',canvasContainer[_0x502ca8(0x103)][_0x502ca8(0x116)]=gameHeight*(integerScaling/_0x5810bf)+'px',textured[_0x502ca8(0x103)][_0x502ca8(0x11e)]=gameWidth*(integerScaling/_0x5810bf)+'px',textured['style']['height']=gameHeight*(integerScaling/_0x5810bf)+'px',imgShader[_0x502ca8(0x103)]['transform']=_0x502ca8(0x108)+integerScaling/_0x5810bf/upscaleShader+')',settingContainer['forEach'](function(_0xdbb573){const _0x426904=_0x502ca8;_0xdbb573['style'][_0x426904(0x11e)]=gameWidth*(integerScaling/_0x5810bf)+'px',_0xdbb573['style'][_0x426904(0x116)]=gameHeight*(integerScaling/_0x5810bf)+'px';}),messageContainer[_0x502ca8(0xea)](function(_0x203ccd){const _0x263e5b=_0x502ca8;_0x203ccd[_0x263e5b(0x103)][_0x263e5b(0x11e)]=gameWidth+'px',_0x203ccd['style'][_0x263e5b(0x116)]=gameHeight+'px',_0x203ccd[_0x263e5b(0x103)]['zoom']=''+integerScaling/_0x5810bf;}),stateTitle['forEach'](function(_0x21ba46){const _0x12aecf=_0x502ca8;_0x21ba46[_0x12aecf(0xe5)][_0x12aecf(0xdc)](_0x12aecf(0xf4));});else _0x2a70ba===_0x502ca8(0xfc)&&(bufferCanvas[_0x502ca8(0x11e)]=clientWidth*upscaleFactor,bufferCanvas[_0x502ca8(0x116)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x502ca8(0x103)][_0x502ca8(0xdd)]=''+0x1/upscaleFactor,bufferCanvas[_0x502ca8(0x103)][_0x502ca8(0xf1)]='',canvasContainer[_0x502ca8(0x103)][_0x502ca8(0x11e)]=clientWidth+'px',canvasContainer['style'][_0x502ca8(0x116)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x502ca8(0x103)]['width']=clientWidth+'px',textured[_0x502ca8(0x103)][_0x502ca8(0x116)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x502ca8(0x103)][_0x502ca8(0xe0)]=_0x502ca8(0x108)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x502ca8(0xea)](function(_0x41216c){const _0xf33b3b=_0x502ca8;_0x41216c[_0xf33b3b(0x103)][_0xf33b3b(0x11e)]=clientWidth+'px',_0x41216c['style'][_0xf33b3b(0x116)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x502ca8(0xea)](function(_0x413a9c){const _0x9a99f9=_0x502ca8;_0x413a9c['style']['width']=gameWidth+'px',_0x413a9c[_0x9a99f9(0x103)][_0x9a99f9(0x116)]=gameHeight+'px',_0x413a9c[_0x9a99f9(0x103)][_0x9a99f9(0xdd)]=''+clientWidth/gameWidth;}),stateTitle[_0x502ca8(0xea)](function(_0x12d01a){const _0x2003a2=_0x502ca8;_0x12d01a[_0x2003a2(0xe5)][_0x2003a2(0xe2)]('fefs');}));imgShader[_0x502ca8(0x103)]['width']=gameWidth*upscaleShader+'px',imgShader[_0x502ca8(0x103)][_0x502ca8(0x116)]=gameHeight*upscaleShader+'px',imgShader[_0x502ca8(0x103)][_0x502ca8(0xf0)]=_0x502ca8(0x138),imgShader['style'][_0x502ca8(0x10e)](_0x502ca8(0xf8),upscaleShader+_0x502ca8(0x12e)+upscaleShader+'px');}function setupWebGL(){const _0x6ed3ec=a0_0x292148;gl=bufferCanvas[_0x6ed3ec(0x120)]('webgl2');if(!gl)return console[_0x6ed3ec(0x105)]('WebGL2\x20not\x20supported'),null;gl[_0x6ed3ec(0x110)](0x0,0x0,bufferCanvas[_0x6ed3ec(0x11e)],bufferCanvas[_0x6ed3ec(0x116)]);}function createShader(_0x4c9a29,_0x24b841){const _0x32d401=a0_0x292148,_0x5245e0=gl['createShader'](_0x4c9a29);gl[_0x32d401(0x13a)](_0x5245e0,_0x24b841),gl[_0x32d401(0x114)](_0x5245e0);if(!gl['getShaderParameter'](_0x5245e0,gl[_0x32d401(0x109)]))return console['error'](gl[_0x32d401(0x101)](_0x5245e0)),gl[_0x32d401(0xe9)](_0x5245e0),null;return _0x5245e0;}async function setupShaders(){const _0x445b76=a0_0x292148,_0x480207=await loadShaderSource(_0x445b76(0xf3)),_0x248df5=await loadShaderSource(_0x445b76(0xed)),_0x2a5e92=createShader(gl[_0x445b76(0xfd)],_0x480207),_0x5ee567=createShader(gl[_0x445b76(0xef)],_0x248df5);return program=gl[_0x445b76(0x12d)](),gl[_0x445b76(0xf5)](program,_0x2a5e92),gl[_0x445b76(0xf5)](program,_0x5ee567),gl[_0x445b76(0xf7)](program),gl[_0x445b76(0x125)](program),program;}function setupTexture(){const _0x24e063=a0_0x292148;texture=gl[_0x24e063(0xee)](),gl[_0x24e063(0xeb)](gl['TEXTURE_2D'],texture),gl[_0x24e063(0x121)](gl[_0x24e063(0x13b)],gl[_0x24e063(0x127)],gl['NEAREST']),gl['texParameteri'](gl[_0x24e063(0x13b)],gl[_0x24e063(0xde)],gl[_0x24e063(0x12f)]),gl[_0x24e063(0x121)](gl['TEXTURE_2D'],gl['TEXTURE_WRAP_S'],gl[_0x24e063(0xdf)]),gl['texParameteri'](gl[_0x24e063(0x13b)],gl[_0x24e063(0xff)],gl[_0x24e063(0xdf)]),gl[_0x24e063(0x13f)](gl[_0x24e063(0xec)](program,_0x24e063(0x122)),gameWidth,gameHeight),gl[_0x24e063(0x13f)](gl[_0x24e063(0xec)](program,_0x24e063(0x100)),gl[_0x24e063(0x134)][_0x24e063(0x11e)],gl[_0x24e063(0x134)][_0x24e063(0x116)]),gl[_0x24e063(0x113)](gl[_0x24e063(0xec)](program,_0x24e063(0x13d)),gameWidth/gl[_0x24e063(0x134)][_0x24e063(0x11e)]),gl[_0x24e063(0x113)](gl['getUniformLocation'](program,_0x24e063(0x10b)),gameHeight/gl[_0x24e063(0x134)]['height']);}function setupBuffers(){const _0x6a010=a0_0x292148,_0x4451e0=gl[_0x6a010(0x13e)]();gl['bindBuffer'](gl[_0x6a010(0xe6)],_0x4451e0),gl['bufferData'](gl[_0x6a010(0xe6)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl['STATIC_DRAW']);const _0x5443b5=gl['getAttribLocation'](program,_0x6a010(0x12c));gl[_0x6a010(0x119)](_0x5443b5),gl['vertexAttribPointer'](_0x5443b5,0x2,gl['FLOAT'],![],0x0,0x0);const _0x5c2b67=gl[_0x6a010(0x13e)]();gl[_0x6a010(0x10d)](gl['ARRAY_BUFFER'],_0x5c2b67),gl[_0x6a010(0x11b)](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x6a010(0x11c)]);const _0x3866da=gl['getAttribLocation'](program,_0x6a010(0x135));gl['enableVertexAttribArray'](_0x3866da),gl[_0x6a010(0x130)](_0x3866da,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x226d79){const _0xc94c74=a0_0x292148,_0x37295e=a0_0x108e2f[_0xc94c74(0xe8)]();if(!_0x37295e)return;await loadLUT64();const _0x54b635=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x5b26e7=0x0;_0x5b26e7<gameHeight;_0x5b26e7++){for(let _0x112e65=0x0;_0x112e65<gameWidth;_0x112e65++){const _0x4a00b1=_0x5b26e7*gameStride+_0x112e65,_0x1fa956=(_0x5b26e7*gameWidth+_0x112e65)*0x4,_0x5eceb5=_0x37295e[_0x4a00b1],_0x24344e=(_0x5eceb5&0xff)>>0x2,_0x5e1fbe=(_0x5eceb5>>0x8&0xff)>>0x2,_0x3bab0b=(_0x5eceb5>>0x10&0xff)>>0x2,_0xde2f5a=(_0x24344e*0x40*0x40+_0x5e1fbe*0x40+_0x3bab0b)*0x3;_0x54b635[_0x1fa956]=lut64[_0xde2f5a],_0x54b635[_0x1fa956+0x1]=lut64[_0xde2f5a+0x1],_0x54b635[_0x1fa956+0x2]=lut64[_0xde2f5a+0x2],_0x54b635[_0x1fa956+0x3]=0xff;}}if(_0x226d79===_0xc94c74(0xfc))gl[_0xc94c74(0xeb)](gl[_0xc94c74(0x13b)],texture),gl['texImage2D'](gl[_0xc94c74(0x13b)],0x0,gl[_0xc94c74(0x102)],gameWidth,gameHeight,0x0,gl[_0xc94c74(0x102)],gl[_0xc94c74(0x10a)],_0x54b635),gl[_0xc94c74(0x133)](gl['COLOR_BUFFER_BIT']),gl['drawArrays'](gl['TRIANGLE_STRIP'],0x0,0x4);else{if(_0x226d79==='2d'){ctx2d=bufferCanvas['getContext']('2d'),ctx2d[_0xc94c74(0xfa)]=![];const _0x2a7308=new ImageData(_0x54b635,gameWidth,gameHeight);createImageBitmap(_0x2a7308)['then'](_0x78e47d=>{const _0x339671=_0xc94c74;ctx2d[_0x339671(0x10f)](0x0,0x0,bufferCanvas[_0x339671(0x11e)],bufferCanvas['height']),ctx2d['drawImage'](_0x78e47d,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x226d79));}export async function switchRenderMode(_0x2e2da7){const _0x4bb8d1=a0_0x292148;systemType=gameName[_0x4bb8d1(0x123)](-0x3);if(_0x2e2da7==='2d')setupStyle('2d'),renderPixel('2d');else _0x2e2da7===_0x4bb8d1(0xfc)&&(setupStyle(_0x4bb8d1(0xfc)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x4bb8d1(0xfc)));}function a0_0x26fa(){const _0xee1c48=['ARRAY_BUFFER','_streng','getPixelData','deleteShader','forEach','bindTexture','getUniformLocation','./src/shaders/fragmentShader.glsl','createTexture','FRAGMENT_SHADER','transformOrigin','imageRendering','.message-container','./src/shaders/vertexShader.glsl','fefs','attachShader','gbc','linkProgram','--bg-size','.stateTitle,\x20.stateDate','imageSmoothingEnabled','256vUCDXG','webgl2','VERTEX_SHADER','_temperature','TEXTURE_WRAP_T','render_size','getShaderInfoLog','RGBA','style','8PGveuY','error','105180mXzwgE','warm','scale(','COMPILE_STATUS','UNSIGNED_BYTE','smooth_height','1638738Zhusja','bindBuffer','setProperty','clearRect','viewport','4kjgqKc','text','uniform1f','compileShader','setItem','height','57065kVWBrT','1446147YPLGEP','enableVertexAttribArray','screenSize','bufferData','STATIC_DRAW','floor','width','3198692bjUgAx','getContext','texParameteri','game_size','slice','.bin','useProgram','263088YqjfoF','TEXTURE_MIN_FILTER','crisp-edges','canvas-container','DOMContentLoaded','querySelectorAll','position','createProgram','px\x20','NEAREST','vertexAttribPointer','4.0','770313MAYRxd','clear','canvas','texcoord','./src/lut/lut64_','addEventListener','top\x20center','getElementById','shaderSource','TEXTURE_2D','arrayBuffer','smooth_width','createBuffer','uniform2f','devicePixelRatio','0,0,','remove','zoom','TEXTURE_MAG_FILTER','CLAMP_TO_EDGE','transform','documentElement','add','451jzLesq','getItem','classList'];a0_0x26fa=function(){return _0xee1c48;};return a0_0x26fa();}function a0_0x1db2(_0x2bfcab,_0x542111){const _0x26fac7=a0_0x26fa();return a0_0x1db2=function(_0x1db2e9,_0x242db4){_0x1db2e9=_0x1db2e9-0xda;let _0x213573=_0x26fac7[_0x1db2e9];return _0x213573;},a0_0x1db2(_0x2bfcab,_0x542111);}document[a0_0x292148(0x137)](a0_0x292148(0x12a),function(){});