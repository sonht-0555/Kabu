const a0_0x42ef8a=a0_0x4b18;(function(_0x1f8f90,_0x47728e){const _0x52a36f=a0_0x4b18,_0x4b8e3e=_0x1f8f90();while(!![]){try{const _0xa287b8=parseInt(_0x52a36f(0xec))/0x1+-parseInt(_0x52a36f(0xf9))/0x2*(parseInt(_0x52a36f(0xcd))/0x3)+-parseInt(_0x52a36f(0xdc))/0x4+-parseInt(_0x52a36f(0xca))/0x5+-parseInt(_0x52a36f(0xed))/0x6*(-parseInt(_0x52a36f(0xf3))/0x7)+parseInt(_0x52a36f(0xd0))/0x8+parseInt(_0x52a36f(0xa2))/0x9*(parseInt(_0x52a36f(0x9b))/0xa);if(_0xa287b8===_0x47728e)break;else _0x4b8e3e['push'](_0x4b8e3e['shift']());}catch(_0x2befed){_0x4b8e3e['push'](_0x4b8e3e['shift']());}}}(a0_0x28d3,0xc7da2));import*as a0_0x21ddca from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;function a0_0x28d3(){const _0x2b63bc=['8107730itEJml','webgl2','texcoord','1576623eClTdV','remove','data','11881616AokXKp','uniform1f','error','enableVertexAttribArray','compileShader','./src/shaders/fragmentShader.glsl','COLOR_BUFFER_BIT','createBuffer','useProgram','canvas','CLAMP_TO_EDGE','COMPILE_STATUS','349360haQJeC','transform','textured','floor','render_size','querySelectorAll','setItem','createTexture','clear','UNSIGNED_BYTE','imageSmoothingEnabled','ARRAY_BUFFER','createProgram','createShader','fefs','drawImage','1532619nxCayy','11760YrQYDP','linkProgram','bindTexture','slice','--bg-size','getElementById','2541WZjQVA','getPixelData','zoom','classList','set','forEach','6UmFOGv','top\x20center','addEventListener','TEXTURE_MIN_FILTER','imageRendering','text','RGBA','crisp-edges','NEAREST','position','getShaderParameter','game_size','clearRect','30ARPSWd','height','clientWidth','TEXTURE_2D','.setting-container','viewport','getShaderInfoLog','1124406EWVKzs','getContext','getUniformLocation','0,0,','.stateTitle,\x20.stateDate','warm','devicePixelRatio','texImage2D','./src/lut/lut64_','attachShader','FLOAT','DOMContentLoaded','WebGL2\x20not\x20supported','shaderSource','STATIC_DRAW','TEXTURE_MAG_FILTER','./src/shaders/vertexShader.glsl','canvas-container','close','screenSize','texParameteri','VERTEX_SHADER','drawArrays','style','add','_streng','.bin','toLowerCase','smooth_width','scale(','width','setProperty','bindBuffer','transformOrigin','bufferData','vertexAttribPointer','TEXTURE_WRAP_T','uniform2f','TEXTURE_WRAP_S','FRAGMENT_SHADER'];a0_0x28d3=function(){return _0x2b63bc;};return a0_0x28d3();}const textured=document[a0_0x42ef8a(0xf2)](a0_0x42ef8a(0xde)),bufferCanvas=document[a0_0x42ef8a(0xf2)](a0_0x42ef8a(0xd9)),canvasContainer=document[a0_0x42ef8a(0xf2)](a0_0x42ef8a(0xb3)),imgShader=document['getElementById']('img-shader'),settingContainer=document[a0_0x42ef8a(0xe1)](a0_0x42ef8a(0x9f)),messageContainer=document[a0_0x42ef8a(0xe1)]('.message-container'),stateTitle=document[a0_0x42ef8a(0xe1)](a0_0x42ef8a(0xa6));function a0_0x4b18(_0x31bf17,_0x365a81){const _0x28d30b=a0_0x28d3();return a0_0x4b18=function(_0x4b18fb,_0x38dc13){_0x4b18fb=_0x4b18fb-0x95;let _0x1cd99c=_0x28d30b[_0x4b18fb];return _0x1cd99c;},a0_0x4b18(_0x31bf17,_0x365a81);}let imageDataObj=null;const totalPixels=gameWidth*gameHeight,imageData=new Uint8ClampedArray(gameWidth*gameHeight*0x4);let srcIndex=0x0,destIndex=0x0;const pixelData=a0_0x21ddca[a0_0x42ef8a(0xf4)]();async function loadLUT64(){const _0x29f68e=a0_0x42ef8a;systemType=gameName[_0x29f68e(0xf0)](-0x3);const _0x242d31=localStorage['getItem'](gameName+_0x29f68e(0xbb))||'4.0',_0x160a7d=(localStorage['getItem'](gameName+'_temperature')||_0x29f68e(0xa7))[_0x29f68e(0xbd)]();if(!lut64||lut64Streng!==_0x242d31||lut64Profile!==_0x160a7d){const _0x5a13af=_0x29f68e(0xaa)+_0x160a7d+'_'+_0x242d31+_0x29f68e(0xbc);console['log'](_0x5a13af);const _0x4edaf5=await fetch(_0x5a13af),_0x44583b=await _0x4edaf5['arrayBuffer']();lut64=new Uint8Array(_0x44583b),lut64Streng=_0x242d31,lut64Profile=_0x160a7d;}}async function loadShaderSource(_0xf9fd6c){const _0x2cc521=a0_0x42ef8a,_0x51e60c=await fetch(_0xf9fd6c);return await _0x51e60c[_0x2cc521(0xfe)]();}function setupStyle(_0x5500d8){const _0x5ab7bc=a0_0x42ef8a;clientWidth=document['documentElement'][_0x5ab7bc(0x9d)];const _0x4be030=window[_0x5ab7bc(0xa8)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x5ab7bc(0xdf)](clientWidth*_0x4be030/gameWidth),localStorage[_0x5ab7bc(0xe2)](_0x5ab7bc(0xb5),_0x5ab7bc(0xa5)+gameWidth*(integerScaling/_0x4be030)+','+gameHeight*(integerScaling/_0x4be030))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x5ab7bc(0xdf)](clientWidth*_0x4be030/gameWidth),localStorage[_0x5ab7bc(0xe2)](_0x5ab7bc(0xb5),'0,0,'+gameWidth*(integerScaling/_0x4be030)+','+gameHeight*(integerScaling/_0x4be030)));if(_0x5500d8==='2d')bufferCanvas[_0x5ab7bc(0xc0)]=gameWidth,bufferCanvas[_0x5ab7bc(0x9c)]=gameHeight,bufferCanvas[_0x5ab7bc(0xb9)][_0x5ab7bc(0xf5)]=''+integerScaling/_0x4be030,bufferCanvas[_0x5ab7bc(0xb9)]['imageRendering']=_0x5ab7bc(0x95),canvasContainer[_0x5ab7bc(0xb9)][_0x5ab7bc(0xc0)]=gameWidth*(integerScaling/_0x4be030)+'px',canvasContainer[_0x5ab7bc(0xb9)][_0x5ab7bc(0x9c)]=gameHeight*(integerScaling/_0x4be030)+'px',textured[_0x5ab7bc(0xb9)][_0x5ab7bc(0xc0)]=gameWidth*(integerScaling/_0x4be030)+'px',textured[_0x5ab7bc(0xb9)][_0x5ab7bc(0x9c)]=gameHeight*(integerScaling/_0x4be030)+'px',imgShader['style'][_0x5ab7bc(0xdd)]=_0x5ab7bc(0xbf)+integerScaling/_0x4be030/upscaleShader+')',settingContainer[_0x5ab7bc(0xf8)](function(_0x26c58b){const _0x582a95=_0x5ab7bc;_0x26c58b[_0x582a95(0xb9)][_0x582a95(0xc0)]=gameWidth*(integerScaling/_0x4be030)+'px',_0x26c58b[_0x582a95(0xb9)][_0x582a95(0x9c)]=gameHeight*(integerScaling/_0x4be030)+'px';}),messageContainer[_0x5ab7bc(0xf8)](function(_0x15a89d){const _0x5be379=_0x5ab7bc;_0x15a89d['style'][_0x5be379(0xc0)]=gameWidth+'px',_0x15a89d[_0x5be379(0xb9)][_0x5be379(0x9c)]=gameHeight+'px',_0x15a89d[_0x5be379(0xb9)][_0x5be379(0xf5)]=''+integerScaling/_0x4be030;}),stateTitle[_0x5ab7bc(0xf8)](function(_0x49f20b){const _0x559b64=_0x5ab7bc;_0x49f20b[_0x559b64(0xf6)][_0x559b64(0xce)](_0x559b64(0xea));});else _0x5500d8===_0x5ab7bc(0xcb)&&(bufferCanvas[_0x5ab7bc(0xc0)]=clientWidth*upscaleFactor,bufferCanvas[_0x5ab7bc(0x9c)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x5ab7bc(0xb9)]['zoom']=''+0x1/upscaleFactor,bufferCanvas[_0x5ab7bc(0xb9)][_0x5ab7bc(0xfd)]='',canvasContainer[_0x5ab7bc(0xb9)]['width']=clientWidth+'px',canvasContainer[_0x5ab7bc(0xb9)][_0x5ab7bc(0x9c)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x5ab7bc(0xb9)][_0x5ab7bc(0xc0)]=clientWidth+'px',textured[_0x5ab7bc(0xb9)][_0x5ab7bc(0x9c)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x5ab7bc(0xb9)][_0x5ab7bc(0xdd)]='scale('+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x5ab7bc(0xf8)](function(_0xab99ad){const _0x686212=_0x5ab7bc;_0xab99ad[_0x686212(0xb9)]['width']=clientWidth+'px',_0xab99ad[_0x686212(0xb9)]['height']=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x47568d){const _0x590c31=_0x5ab7bc;_0x47568d[_0x590c31(0xb9)][_0x590c31(0xc0)]=gameWidth+'px',_0x47568d[_0x590c31(0xb9)][_0x590c31(0x9c)]=gameHeight+'px',_0x47568d['style'][_0x590c31(0xf5)]=''+clientWidth/gameWidth;}),stateTitle[_0x5ab7bc(0xf8)](function(_0x4224b9){const _0xfd96d4=_0x5ab7bc;_0x4224b9[_0xfd96d4(0xf6)][_0xfd96d4(0xba)](_0xfd96d4(0xea));}));imgShader[_0x5ab7bc(0xb9)][_0x5ab7bc(0xc0)]=gameWidth*upscaleShader+'px',imgShader['style'][_0x5ab7bc(0x9c)]=gameHeight*upscaleShader+'px',imgShader['style'][_0x5ab7bc(0xc3)]=_0x5ab7bc(0xfa),imgShader[_0x5ab7bc(0xb9)][_0x5ab7bc(0xc1)](_0x5ab7bc(0xf1),upscaleShader+'px\x20'+upscaleShader+'px');}function setupWebGL(){const _0x3def5c=a0_0x42ef8a;gl=bufferCanvas['getContext'](_0x3def5c(0xcb));if(!gl)return console[_0x3def5c(0xd2)](_0x3def5c(0xae)),null;gl[_0x3def5c(0xa0)](0x0,0x0,bufferCanvas[_0x3def5c(0xc0)],bufferCanvas['height']);}function createShader(_0x3390d9,_0x54d9b9){const _0x5b6133=a0_0x42ef8a,_0x394130=gl[_0x5b6133(0xe9)](_0x3390d9);gl[_0x5b6133(0xaf)](_0x394130,_0x54d9b9),gl[_0x5b6133(0xd4)](_0x394130);if(!gl[_0x5b6133(0x98)](_0x394130,gl[_0x5b6133(0xdb)]))return console['error'](gl[_0x5b6133(0xa1)](_0x394130)),gl['deleteShader'](_0x394130),null;return _0x394130;}async function setupShaders(){const _0x224df4=a0_0x42ef8a,_0x5e7cdc=await loadShaderSource(_0x224df4(0xb2)),_0x3ff007=await loadShaderSource(_0x224df4(0xd5)),_0x2f40a2=createShader(gl[_0x224df4(0xb7)],_0x5e7cdc),_0x556278=createShader(gl[_0x224df4(0xc9)],_0x3ff007);return program=gl[_0x224df4(0xe8)](),gl[_0x224df4(0xab)](program,_0x2f40a2),gl[_0x224df4(0xab)](program,_0x556278),gl[_0x224df4(0xee)](program),gl[_0x224df4(0xd8)](program),program;}function setupTexture(){const _0x19b15a=a0_0x42ef8a;texture=gl[_0x19b15a(0xe3)](),gl['bindTexture'](gl[_0x19b15a(0x9e)],texture),gl['texParameteri'](gl[_0x19b15a(0x9e)],gl[_0x19b15a(0xfc)],gl[_0x19b15a(0x96)]),gl['texParameteri'](gl[_0x19b15a(0x9e)],gl[_0x19b15a(0xb1)],gl[_0x19b15a(0x96)]),gl[_0x19b15a(0xb6)](gl[_0x19b15a(0x9e)],gl[_0x19b15a(0xc8)],gl[_0x19b15a(0xda)]),gl[_0x19b15a(0xb6)](gl[_0x19b15a(0x9e)],gl[_0x19b15a(0xc6)],gl[_0x19b15a(0xda)]),gl[_0x19b15a(0xc7)](gl['getUniformLocation'](program,_0x19b15a(0x99)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x19b15a(0xa4)](program,_0x19b15a(0xe0)),gl['canvas']['width'],gl['canvas']['height']),gl[_0x19b15a(0xd1)](gl[_0x19b15a(0xa4)](program,_0x19b15a(0xbe)),gameWidth/gl['canvas'][_0x19b15a(0xc0)]),gl[_0x19b15a(0xd1)](gl[_0x19b15a(0xa4)](program,'smooth_height'),gameHeight/gl[_0x19b15a(0xd9)][_0x19b15a(0x9c)]);}function setupBuffers(){const _0x25bada=a0_0x42ef8a,_0x2ba3b1=gl[_0x25bada(0xd7)]();gl[_0x25bada(0xc2)](gl[_0x25bada(0xe7)],_0x2ba3b1),gl[_0x25bada(0xc4)](gl[_0x25bada(0xe7)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x25bada(0xb0)]);const _0x3e7027=gl['getAttribLocation'](program,_0x25bada(0x97));gl[_0x25bada(0xd3)](_0x3e7027),gl[_0x25bada(0xc5)](_0x3e7027,0x2,gl[_0x25bada(0xac)],![],0x0,0x0);const _0x15c6ba=gl[_0x25bada(0xd7)]();gl['bindBuffer'](gl['ARRAY_BUFFER'],_0x15c6ba),gl[_0x25bada(0xc4)](gl[_0x25bada(0xe7)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x25bada(0xb0)]);const _0x279f08=gl['getAttribLocation'](program,_0x25bada(0xcc));gl[_0x25bada(0xd3)](_0x279f08),gl[_0x25bada(0xc5)](_0x279f08,0x2,gl[_0x25bada(0xac)],![],0x0,0x0);}async function renderPixel(_0x2689ef){const _0x5da2c3=a0_0x42ef8a;if(!pixelData)return;await loadLUT64();for(let _0x139054=0x0;_0x139054<totalPixels;_0x139054++){const _0x4b31e8=pixelData[srcIndex++],_0x517b38=_0x4b31e8>>0x2&0x3f,_0xba69b2=_0x4b31e8>>0xa&0x3f,_0x188e69=_0x4b31e8>>0x12&0x3f,_0x8ba0c8=_0x517b38<<0xc|_0xba69b2<<0x6|_0x188e69,_0xc70dd1=(_0x8ba0c8<<0x1)+_0x8ba0c8;imageData[destIndex++]=lut64[_0xc70dd1],imageData[destIndex++]=lut64[_0xc70dd1+0x1],imageData[destIndex++]=lut64[_0xc70dd1+0x2],imageData[destIndex++]=0xff;}if(_0x2689ef===_0x5da2c3(0xcb))gl[_0x5da2c3(0xef)](gl[_0x5da2c3(0x9e)],texture),gl[_0x5da2c3(0xa9)](gl[_0x5da2c3(0x9e)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x5da2c3(0xff)],gl[_0x5da2c3(0xe5)],imageData),gl[_0x5da2c3(0xe4)](gl[_0x5da2c3(0xd6)]),gl[_0x5da2c3(0xb8)](gl['TRIANGLE_STRIP'],0x0,0x4);else _0x2689ef==='2d'&&(!ctx2d&&(ctx2d=bufferCanvas[_0x5da2c3(0xa3)]('2d',{'willReadFrequently':!![]}),ctx2d[_0x5da2c3(0xe6)]=![]),(!imageDataObj||imageDataObj[_0x5da2c3(0xc0)]!==gameWidth||imageDataObj['height']!==gameHeight)&&(imageDataObj=new ImageData(gameWidth,gameHeight)),imageDataObj[_0x5da2c3(0xcf)][_0x5da2c3(0xf7)](imageData),createImageBitmap(imageDataObj)['then'](_0x105357=>{const _0x3dd9ca=_0x5da2c3;ctx2d[_0x3dd9ca(0x9a)](0x0,0x0,bufferCanvas[_0x3dd9ca(0xc0)],bufferCanvas['height']),ctx2d[_0x3dd9ca(0xeb)](_0x105357,0x0,0x0),_0x105357[_0x3dd9ca(0xb4)]();}));requestAnimationFrame(()=>renderPixel(_0x2689ef));}export async function switchRenderMode(_0x4b3da3){const _0x5e7b52=a0_0x42ef8a;systemType=gameName['slice'](-0x3);if(_0x4b3da3==='2d')setupStyle('2d'),renderPixel('2d');else _0x4b3da3===_0x5e7b52(0xcb)&&(setupStyle(_0x5e7b52(0xcb)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x5e7b52(0xcb)));}document[a0_0x42ef8a(0xfb)](a0_0x42ef8a(0xad),function(){});