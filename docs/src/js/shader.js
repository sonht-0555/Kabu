(function(_0x32739d,_0x4152b2){const _0x868a53=a0_0x31ae,_0x347d32=_0x32739d();while(!![]){try{const _0x3f4eb8=parseInt(_0x868a53(0xa8))/0x1*(parseInt(_0x868a53(0xbb))/0x2)+-parseInt(_0x868a53(0xc2))/0x3*(parseInt(_0x868a53(0xc0))/0x4)+-parseInt(_0x868a53(0xa2))/0x5+parseInt(_0x868a53(0xc7))/0x6+-parseInt(_0x868a53(0xb8))/0x7+parseInt(_0x868a53(0xa9))/0x8*(parseInt(_0x868a53(0xa6))/0x9)+-parseInt(_0x868a53(0x9c))/0xa;if(_0x3f4eb8===_0x4152b2)break;else _0x347d32['push'](_0x347d32['shift']());}catch(_0x2373d5){_0x347d32['push'](_0x347d32['shift']());}}}(a0_0x41ee,0x718d2));import*as a0_0x2a6ecb from'./main.js';function a0_0x31ae(_0x305e4c,_0x156f64){const _0x41ee2e=a0_0x41ee();return a0_0x31ae=function(_0x31ae63,_0x376826){_0x31ae63=_0x31ae63-0x88;let _0x210268=_0x41ee2e[_0x31ae63];return _0x210268;},a0_0x31ae(_0x305e4c,_0x156f64);}let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x59044e=a0_0x31ae;systemType=gameName['slice'](-0x3);const _0x386311=localStorage[_0x59044e(0xb2)](gameName+_0x59044e(0xad))||_0x59044e(0xb0),_0x326019=(localStorage[_0x59044e(0xb2)](gameName+_0x59044e(0xb9))||_0x59044e(0xc5))[_0x59044e(0x93)]();if(!lut64||lut64Streng!==_0x386311||lut64Profile!==_0x326019){const _0x57aeb2='./src/lut/lut64_'+_0x326019+'_'+_0x386311+'.bin';console[_0x59044e(0xbe)](_0x57aeb2);const _0x3ca4e2=await fetch(_0x57aeb2),_0x50c0d1=await _0x3ca4e2['arrayBuffer']();lut64=new Uint8Array(_0x50c0d1),lut64Streng=_0x386311,lut64Profile=_0x326019;}}function a0_0x41ee(){const _0x5b91d3=['_streng','VERTEX_SHADER','FRAGMENT_SHADER','4.0','render_size','getItem','CLAMP_TO_EDGE','vertexAttribPointer','getAttribLocation','STATIC_DRAW','TEXTURE_WRAP_S','5335617ycmAJd','_temperature','createProgram','557022NQLFaw','getUniformLocation','COLOR_BUFFER_BIT','log','game_size','8MFOBiK','UNSIGNED_BYTE','506208vPTSQR','TEXTURE_MAG_FILTER','uniform1f','warm','webgl','3917760mnYFmK','texImage2D','NEAREST','ARRAY_BUFFER','canvas','createShader','bindTexture','shaderSource','TEXTURE_WRAP_T','low-power','getContext','height','clearRect','attachShader','toLowerCase','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','width','linkProgram','compileShader','texParameteri','slice','createBuffer','clear','4440330eyUGdz','webgl_full','RGBA','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','createTexture','viewport','1846620RuAqDg','drawArrays','then','drawImage','8007057Snphtd','enableVertexAttribArray','3NNdpix','8uJuwJS','useProgram','bufferData','TEXTURE_2D'];a0_0x41ee=function(){return _0x5b91d3;};return a0_0x41ee();}function setupWebGL_Shader(_0x42cfc4){const _0x327940=a0_0x31ae;gl=bufferCanvas[_0x327940(0x8f)](_0x327940(0xc6),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x327940(0x8e)}),gl[_0x327940(0xa1)](0x0,0x0,bufferCanvas[_0x327940(0x95)],bufferCanvas['height']);function _0x42877c(_0x18a7b7,_0x3bc40f){const _0x836cf6=_0x327940,_0x56b54b=gl[_0x836cf6(0x8a)](_0x18a7b7);return gl[_0x836cf6(0x8c)](_0x56b54b,_0x3bc40f),gl[_0x836cf6(0x97)](_0x56b54b),_0x56b54b;}vs=_0x327940(0x94);if(_0x42cfc4==='webgl')fs=_0x327940(0x9f);else _0x42cfc4===_0x327940(0x9d)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x2c5405=_0x42877c(gl[_0x327940(0xae)],vs),_0x18404b=_0x42877c(gl[_0x327940(0xaf)],fs);return program=gl[_0x327940(0xba)](),gl[_0x327940(0x92)](program,_0x2c5405),gl[_0x327940(0x92)](program,_0x18404b),gl[_0x327940(0x96)](program),gl[_0x327940(0xaa)](program),program;}function setupTexture_Buffer(_0x2bcb2d){const _0x36c517=a0_0x31ae;texture=gl[_0x36c517(0xa0)](),gl[_0x36c517(0x8b)](gl[_0x36c517(0xac)],texture),gl[_0x36c517(0x98)](gl['TEXTURE_2D'],gl['TEXTURE_MIN_FILTER'],gl['NEAREST']),gl[_0x36c517(0x98)](gl[_0x36c517(0xac)],gl[_0x36c517(0xc3)],gl[_0x36c517(0xc9)]),gl[_0x36c517(0x98)](gl[_0x36c517(0xac)],gl[_0x36c517(0xb7)],gl[_0x36c517(0xb3)]),gl[_0x36c517(0x98)](gl[_0x36c517(0xac)],gl[_0x36c517(0x8d)],gl[_0x36c517(0xb3)]);_0x2bcb2d===_0x36c517(0x9d)&&(gl['uniform2f'](gl['getUniformLocation'](program,_0x36c517(0xbf)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x36c517(0xbc)](program,_0x36c517(0xb1)),gl[_0x36c517(0x89)][_0x36c517(0x95)],gl[_0x36c517(0x89)]['height']),gl['uniform1f'](gl[_0x36c517(0xbc)](program,'smooth_width'),gameWidth/gl[_0x36c517(0x89)][_0x36c517(0x95)]),gl[_0x36c517(0xc4)](gl['getUniformLocation'](program,'smooth_height'),gameHeight/gl[_0x36c517(0x89)][_0x36c517(0x90)]));const _0x1e43ec=gl[_0x36c517(0x9a)]();gl['bindBuffer'](gl[_0x36c517(0x88)],_0x1e43ec),gl[_0x36c517(0xab)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x36c517(0xb6)]),gl[_0x36c517(0xb4)](gl[_0x36c517(0xb5)](program,'position'),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x36c517(0xa7)](gl[_0x36c517(0xb5)](program,'position'));const _0x4bec41=gl[_0x36c517(0x9a)]();gl['bindBuffer'](gl[_0x36c517(0x88)],_0x4bec41),gl['bufferData'](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x36c517(0xb6)]),gl[_0x36c517(0xb4)](gl['getAttribLocation'](program,'texcoord'),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x36c517(0xa7)](gl[_0x36c517(0xb5)](program,'texcoord'));}function setup2DContext(){const _0x29feed=a0_0x31ae;ctx2d=bufferCanvas[_0x29feed(0x8f)]('2d'),ctx2d['imageSmoothingEnabled']=![];}async function renderPixel(_0x399e28){const _0x31572f=a0_0x31ae,_0x3aa023=a0_0x2a6ecb['getPixelData']();if(!_0x3aa023)return;await loadLUT64();const _0x4a9f26=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x4b4007=0x0;_0x4b4007<gameHeight;_0x4b4007++){for(let _0x49dbbc=0x0;_0x49dbbc<gameWidth;_0x49dbbc++){const _0x33b860=_0x4b4007*gameStride+_0x49dbbc,_0x4136f5=(_0x4b4007*gameWidth+_0x49dbbc)*0x4,_0x17e581=_0x3aa023[_0x33b860],_0x1b7daa=(_0x17e581&0xff)>>0x2,_0x310088=(_0x17e581>>0x8&0xff)>>0x2,_0x5d0c22=(_0x17e581>>0x10&0xff)>>0x2,_0x629bac=(_0x1b7daa*0x40*0x40+_0x310088*0x40+_0x5d0c22)*0x3;_0x4a9f26[_0x4136f5]=lut64[_0x629bac],_0x4a9f26[_0x4136f5+0x1]=lut64[_0x629bac+0x1],_0x4a9f26[_0x4136f5+0x2]=lut64[_0x629bac+0x2],_0x4a9f26[_0x4136f5+0x3]=0xff;}}if(_0x399e28==='webgl')gl[_0x31572f(0xc8)](gl['TEXTURE_2D'],0x0,gl[_0x31572f(0x9e)],gameWidth,gameHeight,0x0,gl[_0x31572f(0x9e)],gl[_0x31572f(0xc1)],_0x4a9f26),gl[_0x31572f(0x9b)](gl[_0x31572f(0xbd)]),gl[_0x31572f(0xa3)](gl['TRIANGLE_STRIP'],0x0,0x4);else _0x399e28==='2d'&&(imageDataObj=new ImageData(_0x4a9f26,gameWidth,gameHeight),createImageBitmap(imageDataObj)[_0x31572f(0xa4)](_0x3cdbc6=>{const _0x142d06=_0x31572f;ctx2d[_0x142d06(0x91)](0x0,0x0,bufferCanvas[_0x142d06(0x95)],bufferCanvas[_0x142d06(0x90)]),ctx2d[_0x142d06(0xa5)](_0x3cdbc6,0x0,0x0);}));requestAnimationFrame(()=>renderPixel(_0x399e28));}export async function switchRenderMode(_0x49b238){const _0x83df90=a0_0x31ae;systemType=gameName[_0x83df90(0x99)](-0x3);if(_0x49b238==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x49b238===_0x83df90(0xc6))setupStyle('2d'),setupWebGL_Shader(_0x83df90(0xc6)),setupTexture_Buffer('webgl'),renderPixel(_0x83df90(0xc6));else _0x49b238===_0x83df90(0x9d)&&(setupStyle(_0x83df90(0x9d)),setupWebGL_Shader(_0x83df90(0x9d)),setupTexture_Buffer(_0x83df90(0x9d)),renderPixel(_0x83df90(0xc6)));}}