(function(_0x4e2a88,_0x27363f){const _0x306872=a0_0x5450,_0x1c068c=_0x4e2a88();while(!![]){try{const _0xccd406=-parseInt(_0x306872(0xf8))/0x1+-parseInt(_0x306872(0x11f))/0x2*(-parseInt(_0x306872(0xe5))/0x3)+-parseInt(_0x306872(0xf0))/0x4*(parseInt(_0x306872(0x109))/0x5)+parseInt(_0x306872(0x121))/0x6+-parseInt(_0x306872(0x104))/0x7+parseInt(_0x306872(0xfb))/0x8*(parseInt(_0x306872(0x10c))/0x9)+parseInt(_0x306872(0x105))/0xa;if(_0xccd406===_0x27363f)break;else _0x1c068c['push'](_0x1c068c['shift']());}catch(_0x439816){_0x1c068c['push'](_0x1c068c['shift']());}}}(a0_0x2f2f,0x20af6));import*as a0_0x466ac0 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;function a0_0x2f2f(){const _0xf6979c=['compileShader','ARRAY_BUFFER','78425kJLTHT','none','getContext','689373DsvKTf','TEXTURE_WRAP_S','slice','height','FLOAT','drawArrays','FRAGMENT_SHADER','log','CLAMP_TO_EDGE','getUniformLocation','texParameteri','texcoord','canvas','STATIC_DRAW','UNSIGNED_BYTE','clear','bufferData','TEXTURE_MIN_FILTER','COLOR_BUFFER_BIT','584hobEnn','createProgram','1371528HURVxm','createShader','createBuffer','uniform2f','./src/lut/lut64_','data','webgl_full','low-power','arrayBuffer','1779RbVcvr','shaderSource','game_size','width','NEAREST','TEXTURE_MAG_FILTER','attachShader','RGBA','createTexture','position','bindTexture','28DrRBHr','VERTEX_SHADER','vertexAttribPointer','toLowerCase','webgl','texImage2D','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','getAttribLocation','176095ALKVIL','_4.0.bin','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','24SiGGmX','smooth_width','uniform1f','TEXTURE_WRAP_T','TEXTURE_2D','clearRect','linkProgram','enableVertexAttribArray','getItem','1736035gGjWjp','362380lyPqey','bindBuffer'];a0_0x2f2f=function(){return _0xf6979c;};return a0_0x2f2f();}async function loadLUT64(){const _0x42d776=a0_0x5450;systemType=gameName[_0x42d776(0x10e)](-0x3);const _0x119470=(localStorage[_0x42d776(0x103)](gameName+'_temperature')||_0x42d776(0x10a))[_0x42d776(0xf3)]();if(!lut64||lut64Profile!==_0x119470){const _0x105562=_0x42d776(0x125)+_0x119470+_0x42d776(0xf9);console[_0x42d776(0x113)](_0x105562);const _0x12eff2=await fetch(_0x105562),_0x19d7de=await _0x12eff2[_0x42d776(0x129)]();lut64=new Uint8Array(_0x19d7de),lut64Profile=_0x119470;}}function setupWebGL_Shader(_0x2f2211){const _0x305f5a=a0_0x5450;gl=bufferCanvas[_0x305f5a(0x10b)]('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x305f5a(0x128)}),gl['viewport'](0x0,0x0,bufferCanvas[_0x305f5a(0xe8)],bufferCanvas[_0x305f5a(0x10f)]);function _0xbc887(_0x5bcb8a,_0x22e4bd){const _0x19c814=_0x305f5a,_0x1b3fee=gl[_0x19c814(0x122)](_0x5bcb8a);return gl[_0x19c814(0xe6)](_0x1b3fee,_0x22e4bd),gl[_0x19c814(0x107)](_0x1b3fee),_0x1b3fee;}vs='attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}';if(_0x2f2211===_0x305f5a(0xf4))fs=_0x305f5a(0xf6);else _0x2f2211===_0x305f5a(0x127)&&(fs=_0x305f5a(0xfa));const _0x1fa5f4=_0xbc887(gl[_0x305f5a(0xf1)],vs),_0x36a55b=_0xbc887(gl[_0x305f5a(0x112)],fs);return program=gl[_0x305f5a(0x120)](),gl[_0x305f5a(0xeb)](program,_0x1fa5f4),gl[_0x305f5a(0xeb)](program,_0x36a55b),gl[_0x305f5a(0x101)](program),gl['useProgram'](program),program;}function setupTexture_Buffer(_0x30dc00){const _0xc2032c=a0_0x5450;texture=gl[_0xc2032c(0xed)](),gl[_0xc2032c(0xef)](gl[_0xc2032c(0xff)],texture),gl['texParameteri'](gl[_0xc2032c(0xff)],gl[_0xc2032c(0x11d)],gl['NEAREST']),gl[_0xc2032c(0x116)](gl[_0xc2032c(0xff)],gl[_0xc2032c(0xea)],gl[_0xc2032c(0xe9)]),gl[_0xc2032c(0x116)](gl[_0xc2032c(0xff)],gl[_0xc2032c(0x10d)],gl['CLAMP_TO_EDGE']),gl['texParameteri'](gl[_0xc2032c(0xff)],gl[_0xc2032c(0xfe)],gl[_0xc2032c(0x114)]);_0x30dc00===_0xc2032c(0x127)&&(gl['uniform2f'](gl[_0xc2032c(0x115)](program,_0xc2032c(0xe7)),gameWidth,gameHeight),gl[_0xc2032c(0x124)](gl[_0xc2032c(0x115)](program,'render_size'),gl[_0xc2032c(0x118)]['width'],gl[_0xc2032c(0x118)][_0xc2032c(0x10f)]),gl[_0xc2032c(0xfd)](gl[_0xc2032c(0x115)](program,_0xc2032c(0xfc)),gameWidth/gl[_0xc2032c(0x118)][_0xc2032c(0xe8)]),gl[_0xc2032c(0xfd)](gl['getUniformLocation'](program,'smooth_height'),gameHeight/gl[_0xc2032c(0x118)]['height']));const _0x38a915=gl[_0xc2032c(0x123)]();gl[_0xc2032c(0x106)](gl[_0xc2032c(0x108)],_0x38a915),gl['bufferData'](gl[_0xc2032c(0x108)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0xc2032c(0x119)]),gl[_0xc2032c(0xf2)](gl['getAttribLocation'](program,_0xc2032c(0xee)),0x2,gl[_0xc2032c(0x110)],![],0x0,0x0),gl[_0xc2032c(0x102)](gl[_0xc2032c(0xf7)](program,'position'));const _0x37c3fe=gl[_0xc2032c(0x123)]();gl[_0xc2032c(0x106)](gl[_0xc2032c(0x108)],_0x37c3fe),gl[_0xc2032c(0x11c)](gl[_0xc2032c(0x108)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0xc2032c(0x119)]),gl[_0xc2032c(0xf2)](gl[_0xc2032c(0xf7)](program,_0xc2032c(0x117)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0xc2032c(0x102)](gl[_0xc2032c(0xf7)](program,'texcoord'));}function setup2DContext(){ctx2d=bufferCanvas['getContext']('2d'),ctx2d['imageSmoothingEnabled']=![];}async function renderPixel(_0x51cd32){const _0x135199=a0_0x5450,_0x511184=a0_0x466ac0['getPixelData']();if(!_0x511184)return;await loadLUT64();const _0x51303f=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x4ab301=0x0;_0x4ab301<gameHeight;_0x4ab301++){for(let _0x366bdc=0x0;_0x366bdc<gameWidth;_0x366bdc++){const _0x5bd2e0=_0x4ab301*gameStride+_0x366bdc,_0x46fc6a=(_0x4ab301*gameWidth+_0x366bdc)*0x4,_0x4b2952=_0x511184[_0x5bd2e0];if(lut64Profile==='none')_0x51303f[_0x46fc6a]=_0x4b2952&0xff,_0x51303f[_0x46fc6a+0x1]=_0x4b2952>>0x8&0xff,_0x51303f[_0x46fc6a+0x2]=_0x4b2952>>0x10&0xff,_0x51303f[_0x46fc6a+0x3]=0xff;else{const _0x391fb7=(_0x4b2952&0xff)>>0x2,_0x1c32a6=(_0x4b2952>>0x8&0xff)>>0x2,_0x904a90=(_0x4b2952>>0x10&0xff)>>0x2,_0x2d4e8e=(_0x391fb7*0x40*0x40+_0x1c32a6*0x40+_0x904a90)*0x3;_0x51303f[_0x46fc6a]=lut64[_0x2d4e8e],_0x51303f[_0x46fc6a+0x1]=lut64[_0x2d4e8e+0x1],_0x51303f[_0x46fc6a+0x2]=lut64[_0x2d4e8e+0x2],_0x51303f[_0x46fc6a+0x3]=0xff;}}}if(_0x51cd32==='webgl')gl[_0x135199(0xf5)](gl[_0x135199(0xff)],0x0,gl[_0x135199(0xec)],gameWidth,gameHeight,0x0,gl[_0x135199(0xec)],gl[_0x135199(0x11a)],_0x51303f),gl[_0x135199(0x11b)](gl[_0x135199(0x11e)]),gl[_0x135199(0x111)](gl['TRIANGLE_STRIP'],0x0,0x4);else _0x51cd32==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x51303f,gameWidth,gameHeight):imageDataObj[_0x135199(0x126)]['set'](_0x51303f),ctx2d[_0x135199(0x100)](0x0,0x0,bufferCanvas[_0x135199(0xe8)],bufferCanvas[_0x135199(0x10f)]),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x51cd32));}function a0_0x5450(_0x2a05b0,_0x4fcb00){const _0x2f2f4c=a0_0x2f2f();return a0_0x5450=function(_0x545057,_0x5e16d3){_0x545057=_0x545057-0xe5;let _0x20c6e6=_0x2f2f4c[_0x545057];return _0x20c6e6;},a0_0x5450(_0x2a05b0,_0x4fcb00);}export async function switchRenderMode(_0x5f62d5){const _0x549425=a0_0x5450;systemType=gameName[_0x549425(0x10e)](-0x3);if(_0x5f62d5==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x5f62d5===_0x549425(0xf4))setupStyle('2d'),setupWebGL_Shader(_0x549425(0xf4)),setupTexture_Buffer(_0x549425(0xf4)),renderPixel(_0x549425(0xf4));else _0x5f62d5==='webgl_full'&&(setupStyle(_0x549425(0x127)),setupWebGL_Shader(_0x549425(0x127)),setupTexture_Buffer(_0x549425(0x127)),renderPixel('webgl'));}}