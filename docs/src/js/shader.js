(function(_0x33fae7,_0x5cce9e){const _0x16d15d=a0_0x4bca,_0x375c34=_0x33fae7();while(!![]){try{const _0x273064=-parseInt(_0x16d15d(0xe9))/0x1*(-parseInt(_0x16d15d(0x109))/0x2)+-parseInt(_0x16d15d(0xc7))/0x3*(parseInt(_0x16d15d(0xf4))/0x4)+parseInt(_0x16d15d(0xce))/0x5*(-parseInt(_0x16d15d(0xf5))/0x6)+parseInt(_0x16d15d(0xc4))/0x7+-parseInt(_0x16d15d(0xe0))/0x8+-parseInt(_0x16d15d(0xe3))/0x9*(parseInt(_0x16d15d(0xcf))/0xa)+parseInt(_0x16d15d(0xd7))/0xb*(parseInt(_0x16d15d(0xc1))/0xc);if(_0x273064===_0x5cce9e)break;else _0x375c34['push'](_0x375c34['shift']());}catch(_0x1faccc){_0x375c34['push'](_0x375c34['shift']());}}}(a0_0x57b5,0x732e6));import*as a0_0x3ece16 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;function a0_0x57b5(){const _0x11b437=['useProgram','smooth_width','webgl_full','uniform1f','8836HjlzpX','smooth_height','FLOAT','vertexAttribPointer','set','getPixelData','createBuffer','COLOR_BUFFER_BIT','getContext','none','log','718024hkCyPx','38778sMAkPX','clearRect','_4.0.bin','position','ARRAY_BUFFER','TEXTURE_WRAP_T','shaderSource','getAttribLocation','render_size','slice','bindBuffer','VERTEX_SHADER','webgl','TRIANGLE_STRIP','TEXTURE_MAG_FILTER','imageSmoothingEnabled','game_size','STATIC_DRAW','createTexture','toLowerCase','174APmdyL','RGBA','TEXTURE_2D','enableVertexAttribArray','25275084uOxZIp','canvas','getUniformLocation','164584mjdaro','width','drawArrays','12klJRUO','data','height','CLAMP_TO_EDGE','bufferData','linkProgram','texParameteri','565gwUnaN','2699300KkXnvL','getItem','FRAGMENT_SHADER','clear','TEXTURE_WRAP_S','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','./src/lut/lut64_','bindTexture','11GNOkiY','texcoord','UNSIGNED_BYTE','createProgram','attachShader','compileShader','arrayBuffer','createShader','uniform2f','5667568QOThOW','low-power','NEAREST','9aDnrTh','viewport'];a0_0x57b5=function(){return _0x11b437;};return a0_0x57b5();}async function loadLUT64(){const _0x2a9812=a0_0x4bca;systemType=gameName[_0x2a9812(0xfe)](-0x3);const _0x2e7986=(localStorage[_0x2a9812(0xd0)](gameName+'_temperature')||_0x2a9812(0xf2))[_0x2a9812(0x108)]();if(!lut64||lut64Profile!==_0x2e7986){const _0x1c6519=_0x2a9812(0xd5)+_0x2e7986+_0x2a9812(0xf7);console[_0x2a9812(0xf3)](_0x1c6519);const _0x21a201=await fetch(_0x1c6519),_0x552bd4=await _0x21a201[_0x2a9812(0xdd)]();lut64=new Uint8Array(_0x552bd4),lut64Profile=_0x2e7986;}}function a0_0x4bca(_0x358823,_0x32ba68){const _0x57b5fe=a0_0x57b5();return a0_0x4bca=function(_0x4bcad2,_0x3368c6){_0x4bcad2=_0x4bcad2-0xbe;let _0x4a5bfb=_0x57b5fe[_0x4bcad2];return _0x4a5bfb;},a0_0x4bca(_0x358823,_0x32ba68);}function setupWebGL_Shader(_0x24226a){const _0x160412=a0_0x4bca;gl=bufferCanvas[_0x160412(0xf1)](_0x160412(0x101),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x160412(0xe1)}),gl[_0x160412(0xe4)](0x0,0x0,bufferCanvas[_0x160412(0xc5)],bufferCanvas['height']);function _0x3d65c8(_0x1f31df,_0x2a8d2f){const _0x28262b=_0x160412,_0x22740c=gl[_0x28262b(0xde)](_0x1f31df);return gl[_0x28262b(0xfb)](_0x22740c,_0x2a8d2f),gl[_0x28262b(0xdc)](_0x22740c),_0x22740c;}vs=_0x160412(0xd4);if(_0x24226a===_0x160412(0x101))fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}';else _0x24226a==='webgl_full'&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x16a413=_0x3d65c8(gl[_0x160412(0x100)],vs),_0x3fb6b2=_0x3d65c8(gl[_0x160412(0xd1)],fs);return program=gl[_0x160412(0xda)](),gl[_0x160412(0xdb)](program,_0x16a413),gl[_0x160412(0xdb)](program,_0x3fb6b2),gl[_0x160412(0xcc)](program),gl[_0x160412(0xe5)](program),program;}function setupTexture_Buffer(_0x438a52){const _0x4c37d0=a0_0x4bca;texture=gl[_0x4c37d0(0x107)](),gl[_0x4c37d0(0xd6)](gl[_0x4c37d0(0xbf)],texture),gl[_0x4c37d0(0xcd)](gl['TEXTURE_2D'],gl['TEXTURE_MIN_FILTER'],gl[_0x4c37d0(0xe2)]),gl[_0x4c37d0(0xcd)](gl[_0x4c37d0(0xbf)],gl[_0x4c37d0(0x103)],gl[_0x4c37d0(0xe2)]),gl[_0x4c37d0(0xcd)](gl[_0x4c37d0(0xbf)],gl[_0x4c37d0(0xd3)],gl[_0x4c37d0(0xca)]),gl[_0x4c37d0(0xcd)](gl[_0x4c37d0(0xbf)],gl[_0x4c37d0(0xfa)],gl[_0x4c37d0(0xca)]);_0x438a52==='webgl_full'&&(gl[_0x4c37d0(0xdf)](gl[_0x4c37d0(0xc3)](program,_0x4c37d0(0x105)),gameWidth,gameHeight),gl[_0x4c37d0(0xdf)](gl[_0x4c37d0(0xc3)](program,_0x4c37d0(0xfd)),gl['canvas']['width'],gl[_0x4c37d0(0xc2)][_0x4c37d0(0xc9)]),gl[_0x4c37d0(0xe8)](gl[_0x4c37d0(0xc3)](program,_0x4c37d0(0xe6)),gameWidth/gl[_0x4c37d0(0xc2)]['width']),gl[_0x4c37d0(0xe8)](gl[_0x4c37d0(0xc3)](program,_0x4c37d0(0xea)),gameHeight/gl[_0x4c37d0(0xc2)][_0x4c37d0(0xc9)]));const _0x2bafaf=gl[_0x4c37d0(0xef)]();gl['bindBuffer'](gl[_0x4c37d0(0xf9)],_0x2bafaf),gl[_0x4c37d0(0xcb)](gl[_0x4c37d0(0xf9)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x4c37d0(0x106)]),gl[_0x4c37d0(0xec)](gl[_0x4c37d0(0xfc)](program,_0x4c37d0(0xf8)),0x2,gl[_0x4c37d0(0xeb)],![],0x0,0x0),gl[_0x4c37d0(0xc0)](gl[_0x4c37d0(0xfc)](program,'position'));const _0x17827b=gl[_0x4c37d0(0xef)]();gl[_0x4c37d0(0xff)](gl[_0x4c37d0(0xf9)],_0x17827b),gl['bufferData'](gl[_0x4c37d0(0xf9)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl[_0x4c37d0(0xec)](gl['getAttribLocation'](program,_0x4c37d0(0xd8)),0x2,gl[_0x4c37d0(0xeb)],![],0x0,0x0),gl[_0x4c37d0(0xc0)](gl[_0x4c37d0(0xfc)](program,'texcoord'));}function setup2DContext(){const _0x209e66=a0_0x4bca;ctx2d=bufferCanvas[_0x209e66(0xf1)]('2d'),ctx2d[_0x209e66(0x104)]=![];}async function renderPixel(_0x318eb3){const _0x1d4f73=a0_0x4bca,_0x4b252a=a0_0x3ece16[_0x1d4f73(0xee)]();if(!_0x4b252a)return;await loadLUT64();const _0xc7de06=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x118158=0x0;_0x118158<gameHeight;_0x118158++){for(let _0x2ff7f4=0x0;_0x2ff7f4<gameWidth;_0x2ff7f4++){const _0x30ddf1=_0x118158*gameStride+_0x2ff7f4,_0x709f3e=(_0x118158*gameWidth+_0x2ff7f4)*0x4,_0x5b6c7f=_0x4b252a[_0x30ddf1];if(lut64Profile===_0x1d4f73(0xf2))_0xc7de06[_0x709f3e]=_0x5b6c7f&0xff,_0xc7de06[_0x709f3e+0x1]=_0x5b6c7f>>0x8&0xff,_0xc7de06[_0x709f3e+0x2]=_0x5b6c7f>>0x10&0xff,_0xc7de06[_0x709f3e+0x3]=0xff;else{const _0x3f8cde=(_0x5b6c7f&0xff)>>0x2,_0x1c1481=(_0x5b6c7f>>0x8&0xff)>>0x2,_0x3de1dd=(_0x5b6c7f>>0x10&0xff)>>0x2,_0x6778ab=(_0x3f8cde*0x40*0x40+_0x1c1481*0x40+_0x3de1dd)*0x3;_0xc7de06[_0x709f3e]=lut64[_0x6778ab],_0xc7de06[_0x709f3e+0x1]=lut64[_0x6778ab+0x1],_0xc7de06[_0x709f3e+0x2]=lut64[_0x6778ab+0x2],_0xc7de06[_0x709f3e+0x3]=0xff;}}}if(_0x318eb3===_0x1d4f73(0x101))gl['texImage2D'](gl[_0x1d4f73(0xbf)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x1d4f73(0xbe)],gl[_0x1d4f73(0xd9)],_0xc7de06),gl[_0x1d4f73(0xd2)](gl[_0x1d4f73(0xf0)]),gl[_0x1d4f73(0xc6)](gl[_0x1d4f73(0x102)],0x0,0x4);else _0x318eb3==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0xc7de06,gameWidth,gameHeight):imageDataObj[_0x1d4f73(0xc8)][_0x1d4f73(0xed)](_0xc7de06),ctx2d[_0x1d4f73(0xf6)](0x0,0x0,bufferCanvas['width'],bufferCanvas['height']),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x318eb3));}export async function switchRenderMode(_0x3edd67){const _0x4740f0=a0_0x4bca;systemType=gameName[_0x4740f0(0xfe)](-0x3);if(_0x3edd67==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x3edd67===_0x4740f0(0x101))setupStyle('2d'),setupWebGL_Shader('webgl'),setupTexture_Buffer(_0x4740f0(0x101)),renderPixel(_0x4740f0(0x101));else _0x3edd67===_0x4740f0(0xe7)&&(setupStyle(_0x4740f0(0xe7)),setupWebGL_Shader(_0x4740f0(0xe7)),setupTexture_Buffer(_0x4740f0(0xe7)),renderPixel(_0x4740f0(0x101)));}}