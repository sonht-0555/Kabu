(function(_0x5b0a4e,_0x103c6a){const _0x40b1c4=a0_0x4cf2,_0x252159=_0x5b0a4e();while(!![]){try{const _0xec08a9=-parseInt(_0x40b1c4(0x161))/0x1*(-parseInt(_0x40b1c4(0x138))/0x2)+-parseInt(_0x40b1c4(0x119))/0x3+-parseInt(_0x40b1c4(0x126))/0x4+parseInt(_0x40b1c4(0x139))/0x5+parseInt(_0x40b1c4(0x13f))/0x6*(-parseInt(_0x40b1c4(0x130))/0x7)+parseInt(_0x40b1c4(0x13a))/0x8+parseInt(_0x40b1c4(0x123))/0x9*(parseInt(_0x40b1c4(0x136))/0xa);if(_0xec08a9===_0x103c6a)break;else _0x252159['push'](_0x252159['shift']());}catch(_0x51e9a0){_0x252159['push'](_0x252159['shift']());}}}(a0_0x1569,0xa269e));function a0_0x4cf2(_0x2f6a58,_0x1a3e11){const _0x15695a=a0_0x1569();return a0_0x4cf2=function(_0x4cf261,_0x16b4b4){_0x4cf261=_0x4cf261-0x119;let _0x2fbb83=_0x15695a[_0x4cf261];return _0x2fbb83;},a0_0x4cf2(_0x2f6a58,_0x1a3e11);}import*as a0_0x5ff652 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x57e5ad=a0_0x4cf2;systemType=gameName[_0x57e5ad(0x143)](-0x3);const _0x2ce0c=localStorage[_0x57e5ad(0x145)](gameName+'_streng')||_0x57e5ad(0x11c),_0x3cc8ce=(localStorage[_0x57e5ad(0x145)](gameName+_0x57e5ad(0x154))||_0x57e5ad(0x125))[_0x57e5ad(0x159)]();if(!lut64||lut64Streng!==_0x2ce0c||lut64Profile!==_0x3cc8ce){const _0xa034c4=_0x57e5ad(0x144)+_0x3cc8ce+'_'+_0x2ce0c+_0x57e5ad(0x156);console[_0x57e5ad(0x152)](_0xa034c4);const _0x119a2e=await fetch(_0xa034c4),_0x5cf47a=await _0x119a2e[_0x57e5ad(0x158)]();lut64=new Uint8Array(_0x5cf47a),lut64Streng=_0x2ce0c,lut64Profile=_0x3cc8ce;}}function a0_0x1569(){const _0x380925=['RGBA','position','getUniformLocation','getContext','TEXTURE_MIN_FILTER','smooth_height','low-power','TEXTURE_MAG_FILTER','linkProgram','createTexture','log','webgl','_temperature','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','.bin','webgl_full','arrayBuffer','toLowerCase','render_size','ARRAY_BUFFER','game_size','TRIANGLE_STRIP','viewport','shaderSource','enableVertexAttribArray','2AFawOr','height','3215352JxOGlh','width','VERTEX_SHADER','4.0','STATIC_DRAW','drawImage','TEXTURE_2D','UNSIGNED_BYTE','TEXTURE_WRAP_S','bufferData','79767bKyAwS','useProgram','warm','3145624rEFHsC','FRAGMENT_SHADER','getPixelData','canvas','getAttribLocation','smooth_width','COLOR_BUFFER_BIT','clearRect','texParameteri','uniform2f','3899YZvvcx','clear','FLOAT','createShader','createBuffer','drawArrays','220OffoGl','vertexAttribPointer','1246318BBlZQU','2206280dsoPXb','7002984mixEhs','NEAREST','texImage2D','CLAMP_TO_EDGE','bindBuffer','2526GRKkuJ','attachShader','createProgram','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','slice','./src/lut/lut64_','getItem','imageSmoothingEnabled','uniform1f'];a0_0x1569=function(){return _0x380925;};return a0_0x1569();}function setupWebGL_Shader(_0x529c27){const _0x2bf5f6=a0_0x4cf2;gl=bufferCanvas[_0x2bf5f6(0x14b)](_0x2bf5f6(0x153),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x2bf5f6(0x14e)}),gl[_0x2bf5f6(0x15e)](0x0,0x0,bufferCanvas[_0x2bf5f6(0x11a)],bufferCanvas[_0x2bf5f6(0x162)]);function _0xc8d9f(_0x718070,_0x5af58e){const _0x33acaa=_0x2bf5f6,_0x32c833=gl[_0x33acaa(0x133)](_0x718070);return gl[_0x33acaa(0x15f)](_0x32c833,_0x5af58e),gl['compileShader'](_0x32c833),_0x32c833;}vs=_0x2bf5f6(0x142);if(_0x529c27===_0x2bf5f6(0x153))fs=_0x2bf5f6(0x155);else _0x529c27===_0x2bf5f6(0x157)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x243118=_0xc8d9f(gl[_0x2bf5f6(0x11b)],vs),_0x37b825=_0xc8d9f(gl[_0x2bf5f6(0x127)],fs);return program=gl[_0x2bf5f6(0x141)](),gl['attachShader'](program,_0x243118),gl[_0x2bf5f6(0x140)](program,_0x37b825),gl[_0x2bf5f6(0x150)](program),gl[_0x2bf5f6(0x124)](program),program;}function setupTexture_Buffer(_0x1fe938){const _0x1ac11e=a0_0x4cf2;texture=gl[_0x1ac11e(0x151)](),gl['bindTexture'](gl[_0x1ac11e(0x11f)],texture),gl['texParameteri'](gl['TEXTURE_2D'],gl[_0x1ac11e(0x14c)],gl[_0x1ac11e(0x13b)]),gl[_0x1ac11e(0x12e)](gl[_0x1ac11e(0x11f)],gl[_0x1ac11e(0x14f)],gl[_0x1ac11e(0x13b)]),gl[_0x1ac11e(0x12e)](gl[_0x1ac11e(0x11f)],gl[_0x1ac11e(0x121)],gl[_0x1ac11e(0x13d)]),gl[_0x1ac11e(0x12e)](gl[_0x1ac11e(0x11f)],gl['TEXTURE_WRAP_T'],gl[_0x1ac11e(0x13d)]);_0x1fe938==='webgl_full'&&(gl[_0x1ac11e(0x12f)](gl[_0x1ac11e(0x14a)](program,_0x1ac11e(0x15c)),gameWidth,gameHeight),gl[_0x1ac11e(0x12f)](gl[_0x1ac11e(0x14a)](program,_0x1ac11e(0x15a)),gl[_0x1ac11e(0x129)]['width'],gl[_0x1ac11e(0x129)][_0x1ac11e(0x162)]),gl[_0x1ac11e(0x147)](gl[_0x1ac11e(0x14a)](program,_0x1ac11e(0x12b)),gameWidth/gl[_0x1ac11e(0x129)]['width']),gl[_0x1ac11e(0x147)](gl[_0x1ac11e(0x14a)](program,_0x1ac11e(0x14d)),gameHeight/gl[_0x1ac11e(0x129)]['height']));const _0x2e4c54=gl[_0x1ac11e(0x134)]();gl[_0x1ac11e(0x13e)](gl['ARRAY_BUFFER'],_0x2e4c54),gl[_0x1ac11e(0x122)](gl[_0x1ac11e(0x15b)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x1ac11e(0x11d)]),gl['vertexAttribPointer'](gl[_0x1ac11e(0x12a)](program,_0x1ac11e(0x149)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x1ac11e(0x160)](gl[_0x1ac11e(0x12a)](program,_0x1ac11e(0x149)));const _0x150f84=gl[_0x1ac11e(0x134)]();gl['bindBuffer'](gl[_0x1ac11e(0x15b)],_0x150f84),gl['bufferData'](gl[_0x1ac11e(0x15b)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl[_0x1ac11e(0x137)](gl['getAttribLocation'](program,'texcoord'),0x2,gl[_0x1ac11e(0x132)],![],0x0,0x0),gl[_0x1ac11e(0x160)](gl['getAttribLocation'](program,'texcoord'));}function setup2DContext(){const _0x20504c=a0_0x4cf2;ctx2d=bufferCanvas['getContext']('2d'),ctx2d[_0x20504c(0x146)]=![];}async function renderPixel(_0xd95c40){const _0x2c0e73=a0_0x4cf2,_0x5bd976=a0_0x5ff652[_0x2c0e73(0x128)]();if(!_0x5bd976)return;await loadLUT64();const _0x362a8=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x765f41=0x0;_0x765f41<gameHeight;_0x765f41++){for(let _0x4734ba=0x0;_0x4734ba<gameWidth;_0x4734ba++){const _0x5c5710=_0x765f41*gameStride+_0x4734ba,_0x82cf01=(_0x765f41*gameWidth+_0x4734ba)*0x4,_0x8e7295=_0x5bd976[_0x5c5710],_0x1204c9=(_0x8e7295&0xff)>>0x2,_0x44556d=(_0x8e7295>>0x8&0xff)>>0x2,_0x31a0c8=(_0x8e7295>>0x10&0xff)>>0x2,_0x1d54f8=(_0x1204c9*0x40*0x40+_0x44556d*0x40+_0x31a0c8)*0x3;_0x362a8[_0x82cf01]=lut64[_0x1d54f8],_0x362a8[_0x82cf01+0x1]=lut64[_0x1d54f8+0x1],_0x362a8[_0x82cf01+0x2]=lut64[_0x1d54f8+0x2],_0x362a8[_0x82cf01+0x3]=0xff;}}if(_0xd95c40===_0x2c0e73(0x153))gl[_0x2c0e73(0x13c)](gl['TEXTURE_2D'],0x0,gl[_0x2c0e73(0x148)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x2c0e73(0x120)],_0x362a8),gl[_0x2c0e73(0x131)](gl[_0x2c0e73(0x12c)]),gl[_0x2c0e73(0x135)](gl[_0x2c0e73(0x15d)],0x0,0x4);else _0xd95c40==='2d'&&(imageDataObj=new ImageData(_0x362a8,gameWidth,gameHeight),createImageBitmap(imageDataObj)['then'](_0x2e031c=>{const _0x2eeb51=_0x2c0e73;ctx2d[_0x2eeb51(0x12d)](0x0,0x0,bufferCanvas[_0x2eeb51(0x11a)],bufferCanvas[_0x2eeb51(0x162)]),ctx2d[_0x2eeb51(0x11e)](_0x2e031c,0x0,0x0);}));requestAnimationFrame(()=>renderPixel(_0xd95c40));}export async function switchRenderMode(_0x324d79){const _0x44cf7c=a0_0x4cf2;systemType=gameName[_0x44cf7c(0x143)](-0x3);if(_0x324d79==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x324d79===_0x44cf7c(0x153))setupStyle('2d'),setupWebGL_Shader(_0x44cf7c(0x153)),setupTexture_Buffer('webgl'),renderPixel(_0x44cf7c(0x153));else _0x324d79===_0x44cf7c(0x157)&&(setupStyle('webgl_full'),setupWebGL_Shader(_0x44cf7c(0x157)),setupTexture_Buffer('webgl_full'),renderPixel(_0x44cf7c(0x153)));}}