const a0_0x450bde=a0_0x2c4d;(function(_0x56bca7,_0x1a7454){const _0x1d8680=a0_0x2c4d,_0x32c342=_0x56bca7();while(!![]){try{const _0x4e3ebf=parseInt(_0x1d8680(0x1d8))/0x1*(parseInt(_0x1d8680(0x1c0))/0x2)+parseInt(_0x1d8680(0x1f6))/0x3*(-parseInt(_0x1d8680(0x1dd))/0x4)+-parseInt(_0x1d8680(0x20e))/0x5+parseInt(_0x1d8680(0x1cf))/0x6+parseInt(_0x1d8680(0x1b1))/0x7+-parseInt(_0x1d8680(0x201))/0x8+parseInt(_0x1d8680(0x1c7))/0x9;if(_0x4e3ebf===_0x1a7454)break;else _0x32c342['push'](_0x32c342['shift']());}catch(_0xa2d3b3){_0x32c342['push'](_0x32c342['shift']());}}}(a0_0x244d,0x648e0));import*as a0_0xf91f91 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x450bde(0x1bc)](a0_0x450bde(0x1ed)),bufferCanvas=document[a0_0x450bde(0x1bc)](a0_0x450bde(0x1b7)),canvasContainer=document['getElementById']('canvas-container'),imgShader=document[a0_0x450bde(0x1bc)](a0_0x450bde(0x1dc)),settingContainer=document['querySelectorAll'](a0_0x450bde(0x1e9)),messageContainer=document[a0_0x450bde(0x1f0)](a0_0x450bde(0x1d5)),stateTitle=document[a0_0x450bde(0x1f0)](a0_0x450bde(0x1b8));async function loadLUT64(){const _0x3c9c25=a0_0x450bde;systemType=gameName['slice'](-0x3);const _0x1ccab6=localStorage[_0x3c9c25(0x1d1)](gameName+'_streng')||_0x3c9c25(0x20c),_0x1f3b2a=(localStorage[_0x3c9c25(0x1d1)](gameName+_0x3c9c25(0x1d6))||_0x3c9c25(0x1b6))[_0x3c9c25(0x1e4)]();if(!lut64||lut64Streng!==_0x1ccab6||lut64Profile!==_0x1f3b2a){const _0x2b3889=_0x3c9c25(0x1c8)+_0x1f3b2a+'_'+_0x1ccab6+_0x3c9c25(0x1c5);console[_0x3c9c25(0x1f5)](_0x2b3889);const _0x2039a4=await fetch(_0x2b3889),_0x33a32d=await _0x2039a4[_0x3c9c25(0x1cd)]();lut64=new Uint8Array(_0x33a32d),lut64Streng=_0x1ccab6,lut64Profile=_0x1f3b2a;}}async function loadShaderSource(_0x7a5308){const _0x36c842=await fetch(_0x7a5308);return await _0x36c842['text']();}function setupStyle(_0x53262f){const _0x372396=a0_0x450bde;clientWidth=document[_0x372396(0x1e5)][_0x372396(0x1c6)];const _0x315c91=window[_0x372396(0x1fa)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math['floor'](clientWidth*_0x315c91/gameWidth),localStorage[_0x372396(0x1e1)](_0x372396(0x1de),_0x372396(0x1ba)+gameWidth*(integerScaling/_0x315c91)+','+gameHeight*(integerScaling/_0x315c91))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x372396(0x1f1)](clientWidth*_0x315c91/gameWidth),localStorage[_0x372396(0x1e1)](_0x372396(0x1de),_0x372396(0x1ba)+gameWidth*(integerScaling/_0x315c91)+','+gameHeight*(integerScaling/_0x315c91)));if(_0x53262f==='2d')bufferCanvas[_0x372396(0x215)]=gameWidth,bufferCanvas[_0x372396(0x1b4)]=gameHeight,bufferCanvas[_0x372396(0x20d)][_0x372396(0x1fc)]=''+integerScaling/_0x315c91,bufferCanvas['style'][_0x372396(0x1c3)]=_0x372396(0x1f7),canvasContainer['style']['width']=gameWidth*(integerScaling/_0x315c91)+'px',canvasContainer['style'][_0x372396(0x1b4)]=gameHeight*(integerScaling/_0x315c91)+'px',textured[_0x372396(0x20d)]['width']=gameWidth*(integerScaling/_0x315c91)+'px',textured['style']['height']=gameHeight*(integerScaling/_0x315c91)+'px',imgShader[_0x372396(0x20d)]['transform']=_0x372396(0x1e7)+integerScaling/_0x315c91/upscaleShader+')',settingContainer[_0x372396(0x200)](function(_0x3c25a5){const _0x4d67a4=_0x372396;_0x3c25a5[_0x4d67a4(0x20d)][_0x4d67a4(0x215)]=gameWidth*(integerScaling/_0x315c91)+'px',_0x3c25a5[_0x4d67a4(0x20d)][_0x4d67a4(0x1b4)]=gameHeight*(integerScaling/_0x315c91)+'px';}),messageContainer[_0x372396(0x200)](function(_0xf03408){const _0x5a0b50=_0x372396;_0xf03408[_0x5a0b50(0x20d)][_0x5a0b50(0x215)]=gameWidth+'px',_0xf03408[_0x5a0b50(0x20d)][_0x5a0b50(0x1b4)]=gameHeight+'px',_0xf03408['style'][_0x5a0b50(0x1fc)]=''+integerScaling/_0x315c91;}),stateTitle[_0x372396(0x200)](function(_0x59e045){const _0x143548=_0x372396;_0x59e045['classList'][_0x143548(0x1d4)](_0x143548(0x1b3));});else _0x53262f===_0x372396(0x205)&&(bufferCanvas[_0x372396(0x215)]=clientWidth*upscaleFactor,bufferCanvas[_0x372396(0x1b4)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x372396(0x20d)]['zoom']=''+0x1/upscaleFactor,bufferCanvas[_0x372396(0x20d)]['imageRendering']='',canvasContainer[_0x372396(0x20d)][_0x372396(0x215)]=clientWidth+'px',canvasContainer[_0x372396(0x20d)][_0x372396(0x1b4)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x372396(0x20d)]['width']=clientWidth+'px',textured[_0x372396(0x20d)][_0x372396(0x1b4)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x372396(0x20d)][_0x372396(0x204)]=_0x372396(0x1e7)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x372396(0x200)](function(_0x128835){const _0x136b46=_0x372396;_0x128835['style'][_0x136b46(0x215)]=clientWidth+'px',_0x128835[_0x136b46(0x20d)][_0x136b46(0x1b4)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer['forEach'](function(_0x2315e6){const _0x35a029=_0x372396;_0x2315e6[_0x35a029(0x20d)][_0x35a029(0x215)]=gameWidth+'px',_0x2315e6[_0x35a029(0x20d)]['height']=gameHeight+'px',_0x2315e6[_0x35a029(0x20d)][_0x35a029(0x1fc)]=''+clientWidth/gameWidth;}),stateTitle['forEach'](function(_0x2eedbc){const _0x5f4e12=_0x372396;_0x2eedbc['classList']['add'](_0x5f4e12(0x1b3));}));imgShader[_0x372396(0x20d)][_0x372396(0x215)]=gameWidth*upscaleShader+'px',imgShader['style'][_0x372396(0x1b4)]=gameHeight*upscaleShader+'px',imgShader[_0x372396(0x20d)][_0x372396(0x1cb)]=_0x372396(0x1d9),imgShader['style']['setProperty'](_0x372396(0x1bb),upscaleShader+_0x372396(0x1df)+upscaleShader+'px');}function setupWebGL(){const _0x4deb9c=a0_0x450bde;gl=bufferCanvas[_0x4deb9c(0x1e8)]('webgl2');if(!gl)return console[_0x4deb9c(0x209)](_0x4deb9c(0x1d3)),null;gl[_0x4deb9c(0x1d7)](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x4deb9c(0x1b4)]);}function createShader(_0x5debde,_0x102719){const _0x54f24c=a0_0x450bde,_0x177c81=gl[_0x54f24c(0x1ca)](_0x5debde);gl[_0x54f24c(0x1da)](_0x177c81,_0x102719),gl[_0x54f24c(0x1ea)](_0x177c81);if(!gl[_0x54f24c(0x1ce)](_0x177c81,gl[_0x54f24c(0x206)]))return console[_0x54f24c(0x209)](gl['getShaderInfoLog'](_0x177c81)),gl['deleteShader'](_0x177c81),null;return _0x177c81;}function a0_0x244d(){const _0x4aeeb9=['px\x20','texImage2D','setItem','bufferData','CLAMP_TO_EDGE','toLowerCase','documentElement','smooth_height','scale(','getContext','.setting-container','compileShader','getAttribLocation','UNSIGNED_BYTE','textured','drawArrays','uniform2f','querySelectorAll','floor','game_size','FRAGMENT_SHADER','DOMContentLoaded','log','12dHjuPb','crisp-edges','drawImage','./src/shaders/vertexShader.glsl','devicePixelRatio','texcoord','zoom','bindBuffer','STATIC_DRAW','TEXTURE_MIN_FILTER','forEach','863272YAougR','TEXTURE_MAG_FILTER','imageSmoothingEnabled','transform','webgl2','COMPILE_STATUS','TEXTURE_2D','ARRAY_BUFFER','error','COLOR_BUFFER_BIT','createTexture','4.0','style','417175tXKKPU','clearRect','VERTEX_SHADER','bindTexture','TRIANGLE_STRIP','uniform1f','TEXTURE_WRAP_T','width','530551pvZlfe','texParameteri','fefs','height','createBuffer','warm','canvas','.stateTitle,\x20.stateDate','RGBA','0,0,','--bg-size','getElementById','attachShader','getUniformLocation','createProgram','786082GsLbfh','./src/shaders/fragmentShader.glsl','addEventListener','imageRendering','vertexAttribPointer','.bin','clientWidth','5210964polDrP','./src/lut/lut64_','FLOAT','createShader','transformOrigin','TEXTURE_WRAP_S','arrayBuffer','getShaderParameter','69924hlddto','linkProgram','getItem','clear','WebGL2\x20not\x20supported','remove','.message-container','_temperature','viewport','1Fyxwcv','top\x20center','shaderSource','enableVertexAttribArray','img-shader','456268HgbMpW','screenSize'];a0_0x244d=function(){return _0x4aeeb9;};return a0_0x244d();}async function setupShaders(){const _0x5e3bd4=a0_0x450bde,_0x34abe7=await loadShaderSource(_0x5e3bd4(0x1f9)),_0x3acc9e=await loadShaderSource(_0x5e3bd4(0x1c1)),_0xdeb185=createShader(gl[_0x5e3bd4(0x210)],_0x34abe7),_0x5c8390=createShader(gl[_0x5e3bd4(0x1f3)],_0x3acc9e);return program=gl[_0x5e3bd4(0x1bf)](),gl[_0x5e3bd4(0x1bd)](program,_0xdeb185),gl[_0x5e3bd4(0x1bd)](program,_0x5c8390),gl[_0x5e3bd4(0x1d0)](program),gl['useProgram'](program),program;}function setupTexture(){const _0x1b0e91=a0_0x450bde;texture=gl[_0x1b0e91(0x20b)](),gl[_0x1b0e91(0x211)](gl[_0x1b0e91(0x207)],texture),gl[_0x1b0e91(0x1b2)](gl['TEXTURE_2D'],gl[_0x1b0e91(0x1ff)],gl['NEAREST']),gl[_0x1b0e91(0x1b2)](gl[_0x1b0e91(0x207)],gl[_0x1b0e91(0x202)],gl['NEAREST']),gl[_0x1b0e91(0x1b2)](gl['TEXTURE_2D'],gl[_0x1b0e91(0x1cc)],gl[_0x1b0e91(0x1e3)]),gl[_0x1b0e91(0x1b2)](gl[_0x1b0e91(0x207)],gl[_0x1b0e91(0x214)],gl[_0x1b0e91(0x1e3)]),gl[_0x1b0e91(0x1ef)](gl[_0x1b0e91(0x1be)](program,_0x1b0e91(0x1f2)),gameWidth,gameHeight),gl[_0x1b0e91(0x1ef)](gl[_0x1b0e91(0x1be)](program,'render_size'),gl[_0x1b0e91(0x1b7)][_0x1b0e91(0x215)],gl[_0x1b0e91(0x1b7)]['height']),gl[_0x1b0e91(0x213)](gl[_0x1b0e91(0x1be)](program,'smooth_width'),gameWidth/gl[_0x1b0e91(0x1b7)][_0x1b0e91(0x215)]),gl[_0x1b0e91(0x213)](gl[_0x1b0e91(0x1be)](program,_0x1b0e91(0x1e6)),gameHeight/gl[_0x1b0e91(0x1b7)][_0x1b0e91(0x1b4)]);}function setupBuffers(){const _0x1531df=a0_0x450bde,_0x27859d=gl['createBuffer']();gl[_0x1531df(0x1fd)](gl[_0x1531df(0x208)],_0x27859d),gl[_0x1531df(0x1e2)](gl[_0x1531df(0x208)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x1531df(0x1fe)]);const _0x4bdf27=gl[_0x1531df(0x1eb)](program,'position');gl['enableVertexAttribArray'](_0x4bdf27),gl[_0x1531df(0x1c4)](_0x4bdf27,0x2,gl[_0x1531df(0x1c9)],![],0x0,0x0);const _0x4f1a24=gl[_0x1531df(0x1b5)]();gl[_0x1531df(0x1fd)](gl[_0x1531df(0x208)],_0x4f1a24),gl[_0x1531df(0x1e2)](gl[_0x1531df(0x208)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x1531df(0x1fe)]);const _0x5a8991=gl[_0x1531df(0x1eb)](program,_0x1531df(0x1fb));gl[_0x1531df(0x1db)](_0x5a8991),gl[_0x1531df(0x1c4)](_0x5a8991,0x2,gl[_0x1531df(0x1c9)],![],0x0,0x0);}async function renderPixel(_0x38b57c){const _0x44d074=a0_0x450bde,_0x5b9cec=a0_0xf91f91['getPixelData']();if(!_0x5b9cec)return;await loadLUT64();const _0x4b12e0=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x222bd5=0x0;_0x222bd5<gameHeight;_0x222bd5++){for(let _0x91a84d=0x0;_0x91a84d<gameWidth;_0x91a84d++){const _0x19c485=_0x222bd5*gameStride+_0x91a84d,_0xce6eea=(_0x222bd5*gameWidth+_0x91a84d)*0x4,_0x52a277=_0x5b9cec[_0x19c485],_0x48eeab=(_0x52a277&0xff)>>0x2,_0x1f3bde=(_0x52a277>>0x8&0xff)>>0x2,_0x393fae=(_0x52a277>>0x10&0xff)>>0x2,_0x5f30cd=(_0x48eeab*0x40*0x40+_0x1f3bde*0x40+_0x393fae)*0x3;_0x4b12e0[_0xce6eea]=lut64[_0x5f30cd],_0x4b12e0[_0xce6eea+0x1]=lut64[_0x5f30cd+0x1],_0x4b12e0[_0xce6eea+0x2]=lut64[_0x5f30cd+0x2],_0x4b12e0[_0xce6eea+0x3]=0xff;}}if(_0x38b57c===_0x44d074(0x205))gl[_0x44d074(0x211)](gl[_0x44d074(0x207)],texture),gl[_0x44d074(0x1e0)](gl[_0x44d074(0x207)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x44d074(0x1b9)],gl[_0x44d074(0x1ec)],_0x4b12e0),gl[_0x44d074(0x1d2)](gl[_0x44d074(0x20a)]),gl[_0x44d074(0x1ee)](gl[_0x44d074(0x212)],0x0,0x4);else{if(_0x38b57c==='2d'){ctx2d=bufferCanvas[_0x44d074(0x1e8)]('2d'),ctx2d[_0x44d074(0x203)]=![];const _0x41558e=new ImageData(_0x4b12e0,gameWidth,gameHeight);createImageBitmap(_0x41558e)['then'](_0x1e1567=>{const _0x144795=_0x44d074;ctx2d[_0x144795(0x20f)](0x0,0x0,bufferCanvas[_0x144795(0x215)],bufferCanvas[_0x144795(0x1b4)]),ctx2d[_0x144795(0x1f8)](_0x1e1567,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x38b57c));}export async function switchRenderMode(_0x57dbf7){const _0x51d01f=a0_0x450bde;systemType=gameName['slice'](-0x3);if(_0x57dbf7==='2d')setupStyle('2d'),renderPixel('2d');else _0x57dbf7===_0x51d01f(0x205)&&(setupStyle(_0x51d01f(0x205)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x51d01f(0x205)));}function a0_0x2c4d(_0x5659ff,_0x93da23){const _0x244dbe=a0_0x244d();return a0_0x2c4d=function(_0x2c4dfa,_0x4bac9a){_0x2c4dfa=_0x2c4dfa-0x1b1;let _0x15d02a=_0x244dbe[_0x2c4dfa];return _0x15d02a;},a0_0x2c4d(_0x5659ff,_0x93da23);}document[a0_0x450bde(0x1c2)](a0_0x450bde(0x1f4),function(){});