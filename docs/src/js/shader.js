const a0_0x5be5e3=a0_0x5a7d;(function(_0x3e10c5,_0x3e07cf){const _0x37f463=a0_0x5a7d,_0x29b8b8=_0x3e10c5();while(!![]){try{const _0x1675e4=-parseInt(_0x37f463(0x17b))/0x1+parseInt(_0x37f463(0x185))/0x2+-parseInt(_0x37f463(0x173))/0x3*(-parseInt(_0x37f463(0x150))/0x4)+parseInt(_0x37f463(0x198))/0x5*(-parseInt(_0x37f463(0x145))/0x6)+-parseInt(_0x37f463(0x165))/0x7+-parseInt(_0x37f463(0x191))/0x8+parseInt(_0x37f463(0x189))/0x9*(parseInt(_0x37f463(0x151))/0xa);if(_0x1675e4===_0x3e07cf)break;else _0x29b8b8['push'](_0x29b8b8['shift']());}catch(_0x20269e){_0x29b8b8['push'](_0x29b8b8['shift']());}}}(a0_0x5eda,0x97391));function a0_0x5eda(){const _0x2ec7ea=['bitmaprenderer','width','getUniformLocation','data','uniform2f','img-shader','documentElement','TEXTURE_MIN_FILTER','texcoord','getAttribLocation','setProperty','screenSize','error','getItem','imageRendering','5713246lXYOrU','drawArrays','style','TEXTURE_MAG_FILTER','uniform1f','getShaderParameter','vertexAttribPointer','transformOrigin','shaderSource','.message-container','game_size','imageSmoothingEnabled','texParameteri','UNSIGNED_BYTE','9LLETwk','render_size','compileShader','position','_streng','COLOR_BUFFER_BIT','ARRAY_BUFFER','devicePixelRatio','223731rQkfJP','.stateTitle,\x20.stateDate','clear','zoom','log','crisp-edges','addEventListener','bindTexture','COMPILE_STATUS','bindBuffer','1577496tEHrJj','scale(','0,0,','forEach','8458254LTdxpo','enableVertexAttribArray','height','--bg-size','slice','TEXTURE_WRAP_S','viewport','then','2240328IZvhXX','webgl2','CLAMP_TO_EDGE','text','floor','VERTEX_SHADER','createProgram','1630sxJXLa','getShaderInfoLog','TEXTURE_2D','textured','createTexture','STATIC_DRAW','linkProgram','createBuffer','_temperature','set','attachShader','TEXTURE_WRAP_T','FRAGMENT_SHADER','smooth_width','deleteShader','getElementById','FLOAT','arrayBuffer','canvas','classList','createShader','19326URJTiY','canvas-container','getContext','RGBA','transform','./src/shaders/fragmentShader.glsl','4.0','querySelectorAll','.bin','bufferData','warm','428060TktSer','20YmoSeY','top\x20center','add','TRIANGLE_STRIP','setItem'];a0_0x5eda=function(){return _0x2ec7ea;};return a0_0x5eda();}import*as a0_0x2317aa from'./main.js';function a0_0x5a7d(_0x3396ec,_0x4190d8){const _0x5edaa4=a0_0x5eda();return a0_0x5a7d=function(_0x5a7d9b,_0x3ca4e8){_0x5a7d9b=_0x5a7d9b-0x13b;let _0x4f9f95=_0x5edaa4[_0x5a7d9b];return _0x4f9f95;},a0_0x5a7d(_0x3396ec,_0x4190d8);}let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x5be5e3(0x13f)](a0_0x5be5e3(0x19b)),bufferCanvas=document['getElementById'](a0_0x5be5e3(0x142)),canvasContainer=document[a0_0x5be5e3(0x13f)](a0_0x5be5e3(0x146)),imgShader=document['getElementById'](a0_0x5be5e3(0x15b)),settingContainer=document[a0_0x5be5e3(0x14c)]('.setting-container'),messageContainer=document[a0_0x5be5e3(0x14c)](a0_0x5be5e3(0x16e)),stateTitle=document[a0_0x5be5e3(0x14c)](a0_0x5be5e3(0x17c));let imageDataObj=null;async function loadLUT64(){const _0xa4199c=a0_0x5be5e3;systemType=gameName[_0xa4199c(0x18d)](-0x3);const _0x2f6fac=localStorage[_0xa4199c(0x163)](gameName+_0xa4199c(0x177))||_0xa4199c(0x14b),_0x4863b3=(localStorage[_0xa4199c(0x163)](gameName+_0xa4199c(0x1a0))||_0xa4199c(0x14f))['toLowerCase']();if(!lut64||lut64Streng!==_0x2f6fac||lut64Profile!==_0x4863b3){const _0x4e4cf5='./src/lut/lut64_'+_0x4863b3+'_'+_0x2f6fac+_0xa4199c(0x14d);console[_0xa4199c(0x17f)](_0x4e4cf5);const _0x8c470c=await fetch(_0x4e4cf5),_0x2cbc30=await _0x8c470c[_0xa4199c(0x141)]();lut64=new Uint8Array(_0x2cbc30),lut64Streng=_0x2f6fac,lut64Profile=_0x4863b3;}}async function loadShaderSource(_0x297a8c){const _0x261e07=a0_0x5be5e3,_0xd57f00=await fetch(_0x297a8c);return await _0xd57f00[_0x261e07(0x194)]();}function setupStyle(_0x189985){const _0x5d97d1=a0_0x5be5e3;clientWidth=document[_0x5d97d1(0x15c)]['clientWidth'];const _0x137837=window[_0x5d97d1(0x17a)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x5d97d1(0x195)](clientWidth*_0x137837/gameWidth),localStorage[_0x5d97d1(0x155)](_0x5d97d1(0x161),_0x5d97d1(0x187)+gameWidth*(integerScaling/_0x137837)+','+gameHeight*(integerScaling/_0x137837))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x5d97d1(0x195)](clientWidth*_0x137837/gameWidth),localStorage[_0x5d97d1(0x155)]('screenSize',_0x5d97d1(0x187)+gameWidth*(integerScaling/_0x137837)+','+gameHeight*(integerScaling/_0x137837)));if(_0x189985==='2d')bufferCanvas[_0x5d97d1(0x157)]=gameWidth,bufferCanvas[_0x5d97d1(0x18b)]=gameHeight,bufferCanvas[_0x5d97d1(0x167)][_0x5d97d1(0x17e)]=''+integerScaling/_0x137837,bufferCanvas[_0x5d97d1(0x167)][_0x5d97d1(0x164)]=_0x5d97d1(0x180),canvasContainer['style'][_0x5d97d1(0x157)]=gameWidth*(integerScaling/_0x137837)+'px',canvasContainer[_0x5d97d1(0x167)][_0x5d97d1(0x18b)]=gameHeight*(integerScaling/_0x137837)+'px',textured['style']['width']=gameWidth*(integerScaling/_0x137837)+'px',textured[_0x5d97d1(0x167)][_0x5d97d1(0x18b)]=gameHeight*(integerScaling/_0x137837)+'px',imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x149)]=_0x5d97d1(0x186)+integerScaling/_0x137837/upscaleShader+')',settingContainer['forEach'](function(_0x5aafeb){const _0x10b892=_0x5d97d1;_0x5aafeb['style'][_0x10b892(0x157)]=gameWidth*(integerScaling/_0x137837)+'px',_0x5aafeb[_0x10b892(0x167)][_0x10b892(0x18b)]=gameHeight*(integerScaling/_0x137837)+'px';}),messageContainer['forEach'](function(_0x262f06){const _0xf27dbf=_0x5d97d1;_0x262f06[_0xf27dbf(0x167)]['width']=gameWidth+'px',_0x262f06[_0xf27dbf(0x167)][_0xf27dbf(0x18b)]=gameHeight+'px',_0x262f06['style'][_0xf27dbf(0x17e)]=''+integerScaling/_0x137837;}),stateTitle['forEach'](function(_0x357dd5){const _0x26566f=_0x5d97d1;_0x357dd5[_0x26566f(0x143)]['remove']('fefs');});else _0x189985===_0x5d97d1(0x192)&&(bufferCanvas[_0x5d97d1(0x157)]=clientWidth*upscaleFactor,bufferCanvas[_0x5d97d1(0x18b)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style'][_0x5d97d1(0x17e)]=''+0x1/upscaleFactor,bufferCanvas[_0x5d97d1(0x167)]['imageRendering']='',canvasContainer['style'][_0x5d97d1(0x157)]=clientWidth+'px',canvasContainer['style'][_0x5d97d1(0x18b)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x5d97d1(0x167)][_0x5d97d1(0x157)]=clientWidth+'px',textured['style']['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x149)]=_0x5d97d1(0x186)+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x5d97d1(0x188)](function(_0x108689){const _0x231fba=_0x5d97d1;_0x108689[_0x231fba(0x167)][_0x231fba(0x157)]=clientWidth+'px',_0x108689[_0x231fba(0x167)][_0x231fba(0x18b)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x5d97d1(0x188)](function(_0x587a45){const _0x1ac073=_0x5d97d1;_0x587a45[_0x1ac073(0x167)][_0x1ac073(0x157)]=gameWidth+'px',_0x587a45[_0x1ac073(0x167)]['height']=gameHeight+'px',_0x587a45['style'][_0x1ac073(0x17e)]=''+clientWidth/gameWidth;}),stateTitle[_0x5d97d1(0x188)](function(_0x7d9b1c){const _0x42586c=_0x5d97d1;_0x7d9b1c[_0x42586c(0x143)][_0x42586c(0x153)]('fefs');}));imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x157)]=gameWidth*upscaleShader+'px',imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x18b)]=gameHeight*upscaleShader+'px',imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x16c)]=_0x5d97d1(0x152),imgShader[_0x5d97d1(0x167)][_0x5d97d1(0x160)](_0x5d97d1(0x18c),upscaleShader+'px\x20'+upscaleShader+'px');}function setupWebGL(){const _0x3b3b52=a0_0x5be5e3;gl=bufferCanvas['getContext']('webgl2');if(!gl)return console[_0x3b3b52(0x162)]('WebGL2\x20not\x20supported'),null;gl[_0x3b3b52(0x18f)](0x0,0x0,bufferCanvas[_0x3b3b52(0x157)],bufferCanvas[_0x3b3b52(0x18b)]);}function createShader(_0x3c2188,_0x25acfc){const _0x433e01=a0_0x5be5e3,_0x1be969=gl[_0x433e01(0x144)](_0x3c2188);gl[_0x433e01(0x16d)](_0x1be969,_0x25acfc),gl[_0x433e01(0x175)](_0x1be969);if(!gl[_0x433e01(0x16a)](_0x1be969,gl[_0x433e01(0x183)]))return console[_0x433e01(0x162)](gl[_0x433e01(0x199)](_0x1be969)),gl[_0x433e01(0x13e)](_0x1be969),null;return _0x1be969;}async function setupShaders(){const _0xfdbe41=a0_0x5be5e3,_0x10c22e=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x2d791f=await loadShaderSource(_0xfdbe41(0x14a)),_0x12deb2=createShader(gl[_0xfdbe41(0x196)],_0x10c22e),_0x189f90=createShader(gl[_0xfdbe41(0x13c)],_0x2d791f);return program=gl[_0xfdbe41(0x197)](),gl[_0xfdbe41(0x1a2)](program,_0x12deb2),gl['attachShader'](program,_0x189f90),gl[_0xfdbe41(0x19e)](program),gl['useProgram'](program),program;}function setupTexture(){const _0x2459e8=a0_0x5be5e3;texture=gl[_0x2459e8(0x19c)](),gl[_0x2459e8(0x182)](gl['TEXTURE_2D'],texture),gl[_0x2459e8(0x171)](gl[_0x2459e8(0x19a)],gl[_0x2459e8(0x15d)],gl['NEAREST']),gl[_0x2459e8(0x171)](gl[_0x2459e8(0x19a)],gl[_0x2459e8(0x168)],gl['NEAREST']),gl[_0x2459e8(0x171)](gl[_0x2459e8(0x19a)],gl[_0x2459e8(0x18e)],gl['CLAMP_TO_EDGE']),gl['texParameteri'](gl['TEXTURE_2D'],gl[_0x2459e8(0x13b)],gl[_0x2459e8(0x193)]),gl[_0x2459e8(0x15a)](gl[_0x2459e8(0x158)](program,_0x2459e8(0x16f)),gameWidth,gameHeight),gl[_0x2459e8(0x15a)](gl[_0x2459e8(0x158)](program,_0x2459e8(0x174)),gl['canvas'][_0x2459e8(0x157)],gl[_0x2459e8(0x142)][_0x2459e8(0x18b)]),gl[_0x2459e8(0x169)](gl[_0x2459e8(0x158)](program,_0x2459e8(0x13d)),gameWidth/gl[_0x2459e8(0x142)][_0x2459e8(0x157)]),gl[_0x2459e8(0x169)](gl[_0x2459e8(0x158)](program,'smooth_height'),gameHeight/gl['canvas']['height']);}function setupBuffers(){const _0x331588=a0_0x5be5e3,_0x4a73b8=gl[_0x331588(0x19f)]();gl[_0x331588(0x184)](gl['ARRAY_BUFFER'],_0x4a73b8),gl[_0x331588(0x14e)](gl[_0x331588(0x179)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl['STATIC_DRAW']);const _0x1c992c=gl[_0x331588(0x15f)](program,_0x331588(0x176));gl[_0x331588(0x18a)](_0x1c992c),gl['vertexAttribPointer'](_0x1c992c,0x2,gl[_0x331588(0x140)],![],0x0,0x0);const _0x3b6812=gl[_0x331588(0x19f)]();gl[_0x331588(0x184)](gl['ARRAY_BUFFER'],_0x3b6812),gl[_0x331588(0x14e)](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x331588(0x19d)]);const _0x14bffa=gl['getAttribLocation'](program,_0x331588(0x15e));gl[_0x331588(0x18a)](_0x14bffa),gl[_0x331588(0x16b)](_0x14bffa,0x2,gl[_0x331588(0x140)],![],0x0,0x0);}async function renderPixel(_0x2a3137){const _0x113a7f=a0_0x5be5e3,_0x3619ce=a0_0x2317aa['getPixelData']();if(!_0x3619ce)return;await loadLUT64();const _0x4e7d7b=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x465c2b=0x0;_0x465c2b<gameHeight;_0x465c2b++){for(let _0x5bf68d=0x0;_0x5bf68d<gameWidth;_0x5bf68d++){const _0x51ddff=_0x465c2b*gameStride+_0x5bf68d,_0x476550=(_0x465c2b*gameWidth+_0x5bf68d)*0x4,_0x9b75a4=_0x3619ce[_0x51ddff],_0x1a1a2c=(_0x9b75a4&0xff)>>0x2,_0x22a252=(_0x9b75a4>>0x8&0xff)>>0x2,_0x238174=(_0x9b75a4>>0x10&0xff)>>0x2,_0x2daa58=(_0x1a1a2c*0x40*0x40+_0x22a252*0x40+_0x238174)*0x3;_0x4e7d7b[_0x476550]=lut64[_0x2daa58],_0x4e7d7b[_0x476550+0x1]=lut64[_0x2daa58+0x1],_0x4e7d7b[_0x476550+0x2]=lut64[_0x2daa58+0x2],_0x4e7d7b[_0x476550+0x3]=0xff;}}if(_0x2a3137===_0x113a7f(0x192))gl[_0x113a7f(0x182)](gl[_0x113a7f(0x19a)],texture),gl['texImage2D'](gl[_0x113a7f(0x19a)],0x0,gl[_0x113a7f(0x148)],gameWidth,gameHeight,0x0,gl[_0x113a7f(0x148)],gl[_0x113a7f(0x172)],_0x4e7d7b),gl[_0x113a7f(0x17d)](gl[_0x113a7f(0x178)]),gl[_0x113a7f(0x166)](gl[_0x113a7f(0x154)],0x0,0x4);else _0x2a3137==='2d'&&(!ctx2d&&(ctx2d=bufferCanvas[_0x113a7f(0x147)](_0x113a7f(0x156)),ctx2d[_0x113a7f(0x170)]=![]),(!imageDataObj||imageDataObj['width']!==gameWidth||imageDataObj[_0x113a7f(0x18b)]!==gameHeight)&&(imageDataObj=new ImageData(gameWidth,gameHeight)),imageDataObj[_0x113a7f(0x159)][_0x113a7f(0x1a1)](_0x4e7d7b),createImageBitmap(imageDataObj)[_0x113a7f(0x190)](_0x5354c9=>{ctx2d['transferFromImageBitmap'](_0x5354c9),_0x5354c9['close']();}));requestAnimationFrame(()=>renderPixel(_0x2a3137));}export async function switchRenderMode(_0x4d0d8d){const _0x378430=a0_0x5be5e3;systemType=gameName[_0x378430(0x18d)](-0x3);if(_0x4d0d8d==='2d')setupStyle('2d'),renderPixel('2d');else _0x4d0d8d===_0x378430(0x192)&&(setupStyle(_0x378430(0x192)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x378430(0x192)));}document[a0_0x5be5e3(0x181)]('DOMContentLoaded',function(){});