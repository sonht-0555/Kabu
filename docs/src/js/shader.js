const a0_0x2de435=a0_0xef6e;(function(_0x3c7428,_0x25fe2d){const _0x587301=a0_0xef6e,_0x3bb78f=_0x3c7428();while(!![]){try{const _0x14af7b=parseInt(_0x587301(0x106))/0x1*(-parseInt(_0x587301(0x14b))/0x2)+-parseInt(_0x587301(0x13d))/0x3*(-parseInt(_0x587301(0x133))/0x4)+parseInt(_0x587301(0x10b))/0x5*(-parseInt(_0x587301(0x153))/0x6)+parseInt(_0x587301(0x135))/0x7+parseInt(_0x587301(0xf5))/0x8*(-parseInt(_0x587301(0x140))/0x9)+-parseInt(_0x587301(0x11c))/0xa+parseInt(_0x587301(0x104))/0xb*(parseInt(_0x587301(0x118))/0xc);if(_0x14af7b===_0x25fe2d)break;else _0x3bb78f['push'](_0x3bb78f['shift']());}catch(_0x16e74a){_0x3bb78f['push'](_0x3bb78f['shift']());}}}(a0_0x2805,0xca60e));import*as a0_0x279be3 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document[a0_0x2de435(0x145)](a0_0x2de435(0x12c)),bufferCanvas=document[a0_0x2de435(0x145)](a0_0x2de435(0x13f)),canvasContainer=document['getElementById'](a0_0x2de435(0x134)),imgShader=document[a0_0x2de435(0x145)]('img-shader'),settingContainer=document[a0_0x2de435(0x114)](a0_0x2de435(0x10c)),messageContainer=document['querySelectorAll'](a0_0x2de435(0x120)),stateTitle=document[a0_0x2de435(0x114)](a0_0x2de435(0x13c));async function loadLUT64(){const _0x25cae2=a0_0x2de435;systemType=gameName[_0x25cae2(0x12b)](-0x3);const _0x1df82f=localStorage[_0x25cae2(0x14f)](gameName+_0x25cae2(0xf7))||'4.0',_0x4a6745=(localStorage[_0x25cae2(0x14f)](gameName+'_temperature')||'warm')[_0x25cae2(0x138)]();if(!lut64||lut64Streng!==_0x1df82f||lut64Profile!==_0x4a6745){const _0xb5f96=_0x25cae2(0x12a)+_0x4a6745+'_'+_0x1df82f+_0x25cae2(0xf2);console['log'](_0xb5f96);const _0xb0e226=await fetch(_0xb5f96),_0x357093=await _0xb0e226[_0x25cae2(0x14e)]();lut64=new Uint8Array(_0x357093),lut64Streng=_0x1df82f,lut64Profile=_0x4a6745;}}async function loadShaderSource(_0x3ce60c){const _0x5d217d=a0_0x2de435,_0x45cb07=await fetch(_0x3ce60c);return await _0x45cb07[_0x5d217d(0x131)]();}function setupStyle(_0x1f14dd){const _0x2d01f2=a0_0x2de435;clientWidth=document[_0x2d01f2(0x105)][_0x2d01f2(0xf1)];const _0x393d35=window[_0x2d01f2(0x10d)];systemType===_0x2d01f2(0x11d)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math['floor'](clientWidth*_0x393d35/gameWidth),localStorage[_0x2d01f2(0xf6)]('screenSize',_0x2d01f2(0x11e)+gameWidth*(integerScaling/_0x393d35)+','+gameHeight*(integerScaling/_0x393d35))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math[_0x2d01f2(0x12f)](clientWidth*_0x393d35/gameWidth),localStorage[_0x2d01f2(0xf6)]('screenSize',_0x2d01f2(0x11e)+gameWidth*(integerScaling/_0x393d35)+','+gameHeight*(integerScaling/_0x393d35)));if(_0x1f14dd==='2d')bufferCanvas[_0x2d01f2(0x11b)]=gameWidth,bufferCanvas[_0x2d01f2(0x125)]=gameHeight,bufferCanvas[_0x2d01f2(0x154)]['zoom']=''+integerScaling/_0x393d35,bufferCanvas['style']['imageRendering']=_0x2d01f2(0x10a),canvasContainer[_0x2d01f2(0x154)][_0x2d01f2(0x11b)]=gameWidth*(integerScaling/_0x393d35)+'px',canvasContainer[_0x2d01f2(0x154)]['height']=gameHeight*(integerScaling/_0x393d35)+'px',textured[_0x2d01f2(0x154)][_0x2d01f2(0x11b)]=gameWidth*(integerScaling/_0x393d35)+'px',textured[_0x2d01f2(0x154)][_0x2d01f2(0x125)]=gameHeight*(integerScaling/_0x393d35)+'px',imgShader['style']['transform']=_0x2d01f2(0xf4)+integerScaling/_0x393d35/upscaleShader+')',settingContainer[_0x2d01f2(0x13a)](function(_0x1f4250){const _0x5bd97b=_0x2d01f2;_0x1f4250[_0x5bd97b(0x154)][_0x5bd97b(0x11b)]=gameWidth*(integerScaling/_0x393d35)+'px',_0x1f4250[_0x5bd97b(0x154)][_0x5bd97b(0x125)]=gameHeight*(integerScaling/_0x393d35)+'px';}),messageContainer[_0x2d01f2(0x13a)](function(_0x79be34){const _0x2bdc4f=_0x2d01f2;_0x79be34[_0x2bdc4f(0x154)][_0x2bdc4f(0x11b)]=gameWidth+'px',_0x79be34[_0x2bdc4f(0x154)][_0x2bdc4f(0x125)]=gameHeight+'px',_0x79be34[_0x2bdc4f(0x154)]['zoom']=''+integerScaling/_0x393d35;}),stateTitle[_0x2d01f2(0x13a)](function(_0x5a4082){const _0x11b668=_0x2d01f2;_0x5a4082[_0x11b668(0x111)]['remove'](_0x11b668(0x139));});else _0x1f14dd===_0x2d01f2(0x102)&&(bufferCanvas[_0x2d01f2(0x11b)]=clientWidth*upscaleFactor,bufferCanvas[_0x2d01f2(0x125)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas['style'][_0x2d01f2(0x152)]=''+0x1/upscaleFactor,bufferCanvas[_0x2d01f2(0x154)][_0x2d01f2(0x141)]='',canvasContainer['style']['width']=clientWidth+'px',canvasContainer['style']['height']=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x2d01f2(0x154)][_0x2d01f2(0x11b)]=clientWidth+'px',textured[_0x2d01f2(0x154)][_0x2d01f2(0x125)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0x2d01f2(0x154)][_0x2d01f2(0x101)]='scale('+clientWidth/gameWidth/upscaleShader+')',settingContainer[_0x2d01f2(0x13a)](function(_0x570477){const _0x49a8ae=_0x2d01f2;_0x570477[_0x49a8ae(0x154)]['width']=clientWidth+'px',_0x570477[_0x49a8ae(0x154)][_0x49a8ae(0x125)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x2d01f2(0x13a)](function(_0x3ab6a0){const _0x4e8e71=_0x2d01f2;_0x3ab6a0[_0x4e8e71(0x154)][_0x4e8e71(0x11b)]=gameWidth+'px',_0x3ab6a0[_0x4e8e71(0x154)]['height']=gameHeight+'px',_0x3ab6a0['style'][_0x4e8e71(0x152)]=''+clientWidth/gameWidth;}),stateTitle[_0x2d01f2(0x13a)](function(_0x3b368e){const _0x108dc8=_0x2d01f2;_0x3b368e[_0x108dc8(0x111)][_0x108dc8(0x12d)](_0x108dc8(0x139));}));imgShader[_0x2d01f2(0x154)][_0x2d01f2(0x11b)]=gameWidth*upscaleShader+'px',imgShader[_0x2d01f2(0x154)][_0x2d01f2(0x125)]=gameHeight*upscaleShader+'px',imgShader[_0x2d01f2(0x154)]['transformOrigin']=_0x2d01f2(0x155),imgShader['style']['setProperty'](_0x2d01f2(0x143),upscaleShader+_0x2d01f2(0x10e)+upscaleShader+'px');}function a0_0xef6e(_0x185a4e,_0x4bd42d){const _0x280531=a0_0x2805();return a0_0xef6e=function(_0xef6eb2,_0x22d1aa){_0xef6eb2=_0xef6eb2-0xf0;let _0x490d71=_0x280531[_0xef6eb2];return _0x490d71;},a0_0xef6e(_0x185a4e,_0x4bd42d);}function setupWebGL(){const _0x5a7c43=a0_0x2de435;gl=bufferCanvas[_0x5a7c43(0x107)](_0x5a7c43(0x102));if(!gl)return console['error']('WebGL2\x20not\x20supported'),null;gl[_0x5a7c43(0x116)](0x0,0x0,bufferCanvas[_0x5a7c43(0x11b)],bufferCanvas[_0x5a7c43(0x125)]);}function createShader(_0x5d5698,_0x449741){const _0x5dc99f=a0_0x2de435,_0x31e288=gl[_0x5dc99f(0x148)](_0x5d5698);gl[_0x5dc99f(0x100)](_0x31e288,_0x449741),gl[_0x5dc99f(0x108)](_0x31e288);if(!gl[_0x5dc99f(0x13b)](_0x31e288,gl[_0x5dc99f(0x12e)]))return console[_0x5dc99f(0xfa)](gl[_0x5dc99f(0xfb)](_0x31e288)),gl['deleteShader'](_0x31e288),null;return _0x31e288;}function a0_0x2805(){const _0x166fb7=['textured','add','COMPILE_STATUS','floor','TEXTURE_MAG_FILTER','text','bindBuffer','2253528KyJmPC','canvas-container','10471636SMYIGa','bufferData','getAttribLocation','toLowerCase','fefs','forEach','getShaderParameter','.stateTitle,\x20.stateDate','3pMLEsN','UNSIGNED_BYTE','canvas','225pocYpK','imageRendering','RGBA','--bg-size','TEXTURE_WRAP_S','getElementById','TRIANGLE_STRIP','FLOAT','createShader','TEXTURE_WRAP_T','TEXTURE_2D','173644VItWQt','./src/shaders/vertexShader.glsl','STATIC_DRAW','arrayBuffer','getItem','ARRAY_BUFFER','./src/shaders/fragmentShader.glsl','zoom','6BuSTfN','style','top\x20center','TEXTURE_MIN_FILTER','clientWidth','.bin','FRAGMENT_SHADER','scale(','225640PihWzX','setItem','_streng','uniform1f','createTexture','error','getShaderInfoLog','then','game_size','vertexAttribPointer','getUniformLocation','shaderSource','transform','webgl2','useProgram','132396xFggfS','documentElement','15evlsDl','getContext','compileShader','VERTEX_SHADER','crisp-edges','5621375FovLYo','.setting-container','devicePixelRatio','px\x20','drawArrays','attachShader','classList','smooth_height','createBuffer','querySelectorAll','bindTexture','viewport','texParameteri','3396xKxUQr','smooth_width','uniform2f','width','15048460NCMIur','gbc','0,0,','COLOR_BUFFER_BIT','.message-container','imageSmoothingEnabled','clear','render_size','NEAREST','height','addEventListener','CLAMP_TO_EDGE','enableVertexAttribArray','getPixelData','./src/lut/lut64_','slice'];a0_0x2805=function(){return _0x166fb7;};return a0_0x2805();}async function setupShaders(){const _0x1fa536=a0_0x2de435,_0x36234d=await loadShaderSource(_0x1fa536(0x14c)),_0x1e0163=await loadShaderSource(_0x1fa536(0x151)),_0x392218=createShader(gl[_0x1fa536(0x109)],_0x36234d),_0x30366d=createShader(gl[_0x1fa536(0xf3)],_0x1e0163);return program=gl['createProgram'](),gl[_0x1fa536(0x110)](program,_0x392218),gl['attachShader'](program,_0x30366d),gl['linkProgram'](program),gl[_0x1fa536(0x103)](program),program;}function setupTexture(){const _0x47a4ae=a0_0x2de435;texture=gl[_0x47a4ae(0xf9)](),gl[_0x47a4ae(0x115)](gl['TEXTURE_2D'],texture),gl[_0x47a4ae(0x117)](gl['TEXTURE_2D'],gl[_0x47a4ae(0xf0)],gl[_0x47a4ae(0x124)]),gl[_0x47a4ae(0x117)](gl['TEXTURE_2D'],gl[_0x47a4ae(0x130)],gl[_0x47a4ae(0x124)]),gl[_0x47a4ae(0x117)](gl[_0x47a4ae(0x14a)],gl[_0x47a4ae(0x144)],gl[_0x47a4ae(0x127)]),gl[_0x47a4ae(0x117)](gl[_0x47a4ae(0x14a)],gl[_0x47a4ae(0x149)],gl[_0x47a4ae(0x127)]),gl[_0x47a4ae(0x11a)](gl['getUniformLocation'](program,_0x47a4ae(0xfd)),gameWidth,gameHeight),gl[_0x47a4ae(0x11a)](gl['getUniformLocation'](program,_0x47a4ae(0x123)),gl[_0x47a4ae(0x13f)][_0x47a4ae(0x11b)],gl[_0x47a4ae(0x13f)][_0x47a4ae(0x125)]),gl[_0x47a4ae(0xf8)](gl[_0x47a4ae(0xff)](program,_0x47a4ae(0x119)),gameWidth/gl['canvas']['width']),gl[_0x47a4ae(0xf8)](gl['getUniformLocation'](program,_0x47a4ae(0x112)),gameHeight/gl['canvas']['height']);}function setupBuffers(){const _0x221142=a0_0x2de435,_0x4ab6a0=gl[_0x221142(0x113)]();gl['bindBuffer'](gl[_0x221142(0x150)],_0x4ab6a0),gl[_0x221142(0x136)](gl[_0x221142(0x150)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl['STATIC_DRAW']);const _0x192de6=gl[_0x221142(0x137)](program,'position');gl['enableVertexAttribArray'](_0x192de6),gl['vertexAttribPointer'](_0x192de6,0x2,gl[_0x221142(0x147)],![],0x0,0x0);const _0x1dc0ed=gl[_0x221142(0x113)]();gl[_0x221142(0x132)](gl[_0x221142(0x150)],_0x1dc0ed),gl[_0x221142(0x136)](gl[_0x221142(0x150)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x221142(0x14d)]);const _0x345011=gl[_0x221142(0x137)](program,'texcoord');gl[_0x221142(0x128)](_0x345011),gl[_0x221142(0xfe)](_0x345011,0x2,gl[_0x221142(0x147)],![],0x0,0x0);}async function renderPixel(_0x2250fd){const _0x3c6b5d=a0_0x2de435,_0x652be=a0_0x279be3[_0x3c6b5d(0x129)]();if(!_0x652be)return;await loadLUT64();const _0x2590c8=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x403a9a=0x0;_0x403a9a<gameHeight;_0x403a9a++){for(let _0x25633a=0x0;_0x25633a<gameWidth;_0x25633a++){const _0x5e99ec=_0x403a9a*gameStride+_0x25633a,_0x416d1a=(_0x403a9a*gameWidth+_0x25633a)*0x4,_0x5775f6=_0x652be[_0x5e99ec],_0x113995=(_0x5775f6&0xff)>>0x2,_0x4868f1=(_0x5775f6>>0x8&0xff)>>0x2,_0x3f504b=(_0x5775f6>>0x10&0xff)>>0x2,_0x4c7968=(_0x113995*0x40*0x40+_0x4868f1*0x40+_0x3f504b)*0x3;_0x2590c8[_0x416d1a]=lut64[_0x4c7968],_0x2590c8[_0x416d1a+0x1]=lut64[_0x4c7968+0x1],_0x2590c8[_0x416d1a+0x2]=lut64[_0x4c7968+0x2],_0x2590c8[_0x416d1a+0x3]=0xff;}}if(_0x2250fd===_0x3c6b5d(0x102))gl['bindTexture'](gl[_0x3c6b5d(0x14a)],texture),gl['texImage2D'](gl[_0x3c6b5d(0x14a)],0x0,gl[_0x3c6b5d(0x142)],gameWidth,gameHeight,0x0,gl[_0x3c6b5d(0x142)],gl[_0x3c6b5d(0x13e)],_0x2590c8),gl[_0x3c6b5d(0x122)](gl[_0x3c6b5d(0x11f)]),gl[_0x3c6b5d(0x10f)](gl[_0x3c6b5d(0x146)],0x0,0x4);else{if(_0x2250fd==='2d'){ctx2d=bufferCanvas[_0x3c6b5d(0x107)]('2d'),ctx2d[_0x3c6b5d(0x121)]=![];const _0x1fecbc=new ImageData(_0x2590c8,gameWidth,gameHeight);createImageBitmap(_0x1fecbc)[_0x3c6b5d(0xfc)](_0xac9f=>{const _0x47832c=_0x3c6b5d;ctx2d['clearRect'](0x0,0x0,bufferCanvas[_0x47832c(0x11b)],bufferCanvas['height']),ctx2d['drawImage'](_0xac9f,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x2250fd));}export async function switchRenderMode(_0x1df755){const _0x1bb71e=a0_0x2de435;systemType=gameName['slice'](-0x3);if(_0x1df755==='2d')setupStyle('2d'),renderPixel('2d');else _0x1df755===_0x1bb71e(0x102)&&(setupStyle(_0x1bb71e(0x102)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x1bb71e(0x102)));}document[a0_0x2de435(0x126)]('DOMContentLoaded',function(){});