(function(_0x2c5bc9,_0x170220){const _0x5231ed=a0_0x179f,_0x2f30cf=_0x2c5bc9();while(!![]){try{const _0x1373bf=parseInt(_0x5231ed(0x118))/0x1*(parseInt(_0x5231ed(0x120))/0x2)+parseInt(_0x5231ed(0x13e))/0x3+parseInt(_0x5231ed(0x128))/0x4*(parseInt(_0x5231ed(0x15a))/0x5)+parseInt(_0x5231ed(0x152))/0x6+parseInt(_0x5231ed(0x14b))/0x7*(parseInt(_0x5231ed(0x13f))/0x8)+parseInt(_0x5231ed(0x158))/0x9*(parseInt(_0x5231ed(0x148))/0xa)+-parseInt(_0x5231ed(0x132))/0xb;if(_0x1373bf===_0x170220)break;else _0x2f30cf['push'](_0x2f30cf['shift']());}catch(_0xf68f4b){_0x2f30cf['push'](_0x2f30cf['shift']());}}}(a0_0x146b,0x9c30f));import*as a0_0x3f3409 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x1b7598=a0_0x179f;systemType=gameName['slice'](-0x3);const _0x1aabfb=(localStorage[_0x1b7598(0x141)](gameName+_0x1b7598(0x12f))||_0x1b7598(0x13a))[_0x1b7598(0x137)]();if(!lut64||lut64Profile!==_0x1aabfb){const _0xaf91ed='./src/lut/lut64_'+_0x1aabfb+_0x1b7598(0x12e);console['log'](_0xaf91ed);const _0x546cf8=await fetch(_0xaf91ed),_0x78b226=await _0x546cf8[_0x1b7598(0x122)]();lut64=new Uint8Array(_0x78b226),lut64Profile=_0x1aabfb;}}function a0_0x146b(){const _0x26ce29=['5TstOGO','createProgram','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','height','6629lSeTrL','uniform1f','TEXTURE_WRAP_T','FRAGMENT_SHADER','useProgram','FLOAT','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','canvas','160HpvNpQ','drawArrays','arrayBuffer','webgl','bufferData','TEXTURE_MIN_FILTER','texcoord','TEXTURE_MAG_FILTER','3040428rShRZb','linkProgram','vertexAttribPointer','width','getAttribLocation','low-power','_4.0.bin','_temperature','createShader','enableVertexAttribArray','47593579yfWqAu','position','shaderSource','clear','bindBuffer','toLowerCase','data','TEXTURE_WRAP_S','none','getUniformLocation','clearRect','uniform2f','1659957wpswKs','69224DkjCLy','putImageData','getItem','render_size','TEXTURE_2D','UNSIGNED_BYTE','CLAMP_TO_EDGE','viewport','smooth_width','444710ZpWhpd','getContext','VERTEX_SHADER','644uuigym','ARRAY_BUFFER','attachShader','texImage2D','texParameteri','STATIC_DRAW','set','7022280avrPar','smooth_height','TRIANGLE_STRIP','webgl_full','slice','RGBA','234GUeLdz','createBuffer'];a0_0x146b=function(){return _0x26ce29;};return a0_0x146b();}function a0_0x179f(_0x3da1b6,_0x260ffd){const _0x146b5b=a0_0x146b();return a0_0x179f=function(_0x179f18,_0x4e36bf){_0x179f18=_0x179f18-0x114;let _0xad09b9=_0x146b5b[_0x179f18];return _0xad09b9;},a0_0x179f(_0x3da1b6,_0x260ffd);}function setupWebGL_Shader(_0x4935b2){const _0x2e8f7d=a0_0x179f;gl=bufferCanvas[_0x2e8f7d(0x149)](_0x2e8f7d(0x123),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x2e8f7d(0x12d)}),gl[_0x2e8f7d(0x146)](0x0,0x0,bufferCanvas[_0x2e8f7d(0x12b)],bufferCanvas[_0x2e8f7d(0x117)]);function _0x38d783(_0x45eebd,_0x1d7dc9){const _0x4b4a96=_0x2e8f7d,_0x1670ee=gl[_0x4b4a96(0x130)](_0x45eebd);return gl[_0x4b4a96(0x134)](_0x1670ee,_0x1d7dc9),gl['compileShader'](_0x1670ee),_0x1670ee;}vs=_0x2e8f7d(0x11e);if(_0x4935b2===_0x2e8f7d(0x123))fs=_0x2e8f7d(0x116);else _0x4935b2==='webgl_full'&&(fs=_0x2e8f7d(0x115));const _0x3ca725=_0x38d783(gl[_0x2e8f7d(0x14a)],vs),_0x34708c=_0x38d783(gl[_0x2e8f7d(0x11b)],fs);return program=gl[_0x2e8f7d(0x114)](),gl['attachShader'](program,_0x3ca725),gl[_0x2e8f7d(0x14d)](program,_0x34708c),gl[_0x2e8f7d(0x129)](program),gl[_0x2e8f7d(0x11c)](program),program;}function setupTexture_Buffer(_0x1e4e78){const _0x1f0a30=a0_0x179f;texture=gl['createTexture'](),gl['bindTexture'](gl[_0x1f0a30(0x143)],texture),gl['texParameteri'](gl[_0x1f0a30(0x143)],gl[_0x1f0a30(0x125)],gl['NEAREST']),gl[_0x1f0a30(0x14f)](gl[_0x1f0a30(0x143)],gl[_0x1f0a30(0x127)],gl['NEAREST']),gl['texParameteri'](gl[_0x1f0a30(0x143)],gl[_0x1f0a30(0x139)],gl[_0x1f0a30(0x145)]),gl['texParameteri'](gl[_0x1f0a30(0x143)],gl[_0x1f0a30(0x11a)],gl[_0x1f0a30(0x145)]);_0x1e4e78==='webgl_full'&&(gl['uniform2f'](gl[_0x1f0a30(0x13b)](program,'game_size'),gameWidth,gameHeight),gl[_0x1f0a30(0x13d)](gl[_0x1f0a30(0x13b)](program,_0x1f0a30(0x142)),gl[_0x1f0a30(0x11f)][_0x1f0a30(0x12b)],gl['canvas'][_0x1f0a30(0x117)]),gl[_0x1f0a30(0x119)](gl[_0x1f0a30(0x13b)](program,_0x1f0a30(0x147)),gameWidth/gl[_0x1f0a30(0x11f)][_0x1f0a30(0x12b)]),gl[_0x1f0a30(0x119)](gl['getUniformLocation'](program,_0x1f0a30(0x153)),gameHeight/gl[_0x1f0a30(0x11f)][_0x1f0a30(0x117)]));const _0x402c1f=gl[_0x1f0a30(0x159)]();gl[_0x1f0a30(0x136)](gl[_0x1f0a30(0x14c)],_0x402c1f),gl[_0x1f0a30(0x124)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x1f0a30(0x150)]),gl[_0x1f0a30(0x12a)](gl[_0x1f0a30(0x12c)](program,_0x1f0a30(0x133)),0x2,gl[_0x1f0a30(0x11d)],![],0x0,0x0),gl[_0x1f0a30(0x131)](gl[_0x1f0a30(0x12c)](program,'position'));const _0x4e430c=gl[_0x1f0a30(0x159)]();gl[_0x1f0a30(0x136)](gl[_0x1f0a30(0x14c)],_0x4e430c),gl[_0x1f0a30(0x124)](gl[_0x1f0a30(0x14c)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl[_0x1f0a30(0x12a)](gl[_0x1f0a30(0x12c)](program,_0x1f0a30(0x126)),0x2,gl[_0x1f0a30(0x11d)],![],0x0,0x0),gl['enableVertexAttribArray'](gl[_0x1f0a30(0x12c)](program,'texcoord'));}function setup2DContext(){const _0x5627f3=a0_0x179f;ctx2d=bufferCanvas[_0x5627f3(0x149)]('2d'),ctx2d['imageSmoothingEnabled']=![];}async function renderPixel(_0x99e5ae){const _0x578404=a0_0x179f,_0x41cd56=a0_0x3f3409['getPixelData']();if(!_0x41cd56)return;await loadLUT64();const _0x455e2d=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x24077f=0x0;_0x24077f<gameHeight;_0x24077f++){for(let _0x1eed38=0x0;_0x1eed38<gameWidth;_0x1eed38++){const _0x1bc2e6=_0x24077f*gameStride+_0x1eed38,_0x51ce6b=(_0x24077f*gameWidth+_0x1eed38)*0x4,_0x3b5536=_0x41cd56[_0x1bc2e6];if(lut64Profile===_0x578404(0x13a))_0x455e2d[_0x51ce6b]=_0x3b5536&0xff,_0x455e2d[_0x51ce6b+0x1]=_0x3b5536>>0x8&0xff,_0x455e2d[_0x51ce6b+0x2]=_0x3b5536>>0x10&0xff,_0x455e2d[_0x51ce6b+0x3]=0xff;else{const _0x17a40d=(_0x3b5536&0xff)>>0x2,_0x59200c=(_0x3b5536>>0x8&0xff)>>0x2,_0x341b3e=(_0x3b5536>>0x10&0xff)>>0x2,_0x6a59a8=(_0x17a40d*0x40*0x40+_0x59200c*0x40+_0x341b3e)*0x3;_0x455e2d[_0x51ce6b]=lut64[_0x6a59a8],_0x455e2d[_0x51ce6b+0x1]=lut64[_0x6a59a8+0x1],_0x455e2d[_0x51ce6b+0x2]=lut64[_0x6a59a8+0x2],_0x455e2d[_0x51ce6b+0x3]=0xff;}}}if(_0x99e5ae===_0x578404(0x123))gl[_0x578404(0x14e)](gl[_0x578404(0x143)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x578404(0x157)],gl[_0x578404(0x144)],_0x455e2d),gl[_0x578404(0x135)](gl['COLOR_BUFFER_BIT']),gl[_0x578404(0x121)](gl[_0x578404(0x154)],0x0,0x4);else _0x99e5ae==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x455e2d,gameWidth,gameHeight):imageDataObj[_0x578404(0x138)][_0x578404(0x151)](_0x455e2d),ctx2d[_0x578404(0x13c)](0x0,0x0,bufferCanvas[_0x578404(0x12b)],bufferCanvas[_0x578404(0x117)]),ctx2d[_0x578404(0x140)](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x99e5ae));}export async function switchRenderMode(_0x2759ed){const _0x259a29=a0_0x179f;systemType=gameName[_0x259a29(0x156)](-0x3);if(_0x2759ed==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x2759ed===_0x259a29(0x123))setupStyle('2d'),setupWebGL_Shader('webgl'),setupTexture_Buffer(_0x259a29(0x123)),renderPixel('webgl');else _0x2759ed==='webgl_full'&&(setupStyle(_0x259a29(0x155)),setupWebGL_Shader(_0x259a29(0x155)),setupTexture_Buffer('webgl_full'),renderPixel('webgl'));}}