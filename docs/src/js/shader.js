(function(_0x55c31e,_0x5ab455){const _0xf622cb=a0_0xc8da,_0x1b469b=_0x55c31e();while(!![]){try{const _0x695fb=-parseInt(_0xf622cb(0xd4))/0x1*(parseInt(_0xf622cb(0xfb))/0x2)+-parseInt(_0xf622cb(0xca))/0x3*(-parseInt(_0xf622cb(0xd7))/0x4)+-parseInt(_0xf622cb(0xec))/0x5+-parseInt(_0xf622cb(0xed))/0x6+parseInt(_0xf622cb(0xf2))/0x7+-parseInt(_0xf622cb(0xf9))/0x8*(parseInt(_0xf622cb(0xde))/0x9)+parseInt(_0xf622cb(0xf5))/0xa;if(_0x695fb===_0x5ab455)break;else _0x1b469b['push'](_0x1b469b['shift']());}catch(_0x52bdf4){_0x1b469b['push'](_0x1b469b['shift']());}}}(a0_0x47aa,0x2abb5));import*as a0_0x208a49 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x3e3b28=a0_0xc8da;systemType=gameName[_0x3e3b28(0xcf)](-0x3);const _0x3772da=(localStorage[_0x3e3b28(0xd0)](gameName+_0x3e3b28(0xe0))||'none')[_0x3e3b28(0xce)]();if(!lut64||lut64Profile!==_0x3772da){const _0x1ec3e6=_0x3e3b28(0xc2)+_0x3772da+_0x3e3b28(0xfd);console['log'](_0x1ec3e6);const _0x5310da=await fetch(_0x1ec3e6),_0x17da54=await _0x5310da['arrayBuffer']();lut64=new Uint8Array(_0x17da54),lut64Profile=_0x3772da;}}function a0_0x47aa(){const _0x3865c1=['18fRqrwP','enableVertexAttribArray','TEXTURE_MIN_FILTER','STATIC_DRAW','toLowerCase','slice','getItem','CLAMP_TO_EDGE','createTexture','createShader','2XOAPSA','useProgram','height','229376lznZDF','bindBuffer','clearRect','getContext','low-power','VERTEX_SHADER','webgl_full','9ubfGZY','getAttribLocation','_temperature','getUniformLocation','RGBA','TEXTURE_WRAP_S','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','render_size','webgl','UNSIGNED_BYTE','texParameteri','vertexAttribPointer','TRIANGLE_STRIP','position','301840VcSjVQ','1754676dJYokv','NEAREST','createBuffer','none','getPixelData','2393132ydvlQk','texcoord','imageSmoothingEnabled','2498770anVknv','uniform1f','smooth_width','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','2738704uHaUks','compileShader','65636jSOwNq','canvas','_4.0.bin','drawArrays','TEXTURE_2D','width','set','bindTexture','ARRAY_BUFFER','./src/lut/lut64_','texImage2D','shaderSource','game_size','FLOAT','attachShader','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','clear'];a0_0x47aa=function(){return _0x3865c1;};return a0_0x47aa();}function setupWebGL_Shader(_0x3a7628){const _0x5e46b2=a0_0xc8da;gl=bufferCanvas['getContext']('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':_0x5e46b2(0xdb)}),gl['viewport'](0x0,0x0,bufferCanvas[_0x5e46b2(0xbe)],bufferCanvas[_0x5e46b2(0xd6)]);function _0x17be09(_0x777502,_0x76da43){const _0x2c681f=_0x5e46b2,_0x7a311d=gl[_0x2c681f(0xd3)](_0x777502);return gl[_0x2c681f(0xc4)](_0x7a311d,_0x76da43),gl[_0x2c681f(0xfa)](_0x7a311d),_0x7a311d;}vs=_0x5e46b2(0xc8);if(_0x3a7628===_0x5e46b2(0xe6))fs=_0x5e46b2(0xe4);else _0x3a7628===_0x5e46b2(0xdd)&&(fs=_0x5e46b2(0xf8));const _0x2eb64e=_0x17be09(gl[_0x5e46b2(0xdc)],vs),_0x147750=_0x17be09(gl['FRAGMENT_SHADER'],fs);return program=gl['createProgram'](),gl[_0x5e46b2(0xc7)](program,_0x2eb64e),gl[_0x5e46b2(0xc7)](program,_0x147750),gl['linkProgram'](program),gl[_0x5e46b2(0xd5)](program),program;}function a0_0xc8da(_0x245b98,_0xa4d7cd){const _0x47aaf4=a0_0x47aa();return a0_0xc8da=function(_0xc8da67,_0x2af24e){_0xc8da67=_0xc8da67-0xbd;let _0x301b37=_0x47aaf4[_0xc8da67];return _0x301b37;},a0_0xc8da(_0x245b98,_0xa4d7cd);}function setupTexture_Buffer(_0x5a857b){const _0x4c6b5b=a0_0xc8da;texture=gl[_0x4c6b5b(0xd2)](),gl[_0x4c6b5b(0xc0)](gl['TEXTURE_2D'],texture),gl[_0x4c6b5b(0xe8)](gl[_0x4c6b5b(0xbd)],gl[_0x4c6b5b(0xcc)],gl[_0x4c6b5b(0xee)]),gl['texParameteri'](gl[_0x4c6b5b(0xbd)],gl['TEXTURE_MAG_FILTER'],gl['NEAREST']),gl[_0x4c6b5b(0xe8)](gl['TEXTURE_2D'],gl[_0x4c6b5b(0xe3)],gl[_0x4c6b5b(0xd1)]),gl[_0x4c6b5b(0xe8)](gl[_0x4c6b5b(0xbd)],gl['TEXTURE_WRAP_T'],gl[_0x4c6b5b(0xd1)]);_0x5a857b===_0x4c6b5b(0xdd)&&(gl['uniform2f'](gl[_0x4c6b5b(0xe1)](program,_0x4c6b5b(0xc5)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x4c6b5b(0xe1)](program,_0x4c6b5b(0xe5)),gl['canvas'][_0x4c6b5b(0xbe)],gl[_0x4c6b5b(0xfc)][_0x4c6b5b(0xd6)]),gl[_0x4c6b5b(0xf6)](gl[_0x4c6b5b(0xe1)](program,_0x4c6b5b(0xf7)),gameWidth/gl[_0x4c6b5b(0xfc)]['width']),gl[_0x4c6b5b(0xf6)](gl['getUniformLocation'](program,'smooth_height'),gameHeight/gl['canvas'][_0x4c6b5b(0xd6)]));const _0x330de4=gl['createBuffer']();gl[_0x4c6b5b(0xd8)](gl[_0x4c6b5b(0xc1)],_0x330de4),gl['bufferData'](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x4c6b5b(0xcd)]),gl[_0x4c6b5b(0xe9)](gl['getAttribLocation'](program,_0x4c6b5b(0xeb)),0x2,gl[_0x4c6b5b(0xc6)],![],0x0,0x0),gl[_0x4c6b5b(0xcb)](gl[_0x4c6b5b(0xdf)](program,_0x4c6b5b(0xeb)));const _0x160948=gl[_0x4c6b5b(0xef)]();gl[_0x4c6b5b(0xd8)](gl[_0x4c6b5b(0xc1)],_0x160948),gl['bufferData'](gl[_0x4c6b5b(0xc1)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x4c6b5b(0xcd)]),gl[_0x4c6b5b(0xe9)](gl[_0x4c6b5b(0xdf)](program,'texcoord'),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x4c6b5b(0xcb)](gl[_0x4c6b5b(0xdf)](program,_0x4c6b5b(0xf3)));}function setup2DContext(){const _0x358467=a0_0xc8da;ctx2d=bufferCanvas[_0x358467(0xda)]('2d'),ctx2d[_0x358467(0xf4)]=![];}async function renderPixel(_0x26d20f){const _0x460abd=a0_0xc8da,_0x5612f7=a0_0x208a49[_0x460abd(0xf1)]();if(!_0x5612f7)return;await loadLUT64();const _0xa9580d=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x3578ef=0x0;_0x3578ef<gameHeight;_0x3578ef++){for(let _0x3fd3a9=0x0;_0x3fd3a9<gameWidth;_0x3fd3a9++){const _0x48b314=_0x3578ef*gameStride+_0x3fd3a9,_0x20551f=(_0x3578ef*gameWidth+_0x3fd3a9)*0x4,_0x14e7c0=_0x5612f7[_0x48b314];if(lut64Profile===_0x460abd(0xf0))_0xa9580d[_0x20551f]=_0x14e7c0&0xff,_0xa9580d[_0x20551f+0x1]=_0x14e7c0>>0x8&0xff,_0xa9580d[_0x20551f+0x2]=_0x14e7c0>>0x10&0xff,_0xa9580d[_0x20551f+0x3]=0xff;else{const _0x158a2e=(_0x14e7c0&0xff)>>0x2,_0x22c883=(_0x14e7c0>>0x8&0xff)>>0x2,_0x1361c6=(_0x14e7c0>>0x10&0xff)>>0x2,_0x33f07d=(_0x158a2e*0x40*0x40+_0x22c883*0x40+_0x1361c6)*0x3;_0xa9580d[_0x20551f]=lut64[_0x33f07d],_0xa9580d[_0x20551f+0x1]=lut64[_0x33f07d+0x1],_0xa9580d[_0x20551f+0x2]=lut64[_0x33f07d+0x2],_0xa9580d[_0x20551f+0x3]=0xff;}}}if(_0x26d20f==='webgl')gl[_0x460abd(0xc3)](gl['TEXTURE_2D'],0x0,gl[_0x460abd(0xe2)],gameWidth,gameHeight,0x0,gl['RGBA'],gl[_0x460abd(0xe7)],_0xa9580d),gl[_0x460abd(0xc9)](gl['COLOR_BUFFER_BIT']),gl[_0x460abd(0xfe)](gl[_0x460abd(0xea)],0x0,0x4);else _0x26d20f==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0xa9580d,gameWidth,gameHeight):imageDataObj['data'][_0x460abd(0xbf)](_0xa9580d),ctx2d[_0x460abd(0xd9)](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x460abd(0xd6)]),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x26d20f));}export async function switchRenderMode(_0x3a2e1f){const _0x390550=a0_0xc8da;systemType=gameName[_0x390550(0xcf)](-0x3);if(_0x3a2e1f==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x3a2e1f===_0x390550(0xe6))setupStyle('2d'),setupWebGL_Shader(_0x390550(0xe6)),setupTexture_Buffer(_0x390550(0xe6)),renderPixel(_0x390550(0xe6));else _0x3a2e1f===_0x390550(0xdd)&&(setupStyle(_0x390550(0xdd)),setupWebGL_Shader('webgl_full'),setupTexture_Buffer(_0x390550(0xdd)),renderPixel(_0x390550(0xe6)));}}