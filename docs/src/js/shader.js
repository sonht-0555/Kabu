(function(_0x3c71c2,_0x3b58dc){const _0x583244=a0_0x3508,_0x22bc43=_0x3c71c2();while(!![]){try{const _0x981ce1=-parseInt(_0x583244(0x1de))/0x1*(-parseInt(_0x583244(0x1e8))/0x2)+-parseInt(_0x583244(0x1d4))/0x3*(-parseInt(_0x583244(0x1d8))/0x4)+-parseInt(_0x583244(0x1d6))/0x5*(-parseInt(_0x583244(0x1b0))/0x6)+-parseInt(_0x583244(0x1d2))/0x7+parseInt(_0x583244(0x1b9))/0x8*(parseInt(_0x583244(0x1b4))/0x9)+-parseInt(_0x583244(0x1c3))/0xa+parseInt(_0x583244(0x1cf))/0xb*(-parseInt(_0x583244(0x1b2))/0xc);if(_0x981ce1===_0x3b58dc)break;else _0x22bc43['push'](_0x22bc43['shift']());}catch(_0x247198){_0x22bc43['push'](_0x22bc43['shift']());}}}(a0_0x3d32,0xbdc73));import*as a0_0x338961 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;function a0_0x3d32(){const _0x1cd6db=['getContext','ARRAY_BUFFER','NEAREST','createShader','bindBuffer','TRIANGLE_STRIP','TEXTURE_WRAP_T','getAttribLocation','linkProgram','5434820NNHTDE','drawArrays','position','width','uniform1f','slice','shaderSource','TEXTURE_2D','TEXTURE_WRAP_S','vertexAttribPointer','canvas','clearRect','11vsiITd','CLAMP_TO_EDGE','webgl','865585QBsptn','enableVertexAttribArray','1140753Dnhkve','_4.0.bin','729305eoaGFd','webgl_full','4tHYyFY','texParameteri','_temperature','getUniformLocation','smooth_height','texcoord','26387xqOPrU','arrayBuffer','COLOR_BUFFER_BIT','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}','TEXTURE_MIN_FILTER','viewport','imageSmoothingEnabled','useProgram','getPixelData','set','74rEZHgA','texImage2D','STATIC_DRAW','createTexture','clear','data','./src/lut/lut64_','bufferData','height','VERTEX_SHADER','UNSIGNED_BYTE','RGBA','36vssDEL','createBuffer','18134148cvaEwr','uniform2f','153tWPsJL','attachShader','compileShader','toLowerCase','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','340664LVFzex'];a0_0x3d32=function(){return _0x1cd6db;};return a0_0x3d32();}async function loadLUT64(){const _0x569c5d=a0_0x3508;systemType=gameName['slice'](-0x3);const _0x3345db=(localStorage['getItem'](gameName+_0x569c5d(0x1da))||'none')[_0x569c5d(0x1b7)]();if(!lut64||lut64Profile!==_0x3345db){const _0x3073f9=_0x569c5d(0x1aa)+_0x3345db+_0x569c5d(0x1d5);console['log'](_0x3073f9);const _0x45a176=await fetch(_0x3073f9),_0x23fb14=await _0x45a176[_0x569c5d(0x1df)]();lut64=new Uint8Array(_0x23fb14),lut64Profile=_0x3345db;}}function a0_0x3508(_0x3f4e86,_0x249cd1){const _0x3d32f7=a0_0x3d32();return a0_0x3508=function(_0x35083a,_0x254644){_0x35083a=_0x35083a-0x1a9;let _0x57abd8=_0x3d32f7[_0x35083a];return _0x57abd8;},a0_0x3508(_0x3f4e86,_0x249cd1);}function setupWebGL_Shader(_0x3bbccc){const _0x5c2ed8=a0_0x3508;gl=bufferCanvas[_0x5c2ed8(0x1ba)](_0x5c2ed8(0x1d1),{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':'low-power'}),gl[_0x5c2ed8(0x1e3)](0x0,0x0,bufferCanvas[_0x5c2ed8(0x1c6)],bufferCanvas['height']);function _0x247b7a(_0x2f3544,_0x23471f){const _0x23a50b=_0x5c2ed8,_0x1d7345=gl[_0x23a50b(0x1bd)](_0x2f3544);return gl[_0x23a50b(0x1c9)](_0x1d7345,_0x23471f),gl[_0x23a50b(0x1b6)](_0x1d7345),_0x1d7345;}vs=_0x5c2ed8(0x1b8);if(_0x3bbccc===_0x5c2ed8(0x1d1))fs=_0x5c2ed8(0x1e1);else _0x3bbccc===_0x5c2ed8(0x1d7)&&(fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}');const _0x265a9a=_0x247b7a(gl[_0x5c2ed8(0x1ad)],vs),_0xac515e=_0x247b7a(gl['FRAGMENT_SHADER'],fs);return program=gl['createProgram'](),gl['attachShader'](program,_0x265a9a),gl[_0x5c2ed8(0x1b5)](program,_0xac515e),gl[_0x5c2ed8(0x1c2)](program),gl[_0x5c2ed8(0x1e5)](program),program;}function setupTexture_Buffer(_0x238c02){const _0x5926bb=a0_0x3508;texture=gl[_0x5926bb(0x1eb)](),gl['bindTexture'](gl['TEXTURE_2D'],texture),gl[_0x5926bb(0x1d9)](gl[_0x5926bb(0x1ca)],gl[_0x5926bb(0x1e2)],gl['NEAREST']),gl[_0x5926bb(0x1d9)](gl[_0x5926bb(0x1ca)],gl['TEXTURE_MAG_FILTER'],gl[_0x5926bb(0x1bc)]),gl[_0x5926bb(0x1d9)](gl[_0x5926bb(0x1ca)],gl[_0x5926bb(0x1cb)],gl[_0x5926bb(0x1d0)]),gl[_0x5926bb(0x1d9)](gl[_0x5926bb(0x1ca)],gl[_0x5926bb(0x1c0)],gl[_0x5926bb(0x1d0)]);_0x238c02===_0x5926bb(0x1d7)&&(gl[_0x5926bb(0x1b3)](gl[_0x5926bb(0x1db)](program,'game_size'),gameWidth,gameHeight),gl[_0x5926bb(0x1b3)](gl['getUniformLocation'](program,'render_size'),gl['canvas'][_0x5926bb(0x1c6)],gl[_0x5926bb(0x1cd)][_0x5926bb(0x1ac)]),gl[_0x5926bb(0x1c7)](gl[_0x5926bb(0x1db)](program,'smooth_width'),gameWidth/gl[_0x5926bb(0x1cd)][_0x5926bb(0x1c6)]),gl[_0x5926bb(0x1c7)](gl[_0x5926bb(0x1db)](program,_0x5926bb(0x1dc)),gameHeight/gl[_0x5926bb(0x1cd)][_0x5926bb(0x1ac)]));const _0x10fc8f=gl[_0x5926bb(0x1b1)]();gl[_0x5926bb(0x1be)](gl[_0x5926bb(0x1bb)],_0x10fc8f),gl[_0x5926bb(0x1ab)](gl[_0x5926bb(0x1bb)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x5926bb(0x1ea)]),gl[_0x5926bb(0x1cc)](gl[_0x5926bb(0x1c1)](program,_0x5926bb(0x1c5)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x5926bb(0x1d3)](gl[_0x5926bb(0x1c1)](program,_0x5926bb(0x1c5)));const _0x3dbb9d=gl[_0x5926bb(0x1b1)]();gl[_0x5926bb(0x1be)](gl[_0x5926bb(0x1bb)],_0x3dbb9d),gl['bufferData'](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl['STATIC_DRAW']),gl[_0x5926bb(0x1cc)](gl[_0x5926bb(0x1c1)](program,_0x5926bb(0x1dd)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0x5926bb(0x1d3)](gl['getAttribLocation'](program,'texcoord'));}function setup2DContext(){const _0x45cdb9=a0_0x3508;ctx2d=bufferCanvas[_0x45cdb9(0x1ba)]('2d'),ctx2d[_0x45cdb9(0x1e4)]=![];}async function renderPixel(_0x37e50a){const _0x1bcaf9=a0_0x3508,_0xaa403e=a0_0x338961[_0x1bcaf9(0x1e6)]();if(!_0xaa403e)return;await loadLUT64();const _0x9ce537=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x2c8cfb=0x0;_0x2c8cfb<gameHeight;_0x2c8cfb++){for(let _0x4b4614=0x0;_0x4b4614<gameWidth;_0x4b4614++){const _0x23d928=_0x2c8cfb*gameStride+_0x4b4614,_0x1d9095=(_0x2c8cfb*gameWidth+_0x4b4614)*0x4,_0xc88864=_0xaa403e[_0x23d928];if(lut64Profile==='none')_0x9ce537[_0x1d9095]=_0xc88864&0xff,_0x9ce537[_0x1d9095+0x1]=_0xc88864>>0x8&0xff,_0x9ce537[_0x1d9095+0x2]=_0xc88864>>0x10&0xff,_0x9ce537[_0x1d9095+0x3]=0xff;else{const _0x55383c=(_0xc88864&0xff)>>0x2,_0x510706=(_0xc88864>>0x8&0xff)>>0x2,_0x472b6a=(_0xc88864>>0x10&0xff)>>0x2,_0x380169=(_0x55383c*0x40*0x40+_0x510706*0x40+_0x472b6a)*0x3;_0x9ce537[_0x1d9095]=lut64[_0x380169],_0x9ce537[_0x1d9095+0x1]=lut64[_0x380169+0x1],_0x9ce537[_0x1d9095+0x2]=lut64[_0x380169+0x2],_0x9ce537[_0x1d9095+0x3]=0xff;}}}if(_0x37e50a==='webgl')gl[_0x1bcaf9(0x1e9)](gl[_0x1bcaf9(0x1ca)],0x0,gl['RGBA'],gameWidth,gameHeight,0x0,gl[_0x1bcaf9(0x1af)],gl[_0x1bcaf9(0x1ae)],_0x9ce537),gl[_0x1bcaf9(0x1ec)](gl[_0x1bcaf9(0x1e0)]),gl[_0x1bcaf9(0x1c4)](gl[_0x1bcaf9(0x1bf)],0x0,0x4);else _0x37e50a==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x9ce537,gameWidth,gameHeight):imageDataObj[_0x1bcaf9(0x1a9)][_0x1bcaf9(0x1e7)](_0x9ce537),ctx2d[_0x1bcaf9(0x1ce)](0x0,0x0,bufferCanvas[_0x1bcaf9(0x1c6)],bufferCanvas[_0x1bcaf9(0x1ac)]),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x37e50a));}export async function switchRenderMode(_0x454bea){const _0x3a1102=a0_0x3508;systemType=gameName[_0x3a1102(0x1c8)](-0x3);if(_0x454bea==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x454bea===_0x3a1102(0x1d1))setupStyle('2d'),setupWebGL_Shader(_0x3a1102(0x1d1)),setupTexture_Buffer('webgl'),renderPixel(_0x3a1102(0x1d1));else _0x454bea===_0x3a1102(0x1d7)&&(setupStyle('webgl_full'),setupWebGL_Shader(_0x3a1102(0x1d7)),setupTexture_Buffer(_0x3a1102(0x1d7)),renderPixel('webgl'));}}