const a0_0x3ff64f=a0_0x1f2f;(function(_0xfb8ac8,_0x189bee){const _0x5cd79e=a0_0x1f2f,_0x4e6b30=_0xfb8ac8();while(!![]){try{const _0x285377=parseInt(_0x5cd79e(0x1a8))/0x1+parseInt(_0x5cd79e(0x1b9))/0x2*(-parseInt(_0x5cd79e(0x199))/0x3)+parseInt(_0x5cd79e(0x1b4))/0x4+-parseInt(_0x5cd79e(0x19e))/0x5+parseInt(_0x5cd79e(0x198))/0x6+parseInt(_0x5cd79e(0x1ab))/0x7*(-parseInt(_0x5cd79e(0x1bf))/0x8)+-parseInt(_0x5cd79e(0x1c6))/0x9;if(_0x285377===_0x189bee)break;else _0x4e6b30['push'](_0x4e6b30['shift']());}catch(_0x8f2921){_0x4e6b30['push'](_0x4e6b30['shift']());}}}(a0_0x48e8,0xa71cc));import*as a0_0x3b3ab2 from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;function a0_0x48e8(){const _0x200754=['getElementById','querySelectorAll','floor','RGBA','1089809lDLIrN','createBuffer','px\x20','34804mPGyBX','4.0','texParameteri','imageSmoothingEnabled','UNSIGNED_BYTE','STATIC_DRAW','attachShader','getPixelData','webgl2','5153116NvsVnA','texImage2D','then','position','transformOrigin','2434thAbTv','ARRAY_BUFFER','clear','error','vertexAttribPointer','./src/lut/lut64_','256FTQZYE','canvas','slice','NEAREST','FLOAT','_temperature','VERTEX_SHADER','13842810vGLzFf','log','--bg-size','toLowerCase','screenSize','0,0,','_streng','createShader','fefs','bufferData','getContext','COLOR_BUFFER_BIT','text','TRIANGLE_STRIP','TEXTURE_MAG_FILTER','.stateTitle,\x20.stateDate','top\x20center','height','createProgram','render_size','getShaderParameter','.setting-container','.bin','viewport','forEach','setItem','arrayBuffer','transform','drawImage','./src/shaders/vertexShader.glsl','texcoord','useProgram','clearRect','warm','width','clientWidth','getItem','uniform1f','compileShader','TEXTURE_2D','getUniformLocation','drawArrays','TEXTURE_WRAP_T','crisp-edges','499446AdqJSt','63mWzvhv','devicePixelRatio','zoom','imageRendering','bindTexture','270430tdfEwK','.message-container','shaderSource','getAttribLocation','style','classList'];a0_0x48e8=function(){return _0x200754;};return a0_0x48e8();}const textured=document['getElementById']('textured'),bufferCanvas=document[a0_0x3ff64f(0x1a4)]('canvas'),canvasContainer=document[a0_0x3ff64f(0x1a4)]('canvas-container'),imgShader=document[a0_0x3ff64f(0x1a4)]('img-shader'),settingContainer=document[a0_0x3ff64f(0x1a5)](a0_0x3ff64f(0x181)),messageContainer=document[a0_0x3ff64f(0x1a5)](a0_0x3ff64f(0x19f)),stateTitle=document[a0_0x3ff64f(0x1a5)](a0_0x3ff64f(0x17b));async function loadLUT64(){const _0xc782d2=a0_0x3ff64f;systemType=gameName[_0xc782d2(0x1c1)](-0x3);const _0x3151b6=localStorage[_0xc782d2(0x190)](gameName+_0xc782d2(0x172))||_0xc782d2(0x1ac),_0x26a78e=(localStorage[_0xc782d2(0x190)](gameName+_0xc782d2(0x1c4))||_0xc782d2(0x18d))[_0xc782d2(0x16f)]();if(!lut64||lut64Streng!==_0x3151b6||lut64Profile!==_0x26a78e){const _0x28c357=_0xc782d2(0x1be)+_0x26a78e+'_'+_0x3151b6+_0xc782d2(0x182);console[_0xc782d2(0x1c7)](_0x28c357);const _0x2628e9=await fetch(_0x28c357),_0x575d31=await _0x2628e9[_0xc782d2(0x186)]();lut64=new Uint8Array(_0x575d31),lut64Streng=_0x3151b6,lut64Profile=_0x26a78e;}}async function loadShaderSource(_0x2f94c9){const _0x7d5151=a0_0x3ff64f,_0x1d71db=await fetch(_0x2f94c9);return await _0x1d71db[_0x7d5151(0x178)]();}function setupStyle(_0x2af177){const _0xdb3506=a0_0x3ff64f;clientWidth=document['documentElement'][_0xdb3506(0x18f)];const _0x185935=window[_0xdb3506(0x19a)];systemType==='gbc'?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0xdb3506(0x1a6)](clientWidth*_0x185935/gameWidth),localStorage[_0xdb3506(0x185)](_0xdb3506(0x170),_0xdb3506(0x171)+gameWidth*(integerScaling/_0x185935)+','+gameHeight*(integerScaling/_0x185935))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math['floor'](clientWidth*_0x185935/gameWidth),localStorage[_0xdb3506(0x185)](_0xdb3506(0x170),'0,0,'+gameWidth*(integerScaling/_0x185935)+','+gameHeight*(integerScaling/_0x185935)));if(_0x2af177==='2d')bufferCanvas[_0xdb3506(0x18e)]=gameWidth,bufferCanvas[_0xdb3506(0x17d)]=gameHeight,bufferCanvas[_0xdb3506(0x1a2)][_0xdb3506(0x19b)]=''+integerScaling/_0x185935,bufferCanvas[_0xdb3506(0x1a2)][_0xdb3506(0x19c)]=_0xdb3506(0x197),canvasContainer[_0xdb3506(0x1a2)][_0xdb3506(0x18e)]=gameWidth*(integerScaling/_0x185935)+'px',canvasContainer[_0xdb3506(0x1a2)][_0xdb3506(0x17d)]=gameHeight*(integerScaling/_0x185935)+'px',textured['style'][_0xdb3506(0x18e)]=gameWidth*(integerScaling/_0x185935)+'px',textured[_0xdb3506(0x1a2)][_0xdb3506(0x17d)]=gameHeight*(integerScaling/_0x185935)+'px',imgShader[_0xdb3506(0x1a2)][_0xdb3506(0x187)]='scale('+integerScaling/_0x185935/upscaleShader+')',settingContainer[_0xdb3506(0x184)](function(_0xbf62f4){const _0x44d20b=_0xdb3506;_0xbf62f4[_0x44d20b(0x1a2)]['width']=gameWidth*(integerScaling/_0x185935)+'px',_0xbf62f4[_0x44d20b(0x1a2)]['height']=gameHeight*(integerScaling/_0x185935)+'px';}),messageContainer[_0xdb3506(0x184)](function(_0x4a1fe7){const _0x11b145=_0xdb3506;_0x4a1fe7[_0x11b145(0x1a2)][_0x11b145(0x18e)]=gameWidth+'px',_0x4a1fe7['style']['height']=gameHeight+'px',_0x4a1fe7[_0x11b145(0x1a2)][_0x11b145(0x19b)]=''+integerScaling/_0x185935;}),stateTitle[_0xdb3506(0x184)](function(_0x644824){const _0x235dae=_0xdb3506;_0x644824[_0x235dae(0x1a3)]['remove'](_0x235dae(0x174));});else _0x2af177==='webgl2'&&(bufferCanvas[_0xdb3506(0x18e)]=clientWidth*upscaleFactor,bufferCanvas[_0xdb3506(0x17d)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0xdb3506(0x1a2)][_0xdb3506(0x19b)]=''+0x1/upscaleFactor,bufferCanvas[_0xdb3506(0x1a2)][_0xdb3506(0x19c)]='',canvasContainer[_0xdb3506(0x1a2)][_0xdb3506(0x18e)]=clientWidth+'px',canvasContainer[_0xdb3506(0x1a2)]['height']=clientWidth*(gameHeight/gameWidth)+'px',textured[_0xdb3506(0x1a2)][_0xdb3506(0x18e)]=clientWidth+'px',textured[_0xdb3506(0x1a2)][_0xdb3506(0x17d)]=clientWidth*(gameHeight/gameWidth)+'px',imgShader[_0xdb3506(0x1a2)][_0xdb3506(0x187)]='scale('+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x398e71){const _0x537e74=_0xdb3506;_0x398e71['style'][_0x537e74(0x18e)]=clientWidth+'px',_0x398e71['style'][_0x537e74(0x17d)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0xdb3506(0x184)](function(_0x2dc7d8){const _0x2bce36=_0xdb3506;_0x2dc7d8[_0x2bce36(0x1a2)][_0x2bce36(0x18e)]=gameWidth+'px',_0x2dc7d8[_0x2bce36(0x1a2)][_0x2bce36(0x17d)]=gameHeight+'px',_0x2dc7d8[_0x2bce36(0x1a2)]['zoom']=''+clientWidth/gameWidth;}),stateTitle[_0xdb3506(0x184)](function(_0x15d6a8){const _0x136459=_0xdb3506;_0x15d6a8[_0x136459(0x1a3)]['add'](_0x136459(0x174));}));imgShader[_0xdb3506(0x1a2)][_0xdb3506(0x18e)]=gameWidth*upscaleShader+'px',imgShader[_0xdb3506(0x1a2)][_0xdb3506(0x17d)]=gameHeight*upscaleShader+'px',imgShader[_0xdb3506(0x1a2)][_0xdb3506(0x1b8)]=_0xdb3506(0x17c),imgShader[_0xdb3506(0x1a2)]['setProperty'](_0xdb3506(0x16e),upscaleShader+_0xdb3506(0x1aa)+upscaleShader+'px');}function setupWebGL(){const _0x5e7429=a0_0x3ff64f;gl=bufferCanvas['getContext'](_0x5e7429(0x1b3));if(!gl)return console[_0x5e7429(0x1bc)]('WebGL2\x20not\x20supported'),null;gl[_0x5e7429(0x183)](0x0,0x0,bufferCanvas[_0x5e7429(0x18e)],bufferCanvas[_0x5e7429(0x17d)]);}function createShader(_0xebf16f,_0x2f52c2){const _0x330032=a0_0x3ff64f,_0x3e2913=gl[_0x330032(0x173)](_0xebf16f);gl[_0x330032(0x1a0)](_0x3e2913,_0x2f52c2),gl[_0x330032(0x192)](_0x3e2913);if(!gl[_0x330032(0x180)](_0x3e2913,gl['COMPILE_STATUS']))return console[_0x330032(0x1bc)](gl['getShaderInfoLog'](_0x3e2913)),gl['deleteShader'](_0x3e2913),null;return _0x3e2913;}async function setupShaders(){const _0x483cd4=a0_0x3ff64f,_0x5de0ac=await loadShaderSource(_0x483cd4(0x189)),_0x424643=await loadShaderSource('./src/shaders/fragmentShader.glsl'),_0x567548=createShader(gl[_0x483cd4(0x1c5)],_0x5de0ac),_0x430a99=createShader(gl['FRAGMENT_SHADER'],_0x424643);return program=gl[_0x483cd4(0x17e)](),gl[_0x483cd4(0x1b1)](program,_0x567548),gl[_0x483cd4(0x1b1)](program,_0x430a99),gl['linkProgram'](program),gl[_0x483cd4(0x18b)](program),program;}function a0_0x1f2f(_0x2a782e,_0x7c9cd1){const _0x48e8ad=a0_0x48e8();return a0_0x1f2f=function(_0x1f2f6e,_0x1aaba8){_0x1f2f6e=_0x1f2f6e-0x16e;let _0x4e8723=_0x48e8ad[_0x1f2f6e];return _0x4e8723;},a0_0x1f2f(_0x2a782e,_0x7c9cd1);}function setupTexture(){const _0x7d523c=a0_0x3ff64f;texture=gl['createTexture'](),gl[_0x7d523c(0x19d)](gl[_0x7d523c(0x193)],texture),gl[_0x7d523c(0x1ad)](gl[_0x7d523c(0x193)],gl['TEXTURE_MIN_FILTER'],gl[_0x7d523c(0x1c2)]),gl['texParameteri'](gl[_0x7d523c(0x193)],gl[_0x7d523c(0x17a)],gl[_0x7d523c(0x1c2)]),gl['texParameteri'](gl[_0x7d523c(0x193)],gl['TEXTURE_WRAP_S'],gl['CLAMP_TO_EDGE']),gl[_0x7d523c(0x1ad)](gl[_0x7d523c(0x193)],gl[_0x7d523c(0x196)],gl['CLAMP_TO_EDGE']),gl['uniform2f'](gl[_0x7d523c(0x194)](program,'game_size'),gameWidth,gameHeight),gl['uniform2f'](gl[_0x7d523c(0x194)](program,_0x7d523c(0x17f)),gl[_0x7d523c(0x1c0)]['width'],gl[_0x7d523c(0x1c0)][_0x7d523c(0x17d)]),gl[_0x7d523c(0x191)](gl[_0x7d523c(0x194)](program,'smooth_width'),gameWidth/gl[_0x7d523c(0x1c0)]['width']),gl[_0x7d523c(0x191)](gl[_0x7d523c(0x194)](program,'smooth_height'),gameHeight/gl['canvas']['height']);}function setupBuffers(){const _0x533505=a0_0x3ff64f,_0x972102=gl[_0x533505(0x1a9)]();gl['bindBuffer'](gl[_0x533505(0x1ba)],_0x972102),gl[_0x533505(0x175)](gl[_0x533505(0x1ba)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x533505(0x1b0)]);const _0x504f15=gl[_0x533505(0x1a1)](program,_0x533505(0x1b7));gl['enableVertexAttribArray'](_0x504f15),gl[_0x533505(0x1bd)](_0x504f15,0x2,gl[_0x533505(0x1c3)],![],0x0,0x0);const _0xb68c93=gl[_0x533505(0x1a9)]();gl['bindBuffer'](gl['ARRAY_BUFFER'],_0xb68c93),gl[_0x533505(0x175)](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x533505(0x1b0)]);const _0x1a78a2=gl[_0x533505(0x1a1)](program,_0x533505(0x18a));gl['enableVertexAttribArray'](_0x1a78a2),gl[_0x533505(0x1bd)](_0x1a78a2,0x2,gl[_0x533505(0x1c3)],![],0x0,0x0);}async function renderPixel(_0x424cd0){const _0x5c5ccf=a0_0x3ff64f,_0x1230b7=a0_0x3b3ab2[_0x5c5ccf(0x1b2)]();if(!_0x1230b7)return;await loadLUT64();const _0x418b29=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x1cdc14=0x0;_0x1cdc14<gameHeight;_0x1cdc14++){for(let _0x42fe2e=0x0;_0x42fe2e<gameWidth;_0x42fe2e++){const _0x4138bf=_0x1cdc14*gameStride+_0x42fe2e,_0x5623c4=(_0x1cdc14*gameWidth+_0x42fe2e)*0x4,_0x59b5d7=_0x1230b7[_0x4138bf],_0x4eec1b=(_0x59b5d7&0xff)>>0x2,_0x8469ce=(_0x59b5d7>>0x8&0xff)>>0x2,_0x41bff1=(_0x59b5d7>>0x10&0xff)>>0x2,_0x5692b9=(_0x4eec1b*0x40*0x40+_0x8469ce*0x40+_0x41bff1)*0x3;_0x418b29[_0x5623c4]=lut64[_0x5692b9],_0x418b29[_0x5623c4+0x1]=lut64[_0x5692b9+0x1],_0x418b29[_0x5623c4+0x2]=lut64[_0x5692b9+0x2],_0x418b29[_0x5623c4+0x3]=0xff;}}if(_0x424cd0==='webgl2')gl['bindTexture'](gl[_0x5c5ccf(0x193)],texture),gl[_0x5c5ccf(0x1b5)](gl[_0x5c5ccf(0x193)],0x0,gl[_0x5c5ccf(0x1a7)],gameWidth,gameHeight,0x0,gl[_0x5c5ccf(0x1a7)],gl[_0x5c5ccf(0x1af)],_0x418b29),gl[_0x5c5ccf(0x1bb)](gl[_0x5c5ccf(0x177)]),gl[_0x5c5ccf(0x195)](gl[_0x5c5ccf(0x179)],0x0,0x4);else{if(_0x424cd0==='2d'){ctx2d=bufferCanvas[_0x5c5ccf(0x176)]('2d'),ctx2d[_0x5c5ccf(0x1ae)]=![];const _0x584fb9=new ImageData(_0x418b29,gameWidth,gameHeight);createImageBitmap(_0x584fb9)[_0x5c5ccf(0x1b6)](_0x4aef0f=>{const _0x5dc1c6=_0x5c5ccf;ctx2d[_0x5dc1c6(0x18c)](0x0,0x0,bufferCanvas['width'],bufferCanvas['height']),ctx2d[_0x5dc1c6(0x188)](_0x4aef0f,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x424cd0));}export async function switchRenderMode(_0x46c55b){const _0x5b2896=a0_0x3ff64f;systemType=gameName['slice'](-0x3);if(_0x46c55b==='2d')setupStyle('2d'),renderPixel('2d');else _0x46c55b===_0x5b2896(0x1b3)&&(setupStyle(_0x5b2896(0x1b3)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel('webgl2'));}document['addEventListener']('DOMContentLoaded',function(){});