const a0_0x2bfe3b=a0_0x4b5b;function a0_0x4b5b(_0x37cbaf,_0x19302e){const _0x31ad7a=a0_0x31ad();return a0_0x4b5b=function(_0x4b5baf,_0x27b919){_0x4b5baf=_0x4b5baf-0xf0;let _0x1faa16=_0x31ad7a[_0x4b5baf];return _0x1faa16;},a0_0x4b5b(_0x37cbaf,_0x19302e);}(function(_0x4c6182,_0x287713){const _0x2ec3f4=a0_0x4b5b,_0x553c4e=_0x4c6182();while(!![]){try{const _0x2a3615=-parseInt(_0x2ec3f4(0x103))/0x1+-parseInt(_0x2ec3f4(0x14c))/0x2*(parseInt(_0x2ec3f4(0x124))/0x3)+parseInt(_0x2ec3f4(0x143))/0x4*(-parseInt(_0x2ec3f4(0x13a))/0x5)+parseInt(_0x2ec3f4(0x120))/0x6+parseInt(_0x2ec3f4(0x149))/0x7*(parseInt(_0x2ec3f4(0x140))/0x8)+-parseInt(_0x2ec3f4(0x100))/0x9+-parseInt(_0x2ec3f4(0x122))/0xa*(-parseInt(_0x2ec3f4(0x128))/0xb);if(_0x2a3615===_0x287713)break;else _0x553c4e['push'](_0x553c4e['shift']());}catch(_0x398e5b){_0x553c4e['push'](_0x553c4e['shift']());}}}(a0_0x31ad,0x89f7e));import*as a0_0x4b76db from'./main.js';let gl=null,program=null,systemType,clientWidth,upscaleFactor=0x3,upscaleShader,gameWidth,gameHeight,gameStride,texture,integerScaling,ctx2d=null,lut64=null,lut64Streng=null,lut64Profile=null;const textured=document['getElementById'](a0_0x2bfe3b(0x147)),bufferCanvas=document[a0_0x2bfe3b(0x14e)](a0_0x2bfe3b(0x150)),canvasContainer=document[a0_0x2bfe3b(0x14e)](a0_0x2bfe3b(0xf9)),imgShader=document[a0_0x2bfe3b(0x14e)](a0_0x2bfe3b(0x10f)),settingContainer=document[a0_0x2bfe3b(0x106)](a0_0x2bfe3b(0x126)),messageContainer=document['querySelectorAll'](a0_0x2bfe3b(0x116)),stateTitle=document[a0_0x2bfe3b(0x106)](a0_0x2bfe3b(0x12c));async function loadLUT64(){const _0x3238ea=a0_0x2bfe3b;systemType=gameName[_0x3238ea(0x13f)](-0x3);const _0x25a833=localStorage[_0x3238ea(0x130)](gameName+_0x3238ea(0x105))||_0x3238ea(0xf8),_0x5d008a=(localStorage['getItem'](gameName+_0x3238ea(0xf1))||'warm')[_0x3238ea(0x110)]();if(!lut64||lut64Streng!==_0x25a833||lut64Profile!==_0x5d008a){const _0x4d201f='./src/lut/lut64_'+_0x5d008a+'_'+_0x25a833+'.bin';console[_0x3238ea(0x102)](_0x4d201f);const _0x278fc6=await fetch(_0x4d201f),_0x338552=await _0x278fc6[_0x3238ea(0x12a)]();lut64=new Uint8Array(_0x338552),lut64Streng=_0x25a833,lut64Profile=_0x5d008a;}}async function loadShaderSource(_0x59f2e4){const _0x120586=await fetch(_0x59f2e4);return await _0x120586['text']();}function setupStyle(_0x55f2c8){const _0x4a3d92=a0_0x2bfe3b;clientWidth=document[_0x4a3d92(0x13d)][_0x4a3d92(0x14f)];const _0x524ead=window[_0x4a3d92(0x11a)];systemType===_0x4a3d92(0x115)?(gameWidth=0xa0,gameHeight=0x90,gameStride=0x100,upscaleShader=0x3,integerScaling=Math[_0x4a3d92(0xf0)](clientWidth*_0x524ead/gameWidth),localStorage[_0x4a3d92(0x152)](_0x4a3d92(0x10a),'0,0,'+gameWidth*(integerScaling/_0x524ead)+','+gameHeight*(integerScaling/_0x524ead))):(gameWidth=0xf0,gameHeight=0xa0,gameStride=0xf0,upscaleShader=0x2,integerScaling=Math['floor'](clientWidth*_0x524ead/gameWidth),localStorage[_0x4a3d92(0x152)](_0x4a3d92(0x10a),_0x4a3d92(0x10e)+gameWidth*(integerScaling/_0x524ead)+','+gameHeight*(integerScaling/_0x524ead)));if(_0x55f2c8==='2d')bufferCanvas[_0x4a3d92(0x13e)]=gameWidth,bufferCanvas[_0x4a3d92(0x107)]=gameHeight,bufferCanvas[_0x4a3d92(0xf6)][_0x4a3d92(0x118)]=''+integerScaling/_0x524ead,bufferCanvas['style'][_0x4a3d92(0x139)]='crisp-edges',canvasContainer[_0x4a3d92(0xf6)][_0x4a3d92(0x13e)]=gameWidth*(integerScaling/_0x524ead)+'px',canvasContainer['style'][_0x4a3d92(0x107)]=gameHeight*(integerScaling/_0x524ead)+'px',textured[_0x4a3d92(0xf6)]['width']=gameWidth*(integerScaling/_0x524ead)+'px',textured['style'][_0x4a3d92(0x107)]=gameHeight*(integerScaling/_0x524ead)+'px',imgShader[_0x4a3d92(0xf6)][_0x4a3d92(0x13c)]=_0x4a3d92(0x11e)+integerScaling/_0x524ead/upscaleShader+')',settingContainer[_0x4a3d92(0x137)](function(_0x44523e){const _0x27acd8=_0x4a3d92;_0x44523e[_0x27acd8(0xf6)][_0x27acd8(0x13e)]=gameWidth*(integerScaling/_0x524ead)+'px',_0x44523e[_0x27acd8(0xf6)]['height']=gameHeight*(integerScaling/_0x524ead)+'px';}),messageContainer['forEach'](function(_0x239d4f){const _0x1fd1c0=_0x4a3d92;_0x239d4f[_0x1fd1c0(0xf6)][_0x1fd1c0(0x13e)]=gameWidth+'px',_0x239d4f[_0x1fd1c0(0xf6)][_0x1fd1c0(0x107)]=gameHeight+'px',_0x239d4f['style']['zoom']=''+integerScaling/_0x524ead;}),stateTitle[_0x4a3d92(0x137)](function(_0x2a48d8){const _0x11933b=_0x4a3d92;_0x2a48d8['classList'][_0x11933b(0x129)](_0x11933b(0x12d));});else _0x55f2c8===_0x4a3d92(0x101)&&(bufferCanvas[_0x4a3d92(0x13e)]=clientWidth*upscaleFactor,bufferCanvas[_0x4a3d92(0x107)]=clientWidth*upscaleFactor*(gameHeight/gameWidth),bufferCanvas[_0x4a3d92(0xf6)][_0x4a3d92(0x118)]=''+0x1/upscaleFactor,bufferCanvas['style']['imageRendering']='',canvasContainer['style'][_0x4a3d92(0x13e)]=clientWidth+'px',canvasContainer[_0x4a3d92(0xf6)][_0x4a3d92(0x107)]=clientWidth*(gameHeight/gameWidth)+'px',textured[_0x4a3d92(0xf6)][_0x4a3d92(0x13e)]=clientWidth+'px',textured['style']['height']=clientWidth*(gameHeight/gameWidth)+'px',imgShader['style']['transform']=_0x4a3d92(0x11e)+clientWidth/gameWidth/upscaleShader+')',settingContainer['forEach'](function(_0x3ed202){const _0xe99ed7=_0x4a3d92;_0x3ed202['style']['width']=clientWidth+'px',_0x3ed202['style'][_0xe99ed7(0x107)]=clientWidth*(gameHeight/gameWidth)+'px';}),messageContainer[_0x4a3d92(0x137)](function(_0x39fa56){const _0x1acdd5=_0x4a3d92;_0x39fa56[_0x1acdd5(0xf6)][_0x1acdd5(0x13e)]=gameWidth+'px',_0x39fa56[_0x1acdd5(0xf6)][_0x1acdd5(0x107)]=gameHeight+'px',_0x39fa56[_0x1acdd5(0xf6)]['zoom']=''+clientWidth/gameWidth;}),stateTitle[_0x4a3d92(0x137)](function(_0xa6138d){const _0x1387f2=_0x4a3d92;_0xa6138d[_0x1387f2(0x146)][_0x1387f2(0x117)](_0x1387f2(0x12d));}));imgShader['style']['width']=gameWidth*upscaleShader+'px',imgShader[_0x4a3d92(0xf6)][_0x4a3d92(0x107)]=gameHeight*upscaleShader+'px',imgShader[_0x4a3d92(0xf6)][_0x4a3d92(0x135)]=_0x4a3d92(0x125),imgShader[_0x4a3d92(0xf6)]['setProperty'](_0x4a3d92(0x11f),upscaleShader+_0x4a3d92(0x133)+upscaleShader+'px');}function setupWebGL(){const _0x51e24c=a0_0x2bfe3b;gl=bufferCanvas[_0x51e24c(0x132)](_0x51e24c(0x101));if(!gl)return console[_0x51e24c(0xfa)](_0x51e24c(0xf7)),null;gl[_0x51e24c(0x134)](0x0,0x0,bufferCanvas[_0x51e24c(0x13e)],bufferCanvas[_0x51e24c(0x107)]);}function createShader(_0x28df55,_0x5c0c0b){const _0x38e5dc=a0_0x2bfe3b,_0x1f3045=gl[_0x38e5dc(0x10b)](_0x28df55);gl[_0x38e5dc(0x13b)](_0x1f3045,_0x5c0c0b),gl[_0x38e5dc(0x112)](_0x1f3045);if(!gl['getShaderParameter'](_0x1f3045,gl[_0x38e5dc(0x138)]))return console[_0x38e5dc(0xfa)](gl[_0x38e5dc(0x11d)](_0x1f3045)),gl['deleteShader'](_0x1f3045),null;return _0x1f3045;}async function setupShaders(){const _0x399b4d=a0_0x2bfe3b,_0x47935b=await loadShaderSource('./src/shaders/vertexShader.glsl'),_0x983fc4=await loadShaderSource('./src/shaders/fragmentShader.glsl'),_0x13117b=createShader(gl[_0x399b4d(0xfe)],_0x47935b),_0xd2e05c=createShader(gl[_0x399b4d(0x142)],_0x983fc4);return program=gl[_0x399b4d(0x14d)](),gl[_0x399b4d(0xfd)](program,_0x13117b),gl['attachShader'](program,_0xd2e05c),gl['linkProgram'](program),gl['useProgram'](program),program;}function setupTexture(){const _0x31f06a=a0_0x2bfe3b;texture=gl['createTexture'](),gl[_0x31f06a(0x108)](gl[_0x31f06a(0xf5)],texture),gl[_0x31f06a(0x123)](gl[_0x31f06a(0xf5)],gl['TEXTURE_MIN_FILTER'],gl['NEAREST']),gl[_0x31f06a(0x123)](gl[_0x31f06a(0xf5)],gl[_0x31f06a(0x111)],gl[_0x31f06a(0xf4)]),gl[_0x31f06a(0x123)](gl[_0x31f06a(0xf5)],gl[_0x31f06a(0x11c)],gl[_0x31f06a(0x14b)]),gl[_0x31f06a(0x123)](gl[_0x31f06a(0xf5)],gl['TEXTURE_WRAP_T'],gl[_0x31f06a(0x14b)]),gl[_0x31f06a(0x114)](gl['getUniformLocation'](program,_0x31f06a(0x113)),gameWidth,gameHeight),gl['uniform2f'](gl[_0x31f06a(0x131)](program,_0x31f06a(0x12b)),gl[_0x31f06a(0x150)]['width'],gl[_0x31f06a(0x150)]['height']),gl['uniform1f'](gl[_0x31f06a(0x131)](program,_0x31f06a(0x148)),gameWidth/gl[_0x31f06a(0x150)][_0x31f06a(0x13e)]),gl[_0x31f06a(0x14a)](gl[_0x31f06a(0x131)](program,'smooth_height'),gameHeight/gl[_0x31f06a(0x150)][_0x31f06a(0x107)]);}function a0_0x31ad(){const _0x149d41=['transform','documentElement','width','slice','7552040ivxazP','ARRAY_BUFFER','FRAGMENT_SHADER','6224FIBREz','RGBA','drawImage','classList','textured','smooth_width','7YKHlkC','uniform1f','CLAMP_TO_EDGE','11848aPlzUO','createProgram','getElementById','clientWidth','canvas','bufferData','setItem','floor','_temperature','enableVertexAttribArray','clearRect','NEAREST','TEXTURE_2D','style','WebGL2\x20not\x20supported','4.0','canvas-container','error','UNSIGNED_BYTE','clear','attachShader','VERTEX_SHADER','getAttribLocation','2432196WJsUtE','webgl2','log','855286WJoUVf','imageSmoothingEnabled','_streng','querySelectorAll','height','bindTexture','drawArrays','screenSize','createShader','texImage2D','addEventListener','0,0,','img-shader','toLowerCase','TEXTURE_MAG_FILTER','compileShader','game_size','uniform2f','gbc','.message-container','add','zoom','createBuffer','devicePixelRatio','texcoord','TEXTURE_WRAP_S','getShaderInfoLog','scale(','--bg-size','6145914nogytR','vertexAttribPointer','32420bpuNQy','texParameteri','132quLVEo','top\x20center','.setting-container','DOMContentLoaded','3168SmTNQm','remove','arrayBuffer','render_size','.stateTitle,\x20.stateDate','fefs','COLOR_BUFFER_BIT','FLOAT','getItem','getUniformLocation','getContext','px\x20','viewport','transformOrigin','STATIC_DRAW','forEach','COMPILE_STATUS','imageRendering','3055KWsSpT','shaderSource'];a0_0x31ad=function(){return _0x149d41;};return a0_0x31ad();}function setupBuffers(){const _0x46792f=a0_0x2bfe3b,_0x5d5d66=gl[_0x46792f(0x119)]();gl['bindBuffer'](gl[_0x46792f(0x141)],_0x5d5d66),gl[_0x46792f(0x151)](gl[_0x46792f(0x141)],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0x46792f(0x136)]);const _0x406a0e=gl[_0x46792f(0xff)](program,'position');gl[_0x46792f(0xf2)](_0x406a0e),gl[_0x46792f(0x121)](_0x406a0e,0x2,gl[_0x46792f(0x12f)],![],0x0,0x0);const _0x45a686=gl[_0x46792f(0x119)]();gl['bindBuffer'](gl[_0x46792f(0x141)],_0x45a686),gl[_0x46792f(0x151)](gl['ARRAY_BUFFER'],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0x46792f(0x136)]);const _0x3aef1f=gl[_0x46792f(0xff)](program,_0x46792f(0x11b));gl[_0x46792f(0xf2)](_0x3aef1f),gl[_0x46792f(0x121)](_0x3aef1f,0x2,gl['FLOAT'],![],0x0,0x0);}async function renderPixel(_0x102d6f){const _0x4a848c=a0_0x2bfe3b,_0x920c68=a0_0x4b76db['getPixelData']();if(!_0x920c68)return;await loadLUT64();const _0x4d1545=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x3a5040=0x0;_0x3a5040<gameHeight;_0x3a5040++){for(let _0x48082e=0x0;_0x48082e<gameWidth;_0x48082e++){const _0x3e503e=_0x3a5040*gameStride+_0x48082e,_0x436308=(_0x3a5040*gameWidth+_0x48082e)*0x4,_0x187421=_0x920c68[_0x3e503e],_0x4674cd=(_0x187421&0xff)>>0x2,_0x106874=(_0x187421>>0x8&0xff)>>0x2,_0x5e0ac6=(_0x187421>>0x10&0xff)>>0x2,_0x3d8bd9=(_0x4674cd*0x40*0x40+_0x106874*0x40+_0x5e0ac6)*0x3;_0x4d1545[_0x436308]=lut64[_0x3d8bd9],_0x4d1545[_0x436308+0x1]=lut64[_0x3d8bd9+0x1],_0x4d1545[_0x436308+0x2]=lut64[_0x3d8bd9+0x2],_0x4d1545[_0x436308+0x3]=0xff;}}if(_0x102d6f===_0x4a848c(0x101))gl[_0x4a848c(0x108)](gl[_0x4a848c(0xf5)],texture),gl[_0x4a848c(0x10c)](gl[_0x4a848c(0xf5)],0x0,gl[_0x4a848c(0x144)],gameWidth,gameHeight,0x0,gl[_0x4a848c(0x144)],gl[_0x4a848c(0xfb)],_0x4d1545),gl[_0x4a848c(0xfc)](gl[_0x4a848c(0x12e)]),gl[_0x4a848c(0x109)](gl['TRIANGLE_STRIP'],0x0,0x4);else{if(_0x102d6f==='2d'){ctx2d=bufferCanvas['getContext']('2d'),ctx2d[_0x4a848c(0x104)]=![];const _0x1151a2=new ImageData(_0x4d1545,gameWidth,gameHeight);createImageBitmap(_0x1151a2)['then'](_0x1770eb=>{const _0xa467e=_0x4a848c;ctx2d[_0xa467e(0xf3)](0x0,0x0,bufferCanvas[_0xa467e(0x13e)],bufferCanvas['height']),ctx2d[_0xa467e(0x145)](_0x1770eb,0x0,0x0);});}}requestAnimationFrame(()=>renderPixel(_0x102d6f));}export async function switchRenderMode(_0x1f4d7c){const _0x209146=a0_0x2bfe3b;systemType=gameName[_0x209146(0x13f)](-0x3);if(_0x1f4d7c==='2d')setupStyle('2d'),renderPixel('2d');else _0x1f4d7c==='webgl2'&&(setupStyle(_0x209146(0x101)),setupWebGL(),await setupShaders(),setupTexture(),setupBuffers(),renderPixel(_0x209146(0x101)));}document[a0_0x2bfe3b(0x10d)](a0_0x2bfe3b(0x127),function(){});