(function(_0x544651,_0x7c6542){const _0xd81fe8=a0_0xbfc5,_0x3f4339=_0x544651();while(!![]){try{const _0x17a4fa=-parseInt(_0xd81fe8(0x1ee))/0x1+-parseInt(_0xd81fe8(0x1e2))/0x2*(-parseInt(_0xd81fe8(0x1d8))/0x3)+parseInt(_0xd81fe8(0x1d9))/0x4+-parseInt(_0xd81fe8(0x1ed))/0x5+parseInt(_0xd81fe8(0x1cc))/0x6*(parseInt(_0xd81fe8(0x1d2))/0x7)+parseInt(_0xd81fe8(0x1f1))/0x8*(-parseInt(_0xd81fe8(0x1be))/0x9)+-parseInt(_0xd81fe8(0x1d7))/0xa*(-parseInt(_0xd81fe8(0x1bd))/0xb);if(_0x17a4fa===_0x7c6542)break;else _0x3f4339['push'](_0x3f4339['shift']());}catch(_0x7ab92c){_0x3f4339['push'](_0x3f4339['shift']());}}}(a0_0x3ba7,0xc498d));import*as a0_0x378766 from'./main.js';let gl=null,program=null,texture=null,ctx2d=null,lut64=null,lut64Profile=null,imageDataObj=null,fs=null,vs=null;async function loadLUT64(){const _0x272e6c=a0_0xbfc5;systemType=gameName[_0x272e6c(0x1b9)](-0x3);const _0x5796d9=(localStorage['getItem'](gameName+_0x272e6c(0x1d6))||_0x272e6c(0x1dd))[_0x272e6c(0x1f3)]();if(!lut64||lut64Profile!==_0x5796d9){const _0x59ea1d=_0x272e6c(0x1c5)+_0x5796d9+'_4.0.bin';console['log'](_0x59ea1d);const _0x2b2a17=await fetch(_0x59ea1d),_0x5cdb58=await _0x2b2a17[_0x272e6c(0x1d4)]();lut64=new Uint8Array(_0x5cdb58),lut64Profile=_0x5796d9;}}function setupWebGL_Shader(_0x97f09b){const _0x5b6d9f=a0_0xbfc5;gl=bufferCanvas[_0x5b6d9f(0x1c9)]('webgl',{'alpha':![],'depth':![],'antialias':![],'premultipliedAlpha':![],'preserveDrawingBuffer':![],'powerPreference':'low-power'}),gl[_0x5b6d9f(0x1f6)](0x0,0x0,bufferCanvas['width'],bufferCanvas['height']);function _0x459858(_0x5531d0,_0x380cbc){const _0x59350f=_0x5b6d9f,_0x2371c0=gl[_0x59350f(0x1e4)](_0x5531d0);return gl['shaderSource'](_0x2371c0,_0x380cbc),gl['compileShader'](_0x2371c0),_0x2371c0;}vs=_0x5b6d9f(0x1c7);if(_0x97f09b===_0x5b6d9f(0x1d5))fs='precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texture;void\x20main()\x20{gl_FragColor\x20=\x20texture2D(texture,\x20v_texcoord);}';else _0x97f09b===_0x5b6d9f(0x1ea)&&(fs=_0x5b6d9f(0x1c2));const _0x2d5b32=_0x459858(gl['VERTEX_SHADER'],vs),_0x18da62=_0x459858(gl[_0x5b6d9f(0x1e1)],fs);return program=gl[_0x5b6d9f(0x1d3)](),gl[_0x5b6d9f(0x1cb)](program,_0x2d5b32),gl[_0x5b6d9f(0x1cb)](program,_0x18da62),gl[_0x5b6d9f(0x1d1)](program),gl[_0x5b6d9f(0x1c8)](program),program;}function setupTexture_Buffer(_0x4623e6){const _0xd02f9c=a0_0xbfc5;texture=gl[_0xd02f9c(0x1da)](),gl['bindTexture'](gl[_0xd02f9c(0x1c4)],texture),gl[_0xd02f9c(0x1ba)](gl['TEXTURE_2D'],gl[_0xd02f9c(0x1c3)],gl[_0xd02f9c(0x1e8)]),gl[_0xd02f9c(0x1ba)](gl['TEXTURE_2D'],gl['TEXTURE_MAG_FILTER'],gl[_0xd02f9c(0x1e8)]),gl[_0xd02f9c(0x1ba)](gl['TEXTURE_2D'],gl[_0xd02f9c(0x1df)],gl[_0xd02f9c(0x1cf)]),gl[_0xd02f9c(0x1ba)](gl['TEXTURE_2D'],gl[_0xd02f9c(0x1bc)],gl['CLAMP_TO_EDGE']);_0x4623e6===_0xd02f9c(0x1ea)&&(gl[_0xd02f9c(0x1de)](gl['getUniformLocation'](program,_0xd02f9c(0x1dc)),gameWidth,gameHeight),gl[_0xd02f9c(0x1de)](gl[_0xd02f9c(0x1ec)](program,'render_size'),gl[_0xd02f9c(0x1c1)]['width'],gl[_0xd02f9c(0x1c1)][_0xd02f9c(0x1e3)]),gl[_0xd02f9c(0x1e9)](gl[_0xd02f9c(0x1ec)](program,_0xd02f9c(0x1e5)),gameWidth/gl[_0xd02f9c(0x1c1)]['width']),gl[_0xd02f9c(0x1e9)](gl[_0xd02f9c(0x1ec)](program,_0xd02f9c(0x1cd)),gameHeight/gl['canvas'][_0xd02f9c(0x1e3)]));const _0x40e21c=gl['createBuffer']();gl[_0xd02f9c(0x1db)](gl[_0xd02f9c(0x1f0)],_0x40e21c),gl[_0xd02f9c(0x1e7)](gl['ARRAY_BUFFER'],new Float32Array([-0x1,-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1]),gl[_0xd02f9c(0x1ef)]),gl['vertexAttribPointer'](gl[_0xd02f9c(0x1ce)](program,'position'),0x2,gl[_0xd02f9c(0x1e0)],![],0x0,0x0),gl[_0xd02f9c(0x1f2)](gl[_0xd02f9c(0x1ce)](program,_0xd02f9c(0x1c6)));const _0x7dbfb1=gl[_0xd02f9c(0x1bf)]();gl[_0xd02f9c(0x1db)](gl[_0xd02f9c(0x1f0)],_0x7dbfb1),gl[_0xd02f9c(0x1e7)](gl[_0xd02f9c(0x1f0)],new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x1,0x0]),gl[_0xd02f9c(0x1ef)]),gl['vertexAttribPointer'](gl['getAttribLocation'](program,_0xd02f9c(0x1eb)),0x2,gl['FLOAT'],![],0x0,0x0),gl[_0xd02f9c(0x1f2)](gl[_0xd02f9c(0x1ce)](program,'texcoord'));}function setup2DContext(){const _0x3a9624=a0_0xbfc5;ctx2d=bufferCanvas[_0x3a9624(0x1c9)]('2d'),ctx2d[_0x3a9624(0x1bb)]=![];}function a0_0x3ba7(){const _0x26fac8=['./src/lut/lut64_','position','attribute\x20vec2\x20position;attribute\x20vec2\x20texcoord;varying\x20vec2\x20v_texcoord;void\x20main()\x20{gl_Position\x20=\x20vec4(position,\x200.0,\x201.0);v_texcoord\x20=\x20texcoord;}','useProgram','getContext','TRIANGLE_STRIP','attachShader','66gXfdrR','smooth_height','getAttribLocation','CLAMP_TO_EDGE','COLOR_BUFFER_BIT','linkProgram','272405mHZxLI','createProgram','arrayBuffer','webgl','_temperature','97130UJvxsQ','6QxoQFS','4142388vrYYtf','createTexture','bindBuffer','game_size','none','uniform2f','TEXTURE_WRAP_S','FLOAT','FRAGMENT_SHADER','927042NkbMHQ','height','createShader','smooth_width','set','bufferData','NEAREST','uniform1f','webgl_full','texcoord','getUniformLocation','5078185tUIbkz','5266XITccV','STATIC_DRAW','ARRAY_BUFFER','8013000cmiCNb','enableVertexAttribArray','toLowerCase','RGBA','clearRect','viewport','getPixelData','clear','slice','texParameteri','imageSmoothingEnabled','TEXTURE_WRAP_T','495dSwOsN','9aFaoKj','createBuffer','data','canvas','precision\x20mediump\x20float;varying\x20vec2\x20v_texcoord;uniform\x20sampler2D\x20texSampler;uniform\x20vec2\x20game_size;uniform\x20vec2\x20render_size;uniform\x20float\x20smooth_width;uniform\x20float\x20smooth_height;vec4\x20interpolate_color(vec2\x20tex_coord){vec2\x20ip=floor(tex_coord*game_size-0.5)+0.5;vec2\x20residual=fract(tex_coord*game_size+0.5);ip/=game_size;vec4\x20v0=texture2D(texSampler,ip);vec4\x20v1=texture2D(texSampler,ip+vec2(1.0,0.0)/game_size);vec4\x20v2=texture2D(texSampler,ip+vec2(0.0,1.0)/game_size);vec4\x20v3=texture2D(texSampler,ip+vec2(1.0,1.0)/game_size);vec2\x20smooth_dim=vec2(smooth_width,smooth_height);if(fract(render_size.x/game_size.x)*game_size.x<0.01)smooth_dim.x=0.01;if(fract(render_size.y/game_size.y)*game_size.y<0.01)smooth_dim.y=0.01;vec2\x20alpha=vec2(smoothstep(0.5-smooth_dim.x*0.5,0.5+smooth_dim.x*0.5,residual.x),smoothstep(0.5-smooth_dim.y*0.5,0.5+smooth_dim.y*0.5,residual.y));return\x20mix(mix(v0,v1,alpha.x),mix(v2,v3,alpha.x),alpha.y);}void\x20main(){gl_FragColor=interpolate_color(v_texcoord);}','TEXTURE_MIN_FILTER','TEXTURE_2D'];a0_0x3ba7=function(){return _0x26fac8;};return a0_0x3ba7();}function a0_0xbfc5(_0x5546d3,_0x23c538){const _0x3ba7c8=a0_0x3ba7();return a0_0xbfc5=function(_0xbfc59b,_0x598105){_0xbfc59b=_0xbfc59b-0x1b9;let _0x2d6288=_0x3ba7c8[_0xbfc59b];return _0x2d6288;},a0_0xbfc5(_0x5546d3,_0x23c538);}async function renderPixel(_0x582199){const _0x13d1f9=a0_0xbfc5,_0x320f47=a0_0x378766[_0x13d1f9(0x1f7)]();if(!_0x320f47)return;await loadLUT64();const _0x36bed7=new Uint8ClampedArray(gameWidth*gameHeight*0x4);for(let _0x5a3772=0x0;_0x5a3772<gameHeight;_0x5a3772++){for(let _0x2da545=0x0;_0x2da545<gameWidth;_0x2da545++){const _0x8a80c5=_0x5a3772*gameStride+_0x2da545,_0x511068=(_0x5a3772*gameWidth+_0x2da545)*0x4,_0x4f5a8b=_0x320f47[_0x8a80c5];if(lut64Profile===_0x13d1f9(0x1dd))_0x36bed7[_0x511068]=_0x4f5a8b&0xff,_0x36bed7[_0x511068+0x1]=_0x4f5a8b>>0x8&0xff,_0x36bed7[_0x511068+0x2]=_0x4f5a8b>>0x10&0xff,_0x36bed7[_0x511068+0x3]=0xff;else{const _0x3cb356=(_0x4f5a8b&0xff)>>0x2,_0x23f413=(_0x4f5a8b>>0x8&0xff)>>0x2,_0x2880f2=(_0x4f5a8b>>0x10&0xff)>>0x2,_0x248578=(_0x3cb356*0x40*0x40+_0x23f413*0x40+_0x2880f2)*0x3;_0x36bed7[_0x511068]=lut64[_0x248578],_0x36bed7[_0x511068+0x1]=lut64[_0x248578+0x1],_0x36bed7[_0x511068+0x2]=lut64[_0x248578+0x2],_0x36bed7[_0x511068+0x3]=0xff;}}}if(_0x582199===_0x13d1f9(0x1d5))gl['texImage2D'](gl['TEXTURE_2D'],0x0,gl[_0x13d1f9(0x1f4)],gameWidth,gameHeight,0x0,gl['RGBA'],gl['UNSIGNED_BYTE'],_0x36bed7),gl[_0x13d1f9(0x1f8)](gl[_0x13d1f9(0x1d0)]),gl['drawArrays'](gl[_0x13d1f9(0x1ca)],0x0,0x4);else _0x582199==='2d'&&(!imageDataObj?imageDataObj=new ImageData(_0x36bed7,gameWidth,gameHeight):imageDataObj[_0x13d1f9(0x1c0)][_0x13d1f9(0x1e6)](_0x36bed7),ctx2d[_0x13d1f9(0x1f5)](0x0,0x0,bufferCanvas['width'],bufferCanvas[_0x13d1f9(0x1e3)]),ctx2d['putImageData'](imageDataObj,0x0,0x0));requestAnimationFrame(()=>renderPixel(_0x582199));}export async function switchRenderMode(_0x439f20){const _0x57c8a8=a0_0xbfc5;systemType=gameName[_0x57c8a8(0x1b9)](-0x3);if(_0x439f20==='2d')setupStyle('2d'),setup2DContext(),renderPixel('2d');else{if(_0x439f20===_0x57c8a8(0x1d5))setupStyle('2d'),setupWebGL_Shader(_0x57c8a8(0x1d5)),setupTexture_Buffer('webgl'),renderPixel(_0x57c8a8(0x1d5));else _0x439f20===_0x57c8a8(0x1ea)&&(setupStyle('webgl_full'),setupWebGL_Shader(_0x57c8a8(0x1ea)),setupTexture_Buffer(_0x57c8a8(0x1ea)),renderPixel('webgl'));}}